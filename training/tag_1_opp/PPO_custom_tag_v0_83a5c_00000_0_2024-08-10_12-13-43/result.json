{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.376557297318701, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.655082202840735, "policy_loss": -0.0068276750416588535, "vf_loss": 6.659909093190754, "vf_explained_var": 0.010302751877951244, "kl": 0.01000380691402802, "entropy": 1.5997740153913145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.504783664550632, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.163286433120569, "policy_loss": -0.011732292376594462, "vf_loss": 6.172689338525136, "vf_explained_var": 0.0012640471880634625, "kl": 0.011646936214297817, "entropy": 1.5981665708124637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": 9.119317019788179, "episode_reward_min": -19.839229807996727, "episode_reward_mean": -2.559661885470813, "episode_len_mean": 365.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 3285, "policy_reward_min": {"agent_policy": -9.11931701978818, "adversary_policy": -31.701772227608437}, "policy_reward_max": {"agent_policy": 19.83922980799673, "adversary_policy": 22.710394261700717}, "policy_reward_mean": {"agent_policy": 2.559661885470815, "adversary_policy": -2.5596618854708124}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.323017276394709, 1.579550285149244, 4.326150211194019, 7.68830576877939, -0.5972294319892537, -8.092581011674914, -14.898222726092545, 9.119317019788179, -19.839229807996727], "episode_lengths": [400, 85, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [2.3230172763947214, -1.5795502851492436, -4.326150211194013, -7.68830576877939, 0.597229431989251, 8.092581011674913, 14.898222726092548, -9.11931701978818, 19.83922980799673], "policy_adversary_policy_reward": [-4.566855449128665, -0.0791791036607652, 4.834677678963554, -1.6755771086650668, 14.600852056183376, -5.94855163379534, 22.710394261700717, -7.33378272414193, -6.192706736283858, 4.998247872305356, -6.937519163459456, -9.24764285989037, 1.9053267754233403, -31.701772227608437, 5.23576489258128, 13.002869146995081, -27.94236740458276, -11.736092211410686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8805904605032354, "mean_inference_ms": 2.4038145107453954, "mean_action_processing_ms": 0.3463884949164255, "mean_env_wait_ms": 0.14819205523045775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054836273193359375, "StateBufferConnector_ms": 0.002590815226236979, "ViewRequirementAgentConnector_ms": 0.08778836992051867}, "num_episodes": 9, "episode_return_max": 9.119317019788179, "episode_return_min": -19.839229807996727, "episode_return_mean": -2.559661885470813}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.24026934663266, "num_env_steps_trained_throughput_per_sec": 433.24026934663266, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 9232.761, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9232.721, "sample_time_ms": 1868.229, "learn_time_ms": 7353.847, "learn_throughput": 543.933, "synch_weights_time_ms": 10.007}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 1, "trial_id": "83a5c_00000", "date": "2024-08-10_12-14-02", "timestamp": 1723306442, "time_this_iter_s": 9.26827597618103, "time_total_s": 9.26827597618103, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5443a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9.26827597618103, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 38.96428571428571, "ram_util_percent": 83.35714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4962123088262698, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.738567825852248, "policy_loss": -0.0046679196847238084, "vf_loss": 6.741802215576172, "vf_explained_var": -0.0036034231148068868, "kl": 0.007167659309595143, "entropy": 1.5940493007185599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1283525086939337, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.931220172345638, "policy_loss": -0.01002776470995741, "vf_loss": 5.938064728677273, "vf_explained_var": 0.06994032592823109, "kl": 0.015916083618638683, "entropy": 1.5667306759705146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 9.812815613957339, "episode_reward_min": -20.524656162944652, "episode_reward_mean": -5.637110337039987, "episode_len_mean": 380.89473684210526, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 7237, "policy_reward_min": {"agent_policy": -9.81281561395734, "adversary_policy": -34.0821466318629}, "policy_reward_max": {"agent_policy": 20.524656162944655, "adversary_policy": 22.710394261700717}, "policy_reward_mean": {"agent_policy": 5.637110337039988, "adversary_policy": -5.637110337039987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.323017276394709, 1.579550285149244, 4.326150211194019, 7.68830576877939, -0.5972294319892537, -8.092581011674914, -14.898222726092545, 9.119317019788179, -19.839229807996727, -11.605533193144225, -15.387404251646476, -9.98285110143166, -1.2301477180681708, -7.250718214619177, -20.524656162944652, -5.954640359835789, 9.812815613957339, -11.836588626765257, -10.108415420024366], "episode_lengths": [400, 85, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 352, 400, 400], "policy_agent_policy_reward": [2.3230172763947214, -1.5795502851492436, -4.326150211194013, -7.68830576877939, 0.597229431989251, 8.092581011674913, 14.898222726092548, -9.11931701978818, 19.83922980799673, 11.605533193144229, 15.387404251646478, 9.98285110143166, 1.2301477180681637, 7.250718214619175, 20.524656162944655, 5.954640359835789, -9.81281561395734, 11.83658862676526, 10.108415420024372], "policy_adversary_policy_reward": [-4.566855449128665, -0.0791791036607652, 4.834677678963554, -1.6755771086650668, 14.600852056183376, -5.94855163379534, 22.710394261700717, -7.33378272414193, -6.192706736283858, 4.998247872305356, -6.937519163459456, -9.24764285989037, 1.9053267754233403, -31.701772227608437, 5.23576489258128, 13.002869146995081, -27.94236740458276, -11.736092211410686, -11.191118487597905, -12.01994789869056, -14.836920131684646, -15.93788837160831, -20.437273473988313, 0.47157127112499353, -5.3770617996598915, 2.916766363523559, 4.377220462685969, -18.87865689192432, -34.0821466318629, -6.967165694026409, -7.373867396241458, -4.53541332343012, 12.95901742510926, 6.666613802805426, -24.061098366970107, 0.38792111343960123, -20.924190323409935, 0.707359483361186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7712213176073026, "mean_inference_ms": 2.0618000746964804, "mean_action_processing_ms": 0.3058200000884375, "mean_env_wait_ms": 0.12999651042880322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005260894173070004, "StateBufferConnector_ms": 0.0028710616262335527, "ViewRequirementAgentConnector_ms": 0.08675612901386462}, "num_episodes": 10, "episode_return_max": 9.812815613957339, "episode_return_min": -20.524656162944652, "episode_return_mean": -5.637110337039987}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 441.45726331911806, "num_env_steps_trained_throughput_per_sec": 441.45726331911806, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 9146.975, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9146.576, "sample_time_ms": 1398.638, "learn_time_ms": 7715.019, "learn_throughput": 518.469, "synch_weights_time_ms": 28.761}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 2, "trial_id": "83a5c_00000", "date": "2024-08-10_12-14-13", "timestamp": 1723306453, "time_this_iter_s": 9.132081270217896, "time_total_s": 18.400357246398926, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5c91f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18.400357246398926, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.513333333333335, "ram_util_percent": 83.47333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.523422267449596, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.220596635657013, "policy_loss": -0.004366254399619287, "vf_loss": 6.223763729781701, "vf_explained_var": 0.0016313987118857247, "kl": 0.00599578014735103, "entropy": 1.5930738507124482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.83499516689529, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.203285314142704, "policy_loss": -0.005090795252666188, "vf_loss": 5.206536356111368, "vf_explained_var": -0.009722261875867843, "kl": 0.00919870959930111, "entropy": 1.5355867984394231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 15.962284900313453, "episode_reward_min": -20.524656162944652, "episode_reward_mean": -3.3470946870389713, "episode_len_mean": 378.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 10962, "policy_reward_min": {"agent_policy": -15.962284900313403, "adversary_policy": -34.0821466318629}, "policy_reward_max": {"agent_policy": 20.524656162944655, "adversary_policy": 27.970622151433147}, "policy_reward_mean": {"agent_policy": 3.3470946870389735, "adversary_policy": -3.3470946870389735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.323017276394709, 1.579550285149244, 4.326150211194019, 7.68830576877939, -0.5972294319892537, -8.092581011674914, -14.898222726092545, 9.119317019788179, -19.839229807996727, -11.605533193144225, -15.387404251646476, -9.98285110143166, -1.2301477180681708, -7.250718214619177, -20.524656162944652, -5.954640359835789, 9.812815613957339, -11.836588626765257, -10.108415420024366, -3.2284670052876887, 11.034581972548104, 15.962284900313453, -14.645558503155572, 0.8246944710212336, -15.680811239489085, -3.8832460985158335, 12.11120907951913, 8.387697438124642, -0.8430345354487976], "episode_lengths": [400, 85, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 352, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400], "policy_agent_policy_reward": [2.3230172763947214, -1.5795502851492436, -4.326150211194013, -7.68830576877939, 0.597229431989251, 8.092581011674913, 14.898222726092548, -9.11931701978818, 19.83922980799673, 11.605533193144229, 15.387404251646478, 9.98285110143166, 1.2301477180681637, 7.250718214619175, 20.524656162944655, 5.954640359835789, -9.81281561395734, 11.83658862676526, 10.108415420024372, 3.2284670052876887, -11.034581972548105, -15.962284900313403, 14.645558503155575, -0.8246944710212247, 15.68081123948909, 3.8832460985158317, -12.111209079519142, -8.387697438124643, 0.8430345354487976], "policy_adversary_policy_reward": [-4.566855449128665, -0.0791791036607652, 4.834677678963554, -1.6755771086650668, 14.600852056183376, -5.94855163379534, 22.710394261700717, -7.33378272414193, -6.192706736283858, 4.998247872305356, -6.937519163459456, -9.24764285989037, 1.9053267754233403, -31.701772227608437, 5.23576489258128, 13.002869146995081, -27.94236740458276, -11.736092211410686, -11.191118487597905, -12.01994789869056, -14.836920131684646, -15.93788837160831, -20.437273473988313, 0.47157127112499353, -5.3770617996598915, 2.916766363523559, 4.377220462685969, -18.87865689192432, -34.0821466318629, -6.967165694026409, -7.373867396241458, -4.53541332343012, 12.95901742510926, 6.666613802805426, -24.061098366970107, 0.38792111343960123, -20.924190323409935, 0.707359483361186, -7.2507615374023295, 0.7938275268269521, 5.241972232004031, 16.82719171309217, 27.970622151433147, 3.9539476491936973, -10.922476286691683, -18.368640719619496, -15.049896080818513, 16.69928502286095, -18.981140130408132, -12.380482348570045, -1.350417156029529, -6.416075041002141, 6.792261168449365, 17.43015699058893, 18.280335007537452, -1.5049401312881727, 0.8256207379333773, -2.5116898088309725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7484870598854569, "mean_inference_ms": 2.067591526075778, "mean_action_processing_ms": 0.3045729841124124, "mean_env_wait_ms": 0.13335905386522942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005301935919399919, "StateBufferConnector_ms": 0.011098384857177734, "ViewRequirementAgentConnector_ms": 0.0902529420523808}, "num_episodes": 10, "episode_return_max": 15.962284900313453, "episode_return_min": -20.524656162944652, "episode_return_mean": -3.3470946870389713}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.29944875577485, "num_env_steps_trained_throughput_per_sec": 433.29944875577485, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 9175.156, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9174.867, "sample_time_ms": 1627.432, "learn_time_ms": 7521.185, "learn_throughput": 531.831, "synch_weights_time_ms": 23.287}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 3, "trial_id": "83a5c_00000", "date": "2024-08-10_12-14-22", "timestamp": 1723306462, "time_this_iter_s": 9.236894130706787, "time_total_s": 27.637251377105713, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5c95e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27.637251377105713, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 46.44285714285714, "ram_util_percent": 83.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.045045502460192, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.725164835793631, "policy_loss": -0.0049016482021817295, "vf_loss": 5.728062159422214, "vf_explained_var": 0.0980390241221776, "kl": 0.010021690499533924, "entropy": 1.5762911951731122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.306468813152363, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.723277814437946, "policy_loss": -0.009678806995604342, "vf_loss": 4.730635608484348, "vf_explained_var": 0.07822098899632693, "kl": 0.011604984796735825, "entropy": 1.475458209340771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 21.423660199879038, "episode_reward_min": -20.524656162944652, "episode_reward_mean": -2.854024032946577, "episode_len_mean": 377.61538461538464, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 14727, "policy_reward_min": {"agent_policy": -21.423660199879055, "adversary_policy": -34.0821466318629}, "policy_reward_max": {"agent_policy": 20.524656162944655, "adversary_policy": 34.91320692202245}, "policy_reward_mean": {"agent_policy": 2.8540240329465796, "adversary_policy": -2.854024032946579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.323017276394709, 1.579550285149244, 4.326150211194019, 7.68830576877939, -0.5972294319892537, -8.092581011674914, -14.898222726092545, 9.119317019788179, -19.839229807996727, -11.605533193144225, -15.387404251646476, -9.98285110143166, -1.2301477180681708, -7.250718214619177, -20.524656162944652, -5.954640359835789, 9.812815613957339, -11.836588626765257, -10.108415420024366, -3.2284670052876887, 11.034581972548104, 15.962284900313453, -14.645558503155572, 0.8246944710212336, -15.680811239489085, -3.8832460985158335, 12.11120907951913, 8.387697438124642, -0.8430345354487976, 21.423660199879038, 10.10186444496731, -2.237876120144284, -6.502047224750914, 4.32453696196149, 5.1096639149904455, -17.345357759639803, -13.516809565381923, -9.902872130562375, -5.695954082105349], "episode_lengths": [400, 85, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 352, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [2.3230172763947214, -1.5795502851492436, -4.326150211194013, -7.68830576877939, 0.597229431989251, 8.092581011674913, 14.898222726092548, -9.11931701978818, 19.83922980799673, 11.605533193144229, 15.387404251646478, 9.98285110143166, 1.2301477180681637, 7.250718214619175, 20.524656162944655, 5.954640359835789, -9.81281561395734, 11.83658862676526, 10.108415420024372, 3.2284670052876887, -11.034581972548105, -15.962284900313403, 14.645558503155575, -0.8246944710212247, 15.68081123948909, 3.8832460985158317, -12.111209079519142, -8.387697438124643, 0.8430345354487976, -21.423660199879055, -10.10186444496731, 2.237876120144284, 6.5020472247509105, -4.32453696196149, -5.109663914990451, 17.345357759639803, 13.51680956538193, 9.902872130562375, 5.695954082105349], "policy_adversary_policy_reward": [-4.566855449128665, -0.0791791036607652, 4.834677678963554, -1.6755771086650668, 14.600852056183376, -5.94855163379534, 22.710394261700717, -7.33378272414193, -6.192706736283858, 4.998247872305356, -6.937519163459456, -9.24764285989037, 1.9053267754233403, -31.701772227608437, 5.23576489258128, 13.002869146995081, -27.94236740458276, -11.736092211410686, -11.191118487597905, -12.01994789869056, -14.836920131684646, -15.93788837160831, -20.437273473988313, 0.47157127112499353, -5.3770617996598915, 2.916766363523559, 4.377220462685969, -18.87865689192432, -34.0821466318629, -6.967165694026409, -7.373867396241458, -4.53541332343012, 12.95901742510926, 6.666613802805426, -24.061098366970107, 0.38792111343960123, -20.924190323409935, 0.707359483361186, -7.2507615374023295, 0.7938275268269521, 5.241972232004031, 16.82719171309217, 27.970622151433147, 3.9539476491936973, -10.922476286691683, -18.368640719619496, -15.049896080818513, 16.69928502286095, -18.981140130408132, -12.380482348570045, -1.350417156029529, -6.416075041002141, 6.792261168449365, 17.43015699058893, 18.280335007537452, -1.5049401312881727, 0.8256207379333773, -2.5116898088309725, 34.91320692202245, 7.934113477735659, 14.296473465123384, 5.907255424811236, 1.35144700597888, -5.827199246267448, -5.398362895684812, -7.605731553817014, 4.275138927969628, 4.373934995953352, -1.4216476301189154, 11.640975460099803, -20.150037190377983, -14.540678328901627, -23.23604179513527, -3.797577335628578, -17.219407475651263, -2.5863367854734918, -0.08636949967577578, -11.305538664534922]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.717074142988697, "mean_inference_ms": 2.003438743831567, "mean_action_processing_ms": 0.29460434422009174, "mean_env_wait_ms": 0.1292582770130602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007297748174422827, "StateBufferConnector_ms": 0.008851136916723007, "ViewRequirementAgentConnector_ms": 0.08279176858755258}, "num_episodes": 10, "episode_return_max": 21.423660199879038, "episode_return_min": -20.524656162944652, "episode_return_mean": -2.854024032946577}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.22141640536734, "num_env_steps_trained_throughput_per_sec": 493.22141640536734, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 8908.856, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8908.63, "sample_time_ms": 1410.84, "learn_time_ms": 7475.275, "learn_throughput": 535.097, "synch_weights_time_ms": 20.165}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 4, "trial_id": "83a5c_00000", "date": "2024-08-10_12-14-30", "timestamp": 1723306470, "time_this_iter_s": 8.115514993667603, "time_total_s": 35.752766370773315, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5c99d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 35.752766370773315, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.71818181818182, "ram_util_percent": 82.74545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2340413443152864, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.550518618941938, "policy_loss": -0.006327019102634892, "vf_loss": 5.554892155733058, "vf_explained_var": 0.05142064359452989, "kl": 0.009767430372839897, "entropy": 1.569562215401382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6552803700168925, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.241943816343944, "policy_loss": -0.0067182059608361065, "vf_loss": 5.2471685945987705, "vf_explained_var": 0.2390593900034825, "kl": 0.007467090532748122, "entropy": 1.4646563520034155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": 21.423660199879038, "episode_reward_min": -20.524656162944652, "episode_reward_mean": -1.7950424425998772, "episode_len_mean": 381.8125, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 18327, "policy_reward_min": {"agent_policy": -21.423660199879055, "adversary_policy": -34.0821466318629}, "policy_reward_max": {"agent_policy": 20.524656162944655, "adversary_policy": 34.91320692202245}, "policy_reward_mean": {"agent_policy": 1.795042442599878, "adversary_policy": -1.7950424425998779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.323017276394709, 1.579550285149244, 4.326150211194019, 7.68830576877939, -0.5972294319892537, -8.092581011674914, -14.898222726092545, 9.119317019788179, -19.839229807996727, -11.605533193144225, -15.387404251646476, -9.98285110143166, -1.2301477180681708, -7.250718214619177, -20.524656162944652, -5.954640359835789, 9.812815613957339, -11.836588626765257, -10.108415420024366, -3.2284670052876887, 11.034581972548104, 15.962284900313453, -14.645558503155572, 0.8246944710212336, -15.680811239489085, -3.8832460985158335, 12.11120907951913, 8.387697438124642, -0.8430345354487976, 21.423660199879038, 10.10186444496731, -2.237876120144284, -6.502047224750914, 4.32453696196149, 5.1096639149904455, -17.345357759639803, -13.516809565381923, -9.902872130562375, -5.695954082105349, -4.9158120229083275, 17.316622486702403, 10.232530109378859, -0.16102900773863205, 2.3705764753149943, 5.667951790290926, 1.6154251700902877, -16.889558955349422, 9.90819399434133], "episode_lengths": [400, 85, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 352, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [2.3230172763947214, -1.5795502851492436, -4.326150211194013, -7.68830576877939, 0.597229431989251, 8.092581011674913, 14.898222726092548, -9.11931701978818, 19.83922980799673, 11.605533193144229, 15.387404251646478, 9.98285110143166, 1.2301477180681637, 7.250718214619175, 20.524656162944655, 5.954640359835789, -9.81281561395734, 11.83658862676526, 10.108415420024372, 3.2284670052876887, -11.034581972548105, -15.962284900313403, 14.645558503155575, -0.8246944710212247, 15.68081123948909, 3.8832460985158317, -12.111209079519142, -8.387697438124643, 0.8430345354487976, -21.423660199879055, -10.10186444496731, 2.237876120144284, 6.5020472247509105, -4.32453696196149, -5.109663914990451, 17.345357759639803, 13.51680956538193, 9.902872130562375, 5.695954082105349, 4.915812022908328, -17.316622486702407, -10.232530109378859, 0.16102900773863205, -2.3705764753149996, -5.667951790290918, -1.615425170090294, 16.889558955349422, -9.908193994341335], "policy_adversary_policy_reward": [-4.566855449128665, -0.0791791036607652, 4.834677678963554, -1.6755771086650668, 14.600852056183376, -5.94855163379534, 22.710394261700717, -7.33378272414193, -6.192706736283858, 4.998247872305356, -6.937519163459456, -9.24764285989037, 1.9053267754233403, -31.701772227608437, 5.23576489258128, 13.002869146995081, -27.94236740458276, -11.736092211410686, -11.191118487597905, -12.01994789869056, -14.836920131684646, -15.93788837160831, -20.437273473988313, 0.47157127112499353, -5.3770617996598915, 2.916766363523559, 4.377220462685969, -18.87865689192432, -34.0821466318629, -6.967165694026409, -7.373867396241458, -4.53541332343012, 12.95901742510926, 6.666613802805426, -24.061098366970107, 0.38792111343960123, -20.924190323409935, 0.707359483361186, -7.2507615374023295, 0.7938275268269521, 5.241972232004031, 16.82719171309217, 27.970622151433147, 3.9539476491936973, -10.922476286691683, -18.368640719619496, -15.049896080818513, 16.69928502286095, -18.981140130408132, -12.380482348570045, -1.350417156029529, -6.416075041002141, 6.792261168449365, 17.43015699058893, 18.280335007537452, -1.5049401312881727, 0.8256207379333773, -2.5116898088309725, 34.91320692202245, 7.934113477735659, 14.296473465123384, 5.907255424811236, 1.35144700597888, -5.827199246267448, -5.398362895684812, -7.605731553817014, 4.275138927969628, 4.373934995953352, -1.4216476301189154, 11.640975460099803, -20.150037190377983, -14.540678328901627, -23.23604179513527, -3.797577335628578, -17.219407475651263, -2.5863367854734918, -0.08636949967577578, -11.305538664534922, -4.771837305833966, -5.059786739982691, 1.3483834680400406, 33.28486150536479, 15.164844641879032, 5.300215576878685, 14.973652925328985, -15.295710940806249, 11.98514751702174, -7.243994566391741, 13.867466562525006, -2.531562981943157, 0.9439010144353475, 2.2869493257452334, -10.22331893809907, -23.555798972599774, 4.539818312892887, 15.276569675789782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6909934823648571, "mean_inference_ms": 1.9377276689872354, "mean_action_processing_ms": 0.28571070613615746, "mean_env_wait_ms": 0.12549261523181263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006667524576187134, "StateBufferConnector_ms": 0.007620205481847127, "ViewRequirementAgentConnector_ms": 0.07838134964307149}, "num_episodes": 9, "episode_return_max": 21.423660199879038, "episode_return_min": -20.524656162944652, "episode_return_mean": -1.7950424425998772}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.9814792473804, "num_env_steps_trained_throughput_per_sec": 518.9814792473804, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 8668.567, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8668.379, "sample_time_ms": 1285.392, "learn_time_ms": 7362.944, "learn_throughput": 543.261, "synch_weights_time_ms": 18.077}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 5, "trial_id": "83a5c_00000", "date": "2024-08-10_12-14-38", "timestamp": 1723306478, "time_this_iter_s": 7.710149049758911, "time_total_s": 43.46291542053223, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 43.46291542053223, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 33.663636363636364, "ram_util_percent": 82.54545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.305260657917255, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.957806186827402, "policy_loss": -0.0018266307298468534, "vf_loss": 5.958688919127933, "vf_explained_var": -0.2839924188833388, "kl": 0.0047194491707281214, "entropy": 1.5691754945371517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0799222315661607, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.384926043947538, "policy_loss": -0.005351803569161954, "vf_loss": 5.388659333686034, "vf_explained_var": 0.4435033924877644, "kl": 0.008092542899148868, "entropy": 1.3767653349786997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 29.72124649003794, "episode_reward_min": -29.757715747882592, "episode_reward_mean": -1.4116877794021478, "episode_len_mean": 384.6842105263158, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 21927, "policy_reward_min": {"agent_policy": -29.72124649003792, "adversary_policy": -46.23649561145355}, "policy_reward_max": {"agent_policy": 29.757715747882592, "adversary_policy": 34.91320692202245}, "policy_reward_mean": {"agent_policy": 1.411687779402149, "adversary_policy": -1.4116877794021492}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.323017276394709, 1.579550285149244, 4.326150211194019, 7.68830576877939, -0.5972294319892537, -8.092581011674914, -14.898222726092545, 9.119317019788179, -19.839229807996727, -11.605533193144225, -15.387404251646476, -9.98285110143166, -1.2301477180681708, -7.250718214619177, -20.524656162944652, -5.954640359835789, 9.812815613957339, -11.836588626765257, -10.108415420024366, -3.2284670052876887, 11.034581972548104, 15.962284900313453, -14.645558503155572, 0.8246944710212336, -15.680811239489085, -3.8832460985158335, 12.11120907951913, 8.387697438124642, -0.8430345354487976, 21.423660199879038, 10.10186444496731, -2.237876120144284, -6.502047224750914, 4.32453696196149, 5.1096639149904455, -17.345357759639803, -13.516809565381923, -9.902872130562375, -5.695954082105349, -4.9158120229083275, 17.316622486702403, 10.232530109378859, -0.16102900773863205, 2.3705764753149943, 5.667951790290926, 1.6154251700902877, -16.889558955349422, 9.90819399434133, 1.9232427510822543, -29.757715747882592, 10.19699337841552, 21.572472946579776, -25.002402925353547, -20.883710493123946, 6.593380473219327, 11.332326945896952, 29.72124649003794], "episode_lengths": [400, 85, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 352, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [2.3230172763947214, -1.5795502851492436, -4.326150211194013, -7.68830576877939, 0.597229431989251, 8.092581011674913, 14.898222726092548, -9.11931701978818, 19.83922980799673, 11.605533193144229, 15.387404251646478, 9.98285110143166, 1.2301477180681637, 7.250718214619175, 20.524656162944655, 5.954640359835789, -9.81281561395734, 11.83658862676526, 10.108415420024372, 3.2284670052876887, -11.034581972548105, -15.962284900313403, 14.645558503155575, -0.8246944710212247, 15.68081123948909, 3.8832460985158317, -12.111209079519142, -8.387697438124643, 0.8430345354487976, -21.423660199879055, -10.10186444496731, 2.237876120144284, 6.5020472247509105, -4.32453696196149, -5.109663914990451, 17.345357759639803, 13.51680956538193, 9.902872130562375, 5.695954082105349, 4.915812022908328, -17.316622486702407, -10.232530109378859, 0.16102900773863205, -2.3705764753149996, -5.667951790290918, -1.615425170090294, 16.889558955349422, -9.908193994341335, -1.9232427510822463, 29.757715747882592, -10.196993378415515, -21.57247294657977, 25.00240292535355, 20.883710493123946, -6.593380473219332, -11.332326945896957, -29.72124649003792], "policy_adversary_policy_reward": [-4.566855449128665, -0.0791791036607652, 4.834677678963554, -1.6755771086650668, 14.600852056183376, -5.94855163379534, 22.710394261700717, -7.33378272414193, -6.192706736283858, 4.998247872305356, -6.937519163459456, -9.24764285989037, 1.9053267754233403, -31.701772227608437, 5.23576489258128, 13.002869146995081, -27.94236740458276, -11.736092211410686, -11.191118487597905, -12.01994789869056, -14.836920131684646, -15.93788837160831, -20.437273473988313, 0.47157127112499353, -5.3770617996598915, 2.916766363523559, 4.377220462685969, -18.87865689192432, -34.0821466318629, -6.967165694026409, -7.373867396241458, -4.53541332343012, 12.95901742510926, 6.666613802805426, -24.061098366970107, 0.38792111343960123, -20.924190323409935, 0.707359483361186, -7.2507615374023295, 0.7938275268269521, 5.241972232004031, 16.82719171309217, 27.970622151433147, 3.9539476491936973, -10.922476286691683, -18.368640719619496, -15.049896080818513, 16.69928502286095, -18.981140130408132, -12.380482348570045, -1.350417156029529, -6.416075041002141, 6.792261168449365, 17.43015699058893, 18.280335007537452, -1.5049401312881727, 0.8256207379333773, -2.5116898088309725, 34.91320692202245, 7.934113477735659, 14.296473465123384, 5.907255424811236, 1.35144700597888, -5.827199246267448, -5.398362895684812, -7.605731553817014, 4.275138927969628, 4.373934995953352, -1.4216476301189154, 11.640975460099803, -20.150037190377983, -14.540678328901627, -23.23604179513527, -3.797577335628578, -17.219407475651263, -2.5863367854734918, -0.08636949967577578, -11.305538664534922, -4.771837305833966, -5.059786739982691, 1.3483834680400406, 33.28486150536479, 15.164844641879032, 5.300215576878685, 14.973652925328985, -15.295710940806249, 11.98514751702174, -7.243994566391741, 13.867466562525006, -2.531562981943157, 0.9439010144353475, 2.2869493257452334, -10.22331893809907, -23.555798972599774, 4.539818312892887, 15.276569675789782, -6.443939707886328, 10.290425210050817, -13.278935884311636, -46.23649561145355, 0.6829899881251151, 19.710996768705918, 14.28330272631136, 28.861643166848193, -14.292173814187333, -35.712632036519764, -24.666092349993477, -17.101328636254415, 13.590821056906345, -0.404060110467686, 12.579979873134313, 10.084674018659598, 28.337633491225574, 31.10485948885023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6685028693038118, "mean_inference_ms": 1.876527678795408, "mean_action_processing_ms": 0.2776511235920933, "mean_env_wait_ms": 0.12181919537629468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006262043066192092, "StateBufferConnector_ms": 0.006799948842901932, "ViewRequirementAgentConnector_ms": 0.07694227653637267}, "num_episodes": 9, "episode_return_max": 29.72124649003794, "episode_return_min": -29.757715747882592, "episode_return_mean": -1.4116877794021478}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.93642026079203, "num_env_steps_trained_throughput_per_sec": 467.93642026079203, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 8648.505, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8648.24, "sample_time_ms": 1201.235, "learn_time_ms": 7424.744, "learn_throughput": 538.739, "synch_weights_time_ms": 20.053}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 6, "trial_id": "83a5c_00000", "date": "2024-08-10_12-14-47", "timestamp": 1723306487, "time_this_iter_s": 8.596498250961304, "time_total_s": 52.05941367149353, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61a310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.05941367149353, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 36.708333333333336, "ram_util_percent": 82.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7419417160055626, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.390382760668558, "policy_loss": -0.004922163572344712, "vf_loss": 5.393836150345979, "vf_explained_var": 0.0067842545332732025, "kl": 0.014687792681319456, "entropy": 1.5799619388328028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3066949182500442, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.70473900710543, "policy_loss": -0.007997901639222012, "vf_loss": 4.7107144174476465, "vf_explained_var": 0.33518450303624076, "kl": 0.010112396012579516, "entropy": 1.3908346927414337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 29.72124649003794, "episode_reward_min": -35.47902454651848, "episode_reward_mean": -1.4453155238095674, "episode_len_mean": 386.77272727272725, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 25527, "policy_reward_min": {"agent_policy": -29.72124649003792, "adversary_policy": -46.23649561145355}, "policy_reward_max": {"agent_policy": 35.479024546518474, "adversary_policy": 34.91320692202245}, "policy_reward_mean": {"agent_policy": 1.4453155238095687, "adversary_policy": -1.4453155238095687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.323017276394709, 1.579550285149244, 4.326150211194019, 7.68830576877939, -0.5972294319892537, -8.092581011674914, -14.898222726092545, 9.119317019788179, -19.839229807996727, -11.605533193144225, -15.387404251646476, -9.98285110143166, -1.2301477180681708, -7.250718214619177, -20.524656162944652, -5.954640359835789, 9.812815613957339, -11.836588626765257, -10.108415420024366, -3.2284670052876887, 11.034581972548104, 15.962284900313453, -14.645558503155572, 0.8246944710212336, -15.680811239489085, -3.8832460985158335, 12.11120907951913, 8.387697438124642, -0.8430345354487976, 21.423660199879038, 10.10186444496731, -2.237876120144284, -6.502047224750914, 4.32453696196149, 5.1096639149904455, -17.345357759639803, -13.516809565381923, -9.902872130562375, -5.695954082105349, -4.9158120229083275, 17.316622486702403, 10.232530109378859, -0.16102900773863205, 2.3705764753149943, 5.667951790290926, 1.6154251700902877, -16.889558955349422, 9.90819399434133, 1.9232427510822543, -29.757715747882592, 10.19699337841552, 21.572472946579776, -25.002402925353547, -20.883710493123946, 6.593380473219327, 11.332326945896952, 29.72124649003794, -12.971607791782027, 7.754204288377872, -18.431747372605518, 8.453208811764705, -35.47902454651848, -13.904660425816452, 18.920883729976456, 15.813228299236219, 14.920893861858207], "episode_lengths": [400, 85, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 352, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [2.3230172763947214, -1.5795502851492436, -4.326150211194013, -7.68830576877939, 0.597229431989251, 8.092581011674913, 14.898222726092548, -9.11931701978818, 19.83922980799673, 11.605533193144229, 15.387404251646478, 9.98285110143166, 1.2301477180681637, 7.250718214619175, 20.524656162944655, 5.954640359835789, -9.81281561395734, 11.83658862676526, 10.108415420024372, 3.2284670052876887, -11.034581972548105, -15.962284900313403, 14.645558503155575, -0.8246944710212247, 15.68081123948909, 3.8832460985158317, -12.111209079519142, -8.387697438124643, 0.8430345354487976, -21.423660199879055, -10.10186444496731, 2.237876120144284, 6.5020472247509105, -4.32453696196149, -5.109663914990451, 17.345357759639803, 13.51680956538193, 9.902872130562375, 5.695954082105349, 4.915812022908328, -17.316622486702407, -10.232530109378859, 0.16102900773863205, -2.3705764753149996, -5.667951790290918, -1.615425170090294, 16.889558955349422, -9.908193994341335, -1.9232427510822463, 29.757715747882592, -10.196993378415515, -21.57247294657977, 25.00240292535355, 20.883710493123946, -6.593380473219332, -11.332326945896957, -29.72124649003792, 12.971607791782027, -7.754204288377869, 18.431747372605518, -8.453208811764709, 35.479024546518474, 13.904660425816452, -18.92088372997646, -15.813228299236226, -14.92089386185818], "policy_adversary_policy_reward": [-4.566855449128665, -0.0791791036607652, 4.834677678963554, -1.6755771086650668, 14.600852056183376, -5.94855163379534, 22.710394261700717, -7.33378272414193, -6.192706736283858, 4.998247872305356, -6.937519163459456, -9.24764285989037, 1.9053267754233403, -31.701772227608437, 5.23576489258128, 13.002869146995081, -27.94236740458276, -11.736092211410686, -11.191118487597905, -12.01994789869056, -14.836920131684646, -15.93788837160831, -20.437273473988313, 0.47157127112499353, -5.3770617996598915, 2.916766363523559, 4.377220462685969, -18.87865689192432, -34.0821466318629, -6.967165694026409, -7.373867396241458, -4.53541332343012, 12.95901742510926, 6.666613802805426, -24.061098366970107, 0.38792111343960123, -20.924190323409935, 0.707359483361186, -7.2507615374023295, 0.7938275268269521, 5.241972232004031, 16.82719171309217, 27.970622151433147, 3.9539476491936973, -10.922476286691683, -18.368640719619496, -15.049896080818513, 16.69928502286095, -18.981140130408132, -12.380482348570045, -1.350417156029529, -6.416075041002141, 6.792261168449365, 17.43015699058893, 18.280335007537452, -1.5049401312881727, 0.8256207379333773, -2.5116898088309725, 34.91320692202245, 7.934113477735659, 14.296473465123384, 5.907255424811236, 1.35144700597888, -5.827199246267448, -5.398362895684812, -7.605731553817014, 4.275138927969628, 4.373934995953352, -1.4216476301189154, 11.640975460099803, -20.150037190377983, -14.540678328901627, -23.23604179513527, -3.797577335628578, -17.219407475651263, -2.5863367854734918, -0.08636949967577578, -11.305538664534922, -4.771837305833966, -5.059786739982691, 1.3483834680400406, 33.28486150536479, 15.164844641879032, 5.300215576878685, 14.973652925328985, -15.295710940806249, 11.98514751702174, -7.243994566391741, 13.867466562525006, -2.531562981943157, 0.9439010144353475, 2.2869493257452334, -10.22331893809907, -23.555798972599774, 4.539818312892887, 15.276569675789782, -6.443939707886328, 10.290425210050817, -13.278935884311636, -46.23649561145355, 0.6829899881251151, 19.710996768705918, 14.28330272631136, 28.861643166848193, -14.292173814187333, -35.712632036519764, -24.666092349993477, -17.101328636254415, 13.590821056906345, -0.404060110467686, 12.579979873134313, 10.084674018659598, 28.337633491225574, 31.10485948885023, -11.461736507831418, -14.481479075732636, 4.567970889298241, 10.940437687457512, -7.300966378360378, -29.562528366850657, 11.675096533628782, 5.231321089900629, -36.485261338186014, -34.47278775485095, -8.188692056340798, -19.620628795292106, 19.894153905059856, 17.947613554893078, 19.99801401969809, 11.628442578774363, 11.618654888559204, 18.22313283515712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6538316286165955, "mean_inference_ms": 1.8332248543663459, "mean_action_processing_ms": 0.27261539247441646, "mean_env_wait_ms": 0.11960286019414397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007027748859289921, "StateBufferConnector_ms": 0.006283774520411636, "ViewRequirementAgentConnector_ms": 0.08002664103652492}, "num_episodes": 9, "episode_return_max": 29.72124649003794, "episode_return_min": -35.47902454651848, "episode_return_mean": -1.4453155238095674}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 468.4987317997274, "num_env_steps_trained_throughput_per_sec": 468.4987317997274, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 8632.71, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8632.474, "sample_time_ms": 1204.271, "learn_time_ms": 7407.544, "learn_throughput": 539.99, "synch_weights_time_ms": 18.684}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 7, "trial_id": "83a5c_00000", "date": "2024-08-10_12-14-55", "timestamp": 1723306495, "time_this_iter_s": 8.588460206985474, "time_total_s": 60.647873878479004, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 60.647873878479004, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.38461538461539, "ram_util_percent": 83.07692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.546991043384113, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.877217877352679, "policy_loss": -0.0029885227443334998, "vf_loss": 5.879441508288106, "vf_explained_var": -0.33825094176347925, "kl": 0.007648860439129293, "entropy": 1.553375270505431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.748795462306589, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.712982264657815, "policy_loss": -0.010927064339921345, "vf_loss": 4.72066953231891, "vf_explained_var": 0.3805265157793959, "kl": 0.01619896000797501, "entropy": 1.316648072252671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 31.11044260552017, "episode_reward_min": -35.47902454651848, "episode_reward_mean": -0.5677950001149193, "episode_len_mean": 375.1898734177215, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 29640, "policy_reward_min": {"agent_policy": -31.110442605520195, "adversary_policy": -46.23649561145355}, "policy_reward_max": {"agent_policy": 35.479024546518474, "adversary_policy": 39.127983671656665}, "policy_reward_mean": {"agent_policy": 0.5677950001149197, "adversary_policy": -0.5677950001149205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.323017276394709, 1.579550285149244, 4.326150211194019, 7.68830576877939, -0.5972294319892537, -8.092581011674914, -14.898222726092545, 9.119317019788179, -19.839229807996727, -11.605533193144225, -15.387404251646476, -9.98285110143166, -1.2301477180681708, -7.250718214619177, -20.524656162944652, -5.954640359835789, 9.812815613957339, -11.836588626765257, -10.108415420024366, -3.2284670052876887, 11.034581972548104, 15.962284900313453, -14.645558503155572, 0.8246944710212336, -15.680811239489085, -3.8832460985158335, 12.11120907951913, 8.387697438124642, -0.8430345354487976, 21.423660199879038, 10.10186444496731, -2.237876120144284, -6.502047224750914, 4.32453696196149, 5.1096639149904455, -17.345357759639803, -13.516809565381923, -9.902872130562375, -5.695954082105349, -4.9158120229083275, 17.316622486702403, 10.232530109378859, -0.16102900773863205, 2.3705764753149943, 5.667951790290926, 1.6154251700902877, -16.889558955349422, 9.90819399434133, 1.9232427510822543, -29.757715747882592, 10.19699337841552, 21.572472946579776, -25.002402925353547, -20.883710493123946, 6.593380473219327, 11.332326945896952, 29.72124649003794, -12.971607791782027, 7.754204288377872, -18.431747372605518, 8.453208811764705, -35.47902454651848, -13.904660425816452, 18.920883729976456, 15.813228299236219, 14.920893861858207, 3.671290972635112, -35.01807631216486, -7.278671558661923, 3.3424181820536045, 17.061336340884374, 24.464435006492717, -6.356336710741166, 6.294501272211233, -2.0005943422473713, -4.458224598213191, 13.681003474301118, 6.021495230282974, 31.11044260552017], "episode_lengths": [400, 85, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 352, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 99, 8, 400], "policy_agent_policy_reward": [2.3230172763947214, -1.5795502851492436, -4.326150211194013, -7.68830576877939, 0.597229431989251, 8.092581011674913, 14.898222726092548, -9.11931701978818, 19.83922980799673, 11.605533193144229, 15.387404251646478, 9.98285110143166, 1.2301477180681637, 7.250718214619175, 20.524656162944655, 5.954640359835789, -9.81281561395734, 11.83658862676526, 10.108415420024372, 3.2284670052876887, -11.034581972548105, -15.962284900313403, 14.645558503155575, -0.8246944710212247, 15.68081123948909, 3.8832460985158317, -12.111209079519142, -8.387697438124643, 0.8430345354487976, -21.423660199879055, -10.10186444496731, 2.237876120144284, 6.5020472247509105, -4.32453696196149, -5.109663914990451, 17.345357759639803, 13.51680956538193, 9.902872130562375, 5.695954082105349, 4.915812022908328, -17.316622486702407, -10.232530109378859, 0.16102900773863205, -2.3705764753149996, -5.667951790290918, -1.615425170090294, 16.889558955349422, -9.908193994341335, -1.9232427510822463, 29.757715747882592, -10.196993378415515, -21.57247294657977, 25.00240292535355, 20.883710493123946, -6.593380473219332, -11.332326945896957, -29.72124649003792, 12.971607791782027, -7.754204288377869, 18.431747372605518, -8.453208811764709, 35.479024546518474, 13.904660425816452, -18.92088372997646, -15.813228299236226, -14.92089386185818, -3.671290972635111, 35.01807631216484, 7.278671558661923, -3.3424181820536045, -17.061336340884367, -24.464435006492778, 6.356336710741166, -6.294501272211231, 2.0005943422473704, 4.4582245982131985, -13.681003474301113, -6.021495230282974, -31.110442605520195], "policy_adversary_policy_reward": [-4.566855449128665, -0.0791791036607652, 4.834677678963554, -1.6755771086650668, 14.600852056183376, -5.94855163379534, 22.710394261700717, -7.33378272414193, -6.192706736283858, 4.998247872305356, -6.937519163459456, -9.24764285989037, 1.9053267754233403, -31.701772227608437, 5.23576489258128, 13.002869146995081, -27.94236740458276, -11.736092211410686, -11.191118487597905, -12.01994789869056, -14.836920131684646, -15.93788837160831, -20.437273473988313, 0.47157127112499353, -5.3770617996598915, 2.916766363523559, 4.377220462685969, -18.87865689192432, -34.0821466318629, -6.967165694026409, -7.373867396241458, -4.53541332343012, 12.95901742510926, 6.666613802805426, -24.061098366970107, 0.38792111343960123, -20.924190323409935, 0.707359483361186, -7.2507615374023295, 0.7938275268269521, 5.241972232004031, 16.82719171309217, 27.970622151433147, 3.9539476491936973, -10.922476286691683, -18.368640719619496, -15.049896080818513, 16.69928502286095, -18.981140130408132, -12.380482348570045, -1.350417156029529, -6.416075041002141, 6.792261168449365, 17.43015699058893, 18.280335007537452, -1.5049401312881727, 0.8256207379333773, -2.5116898088309725, 34.91320692202245, 7.934113477735659, 14.296473465123384, 5.907255424811236, 1.35144700597888, -5.827199246267448, -5.398362895684812, -7.605731553817014, 4.275138927969628, 4.373934995953352, -1.4216476301189154, 11.640975460099803, -20.150037190377983, -14.540678328901627, -23.23604179513527, -3.797577335628578, -17.219407475651263, -2.5863367854734918, -0.08636949967577578, -11.305538664534922, -4.771837305833966, -5.059786739982691, 1.3483834680400406, 33.28486150536479, 15.164844641879032, 5.300215576878685, 14.973652925328985, -15.295710940806249, 11.98514751702174, -7.243994566391741, 13.867466562525006, -2.531562981943157, 0.9439010144353475, 2.2869493257452334, -10.22331893809907, -23.555798972599774, 4.539818312892887, 15.276569675789782, -6.443939707886328, 10.290425210050817, -13.278935884311636, -46.23649561145355, 0.6829899881251151, 19.710996768705918, 14.28330272631136, 28.861643166848193, -14.292173814187333, -35.712632036519764, -24.666092349993477, -17.101328636254415, 13.590821056906345, -0.404060110467686, 12.579979873134313, 10.084674018659598, 28.337633491225574, 31.10485948885023, -11.461736507831418, -14.481479075732636, 4.567970889298241, 10.940437687457512, -7.300966378360378, -29.562528366850657, 11.675096533628782, 5.231321089900629, -36.485261338186014, -34.47278775485095, -8.188692056340798, -19.620628795292106, 19.894153905059856, 17.947613554893078, 19.99801401969809, 11.628442578774363, 11.618654888559204, 18.22313283515712, -5.40116061857146, 12.743742563841682, -41.48864287678995, -28.54750974753972, -0.05568973224752938, -14.501653385076317, 3.6044140128823585, 3.0804223512248505, 7.463279389221613, 26.65939329254711, 15.617179492547356, 33.31169052043815, -8.559732878417588, -4.152940543064747, 11.052349999581404, 1.536652544841071, 2.4494906069424474, -6.450679291437186, -2.828215971938665, -6.088233224487729, 18.173758250979823, 9.188248697622406, 8.24916180168208, 3.793828658883868, 39.127983671656665, 23.092901539383675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6350957564210511, "mean_inference_ms": 1.7759922391923448, "mean_action_processing_ms": 0.26567209149852794, "mean_env_wait_ms": 0.11662525470758144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006716311732424965, "StateBufferConnector_ms": 0.00574875481521027, "ViewRequirementAgentConnector_ms": 0.07707001287725908}, "num_episodes": 13, "episode_return_max": 31.11044260552017, "episode_return_min": -35.47902454651848, "episode_return_mean": -0.5677950001149193}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 525.289530150423, "num_env_steps_trained_throughput_per_sec": 525.289530150423, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 8505.479, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8505.267, "sample_time_ms": 1160.86, "learn_time_ms": 7324.955, "learn_throughput": 546.078, "synch_weights_time_ms": 17.667}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 8, "trial_id": "83a5c_00000", "date": "2024-08-10_12-15-03", "timestamp": 1723306503, "time_this_iter_s": 7.617945909500122, "time_total_s": 68.26581978797913, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 68.26581978797913, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 29.609090909090913, "ram_util_percent": 81.62727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.973783937932322, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.92475813217264, "policy_loss": -0.007606768424046182, "vf_loss": 4.930824815911591, "vf_explained_var": -0.0619542969913079, "kl": 0.015400650456242074, "entropy": 1.5507895395238565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1664389107997217, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.1274845210214455, "policy_loss": -0.009098028506074721, "vf_loss": 4.134401930868625, "vf_explained_var": 0.26569774802774193, "kl": 0.010903113002041312, "entropy": 1.3065361072619757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "env_runners": {"episode_reward_max": 31.11044260552017, "episode_reward_min": -38.06390256923187, "episode_reward_mean": -0.9134458914336574, "episode_len_mean": 377.97752808988764, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33640, "policy_reward_min": {"agent_policy": -31.110442605520195, "adversary_policy": -46.23649561145355}, "policy_reward_max": {"agent_policy": 38.06390256923191, "adversary_policy": 39.127983671656665}, "policy_reward_mean": {"agent_policy": 0.9134458914336577, "adversary_policy": -0.9134458914336586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.323017276394709, 1.579550285149244, 4.326150211194019, 7.68830576877939, -0.5972294319892537, -8.092581011674914, -14.898222726092545, 9.119317019788179, -19.839229807996727, -11.605533193144225, -15.387404251646476, -9.98285110143166, -1.2301477180681708, -7.250718214619177, -20.524656162944652, -5.954640359835789, 9.812815613957339, -11.836588626765257, -10.108415420024366, -3.2284670052876887, 11.034581972548104, 15.962284900313453, -14.645558503155572, 0.8246944710212336, -15.680811239489085, -3.8832460985158335, 12.11120907951913, 8.387697438124642, -0.8430345354487976, 21.423660199879038, 10.10186444496731, -2.237876120144284, -6.502047224750914, 4.32453696196149, 5.1096639149904455, -17.345357759639803, -13.516809565381923, -9.902872130562375, -5.695954082105349, -4.9158120229083275, 17.316622486702403, 10.232530109378859, -0.16102900773863205, 2.3705764753149943, 5.667951790290926, 1.6154251700902877, -16.889558955349422, 9.90819399434133, 1.9232427510822543, -29.757715747882592, 10.19699337841552, 21.572472946579776, -25.002402925353547, -20.883710493123946, 6.593380473219327, 11.332326945896952, 29.72124649003794, -12.971607791782027, 7.754204288377872, -18.431747372605518, 8.453208811764705, -35.47902454651848, -13.904660425816452, 18.920883729976456, 15.813228299236219, 14.920893861858207, 3.671290972635112, -35.01807631216486, -7.278671558661923, 3.3424181820536045, 17.061336340884374, 24.464435006492717, -6.356336710741166, 6.294501272211233, -2.0005943422473713, -4.458224598213191, 13.681003474301118, 6.021495230282974, 31.11044260552017, 3.728865746072363, -28.671383575624894, 5.760527159231852, 16.374713499133403, 14.188093447745093, -38.06390256923187, 9.243355568630982, 26.624666776316946, -14.638661763888287, -30.98715361690244], "episode_lengths": [400, 85, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 352, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 99, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [2.3230172763947214, -1.5795502851492436, -4.326150211194013, -7.68830576877939, 0.597229431989251, 8.092581011674913, 14.898222726092548, -9.11931701978818, 19.83922980799673, 11.605533193144229, 15.387404251646478, 9.98285110143166, 1.2301477180681637, 7.250718214619175, 20.524656162944655, 5.954640359835789, -9.81281561395734, 11.83658862676526, 10.108415420024372, 3.2284670052876887, -11.034581972548105, -15.962284900313403, 14.645558503155575, -0.8246944710212247, 15.68081123948909, 3.8832460985158317, -12.111209079519142, -8.387697438124643, 0.8430345354487976, -21.423660199879055, -10.10186444496731, 2.237876120144284, 6.5020472247509105, -4.32453696196149, -5.109663914990451, 17.345357759639803, 13.51680956538193, 9.902872130562375, 5.695954082105349, 4.915812022908328, -17.316622486702407, -10.232530109378859, 0.16102900773863205, -2.3705764753149996, -5.667951790290918, -1.615425170090294, 16.889558955349422, -9.908193994341335, -1.9232427510822463, 29.757715747882592, -10.196993378415515, -21.57247294657977, 25.00240292535355, 20.883710493123946, -6.593380473219332, -11.332326945896957, -29.72124649003792, 12.971607791782027, -7.754204288377869, 18.431747372605518, -8.453208811764709, 35.479024546518474, 13.904660425816452, -18.92088372997646, -15.813228299236226, -14.92089386185818, -3.671290972635111, 35.01807631216484, 7.278671558661923, -3.3424181820536045, -17.061336340884367, -24.464435006492778, 6.356336710741166, -6.294501272211231, 2.0005943422473704, 4.4582245982131985, -13.681003474301113, -6.021495230282974, -31.110442605520195, -3.7288657460723584, 28.671383575624876, -5.760527159231852, -16.374713499133435, -14.188093447745091, 38.06390256923191, -9.24335556863098, -26.62466677631695, 14.638661763888294, 30.987153616902454], "policy_adversary_policy_reward": [-4.566855449128665, -0.0791791036607652, 4.834677678963554, -1.6755771086650668, 14.600852056183376, -5.94855163379534, 22.710394261700717, -7.33378272414193, -6.192706736283858, 4.998247872305356, -6.937519163459456, -9.24764285989037, 1.9053267754233403, -31.701772227608437, 5.23576489258128, 13.002869146995081, -27.94236740458276, -11.736092211410686, -11.191118487597905, -12.01994789869056, -14.836920131684646, -15.93788837160831, -20.437273473988313, 0.47157127112499353, -5.3770617996598915, 2.916766363523559, 4.377220462685969, -18.87865689192432, -34.0821466318629, -6.967165694026409, -7.373867396241458, -4.53541332343012, 12.95901742510926, 6.666613802805426, -24.061098366970107, 0.38792111343960123, -20.924190323409935, 0.707359483361186, -7.2507615374023295, 0.7938275268269521, 5.241972232004031, 16.82719171309217, 27.970622151433147, 3.9539476491936973, -10.922476286691683, -18.368640719619496, -15.049896080818513, 16.69928502286095, -18.981140130408132, -12.380482348570045, -1.350417156029529, -6.416075041002141, 6.792261168449365, 17.43015699058893, 18.280335007537452, -1.5049401312881727, 0.8256207379333773, -2.5116898088309725, 34.91320692202245, 7.934113477735659, 14.296473465123384, 5.907255424811236, 1.35144700597888, -5.827199246267448, -5.398362895684812, -7.605731553817014, 4.275138927969628, 4.373934995953352, -1.4216476301189154, 11.640975460099803, -20.150037190377983, -14.540678328901627, -23.23604179513527, -3.797577335628578, -17.219407475651263, -2.5863367854734918, -0.08636949967577578, -11.305538664534922, -4.771837305833966, -5.059786739982691, 1.3483834680400406, 33.28486150536479, 15.164844641879032, 5.300215576878685, 14.973652925328985, -15.295710940806249, 11.98514751702174, -7.243994566391741, 13.867466562525006, -2.531562981943157, 0.9439010144353475, 2.2869493257452334, -10.22331893809907, -23.555798972599774, 4.539818312892887, 15.276569675789782, -6.443939707886328, 10.290425210050817, -13.278935884311636, -46.23649561145355, 0.6829899881251151, 19.710996768705918, 14.28330272631136, 28.861643166848193, -14.292173814187333, -35.712632036519764, -24.666092349993477, -17.101328636254415, 13.590821056906345, -0.404060110467686, 12.579979873134313, 10.084674018659598, 28.337633491225574, 31.10485948885023, -11.461736507831418, -14.481479075732636, 4.567970889298241, 10.940437687457512, -7.300966378360378, -29.562528366850657, 11.675096533628782, 5.231321089900629, -36.485261338186014, -34.47278775485095, -8.188692056340798, -19.620628795292106, 19.894153905059856, 17.947613554893078, 19.99801401969809, 11.628442578774363, 11.618654888559204, 18.22313283515712, -5.40116061857146, 12.743742563841682, -41.48864287678995, -28.54750974753972, -0.05568973224752938, -14.501653385076317, 3.6044140128823585, 3.0804223512248505, 7.463279389221613, 26.65939329254711, 15.617179492547356, 33.31169052043815, -8.559732878417588, -4.152940543064747, 11.052349999581404, 1.536652544841071, 2.4494906069424474, -6.450679291437186, -2.828215971938665, -6.088233224487729, 18.173758250979823, 9.188248697622406, 8.24916180168208, 3.793828658883868, 39.127983671656665, 23.092901539383675, 3.3895962462236504, 4.06813524592107, -24.022951266298243, -33.319815884951495, 3.195639885787852, 8.325414432675853, -0.6089845292005016, 33.35841152746734, 3.8562394800093838, 24.519947415480786, -38.811093306531674, -37.31671183193218, 14.655156688524352, 3.8315544487376183, 24.806418468202644, 28.442915084431235, -4.912003941153571, -24.365319586623006, -32.635786509576285, -29.33852072422863]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6224492042629886, "mean_inference_ms": 1.7371022547880366, "mean_action_processing_ms": 0.26085422809210057, "mean_env_wait_ms": 0.11439718671025152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006403146165140559, "StateBufferConnector_ms": 0.005367632662312368, "ViewRequirementAgentConnector_ms": 0.07549993107827861}, "num_episodes": 10, "episode_return_max": 31.11044260552017, "episode_return_min": -38.06390256923187, "episode_return_mean": -0.9134458914336574}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 546.3469635327459, "num_env_steps_trained_throughput_per_sec": 546.3469635327459, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 8373.91, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8373.718, "sample_time_ms": 1111.001, "learn_time_ms": 7244.295, "learn_throughput": 552.159, "synch_weights_time_ms": 16.79}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "training_iteration": 9, "trial_id": "83a5c_00000", "date": "2024-08-10_12-15-10", "timestamp": 1723306510, "time_this_iter_s": 7.323959112167358, "time_total_s": 75.58977890014648, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f60eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.58977890014648, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.740000000000002, "ram_util_percent": 81.69000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.892569069887595, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.018936407755292, "policy_loss": -0.005642018832571844, "vf_loss": 6.023069898413603, "vf_explained_var": -0.5100195809646889, "kl": 0.015085476322659393, "entropy": 1.5508478383538584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.137852554023266, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.7072065440317, "policy_loss": -0.003085217454160253, "vf_loss": 4.709228031585614, "vf_explained_var": 0.10539217932770649, "kl": 0.005318586658684351, "entropy": 1.1275649366279443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 31.11044260552017, "episode_reward_min": -42.08151695907603, "episode_reward_mean": -1.9640405212956762, "episode_len_mean": 380.4, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38040, "policy_reward_min": {"agent_policy": -31.110442605520195, "adversary_policy": -46.23649561145355}, "policy_reward_max": {"agent_policy": 42.081516959076026, "adversary_policy": 39.127983671656665}, "policy_reward_mean": {"agent_policy": 1.9640405212956766, "adversary_policy": -1.9640405212956784}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.579550285149244, 4.326150211194019, 7.68830576877939, -0.5972294319892537, -8.092581011674914, -14.898222726092545, 9.119317019788179, -19.839229807996727, -11.605533193144225, -15.387404251646476, -9.98285110143166, -1.2301477180681708, -7.250718214619177, -20.524656162944652, -5.954640359835789, 9.812815613957339, -11.836588626765257, -10.108415420024366, -3.2284670052876887, 11.034581972548104, 15.962284900313453, -14.645558503155572, 0.8246944710212336, -15.680811239489085, -3.8832460985158335, 12.11120907951913, 8.387697438124642, -0.8430345354487976, 21.423660199879038, 10.10186444496731, -2.237876120144284, -6.502047224750914, 4.32453696196149, 5.1096639149904455, -17.345357759639803, -13.516809565381923, -9.902872130562375, -5.695954082105349, -4.9158120229083275, 17.316622486702403, 10.232530109378859, -0.16102900773863205, 2.3705764753149943, 5.667951790290926, 1.6154251700902877, -16.889558955349422, 9.90819399434133, 1.9232427510822543, -29.757715747882592, 10.19699337841552, 21.572472946579776, -25.002402925353547, -20.883710493123946, 6.593380473219327, 11.332326945896952, 29.72124649003794, -12.971607791782027, 7.754204288377872, -18.431747372605518, 8.453208811764705, -35.47902454651848, -13.904660425816452, 18.920883729976456, 15.813228299236219, 14.920893861858207, 3.671290972635112, -35.01807631216486, -7.278671558661923, 3.3424181820536045, 17.061336340884374, 24.464435006492717, -6.356336710741166, 6.294501272211233, -2.0005943422473713, -4.458224598213191, 13.681003474301118, 6.021495230282974, 31.11044260552017, 3.728865746072363, -28.671383575624894, 5.760527159231852, 16.374713499133403, 14.188093447745093, -38.06390256923187, 9.243355568630982, 26.624666776316946, -14.638661763888287, -30.98715361690244, 14.009038762498337, 20.196399515397097, -33.32738562494926, -32.53659948488969, -41.94059570245023, 5.025486177844239, -25.643727739794485, -12.311365753694602, 12.932067780646983, 3.763036350245269, 14.484777609855534, -42.08151695907603], "episode_lengths": [85, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 352, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 99, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-1.5795502851492436, -4.326150211194013, -7.68830576877939, 0.597229431989251, 8.092581011674913, 14.898222726092548, -9.11931701978818, 19.83922980799673, 11.605533193144229, 15.387404251646478, 9.98285110143166, 1.2301477180681637, 7.250718214619175, 20.524656162944655, 5.954640359835789, -9.81281561395734, 11.83658862676526, 10.108415420024372, 3.2284670052876887, -11.034581972548105, -15.962284900313403, 14.645558503155575, -0.8246944710212247, 15.68081123948909, 3.8832460985158317, -12.111209079519142, -8.387697438124643, 0.8430345354487976, -21.423660199879055, -10.10186444496731, 2.237876120144284, 6.5020472247509105, -4.32453696196149, -5.109663914990451, 17.345357759639803, 13.51680956538193, 9.902872130562375, 5.695954082105349, 4.915812022908328, -17.316622486702407, -10.232530109378859, 0.16102900773863205, -2.3705764753149996, -5.667951790290918, -1.615425170090294, 16.889558955349422, -9.908193994341335, -1.9232427510822463, 29.757715747882592, -10.196993378415515, -21.57247294657977, 25.00240292535355, 20.883710493123946, -6.593380473219332, -11.332326945896957, -29.72124649003792, 12.971607791782027, -7.754204288377869, 18.431747372605518, -8.453208811764709, 35.479024546518474, 13.904660425816452, -18.92088372997646, -15.813228299236226, -14.92089386185818, -3.671290972635111, 35.01807631216484, 7.278671558661923, -3.3424181820536045, -17.061336340884367, -24.464435006492778, 6.356336710741166, -6.294501272211231, 2.0005943422473704, 4.4582245982131985, -13.681003474301113, -6.021495230282974, -31.110442605520195, -3.7288657460723584, 28.671383575624876, -5.760527159231852, -16.374713499133435, -14.188093447745091, 38.06390256923191, -9.24335556863098, -26.62466677631695, 14.638661763888294, 30.987153616902454, -14.009038762498314, -20.196399515397093, 33.32738562494929, 32.53659948488969, 41.94059570245024, -5.025486177844239, 25.643727739794485, 12.311365753694602, -12.932067780647, -3.763036350245269, -14.484777609855525, 42.081516959076026], "policy_adversary_policy_reward": [4.834677678963554, -1.6755771086650668, 14.600852056183376, -5.94855163379534, 22.710394261700717, -7.33378272414193, -6.192706736283858, 4.998247872305356, -6.937519163459456, -9.24764285989037, 1.9053267754233403, -31.701772227608437, 5.23576489258128, 13.002869146995081, -27.94236740458276, -11.736092211410686, -11.191118487597905, -12.01994789869056, -14.836920131684646, -15.93788837160831, -20.437273473988313, 0.47157127112499353, -5.3770617996598915, 2.916766363523559, 4.377220462685969, -18.87865689192432, -34.0821466318629, -6.967165694026409, -7.373867396241458, -4.53541332343012, 12.95901742510926, 6.666613802805426, -24.061098366970107, 0.38792111343960123, -20.924190323409935, 0.707359483361186, -7.2507615374023295, 0.7938275268269521, 5.241972232004031, 16.82719171309217, 27.970622151433147, 3.9539476491936973, -10.922476286691683, -18.368640719619496, -15.049896080818513, 16.69928502286095, -18.981140130408132, -12.380482348570045, -1.350417156029529, -6.416075041002141, 6.792261168449365, 17.43015699058893, 18.280335007537452, -1.5049401312881727, 0.8256207379333773, -2.5116898088309725, 34.91320692202245, 7.934113477735659, 14.296473465123384, 5.907255424811236, 1.35144700597888, -5.827199246267448, -5.398362895684812, -7.605731553817014, 4.275138927969628, 4.373934995953352, -1.4216476301189154, 11.640975460099803, -20.150037190377983, -14.540678328901627, -23.23604179513527, -3.797577335628578, -17.219407475651263, -2.5863367854734918, -0.08636949967577578, -11.305538664534922, -4.771837305833966, -5.059786739982691, 1.3483834680400406, 33.28486150536479, 15.164844641879032, 5.300215576878685, 14.973652925328985, -15.295710940806249, 11.98514751702174, -7.243994566391741, 13.867466562525006, -2.531562981943157, 0.9439010144353475, 2.2869493257452334, -10.22331893809907, -23.555798972599774, 4.539818312892887, 15.276569675789782, -6.443939707886328, 10.290425210050817, -13.278935884311636, -46.23649561145355, 0.6829899881251151, 19.710996768705918, 14.28330272631136, 28.861643166848193, -14.292173814187333, -35.712632036519764, -24.666092349993477, -17.101328636254415, 13.590821056906345, -0.404060110467686, 12.579979873134313, 10.084674018659598, 28.337633491225574, 31.10485948885023, -11.461736507831418, -14.481479075732636, 4.567970889298241, 10.940437687457512, -7.300966378360378, -29.562528366850657, 11.675096533628782, 5.231321089900629, -36.485261338186014, -34.47278775485095, -8.188692056340798, -19.620628795292106, 19.894153905059856, 17.947613554893078, 19.99801401969809, 11.628442578774363, 11.618654888559204, 18.22313283515712, -5.40116061857146, 12.743742563841682, -41.48864287678995, -28.54750974753972, -0.05568973224752938, -14.501653385076317, 3.6044140128823585, 3.0804223512248505, 7.463279389221613, 26.65939329254711, 15.617179492547356, 33.31169052043815, -8.559732878417588, -4.152940543064747, 11.052349999581404, 1.536652544841071, 2.4494906069424474, -6.450679291437186, -2.828215971938665, -6.088233224487729, 18.173758250979823, 9.188248697622406, 8.24916180168208, 3.793828658883868, 39.127983671656665, 23.092901539383675, 3.3895962462236504, 4.06813524592107, -24.022951266298243, -33.319815884951495, 3.195639885787852, 8.325414432675853, -0.6089845292005016, 33.35841152746734, 3.8562394800093838, 24.519947415480786, -38.811093306531674, -37.31671183193218, 14.655156688524352, 3.8315544487376183, 24.806418468202644, 28.442915084431235, -4.912003941153571, -24.365319586623006, -32.635786509576285, -29.33852072422863, 9.137048131868754, 18.881029393127875, 26.863120399816953, 13.529678630977216, -23.965430100224417, -42.6893411496742, -31.3832862592157, -33.68991271056366, -41.83603902997241, -42.04515237492797, 2.6735990233121445, 7.377373332376333, -39.77872843537869, -11.508727044210282, -16.2907929158064, -8.331938591582805, 5.135985334556899, 20.728150226737057, -12.47517414140913, 20.001246841899682, 6.968987873742959, 22.00056734596804, -40.35215625434513, -43.810877663807005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6062219624260295, "mean_inference_ms": 1.6874945066459475, "mean_action_processing_ms": 0.2549661479043042, "mean_env_wait_ms": 0.11169703814522118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006044864654541016, "StateBufferConnector_ms": 0.005048990249633789, "ViewRequirementAgentConnector_ms": 0.07468032836914062}, "num_episodes": 12, "episode_return_max": 31.11044260552017, "episode_return_min": -42.08151695907603, "episode_return_mean": -1.9640405212956762}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 522.1122440669197, "num_env_steps_trained_throughput_per_sec": 522.1122440669197, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 8302.641, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8302.457, "sample_time_ms": 1079.494, "learn_time_ms": 7204.442, "learn_throughput": 555.213, "synch_weights_time_ms": 16.846}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 10, "trial_id": "83a5c_00000", "date": "2024-08-10_12-15-18", "timestamp": 1723306518, "time_this_iter_s": 7.685369968414307, "time_total_s": 83.27514886856079, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 83.27514886856079, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 32.79090909090909, "ram_util_percent": 81.88181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.082442973498945, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.710631947794919, "policy_loss": -0.013850809071488954, "vf_loss": 5.72172603304424, "vf_explained_var": -0.06669000529107594, "kl": 0.027567331818992697, "entropy": 1.5584580159691908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.499222348195811, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.321124920497338, "policy_loss": -0.0054256984493501175, "vf_loss": 4.325080808252096, "vf_explained_var": -0.02882285453379154, "kl": 0.00734915748053346, "entropy": 1.0417328291883072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "env_runners": {"episode_reward_max": 31.11044260552017, "episode_reward_min": -42.08151695907603, "episode_reward_mean": -3.1956306595482302, "episode_len_mean": 375.85, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37585, "policy_reward_min": {"agent_policy": -31.110442605520195, "adversary_policy": -46.23649561145355}, "policy_reward_max": {"agent_policy": 42.081516959076026, "adversary_policy": 39.127983671656665}, "policy_reward_mean": {"agent_policy": 3.195630659548231, "adversary_policy": -3.195630659548233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.250718214619177, -20.524656162944652, -5.954640359835789, 9.812815613957339, -11.836588626765257, -10.108415420024366, -3.2284670052876887, 11.034581972548104, 15.962284900313453, -14.645558503155572, 0.8246944710212336, -15.680811239489085, -3.8832460985158335, 12.11120907951913, 8.387697438124642, -0.8430345354487976, 21.423660199879038, 10.10186444496731, -2.237876120144284, -6.502047224750914, 4.32453696196149, 5.1096639149904455, -17.345357759639803, -13.516809565381923, -9.902872130562375, -5.695954082105349, -4.9158120229083275, 17.316622486702403, 10.232530109378859, -0.16102900773863205, 2.3705764753149943, 5.667951790290926, 1.6154251700902877, -16.889558955349422, 9.90819399434133, 1.9232427510822543, -29.757715747882592, 10.19699337841552, 21.572472946579776, -25.002402925353547, -20.883710493123946, 6.593380473219327, 11.332326945896952, 29.72124649003794, -12.971607791782027, 7.754204288377872, -18.431747372605518, 8.453208811764705, -35.47902454651848, -13.904660425816452, 18.920883729976456, 15.813228299236219, 14.920893861858207, 3.671290972635112, -35.01807631216486, -7.278671558661923, 3.3424181820536045, 17.061336340884374, 24.464435006492717, -6.356336710741166, 6.294501272211233, -2.0005943422473713, -4.458224598213191, 13.681003474301118, 6.021495230282974, 31.11044260552017, 3.728865746072363, -28.671383575624894, 5.760527159231852, 16.374713499133403, 14.188093447745093, -38.06390256923187, 9.243355568630982, 26.624666776316946, -14.638661763888287, -30.98715361690244, 14.009038762498337, 20.196399515397097, -33.32738562494926, -32.53659948488969, -41.94059570245023, 5.025486177844239, -25.643727739794485, -12.311365753694602, 12.932067780646983, 3.763036350245269, 14.484777609855534, -42.08151695907603, -25.996800334434415, -19.399029098147672, 10.042450533194048, -19.247027667265254, -18.03352662799239, -17.000812592196635, 9.397242556118819, -15.27783282273154, 0.3211514745736881, -29.205088032835402, -25.314317666226682, -32.3652995044451], "episode_lengths": [400, 400, 400, 352, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 99, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 2, 400, 400, 400], "policy_agent_policy_reward": [7.250718214619175, 20.524656162944655, 5.954640359835789, -9.81281561395734, 11.83658862676526, 10.108415420024372, 3.2284670052876887, -11.034581972548105, -15.962284900313403, 14.645558503155575, -0.8246944710212247, 15.68081123948909, 3.8832460985158317, -12.111209079519142, -8.387697438124643, 0.8430345354487976, -21.423660199879055, -10.10186444496731, 2.237876120144284, 6.5020472247509105, -4.32453696196149, -5.109663914990451, 17.345357759639803, 13.51680956538193, 9.902872130562375, 5.695954082105349, 4.915812022908328, -17.316622486702407, -10.232530109378859, 0.16102900773863205, -2.3705764753149996, -5.667951790290918, -1.615425170090294, 16.889558955349422, -9.908193994341335, -1.9232427510822463, 29.757715747882592, -10.196993378415515, -21.57247294657977, 25.00240292535355, 20.883710493123946, -6.593380473219332, -11.332326945896957, -29.72124649003792, 12.971607791782027, -7.754204288377869, 18.431747372605518, -8.453208811764709, 35.479024546518474, 13.904660425816452, -18.92088372997646, -15.813228299236226, -14.92089386185818, -3.671290972635111, 35.01807631216484, 7.278671558661923, -3.3424181820536045, -17.061336340884367, -24.464435006492778, 6.356336710741166, -6.294501272211231, 2.0005943422473704, 4.4582245982131985, -13.681003474301113, -6.021495230282974, -31.110442605520195, -3.7288657460723584, 28.671383575624876, -5.760527159231852, -16.374713499133435, -14.188093447745091, 38.06390256923191, -9.24335556863098, -26.62466677631695, 14.638661763888294, 30.987153616902454, -14.009038762498314, -20.196399515397093, 33.32738562494929, 32.53659948488969, 41.94059570245024, -5.025486177844239, 25.643727739794485, 12.311365753694602, -12.932067780647, -3.763036350245269, -14.484777609855525, 42.081516959076026, 25.996800334434415, 19.399029098147672, -10.042450533194048, 19.247027667265254, 18.03352662799239, 17.000812592196635, -9.397242556118815, 15.27783282273154, -0.3211514745736881, 29.205088032835427, 25.31431766622669, 32.365299504445076], "policy_adversary_policy_reward": [4.377220462685969, -18.87865689192432, -34.0821466318629, -6.967165694026409, -7.373867396241458, -4.53541332343012, 12.95901742510926, 6.666613802805426, -24.061098366970107, 0.38792111343960123, -20.924190323409935, 0.707359483361186, -7.2507615374023295, 0.7938275268269521, 5.241972232004031, 16.82719171309217, 27.970622151433147, 3.9539476491936973, -10.922476286691683, -18.368640719619496, -15.049896080818513, 16.69928502286095, -18.981140130408132, -12.380482348570045, -1.350417156029529, -6.416075041002141, 6.792261168449365, 17.43015699058893, 18.280335007537452, -1.5049401312881727, 0.8256207379333773, -2.5116898088309725, 34.91320692202245, 7.934113477735659, 14.296473465123384, 5.907255424811236, 1.35144700597888, -5.827199246267448, -5.398362895684812, -7.605731553817014, 4.275138927969628, 4.373934995953352, -1.4216476301189154, 11.640975460099803, -20.150037190377983, -14.540678328901627, -23.23604179513527, -3.797577335628578, -17.219407475651263, -2.5863367854734918, -0.08636949967577578, -11.305538664534922, -4.771837305833966, -5.059786739982691, 1.3483834680400406, 33.28486150536479, 15.164844641879032, 5.300215576878685, 14.973652925328985, -15.295710940806249, 11.98514751702174, -7.243994566391741, 13.867466562525006, -2.531562981943157, 0.9439010144353475, 2.2869493257452334, -10.22331893809907, -23.555798972599774, 4.539818312892887, 15.276569675789782, -6.443939707886328, 10.290425210050817, -13.278935884311636, -46.23649561145355, 0.6829899881251151, 19.710996768705918, 14.28330272631136, 28.861643166848193, -14.292173814187333, -35.712632036519764, -24.666092349993477, -17.101328636254415, 13.590821056906345, -0.404060110467686, 12.579979873134313, 10.084674018659598, 28.337633491225574, 31.10485948885023, -11.461736507831418, -14.481479075732636, 4.567970889298241, 10.940437687457512, -7.300966378360378, -29.562528366850657, 11.675096533628782, 5.231321089900629, -36.485261338186014, -34.47278775485095, -8.188692056340798, -19.620628795292106, 19.894153905059856, 17.947613554893078, 19.99801401969809, 11.628442578774363, 11.618654888559204, 18.22313283515712, -5.40116061857146, 12.743742563841682, -41.48864287678995, -28.54750974753972, -0.05568973224752938, -14.501653385076317, 3.6044140128823585, 3.0804223512248505, 7.463279389221613, 26.65939329254711, 15.617179492547356, 33.31169052043815, -8.559732878417588, -4.152940543064747, 11.052349999581404, 1.536652544841071, 2.4494906069424474, -6.450679291437186, -2.828215971938665, -6.088233224487729, 18.173758250979823, 9.188248697622406, 8.24916180168208, 3.793828658883868, 39.127983671656665, 23.092901539383675, 3.3895962462236504, 4.06813524592107, -24.022951266298243, -33.319815884951495, 3.195639885787852, 8.325414432675853, -0.6089845292005016, 33.35841152746734, 3.8562394800093838, 24.519947415480786, -38.811093306531674, -37.31671183193218, 14.655156688524352, 3.8315544487376183, 24.806418468202644, 28.442915084431235, -4.912003941153571, -24.365319586623006, -32.635786509576285, -29.33852072422863, 9.137048131868754, 18.881029393127875, 26.863120399816953, 13.529678630977216, -23.965430100224417, -42.6893411496742, -31.3832862592157, -33.68991271056366, -41.83603902997241, -42.04515237492797, 2.6735990233121445, 7.377373332376333, -39.77872843537869, -11.508727044210282, -16.2907929158064, -8.331938591582805, 5.135985334556899, 20.728150226737057, -12.47517414140913, 20.001246841899682, 6.968987873742959, 22.00056734596804, -40.35215625434513, -43.810877663807005, -12.46365604334467, -39.52994462552416, -31.604665514380258, -7.1933926819150855, 18.58630878020084, 1.4985922861872538, -25.071857104411787, -13.422198230118717, -5.836809100292911, -30.23024415569187, -12.117085306082103, -21.88453987831117, 22.491758507719997, -3.6972733954823607, -16.766817394142368, -13.788848251320715, -1.240667371845415, 1.8829703209927913, -25.863605577310935, -32.546570488359905, -30.453843332295676, -20.17479200015769, -34.11711149829263, -30.613487510597537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5660466282687284, "mean_inference_ms": 1.5902131438443896, "mean_action_processing_ms": 0.24094465338616394, "mean_env_wait_ms": 0.10626960311636686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005759477615356445, "StateBufferConnector_ms": 0.005046367645263672, "ViewRequirementAgentConnector_ms": 0.0712885856628418}, "num_episodes": 12, "episode_return_max": 31.11044260552017, "episode_return_min": -42.08151695907603, "episode_return_mean": -3.1956306595482302}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 528.4806350581545, "num_env_steps_trained_throughput_per_sec": 528.4806350581545, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 8136.253, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8136.069, "sample_time_ms": 969.203, "learn_time_ms": 7148.32, "learn_throughput": 559.572, "synch_weights_time_ms": 16.888}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "training_iteration": 11, "trial_id": "83a5c_00000", "date": "2024-08-10_12-15-26", "timestamp": 1723306526, "time_this_iter_s": 7.571730136871338, "time_total_s": 90.84687900543213, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.84687900543213, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 28.218181818181822, "ram_util_percent": 81.37272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9308622777304323, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.312103588366635, "policy_loss": -0.005221260395689459, "vf_loss": 5.316079526729685, "vf_explained_var": 0.05739801207547465, "kl": 0.008302164604544781, "entropy": 1.5726589053396194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.358040111884475, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.60965007469058, "policy_loss": -0.005544548821732557, "vf_loss": 4.613632668306431, "vf_explained_var": 0.014229241261879603, "kl": 0.007809799796657554, "entropy": 1.076606893291076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 31.11044260552017, "episode_reward_min": -42.08151695907603, "episode_reward_mean": -3.579231396059472, "episode_len_mean": 376.33, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37633, "policy_reward_min": {"agent_policy": -31.110442605520195, "adversary_policy": -46.23649561145355}, "policy_reward_max": {"agent_policy": 42.081516959076026, "adversary_policy": 39.127983671656665}, "policy_reward_mean": {"agent_policy": 3.5792313960594724, "adversary_policy": -3.5792313960594733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.680811239489085, -3.8832460985158335, 12.11120907951913, 8.387697438124642, -0.8430345354487976, 21.423660199879038, 10.10186444496731, -2.237876120144284, -6.502047224750914, 4.32453696196149, 5.1096639149904455, -17.345357759639803, -13.516809565381923, -9.902872130562375, -5.695954082105349, -4.9158120229083275, 17.316622486702403, 10.232530109378859, -0.16102900773863205, 2.3705764753149943, 5.667951790290926, 1.6154251700902877, -16.889558955349422, 9.90819399434133, 1.9232427510822543, -29.757715747882592, 10.19699337841552, 21.572472946579776, -25.002402925353547, -20.883710493123946, 6.593380473219327, 11.332326945896952, 29.72124649003794, -12.971607791782027, 7.754204288377872, -18.431747372605518, 8.453208811764705, -35.47902454651848, -13.904660425816452, 18.920883729976456, 15.813228299236219, 14.920893861858207, 3.671290972635112, -35.01807631216486, -7.278671558661923, 3.3424181820536045, 17.061336340884374, 24.464435006492717, -6.356336710741166, 6.294501272211233, -2.0005943422473713, -4.458224598213191, 13.681003474301118, 6.021495230282974, 31.11044260552017, 3.728865746072363, -28.671383575624894, 5.760527159231852, 16.374713499133403, 14.188093447745093, -38.06390256923187, 9.243355568630982, 26.624666776316946, -14.638661763888287, -30.98715361690244, 14.009038762498337, 20.196399515397097, -33.32738562494926, -32.53659948488969, -41.94059570245023, 5.025486177844239, -25.643727739794485, -12.311365753694602, 12.932067780646983, 3.763036350245269, 14.484777609855534, -42.08151695907603, -25.996800334434415, -19.399029098147672, 10.042450533194048, -19.247027667265254, -18.03352662799239, -17.000812592196635, 9.397242556118819, -15.27783282273154, 0.3211514745736881, -29.205088032835402, -25.314317666226682, -32.3652995044451, -18.158010809632902, -10.07435107646715, -18.59014565697907, -5.014040577848752, 0.20946847263772028, 9.131689770415912, -5.900958595476814, -11.809503251872526, -5.078677928619468, -5.159565834907058, -3.8306454971663957], "episode_lengths": [400, 400, 400, 125, 400, 165, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 99, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [15.68081123948909, 3.8832460985158317, -12.111209079519142, -8.387697438124643, 0.8430345354487976, -21.423660199879055, -10.10186444496731, 2.237876120144284, 6.5020472247509105, -4.32453696196149, -5.109663914990451, 17.345357759639803, 13.51680956538193, 9.902872130562375, 5.695954082105349, 4.915812022908328, -17.316622486702407, -10.232530109378859, 0.16102900773863205, -2.3705764753149996, -5.667951790290918, -1.615425170090294, 16.889558955349422, -9.908193994341335, -1.9232427510822463, 29.757715747882592, -10.196993378415515, -21.57247294657977, 25.00240292535355, 20.883710493123946, -6.593380473219332, -11.332326945896957, -29.72124649003792, 12.971607791782027, -7.754204288377869, 18.431747372605518, -8.453208811764709, 35.479024546518474, 13.904660425816452, -18.92088372997646, -15.813228299236226, -14.92089386185818, -3.671290972635111, 35.01807631216484, 7.278671558661923, -3.3424181820536045, -17.061336340884367, -24.464435006492778, 6.356336710741166, -6.294501272211231, 2.0005943422473704, 4.4582245982131985, -13.681003474301113, -6.021495230282974, -31.110442605520195, -3.7288657460723584, 28.671383575624876, -5.760527159231852, -16.374713499133435, -14.188093447745091, 38.06390256923191, -9.24335556863098, -26.62466677631695, 14.638661763888294, 30.987153616902454, -14.009038762498314, -20.196399515397093, 33.32738562494929, 32.53659948488969, 41.94059570245024, -5.025486177844239, 25.643727739794485, 12.311365753694602, -12.932067780647, -3.763036350245269, -14.484777609855525, 42.081516959076026, 25.996800334434415, 19.399029098147672, -10.042450533194048, 19.247027667265254, 18.03352662799239, 17.000812592196635, -9.397242556118815, 15.27783282273154, -0.3211514745736881, 29.205088032835427, 25.31431766622669, 32.365299504445076, 18.158010809632934, 10.07435107646715, 18.590145656979065, 5.014040577848752, -0.20946847263772028, -9.131689770415912, 5.900958595476814, 11.809503251872524, 5.07867792861947, 5.159565834907058, 3.8306454971663957], "policy_adversary_policy_reward": [-18.981140130408132, -12.380482348570045, -1.350417156029529, -6.416075041002141, 6.792261168449365, 17.43015699058893, 18.280335007537452, -1.5049401312881727, 0.8256207379333773, -2.5116898088309725, 34.91320692202245, 7.934113477735659, 14.296473465123384, 5.907255424811236, 1.35144700597888, -5.827199246267448, -5.398362895684812, -7.605731553817014, 4.275138927969628, 4.373934995953352, -1.4216476301189154, 11.640975460099803, -20.150037190377983, -14.540678328901627, -23.23604179513527, -3.797577335628578, -17.219407475651263, -2.5863367854734918, -0.08636949967577578, -11.305538664534922, -4.771837305833966, -5.059786739982691, 1.3483834680400406, 33.28486150536479, 15.164844641879032, 5.300215576878685, 14.973652925328985, -15.295710940806249, 11.98514751702174, -7.243994566391741, 13.867466562525006, -2.531562981943157, 0.9439010144353475, 2.2869493257452334, -10.22331893809907, -23.555798972599774, 4.539818312892887, 15.276569675789782, -6.443939707886328, 10.290425210050817, -13.278935884311636, -46.23649561145355, 0.6829899881251151, 19.710996768705918, 14.28330272631136, 28.861643166848193, -14.292173814187333, -35.712632036519764, -24.666092349993477, -17.101328636254415, 13.590821056906345, -0.404060110467686, 12.579979873134313, 10.084674018659598, 28.337633491225574, 31.10485948885023, -11.461736507831418, -14.481479075732636, 4.567970889298241, 10.940437687457512, -7.300966378360378, -29.562528366850657, 11.675096533628782, 5.231321089900629, -36.485261338186014, -34.47278775485095, -8.188692056340798, -19.620628795292106, 19.894153905059856, 17.947613554893078, 19.99801401969809, 11.628442578774363, 11.618654888559204, 18.22313283515712, -5.40116061857146, 12.743742563841682, -41.48864287678995, -28.54750974753972, -0.05568973224752938, -14.501653385076317, 3.6044140128823585, 3.0804223512248505, 7.463279389221613, 26.65939329254711, 15.617179492547356, 33.31169052043815, -8.559732878417588, -4.152940543064747, 11.052349999581404, 1.536652544841071, 2.4494906069424474, -6.450679291437186, -2.828215971938665, -6.088233224487729, 18.173758250979823, 9.188248697622406, 8.24916180168208, 3.793828658883868, 39.127983671656665, 23.092901539383675, 3.3895962462236504, 4.06813524592107, -24.022951266298243, -33.319815884951495, 3.195639885787852, 8.325414432675853, -0.6089845292005016, 33.35841152746734, 3.8562394800093838, 24.519947415480786, -38.811093306531674, -37.31671183193218, 14.655156688524352, 3.8315544487376183, 24.806418468202644, 28.442915084431235, -4.912003941153571, -24.365319586623006, -32.635786509576285, -29.33852072422863, 9.137048131868754, 18.881029393127875, 26.863120399816953, 13.529678630977216, -23.965430100224417, -42.6893411496742, -31.3832862592157, -33.68991271056366, -41.83603902997241, -42.04515237492797, 2.6735990233121445, 7.377373332376333, -39.77872843537869, -11.508727044210282, -16.2907929158064, -8.331938591582805, 5.135985334556899, 20.728150226737057, -12.47517414140913, 20.001246841899682, 6.968987873742959, 22.00056734596804, -40.35215625434513, -43.810877663807005, -12.46365604334467, -39.52994462552416, -31.604665514380258, -7.1933926819150855, 18.58630878020084, 1.4985922861872538, -25.071857104411787, -13.422198230118717, -5.836809100292911, -30.23024415569187, -12.117085306082103, -21.88453987831117, 22.491758507719997, -3.6972733954823607, -16.766817394142368, -13.788848251320715, -1.240667371845415, 1.8829703209927913, -25.863605577310935, -32.546570488359905, -30.453843332295676, -20.17479200015769, -34.11711149829263, -30.613487510597537, -10.0102058193539, -26.30581579991196, -13.860987072719755, -6.2877150802145465, -5.181146333195542, -31.999144980762594, -13.57453626730619, 3.54645511160869, 11.70420972327507, -11.285272777999634, 7.1823706584760565, 11.081008882355768, -19.302258955955434, 7.5003417650018065, -25.266767866749284, 1.647761363004232, 7.431766946916767, -17.589122804155707, -9.264966520864132, -1.0541651489499841, 3.0574150630816597, -10.718706057414451]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5467869328520751, "mean_inference_ms": 1.5209317700715803, "mean_action_processing_ms": 0.23343009991655678, "mean_env_wait_ms": 0.1026508184761727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005456328392028809, "StateBufferConnector_ms": 0.004959702491760254, "ViewRequirementAgentConnector_ms": 0.06983554363250732}, "num_episodes": 11, "episode_return_max": 31.11044260552017, "episode_return_min": -42.08151695907603, "episode_return_mean": -3.579231396059472}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 538.8040547397575, "num_env_steps_trained_throughput_per_sec": 538.8040547397575, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 7972.52, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7972.409, "sample_time_ms": 957.625, "learn_time_ms": 7000.739, "learn_throughput": 571.368, "synch_weights_time_ms": 13.114}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 12, "trial_id": "83a5c_00000", "date": "2024-08-10_12-15-33", "timestamp": 1723306533, "time_this_iter_s": 7.4265968799591064, "time_total_s": 98.27347588539124, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61a0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 98.27347588539124, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 28.01, "ram_util_percent": 80.53}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.072317530112292, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.212267868859428, "policy_loss": -0.008359135347467763, "vf_loss": 4.218263897820124, "vf_explained_var": -0.061963226650127025, "kl": 0.015754084214329264, "entropy": 1.5632587183089484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.076528715994209, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.069060533245405, "policy_loss": -0.006099785706707431, "vf_loss": 4.073528770109018, "vf_explained_var": 0.06713964895655712, "kl": 0.008157772179597107, "entropy": 1.051246561606725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "env_runners": {"episode_reward_max": 31.11044260552017, "episode_reward_min": -42.08151695907603, "episode_reward_mean": -4.496308542263755, "episode_len_mean": 381.43, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38143, "policy_reward_min": {"agent_policy": -31.110442605520195, "adversary_policy": -46.23649561145355}, "policy_reward_max": {"agent_policy": 42.081516959076026, "adversary_policy": 39.127983671656665}, "policy_reward_mean": {"agent_policy": 4.496308542263756, "adversary_policy": -4.4963085422637565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.1096639149904455, -17.345357759639803, -13.516809565381923, -9.902872130562375, -5.695954082105349, -4.9158120229083275, 17.316622486702403, 10.232530109378859, -0.16102900773863205, 2.3705764753149943, 5.667951790290926, 1.6154251700902877, -16.889558955349422, 9.90819399434133, 1.9232427510822543, -29.757715747882592, 10.19699337841552, 21.572472946579776, -25.002402925353547, -20.883710493123946, 6.593380473219327, 11.332326945896952, 29.72124649003794, -12.971607791782027, 7.754204288377872, -18.431747372605518, 8.453208811764705, -35.47902454651848, -13.904660425816452, 18.920883729976456, 15.813228299236219, 14.920893861858207, 3.671290972635112, -35.01807631216486, -7.278671558661923, 3.3424181820536045, 17.061336340884374, 24.464435006492717, -6.356336710741166, 6.294501272211233, -2.0005943422473713, -4.458224598213191, 13.681003474301118, 6.021495230282974, 31.11044260552017, 3.728865746072363, -28.671383575624894, 5.760527159231852, 16.374713499133403, 14.188093447745093, -38.06390256923187, 9.243355568630982, 26.624666776316946, -14.638661763888287, -30.98715361690244, 14.009038762498337, 20.196399515397097, -33.32738562494926, -32.53659948488969, -41.94059570245023, 5.025486177844239, -25.643727739794485, -12.311365753694602, 12.932067780646983, 3.763036350245269, 14.484777609855534, -42.08151695907603, -25.996800334434415, -19.399029098147672, 10.042450533194048, -19.247027667265254, -18.03352662799239, -17.000812592196635, 9.397242556118819, -15.27783282273154, 0.3211514745736881, -29.205088032835402, -25.314317666226682, -32.3652995044451, -18.158010809632902, -10.07435107646715, -18.59014565697907, -5.014040577848752, 0.20946847263772028, 9.131689770415912, -5.900958595476814, -11.809503251872526, -5.078677928619468, -5.159565834907058, -3.8306454971663957, -5.326159847071571, -1.8596626143783705, -16.641246036360556, -6.656450648608191, -10.07045276018505, -15.606212837247146, -11.457891601370532, -11.082084360061879, 5.966107506067278, 8.228291484890432], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 99, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-5.109663914990451, 17.345357759639803, 13.51680956538193, 9.902872130562375, 5.695954082105349, 4.915812022908328, -17.316622486702407, -10.232530109378859, 0.16102900773863205, -2.3705764753149996, -5.667951790290918, -1.615425170090294, 16.889558955349422, -9.908193994341335, -1.9232427510822463, 29.757715747882592, -10.196993378415515, -21.57247294657977, 25.00240292535355, 20.883710493123946, -6.593380473219332, -11.332326945896957, -29.72124649003792, 12.971607791782027, -7.754204288377869, 18.431747372605518, -8.453208811764709, 35.479024546518474, 13.904660425816452, -18.92088372997646, -15.813228299236226, -14.92089386185818, -3.671290972635111, 35.01807631216484, 7.278671558661923, -3.3424181820536045, -17.061336340884367, -24.464435006492778, 6.356336710741166, -6.294501272211231, 2.0005943422473704, 4.4582245982131985, -13.681003474301113, -6.021495230282974, -31.110442605520195, -3.7288657460723584, 28.671383575624876, -5.760527159231852, -16.374713499133435, -14.188093447745091, 38.06390256923191, -9.24335556863098, -26.62466677631695, 14.638661763888294, 30.987153616902454, -14.009038762498314, -20.196399515397093, 33.32738562494929, 32.53659948488969, 41.94059570245024, -5.025486177844239, 25.643727739794485, 12.311365753694602, -12.932067780647, -3.763036350245269, -14.484777609855525, 42.081516959076026, 25.996800334434415, 19.399029098147672, -10.042450533194048, 19.247027667265254, 18.03352662799239, 17.000812592196635, -9.397242556118815, 15.27783282273154, -0.3211514745736881, 29.205088032835427, 25.31431766622669, 32.365299504445076, 18.158010809632934, 10.07435107646715, 18.590145656979065, 5.014040577848752, -0.20946847263772028, -9.131689770415912, 5.900958595476814, 11.809503251872524, 5.07867792861947, 5.159565834907058, 3.8306454971663957, 5.326159847071571, 1.8596626143783705, 16.641246036360556, 6.656450648608191, 10.070452760185047, 15.606212837247147, 11.457891601370532, 11.08208436006188, -5.966107506067278, -8.228291484890432], "policy_adversary_policy_reward": [-1.4216476301189154, 11.640975460099803, -20.150037190377983, -14.540678328901627, -23.23604179513527, -3.797577335628578, -17.219407475651263, -2.5863367854734918, -0.08636949967577578, -11.305538664534922, -4.771837305833966, -5.059786739982691, 1.3483834680400406, 33.28486150536479, 15.164844641879032, 5.300215576878685, 14.973652925328985, -15.295710940806249, 11.98514751702174, -7.243994566391741, 13.867466562525006, -2.531562981943157, 0.9439010144353475, 2.2869493257452334, -10.22331893809907, -23.555798972599774, 4.539818312892887, 15.276569675789782, -6.443939707886328, 10.290425210050817, -13.278935884311636, -46.23649561145355, 0.6829899881251151, 19.710996768705918, 14.28330272631136, 28.861643166848193, -14.292173814187333, -35.712632036519764, -24.666092349993477, -17.101328636254415, 13.590821056906345, -0.404060110467686, 12.579979873134313, 10.084674018659598, 28.337633491225574, 31.10485948885023, -11.461736507831418, -14.481479075732636, 4.567970889298241, 10.940437687457512, -7.300966378360378, -29.562528366850657, 11.675096533628782, 5.231321089900629, -36.485261338186014, -34.47278775485095, -8.188692056340798, -19.620628795292106, 19.894153905059856, 17.947613554893078, 19.99801401969809, 11.628442578774363, 11.618654888559204, 18.22313283515712, -5.40116061857146, 12.743742563841682, -41.48864287678995, -28.54750974753972, -0.05568973224752938, -14.501653385076317, 3.6044140128823585, 3.0804223512248505, 7.463279389221613, 26.65939329254711, 15.617179492547356, 33.31169052043815, -8.559732878417588, -4.152940543064747, 11.052349999581404, 1.536652544841071, 2.4494906069424474, -6.450679291437186, -2.828215971938665, -6.088233224487729, 18.173758250979823, 9.188248697622406, 8.24916180168208, 3.793828658883868, 39.127983671656665, 23.092901539383675, 3.3895962462236504, 4.06813524592107, -24.022951266298243, -33.319815884951495, 3.195639885787852, 8.325414432675853, -0.6089845292005016, 33.35841152746734, 3.8562394800093838, 24.519947415480786, -38.811093306531674, -37.31671183193218, 14.655156688524352, 3.8315544487376183, 24.806418468202644, 28.442915084431235, -4.912003941153571, -24.365319586623006, -32.635786509576285, -29.33852072422863, 9.137048131868754, 18.881029393127875, 26.863120399816953, 13.529678630977216, -23.965430100224417, -42.6893411496742, -31.3832862592157, -33.68991271056366, -41.83603902997241, -42.04515237492797, 2.6735990233121445, 7.377373332376333, -39.77872843537869, -11.508727044210282, -16.2907929158064, -8.331938591582805, 5.135985334556899, 20.728150226737057, -12.47517414140913, 20.001246841899682, 6.968987873742959, 22.00056734596804, -40.35215625434513, -43.810877663807005, -12.46365604334467, -39.52994462552416, -31.604665514380258, -7.1933926819150855, 18.58630878020084, 1.4985922861872538, -25.071857104411787, -13.422198230118717, -5.836809100292911, -30.23024415569187, -12.117085306082103, -21.88453987831117, 22.491758507719997, -3.6972733954823607, -16.766817394142368, -13.788848251320715, -1.240667371845415, 1.8829703209927913, -25.863605577310935, -32.546570488359905, -30.453843332295676, -20.17479200015769, -34.11711149829263, -30.613487510597537, -10.0102058193539, -26.30581579991196, -13.860987072719755, -6.2877150802145465, -5.181146333195542, -31.999144980762594, -13.57453626730619, 3.54645511160869, 11.70420972327507, -11.285272777999634, 7.1823706584760565, 11.081008882355768, -19.302258955955434, 7.5003417650018065, -25.266767866749284, 1.647761363004232, 7.431766946916767, -17.589122804155707, -9.264966520864132, -1.0541651489499841, 3.0574150630816597, -10.718706057414451, -13.949081887927445, 3.2967621937843035, -5.498358563675513, 1.779033334918772, -29.048468995550223, -4.234023077170882, 2.9634413086867326, -16.276342605903118, -0.1283729596727774, -20.01253256069732, -13.750515561648534, -17.46191011284578, -7.2848320837839395, -15.630951118957125, -17.750540664869146, -4.41362805525462, 10.333392375511096, 1.59882263662346, 5.5222230193573765, 10.934359950423488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5273459561063079, "mean_inference_ms": 1.4562831745207838, "mean_action_processing_ms": 0.22557664781887973, "mean_env_wait_ms": 0.0980662705920012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004419684410095215, "StateBufferConnector_ms": 0.002564549446105957, "ViewRequirementAgentConnector_ms": 0.06935977935791016}, "num_episodes": 10, "episode_return_max": 31.11044260552017, "episode_return_min": -42.08151695907603, "episode_return_mean": -4.496308542263755}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.78577266604094, "num_env_steps_trained_throughput_per_sec": 493.78577266604094, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 7859.437, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7859.329, "sample_time_ms": 826.021, "learn_time_ms": 7019.167, "learn_throughput": 569.868, "synch_weights_time_ms": 13.178}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "training_iteration": 13, "trial_id": "83a5c_00000", "date": "2024-08-10_12-15-41", "timestamp": 1723306541, "time_this_iter_s": 8.105095386505127, "time_total_s": 106.37857127189636, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a1820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.37857127189636, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.791666666666668, "ram_util_percent": 80.53333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.220265296164644, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.686778034734978, "policy_loss": -0.006669526396654349, "vf_loss": 4.69134531222954, "vf_explained_var": -0.10855632670341976, "kl": 0.014015045421077421, "entropy": 1.5646821846406926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.128311780033012, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.767947587370872, "policy_loss": -0.005334937737886018, "vf_loss": 4.7723438481489815, "vf_explained_var": 0.014732379217942555, "kl": 0.004693438710372296, "entropy": 1.0869626943022013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 31.11044260552017, "episode_reward_min": -42.08151695907603, "episode_reward_mean": -4.14058995005052, "episode_len_mean": 378.32, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37832, "policy_reward_min": {"agent_policy": -31.110442605520195, "adversary_policy": -46.23649561145355}, "policy_reward_max": {"agent_policy": 42.081516959076026, "adversary_policy": 44.23359777857221}, "policy_reward_mean": {"agent_policy": 4.14058995005052, "adversary_policy": -4.140589950050522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.667951790290926, 1.6154251700902877, -16.889558955349422, 9.90819399434133, 1.9232427510822543, -29.757715747882592, 10.19699337841552, 21.572472946579776, -25.002402925353547, -20.883710493123946, 6.593380473219327, 11.332326945896952, 29.72124649003794, -12.971607791782027, 7.754204288377872, -18.431747372605518, 8.453208811764705, -35.47902454651848, -13.904660425816452, 18.920883729976456, 15.813228299236219, 14.920893861858207, 3.671290972635112, -35.01807631216486, -7.278671558661923, 3.3424181820536045, 17.061336340884374, 24.464435006492717, -6.356336710741166, 6.294501272211233, -2.0005943422473713, -4.458224598213191, 13.681003474301118, 6.021495230282974, 31.11044260552017, 3.728865746072363, -28.671383575624894, 5.760527159231852, 16.374713499133403, 14.188093447745093, -38.06390256923187, 9.243355568630982, 26.624666776316946, -14.638661763888287, -30.98715361690244, 14.009038762498337, 20.196399515397097, -33.32738562494926, -32.53659948488969, -41.94059570245023, 5.025486177844239, -25.643727739794485, -12.311365753694602, 12.932067780646983, 3.763036350245269, 14.484777609855534, -42.08151695907603, -25.996800334434415, -19.399029098147672, 10.042450533194048, -19.247027667265254, -18.03352662799239, -17.000812592196635, 9.397242556118819, -15.27783282273154, 0.3211514745736881, -29.205088032835402, -25.314317666226682, -32.3652995044451, -18.158010809632902, -10.07435107646715, -18.59014565697907, -5.014040577848752, 0.20946847263772028, 9.131689770415912, -5.900958595476814, -11.809503251872526, -5.078677928619468, -5.159565834907058, -3.8306454971663957, -5.326159847071571, -1.8596626143783705, -16.641246036360556, -6.656450648608191, -10.07045276018505, -15.606212837247146, -11.457891601370532, -11.082084360061879, 5.966107506067278, 8.228291484890432, 0.07615890527641156, -18.53163274121582, 6.584887792234813, 4.602585851440578, 22.94849831008917, 6.134576636910063, 3.5678434827192405, -0.7866697409451593, -7.317303719496426, 1.7844728623608859], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 99, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-5.667951790290918, -1.615425170090294, 16.889558955349422, -9.908193994341335, -1.9232427510822463, 29.757715747882592, -10.196993378415515, -21.57247294657977, 25.00240292535355, 20.883710493123946, -6.593380473219332, -11.332326945896957, -29.72124649003792, 12.971607791782027, -7.754204288377869, 18.431747372605518, -8.453208811764709, 35.479024546518474, 13.904660425816452, -18.92088372997646, -15.813228299236226, -14.92089386185818, -3.671290972635111, 35.01807631216484, 7.278671558661923, -3.3424181820536045, -17.061336340884367, -24.464435006492778, 6.356336710741166, -6.294501272211231, 2.0005943422473704, 4.4582245982131985, -13.681003474301113, -6.021495230282974, -31.110442605520195, -3.7288657460723584, 28.671383575624876, -5.760527159231852, -16.374713499133435, -14.188093447745091, 38.06390256923191, -9.24335556863098, -26.62466677631695, 14.638661763888294, 30.987153616902454, -14.009038762498314, -20.196399515397093, 33.32738562494929, 32.53659948488969, 41.94059570245024, -5.025486177844239, 25.643727739794485, 12.311365753694602, -12.932067780647, -3.763036350245269, -14.484777609855525, 42.081516959076026, 25.996800334434415, 19.399029098147672, -10.042450533194048, 19.247027667265254, 18.03352662799239, 17.000812592196635, -9.397242556118815, 15.27783282273154, -0.3211514745736881, 29.205088032835427, 25.31431766622669, 32.365299504445076, 18.158010809632934, 10.07435107646715, 18.590145656979065, 5.014040577848752, -0.20946847263772028, -9.131689770415912, 5.900958595476814, 11.809503251872524, 5.07867792861947, 5.159565834907058, 3.8306454971663957, 5.326159847071571, 1.8596626143783705, 16.641246036360556, 6.656450648608191, 10.070452760185047, 15.606212837247147, 11.457891601370532, 11.08208436006188, -5.966107506067278, -8.228291484890432, -0.07615890527641156, 18.5316327412158, -6.584887792234813, -4.602585851440578, -22.948498310089164, -6.134576636910063, -3.5678434827192405, 0.7866697409451611, 7.317303719496426, -1.7844728623608859], "policy_adversary_policy_reward": [13.867466562525006, -2.531562981943157, 0.9439010144353475, 2.2869493257452334, -10.22331893809907, -23.555798972599774, 4.539818312892887, 15.276569675789782, -6.443939707886328, 10.290425210050817, -13.278935884311636, -46.23649561145355, 0.6829899881251151, 19.710996768705918, 14.28330272631136, 28.861643166848193, -14.292173814187333, -35.712632036519764, -24.666092349993477, -17.101328636254415, 13.590821056906345, -0.404060110467686, 12.579979873134313, 10.084674018659598, 28.337633491225574, 31.10485948885023, -11.461736507831418, -14.481479075732636, 4.567970889298241, 10.940437687457512, -7.300966378360378, -29.562528366850657, 11.675096533628782, 5.231321089900629, -36.485261338186014, -34.47278775485095, -8.188692056340798, -19.620628795292106, 19.894153905059856, 17.947613554893078, 19.99801401969809, 11.628442578774363, 11.618654888559204, 18.22313283515712, -5.40116061857146, 12.743742563841682, -41.48864287678995, -28.54750974753972, -0.05568973224752938, -14.501653385076317, 3.6044140128823585, 3.0804223512248505, 7.463279389221613, 26.65939329254711, 15.617179492547356, 33.31169052043815, -8.559732878417588, -4.152940543064747, 11.052349999581404, 1.536652544841071, 2.4494906069424474, -6.450679291437186, -2.828215971938665, -6.088233224487729, 18.173758250979823, 9.188248697622406, 8.24916180168208, 3.793828658883868, 39.127983671656665, 23.092901539383675, 3.3895962462236504, 4.06813524592107, -24.022951266298243, -33.319815884951495, 3.195639885787852, 8.325414432675853, -0.6089845292005016, 33.35841152746734, 3.8562394800093838, 24.519947415480786, -38.811093306531674, -37.31671183193218, 14.655156688524352, 3.8315544487376183, 24.806418468202644, 28.442915084431235, -4.912003941153571, -24.365319586623006, -32.635786509576285, -29.33852072422863, 9.137048131868754, 18.881029393127875, 26.863120399816953, 13.529678630977216, -23.965430100224417, -42.6893411496742, -31.3832862592157, -33.68991271056366, -41.83603902997241, -42.04515237492797, 2.6735990233121445, 7.377373332376333, -39.77872843537869, -11.508727044210282, -16.2907929158064, -8.331938591582805, 5.135985334556899, 20.728150226737057, -12.47517414140913, 20.001246841899682, 6.968987873742959, 22.00056734596804, -40.35215625434513, -43.810877663807005, -12.46365604334467, -39.52994462552416, -31.604665514380258, -7.1933926819150855, 18.58630878020084, 1.4985922861872538, -25.071857104411787, -13.422198230118717, -5.836809100292911, -30.23024415569187, -12.117085306082103, -21.88453987831117, 22.491758507719997, -3.6972733954823607, -16.766817394142368, -13.788848251320715, -1.240667371845415, 1.8829703209927913, -25.863605577310935, -32.546570488359905, -30.453843332295676, -20.17479200015769, -34.11711149829263, -30.613487510597537, -10.0102058193539, -26.30581579991196, -13.860987072719755, -6.2877150802145465, -5.181146333195542, -31.999144980762594, -13.57453626730619, 3.54645511160869, 11.70420972327507, -11.285272777999634, 7.1823706584760565, 11.081008882355768, -19.302258955955434, 7.5003417650018065, -25.266767866749284, 1.647761363004232, 7.431766946916767, -17.589122804155707, -9.264966520864132, -1.0541651489499841, 3.0574150630816597, -10.718706057414451, -13.949081887927445, 3.2967621937843035, -5.498358563675513, 1.779033334918772, -29.048468995550223, -4.234023077170882, 2.9634413086867326, -16.276342605903118, -0.1283729596727774, -20.01253256069732, -13.750515561648534, -17.46191011284578, -7.2848320837839395, -15.630951118957125, -17.750540664869146, -4.41362805525462, 10.333392375511096, 1.59882263662346, 5.5222230193573765, 10.934359950423488, 5.851206053386132, -5.698888242833309, -11.294810001374078, -25.768455481057515, 10.283812008905535, 2.885963575564091, -4.420719854889452, 13.625891557770608, 44.23359777857221, 1.6633988416061118, -2.2909701305357935, 14.56012340435592, 5.971698645623711, 1.16398831981477, 6.471866584703438, -8.04520606659376, -12.571113336665036, -2.063494102327816, -1.9491787520841335, 5.518124476805905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5153556837993815, "mean_inference_ms": 1.4088560580173584, "mean_action_processing_ms": 0.2199937052586579, "mean_env_wait_ms": 0.09513129057320507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004309654235839844, "StateBufferConnector_ms": 0.0025501251220703125, "ViewRequirementAgentConnector_ms": 0.0689539909362793}, "num_episodes": 10, "episode_return_max": 31.11044260552017, "episode_return_min": -42.08151695907603, "episode_return_mean": -4.14058995005052}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.8570374572119, "num_env_steps_trained_throughput_per_sec": 480.8570374572119, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 7880.29, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7880.182, "sample_time_ms": 824.962, "learn_time_ms": 7040.806, "learn_throughput": 568.117, "synch_weights_time_ms": 13.458}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 14, "trial_id": "83a5c_00000", "date": "2024-08-10_12-15-50", "timestamp": 1723306550, "time_this_iter_s": 8.322670221328735, "time_total_s": 114.7012414932251, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f570b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.7012414932251, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.441666666666666, "ram_util_percent": 80.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3700609876995995, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9064814242105634, "policy_loss": -0.005244397588330444, "vf_loss": 3.9097999073210215, "vf_explained_var": 0.0006074899403506486, "kl": 0.012839449256659445, "entropy": 1.5539183363081917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2226175984057286, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.1004688854018845, "policy_loss": -0.004365520147500016, "vf_loss": 4.103838857511679, "vf_explained_var": 0.07465662024915218, "kl": 0.00995548169046098, "entropy": 1.0396512515842915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "env_runners": {"episode_reward_max": 31.11044260552017, "episode_reward_min": -42.08151695907603, "episode_reward_mean": -3.2428720408759744, "episode_len_mean": 371.43, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37143, "policy_reward_min": {"agent_policy": -31.110442605520195, "adversary_policy": -43.810877663807005}, "policy_reward_max": {"agent_policy": 42.081516959076026, "adversary_policy": 44.23359777857221}, "policy_reward_mean": {"agent_policy": 3.242872040875975, "adversary_policy": -3.2428720408759766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.332326945896952, 29.72124649003794, -12.971607791782027, 7.754204288377872, -18.431747372605518, 8.453208811764705, -35.47902454651848, -13.904660425816452, 18.920883729976456, 15.813228299236219, 14.920893861858207, 3.671290972635112, -35.01807631216486, -7.278671558661923, 3.3424181820536045, 17.061336340884374, 24.464435006492717, -6.356336710741166, 6.294501272211233, -2.0005943422473713, -4.458224598213191, 13.681003474301118, 6.021495230282974, 31.11044260552017, 3.728865746072363, -28.671383575624894, 5.760527159231852, 16.374713499133403, 14.188093447745093, -38.06390256923187, 9.243355568630982, 26.624666776316946, -14.638661763888287, -30.98715361690244, 14.009038762498337, 20.196399515397097, -33.32738562494926, -32.53659948488969, -41.94059570245023, 5.025486177844239, -25.643727739794485, -12.311365753694602, 12.932067780646983, 3.763036350245269, 14.484777609855534, -42.08151695907603, -25.996800334434415, -19.399029098147672, 10.042450533194048, -19.247027667265254, -18.03352662799239, -17.000812592196635, 9.397242556118819, -15.27783282273154, 0.3211514745736881, -29.205088032835402, -25.314317666226682, -32.3652995044451, -18.158010809632902, -10.07435107646715, -18.59014565697907, -5.014040577848752, 0.20946847263772028, 9.131689770415912, -5.900958595476814, -11.809503251872526, -5.078677928619468, -5.159565834907058, -3.8306454971663957, -5.326159847071571, -1.8596626143783705, -16.641246036360556, -6.656450648608191, -10.07045276018505, -15.606212837247146, -11.457891601370532, -11.082084360061879, 5.966107506067278, 8.228291484890432, 0.07615890527641156, -18.53163274121582, 6.584887792234813, 4.602585851440578, 22.94849831008917, 6.134576636910063, 3.5678434827192405, -0.7866697409451593, -7.317303719496426, 1.7844728623608859, 4.090016279162507, 9.43134547398794, -18.648506822561256, 0.21244695238475764, -2.992157048401932, -1.7475694114941565, 6.533789579539155, 24.7218263778357, 8.716328766351031, 17.631661020440966, 6.766882132519683], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 99, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 80, 400, 400, 31], "policy_agent_policy_reward": [-11.332326945896957, -29.72124649003792, 12.971607791782027, -7.754204288377869, 18.431747372605518, -8.453208811764709, 35.479024546518474, 13.904660425816452, -18.92088372997646, -15.813228299236226, -14.92089386185818, -3.671290972635111, 35.01807631216484, 7.278671558661923, -3.3424181820536045, -17.061336340884367, -24.464435006492778, 6.356336710741166, -6.294501272211231, 2.0005943422473704, 4.4582245982131985, -13.681003474301113, -6.021495230282974, -31.110442605520195, -3.7288657460723584, 28.671383575624876, -5.760527159231852, -16.374713499133435, -14.188093447745091, 38.06390256923191, -9.24335556863098, -26.62466677631695, 14.638661763888294, 30.987153616902454, -14.009038762498314, -20.196399515397093, 33.32738562494929, 32.53659948488969, 41.94059570245024, -5.025486177844239, 25.643727739794485, 12.311365753694602, -12.932067780647, -3.763036350245269, -14.484777609855525, 42.081516959076026, 25.996800334434415, 19.399029098147672, -10.042450533194048, 19.247027667265254, 18.03352662799239, 17.000812592196635, -9.397242556118815, 15.27783282273154, -0.3211514745736881, 29.205088032835427, 25.31431766622669, 32.365299504445076, 18.158010809632934, 10.07435107646715, 18.590145656979065, 5.014040577848752, -0.20946847263772028, -9.131689770415912, 5.900958595476814, 11.809503251872524, 5.07867792861947, 5.159565834907058, 3.8306454971663957, 5.326159847071571, 1.8596626143783705, 16.641246036360556, 6.656450648608191, 10.070452760185047, 15.606212837247147, 11.457891601370532, 11.08208436006188, -5.966107506067278, -8.228291484890432, -0.07615890527641156, 18.5316327412158, -6.584887792234813, -4.602585851440578, -22.948498310089164, -6.134576636910063, -3.5678434827192405, 0.7866697409451611, 7.317303719496426, -1.7844728623608859, -4.090016279162507, -9.43134547398794, 18.648506822561256, -0.21244695238475764, 2.9921570484019266, 1.7475694114941565, -6.533789579539155, -24.721826377835683, -8.716328766351033, -17.631661020441012, -6.766882132519681], "policy_adversary_policy_reward": [12.579979873134313, 10.084674018659598, 28.337633491225574, 31.10485948885023, -11.461736507831418, -14.481479075732636, 4.567970889298241, 10.940437687457512, -7.300966378360378, -29.562528366850657, 11.675096533628782, 5.231321089900629, -36.485261338186014, -34.47278775485095, -8.188692056340798, -19.620628795292106, 19.894153905059856, 17.947613554893078, 19.99801401969809, 11.628442578774363, 11.618654888559204, 18.22313283515712, -5.40116061857146, 12.743742563841682, -41.48864287678995, -28.54750974753972, -0.05568973224752938, -14.501653385076317, 3.6044140128823585, 3.0804223512248505, 7.463279389221613, 26.65939329254711, 15.617179492547356, 33.31169052043815, -8.559732878417588, -4.152940543064747, 11.052349999581404, 1.536652544841071, 2.4494906069424474, -6.450679291437186, -2.828215971938665, -6.088233224487729, 18.173758250979823, 9.188248697622406, 8.24916180168208, 3.793828658883868, 39.127983671656665, 23.092901539383675, 3.3895962462236504, 4.06813524592107, -24.022951266298243, -33.319815884951495, 3.195639885787852, 8.325414432675853, -0.6089845292005016, 33.35841152746734, 3.8562394800093838, 24.519947415480786, -38.811093306531674, -37.31671183193218, 14.655156688524352, 3.8315544487376183, 24.806418468202644, 28.442915084431235, -4.912003941153571, -24.365319586623006, -32.635786509576285, -29.33852072422863, 9.137048131868754, 18.881029393127875, 26.863120399816953, 13.529678630977216, -23.965430100224417, -42.6893411496742, -31.3832862592157, -33.68991271056366, -41.83603902997241, -42.04515237492797, 2.6735990233121445, 7.377373332376333, -39.77872843537869, -11.508727044210282, -16.2907929158064, -8.331938591582805, 5.135985334556899, 20.728150226737057, -12.47517414140913, 20.001246841899682, 6.968987873742959, 22.00056734596804, -40.35215625434513, -43.810877663807005, -12.46365604334467, -39.52994462552416, -31.604665514380258, -7.1933926819150855, 18.58630878020084, 1.4985922861872538, -25.071857104411787, -13.422198230118717, -5.836809100292911, -30.23024415569187, -12.117085306082103, -21.88453987831117, 22.491758507719997, -3.6972733954823607, -16.766817394142368, -13.788848251320715, -1.240667371845415, 1.8829703209927913, -25.863605577310935, -32.546570488359905, -30.453843332295676, -20.17479200015769, -34.11711149829263, -30.613487510597537, -10.0102058193539, -26.30581579991196, -13.860987072719755, -6.2877150802145465, -5.181146333195542, -31.999144980762594, -13.57453626730619, 3.54645511160869, 11.70420972327507, -11.285272777999634, 7.1823706584760565, 11.081008882355768, -19.302258955955434, 7.5003417650018065, -25.266767866749284, 1.647761363004232, 7.431766946916767, -17.589122804155707, -9.264966520864132, -1.0541651489499841, 3.0574150630816597, -10.718706057414451, -13.949081887927445, 3.2967621937843035, -5.498358563675513, 1.779033334918772, -29.048468995550223, -4.234023077170882, 2.9634413086867326, -16.276342605903118, -0.1283729596727774, -20.01253256069732, -13.750515561648534, -17.46191011284578, -7.2848320837839395, -15.630951118957125, -17.750540664869146, -4.41362805525462, 10.333392375511096, 1.59882263662346, 5.5222230193573765, 10.934359950423488, 5.851206053386132, -5.698888242833309, -11.294810001374078, -25.768455481057515, 10.283812008905535, 2.885963575564091, -4.420719854889452, 13.625891557770608, 44.23359777857221, 1.6633988416061118, -2.2909701305357935, 14.56012340435592, 5.971698645623711, 1.16398831981477, 6.471866584703438, -8.04520606659376, -12.571113336665036, -2.063494102327816, -1.9491787520841335, 5.518124476805905, 0.03743514763384681, 8.142597410691167, 11.633823427462627, 7.228867520513255, -7.551777064597992, -29.74523658052452, -0.42582224866973917, 0.8507161534392544, 2.8199759912124307, -8.804290088016291, -15.779398435323401, 12.284259612335088, 13.4288454894124, -0.3612663303340895, 16.653883409098068, 32.7897693465733, 13.05729231336936, 4.375365219332714, 15.061374094565, 20.201947946316956, 15.9800709418026, -2.4463066767632355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5057782392198202, "mean_inference_ms": 1.3717478698569383, "mean_action_processing_ms": 0.21561684744298593, "mean_env_wait_ms": 0.09272321129724291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004320859909057617, "StateBufferConnector_ms": 0.0029507875442504883, "ViewRequirementAgentConnector_ms": 0.06973433494567871}, "num_episodes": 11, "episode_return_max": 31.11044260552017, "episode_return_min": -42.08151695907603, "episode_return_mean": -3.2428720408759744}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 469.2652425189281, "num_env_steps_trained_throughput_per_sec": 469.2652425189281, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 7961.946, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7961.837, "sample_time_ms": 828.341, "learn_time_ms": 7118.51, "learn_throughput": 561.915, "synch_weights_time_ms": 14.037}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "training_iteration": 15, "trial_id": "83a5c_00000", "date": "2024-08-10_12-15-58", "timestamp": 1723306558, "time_this_iter_s": 8.528642892837524, "time_total_s": 123.22988438606262, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f6360d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 123.22988438606262, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 27.900000000000006, "ram_util_percent": 80.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0473493158974976, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.522089927915543, "policy_loss": -0.006043407615648691, "vf_loss": 3.5259393908990124, "vf_explained_var": -0.25178951990036735, "kl": 0.014626284502265776, "entropy": 1.5594174673948338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.213897012981276, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1745469195147353, "policy_loss": -0.005208068381277068, "vf_loss": 3.1790949714680514, "vf_explained_var": 0.20428105276077985, "kl": 0.006600288878966065, "entropy": 0.9878167238707344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 31.11044260552017, "episode_reward_min": -42.08151695907603, "episode_reward_mean": -2.662063587499469, "episode_len_mean": 371.43, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37143, "policy_reward_min": {"agent_policy": -31.110442605520195, "adversary_policy": -47.72986543300034}, "policy_reward_max": {"agent_policy": 42.081516959076026, "adversary_policy": 44.23359777857221}, "policy_reward_mean": {"agent_policy": 2.662063587499468, "adversary_policy": -2.6620635874994703}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.813228299236219, 14.920893861858207, 3.671290972635112, -35.01807631216486, -7.278671558661923, 3.3424181820536045, 17.061336340884374, 24.464435006492717, -6.356336710741166, 6.294501272211233, -2.0005943422473713, -4.458224598213191, 13.681003474301118, 6.021495230282974, 31.11044260552017, 3.728865746072363, -28.671383575624894, 5.760527159231852, 16.374713499133403, 14.188093447745093, -38.06390256923187, 9.243355568630982, 26.624666776316946, -14.638661763888287, -30.98715361690244, 14.009038762498337, 20.196399515397097, -33.32738562494926, -32.53659948488969, -41.94059570245023, 5.025486177844239, -25.643727739794485, -12.311365753694602, 12.932067780646983, 3.763036350245269, 14.484777609855534, -42.08151695907603, -25.996800334434415, -19.399029098147672, 10.042450533194048, -19.247027667265254, -18.03352662799239, -17.000812592196635, 9.397242556118819, -15.27783282273154, 0.3211514745736881, -29.205088032835402, -25.314317666226682, -32.3652995044451, -18.158010809632902, -10.07435107646715, -18.59014565697907, -5.014040577848752, 0.20946847263772028, 9.131689770415912, -5.900958595476814, -11.809503251872526, -5.078677928619468, -5.159565834907058, -3.8306454971663957, -5.326159847071571, -1.8596626143783705, -16.641246036360556, -6.656450648608191, -10.07045276018505, -15.606212837247146, -11.457891601370532, -11.082084360061879, 5.966107506067278, 8.228291484890432, 0.07615890527641156, -18.53163274121582, 6.584887792234813, 4.602585851440578, 22.94849831008917, 6.134576636910063, 3.5678434827192405, -0.7866697409451593, -7.317303719496426, 1.7844728623608859, 4.090016279162507, 9.43134547398794, -18.648506822561256, 0.21244695238475764, -2.992157048401932, -1.7475694114941565, 6.533789579539155, 24.7218263778357, 8.716328766351031, 17.631661020440966, 6.766882132519683, -2.526905985581733, 25.132106143407636, 12.938312567677118, -35.617472062103026, 8.251517598619316, 1.9179637346272127, 4.74601097213043, 29.29645412660523, 9.337688371599874], "episode_lengths": [400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 99, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 80, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-15.813228299236226, -14.92089386185818, -3.671290972635111, 35.01807631216484, 7.278671558661923, -3.3424181820536045, -17.061336340884367, -24.464435006492778, 6.356336710741166, -6.294501272211231, 2.0005943422473704, 4.4582245982131985, -13.681003474301113, -6.021495230282974, -31.110442605520195, -3.7288657460723584, 28.671383575624876, -5.760527159231852, -16.374713499133435, -14.188093447745091, 38.06390256923191, -9.24335556863098, -26.62466677631695, 14.638661763888294, 30.987153616902454, -14.009038762498314, -20.196399515397093, 33.32738562494929, 32.53659948488969, 41.94059570245024, -5.025486177844239, 25.643727739794485, 12.311365753694602, -12.932067780647, -3.763036350245269, -14.484777609855525, 42.081516959076026, 25.996800334434415, 19.399029098147672, -10.042450533194048, 19.247027667265254, 18.03352662799239, 17.000812592196635, -9.397242556118815, 15.27783282273154, -0.3211514745736881, 29.205088032835427, 25.31431766622669, 32.365299504445076, 18.158010809632934, 10.07435107646715, 18.590145656979065, 5.014040577848752, -0.20946847263772028, -9.131689770415912, 5.900958595476814, 11.809503251872524, 5.07867792861947, 5.159565834907058, 3.8306454971663957, 5.326159847071571, 1.8596626143783705, 16.641246036360556, 6.656450648608191, 10.070452760185047, 15.606212837247147, 11.457891601370532, 11.08208436006188, -5.966107506067278, -8.228291484890432, -0.07615890527641156, 18.5316327412158, -6.584887792234813, -4.602585851440578, -22.948498310089164, -6.134576636910063, -3.5678434827192405, 0.7866697409451611, 7.317303719496426, -1.7844728623608859, -4.090016279162507, -9.43134547398794, 18.648506822561256, -0.21244695238475764, 2.9921570484019266, 1.7475694114941565, -6.533789579539155, -24.721826377835683, -8.716328766351033, -17.631661020441012, -6.766882132519681, 2.526905985581732, -25.132106143407633, -12.938312567677126, 35.61747206210302, -8.251517598619314, -1.9179637346272171, -4.7460109721304296, -29.296454126605276, -9.33768837159988], "policy_adversary_policy_reward": [19.99801401969809, 11.628442578774363, 11.618654888559204, 18.22313283515712, -5.40116061857146, 12.743742563841682, -41.48864287678995, -28.54750974753972, -0.05568973224752938, -14.501653385076317, 3.6044140128823585, 3.0804223512248505, 7.463279389221613, 26.65939329254711, 15.617179492547356, 33.31169052043815, -8.559732878417588, -4.152940543064747, 11.052349999581404, 1.536652544841071, 2.4494906069424474, -6.450679291437186, -2.828215971938665, -6.088233224487729, 18.173758250979823, 9.188248697622406, 8.24916180168208, 3.793828658883868, 39.127983671656665, 23.092901539383675, 3.3895962462236504, 4.06813524592107, -24.022951266298243, -33.319815884951495, 3.195639885787852, 8.325414432675853, -0.6089845292005016, 33.35841152746734, 3.8562394800093838, 24.519947415480786, -38.811093306531674, -37.31671183193218, 14.655156688524352, 3.8315544487376183, 24.806418468202644, 28.442915084431235, -4.912003941153571, -24.365319586623006, -32.635786509576285, -29.33852072422863, 9.137048131868754, 18.881029393127875, 26.863120399816953, 13.529678630977216, -23.965430100224417, -42.6893411496742, -31.3832862592157, -33.68991271056366, -41.83603902997241, -42.04515237492797, 2.6735990233121445, 7.377373332376333, -39.77872843537869, -11.508727044210282, -16.2907929158064, -8.331938591582805, 5.135985334556899, 20.728150226737057, -12.47517414140913, 20.001246841899682, 6.968987873742959, 22.00056734596804, -40.35215625434513, -43.810877663807005, -12.46365604334467, -39.52994462552416, -31.604665514380258, -7.1933926819150855, 18.58630878020084, 1.4985922861872538, -25.071857104411787, -13.422198230118717, -5.836809100292911, -30.23024415569187, -12.117085306082103, -21.88453987831117, 22.491758507719997, -3.6972733954823607, -16.766817394142368, -13.788848251320715, -1.240667371845415, 1.8829703209927913, -25.863605577310935, -32.546570488359905, -30.453843332295676, -20.17479200015769, -34.11711149829263, -30.613487510597537, -10.0102058193539, -26.30581579991196, -13.860987072719755, -6.2877150802145465, -5.181146333195542, -31.999144980762594, -13.57453626730619, 3.54645511160869, 11.70420972327507, -11.285272777999634, 7.1823706584760565, 11.081008882355768, -19.302258955955434, 7.5003417650018065, -25.266767866749284, 1.647761363004232, 7.431766946916767, -17.589122804155707, -9.264966520864132, -1.0541651489499841, 3.0574150630816597, -10.718706057414451, -13.949081887927445, 3.2967621937843035, -5.498358563675513, 1.779033334918772, -29.048468995550223, -4.234023077170882, 2.9634413086867326, -16.276342605903118, -0.1283729596727774, -20.01253256069732, -13.750515561648534, -17.46191011284578, -7.2848320837839395, -15.630951118957125, -17.750540664869146, -4.41362805525462, 10.333392375511096, 1.59882263662346, 5.5222230193573765, 10.934359950423488, 5.851206053386132, -5.698888242833309, -11.294810001374078, -25.768455481057515, 10.283812008905535, 2.885963575564091, -4.420719854889452, 13.625891557770608, 44.23359777857221, 1.6633988416061118, -2.2909701305357935, 14.56012340435592, 5.971698645623711, 1.16398831981477, 6.471866584703438, -8.04520606659376, -12.571113336665036, -2.063494102327816, -1.9491787520841335, 5.518124476805905, 0.03743514763384681, 8.142597410691167, 11.633823427462627, 7.228867520513255, -7.551777064597992, -29.74523658052452, -0.42582224866973917, 0.8507161534392544, 2.8199759912124307, -8.804290088016291, -15.779398435323401, 12.284259612335088, 13.4288454894124, -0.3612663303340895, 16.653883409098068, 32.7897693465733, 13.05729231336936, 4.375365219332714, 15.061374094565, 20.201947946316956, 15.9800709418026, -2.4463066767632355, -1.6615423642737888, -3.3922696068896725, 20.096355722370003, 30.16785656444523, 6.560418112982186, 19.31620702237207, -23.505078691205668, -47.72986543300034, 23.361327445499036, -6.858292248260401, 17.08227917068309, -13.246351701428662, -5.252716582256127, 14.744738526516997, 30.789309226821626, 27.80359902638893, 6.21769327779967, 12.457683465400084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4971174221741246, "mean_inference_ms": 1.342620435375498, "mean_action_processing_ms": 0.21180258401224702, "mean_env_wait_ms": 0.09060074462213659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035486221313476562, "StateBufferConnector_ms": 0.0028798580169677734, "ViewRequirementAgentConnector_ms": 0.06613016128540039}, "num_episodes": 9, "episode_return_max": 31.11044260552017, "episode_return_min": -42.08151695907603, "episode_return_mean": -2.662063587499469}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.1798311048823, "num_env_steps_trained_throughput_per_sec": 502.1798311048823, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 7903.655, "restore_workers_time_ms": 0.014, "training_step_time_ms": 7903.607, "sample_time_ms": 823.711, "learn_time_ms": 7066.933, "learn_throughput": 566.016, "synch_weights_time_ms": 12.319}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 16, "trial_id": "83a5c_00000", "date": "2024-08-10_12-16-06", "timestamp": 1723306566, "time_this_iter_s": 7.969143867492676, "time_total_s": 131.1990282535553, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f635700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 131.1990282535553, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.59090909090909, "ram_util_percent": 80.03636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0057338416891755, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.499313892510833, "policy_loss": -0.0020343567662325407, "vf_loss": 5.500900564244184, "vf_explained_var": -0.507469280213906, "kl": 0.0029845439469387432, "entropy": 1.5598573306880932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.896147163026035, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.033577511956294, "policy_loss": -0.0031990211728649834, "vf_loss": 4.0361279651522635, "vf_explained_var": 0.13062276958177488, "kl": 0.006485629074087596, "entropy": 1.0976047554363808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "env_runners": {"episode_reward_max": 31.11044260552017, "episode_reward_min": -42.08151695907603, "episode_reward_mean": -3.3053655064740908, "episode_len_mean": 375.37, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37537, "policy_reward_min": {"agent_policy": -31.110442605520195, "adversary_policy": -47.72986543300034}, "policy_reward_max": {"agent_policy": 42.081516959076026, "adversary_policy": 44.23359777857221}, "policy_reward_mean": {"agent_policy": 3.3053655064740908, "adversary_policy": -3.305365506474093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.294501272211233, -2.0005943422473713, -4.458224598213191, 13.681003474301118, 6.021495230282974, 31.11044260552017, 3.728865746072363, -28.671383575624894, 5.760527159231852, 16.374713499133403, 14.188093447745093, -38.06390256923187, 9.243355568630982, 26.624666776316946, -14.638661763888287, -30.98715361690244, 14.009038762498337, 20.196399515397097, -33.32738562494926, -32.53659948488969, -41.94059570245023, 5.025486177844239, -25.643727739794485, -12.311365753694602, 12.932067780646983, 3.763036350245269, 14.484777609855534, -42.08151695907603, -25.996800334434415, -19.399029098147672, 10.042450533194048, -19.247027667265254, -18.03352662799239, -17.000812592196635, 9.397242556118819, -15.27783282273154, 0.3211514745736881, -29.205088032835402, -25.314317666226682, -32.3652995044451, -18.158010809632902, -10.07435107646715, -18.59014565697907, -5.014040577848752, 0.20946847263772028, 9.131689770415912, -5.900958595476814, -11.809503251872526, -5.078677928619468, -5.159565834907058, -3.8306454971663957, -5.326159847071571, -1.8596626143783705, -16.641246036360556, -6.656450648608191, -10.07045276018505, -15.606212837247146, -11.457891601370532, -11.082084360061879, 5.966107506067278, 8.228291484890432, 0.07615890527641156, -18.53163274121582, 6.584887792234813, 4.602585851440578, 22.94849831008917, 6.134576636910063, 3.5678434827192405, -0.7866697409451593, -7.317303719496426, 1.7844728623608859, 4.090016279162507, 9.43134547398794, -18.648506822561256, 0.21244695238475764, -2.992157048401932, -1.7475694114941565, 6.533789579539155, 24.7218263778357, 8.716328766351031, 17.631661020440966, 6.766882132519683, -2.526905985581733, 25.132106143407636, 12.938312567677118, -35.617472062103026, 8.251517598619316, 1.9179637346272127, 4.74601097213043, 29.29645412660523, 9.337688371599874, -10.351533429730088, 1.9419264169424038, -26.096723985962246, -1.8899909840076212, 0.49281009106118123, 1.7792367297641665, -0.1240594587848225, 18.583920034738608, -18.04525922989152], "episode_lengths": [400, 400, 400, 99, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 80, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-6.294501272211231, 2.0005943422473704, 4.4582245982131985, -13.681003474301113, -6.021495230282974, -31.110442605520195, -3.7288657460723584, 28.671383575624876, -5.760527159231852, -16.374713499133435, -14.188093447745091, 38.06390256923191, -9.24335556863098, -26.62466677631695, 14.638661763888294, 30.987153616902454, -14.009038762498314, -20.196399515397093, 33.32738562494929, 32.53659948488969, 41.94059570245024, -5.025486177844239, 25.643727739794485, 12.311365753694602, -12.932067780647, -3.763036350245269, -14.484777609855525, 42.081516959076026, 25.996800334434415, 19.399029098147672, -10.042450533194048, 19.247027667265254, 18.03352662799239, 17.000812592196635, -9.397242556118815, 15.27783282273154, -0.3211514745736881, 29.205088032835427, 25.31431766622669, 32.365299504445076, 18.158010809632934, 10.07435107646715, 18.590145656979065, 5.014040577848752, -0.20946847263772028, -9.131689770415912, 5.900958595476814, 11.809503251872524, 5.07867792861947, 5.159565834907058, 3.8306454971663957, 5.326159847071571, 1.8596626143783705, 16.641246036360556, 6.656450648608191, 10.070452760185047, 15.606212837247147, 11.457891601370532, 11.08208436006188, -5.966107506067278, -8.228291484890432, -0.07615890527641156, 18.5316327412158, -6.584887792234813, -4.602585851440578, -22.948498310089164, -6.134576636910063, -3.5678434827192405, 0.7866697409451611, 7.317303719496426, -1.7844728623608859, -4.090016279162507, -9.43134547398794, 18.648506822561256, -0.21244695238475764, 2.9921570484019266, 1.7475694114941565, -6.533789579539155, -24.721826377835683, -8.716328766351033, -17.631661020441012, -6.766882132519681, 2.526905985581732, -25.132106143407633, -12.938312567677126, 35.61747206210302, -8.251517598619314, -1.9179637346272171, -4.7460109721304296, -29.296454126605276, -9.33768837159988, 10.351533429730079, -1.9419264169424082, 26.096723985962246, 1.8899909840076212, -0.49281009106118034, -1.7792367297641665, 0.1240594587848225, -18.583920034738604, 18.04525922989152], "policy_adversary_policy_reward": [11.052349999581404, 1.536652544841071, 2.4494906069424474, -6.450679291437186, -2.828215971938665, -6.088233224487729, 18.173758250979823, 9.188248697622406, 8.24916180168208, 3.793828658883868, 39.127983671656665, 23.092901539383675, 3.3895962462236504, 4.06813524592107, -24.022951266298243, -33.319815884951495, 3.195639885787852, 8.325414432675853, -0.6089845292005016, 33.35841152746734, 3.8562394800093838, 24.519947415480786, -38.811093306531674, -37.31671183193218, 14.655156688524352, 3.8315544487376183, 24.806418468202644, 28.442915084431235, -4.912003941153571, -24.365319586623006, -32.635786509576285, -29.33852072422863, 9.137048131868754, 18.881029393127875, 26.863120399816953, 13.529678630977216, -23.965430100224417, -42.6893411496742, -31.3832862592157, -33.68991271056366, -41.83603902997241, -42.04515237492797, 2.6735990233121445, 7.377373332376333, -39.77872843537869, -11.508727044210282, -16.2907929158064, -8.331938591582805, 5.135985334556899, 20.728150226737057, -12.47517414140913, 20.001246841899682, 6.968987873742959, 22.00056734596804, -40.35215625434513, -43.810877663807005, -12.46365604334467, -39.52994462552416, -31.604665514380258, -7.1933926819150855, 18.58630878020084, 1.4985922861872538, -25.071857104411787, -13.422198230118717, -5.836809100292911, -30.23024415569187, -12.117085306082103, -21.88453987831117, 22.491758507719997, -3.6972733954823607, -16.766817394142368, -13.788848251320715, -1.240667371845415, 1.8829703209927913, -25.863605577310935, -32.546570488359905, -30.453843332295676, -20.17479200015769, -34.11711149829263, -30.613487510597537, -10.0102058193539, -26.30581579991196, -13.860987072719755, -6.2877150802145465, -5.181146333195542, -31.999144980762594, -13.57453626730619, 3.54645511160869, 11.70420972327507, -11.285272777999634, 7.1823706584760565, 11.081008882355768, -19.302258955955434, 7.5003417650018065, -25.266767866749284, 1.647761363004232, 7.431766946916767, -17.589122804155707, -9.264966520864132, -1.0541651489499841, 3.0574150630816597, -10.718706057414451, -13.949081887927445, 3.2967621937843035, -5.498358563675513, 1.779033334918772, -29.048468995550223, -4.234023077170882, 2.9634413086867326, -16.276342605903118, -0.1283729596727774, -20.01253256069732, -13.750515561648534, -17.46191011284578, -7.2848320837839395, -15.630951118957125, -17.750540664869146, -4.41362805525462, 10.333392375511096, 1.59882263662346, 5.5222230193573765, 10.934359950423488, 5.851206053386132, -5.698888242833309, -11.294810001374078, -25.768455481057515, 10.283812008905535, 2.885963575564091, -4.420719854889452, 13.625891557770608, 44.23359777857221, 1.6633988416061118, -2.2909701305357935, 14.56012340435592, 5.971698645623711, 1.16398831981477, 6.471866584703438, -8.04520606659376, -12.571113336665036, -2.063494102327816, -1.9491787520841335, 5.518124476805905, 0.03743514763384681, 8.142597410691167, 11.633823427462627, 7.228867520513255, -7.551777064597992, -29.74523658052452, -0.42582224866973917, 0.8507161534392544, 2.8199759912124307, -8.804290088016291, -15.779398435323401, 12.284259612335088, 13.4288454894124, -0.3612663303340895, 16.653883409098068, 32.7897693465733, 13.05729231336936, 4.375365219332714, 15.061374094565, 20.201947946316956, 15.9800709418026, -2.4463066767632355, -1.6615423642737888, -3.3922696068896725, 20.096355722370003, 30.16785656444523, 6.560418112982186, 19.31620702237207, -23.505078691205668, -47.72986543300034, 23.361327445499036, -6.858292248260401, 17.08227917068309, -13.246351701428662, -5.252716582256127, 14.744738526516997, 30.789309226821626, 27.80359902638893, 6.21769327779967, 12.457683465400084, -7.714323672846467, -12.988743186613684, 2.51009938764226, 1.373753446242553, -23.806391123276928, -28.38705684864756, -4.6623667539997875, 0.8823847859845442, -7.096502681366035, 8.082122863488394, -10.734430653080906, 14.292904112609234, 0.5484796364197653, -0.7965985539894156, 23.607577349951562, 13.560262719525687, -18.578794992701397, -17.511723467081644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48916690618358616, "mean_inference_ms": 1.3168204190654922, "mean_action_processing_ms": 0.20815121318835866, "mean_env_wait_ms": 0.0886646294968494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003359198570251465, "StateBufferConnector_ms": 0.0027976036071777344, "ViewRequirementAgentConnector_ms": 0.06572318077087402}, "num_episodes": 9, "episode_return_max": 31.11044260552017, "episode_return_min": -42.08151695907603, "episode_return_mean": -3.3053655064740908}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.97748919880013, "num_env_steps_trained_throughput_per_sec": 486.97748919880013, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 7871.255, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7871.211, "sample_time_ms": 779.831, "learn_time_ms": 7078.003, "learn_throughput": 565.131, "synch_weights_time_ms": 12.749}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "training_iteration": 17, "trial_id": "83a5c_00000", "date": "2024-08-10_12-16-14", "timestamp": 1723306574, "time_this_iter_s": 8.219337224960327, "time_total_s": 139.41836547851562, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f635af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 139.41836547851562, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.575, "ram_util_percent": 80.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7907293444430388, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.13042424948758, "policy_loss": -0.006627918012494408, "vf_loss": 4.136182459952339, "vf_explained_var": -0.3511844479217731, "kl": 0.011596089156980311, "entropy": 1.5253590276632358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7585725453992684, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.043506530672312, "policy_loss": -0.008044473388872575, "vf_loss": 4.049622699369987, "vf_explained_var": 0.1219545510907968, "kl": 0.019283114981066763, "entropy": 1.0727534948537747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 34.508178484533055, "episode_reward_min": -42.08151695907603, "episode_reward_mean": -4.742855777361808, "episode_len_mean": 382.3, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38230, "policy_reward_min": {"agent_policy": -34.508178484532934, "adversary_policy": -53.425028829319714}, "policy_reward_max": {"agent_policy": 42.081516959076026, "adversary_policy": 44.23359777857221}, "policy_reward_mean": {"agent_policy": 4.74285577736181, "adversary_policy": -4.742855777361811}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.188093447745093, -38.06390256923187, 9.243355568630982, 26.624666776316946, -14.638661763888287, -30.98715361690244, 14.009038762498337, 20.196399515397097, -33.32738562494926, -32.53659948488969, -41.94059570245023, 5.025486177844239, -25.643727739794485, -12.311365753694602, 12.932067780646983, 3.763036350245269, 14.484777609855534, -42.08151695907603, -25.996800334434415, -19.399029098147672, 10.042450533194048, -19.247027667265254, -18.03352662799239, -17.000812592196635, 9.397242556118819, -15.27783282273154, 0.3211514745736881, -29.205088032835402, -25.314317666226682, -32.3652995044451, -18.158010809632902, -10.07435107646715, -18.59014565697907, -5.014040577848752, 0.20946847263772028, 9.131689770415912, -5.900958595476814, -11.809503251872526, -5.078677928619468, -5.159565834907058, -3.8306454971663957, -5.326159847071571, -1.8596626143783705, -16.641246036360556, -6.656450648608191, -10.07045276018505, -15.606212837247146, -11.457891601370532, -11.082084360061879, 5.966107506067278, 8.228291484890432, 0.07615890527641156, -18.53163274121582, 6.584887792234813, 4.602585851440578, 22.94849831008917, 6.134576636910063, 3.5678434827192405, -0.7866697409451593, -7.317303719496426, 1.7844728623608859, 4.090016279162507, 9.43134547398794, -18.648506822561256, 0.21244695238475764, -2.992157048401932, -1.7475694114941565, 6.533789579539155, 24.7218263778357, 8.716328766351031, 17.631661020440966, 6.766882132519683, -2.526905985581733, 25.132106143407636, 12.938312567677118, -35.617472062103026, 8.251517598619316, 1.9179637346272127, 4.74601097213043, 29.29645412660523, 9.337688371599874, -10.351533429730088, 1.9419264169424038, -26.096723985962246, -1.8899909840076212, 0.49281009106118123, 1.7792367297641665, -0.1240594587848225, 18.583920034738608, -18.04525922989152, -26.593798566929713, -17.748326756386223, 29.093445553843054, 13.080799457754097, 9.49300538907429, -37.9458586310663, -37.01335217586435, -41.876234001352266, -20.905539371709793, 34.508178484533055], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 80, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-14.188093447745091, 38.06390256923191, -9.24335556863098, -26.62466677631695, 14.638661763888294, 30.987153616902454, -14.009038762498314, -20.196399515397093, 33.32738562494929, 32.53659948488969, 41.94059570245024, -5.025486177844239, 25.643727739794485, 12.311365753694602, -12.932067780647, -3.763036350245269, -14.484777609855525, 42.081516959076026, 25.996800334434415, 19.399029098147672, -10.042450533194048, 19.247027667265254, 18.03352662799239, 17.000812592196635, -9.397242556118815, 15.27783282273154, -0.3211514745736881, 29.205088032835427, 25.31431766622669, 32.365299504445076, 18.158010809632934, 10.07435107646715, 18.590145656979065, 5.014040577848752, -0.20946847263772028, -9.131689770415912, 5.900958595476814, 11.809503251872524, 5.07867792861947, 5.159565834907058, 3.8306454971663957, 5.326159847071571, 1.8596626143783705, 16.641246036360556, 6.656450648608191, 10.070452760185047, 15.606212837247147, 11.457891601370532, 11.08208436006188, -5.966107506067278, -8.228291484890432, -0.07615890527641156, 18.5316327412158, -6.584887792234813, -4.602585851440578, -22.948498310089164, -6.134576636910063, -3.5678434827192405, 0.7866697409451611, 7.317303719496426, -1.7844728623608859, -4.090016279162507, -9.43134547398794, 18.648506822561256, -0.21244695238475764, 2.9921570484019266, 1.7475694114941565, -6.533789579539155, -24.721826377835683, -8.716328766351033, -17.631661020441012, -6.766882132519681, 2.526905985581732, -25.132106143407633, -12.938312567677126, 35.61747206210302, -8.251517598619314, -1.9179637346272171, -4.7460109721304296, -29.296454126605276, -9.33768837159988, 10.351533429730079, -1.9419264169424082, 26.096723985962246, 1.8899909840076212, -0.49281009106118034, -1.7792367297641665, 0.1240594587848225, -18.583920034738604, 18.04525922989152, 26.593798566929713, 17.748326756386223, -29.093445553843083, -13.080799457754098, -9.493005389074302, 37.945858631066294, 37.01335217586431, 41.87623400135226, 20.905539371709793, -34.508178484532934], "policy_adversary_policy_reward": [3.8562394800093838, 24.519947415480786, -38.811093306531674, -37.31671183193218, 14.655156688524352, 3.8315544487376183, 24.806418468202644, 28.442915084431235, -4.912003941153571, -24.365319586623006, -32.635786509576285, -29.33852072422863, 9.137048131868754, 18.881029393127875, 26.863120399816953, 13.529678630977216, -23.965430100224417, -42.6893411496742, -31.3832862592157, -33.68991271056366, -41.83603902997241, -42.04515237492797, 2.6735990233121445, 7.377373332376333, -39.77872843537869, -11.508727044210282, -16.2907929158064, -8.331938591582805, 5.135985334556899, 20.728150226737057, -12.47517414140913, 20.001246841899682, 6.968987873742959, 22.00056734596804, -40.35215625434513, -43.810877663807005, -12.46365604334467, -39.52994462552416, -31.604665514380258, -7.1933926819150855, 18.58630878020084, 1.4985922861872538, -25.071857104411787, -13.422198230118717, -5.836809100292911, -30.23024415569187, -12.117085306082103, -21.88453987831117, 22.491758507719997, -3.6972733954823607, -16.766817394142368, -13.788848251320715, -1.240667371845415, 1.8829703209927913, -25.863605577310935, -32.546570488359905, -30.453843332295676, -20.17479200015769, -34.11711149829263, -30.613487510597537, -10.0102058193539, -26.30581579991196, -13.860987072719755, -6.2877150802145465, -5.181146333195542, -31.999144980762594, -13.57453626730619, 3.54645511160869, 11.70420972327507, -11.285272777999634, 7.1823706584760565, 11.081008882355768, -19.302258955955434, 7.5003417650018065, -25.266767866749284, 1.647761363004232, 7.431766946916767, -17.589122804155707, -9.264966520864132, -1.0541651489499841, 3.0574150630816597, -10.718706057414451, -13.949081887927445, 3.2967621937843035, -5.498358563675513, 1.779033334918772, -29.048468995550223, -4.234023077170882, 2.9634413086867326, -16.276342605903118, -0.1283729596727774, -20.01253256069732, -13.750515561648534, -17.46191011284578, -7.2848320837839395, -15.630951118957125, -17.750540664869146, -4.41362805525462, 10.333392375511096, 1.59882263662346, 5.5222230193573765, 10.934359950423488, 5.851206053386132, -5.698888242833309, -11.294810001374078, -25.768455481057515, 10.283812008905535, 2.885963575564091, -4.420719854889452, 13.625891557770608, 44.23359777857221, 1.6633988416061118, -2.2909701305357935, 14.56012340435592, 5.971698645623711, 1.16398831981477, 6.471866584703438, -8.04520606659376, -12.571113336665036, -2.063494102327816, -1.9491787520841335, 5.518124476805905, 0.03743514763384681, 8.142597410691167, 11.633823427462627, 7.228867520513255, -7.551777064597992, -29.74523658052452, -0.42582224866973917, 0.8507161534392544, 2.8199759912124307, -8.804290088016291, -15.779398435323401, 12.284259612335088, 13.4288454894124, -0.3612663303340895, 16.653883409098068, 32.7897693465733, 13.05729231336936, 4.375365219332714, 15.061374094565, 20.201947946316956, 15.9800709418026, -2.4463066767632355, -1.6615423642737888, -3.3922696068896725, 20.096355722370003, 30.16785656444523, 6.560418112982186, 19.31620702237207, -23.505078691205668, -47.72986543300034, 23.361327445499036, -6.858292248260401, 17.08227917068309, -13.246351701428662, -5.252716582256127, 14.744738526516997, 30.789309226821626, 27.80359902638893, 6.21769327779967, 12.457683465400084, -7.714323672846467, -12.988743186613684, 2.51009938764226, 1.373753446242553, -23.806391123276928, -28.38705684864756, -4.6623667539997875, 0.8823847859845442, -7.096502681366035, 8.082122863488394, -10.734430653080906, 14.292904112609234, 0.5484796364197653, -0.7965985539894156, 23.607577349951562, 13.560262719525687, -18.578794992701397, -17.511723467081644, -37.03864598939669, -16.148951144462735, -22.70397688727617, -12.792676625496277, 36.4009681914243, 21.78592291626186, 0.1185844963531526, 26.04301441915507, 13.24488748639984, 5.741123291748737, -23.69876124501735, -52.19295601711518, -33.229225316678296, -40.79747903505039, -53.425028829319714, -30.327439173384974, -20.66332093273858, -21.147757810681007, 35.33057490984038, 33.685782059225545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4811336531992251, "mean_inference_ms": 1.2917623642724443, "mean_action_processing_ms": 0.20513779099756527, "mean_env_wait_ms": 0.08666784378660833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034215450286865234, "StateBufferConnector_ms": 0.002834796905517578, "ViewRequirementAgentConnector_ms": 0.06702232360839844}, "num_episodes": 10, "episode_return_max": 34.508178484533055, "episode_return_min": -42.08151695907603, "episode_return_mean": -4.742855777361808}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 474.3432570741956, "num_env_steps_trained_throughput_per_sec": 474.3432570741956, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 7953.041, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7952.997, "sample_time_ms": 775.014, "learn_time_ms": 7164.171, "learn_throughput": 558.334, "synch_weights_time_ms": 13.19}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 18, "trial_id": "83a5c_00000", "date": "2024-08-10_12-16-23", "timestamp": 1723306583, "time_this_iter_s": 8.45418906211853, "time_total_s": 147.87255454063416, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f636a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 147.87255454063416, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.491666666666664, "ram_util_percent": 80.32499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.55666350821654, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7896639363475577, "policy_loss": -0.004933369238294227, "vf_loss": 3.7935987270698344, "vf_explained_var": -0.11555737559757535, "kl": 0.013314395901474855, "entropy": 1.5250542213677099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8314434129123884, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.138607354958852, "policy_loss": -0.00653110500134062, "vf_loss": 3.144163095702728, "vf_explained_var": 0.03362727115551631, "kl": 0.00975354079230543, "entropy": 1.0891381890823444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "env_runners": {"episode_reward_max": 34.508178484533055, "episode_reward_min": -42.08151695907603, "episode_reward_mean": -4.0618224247609, "episode_len_mean": 382.3, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38230, "policy_reward_min": {"agent_policy": -34.508178484532934, "adversary_policy": -53.425028829319714}, "policy_reward_max": {"agent_policy": 42.081516959076026, "adversary_policy": 44.23359777857221}, "policy_reward_mean": {"agent_policy": 4.061822424760899, "adversary_policy": -4.0618224247609}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.643727739794485, -12.311365753694602, 12.932067780646983, 3.763036350245269, 14.484777609855534, -42.08151695907603, -25.996800334434415, -19.399029098147672, 10.042450533194048, -19.247027667265254, -18.03352662799239, -17.000812592196635, 9.397242556118819, -15.27783282273154, 0.3211514745736881, -29.205088032835402, -25.314317666226682, -32.3652995044451, -18.158010809632902, -10.07435107646715, -18.59014565697907, -5.014040577848752, 0.20946847263772028, 9.131689770415912, -5.900958595476814, -11.809503251872526, -5.078677928619468, -5.159565834907058, -3.8306454971663957, -5.326159847071571, -1.8596626143783705, -16.641246036360556, -6.656450648608191, -10.07045276018505, -15.606212837247146, -11.457891601370532, -11.082084360061879, 5.966107506067278, 8.228291484890432, 0.07615890527641156, -18.53163274121582, 6.584887792234813, 4.602585851440578, 22.94849831008917, 6.134576636910063, 3.5678434827192405, -0.7866697409451593, -7.317303719496426, 1.7844728623608859, 4.090016279162507, 9.43134547398794, -18.648506822561256, 0.21244695238475764, -2.992157048401932, -1.7475694114941565, 6.533789579539155, 24.7218263778357, 8.716328766351031, 17.631661020440966, 6.766882132519683, -2.526905985581733, 25.132106143407636, 12.938312567677118, -35.617472062103026, 8.251517598619316, 1.9179637346272127, 4.74601097213043, 29.29645412660523, 9.337688371599874, -10.351533429730088, 1.9419264169424038, -26.096723985962246, -1.8899909840076212, 0.49281009106118123, 1.7792367297641665, -0.1240594587848225, 18.583920034738608, -18.04525922989152, -26.593798566929713, -17.748326756386223, 29.093445553843054, 13.080799457754097, 9.49300538907429, -37.9458586310663, -37.01335217586435, -41.876234001352266, -20.905539371709793, 34.508178484533055, -19.476565340915123, 11.83818203573399, -32.54098718817982, 18.163830843209475, 14.080078592303103, -1.0711107131324678, 29.262052127568417, -14.965274889235399, -39.43641534923553, 9.633381580845407, -22.93983695053654, 13.348741997786286], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 28, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 80, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [25.643727739794485, 12.311365753694602, -12.932067780647, -3.763036350245269, -14.484777609855525, 42.081516959076026, 25.996800334434415, 19.399029098147672, -10.042450533194048, 19.247027667265254, 18.03352662799239, 17.000812592196635, -9.397242556118815, 15.27783282273154, -0.3211514745736881, 29.205088032835427, 25.31431766622669, 32.365299504445076, 18.158010809632934, 10.07435107646715, 18.590145656979065, 5.014040577848752, -0.20946847263772028, -9.131689770415912, 5.900958595476814, 11.809503251872524, 5.07867792861947, 5.159565834907058, 3.8306454971663957, 5.326159847071571, 1.8596626143783705, 16.641246036360556, 6.656450648608191, 10.070452760185047, 15.606212837247147, 11.457891601370532, 11.08208436006188, -5.966107506067278, -8.228291484890432, -0.07615890527641156, 18.5316327412158, -6.584887792234813, -4.602585851440578, -22.948498310089164, -6.134576636910063, -3.5678434827192405, 0.7866697409451611, 7.317303719496426, -1.7844728623608859, -4.090016279162507, -9.43134547398794, 18.648506822561256, -0.21244695238475764, 2.9921570484019266, 1.7475694114941565, -6.533789579539155, -24.721826377835683, -8.716328766351033, -17.631661020441012, -6.766882132519681, 2.526905985581732, -25.132106143407633, -12.938312567677126, 35.61747206210302, -8.251517598619314, -1.9179637346272171, -4.7460109721304296, -29.296454126605276, -9.33768837159988, 10.351533429730079, -1.9419264169424082, 26.096723985962246, 1.8899909840076212, -0.49281009106118034, -1.7792367297641665, 0.1240594587848225, -18.583920034738604, 18.04525922989152, 26.593798566929713, 17.748326756386223, -29.093445553843083, -13.080799457754098, -9.493005389074302, 37.945858631066294, 37.01335217586431, 41.87623400135226, 20.905539371709793, -34.508178484532934, 19.476565340915123, -11.838182035733995, 32.54098718817981, -18.163830843209524, -14.080078592303101, 1.0711107131324678, -29.26205212756843, 14.965274889235399, 39.43641534923554, -9.633381580845413, 22.93983695053653, -13.34874199778628], "policy_adversary_policy_reward": [-39.77872843537869, -11.508727044210282, -16.2907929158064, -8.331938591582805, 5.135985334556899, 20.728150226737057, -12.47517414140913, 20.001246841899682, 6.968987873742959, 22.00056734596804, -40.35215625434513, -43.810877663807005, -12.46365604334467, -39.52994462552416, -31.604665514380258, -7.1933926819150855, 18.58630878020084, 1.4985922861872538, -25.071857104411787, -13.422198230118717, -5.836809100292911, -30.23024415569187, -12.117085306082103, -21.88453987831117, 22.491758507719997, -3.6972733954823607, -16.766817394142368, -13.788848251320715, -1.240667371845415, 1.8829703209927913, -25.863605577310935, -32.546570488359905, -30.453843332295676, -20.17479200015769, -34.11711149829263, -30.613487510597537, -10.0102058193539, -26.30581579991196, -13.860987072719755, -6.2877150802145465, -5.181146333195542, -31.999144980762594, -13.57453626730619, 3.54645511160869, 11.70420972327507, -11.285272777999634, 7.1823706584760565, 11.081008882355768, -19.302258955955434, 7.5003417650018065, -25.266767866749284, 1.647761363004232, 7.431766946916767, -17.589122804155707, -9.264966520864132, -1.0541651489499841, 3.0574150630816597, -10.718706057414451, -13.949081887927445, 3.2967621937843035, -5.498358563675513, 1.779033334918772, -29.048468995550223, -4.234023077170882, 2.9634413086867326, -16.276342605903118, -0.1283729596727774, -20.01253256069732, -13.750515561648534, -17.46191011284578, -7.2848320837839395, -15.630951118957125, -17.750540664869146, -4.41362805525462, 10.333392375511096, 1.59882263662346, 5.5222230193573765, 10.934359950423488, 5.851206053386132, -5.698888242833309, -11.294810001374078, -25.768455481057515, 10.283812008905535, 2.885963575564091, -4.420719854889452, 13.625891557770608, 44.23359777857221, 1.6633988416061118, -2.2909701305357935, 14.56012340435592, 5.971698645623711, 1.16398831981477, 6.471866584703438, -8.04520606659376, -12.571113336665036, -2.063494102327816, -1.9491787520841335, 5.518124476805905, 0.03743514763384681, 8.142597410691167, 11.633823427462627, 7.228867520513255, -7.551777064597992, -29.74523658052452, -0.42582224866973917, 0.8507161534392544, 2.8199759912124307, -8.804290088016291, -15.779398435323401, 12.284259612335088, 13.4288454894124, -0.3612663303340895, 16.653883409098068, 32.7897693465733, 13.05729231336936, 4.375365219332714, 15.061374094565, 20.201947946316956, 15.9800709418026, -2.4463066767632355, -1.6615423642737888, -3.3922696068896725, 20.096355722370003, 30.16785656444523, 6.560418112982186, 19.31620702237207, -23.505078691205668, -47.72986543300034, 23.361327445499036, -6.858292248260401, 17.08227917068309, -13.246351701428662, -5.252716582256127, 14.744738526516997, 30.789309226821626, 27.80359902638893, 6.21769327779967, 12.457683465400084, -7.714323672846467, -12.988743186613684, 2.51009938764226, 1.373753446242553, -23.806391123276928, -28.38705684864756, -4.6623667539997875, 0.8823847859845442, -7.096502681366035, 8.082122863488394, -10.734430653080906, 14.292904112609234, 0.5484796364197653, -0.7965985539894156, 23.607577349951562, 13.560262719525687, -18.578794992701397, -17.511723467081644, -37.03864598939669, -16.148951144462735, -22.70397688727617, -12.792676625496277, 36.4009681914243, 21.78592291626186, 0.1185844963531526, 26.04301441915507, 13.24488748639984, 5.741123291748737, -23.69876124501735, -52.19295601711518, -33.229225316678296, -40.79747903505039, -53.425028829319714, -30.327439173384974, -20.66332093273858, -21.147757810681007, 35.33057490984038, 33.685782059225545, -24.31905426486849, -14.634076416961754, -1.4988443602220087, 25.175208431690017, -34.38967078423392, -30.69230359212567, 14.422442469362696, 21.905219217056402, 15.249659283026165, 12.91049790158002, -7.8473551184249555, 5.70513369216002, 27.91191893001333, 30.612185325123537, -11.031858151763892, -18.898691626706906, -50.27571919312325, -28.597111505347854, 3.482797207794265, 15.783965953896569, -12.263945389057369, -33.6157285120157, 1.2968529221862717, 25.400631073386293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47355264166969685, "mean_inference_ms": 1.2665454817069677, "mean_action_processing_ms": 0.20172606407669744, "mean_env_wait_ms": 0.08483200556424618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003541111946105957, "StateBufferConnector_ms": 0.002878546714782715, "ViewRequirementAgentConnector_ms": 0.0684736967086792}, "num_episodes": 12, "episode_return_max": 34.508178484533055, "episode_return_min": -42.08151695907603, "episode_return_mean": -4.0618224247609}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.7769785720474, "num_env_steps_trained_throughput_per_sec": 487.7769785720474, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 8040.952, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8040.909, "sample_time_ms": 783.779, "learn_time_ms": 7242.835, "learn_throughput": 552.27, "synch_weights_time_ms": 13.635}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "training_iteration": 19, "trial_id": "83a5c_00000", "date": "2024-08-10_12-16-31", "timestamp": 1723306591, "time_this_iter_s": 8.205255031585693, "time_total_s": 156.07780957221985, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f636c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 156.07780957221985, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 26.7, "ram_util_percent": 80.14999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7911512637737568, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.311283440312381, "policy_loss": -0.0066990087158662615, "vf_loss": 4.317070524150101, "vf_explained_var": -0.658463779832951, "kl": 0.012159112659267135, "entropy": 1.5507473123136652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8694575970371563, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6453108782569568, "policy_loss": -0.0059620224875592005, "vf_loss": 3.6499405041337014, "vf_explained_var": 0.06937218885868787, "kl": 0.013323970674170274, "entropy": 1.0373073436319828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 34.508178484533055, "episode_reward_min": -41.876234001352266, "episode_reward_mean": -3.495665720619452, "episode_len_mean": 378.38, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37838, "policy_reward_min": {"agent_policy": -34.508178484532934, "adversary_policy": -53.425028829319714}, "policy_reward_max": {"agent_policy": 41.87623400135226, "adversary_policy": 44.23359777857221}, "policy_reward_mean": {"agent_policy": 3.4956657206194506, "adversary_policy": -3.4956657206194506}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.397242556118819, -15.27783282273154, 0.3211514745736881, -29.205088032835402, -25.314317666226682, -32.3652995044451, -18.158010809632902, -10.07435107646715, -18.59014565697907, -5.014040577848752, 0.20946847263772028, 9.131689770415912, -5.900958595476814, -11.809503251872526, -5.078677928619468, -5.159565834907058, -3.8306454971663957, -5.326159847071571, -1.8596626143783705, -16.641246036360556, -6.656450648608191, -10.07045276018505, -15.606212837247146, -11.457891601370532, -11.082084360061879, 5.966107506067278, 8.228291484890432, 0.07615890527641156, -18.53163274121582, 6.584887792234813, 4.602585851440578, 22.94849831008917, 6.134576636910063, 3.5678434827192405, -0.7866697409451593, -7.317303719496426, 1.7844728623608859, 4.090016279162507, 9.43134547398794, -18.648506822561256, 0.21244695238475764, -2.992157048401932, -1.7475694114941565, 6.533789579539155, 24.7218263778357, 8.716328766351031, 17.631661020440966, 6.766882132519683, -2.526905985581733, 25.132106143407636, 12.938312567677118, -35.617472062103026, 8.251517598619316, 1.9179637346272127, 4.74601097213043, 29.29645412660523, 9.337688371599874, -10.351533429730088, 1.9419264169424038, -26.096723985962246, -1.8899909840076212, 0.49281009106118123, 1.7792367297641665, -0.1240594587848225, 18.583920034738608, -18.04525922989152, -26.593798566929713, -17.748326756386223, 29.093445553843054, 13.080799457754097, 9.49300538907429, -37.9458586310663, -37.01335217586435, -41.876234001352266, -20.905539371709793, 34.508178484533055, -19.476565340915123, 11.83818203573399, -32.54098718817982, 18.163830843209475, 14.080078592303103, -1.0711107131324678, 29.262052127568417, -14.965274889235399, -39.43641534923553, 9.633381580845407, -22.93983695053654, 13.348741997786286, -35.43493189955169, -34.79760610694063, -18.72319505144694, 0.5843229747291101, 5.939214487469998, 1.2611985412816156, -19.91499414184244, 2.8138885542761916, -31.839931623748626, 6.65979059035633, 21.167677058627216, 20.408762532275095], "episode_lengths": [28, 400, 2, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 80, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-9.397242556118815, 15.27783282273154, -0.3211514745736881, 29.205088032835427, 25.31431766622669, 32.365299504445076, 18.158010809632934, 10.07435107646715, 18.590145656979065, 5.014040577848752, -0.20946847263772028, -9.131689770415912, 5.900958595476814, 11.809503251872524, 5.07867792861947, 5.159565834907058, 3.8306454971663957, 5.326159847071571, 1.8596626143783705, 16.641246036360556, 6.656450648608191, 10.070452760185047, 15.606212837247147, 11.457891601370532, 11.08208436006188, -5.966107506067278, -8.228291484890432, -0.07615890527641156, 18.5316327412158, -6.584887792234813, -4.602585851440578, -22.948498310089164, -6.134576636910063, -3.5678434827192405, 0.7866697409451611, 7.317303719496426, -1.7844728623608859, -4.090016279162507, -9.43134547398794, 18.648506822561256, -0.21244695238475764, 2.9921570484019266, 1.7475694114941565, -6.533789579539155, -24.721826377835683, -8.716328766351033, -17.631661020441012, -6.766882132519681, 2.526905985581732, -25.132106143407633, -12.938312567677126, 35.61747206210302, -8.251517598619314, -1.9179637346272171, -4.7460109721304296, -29.296454126605276, -9.33768837159988, 10.351533429730079, -1.9419264169424082, 26.096723985962246, 1.8899909840076212, -0.49281009106118034, -1.7792367297641665, 0.1240594587848225, -18.583920034738604, 18.04525922989152, 26.593798566929713, 17.748326756386223, -29.093445553843083, -13.080799457754098, -9.493005389074302, 37.945858631066294, 37.01335217586431, 41.87623400135226, 20.905539371709793, -34.508178484532934, 19.476565340915123, -11.838182035733995, 32.54098718817981, -18.163830843209524, -14.080078592303101, 1.0711107131324678, -29.26205212756843, 14.965274889235399, 39.43641534923554, -9.633381580845413, 22.93983695053653, -13.34874199778628, 35.434931899551685, 34.79760610694062, 18.72319505144694, -0.5843229747291101, -5.939214487469997, -1.2611985412816158, 19.91499414184244, -2.8138885542761916, 31.83993162374862, -6.659790590356339, -21.16767705862722, -20.408762532275077], "policy_adversary_policy_reward": [22.491758507719997, -3.6972733954823607, -16.766817394142368, -13.788848251320715, -1.240667371845415, 1.8829703209927913, -25.863605577310935, -32.546570488359905, -30.453843332295676, -20.17479200015769, -34.11711149829263, -30.613487510597537, -10.0102058193539, -26.30581579991196, -13.860987072719755, -6.2877150802145465, -5.181146333195542, -31.999144980762594, -13.57453626730619, 3.54645511160869, 11.70420972327507, -11.285272777999634, 7.1823706584760565, 11.081008882355768, -19.302258955955434, 7.5003417650018065, -25.266767866749284, 1.647761363004232, 7.431766946916767, -17.589122804155707, -9.264966520864132, -1.0541651489499841, 3.0574150630816597, -10.718706057414451, -13.949081887927445, 3.2967621937843035, -5.498358563675513, 1.779033334918772, -29.048468995550223, -4.234023077170882, 2.9634413086867326, -16.276342605903118, -0.1283729596727774, -20.01253256069732, -13.750515561648534, -17.46191011284578, -7.2848320837839395, -15.630951118957125, -17.750540664869146, -4.41362805525462, 10.333392375511096, 1.59882263662346, 5.5222230193573765, 10.934359950423488, 5.851206053386132, -5.698888242833309, -11.294810001374078, -25.768455481057515, 10.283812008905535, 2.885963575564091, -4.420719854889452, 13.625891557770608, 44.23359777857221, 1.6633988416061118, -2.2909701305357935, 14.56012340435592, 5.971698645623711, 1.16398831981477, 6.471866584703438, -8.04520606659376, -12.571113336665036, -2.063494102327816, -1.9491787520841335, 5.518124476805905, 0.03743514763384681, 8.142597410691167, 11.633823427462627, 7.228867520513255, -7.551777064597992, -29.74523658052452, -0.42582224866973917, 0.8507161534392544, 2.8199759912124307, -8.804290088016291, -15.779398435323401, 12.284259612335088, 13.4288454894124, -0.3612663303340895, 16.653883409098068, 32.7897693465733, 13.05729231336936, 4.375365219332714, 15.061374094565, 20.201947946316956, 15.9800709418026, -2.4463066767632355, -1.6615423642737888, -3.3922696068896725, 20.096355722370003, 30.16785656444523, 6.560418112982186, 19.31620702237207, -23.505078691205668, -47.72986543300034, 23.361327445499036, -6.858292248260401, 17.08227917068309, -13.246351701428662, -5.252716582256127, 14.744738526516997, 30.789309226821626, 27.80359902638893, 6.21769327779967, 12.457683465400084, -7.714323672846467, -12.988743186613684, 2.51009938764226, 1.373753446242553, -23.806391123276928, -28.38705684864756, -4.6623667539997875, 0.8823847859845442, -7.096502681366035, 8.082122863488394, -10.734430653080906, 14.292904112609234, 0.5484796364197653, -0.7965985539894156, 23.607577349951562, 13.560262719525687, -18.578794992701397, -17.511723467081644, -37.03864598939669, -16.148951144462735, -22.70397688727617, -12.792676625496277, 36.4009681914243, 21.78592291626186, 0.1185844963531526, 26.04301441915507, 13.24488748639984, 5.741123291748737, -23.69876124501735, -52.19295601711518, -33.229225316678296, -40.79747903505039, -53.425028829319714, -30.327439173384974, -20.66332093273858, -21.147757810681007, 35.33057490984038, 33.685782059225545, -24.31905426486849, -14.634076416961754, -1.4988443602220087, 25.175208431690017, -34.38967078423392, -30.69230359212567, 14.422442469362696, 21.905219217056402, 15.249659283026165, 12.91049790158002, -7.8473551184249555, 5.70513369216002, 27.91191893001333, 30.612185325123537, -11.031858151763892, -18.898691626706906, -50.27571919312325, -28.597111505347854, 3.482797207794265, 15.783965953896569, -12.263945389057369, -33.6157285120157, 1.2968529221862717, 25.400631073386293, -30.070646136127166, -40.79921766297633, -38.581491190190455, -31.01372102369075, -34.08511800330234, -3.361272099591538, -11.241384622569768, 12.410030572027988, 5.780643389994719, 6.097785584945292, -11.360528407762926, 13.882925490326157, -31.989811621567917, -7.840176662116967, -0.2875740799508648, 5.915351188503248, -14.752328997963936, -48.9275342495333, -3.944746092038349, 17.264327272751043, 18.029095971806477, 24.306258145447952, 15.728466475516942, 25.08905858903322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46694023834704645, "mean_inference_ms": 1.2450544219046178, "mean_action_processing_ms": 0.19876150505983875, "mean_env_wait_ms": 0.08326068028297322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003598809242248535, "StateBufferConnector_ms": 0.0029449462890625, "ViewRequirementAgentConnector_ms": 0.06982660293579102}, "num_episodes": 12, "episode_return_max": 34.508178484533055, "episode_return_min": -41.876234001352266, "episode_return_mean": -3.495665720619452}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.7309557101904, "num_env_steps_trained_throughput_per_sec": 500.7309557101904, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 8073.663, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8073.628, "sample_time_ms": 776.701, "learn_time_ms": 7283.277, "learn_throughput": 549.203, "synch_weights_time_ms": 13.151}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 20, "trial_id": "83a5c_00000", "date": "2024-08-10_12-16-39", "timestamp": 1723306599, "time_this_iter_s": 7.994219064712524, "time_total_s": 164.07202863693237, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5c9c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.07202863693237, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 26.745454545454546, "ram_util_percent": 80.37272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8448116365563934, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.975947995665212, "policy_loss": -0.009580445944986962, "vf_loss": 4.9840171449398865, "vf_explained_var": -0.47010957434694606, "kl": 0.0201506679523301, "entropy": 1.5468879914157605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9909672727497916, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.042706252634526, "policy_loss": -0.006815685720115047, "vf_loss": 4.048423228412867, "vf_explained_var": 0.024779623933136465, "kl": 0.010987280328257428, "entropy": 1.0073125697051486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "env_runners": {"episode_reward_max": 34.508178484533055, "episode_reward_min": -41.876234001352266, "episode_reward_mean": -3.1799494425345927, "episode_len_mean": 386.08, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38608, "policy_reward_min": {"agent_policy": -34.508178484532934, "adversary_policy": -53.425028829319714}, "policy_reward_max": {"agent_policy": 41.87623400135226, "adversary_policy": 44.23359777857221}, "policy_reward_mean": {"agent_policy": 3.1799494425345904, "adversary_policy": -3.179949442534592}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.20946847263772028, 9.131689770415912, -5.900958595476814, -11.809503251872526, -5.078677928619468, -5.159565834907058, -3.8306454971663957, -5.326159847071571, -1.8596626143783705, -16.641246036360556, -6.656450648608191, -10.07045276018505, -15.606212837247146, -11.457891601370532, -11.082084360061879, 5.966107506067278, 8.228291484890432, 0.07615890527641156, -18.53163274121582, 6.584887792234813, 4.602585851440578, 22.94849831008917, 6.134576636910063, 3.5678434827192405, -0.7866697409451593, -7.317303719496426, 1.7844728623608859, 4.090016279162507, 9.43134547398794, -18.648506822561256, 0.21244695238475764, -2.992157048401932, -1.7475694114941565, 6.533789579539155, 24.7218263778357, 8.716328766351031, 17.631661020440966, 6.766882132519683, -2.526905985581733, 25.132106143407636, 12.938312567677118, -35.617472062103026, 8.251517598619316, 1.9179637346272127, 4.74601097213043, 29.29645412660523, 9.337688371599874, -10.351533429730088, 1.9419264169424038, -26.096723985962246, -1.8899909840076212, 0.49281009106118123, 1.7792367297641665, -0.1240594587848225, 18.583920034738608, -18.04525922989152, -26.593798566929713, -17.748326756386223, 29.093445553843054, 13.080799457754097, 9.49300538907429, -37.9458586310663, -37.01335217586435, -41.876234001352266, -20.905539371709793, 34.508178484533055, -19.476565340915123, 11.83818203573399, -32.54098718817982, 18.163830843209475, 14.080078592303103, -1.0711107131324678, 29.262052127568417, -14.965274889235399, -39.43641534923553, 9.633381580845407, -22.93983695053654, 13.348741997786286, -35.43493189955169, -34.79760610694063, -18.72319505144694, 0.5843229747291101, 5.939214487469998, 1.2611985412816156, -19.91499414184244, 2.8138885542761916, -31.839931623748626, 6.65979059035633, 21.167677058627216, 20.408762532275095, -6.572536578367412, -26.02962317816581, -28.11337062096422, 10.159807727479107, -20.34155118524857, 4.271219926970527, -7.692020956106793, 4.539083737982319, -12.61898813016671, -30.311085051400656], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 80, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-0.20946847263772028, -9.131689770415912, 5.900958595476814, 11.809503251872524, 5.07867792861947, 5.159565834907058, 3.8306454971663957, 5.326159847071571, 1.8596626143783705, 16.641246036360556, 6.656450648608191, 10.070452760185047, 15.606212837247147, 11.457891601370532, 11.08208436006188, -5.966107506067278, -8.228291484890432, -0.07615890527641156, 18.5316327412158, -6.584887792234813, -4.602585851440578, -22.948498310089164, -6.134576636910063, -3.5678434827192405, 0.7866697409451611, 7.317303719496426, -1.7844728623608859, -4.090016279162507, -9.43134547398794, 18.648506822561256, -0.21244695238475764, 2.9921570484019266, 1.7475694114941565, -6.533789579539155, -24.721826377835683, -8.716328766351033, -17.631661020441012, -6.766882132519681, 2.526905985581732, -25.132106143407633, -12.938312567677126, 35.61747206210302, -8.251517598619314, -1.9179637346272171, -4.7460109721304296, -29.296454126605276, -9.33768837159988, 10.351533429730079, -1.9419264169424082, 26.096723985962246, 1.8899909840076212, -0.49281009106118034, -1.7792367297641665, 0.1240594587848225, -18.583920034738604, 18.04525922989152, 26.593798566929713, 17.748326756386223, -29.093445553843083, -13.080799457754098, -9.493005389074302, 37.945858631066294, 37.01335217586431, 41.87623400135226, 20.905539371709793, -34.508178484532934, 19.476565340915123, -11.838182035733995, 32.54098718817981, -18.163830843209524, -14.080078592303101, 1.0711107131324678, -29.26205212756843, 14.965274889235399, 39.43641534923554, -9.633381580845413, 22.93983695053653, -13.34874199778628, 35.434931899551685, 34.79760610694062, 18.72319505144694, -0.5843229747291101, -5.939214487469997, -1.2611985412816158, 19.91499414184244, -2.8138885542761916, 31.83993162374862, -6.659790590356339, -21.16767705862722, -20.408762532275077, 6.572536578367411, 26.02962317816581, 28.11337062096422, -10.159807727479109, 20.341551185248566, -4.271219926970534, 7.692020956106793, -4.539083737982313, 12.61898813016671, 30.31108505140064], "policy_adversary_policy_reward": [11.70420972327507, -11.285272777999634, 7.1823706584760565, 11.081008882355768, -19.302258955955434, 7.5003417650018065, -25.266767866749284, 1.647761363004232, 7.431766946916767, -17.589122804155707, -9.264966520864132, -1.0541651489499841, 3.0574150630816597, -10.718706057414451, -13.949081887927445, 3.2967621937843035, -5.498358563675513, 1.779033334918772, -29.048468995550223, -4.234023077170882, 2.9634413086867326, -16.276342605903118, -0.1283729596727774, -20.01253256069732, -13.750515561648534, -17.46191011284578, -7.2848320837839395, -15.630951118957125, -17.750540664869146, -4.41362805525462, 10.333392375511096, 1.59882263662346, 5.5222230193573765, 10.934359950423488, 5.851206053386132, -5.698888242833309, -11.294810001374078, -25.768455481057515, 10.283812008905535, 2.885963575564091, -4.420719854889452, 13.625891557770608, 44.23359777857221, 1.6633988416061118, -2.2909701305357935, 14.56012340435592, 5.971698645623711, 1.16398831981477, 6.471866584703438, -8.04520606659376, -12.571113336665036, -2.063494102327816, -1.9491787520841335, 5.518124476805905, 0.03743514763384681, 8.142597410691167, 11.633823427462627, 7.228867520513255, -7.551777064597992, -29.74523658052452, -0.42582224866973917, 0.8507161534392544, 2.8199759912124307, -8.804290088016291, -15.779398435323401, 12.284259612335088, 13.4288454894124, -0.3612663303340895, 16.653883409098068, 32.7897693465733, 13.05729231336936, 4.375365219332714, 15.061374094565, 20.201947946316956, 15.9800709418026, -2.4463066767632355, -1.6615423642737888, -3.3922696068896725, 20.096355722370003, 30.16785656444523, 6.560418112982186, 19.31620702237207, -23.505078691205668, -47.72986543300034, 23.361327445499036, -6.858292248260401, 17.08227917068309, -13.246351701428662, -5.252716582256127, 14.744738526516997, 30.789309226821626, 27.80359902638893, 6.21769327779967, 12.457683465400084, -7.714323672846467, -12.988743186613684, 2.51009938764226, 1.373753446242553, -23.806391123276928, -28.38705684864756, -4.6623667539997875, 0.8823847859845442, -7.096502681366035, 8.082122863488394, -10.734430653080906, 14.292904112609234, 0.5484796364197653, -0.7965985539894156, 23.607577349951562, 13.560262719525687, -18.578794992701397, -17.511723467081644, -37.03864598939669, -16.148951144462735, -22.70397688727617, -12.792676625496277, 36.4009681914243, 21.78592291626186, 0.1185844963531526, 26.04301441915507, 13.24488748639984, 5.741123291748737, -23.69876124501735, -52.19295601711518, -33.229225316678296, -40.79747903505039, -53.425028829319714, -30.327439173384974, -20.66332093273858, -21.147757810681007, 35.33057490984038, 33.685782059225545, -24.31905426486849, -14.634076416961754, -1.4988443602220087, 25.175208431690017, -34.38967078423392, -30.69230359212567, 14.422442469362696, 21.905219217056402, 15.249659283026165, 12.91049790158002, -7.8473551184249555, 5.70513369216002, 27.91191893001333, 30.612185325123537, -11.031858151763892, -18.898691626706906, -50.27571919312325, -28.597111505347854, 3.482797207794265, 15.783965953896569, -12.263945389057369, -33.6157285120157, 1.2968529221862717, 25.400631073386293, -30.070646136127166, -40.79921766297633, -38.581491190190455, -31.01372102369075, -34.08511800330234, -3.361272099591538, -11.241384622569768, 12.410030572027988, 5.780643389994719, 6.097785584945292, -11.360528407762926, 13.882925490326157, -31.989811621567917, -7.840176662116967, -0.2875740799508648, 5.915351188503248, -14.752328997963936, -48.9275342495333, -3.944746092038349, 17.264327272751043, 18.029095971806477, 24.306258145447952, 15.728466475516942, 25.08905858903322, -4.606836444589314, -8.538236712145508, -31.888182772452183, -20.17106358387944, -26.044760604672305, -30.18198063725614, 4.861090806864951, 15.45852464809327, -8.04463337929014, -32.63846899120699, -9.519198536987496, 18.061638390928543, -2.110224463262373, -13.273817448951213, -19.779480442855444, 28.85764791882008, -12.062990233462841, -13.174986026870577, -42.98329493541586, -17.638875167385493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46175944611383835, "mean_inference_ms": 1.2288647474675312, "mean_action_processing_ms": 0.19657257650793747, "mean_env_wait_ms": 0.0820800498411594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003651142120361328, "StateBufferConnector_ms": 0.002917766571044922, "ViewRequirementAgentConnector_ms": 0.06812119483947754}, "num_episodes": 10, "episode_return_max": 34.508178484533055, "episode_return_min": -41.876234001352266, "episode_return_mean": -3.1799494425345927}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.0031484064229, "num_env_steps_trained_throughput_per_sec": 497.0031484064229, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 8121.6, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8121.565, "sample_time_ms": 772.266, "learn_time_ms": 7335.494, "learn_throughput": 545.294, "synch_weights_time_ms": 13.314}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "training_iteration": 21, "trial_id": "83a5c_00000", "date": "2024-08-10_12-16-47", "timestamp": 1723306607, "time_this_iter_s": 8.053327083587646, "time_total_s": 172.12535572052002, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 172.12535572052002, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.108333333333334, "ram_util_percent": 80.49166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9606725464106867, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.80249799899954, "policy_loss": -0.005157036527562591, "vf_loss": 5.806314777192616, "vf_explained_var": -0.09972525967491998, "kl": 0.011913334055291663, "entropy": 1.5063090277096582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1023087737460933, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.84579402183493, "policy_loss": -0.004415751743848281, "vf_loss": 4.849516761799653, "vf_explained_var": 0.10359327246745427, "kl": 0.00693011951378425, "entropy": 0.9353914850701889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 34.508178484533055, "episode_reward_min": -41.876234001352266, "episode_reward_mean": -3.462401013163921, "episode_len_mean": 386.08, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38608, "policy_reward_min": {"agent_policy": -34.508178484532934, "adversary_policy": -53.425028829319714}, "policy_reward_max": {"agent_policy": 41.87623400135226, "adversary_policy": 44.23359777857221}, "policy_reward_mean": {"agent_policy": 3.4624010131639187, "adversary_policy": -3.4624010131639205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.07045276018505, -15.606212837247146, -11.457891601370532, -11.082084360061879, 5.966107506067278, 8.228291484890432, 0.07615890527641156, -18.53163274121582, 6.584887792234813, 4.602585851440578, 22.94849831008917, 6.134576636910063, 3.5678434827192405, -0.7866697409451593, -7.317303719496426, 1.7844728623608859, 4.090016279162507, 9.43134547398794, -18.648506822561256, 0.21244695238475764, -2.992157048401932, -1.7475694114941565, 6.533789579539155, 24.7218263778357, 8.716328766351031, 17.631661020440966, 6.766882132519683, -2.526905985581733, 25.132106143407636, 12.938312567677118, -35.617472062103026, 8.251517598619316, 1.9179637346272127, 4.74601097213043, 29.29645412660523, 9.337688371599874, -10.351533429730088, 1.9419264169424038, -26.096723985962246, -1.8899909840076212, 0.49281009106118123, 1.7792367297641665, -0.1240594587848225, 18.583920034738608, -18.04525922989152, -26.593798566929713, -17.748326756386223, 29.093445553843054, 13.080799457754097, 9.49300538907429, -37.9458586310663, -37.01335217586435, -41.876234001352266, -20.905539371709793, 34.508178484533055, -19.476565340915123, 11.83818203573399, -32.54098718817982, 18.163830843209475, 14.080078592303103, -1.0711107131324678, 29.262052127568417, -14.965274889235399, -39.43641534923553, 9.633381580845407, -22.93983695053654, 13.348741997786286, -35.43493189955169, -34.79760610694063, -18.72319505144694, 0.5843229747291101, 5.939214487469998, 1.2611985412816156, -19.91499414184244, 2.8138885542761916, -31.839931623748626, 6.65979059035633, 21.167677058627216, 20.408762532275095, -6.572536578367412, -26.02962317816581, -28.11337062096422, 10.159807727479107, -20.34155118524857, 4.271219926970527, -7.692020956106793, 4.539083737982319, -12.61898813016671, -30.311085051400656, -15.858393101855881, 14.847528679960751, -15.949169954444068, -16.788603246045355, -13.82334799227834, -4.643459969995208, -9.582078785007027, -11.409768516980353, 11.343635353634689, 3.827994709675318, -23.131206251004663], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 80, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [10.070452760185047, 15.606212837247147, 11.457891601370532, 11.08208436006188, -5.966107506067278, -8.228291484890432, -0.07615890527641156, 18.5316327412158, -6.584887792234813, -4.602585851440578, -22.948498310089164, -6.134576636910063, -3.5678434827192405, 0.7866697409451611, 7.317303719496426, -1.7844728623608859, -4.090016279162507, -9.43134547398794, 18.648506822561256, -0.21244695238475764, 2.9921570484019266, 1.7475694114941565, -6.533789579539155, -24.721826377835683, -8.716328766351033, -17.631661020441012, -6.766882132519681, 2.526905985581732, -25.132106143407633, -12.938312567677126, 35.61747206210302, -8.251517598619314, -1.9179637346272171, -4.7460109721304296, -29.296454126605276, -9.33768837159988, 10.351533429730079, -1.9419264169424082, 26.096723985962246, 1.8899909840076212, -0.49281009106118034, -1.7792367297641665, 0.1240594587848225, -18.583920034738604, 18.04525922989152, 26.593798566929713, 17.748326756386223, -29.093445553843083, -13.080799457754098, -9.493005389074302, 37.945858631066294, 37.01335217586431, 41.87623400135226, 20.905539371709793, -34.508178484532934, 19.476565340915123, -11.838182035733995, 32.54098718817981, -18.163830843209524, -14.080078592303101, 1.0711107131324678, -29.26205212756843, 14.965274889235399, 39.43641534923554, -9.633381580845413, 22.93983695053653, -13.34874199778628, 35.434931899551685, 34.79760610694062, 18.72319505144694, -0.5843229747291101, -5.939214487469997, -1.2611985412816158, 19.91499414184244, -2.8138885542761916, 31.83993162374862, -6.659790590356339, -21.16767705862722, -20.408762532275077, 6.572536578367411, 26.02962317816581, 28.11337062096422, -10.159807727479109, 20.341551185248566, -4.271219926970534, 7.692020956106793, -4.539083737982313, 12.61898813016671, 30.31108505140064, 15.858393101855881, -14.847528679960751, 15.949169954444063, 16.788603246045362, 13.823347992278338, 4.643459969995208, 9.582078785007027, 11.409768516980353, -11.343635353634689, -3.827994709675319, 23.131206251004667], "policy_adversary_policy_reward": [-0.1283729596727774, -20.01253256069732, -13.750515561648534, -17.46191011284578, -7.2848320837839395, -15.630951118957125, -17.750540664869146, -4.41362805525462, 10.333392375511096, 1.59882263662346, 5.5222230193573765, 10.934359950423488, 5.851206053386132, -5.698888242833309, -11.294810001374078, -25.768455481057515, 10.283812008905535, 2.885963575564091, -4.420719854889452, 13.625891557770608, 44.23359777857221, 1.6633988416061118, -2.2909701305357935, 14.56012340435592, 5.971698645623711, 1.16398831981477, 6.471866584703438, -8.04520606659376, -12.571113336665036, -2.063494102327816, -1.9491787520841335, 5.518124476805905, 0.03743514763384681, 8.142597410691167, 11.633823427462627, 7.228867520513255, -7.551777064597992, -29.74523658052452, -0.42582224866973917, 0.8507161534392544, 2.8199759912124307, -8.804290088016291, -15.779398435323401, 12.284259612335088, 13.4288454894124, -0.3612663303340895, 16.653883409098068, 32.7897693465733, 13.05729231336936, 4.375365219332714, 15.061374094565, 20.201947946316956, 15.9800709418026, -2.4463066767632355, -1.6615423642737888, -3.3922696068896725, 20.096355722370003, 30.16785656444523, 6.560418112982186, 19.31620702237207, -23.505078691205668, -47.72986543300034, 23.361327445499036, -6.858292248260401, 17.08227917068309, -13.246351701428662, -5.252716582256127, 14.744738526516997, 30.789309226821626, 27.80359902638893, 6.21769327779967, 12.457683465400084, -7.714323672846467, -12.988743186613684, 2.51009938764226, 1.373753446242553, -23.806391123276928, -28.38705684864756, -4.6623667539997875, 0.8823847859845442, -7.096502681366035, 8.082122863488394, -10.734430653080906, 14.292904112609234, 0.5484796364197653, -0.7965985539894156, 23.607577349951562, 13.560262719525687, -18.578794992701397, -17.511723467081644, -37.03864598939669, -16.148951144462735, -22.70397688727617, -12.792676625496277, 36.4009681914243, 21.78592291626186, 0.1185844963531526, 26.04301441915507, 13.24488748639984, 5.741123291748737, -23.69876124501735, -52.19295601711518, -33.229225316678296, -40.79747903505039, -53.425028829319714, -30.327439173384974, -20.66332093273858, -21.147757810681007, 35.33057490984038, 33.685782059225545, -24.31905426486849, -14.634076416961754, -1.4988443602220087, 25.175208431690017, -34.38967078423392, -30.69230359212567, 14.422442469362696, 21.905219217056402, 15.249659283026165, 12.91049790158002, -7.8473551184249555, 5.70513369216002, 27.91191893001333, 30.612185325123537, -11.031858151763892, -18.898691626706906, -50.27571919312325, -28.597111505347854, 3.482797207794265, 15.783965953896569, -12.263945389057369, -33.6157285120157, 1.2968529221862717, 25.400631073386293, -30.070646136127166, -40.79921766297633, -38.581491190190455, -31.01372102369075, -34.08511800330234, -3.361272099591538, -11.241384622569768, 12.410030572027988, 5.780643389994719, 6.097785584945292, -11.360528407762926, 13.882925490326157, -31.989811621567917, -7.840176662116967, -0.2875740799508648, 5.915351188503248, -14.752328997963936, -48.9275342495333, -3.944746092038349, 17.264327272751043, 18.029095971806477, 24.306258145447952, 15.728466475516942, 25.08905858903322, -4.606836444589314, -8.538236712145508, -31.888182772452183, -20.17106358387944, -26.044760604672305, -30.18198063725614, 4.861090806864951, 15.45852464809327, -8.04463337929014, -32.63846899120699, -9.519198536987496, 18.061638390928543, -2.110224463262373, -13.273817448951213, -19.779480442855444, 28.85764791882008, -12.062990233462841, -13.174986026870577, -42.98329493541586, -17.638875167385493, -22.23178011069311, -9.485006093018654, 1.4766145068826617, 28.21844285303884, -12.505778205010628, -19.39256170387751, -22.684793350333763, -10.89241314175695, -29.553388464247618, 1.9066924796909284, -21.603463906510928, 12.316543966520513, -2.440342880144101, -16.723814689869954, -23.63155451612782, 0.8120174821671142, -0.5404185782784019, 23.22768928554778, -7.934435757922296, 15.590425177272934, -22.892788503793835, -23.369623998215527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45674668391091544, "mean_inference_ms": 1.2128594949416958, "mean_action_processing_ms": 0.19443766635184886, "mean_env_wait_ms": 0.08083926204959038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003679633140563965, "StateBufferConnector_ms": 0.002912282943725586, "ViewRequirementAgentConnector_ms": 0.0682903528213501}, "num_episodes": 11, "episode_return_max": 34.508178484533055, "episode_return_min": -41.876234001352266, "episode_return_mean": -3.462401013163921}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.45847343270236, "num_env_steps_trained_throughput_per_sec": 482.45847343270236, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 8208.302, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8208.266, "sample_time_ms": 767.344, "learn_time_ms": 7426.633, "learn_throughput": 538.602, "synch_weights_time_ms": 13.8}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 22, "trial_id": "83a5c_00000", "date": "2024-08-10_12-16-55", "timestamp": 1723306615, "time_this_iter_s": 8.29594111442566, "time_total_s": 180.42129683494568, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f60edc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 180.42129683494568, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.836363636363636, "ram_util_percent": 80.35454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.062069089355923, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.318206707510368, "policy_loss": -0.003988594155408758, "vf_loss": 5.321713288120492, "vf_explained_var": -0.24479690875325885, "kl": 0.004284561928295234, "entropy": 1.5308565139139771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.011042569112033, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7134680879612763, "policy_loss": -0.00576325886019428, "vf_loss": 3.718621320525805, "vf_explained_var": 0.23440759778022766, "kl": 0.006100410213142375, "entropy": 0.9941521996011337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "env_runners": {"episode_reward_max": 34.508178484533055, "episode_reward_min": -41.876234001352266, "episode_reward_mean": -3.9738159620893607, "episode_len_mean": 382.14, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38214, "policy_reward_min": {"agent_policy": -34.508178484532934, "adversary_policy": -53.425028829319714}, "policy_reward_max": {"agent_policy": 41.87623400135226, "adversary_policy": 44.23359777857221}, "policy_reward_mean": {"agent_policy": 3.9738159620893585, "adversary_policy": -3.973815962089361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.94849831008917, 6.134576636910063, 3.5678434827192405, -0.7866697409451593, -7.317303719496426, 1.7844728623608859, 4.090016279162507, 9.43134547398794, -18.648506822561256, 0.21244695238475764, -2.992157048401932, -1.7475694114941565, 6.533789579539155, 24.7218263778357, 8.716328766351031, 17.631661020440966, 6.766882132519683, -2.526905985581733, 25.132106143407636, 12.938312567677118, -35.617472062103026, 8.251517598619316, 1.9179637346272127, 4.74601097213043, 29.29645412660523, 9.337688371599874, -10.351533429730088, 1.9419264169424038, -26.096723985962246, -1.8899909840076212, 0.49281009106118123, 1.7792367297641665, -0.1240594587848225, 18.583920034738608, -18.04525922989152, -26.593798566929713, -17.748326756386223, 29.093445553843054, 13.080799457754097, 9.49300538907429, -37.9458586310663, -37.01335217586435, -41.876234001352266, -20.905539371709793, 34.508178484533055, -19.476565340915123, 11.83818203573399, -32.54098718817982, 18.163830843209475, 14.080078592303103, -1.0711107131324678, 29.262052127568417, -14.965274889235399, -39.43641534923553, 9.633381580845407, -22.93983695053654, 13.348741997786286, -35.43493189955169, -34.79760610694063, -18.72319505144694, 0.5843229747291101, 5.939214487469998, 1.2611985412816156, -19.91499414184244, 2.8138885542761916, -31.839931623748626, 6.65979059035633, 21.167677058627216, 20.408762532275095, -6.572536578367412, -26.02962317816581, -28.11337062096422, 10.159807727479107, -20.34155118524857, 4.271219926970527, -7.692020956106793, 4.539083737982319, -12.61898813016671, -30.311085051400656, -15.858393101855881, 14.847528679960751, -15.949169954444068, -16.788603246045355, -13.82334799227834, -4.643459969995208, -9.582078785007027, -11.409768516980353, 11.343635353634689, 3.827994709675318, -23.131206251004663, -24.813866964094665, -4.773445879447202, -12.549973402956757, -11.321235893653578, -22.640883746294246, 15.880878784003652, -10.314562312840648, -2.5853035286347748, 6.589292217865235, -25.90263692666193], "episode_lengths": [89, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 80, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400], "policy_agent_policy_reward": [-22.948498310089164, -6.134576636910063, -3.5678434827192405, 0.7866697409451611, 7.317303719496426, -1.7844728623608859, -4.090016279162507, -9.43134547398794, 18.648506822561256, -0.21244695238475764, 2.9921570484019266, 1.7475694114941565, -6.533789579539155, -24.721826377835683, -8.716328766351033, -17.631661020441012, -6.766882132519681, 2.526905985581732, -25.132106143407633, -12.938312567677126, 35.61747206210302, -8.251517598619314, -1.9179637346272171, -4.7460109721304296, -29.296454126605276, -9.33768837159988, 10.351533429730079, -1.9419264169424082, 26.096723985962246, 1.8899909840076212, -0.49281009106118034, -1.7792367297641665, 0.1240594587848225, -18.583920034738604, 18.04525922989152, 26.593798566929713, 17.748326756386223, -29.093445553843083, -13.080799457754098, -9.493005389074302, 37.945858631066294, 37.01335217586431, 41.87623400135226, 20.905539371709793, -34.508178484532934, 19.476565340915123, -11.838182035733995, 32.54098718817981, -18.163830843209524, -14.080078592303101, 1.0711107131324678, -29.26205212756843, 14.965274889235399, 39.43641534923554, -9.633381580845413, 22.93983695053653, -13.34874199778628, 35.434931899551685, 34.79760610694062, 18.72319505144694, -0.5843229747291101, -5.939214487469997, -1.2611985412816158, 19.91499414184244, -2.8138885542761916, 31.83993162374862, -6.659790590356339, -21.16767705862722, -20.408762532275077, 6.572536578367411, 26.02962317816581, 28.11337062096422, -10.159807727479109, 20.341551185248566, -4.271219926970534, 7.692020956106793, -4.539083737982313, 12.61898813016671, 30.31108505140064, 15.858393101855881, -14.847528679960751, 15.949169954444063, 16.788603246045362, 13.823347992278338, 4.643459969995208, 9.582078785007027, 11.409768516980353, -11.343635353634689, -3.827994709675319, 23.131206251004667, 24.81386696409466, 4.773445879447202, 12.549973402956756, 11.321235893653578, 22.640883746294246, -15.880878784003652, 10.314562312840645, 2.5853035286347748, -6.589292217865236, 25.902636926661934], "policy_adversary_policy_reward": [44.23359777857221, 1.6633988416061118, -2.2909701305357935, 14.56012340435592, 5.971698645623711, 1.16398831981477, 6.471866584703438, -8.04520606659376, -12.571113336665036, -2.063494102327816, -1.9491787520841335, 5.518124476805905, 0.03743514763384681, 8.142597410691167, 11.633823427462627, 7.228867520513255, -7.551777064597992, -29.74523658052452, -0.42582224866973917, 0.8507161534392544, 2.8199759912124307, -8.804290088016291, -15.779398435323401, 12.284259612335088, 13.4288454894124, -0.3612663303340895, 16.653883409098068, 32.7897693465733, 13.05729231336936, 4.375365219332714, 15.061374094565, 20.201947946316956, 15.9800709418026, -2.4463066767632355, -1.6615423642737888, -3.3922696068896725, 20.096355722370003, 30.16785656444523, 6.560418112982186, 19.31620702237207, -23.505078691205668, -47.72986543300034, 23.361327445499036, -6.858292248260401, 17.08227917068309, -13.246351701428662, -5.252716582256127, 14.744738526516997, 30.789309226821626, 27.80359902638893, 6.21769327779967, 12.457683465400084, -7.714323672846467, -12.988743186613684, 2.51009938764226, 1.373753446242553, -23.806391123276928, -28.38705684864756, -4.6623667539997875, 0.8823847859845442, -7.096502681366035, 8.082122863488394, -10.734430653080906, 14.292904112609234, 0.5484796364197653, -0.7965985539894156, 23.607577349951562, 13.560262719525687, -18.578794992701397, -17.511723467081644, -37.03864598939669, -16.148951144462735, -22.70397688727617, -12.792676625496277, 36.4009681914243, 21.78592291626186, 0.1185844963531526, 26.04301441915507, 13.24488748639984, 5.741123291748737, -23.69876124501735, -52.19295601711518, -33.229225316678296, -40.79747903505039, -53.425028829319714, -30.327439173384974, -20.66332093273858, -21.147757810681007, 35.33057490984038, 33.685782059225545, -24.31905426486849, -14.634076416961754, -1.4988443602220087, 25.175208431690017, -34.38967078423392, -30.69230359212567, 14.422442469362696, 21.905219217056402, 15.249659283026165, 12.91049790158002, -7.8473551184249555, 5.70513369216002, 27.91191893001333, 30.612185325123537, -11.031858151763892, -18.898691626706906, -50.27571919312325, -28.597111505347854, 3.482797207794265, 15.783965953896569, -12.263945389057369, -33.6157285120157, 1.2968529221862717, 25.400631073386293, -30.070646136127166, -40.79921766297633, -38.581491190190455, -31.01372102369075, -34.08511800330234, -3.361272099591538, -11.241384622569768, 12.410030572027988, 5.780643389994719, 6.097785584945292, -11.360528407762926, 13.882925490326157, -31.989811621567917, -7.840176662116967, -0.2875740799508648, 5.915351188503248, -14.752328997963936, -48.9275342495333, -3.944746092038349, 17.264327272751043, 18.029095971806477, 24.306258145447952, 15.728466475516942, 25.08905858903322, -4.606836444589314, -8.538236712145508, -31.888182772452183, -20.17106358387944, -26.044760604672305, -30.18198063725614, 4.861090806864951, 15.45852464809327, -8.04463337929014, -32.63846899120699, -9.519198536987496, 18.061638390928543, -2.110224463262373, -13.273817448951213, -19.779480442855444, 28.85764791882008, -12.062990233462841, -13.174986026870577, -42.98329493541586, -17.638875167385493, -22.23178011069311, -9.485006093018654, 1.4766145068826617, 28.21844285303884, -12.505778205010628, -19.39256170387751, -22.684793350333763, -10.89241314175695, -29.553388464247618, 1.9066924796909284, -21.603463906510928, 12.316543966520513, -2.440342880144101, -16.723814689869954, -23.63155451612782, 0.8120174821671142, -0.5404185782784019, 23.22768928554778, -7.934435757922296, 15.590425177272934, -22.892788503793835, -23.369623998215527, -9.40956064645318, -40.21817328173614, -8.649688149975582, -0.8972036089188222, 1.1686494170110429, -26.268596222924565, 7.2934508436569985, -29.935922630964157, -18.12224481264314, -27.159522679945354, 25.64459405209451, 6.117163515912793, -4.424697986909493, -16.204426638771796, 7.376195701281549, -12.546802758551099, 5.3376939326390005, 7.84089050309147, -15.550740282470112, -36.25453357085374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45250566802187725, "mean_inference_ms": 1.1996635616529152, "mean_action_processing_ms": 0.1926914665056351, "mean_env_wait_ms": 0.07985849487959906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003711700439453125, "StateBufferConnector_ms": 0.0029374361038208008, "ViewRequirementAgentConnector_ms": 0.06824398040771484}, "num_episodes": 10, "episode_return_max": 34.508178484533055, "episode_return_min": -41.876234001352266, "episode_return_mean": -3.9738159620893607}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.5826565575834, "num_env_steps_trained_throughput_per_sec": 490.5826565575834, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 8213.591, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8213.555, "sample_time_ms": 766.622, "learn_time_ms": 7432.78, "learn_throughput": 538.157, "synch_weights_time_ms": 13.714}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "training_iteration": 23, "trial_id": "83a5c_00000", "date": "2024-08-10_12-17-04", "timestamp": 1723306624, "time_this_iter_s": 8.159042119979858, "time_total_s": 188.58033895492554, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5c9c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 188.58033895492554, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.333333333333325, "ram_util_percent": 80.10833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0991923476968495, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.386731727034958, "policy_loss": -0.005776551340721429, "vf_loss": 5.3917990341388355, "vf_explained_var": -0.9016449325299137, "kl": 0.012608554528940445, "entropy": 1.5029264748411835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.091204363045593, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.568561624735594, "policy_loss": -0.006460149336392836, "vf_loss": 4.574387029061715, "vf_explained_var": 0.13891290308286747, "kl": 0.006347448645630251, "entropy": 0.9763811490188042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 34.508178484533055, "episode_reward_min": -41.876234001352266, "episode_reward_mean": -4.746533493749485, "episode_len_mean": 381.62, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38162, "policy_reward_min": {"agent_policy": -34.508178484532934, "adversary_policy": -53.425028829319714}, "policy_reward_max": {"agent_policy": 41.87623400135226, "adversary_policy": 36.4009681914243}, "policy_reward_mean": {"agent_policy": 4.746533493749483, "adversary_policy": -4.746533493749484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.992157048401932, -1.7475694114941565, 6.533789579539155, 24.7218263778357, 8.716328766351031, 17.631661020440966, 6.766882132519683, -2.526905985581733, 25.132106143407636, 12.938312567677118, -35.617472062103026, 8.251517598619316, 1.9179637346272127, 4.74601097213043, 29.29645412660523, 9.337688371599874, -10.351533429730088, 1.9419264169424038, -26.096723985962246, -1.8899909840076212, 0.49281009106118123, 1.7792367297641665, -0.1240594587848225, 18.583920034738608, -18.04525922989152, -26.593798566929713, -17.748326756386223, 29.093445553843054, 13.080799457754097, 9.49300538907429, -37.9458586310663, -37.01335217586435, -41.876234001352266, -20.905539371709793, 34.508178484533055, -19.476565340915123, 11.83818203573399, -32.54098718817982, 18.163830843209475, 14.080078592303103, -1.0711107131324678, 29.262052127568417, -14.965274889235399, -39.43641534923553, 9.633381580845407, -22.93983695053654, 13.348741997786286, -35.43493189955169, -34.79760610694063, -18.72319505144694, 0.5843229747291101, 5.939214487469998, 1.2611985412816156, -19.91499414184244, 2.8138885542761916, -31.839931623748626, 6.65979059035633, 21.167677058627216, 20.408762532275095, -6.572536578367412, -26.02962317816581, -28.11337062096422, 10.159807727479107, -20.34155118524857, 4.271219926970527, -7.692020956106793, 4.539083737982319, -12.61898813016671, -30.311085051400656, -15.858393101855881, 14.847528679960751, -15.949169954444068, -16.788603246045355, -13.82334799227834, -4.643459969995208, -9.582078785007027, -11.409768516980353, 11.343635353634689, 3.827994709675318, -23.131206251004663, -24.813866964094665, -4.773445879447202, -12.549973402956757, -11.321235893653578, -22.640883746294246, 15.880878784003652, -10.314562312840648, -2.5853035286347748, 6.589292217865235, -25.90263692666193, -6.297376154570442, -23.157874984689435, -8.539441937390645, -6.053477084508785, -10.17457720699695, 1.264587462662826, -12.006846989165306, 10.70470485815487, 3.860610220870976, -5.455341635767823], "episode_lengths": [400, 400, 400, 80, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 37, 400, 400], "policy_agent_policy_reward": [2.9921570484019266, 1.7475694114941565, -6.533789579539155, -24.721826377835683, -8.716328766351033, -17.631661020441012, -6.766882132519681, 2.526905985581732, -25.132106143407633, -12.938312567677126, 35.61747206210302, -8.251517598619314, -1.9179637346272171, -4.7460109721304296, -29.296454126605276, -9.33768837159988, 10.351533429730079, -1.9419264169424082, 26.096723985962246, 1.8899909840076212, -0.49281009106118034, -1.7792367297641665, 0.1240594587848225, -18.583920034738604, 18.04525922989152, 26.593798566929713, 17.748326756386223, -29.093445553843083, -13.080799457754098, -9.493005389074302, 37.945858631066294, 37.01335217586431, 41.87623400135226, 20.905539371709793, -34.508178484532934, 19.476565340915123, -11.838182035733995, 32.54098718817981, -18.163830843209524, -14.080078592303101, 1.0711107131324678, -29.26205212756843, 14.965274889235399, 39.43641534923554, -9.633381580845413, 22.93983695053653, -13.34874199778628, 35.434931899551685, 34.79760610694062, 18.72319505144694, -0.5843229747291101, -5.939214487469997, -1.2611985412816158, 19.91499414184244, -2.8138885542761916, 31.83993162374862, -6.659790590356339, -21.16767705862722, -20.408762532275077, 6.572536578367411, 26.02962317816581, 28.11337062096422, -10.159807727479109, 20.341551185248566, -4.271219926970534, 7.692020956106793, -4.539083737982313, 12.61898813016671, 30.31108505140064, 15.858393101855881, -14.847528679960751, 15.949169954444063, 16.788603246045362, 13.823347992278338, 4.643459969995208, 9.582078785007027, 11.409768516980353, -11.343635353634689, -3.827994709675319, 23.131206251004667, 24.81386696409466, 4.773445879447202, 12.549973402956756, 11.321235893653578, 22.640883746294246, -15.880878784003652, 10.314562312840645, 2.5853035286347748, -6.589292217865236, 25.902636926661934, 6.297376154570436, 23.157874984689432, 8.539441937390647, 6.053477084508785, 10.174577206996943, -1.264587462662826, 12.006846989165306, -10.704704858154864, -3.860610220870976, 5.455341635767827], "policy_adversary_policy_reward": [2.8199759912124307, -8.804290088016291, -15.779398435323401, 12.284259612335088, 13.4288454894124, -0.3612663303340895, 16.653883409098068, 32.7897693465733, 13.05729231336936, 4.375365219332714, 15.061374094565, 20.201947946316956, 15.9800709418026, -2.4463066767632355, -1.6615423642737888, -3.3922696068896725, 20.096355722370003, 30.16785656444523, 6.560418112982186, 19.31620702237207, -23.505078691205668, -47.72986543300034, 23.361327445499036, -6.858292248260401, 17.08227917068309, -13.246351701428662, -5.252716582256127, 14.744738526516997, 30.789309226821626, 27.80359902638893, 6.21769327779967, 12.457683465400084, -7.714323672846467, -12.988743186613684, 2.51009938764226, 1.373753446242553, -23.806391123276928, -28.38705684864756, -4.6623667539997875, 0.8823847859845442, -7.096502681366035, 8.082122863488394, -10.734430653080906, 14.292904112609234, 0.5484796364197653, -0.7965985539894156, 23.607577349951562, 13.560262719525687, -18.578794992701397, -17.511723467081644, -37.03864598939669, -16.148951144462735, -22.70397688727617, -12.792676625496277, 36.4009681914243, 21.78592291626186, 0.1185844963531526, 26.04301441915507, 13.24488748639984, 5.741123291748737, -23.69876124501735, -52.19295601711518, -33.229225316678296, -40.79747903505039, -53.425028829319714, -30.327439173384974, -20.66332093273858, -21.147757810681007, 35.33057490984038, 33.685782059225545, -24.31905426486849, -14.634076416961754, -1.4988443602220087, 25.175208431690017, -34.38967078423392, -30.69230359212567, 14.422442469362696, 21.905219217056402, 15.249659283026165, 12.91049790158002, -7.8473551184249555, 5.70513369216002, 27.91191893001333, 30.612185325123537, -11.031858151763892, -18.898691626706906, -50.27571919312325, -28.597111505347854, 3.482797207794265, 15.783965953896569, -12.263945389057369, -33.6157285120157, 1.2968529221862717, 25.400631073386293, -30.070646136127166, -40.79921766297633, -38.581491190190455, -31.01372102369075, -34.08511800330234, -3.361272099591538, -11.241384622569768, 12.410030572027988, 5.780643389994719, 6.097785584945292, -11.360528407762926, 13.882925490326157, -31.989811621567917, -7.840176662116967, -0.2875740799508648, 5.915351188503248, -14.752328997963936, -48.9275342495333, -3.944746092038349, 17.264327272751043, 18.029095971806477, 24.306258145447952, 15.728466475516942, 25.08905858903322, -4.606836444589314, -8.538236712145508, -31.888182772452183, -20.17106358387944, -26.044760604672305, -30.18198063725614, 4.861090806864951, 15.45852464809327, -8.04463337929014, -32.63846899120699, -9.519198536987496, 18.061638390928543, -2.110224463262373, -13.273817448951213, -19.779480442855444, 28.85764791882008, -12.062990233462841, -13.174986026870577, -42.98329493541586, -17.638875167385493, -22.23178011069311, -9.485006093018654, 1.4766145068826617, 28.21844285303884, -12.505778205010628, -19.39256170387751, -22.684793350333763, -10.89241314175695, -29.553388464247618, 1.9066924796909284, -21.603463906510928, 12.316543966520513, -2.440342880144101, -16.723814689869954, -23.63155451612782, 0.8120174821671142, -0.5404185782784019, 23.22768928554778, -7.934435757922296, 15.590425177272934, -22.892788503793835, -23.369623998215527, -9.40956064645318, -40.21817328173614, -8.649688149975582, -0.8972036089188222, 1.1686494170110429, -26.268596222924565, 7.2934508436569985, -29.935922630964157, -18.12224481264314, -27.159522679945354, 25.64459405209451, 6.117163515912793, -4.424697986909493, -16.204426638771796, 7.376195701281549, -12.546802758551099, 5.3376939326390005, 7.84089050309147, -15.550740282470112, -36.25453357085374, 3.0807043557185345, -15.675456664859414, -23.22955112890245, -23.08619884047644, -19.598707413863274, 2.519823539081983, -11.45730879687714, -0.64964537214043, -8.2379982781369, -12.111156135856987, 0.1433015919899212, 2.3858733333357307, -7.036626674002321, -16.97706730432829, 4.656126434319523, 16.75328328199021, 3.5126044088125354, 4.208616032929417, -24.608915429397484, 13.698232157861835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4487786056526595, "mean_inference_ms": 1.1881247269731299, "mean_action_processing_ms": 0.1911609677081697, "mean_env_wait_ms": 0.07898008500623685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003689885139465332, "StateBufferConnector_ms": 0.0029680728912353516, "ViewRequirementAgentConnector_ms": 0.0685349702835083}, "num_episodes": 10, "episode_return_max": 34.508178484533055, "episode_return_min": -41.876234001352266, "episode_return_mean": -4.746533493749485}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.1585396725354, "num_env_steps_trained_throughput_per_sec": 496.1585396725354, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 8187.936, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8187.901, "sample_time_ms": 765.641, "learn_time_ms": 7408.182, "learn_throughput": 539.944, "synch_weights_time_ms": 13.644}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 24, "trial_id": "83a5c_00000", "date": "2024-08-10_12-17-12", "timestamp": 1723306632, "time_this_iter_s": 8.06708312034607, "time_total_s": 196.6474220752716, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a6310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 196.6474220752716, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 25.958333333333332, "ram_util_percent": 79.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.174635553233838, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.860708556982575, "policy_loss": -0.0030673348455734196, "vf_loss": 4.863172310243839, "vf_explained_var": -0.30306524259072765, "kl": 0.010730508967732167, "entropy": 1.5044282194798586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7852321926504375, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.221058896183967, "policy_loss": -0.003332100281113526, "vf_loss": 4.224119920283556, "vf_explained_var": 0.24652591831982135, "kl": 0.0027110624977048055, "entropy": 0.9575815103327234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "env_runners": {"episode_reward_max": 34.508178484533055, "episode_reward_min": -41.876234001352266, "episode_reward_mean": -6.231145473576548, "episode_len_mean": 388.51, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38851, "policy_reward_min": {"agent_policy": -34.508178484532934, "adversary_policy": -53.425028829319714}, "policy_reward_max": {"agent_policy": 41.87623400135226, "adversary_policy": 36.4009681914243}, "policy_reward_mean": {"agent_policy": 6.231145473576545, "adversary_policy": -6.2311454735765475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.938312567677118, -35.617472062103026, 8.251517598619316, 1.9179637346272127, 4.74601097213043, 29.29645412660523, 9.337688371599874, -10.351533429730088, 1.9419264169424038, -26.096723985962246, -1.8899909840076212, 0.49281009106118123, 1.7792367297641665, -0.1240594587848225, 18.583920034738608, -18.04525922989152, -26.593798566929713, -17.748326756386223, 29.093445553843054, 13.080799457754097, 9.49300538907429, -37.9458586310663, -37.01335217586435, -41.876234001352266, -20.905539371709793, 34.508178484533055, -19.476565340915123, 11.83818203573399, -32.54098718817982, 18.163830843209475, 14.080078592303103, -1.0711107131324678, 29.262052127568417, -14.965274889235399, -39.43641534923553, 9.633381580845407, -22.93983695053654, 13.348741997786286, -35.43493189955169, -34.79760610694063, -18.72319505144694, 0.5843229747291101, 5.939214487469998, 1.2611985412816156, -19.91499414184244, 2.8138885542761916, -31.839931623748626, 6.65979059035633, 21.167677058627216, 20.408762532275095, -6.572536578367412, -26.02962317816581, -28.11337062096422, 10.159807727479107, -20.34155118524857, 4.271219926970527, -7.692020956106793, 4.539083737982319, -12.61898813016671, -30.311085051400656, -15.858393101855881, 14.847528679960751, -15.949169954444068, -16.788603246045355, -13.82334799227834, -4.643459969995208, -9.582078785007027, -11.409768516980353, 11.343635353634689, 3.827994709675318, -23.131206251004663, -24.813866964094665, -4.773445879447202, -12.549973402956757, -11.321235893653578, -22.640883746294246, 15.880878784003652, -10.314562312840648, -2.5853035286347748, 6.589292217865235, -25.90263692666193, -6.297376154570442, -23.157874984689435, -8.539441937390645, -6.053477084508785, -10.17457720699695, 1.264587462662826, -12.006846989165306, 10.70470485815487, 3.860610220870976, -5.455341635767823, 0.9183686435134106, -0.013110621101707132, -23.628805473611976, 12.350785775950987, -27.82418614434382, -3.8287520857948767, -9.243859973402373, -10.220766216436996, -4.734910312862455], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 37, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-12.938312567677126, 35.61747206210302, -8.251517598619314, -1.9179637346272171, -4.7460109721304296, -29.296454126605276, -9.33768837159988, 10.351533429730079, -1.9419264169424082, 26.096723985962246, 1.8899909840076212, -0.49281009106118034, -1.7792367297641665, 0.1240594587848225, -18.583920034738604, 18.04525922989152, 26.593798566929713, 17.748326756386223, -29.093445553843083, -13.080799457754098, -9.493005389074302, 37.945858631066294, 37.01335217586431, 41.87623400135226, 20.905539371709793, -34.508178484532934, 19.476565340915123, -11.838182035733995, 32.54098718817981, -18.163830843209524, -14.080078592303101, 1.0711107131324678, -29.26205212756843, 14.965274889235399, 39.43641534923554, -9.633381580845413, 22.93983695053653, -13.34874199778628, 35.434931899551685, 34.79760610694062, 18.72319505144694, -0.5843229747291101, -5.939214487469997, -1.2611985412816158, 19.91499414184244, -2.8138885542761916, 31.83993162374862, -6.659790590356339, -21.16767705862722, -20.408762532275077, 6.572536578367411, 26.02962317816581, 28.11337062096422, -10.159807727479109, 20.341551185248566, -4.271219926970534, 7.692020956106793, -4.539083737982313, 12.61898813016671, 30.31108505140064, 15.858393101855881, -14.847528679960751, 15.949169954444063, 16.788603246045362, 13.823347992278338, 4.643459969995208, 9.582078785007027, 11.409768516980353, -11.343635353634689, -3.827994709675319, 23.131206251004667, 24.81386696409466, 4.773445879447202, 12.549973402956756, 11.321235893653578, 22.640883746294246, -15.880878784003652, 10.314562312840645, 2.5853035286347748, -6.589292217865236, 25.902636926661934, 6.297376154570436, 23.157874984689432, 8.539441937390647, 6.053477084508785, 10.174577206996943, -1.264587462662826, 12.006846989165306, -10.704704858154864, -3.860610220870976, 5.455341635767827, -0.9183686435134106, 0.013110621101707132, 23.628805473611976, -12.350785775950989, 27.824186144343805, 3.8287520857948767, 9.24385997340238, 10.220766216436996, 4.734910312862455], "policy_adversary_policy_reward": [6.560418112982186, 19.31620702237207, -23.505078691205668, -47.72986543300034, 23.361327445499036, -6.858292248260401, 17.08227917068309, -13.246351701428662, -5.252716582256127, 14.744738526516997, 30.789309226821626, 27.80359902638893, 6.21769327779967, 12.457683465400084, -7.714323672846467, -12.988743186613684, 2.51009938764226, 1.373753446242553, -23.806391123276928, -28.38705684864756, -4.6623667539997875, 0.8823847859845442, -7.096502681366035, 8.082122863488394, -10.734430653080906, 14.292904112609234, 0.5484796364197653, -0.7965985539894156, 23.607577349951562, 13.560262719525687, -18.578794992701397, -17.511723467081644, -37.03864598939669, -16.148951144462735, -22.70397688727617, -12.792676625496277, 36.4009681914243, 21.78592291626186, 0.1185844963531526, 26.04301441915507, 13.24488748639984, 5.741123291748737, -23.69876124501735, -52.19295601711518, -33.229225316678296, -40.79747903505039, -53.425028829319714, -30.327439173384974, -20.66332093273858, -21.147757810681007, 35.33057490984038, 33.685782059225545, -24.31905426486849, -14.634076416961754, -1.4988443602220087, 25.175208431690017, -34.38967078423392, -30.69230359212567, 14.422442469362696, 21.905219217056402, 15.249659283026165, 12.91049790158002, -7.8473551184249555, 5.70513369216002, 27.91191893001333, 30.612185325123537, -11.031858151763892, -18.898691626706906, -50.27571919312325, -28.597111505347854, 3.482797207794265, 15.783965953896569, -12.263945389057369, -33.6157285120157, 1.2968529221862717, 25.400631073386293, -30.070646136127166, -40.79921766297633, -38.581491190190455, -31.01372102369075, -34.08511800330234, -3.361272099591538, -11.241384622569768, 12.410030572027988, 5.780643389994719, 6.097785584945292, -11.360528407762926, 13.882925490326157, -31.989811621567917, -7.840176662116967, -0.2875740799508648, 5.915351188503248, -14.752328997963936, -48.9275342495333, -3.944746092038349, 17.264327272751043, 18.029095971806477, 24.306258145447952, 15.728466475516942, 25.08905858903322, -4.606836444589314, -8.538236712145508, -31.888182772452183, -20.17106358387944, -26.044760604672305, -30.18198063725614, 4.861090806864951, 15.45852464809327, -8.04463337929014, -32.63846899120699, -9.519198536987496, 18.061638390928543, -2.110224463262373, -13.273817448951213, -19.779480442855444, 28.85764791882008, -12.062990233462841, -13.174986026870577, -42.98329493541586, -17.638875167385493, -22.23178011069311, -9.485006093018654, 1.4766145068826617, 28.21844285303884, -12.505778205010628, -19.39256170387751, -22.684793350333763, -10.89241314175695, -29.553388464247618, 1.9066924796909284, -21.603463906510928, 12.316543966520513, -2.440342880144101, -16.723814689869954, -23.63155451612782, 0.8120174821671142, -0.5404185782784019, 23.22768928554778, -7.934435757922296, 15.590425177272934, -22.892788503793835, -23.369623998215527, -9.40956064645318, -40.21817328173614, -8.649688149975582, -0.8972036089188222, 1.1686494170110429, -26.268596222924565, 7.2934508436569985, -29.935922630964157, -18.12224481264314, -27.159522679945354, 25.64459405209451, 6.117163515912793, -4.424697986909493, -16.204426638771796, 7.376195701281549, -12.546802758551099, 5.3376939326390005, 7.84089050309147, -15.550740282470112, -36.25453357085374, 3.0807043557185345, -15.675456664859414, -23.22955112890245, -23.08619884047644, -19.598707413863274, 2.519823539081983, -11.45730879687714, -0.64964537214043, -8.2379982781369, -12.111156135856987, 0.1433015919899212, 2.3858733333357307, -7.036626674002321, -16.97706730432829, 4.656126434319523, 16.75328328199021, 3.5126044088125354, 4.208616032929417, -24.608915429397484, 13.698232157861835, -2.631466487769238, 4.468203774796059, -11.549235318750018, 11.523014076546602, -26.00701288402881, -21.25059806319514, 16.00047642815151, 8.701095123750466, -36.26541159474706, -19.382960693940575, 9.232108402015967, -16.88961257360572, -13.247042724635588, -5.240677222169163, -13.080127895466429, -7.361404537407566, -9.054313726525566, -0.41550689919934314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4455173016003728, "mean_inference_ms": 1.1781772936636528, "mean_action_processing_ms": 0.1899076244254114, "mean_env_wait_ms": 0.07818057764545602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036107301712036133, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.06831777095794678}, "num_episodes": 9, "episode_return_max": 34.508178484533055, "episode_return_min": -41.876234001352266, "episode_return_mean": -6.231145473576548}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.84643933740404, "num_env_steps_trained_throughput_per_sec": 480.84643933740404, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 8167.406, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8167.372, "sample_time_ms": 756.455, "learn_time_ms": 7397.057, "learn_throughput": 540.756, "synch_weights_time_ms": 13.425}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "training_iteration": 25, "trial_id": "83a5c_00000", "date": "2024-08-10_12-17-20", "timestamp": 1723306640, "time_this_iter_s": 8.322913885116577, "time_total_s": 204.97033596038818, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a6dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 204.97033596038818, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 27.181818181818176, "ram_util_percent": 79.85454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.01711722672301, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.866386747864819, "policy_loss": -0.006476757756715256, "vf_loss": 5.871784015685793, "vf_explained_var": -0.1806574632566442, "kl": 0.0191910723021412, "entropy": 1.49602461542402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.23492510865132, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.277901398887237, "policy_loss": -0.0009731995584540224, "vf_loss": 5.2786235978206, "vf_explained_var": 0.4220345978314678, "kl": 0.005020213610129661, "entropy": 1.0377045534551144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 34.508178484533055, "episode_reward_min": -41.876234001352266, "episode_reward_mean": -6.827115246028189, "episode_len_mean": 388.51, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38851, "policy_reward_min": {"agent_policy": -34.508178484532934, "adversary_policy": -53.425028829319714}, "policy_reward_max": {"agent_policy": 41.87623400135226, "adversary_policy": 36.4009681914243}, "policy_reward_mean": {"agent_policy": 6.827115246028187, "adversary_policy": -6.827115246028189}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.096723985962246, -1.8899909840076212, 0.49281009106118123, 1.7792367297641665, -0.1240594587848225, 18.583920034738608, -18.04525922989152, -26.593798566929713, -17.748326756386223, 29.093445553843054, 13.080799457754097, 9.49300538907429, -37.9458586310663, -37.01335217586435, -41.876234001352266, -20.905539371709793, 34.508178484533055, -19.476565340915123, 11.83818203573399, -32.54098718817982, 18.163830843209475, 14.080078592303103, -1.0711107131324678, 29.262052127568417, -14.965274889235399, -39.43641534923553, 9.633381580845407, -22.93983695053654, 13.348741997786286, -35.43493189955169, -34.79760610694063, -18.72319505144694, 0.5843229747291101, 5.939214487469998, 1.2611985412816156, -19.91499414184244, 2.8138885542761916, -31.839931623748626, 6.65979059035633, 21.167677058627216, 20.408762532275095, -6.572536578367412, -26.02962317816581, -28.11337062096422, 10.159807727479107, -20.34155118524857, 4.271219926970527, -7.692020956106793, 4.539083737982319, -12.61898813016671, -30.311085051400656, -15.858393101855881, 14.847528679960751, -15.949169954444068, -16.788603246045355, -13.82334799227834, -4.643459969995208, -9.582078785007027, -11.409768516980353, 11.343635353634689, 3.827994709675318, -23.131206251004663, -24.813866964094665, -4.773445879447202, -12.549973402956757, -11.321235893653578, -22.640883746294246, 15.880878784003652, -10.314562312840648, -2.5853035286347748, 6.589292217865235, -25.90263692666193, -6.297376154570442, -23.157874984689435, -8.539441937390645, -6.053477084508785, -10.17457720699695, 1.264587462662826, -12.006846989165306, 10.70470485815487, 3.860610220870976, -5.455341635767823, 0.9183686435134106, -0.013110621101707132, -23.628805473611976, 12.350785775950987, -27.82418614434382, -3.8287520857948767, -9.243859973402373, -10.220766216436996, -4.734910312862455, -34.63527982441757, -8.410528812599617, 19.07362655645535, 14.792041202696982, -28.09561619356096, 5.9290211181266095, -9.903830393805471, 5.76357052996682, -1.649113131657776], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 37, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [26.096723985962246, 1.8899909840076212, -0.49281009106118034, -1.7792367297641665, 0.1240594587848225, -18.583920034738604, 18.04525922989152, 26.593798566929713, 17.748326756386223, -29.093445553843083, -13.080799457754098, -9.493005389074302, 37.945858631066294, 37.01335217586431, 41.87623400135226, 20.905539371709793, -34.508178484532934, 19.476565340915123, -11.838182035733995, 32.54098718817981, -18.163830843209524, -14.080078592303101, 1.0711107131324678, -29.26205212756843, 14.965274889235399, 39.43641534923554, -9.633381580845413, 22.93983695053653, -13.34874199778628, 35.434931899551685, 34.79760610694062, 18.72319505144694, -0.5843229747291101, -5.939214487469997, -1.2611985412816158, 19.91499414184244, -2.8138885542761916, 31.83993162374862, -6.659790590356339, -21.16767705862722, -20.408762532275077, 6.572536578367411, 26.02962317816581, 28.11337062096422, -10.159807727479109, 20.341551185248566, -4.271219926970534, 7.692020956106793, -4.539083737982313, 12.61898813016671, 30.31108505140064, 15.858393101855881, -14.847528679960751, 15.949169954444063, 16.788603246045362, 13.823347992278338, 4.643459969995208, 9.582078785007027, 11.409768516980353, -11.343635353634689, -3.827994709675319, 23.131206251004667, 24.81386696409466, 4.773445879447202, 12.549973402956756, 11.321235893653578, 22.640883746294246, -15.880878784003652, 10.314562312840645, 2.5853035286347748, -6.589292217865236, 25.902636926661934, 6.297376154570436, 23.157874984689432, 8.539441937390647, 6.053477084508785, 10.174577206996943, -1.264587462662826, 12.006846989165306, -10.704704858154864, -3.860610220870976, 5.455341635767827, -0.9183686435134106, 0.013110621101707132, 23.628805473611976, -12.350785775950989, 27.824186144343805, 3.8287520857948767, 9.24385997340238, 10.220766216436996, 4.734910312862455, 34.63527982441758, 8.410528812599615, -19.073626556455366, -14.792041202696959, 28.09561619356094, -5.9290211181266095, 9.903830393805483, -5.76357052996682, 1.6491131316577743], "policy_adversary_policy_reward": [-23.806391123276928, -28.38705684864756, -4.6623667539997875, 0.8823847859845442, -7.096502681366035, 8.082122863488394, -10.734430653080906, 14.292904112609234, 0.5484796364197653, -0.7965985539894156, 23.607577349951562, 13.560262719525687, -18.578794992701397, -17.511723467081644, -37.03864598939669, -16.148951144462735, -22.70397688727617, -12.792676625496277, 36.4009681914243, 21.78592291626186, 0.1185844963531526, 26.04301441915507, 13.24488748639984, 5.741123291748737, -23.69876124501735, -52.19295601711518, -33.229225316678296, -40.79747903505039, -53.425028829319714, -30.327439173384974, -20.66332093273858, -21.147757810681007, 35.33057490984038, 33.685782059225545, -24.31905426486849, -14.634076416961754, -1.4988443602220087, 25.175208431690017, -34.38967078423392, -30.69230359212567, 14.422442469362696, 21.905219217056402, 15.249659283026165, 12.91049790158002, -7.8473551184249555, 5.70513369216002, 27.91191893001333, 30.612185325123537, -11.031858151763892, -18.898691626706906, -50.27571919312325, -28.597111505347854, 3.482797207794265, 15.783965953896569, -12.263945389057369, -33.6157285120157, 1.2968529221862717, 25.400631073386293, -30.070646136127166, -40.79921766297633, -38.581491190190455, -31.01372102369075, -34.08511800330234, -3.361272099591538, -11.241384622569768, 12.410030572027988, 5.780643389994719, 6.097785584945292, -11.360528407762926, 13.882925490326157, -31.989811621567917, -7.840176662116967, -0.2875740799508648, 5.915351188503248, -14.752328997963936, -48.9275342495333, -3.944746092038349, 17.264327272751043, 18.029095971806477, 24.306258145447952, 15.728466475516942, 25.08905858903322, -4.606836444589314, -8.538236712145508, -31.888182772452183, -20.17106358387944, -26.044760604672305, -30.18198063725614, 4.861090806864951, 15.45852464809327, -8.04463337929014, -32.63846899120699, -9.519198536987496, 18.061638390928543, -2.110224463262373, -13.273817448951213, -19.779480442855444, 28.85764791882008, -12.062990233462841, -13.174986026870577, -42.98329493541586, -17.638875167385493, -22.23178011069311, -9.485006093018654, 1.4766145068826617, 28.21844285303884, -12.505778205010628, -19.39256170387751, -22.684793350333763, -10.89241314175695, -29.553388464247618, 1.9066924796909284, -21.603463906510928, 12.316543966520513, -2.440342880144101, -16.723814689869954, -23.63155451612782, 0.8120174821671142, -0.5404185782784019, 23.22768928554778, -7.934435757922296, 15.590425177272934, -22.892788503793835, -23.369623998215527, -9.40956064645318, -40.21817328173614, -8.649688149975582, -0.8972036089188222, 1.1686494170110429, -26.268596222924565, 7.2934508436569985, -29.935922630964157, -18.12224481264314, -27.159522679945354, 25.64459405209451, 6.117163515912793, -4.424697986909493, -16.204426638771796, 7.376195701281549, -12.546802758551099, 5.3376939326390005, 7.84089050309147, -15.550740282470112, -36.25453357085374, 3.0807043557185345, -15.675456664859414, -23.22955112890245, -23.08619884047644, -19.598707413863274, 2.519823539081983, -11.45730879687714, -0.64964537214043, -8.2379982781369, -12.111156135856987, 0.1433015919899212, 2.3858733333357307, -7.036626674002321, -16.97706730432829, 4.656126434319523, 16.75328328199021, 3.5126044088125354, 4.208616032929417, -24.608915429397484, 13.698232157861835, -2.631466487769238, 4.468203774796059, -11.549235318750018, 11.523014076546602, -26.00701288402881, -21.25059806319514, 16.00047642815151, 8.701095123750466, -36.26541159474706, -19.382960693940575, 9.232108402015967, -16.88961257360572, -13.247042724635588, -5.240677222169163, -13.080127895466429, -7.361404537407566, -9.054313726525566, -0.41550689919934314, -25.261536984342825, -44.00902266449234, -4.786967185980167, -12.034090439219067, 22.2329594081204, 15.914293704790325, 10.095486263621043, 19.488596141772877, -34.2398324150547, -21.951399972067204, -3.260466207049028, 15.118508443302247, -8.970949450988964, -10.836711336621978, 0.3510559724216762, 11.176085087511964, -6.559570206749623, 3.2613439434340705]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44267184798505327, "mean_inference_ms": 1.169412158381529, "mean_action_processing_ms": 0.18876774333165916, "mean_env_wait_ms": 0.07752468063301611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003600001335144043, "StateBufferConnector_ms": 0.0025697946548461914, "ViewRequirementAgentConnector_ms": 0.06908440589904785}, "num_episodes": 9, "episode_return_max": 34.508178484533055, "episode_return_min": -41.876234001352266, "episode_return_mean": -6.827115246028189}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 468.58682100683114, "num_env_steps_trained_throughput_per_sec": 468.58682100683114, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 8224.509, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8224.476, "sample_time_ms": 757.701, "learn_time_ms": 7452.798, "learn_throughput": 536.711, "synch_weights_time_ms": 13.54}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 26, "trial_id": "83a5c_00000", "date": "2024-08-10_12-17-29", "timestamp": 1723306649, "time_this_iter_s": 8.542181968688965, "time_total_s": 213.51251792907715, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a60d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 213.51251792907715, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 27.576923076923077, "ram_util_percent": 80.06153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6388504590306963, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.486506461087989, "policy_loss": -0.0072435087088258965, "vf_loss": 6.49240321633677, "vf_explained_var": -0.7200030142037326, "kl": 0.023942320834490063, "entropy": 1.5400578751135126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.996940186433494, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.938251961270968, "policy_loss": -0.0020780075501534157, "vf_loss": 4.939881293723981, "vf_explained_var": 0.21911013374725977, "kl": 0.008973538791042774, "entropy": 1.0841544788330792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "env_runners": {"episode_reward_max": 34.508178484533055, "episode_reward_min": -41.876234001352266, "episode_reward_mean": -7.654688837541872, "episode_len_mean": 388.51, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38851, "policy_reward_min": {"agent_policy": -34.508178484532934, "adversary_policy": -53.425028829319714}, "policy_reward_max": {"agent_policy": 41.87623400135226, "adversary_policy": 35.33057490984038}, "policy_reward_mean": {"agent_policy": 7.654688837541872, "adversary_policy": -7.654688837541873}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.080799457754097, 9.49300538907429, -37.9458586310663, -37.01335217586435, -41.876234001352266, -20.905539371709793, 34.508178484533055, -19.476565340915123, 11.83818203573399, -32.54098718817982, 18.163830843209475, 14.080078592303103, -1.0711107131324678, 29.262052127568417, -14.965274889235399, -39.43641534923553, 9.633381580845407, -22.93983695053654, 13.348741997786286, -35.43493189955169, -34.79760610694063, -18.72319505144694, 0.5843229747291101, 5.939214487469998, 1.2611985412816156, -19.91499414184244, 2.8138885542761916, -31.839931623748626, 6.65979059035633, 21.167677058627216, 20.408762532275095, -6.572536578367412, -26.02962317816581, -28.11337062096422, 10.159807727479107, -20.34155118524857, 4.271219926970527, -7.692020956106793, 4.539083737982319, -12.61898813016671, -30.311085051400656, -15.858393101855881, 14.847528679960751, -15.949169954444068, -16.788603246045355, -13.82334799227834, -4.643459969995208, -9.582078785007027, -11.409768516980353, 11.343635353634689, 3.827994709675318, -23.131206251004663, -24.813866964094665, -4.773445879447202, -12.549973402956757, -11.321235893653578, -22.640883746294246, 15.880878784003652, -10.314562312840648, -2.5853035286347748, 6.589292217865235, -25.90263692666193, -6.297376154570442, -23.157874984689435, -8.539441937390645, -6.053477084508785, -10.17457720699695, 1.264587462662826, -12.006846989165306, 10.70470485815487, 3.860610220870976, -5.455341635767823, 0.9183686435134106, -0.013110621101707132, -23.628805473611976, 12.350785775950987, -27.82418614434382, -3.8287520857948767, -9.243859973402373, -10.220766216436996, -4.734910312862455, -34.63527982441757, -8.410528812599617, 19.07362655645535, 14.792041202696982, -28.09561619356096, 5.9290211181266095, -9.903830393805471, 5.76357052996682, -1.649113131657776, -17.521722969031, 4.3071703140429936, 9.19927530487533, -24.02810538078105, -7.260228536054651, -37.82008966315196, -20.90390725321028, -14.699711759250029, 0.1342408660639851, -14.713026647426943], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 37, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-13.080799457754098, -9.493005389074302, 37.945858631066294, 37.01335217586431, 41.87623400135226, 20.905539371709793, -34.508178484532934, 19.476565340915123, -11.838182035733995, 32.54098718817981, -18.163830843209524, -14.080078592303101, 1.0711107131324678, -29.26205212756843, 14.965274889235399, 39.43641534923554, -9.633381580845413, 22.93983695053653, -13.34874199778628, 35.434931899551685, 34.79760610694062, 18.72319505144694, -0.5843229747291101, -5.939214487469997, -1.2611985412816158, 19.91499414184244, -2.8138885542761916, 31.83993162374862, -6.659790590356339, -21.16767705862722, -20.408762532275077, 6.572536578367411, 26.02962317816581, 28.11337062096422, -10.159807727479109, 20.341551185248566, -4.271219926970534, 7.692020956106793, -4.539083737982313, 12.61898813016671, 30.31108505140064, 15.858393101855881, -14.847528679960751, 15.949169954444063, 16.788603246045362, 13.823347992278338, 4.643459969995208, 9.582078785007027, 11.409768516980353, -11.343635353634689, -3.827994709675319, 23.131206251004667, 24.81386696409466, 4.773445879447202, 12.549973402956756, 11.321235893653578, 22.640883746294246, -15.880878784003652, 10.314562312840645, 2.5853035286347748, -6.589292217865236, 25.902636926661934, 6.297376154570436, 23.157874984689432, 8.539441937390647, 6.053477084508785, 10.174577206996943, -1.264587462662826, 12.006846989165306, -10.704704858154864, -3.860610220870976, 5.455341635767827, -0.9183686435134106, 0.013110621101707132, 23.628805473611976, -12.350785775950989, 27.824186144343805, 3.8287520857948767, 9.24385997340238, 10.220766216436996, 4.734910312862455, 34.63527982441758, 8.410528812599615, -19.073626556455366, -14.792041202696959, 28.09561619356094, -5.9290211181266095, 9.903830393805483, -5.76357052996682, 1.6491131316577743, 17.521722969030996, -4.307170314042992, -9.199275304875332, 24.028105380781042, 7.260228536054651, 37.82008966315194, 20.903907253210285, 14.699711759250025, -0.13424086606398422, 14.713026647426942], "policy_adversary_policy_reward": [0.1185844963531526, 26.04301441915507, 13.24488748639984, 5.741123291748737, -23.69876124501735, -52.19295601711518, -33.229225316678296, -40.79747903505039, -53.425028829319714, -30.327439173384974, -20.66332093273858, -21.147757810681007, 35.33057490984038, 33.685782059225545, -24.31905426486849, -14.634076416961754, -1.4988443602220087, 25.175208431690017, -34.38967078423392, -30.69230359212567, 14.422442469362696, 21.905219217056402, 15.249659283026165, 12.91049790158002, -7.8473551184249555, 5.70513369216002, 27.91191893001333, 30.612185325123537, -11.031858151763892, -18.898691626706906, -50.27571919312325, -28.597111505347854, 3.482797207794265, 15.783965953896569, -12.263945389057369, -33.6157285120157, 1.2968529221862717, 25.400631073386293, -30.070646136127166, -40.79921766297633, -38.581491190190455, -31.01372102369075, -34.08511800330234, -3.361272099591538, -11.241384622569768, 12.410030572027988, 5.780643389994719, 6.097785584945292, -11.360528407762926, 13.882925490326157, -31.989811621567917, -7.840176662116967, -0.2875740799508648, 5.915351188503248, -14.752328997963936, -48.9275342495333, -3.944746092038349, 17.264327272751043, 18.029095971806477, 24.306258145447952, 15.728466475516942, 25.08905858903322, -4.606836444589314, -8.538236712145508, -31.888182772452183, -20.17106358387944, -26.044760604672305, -30.18198063725614, 4.861090806864951, 15.45852464809327, -8.04463337929014, -32.63846899120699, -9.519198536987496, 18.061638390928543, -2.110224463262373, -13.273817448951213, -19.779480442855444, 28.85764791882008, -12.062990233462841, -13.174986026870577, -42.98329493541586, -17.638875167385493, -22.23178011069311, -9.485006093018654, 1.4766145068826617, 28.21844285303884, -12.505778205010628, -19.39256170387751, -22.684793350333763, -10.89241314175695, -29.553388464247618, 1.9066924796909284, -21.603463906510928, 12.316543966520513, -2.440342880144101, -16.723814689869954, -23.63155451612782, 0.8120174821671142, -0.5404185782784019, 23.22768928554778, -7.934435757922296, 15.590425177272934, -22.892788503793835, -23.369623998215527, -9.40956064645318, -40.21817328173614, -8.649688149975582, -0.8972036089188222, 1.1686494170110429, -26.268596222924565, 7.2934508436569985, -29.935922630964157, -18.12224481264314, -27.159522679945354, 25.64459405209451, 6.117163515912793, -4.424697986909493, -16.204426638771796, 7.376195701281549, -12.546802758551099, 5.3376939326390005, 7.84089050309147, -15.550740282470112, -36.25453357085374, 3.0807043557185345, -15.675456664859414, -23.22955112890245, -23.08619884047644, -19.598707413863274, 2.519823539081983, -11.45730879687714, -0.64964537214043, -8.2379982781369, -12.111156135856987, 0.1433015919899212, 2.3858733333357307, -7.036626674002321, -16.97706730432829, 4.656126434319523, 16.75328328199021, 3.5126044088125354, 4.208616032929417, -24.608915429397484, 13.698232157861835, -2.631466487769238, 4.468203774796059, -11.549235318750018, 11.523014076546602, -26.00701288402881, -21.25059806319514, 16.00047642815151, 8.701095123750466, -36.26541159474706, -19.382960693940575, 9.232108402015967, -16.88961257360572, -13.247042724635588, -5.240677222169163, -13.080127895466429, -7.361404537407566, -9.054313726525566, -0.41550689919934314, -25.261536984342825, -44.00902266449234, -4.786967185980167, -12.034090439219067, 22.2329594081204, 15.914293704790325, 10.095486263621043, 19.488596141772877, -34.2398324150547, -21.951399972067204, -3.260466207049028, 15.118508443302247, -8.970949450988964, -10.836711336621978, 0.3510559724216762, 11.176085087511964, -6.559570206749623, 3.2613439434340705, -24.93676987554196, -10.106676062520016, 26.352600292034303, -17.738259663948316, 8.458237263730869, 9.940313346019796, -25.25628985107246, -22.799920910489636, -27.523705671195387, 13.003248599086085, -38.937374115150526, -36.702805211153574, -3.3413579245800236, -38.466456581840525, -13.480523385759694, -15.918900132740358, -14.202323367932763, 14.47080510006073, -37.5927156119085, 8.166662317054616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44012987097339334, "mean_inference_ms": 1.161479926607929, "mean_action_processing_ms": 0.18769312792848417, "mean_env_wait_ms": 0.07692507828487162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004107117652893066, "StateBufferConnector_ms": 0.002636551856994629, "ViewRequirementAgentConnector_ms": 0.07313764095306396}, "num_episodes": 10, "episode_return_max": 34.508178484533055, "episode_return_min": -41.876234001352266, "episode_return_mean": -7.654688837541872}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 414.67828021139053, "num_env_steps_trained_throughput_per_sec": 414.67828021139053, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 8367.719, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8367.686, "sample_time_ms": 771.138, "learn_time_ms": 7582.362, "learn_throughput": 527.54, "synch_weights_time_ms": 13.741}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "training_iteration": 27, "trial_id": "83a5c_00000", "date": "2024-08-10_12-17-38", "timestamp": 1723306658, "time_this_iter_s": 9.65270709991455, "time_total_s": 223.1652250289917, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61a0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.1652250289917, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 34.26923076923077, "ram_util_percent": 81.16923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9169499402323726, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.58878782993902, "policy_loss": -0.006680477287733641, "vf_loss": 5.5940821910030625, "vf_explained_var": -0.12282518015967475, "kl": 0.01642808547350544, "entropy": 1.5256928943452381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.07422602744773, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.697124867141246, "policy_loss": -0.00502788521698676, "vf_loss": 5.701078416903814, "vf_explained_var": 0.1338803964977463, "kl": 0.021486537924761014, "entropy": 1.0271653688202302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 29.262052127568417, "episode_reward_min": -39.43641534923553, "episode_reward_mean": -8.149934476891463, "episode_len_mean": 388.51, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38851, "policy_reward_min": {"agent_policy": -29.26205212756843, "adversary_policy": -50.27571919312325}, "policy_reward_max": {"agent_policy": 39.43641534923554, "adversary_policy": 30.612185325123537}, "policy_reward_mean": {"agent_policy": 8.149934476891463, "adversary_policy": -8.149934476891465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.080078592303103, -1.0711107131324678, 29.262052127568417, -14.965274889235399, -39.43641534923553, 9.633381580845407, -22.93983695053654, 13.348741997786286, -35.43493189955169, -34.79760610694063, -18.72319505144694, 0.5843229747291101, 5.939214487469998, 1.2611985412816156, -19.91499414184244, 2.8138885542761916, -31.839931623748626, 6.65979059035633, 21.167677058627216, 20.408762532275095, -6.572536578367412, -26.02962317816581, -28.11337062096422, 10.159807727479107, -20.34155118524857, 4.271219926970527, -7.692020956106793, 4.539083737982319, -12.61898813016671, -30.311085051400656, -15.858393101855881, 14.847528679960751, -15.949169954444068, -16.788603246045355, -13.82334799227834, -4.643459969995208, -9.582078785007027, -11.409768516980353, 11.343635353634689, 3.827994709675318, -23.131206251004663, -24.813866964094665, -4.773445879447202, -12.549973402956757, -11.321235893653578, -22.640883746294246, 15.880878784003652, -10.314562312840648, -2.5853035286347748, 6.589292217865235, -25.90263692666193, -6.297376154570442, -23.157874984689435, -8.539441937390645, -6.053477084508785, -10.17457720699695, 1.264587462662826, -12.006846989165306, 10.70470485815487, 3.860610220870976, -5.455341635767823, 0.9183686435134106, -0.013110621101707132, -23.628805473611976, 12.350785775950987, -27.82418614434382, -3.8287520857948767, -9.243859973402373, -10.220766216436996, -4.734910312862455, -34.63527982441757, -8.410528812599617, 19.07362655645535, 14.792041202696982, -28.09561619356096, 5.9290211181266095, -9.903830393805471, 5.76357052996682, -1.649113131657776, -17.521722969031, 4.3071703140429936, 9.19927530487533, -24.02810538078105, -7.260228536054651, -37.82008966315196, -20.90390725321028, -14.699711759250029, 0.1342408660639851, -14.713026647426943, -0.20238159918407916, -23.21794783290831, -22.756011526133467, -16.35035380328967, -19.344296241800954, -18.586665189888087, -19.367660483070946, 10.350561547758073, -9.949737479483284, -15.455243806145857, -17.319368019595245], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 37, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-14.080078592303101, 1.0711107131324678, -29.26205212756843, 14.965274889235399, 39.43641534923554, -9.633381580845413, 22.93983695053653, -13.34874199778628, 35.434931899551685, 34.79760610694062, 18.72319505144694, -0.5843229747291101, -5.939214487469997, -1.2611985412816158, 19.91499414184244, -2.8138885542761916, 31.83993162374862, -6.659790590356339, -21.16767705862722, -20.408762532275077, 6.572536578367411, 26.02962317816581, 28.11337062096422, -10.159807727479109, 20.341551185248566, -4.271219926970534, 7.692020956106793, -4.539083737982313, 12.61898813016671, 30.31108505140064, 15.858393101855881, -14.847528679960751, 15.949169954444063, 16.788603246045362, 13.823347992278338, 4.643459969995208, 9.582078785007027, 11.409768516980353, -11.343635353634689, -3.827994709675319, 23.131206251004667, 24.81386696409466, 4.773445879447202, 12.549973402956756, 11.321235893653578, 22.640883746294246, -15.880878784003652, 10.314562312840645, 2.5853035286347748, -6.589292217865236, 25.902636926661934, 6.297376154570436, 23.157874984689432, 8.539441937390647, 6.053477084508785, 10.174577206996943, -1.264587462662826, 12.006846989165306, -10.704704858154864, -3.860610220870976, 5.455341635767827, -0.9183686435134106, 0.013110621101707132, 23.628805473611976, -12.350785775950989, 27.824186144343805, 3.8287520857948767, 9.24385997340238, 10.220766216436996, 4.734910312862455, 34.63527982441758, 8.410528812599615, -19.073626556455366, -14.792041202696959, 28.09561619356094, -5.9290211181266095, 9.903830393805483, -5.76357052996682, 1.6491131316577743, 17.521722969030996, -4.307170314042992, -9.199275304875332, 24.028105380781042, 7.260228536054651, 37.82008966315194, 20.903907253210285, 14.699711759250025, -0.13424086606398422, 14.713026647426942, 0.20238159918407916, 23.21794783290831, 22.756011526133467, 16.35035380328968, 19.34429624180095, 18.586665189888112, 19.367660483070946, -10.35056154775807, 9.949737479483284, 15.455243806145845, 17.31936801959525], "policy_adversary_policy_reward": [15.249659283026165, 12.91049790158002, -7.8473551184249555, 5.70513369216002, 27.91191893001333, 30.612185325123537, -11.031858151763892, -18.898691626706906, -50.27571919312325, -28.597111505347854, 3.482797207794265, 15.783965953896569, -12.263945389057369, -33.6157285120157, 1.2968529221862717, 25.400631073386293, -30.070646136127166, -40.79921766297633, -38.581491190190455, -31.01372102369075, -34.08511800330234, -3.361272099591538, -11.241384622569768, 12.410030572027988, 5.780643389994719, 6.097785584945292, -11.360528407762926, 13.882925490326157, -31.989811621567917, -7.840176662116967, -0.2875740799508648, 5.915351188503248, -14.752328997963936, -48.9275342495333, -3.944746092038349, 17.264327272751043, 18.029095971806477, 24.306258145447952, 15.728466475516942, 25.08905858903322, -4.606836444589314, -8.538236712145508, -31.888182772452183, -20.17106358387944, -26.044760604672305, -30.18198063725614, 4.861090806864951, 15.45852464809327, -8.04463337929014, -32.63846899120699, -9.519198536987496, 18.061638390928543, -2.110224463262373, -13.273817448951213, -19.779480442855444, 28.85764791882008, -12.062990233462841, -13.174986026870577, -42.98329493541586, -17.638875167385493, -22.23178011069311, -9.485006093018654, 1.4766145068826617, 28.21844285303884, -12.505778205010628, -19.39256170387751, -22.684793350333763, -10.89241314175695, -29.553388464247618, 1.9066924796909284, -21.603463906510928, 12.316543966520513, -2.440342880144101, -16.723814689869954, -23.63155451612782, 0.8120174821671142, -0.5404185782784019, 23.22768928554778, -7.934435757922296, 15.590425177272934, -22.892788503793835, -23.369623998215527, -9.40956064645318, -40.21817328173614, -8.649688149975582, -0.8972036089188222, 1.1686494170110429, -26.268596222924565, 7.2934508436569985, -29.935922630964157, -18.12224481264314, -27.159522679945354, 25.64459405209451, 6.117163515912793, -4.424697986909493, -16.204426638771796, 7.376195701281549, -12.546802758551099, 5.3376939326390005, 7.84089050309147, -15.550740282470112, -36.25453357085374, 3.0807043557185345, -15.675456664859414, -23.22955112890245, -23.08619884047644, -19.598707413863274, 2.519823539081983, -11.45730879687714, -0.64964537214043, -8.2379982781369, -12.111156135856987, 0.1433015919899212, 2.3858733333357307, -7.036626674002321, -16.97706730432829, 4.656126434319523, 16.75328328199021, 3.5126044088125354, 4.208616032929417, -24.608915429397484, 13.698232157861835, -2.631466487769238, 4.468203774796059, -11.549235318750018, 11.523014076546602, -26.00701288402881, -21.25059806319514, 16.00047642815151, 8.701095123750466, -36.26541159474706, -19.382960693940575, 9.232108402015967, -16.88961257360572, -13.247042724635588, -5.240677222169163, -13.080127895466429, -7.361404537407566, -9.054313726525566, -0.41550689919934314, -25.261536984342825, -44.00902266449234, -4.786967185980167, -12.034090439219067, 22.2329594081204, 15.914293704790325, 10.095486263621043, 19.488596141772877, -34.2398324150547, -21.951399972067204, -3.260466207049028, 15.118508443302247, -8.970949450988964, -10.836711336621978, 0.3510559724216762, 11.176085087511964, -6.559570206749623, 3.2613439434340705, -24.93676987554196, -10.106676062520016, 26.352600292034303, -17.738259663948316, 8.458237263730869, 9.940313346019796, -25.25628985107246, -22.799920910489636, -27.523705671195387, 13.003248599086085, -38.937374115150526, -36.702805211153574, -3.3413579245800236, -38.466456581840525, -13.480523385759694, -15.918900132740358, -14.202323367932763, 14.47080510006073, -37.5927156119085, 8.166662317054616, 1.7443947277856537, -2.149157926153812, -26.36586802377937, -20.070027642037246, -19.626282153335723, -25.885740898931214, -18.627664976744622, -14.073042629834706, 2.8496302389222947, -41.5382227225242, -40.887604673080126, 3.7142742933038733, -4.879713395417575, -33.85560757072432, 7.562177429968244, 13.13894566554793, 5.595942877595284, -25.49541783656185, -25.203261196247382, -5.707226416044318, -7.875840547110371, -26.76289549208019]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43783255197033133, "mean_inference_ms": 1.1546818805931165, "mean_action_processing_ms": 0.18687161193672303, "mean_env_wait_ms": 0.07637576107946564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004656076431274414, "StateBufferConnector_ms": 0.0027207136154174805, "ViewRequirementAgentConnector_ms": 0.07384657859802246}, "num_episodes": 11, "episode_return_max": 29.262052127568417, "episode_return_min": -39.43641534923553, "episode_return_mean": -8.149934476891463}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.10449557237536, "num_env_steps_trained_throughput_per_sec": 435.10449557237536, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 8443.768, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8443.734, "sample_time_ms": 792.408, "learn_time_ms": 7637.156, "learn_throughput": 523.755, "synch_weights_time_ms": 13.725}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 28, "trial_id": "83a5c_00000", "date": "2024-08-10_12-17-48", "timestamp": 1723306668, "time_this_iter_s": 9.198094129562378, "time_total_s": 232.36331915855408, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5c9a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 232.36331915855408, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 31.692307692307693, "ram_util_percent": 81.23076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.95197116385692, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.261634662416246, "policy_loss": -0.006968589211572652, "vf_loss": 6.2675354172943765, "vf_explained_var": -0.033236059341481126, "kl": 0.012655686009897445, "entropy": 1.5023100065175818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.218287480995059, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.721015193561713, "policy_loss": -0.005470602387989251, "vf_loss": 5.725710822145144, "vf_explained_var": 0.3952658622836073, "kl": 0.010333010471637231, "entropy": 0.9626411947732171, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "env_runners": {"episode_reward_max": 41.93926355606551, "episode_reward_min": -48.19454946777389, "episode_reward_mean": -6.620397702346089, "episode_len_mean": 384.32, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 38432, "policy_reward_min": {"agent_policy": -41.93926355606554, "adversary_policy": -55.41260712398561}, "policy_reward_max": {"agent_policy": 48.19454946777388, "adversary_policy": 48.441604760962036}, "policy_reward_mean": {"agent_policy": 6.620397702346087, "adversary_policy": -6.620397702346093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.91499414184244, 2.8138885542761916, -31.839931623748626, 6.65979059035633, 21.167677058627216, 20.408762532275095, -6.572536578367412, -26.02962317816581, -28.11337062096422, 10.159807727479107, -20.34155118524857, 4.271219926970527, -7.692020956106793, 4.539083737982319, -12.61898813016671, -30.311085051400656, -15.858393101855881, 14.847528679960751, -15.949169954444068, -16.788603246045355, -13.82334799227834, -4.643459969995208, -9.582078785007027, -11.409768516980353, 11.343635353634689, 3.827994709675318, -23.131206251004663, -24.813866964094665, -4.773445879447202, -12.549973402956757, -11.321235893653578, -22.640883746294246, 15.880878784003652, -10.314562312840648, -2.5853035286347748, 6.589292217865235, -25.90263692666193, -6.297376154570442, -23.157874984689435, -8.539441937390645, -6.053477084508785, -10.17457720699695, 1.264587462662826, -12.006846989165306, 10.70470485815487, 3.860610220870976, -5.455341635767823, 0.9183686435134106, -0.013110621101707132, -23.628805473611976, 12.350785775950987, -27.82418614434382, -3.8287520857948767, -9.243859973402373, -10.220766216436996, -4.734910312862455, -34.63527982441757, -8.410528812599617, 19.07362655645535, 14.792041202696982, -28.09561619356096, 5.9290211181266095, -9.903830393805471, 5.76357052996682, -1.649113131657776, -17.521722969031, 4.3071703140429936, 9.19927530487533, -24.02810538078105, -7.260228536054651, -37.82008966315196, -20.90390725321028, -14.699711759250029, 0.1342408660639851, -14.713026647426943, -0.20238159918407916, -23.21794783290831, -22.756011526133467, -16.35035380328967, -19.344296241800954, -18.586665189888087, -19.367660483070946, 10.350561547758073, -9.949737479483284, -15.455243806145857, -17.319368019595245, 1.1230569174698797, 41.93926355606551, -18.40433110989635, 3.5387834731997474, 11.807337461039829, 9.000989400028223, 7.679492762986999, 22.874924639030386, -48.19454946777389, 18.68230933367071, -34.9603929734427, 16.039217384785246, 7.292455614895459, 21.27573980438308], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 37, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 103, 400, 266, 400, 400, 400, 233, 400, 400, 400, 400, 187, 400], "policy_agent_policy_reward": [19.91499414184244, -2.8138885542761916, 31.83993162374862, -6.659790590356339, -21.16767705862722, -20.408762532275077, 6.572536578367411, 26.02962317816581, 28.11337062096422, -10.159807727479109, 20.341551185248566, -4.271219926970534, 7.692020956106793, -4.539083737982313, 12.61898813016671, 30.31108505140064, 15.858393101855881, -14.847528679960751, 15.949169954444063, 16.788603246045362, 13.823347992278338, 4.643459969995208, 9.582078785007027, 11.409768516980353, -11.343635353634689, -3.827994709675319, 23.131206251004667, 24.81386696409466, 4.773445879447202, 12.549973402956756, 11.321235893653578, 22.640883746294246, -15.880878784003652, 10.314562312840645, 2.5853035286347748, -6.589292217865236, 25.902636926661934, 6.297376154570436, 23.157874984689432, 8.539441937390647, 6.053477084508785, 10.174577206996943, -1.264587462662826, 12.006846989165306, -10.704704858154864, -3.860610220870976, 5.455341635767827, -0.9183686435134106, 0.013110621101707132, 23.628805473611976, -12.350785775950989, 27.824186144343805, 3.8287520857948767, 9.24385997340238, 10.220766216436996, 4.734910312862455, 34.63527982441758, 8.410528812599615, -19.073626556455366, -14.792041202696959, 28.09561619356094, -5.9290211181266095, 9.903830393805483, -5.76357052996682, 1.6491131316577743, 17.521722969030996, -4.307170314042992, -9.199275304875332, 24.028105380781042, 7.260228536054651, 37.82008966315194, 20.903907253210285, 14.699711759250025, -0.13424086606398422, 14.713026647426942, 0.20238159918407916, 23.21794783290831, 22.756011526133467, 16.35035380328968, 19.34429624180095, 18.586665189888112, 19.367660483070946, -10.35056154775807, 9.949737479483284, 15.455243806145845, 17.31936801959525, -1.123056917469878, -41.93926355606554, 18.404331109896354, -3.538783473199754, -11.807337461039834, -9.000989400028214, -7.679492762987003, -22.874924639030375, 48.19454946777388, -18.68230933367073, 34.96039297344271, -16.039217384785246, -7.2924556148954665, -21.27573980438307], "policy_adversary_policy_reward": [-31.989811621567917, -7.840176662116967, -0.2875740799508648, 5.915351188503248, -14.752328997963936, -48.9275342495333, -3.944746092038349, 17.264327272751043, 18.029095971806477, 24.306258145447952, 15.728466475516942, 25.08905858903322, -4.606836444589314, -8.538236712145508, -31.888182772452183, -20.17106358387944, -26.044760604672305, -30.18198063725614, 4.861090806864951, 15.45852464809327, -8.04463337929014, -32.63846899120699, -9.519198536987496, 18.061638390928543, -2.110224463262373, -13.273817448951213, -19.779480442855444, 28.85764791882008, -12.062990233462841, -13.174986026870577, -42.98329493541586, -17.638875167385493, -22.23178011069311, -9.485006093018654, 1.4766145068826617, 28.21844285303884, -12.505778205010628, -19.39256170387751, -22.684793350333763, -10.89241314175695, -29.553388464247618, 1.9066924796909284, -21.603463906510928, 12.316543966520513, -2.440342880144101, -16.723814689869954, -23.63155451612782, 0.8120174821671142, -0.5404185782784019, 23.22768928554778, -7.934435757922296, 15.590425177272934, -22.892788503793835, -23.369623998215527, -9.40956064645318, -40.21817328173614, -8.649688149975582, -0.8972036089188222, 1.1686494170110429, -26.268596222924565, 7.2934508436569985, -29.935922630964157, -18.12224481264314, -27.159522679945354, 25.64459405209451, 6.117163515912793, -4.424697986909493, -16.204426638771796, 7.376195701281549, -12.546802758551099, 5.3376939326390005, 7.84089050309147, -15.550740282470112, -36.25453357085374, 3.0807043557185345, -15.675456664859414, -23.22955112890245, -23.08619884047644, -19.598707413863274, 2.519823539081983, -11.45730879687714, -0.64964537214043, -8.2379982781369, -12.111156135856987, 0.1433015919899212, 2.3858733333357307, -7.036626674002321, -16.97706730432829, 4.656126434319523, 16.75328328199021, 3.5126044088125354, 4.208616032929417, -24.608915429397484, 13.698232157861835, -2.631466487769238, 4.468203774796059, -11.549235318750018, 11.523014076546602, -26.00701288402881, -21.25059806319514, 16.00047642815151, 8.701095123750466, -36.26541159474706, -19.382960693940575, 9.232108402015967, -16.88961257360572, -13.247042724635588, -5.240677222169163, -13.080127895466429, -7.361404537407566, -9.054313726525566, -0.41550689919934314, -25.261536984342825, -44.00902266449234, -4.786967185980167, -12.034090439219067, 22.2329594081204, 15.914293704790325, 10.095486263621043, 19.488596141772877, -34.2398324150547, -21.951399972067204, -3.260466207049028, 15.118508443302247, -8.970949450988964, -10.836711336621978, 0.3510559724216762, 11.176085087511964, -6.559570206749623, 3.2613439434340705, -24.93676987554196, -10.106676062520016, 26.352600292034303, -17.738259663948316, 8.458237263730869, 9.940313346019796, -25.25628985107246, -22.799920910489636, -27.523705671195387, 13.003248599086085, -38.937374115150526, -36.702805211153574, -3.3413579245800236, -38.466456581840525, -13.480523385759694, -15.918900132740358, -14.202323367932763, 14.47080510006073, -37.5927156119085, 8.166662317054616, 1.7443947277856537, -2.149157926153812, -26.36586802377937, -20.070027642037246, -19.626282153335723, -25.885740898931214, -18.627664976744622, -14.073042629834706, 2.8496302389222947, -41.5382227225242, -40.887604673080126, 3.7142742933038733, -4.879713395417575, -33.85560757072432, 7.562177429968244, 13.13894566554793, 5.595942877595284, -25.49541783656185, -25.203261196247382, -5.707226416044318, -7.875840547110371, -26.76289549208019, 10.817289476051986, -8.571175641112195, 48.441604760962036, 35.43692235116902, -10.13150678375387, -26.67715543603883, -1.566783819996318, 8.64435076639581, 13.507852061978424, 10.10682286010122, 7.173740354733509, 10.828238445322913, 8.395071418619297, 6.963914107354697, 27.336584669555002, 18.413264608505777, -40.97649181156209, -55.41260712398561, 23.62186077734294, 13.742757889998503, -43.717582557537945, -26.20320338934752, 23.991730182269038, 8.086704587301444, 36.42530606559988, -21.840394835808965, 11.70463501211167, 30.8468445966545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43582280230190007, "mean_inference_ms": 1.1478872892110912, "mean_action_processing_ms": 0.1861119398191652, "mean_env_wait_ms": 0.07577728510633101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004615187644958496, "StateBufferConnector_ms": 0.002707242965698242, "ViewRequirementAgentConnector_ms": 0.07496857643127441}, "num_episodes": 14, "episode_return_max": 41.93926355606551, "episode_return_min": -48.19454946777389, "episode_return_mean": -6.620397702346089}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 465.7799147858885, "num_env_steps_trained_throughput_per_sec": 465.7799147858885, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 8482.495, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8482.461, "sample_time_ms": 806.618, "learn_time_ms": 7661.855, "learn_throughput": 522.067, "synch_weights_time_ms": 13.582}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "training_iteration": 29, "trial_id": "83a5c_00000", "date": "2024-08-10_12-17-56", "timestamp": 1723306676, "time_this_iter_s": 8.592236995697021, "time_total_s": 240.9555561542511, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f636af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 240.9555561542511, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 27.26153846153846, "ram_util_percent": 81.44615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9180019012203924, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.410058105811871, "policy_loss": -0.001580638349765823, "vf_loss": 5.411031078156971, "vf_explained_var": -0.10289887937288436, "kl": 0.0072020071093177014, "entropy": 1.5419169417134038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9730617811282474, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.194473288953304, "policy_loss": -0.0023213724028513147, "vf_loss": 5.196211958676576, "vf_explained_var": 0.308489484526217, "kl": 0.00776938278502494, "entropy": 0.8464157016326984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 41.93926355606551, "episode_reward_min": -51.53203790380037, "episode_reward_mean": -6.097746653290292, "episode_len_mean": 367.16, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 36716, "policy_reward_min": {"agent_policy": -41.93926355606554, "adversary_policy": -59.2382306800285}, "policy_reward_max": {"agent_policy": 51.53203790380038, "adversary_policy": 48.441604760962036}, "policy_reward_mean": {"agent_policy": 6.09774665329029, "adversary_policy": -6.097746653290294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.61898813016671, -30.311085051400656, -15.858393101855881, 14.847528679960751, -15.949169954444068, -16.788603246045355, -13.82334799227834, -4.643459969995208, -9.582078785007027, -11.409768516980353, 11.343635353634689, 3.827994709675318, -23.131206251004663, -24.813866964094665, -4.773445879447202, -12.549973402956757, -11.321235893653578, -22.640883746294246, 15.880878784003652, -10.314562312840648, -2.5853035286347748, 6.589292217865235, -25.90263692666193, -6.297376154570442, -23.157874984689435, -8.539441937390645, -6.053477084508785, -10.17457720699695, 1.264587462662826, -12.006846989165306, 10.70470485815487, 3.860610220870976, -5.455341635767823, 0.9183686435134106, -0.013110621101707132, -23.628805473611976, 12.350785775950987, -27.82418614434382, -3.8287520857948767, -9.243859973402373, -10.220766216436996, -4.734910312862455, -34.63527982441757, -8.410528812599617, 19.07362655645535, 14.792041202696982, -28.09561619356096, 5.9290211181266095, -9.903830393805471, 5.76357052996682, -1.649113131657776, -17.521722969031, 4.3071703140429936, 9.19927530487533, -24.02810538078105, -7.260228536054651, -37.82008966315196, -20.90390725321028, -14.699711759250029, 0.1342408660639851, -14.713026647426943, -0.20238159918407916, -23.21794783290831, -22.756011526133467, -16.35035380328967, -19.344296241800954, -18.586665189888087, -19.367660483070946, 10.350561547758073, -9.949737479483284, -15.455243806145857, -17.319368019595245, 1.1230569174698797, 41.93926355606551, -18.40433110989635, 3.5387834731997474, 11.807337461039829, 9.000989400028223, 7.679492762986999, 22.874924639030386, -48.19454946777389, 18.68230933367071, -34.9603929734427, 16.039217384785246, 7.292455614895459, 21.27573980438308, 32.51512509516848, -51.384858529330806, -32.716146233942375, -44.55415168189967, -32.03060065269456, 21.17147297940132, 25.86527643074837, 23.107338288120594, -51.53203790380037, 3.4551375530697905, 17.757196227109265, 32.2940010508359, 16.671513966956205, 21.16204015936055], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 37, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 103, 400, 266, 400, 400, 400, 233, 400, 400, 400, 400, 187, 400, 400, 400, 400, 400, 400, 125, 167, 163, 400, 17, 280, 203, 400, 129], "policy_agent_policy_reward": [12.61898813016671, 30.31108505140064, 15.858393101855881, -14.847528679960751, 15.949169954444063, 16.788603246045362, 13.823347992278338, 4.643459969995208, 9.582078785007027, 11.409768516980353, -11.343635353634689, -3.827994709675319, 23.131206251004667, 24.81386696409466, 4.773445879447202, 12.549973402956756, 11.321235893653578, 22.640883746294246, -15.880878784003652, 10.314562312840645, 2.5853035286347748, -6.589292217865236, 25.902636926661934, 6.297376154570436, 23.157874984689432, 8.539441937390647, 6.053477084508785, 10.174577206996943, -1.264587462662826, 12.006846989165306, -10.704704858154864, -3.860610220870976, 5.455341635767827, -0.9183686435134106, 0.013110621101707132, 23.628805473611976, -12.350785775950989, 27.824186144343805, 3.8287520857948767, 9.24385997340238, 10.220766216436996, 4.734910312862455, 34.63527982441758, 8.410528812599615, -19.073626556455366, -14.792041202696959, 28.09561619356094, -5.9290211181266095, 9.903830393805483, -5.76357052996682, 1.6491131316577743, 17.521722969030996, -4.307170314042992, -9.199275304875332, 24.028105380781042, 7.260228536054651, 37.82008966315194, 20.903907253210285, 14.699711759250025, -0.13424086606398422, 14.713026647426942, 0.20238159918407916, 23.21794783290831, 22.756011526133467, 16.35035380328968, 19.34429624180095, 18.586665189888112, 19.367660483070946, -10.35056154775807, 9.949737479483284, 15.455243806145845, 17.31936801959525, -1.123056917469878, -41.93926355606554, 18.404331109896354, -3.538783473199754, -11.807337461039834, -9.000989400028214, -7.679492762987003, -22.874924639030375, 48.19454946777388, -18.68230933367073, 34.96039297344271, -16.039217384785246, -7.2924556148954665, -21.27573980438307, -32.5151250951685, 51.38485852933083, 32.71614623394238, 44.554151681899675, 32.03060065269456, -21.17147297940133, -25.865276430748366, -23.10733828812059, 51.53203790380038, -3.4551375530697905, -17.75719622710929, -32.29400105083593, -16.671513966956205, -21.162040159360547], "policy_adversary_policy_reward": [-12.062990233462841, -13.174986026870577, -42.98329493541586, -17.638875167385493, -22.23178011069311, -9.485006093018654, 1.4766145068826617, 28.21844285303884, -12.505778205010628, -19.39256170387751, -22.684793350333763, -10.89241314175695, -29.553388464247618, 1.9066924796909284, -21.603463906510928, 12.316543966520513, -2.440342880144101, -16.723814689869954, -23.63155451612782, 0.8120174821671142, -0.5404185782784019, 23.22768928554778, -7.934435757922296, 15.590425177272934, -22.892788503793835, -23.369623998215527, -9.40956064645318, -40.21817328173614, -8.649688149975582, -0.8972036089188222, 1.1686494170110429, -26.268596222924565, 7.2934508436569985, -29.935922630964157, -18.12224481264314, -27.159522679945354, 25.64459405209451, 6.117163515912793, -4.424697986909493, -16.204426638771796, 7.376195701281549, -12.546802758551099, 5.3376939326390005, 7.84089050309147, -15.550740282470112, -36.25453357085374, 3.0807043557185345, -15.675456664859414, -23.22955112890245, -23.08619884047644, -19.598707413863274, 2.519823539081983, -11.45730879687714, -0.64964537214043, -8.2379982781369, -12.111156135856987, 0.1433015919899212, 2.3858733333357307, -7.036626674002321, -16.97706730432829, 4.656126434319523, 16.75328328199021, 3.5126044088125354, 4.208616032929417, -24.608915429397484, 13.698232157861835, -2.631466487769238, 4.468203774796059, -11.549235318750018, 11.523014076546602, -26.00701288402881, -21.25059806319514, 16.00047642815151, 8.701095123750466, -36.26541159474706, -19.382960693940575, 9.232108402015967, -16.88961257360572, -13.247042724635588, -5.240677222169163, -13.080127895466429, -7.361404537407566, -9.054313726525566, -0.41550689919934314, -25.261536984342825, -44.00902266449234, -4.786967185980167, -12.034090439219067, 22.2329594081204, 15.914293704790325, 10.095486263621043, 19.488596141772877, -34.2398324150547, -21.951399972067204, -3.260466207049028, 15.118508443302247, -8.970949450988964, -10.836711336621978, 0.3510559724216762, 11.176085087511964, -6.559570206749623, 3.2613439434340705, -24.93676987554196, -10.106676062520016, 26.352600292034303, -17.738259663948316, 8.458237263730869, 9.940313346019796, -25.25628985107246, -22.799920910489636, -27.523705671195387, 13.003248599086085, -38.937374115150526, -36.702805211153574, -3.3413579245800236, -38.466456581840525, -13.480523385759694, -15.918900132740358, -14.202323367932763, 14.47080510006073, -37.5927156119085, 8.166662317054616, 1.7443947277856537, -2.149157926153812, -26.36586802377937, -20.070027642037246, -19.626282153335723, -25.885740898931214, -18.627664976744622, -14.073042629834706, 2.8496302389222947, -41.5382227225242, -40.887604673080126, 3.7142742933038733, -4.879713395417575, -33.85560757072432, 7.562177429968244, 13.13894566554793, 5.595942877595284, -25.49541783656185, -25.203261196247382, -5.707226416044318, -7.875840547110371, -26.76289549208019, 10.817289476051986, -8.571175641112195, 48.441604760962036, 35.43692235116902, -10.13150678375387, -26.67715543603883, -1.566783819996318, 8.64435076639581, 13.507852061978424, 10.10682286010122, 7.173740354733509, 10.828238445322913, 8.395071418619297, 6.963914107354697, 27.336584669555002, 18.413264608505777, -40.97649181156209, -55.41260712398561, 23.62186077734294, 13.742757889998503, -43.717582557537945, -26.20320338934752, 23.991730182269038, 8.086704587301444, 36.42530606559988, -21.840394835808965, 11.70463501211167, 30.8468445966545, 33.15668886583209, 31.87356132450489, -48.902459153284305, -53.867257905377336, -33.19309584538235, -32.239196622502405, -59.2382306800285, -29.87007268377088, -35.73876700443195, -28.32243430095717, 9.198495082622491, 33.14445087618016, 26.713708587517925, 25.01684427397882, 13.985763828914516, 32.228912747326646, -50.6669572593179, -52.39711854828284, 8.50320202975385, -1.5929269236142716, -0.1439948323853697, 35.658387286603926, 45.43251362491974, 19.155488476752122, 20.882658247601714, 12.460369686310743, 9.376798908934976, 32.94728140978612]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43481458329174394, "mean_inference_ms": 1.1440999237682663, "mean_action_processing_ms": 0.18578677738082583, "mean_env_wait_ms": 0.07544426855032225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047092437744140625, "StateBufferConnector_ms": 0.0027822256088256836, "ViewRequirementAgentConnector_ms": 0.07739973068237305}, "num_episodes": 14, "episode_return_max": 41.93926355606551, "episode_return_min": -51.53203790380037, "episode_return_mean": -6.097746653290292}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 430.183668907916, "num_env_steps_trained_throughput_per_sec": 430.183668907916, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 8613.499, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8613.465, "sample_time_ms": 836.383, "learn_time_ms": 7762.99, "learn_throughput": 515.265, "synch_weights_time_ms": 13.688}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 30, "trial_id": "83a5c_00000", "date": "2024-08-10_12-18-05", "timestamp": 1723306685, "time_this_iter_s": 9.304750204086304, "time_total_s": 250.2603063583374, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f635f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.2603063583374, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 33.9, "ram_util_percent": 82.06153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8536415692044312, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.7825505143120175, "policy_loss": -0.003652585089630472, "vf_loss": 5.785651344723171, "vf_explained_var": -0.14178180101687315, "kl": 0.006539456095854319, "entropy": 1.5361656376293726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0337766549860437, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.273675325761238, "policy_loss": -0.0045717596738541035, "vf_loss": 5.277491427709659, "vf_explained_var": 0.37149255617211263, "kl": 0.010075106243976355, "entropy": 0.8848121225213011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "env_runners": {"episode_reward_max": 44.111550063481225, "episode_reward_min": -56.10462546324677, "episode_reward_mean": -4.503622237314026, "episode_len_mean": 341.13, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 34113, "policy_reward_min": {"agent_policy": -44.11155006348118, "adversary_policy": -63.146454592978245}, "policy_reward_max": {"agent_policy": 56.10462546324678, "adversary_policy": 48.441604760962036}, "policy_reward_mean": {"agent_policy": 4.503622237314028, "adversary_policy": -4.503622237314028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.321235893653578, -22.640883746294246, 15.880878784003652, -10.314562312840648, -2.5853035286347748, 6.589292217865235, -25.90263692666193, -6.297376154570442, -23.157874984689435, -8.539441937390645, -6.053477084508785, -10.17457720699695, 1.264587462662826, -12.006846989165306, 10.70470485815487, 3.860610220870976, -5.455341635767823, 0.9183686435134106, -0.013110621101707132, -23.628805473611976, 12.350785775950987, -27.82418614434382, -3.8287520857948767, -9.243859973402373, -10.220766216436996, -4.734910312862455, -34.63527982441757, -8.410528812599617, 19.07362655645535, 14.792041202696982, -28.09561619356096, 5.9290211181266095, -9.903830393805471, 5.76357052996682, -1.649113131657776, -17.521722969031, 4.3071703140429936, 9.19927530487533, -24.02810538078105, -7.260228536054651, -37.82008966315196, -20.90390725321028, -14.699711759250029, 0.1342408660639851, -14.713026647426943, -0.20238159918407916, -23.21794783290831, -22.756011526133467, -16.35035380328967, -19.344296241800954, -18.586665189888087, -19.367660483070946, 10.350561547758073, -9.949737479483284, -15.455243806145857, -17.319368019595245, 1.1230569174698797, 41.93926355606551, -18.40433110989635, 3.5387834731997474, 11.807337461039829, 9.000989400028223, 7.679492762986999, 22.874924639030386, -48.19454946777389, 18.68230933367071, -34.9603929734427, 16.039217384785246, 7.292455614895459, 21.27573980438308, 32.51512509516848, -51.384858529330806, -32.716146233942375, -44.55415168189967, -32.03060065269456, 21.17147297940132, 25.86527643074837, 23.107338288120594, -51.53203790380037, 3.4551375530697905, 17.757196227109265, 32.2940010508359, 16.671513966956205, 21.16204015936055, -32.12082409361043, 15.881891704555539, -56.10462546324677, -38.357784533570836, 20.707624968806236, -0.6800804940634633, 28.509361167662032, -28.17601957934607, 19.398621250899293, 15.354830532225352, -51.12524840613426, 44.111550063481225, 27.09619753292729, 6.932842246761007, 5.6239602033660345, 16.12591599450812], "episode_lengths": [400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 37, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 103, 400, 266, 400, 400, 400, 233, 400, 400, 400, 400, 187, 400, 400, 400, 400, 400, 400, 125, 167, 163, 400, 17, 280, 203, 400, 129, 400, 262, 400, 400, 181, 62, 198, 400, 170, 127, 400, 248, 240, 106, 63, 140], "policy_agent_policy_reward": [11.321235893653578, 22.640883746294246, -15.880878784003652, 10.314562312840645, 2.5853035286347748, -6.589292217865236, 25.902636926661934, 6.297376154570436, 23.157874984689432, 8.539441937390647, 6.053477084508785, 10.174577206996943, -1.264587462662826, 12.006846989165306, -10.704704858154864, -3.860610220870976, 5.455341635767827, -0.9183686435134106, 0.013110621101707132, 23.628805473611976, -12.350785775950989, 27.824186144343805, 3.8287520857948767, 9.24385997340238, 10.220766216436996, 4.734910312862455, 34.63527982441758, 8.410528812599615, -19.073626556455366, -14.792041202696959, 28.09561619356094, -5.9290211181266095, 9.903830393805483, -5.76357052996682, 1.6491131316577743, 17.521722969030996, -4.307170314042992, -9.199275304875332, 24.028105380781042, 7.260228536054651, 37.82008966315194, 20.903907253210285, 14.699711759250025, -0.13424086606398422, 14.713026647426942, 0.20238159918407916, 23.21794783290831, 22.756011526133467, 16.35035380328968, 19.34429624180095, 18.586665189888112, 19.367660483070946, -10.35056154775807, 9.949737479483284, 15.455243806145845, 17.31936801959525, -1.123056917469878, -41.93926355606554, 18.404331109896354, -3.538783473199754, -11.807337461039834, -9.000989400028214, -7.679492762987003, -22.874924639030375, 48.19454946777388, -18.68230933367073, 34.96039297344271, -16.039217384785246, -7.2924556148954665, -21.27573980438307, -32.5151250951685, 51.38485852933083, 32.71614623394238, 44.554151681899675, 32.03060065269456, -21.17147297940133, -25.865276430748366, -23.10733828812059, 51.53203790380038, -3.4551375530697905, -17.75719622710929, -32.29400105083593, -16.671513966956205, -21.162040159360547, 32.12082409361043, -15.881891704555528, 56.10462546324678, 38.35778453357084, -20.707624968806225, 0.6800804940634624, -28.50936116766204, 28.17601957934607, -19.398621250899286, -15.354830532225357, 51.12524840613427, -44.11155006348118, -27.096197532927334, -6.932842246761009, -5.6239602033660345, -16.125915994508112], "policy_adversary_policy_reward": [7.2934508436569985, -29.935922630964157, -18.12224481264314, -27.159522679945354, 25.64459405209451, 6.117163515912793, -4.424697986909493, -16.204426638771796, 7.376195701281549, -12.546802758551099, 5.3376939326390005, 7.84089050309147, -15.550740282470112, -36.25453357085374, 3.0807043557185345, -15.675456664859414, -23.22955112890245, -23.08619884047644, -19.598707413863274, 2.519823539081983, -11.45730879687714, -0.64964537214043, -8.2379982781369, -12.111156135856987, 0.1433015919899212, 2.3858733333357307, -7.036626674002321, -16.97706730432829, 4.656126434319523, 16.75328328199021, 3.5126044088125354, 4.208616032929417, -24.608915429397484, 13.698232157861835, -2.631466487769238, 4.468203774796059, -11.549235318750018, 11.523014076546602, -26.00701288402881, -21.25059806319514, 16.00047642815151, 8.701095123750466, -36.26541159474706, -19.382960693940575, 9.232108402015967, -16.88961257360572, -13.247042724635588, -5.240677222169163, -13.080127895466429, -7.361404537407566, -9.054313726525566, -0.41550689919934314, -25.261536984342825, -44.00902266449234, -4.786967185980167, -12.034090439219067, 22.2329594081204, 15.914293704790325, 10.095486263621043, 19.488596141772877, -34.2398324150547, -21.951399972067204, -3.260466207049028, 15.118508443302247, -8.970949450988964, -10.836711336621978, 0.3510559724216762, 11.176085087511964, -6.559570206749623, 3.2613439434340705, -24.93676987554196, -10.106676062520016, 26.352600292034303, -17.738259663948316, 8.458237263730869, 9.940313346019796, -25.25628985107246, -22.799920910489636, -27.523705671195387, 13.003248599086085, -38.937374115150526, -36.702805211153574, -3.3413579245800236, -38.466456581840525, -13.480523385759694, -15.918900132740358, -14.202323367932763, 14.47080510006073, -37.5927156119085, 8.166662317054616, 1.7443947277856537, -2.149157926153812, -26.36586802377937, -20.070027642037246, -19.626282153335723, -25.885740898931214, -18.627664976744622, -14.073042629834706, 2.8496302389222947, -41.5382227225242, -40.887604673080126, 3.7142742933038733, -4.879713395417575, -33.85560757072432, 7.562177429968244, 13.13894566554793, 5.595942877595284, -25.49541783656185, -25.203261196247382, -5.707226416044318, -7.875840547110371, -26.76289549208019, 10.817289476051986, -8.571175641112195, 48.441604760962036, 35.43692235116902, -10.13150678375387, -26.67715543603883, -1.566783819996318, 8.64435076639581, 13.507852061978424, 10.10682286010122, 7.173740354733509, 10.828238445322913, 8.395071418619297, 6.963914107354697, 27.336584669555002, 18.413264608505777, -40.97649181156209, -55.41260712398561, 23.62186077734294, 13.742757889998503, -43.717582557537945, -26.20320338934752, 23.991730182269038, 8.086704587301444, 36.42530606559988, -21.840394835808965, 11.70463501211167, 30.8468445966545, 33.15668886583209, 31.87356132450489, -48.902459153284305, -53.867257905377336, -33.19309584538235, -32.239196622502405, -59.2382306800285, -29.87007268377088, -35.73876700443195, -28.32243430095717, 9.198495082622491, 33.14445087618016, 26.713708587517925, 25.01684427397882, 13.985763828914516, 32.228912747326646, -50.6669572593179, -52.39711854828284, 8.50320202975385, -1.5929269236142716, -0.1439948323853697, 35.658387286603926, 45.43251362491974, 19.155488476752122, 20.882658247601714, 12.460369686310743, 9.376798908934976, 32.94728140978612, -18.541998633918773, -45.69964955330209, 18.901564568532113, 12.862218840578947, -49.06279633351533, -63.146454592978245, -30.826364485679477, -45.88920458146222, 23.983514827420603, 17.431735110191863, -15.28030629725431, 13.920145309127383, 26.010066801210108, 31.008655534113966, -19.50532203398825, -36.84671712470389, 19.232405245145074, 19.564837256653504, 16.28235978725548, 14.427301277195223, -55.07367674367855, -47.17682006858992, 47.4539839274547, 40.769116199507735, 25.90338950375036, 28.28900556210426, 8.432463138060115, 5.433221355461903, 25.279215324802454, -14.031294918070373, 18.218252711436534, 14.033579277579696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4339021649142994, "mean_inference_ms": 1.1428704217005556, "mean_action_processing_ms": 0.18568590853441255, "mean_env_wait_ms": 0.07531420338955916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004782438278198242, "StateBufferConnector_ms": 0.0029593706130981445, "ViewRequirementAgentConnector_ms": 0.07975482940673828}, "num_episodes": 16, "episode_return_max": 44.111550063481225, "episode_return_min": -56.10462546324677, "episode_return_mean": -4.503622237314026}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.9273615624307, "num_env_steps_trained_throughput_per_sec": 440.9273615624307, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 8715.854, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8715.82, "sample_time_ms": 850.239, "learn_time_ms": 7851.417, "learn_throughput": 509.462, "synch_weights_time_ms": 13.752}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "training_iteration": 31, "trial_id": "83a5c_00000", "date": "2024-08-10_12-18-15", "timestamp": 1723306695, "time_this_iter_s": 9.08307695388794, "time_total_s": 259.34338331222534, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f635ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 259.34338331222534, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 30.47692307692308, "ram_util_percent": 81.95384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7043941008035466, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.171047689801171, "policy_loss": -0.005781433599133774, "vf_loss": 6.175199704195457, "vf_explained_var": -0.27831293092202886, "kl": 0.019311532702732337, "entropy": 1.54211121223591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3132508288448057, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.626689996818701, "policy_loss": -0.0066693228121342445, "vf_loss": 5.631443223853906, "vf_explained_var": 0.3147859144334992, "kl": 0.025547976444719823, "entropy": 0.8481176100050409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 44.111550063481225, "episode_reward_min": -56.10462546324677, "episode_reward_mean": -3.6017184919628136, "episode_len_mean": 325.53, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 32553, "policy_reward_min": {"agent_policy": -44.11155006348118, "adversary_policy": -63.146454592978245}, "policy_reward_max": {"agent_policy": 56.10462546324678, "adversary_policy": 48.441604760962036}, "policy_reward_mean": {"agent_policy": 3.601718491962813, "adversary_policy": -3.601718491962814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.455341635767823, 0.9183686435134106, -0.013110621101707132, -23.628805473611976, 12.350785775950987, -27.82418614434382, -3.8287520857948767, -9.243859973402373, -10.220766216436996, -4.734910312862455, -34.63527982441757, -8.410528812599617, 19.07362655645535, 14.792041202696982, -28.09561619356096, 5.9290211181266095, -9.903830393805471, 5.76357052996682, -1.649113131657776, -17.521722969031, 4.3071703140429936, 9.19927530487533, -24.02810538078105, -7.260228536054651, -37.82008966315196, -20.90390725321028, -14.699711759250029, 0.1342408660639851, -14.713026647426943, -0.20238159918407916, -23.21794783290831, -22.756011526133467, -16.35035380328967, -19.344296241800954, -18.586665189888087, -19.367660483070946, 10.350561547758073, -9.949737479483284, -15.455243806145857, -17.319368019595245, 1.1230569174698797, 41.93926355606551, -18.40433110989635, 3.5387834731997474, 11.807337461039829, 9.000989400028223, 7.679492762986999, 22.874924639030386, -48.19454946777389, 18.68230933367071, -34.9603929734427, 16.039217384785246, 7.292455614895459, 21.27573980438308, 32.51512509516848, -51.384858529330806, -32.716146233942375, -44.55415168189967, -32.03060065269456, 21.17147297940132, 25.86527643074837, 23.107338288120594, -51.53203790380037, 3.4551375530697905, 17.757196227109265, 32.2940010508359, 16.671513966956205, 21.16204015936055, -32.12082409361043, 15.881891704555539, -56.10462546324677, -38.357784533570836, 20.707624968806236, -0.6800804940634633, 28.509361167662032, -28.17601957934607, 19.398621250899293, 15.354830532225352, -51.12524840613426, 44.111550063481225, 27.09619753292729, 6.932842246761007, 5.6239602033660345, 16.12591599450812, 10.0099514857194, 2.6053128431446986, 1.819303839536756, -28.790660312331532, -22.047149530944075, 9.893878574484232, -31.72003550636819, -31.02534158089413, 27.097899985060497, -45.80945115289876, 18.274791355457918, 29.576922544459848, 25.617381941946455, -38.08450066375535, 37.29944711472042, 24.77848037593406], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 103, 400, 266, 400, 400, 400, 233, 400, 400, 400, 400, 187, 400, 400, 400, 400, 400, 400, 125, 167, 163, 400, 17, 280, 203, 400, 129, 400, 262, 400, 400, 181, 62, 198, 400, 170, 127, 400, 248, 240, 106, 63, 140, 113, 159, 129, 400, 400, 83, 400, 400, 100, 400, 175, 163, 339, 400, 213, 209], "policy_agent_policy_reward": [5.455341635767827, -0.9183686435134106, 0.013110621101707132, 23.628805473611976, -12.350785775950989, 27.824186144343805, 3.8287520857948767, 9.24385997340238, 10.220766216436996, 4.734910312862455, 34.63527982441758, 8.410528812599615, -19.073626556455366, -14.792041202696959, 28.09561619356094, -5.9290211181266095, 9.903830393805483, -5.76357052996682, 1.6491131316577743, 17.521722969030996, -4.307170314042992, -9.199275304875332, 24.028105380781042, 7.260228536054651, 37.82008966315194, 20.903907253210285, 14.699711759250025, -0.13424086606398422, 14.713026647426942, 0.20238159918407916, 23.21794783290831, 22.756011526133467, 16.35035380328968, 19.34429624180095, 18.586665189888112, 19.367660483070946, -10.35056154775807, 9.949737479483284, 15.455243806145845, 17.31936801959525, -1.123056917469878, -41.93926355606554, 18.404331109896354, -3.538783473199754, -11.807337461039834, -9.000989400028214, -7.679492762987003, -22.874924639030375, 48.19454946777388, -18.68230933367073, 34.96039297344271, -16.039217384785246, -7.2924556148954665, -21.27573980438307, -32.5151250951685, 51.38485852933083, 32.71614623394238, 44.554151681899675, 32.03060065269456, -21.17147297940133, -25.865276430748366, -23.10733828812059, 51.53203790380038, -3.4551375530697905, -17.75719622710929, -32.29400105083593, -16.671513966956205, -21.162040159360547, 32.12082409361043, -15.881891704555528, 56.10462546324678, 38.35778453357084, -20.707624968806225, 0.6800804940634624, -28.50936116766204, 28.17601957934607, -19.398621250899286, -15.354830532225357, 51.12524840613427, -44.11155006348118, -27.096197532927334, -6.932842246761009, -5.6239602033660345, -16.125915994508112, -10.009951485719393, -2.6053128431446924, -1.8193038395367584, 28.790660312331532, 22.047149530944075, -9.893878574484233, 31.72003550636819, 31.02534158089413, -27.0978999850605, 45.80945115289875, -18.274791355457932, -29.57692254445982, -25.617381941946466, 38.08450066375536, -37.299447114720444, -24.77848037593403], "policy_adversary_policy_reward": [-24.608915429397484, 13.698232157861835, -2.631466487769238, 4.468203774796059, -11.549235318750018, 11.523014076546602, -26.00701288402881, -21.25059806319514, 16.00047642815151, 8.701095123750466, -36.26541159474706, -19.382960693940575, 9.232108402015967, -16.88961257360572, -13.247042724635588, -5.240677222169163, -13.080127895466429, -7.361404537407566, -9.054313726525566, -0.41550689919934314, -25.261536984342825, -44.00902266449234, -4.786967185980167, -12.034090439219067, 22.2329594081204, 15.914293704790325, 10.095486263621043, 19.488596141772877, -34.2398324150547, -21.951399972067204, -3.260466207049028, 15.118508443302247, -8.970949450988964, -10.836711336621978, 0.3510559724216762, 11.176085087511964, -6.559570206749623, 3.2613439434340705, -24.93676987554196, -10.106676062520016, 26.352600292034303, -17.738259663948316, 8.458237263730869, 9.940313346019796, -25.25628985107246, -22.799920910489636, -27.523705671195387, 13.003248599086085, -38.937374115150526, -36.702805211153574, -3.3413579245800236, -38.466456581840525, -13.480523385759694, -15.918900132740358, -14.202323367932763, 14.47080510006073, -37.5927156119085, 8.166662317054616, 1.7443947277856537, -2.149157926153812, -26.36586802377937, -20.070027642037246, -19.626282153335723, -25.885740898931214, -18.627664976744622, -14.073042629834706, 2.8496302389222947, -41.5382227225242, -40.887604673080126, 3.7142742933038733, -4.879713395417575, -33.85560757072432, 7.562177429968244, 13.13894566554793, 5.595942877595284, -25.49541783656185, -25.203261196247382, -5.707226416044318, -7.875840547110371, -26.76289549208019, 10.817289476051986, -8.571175641112195, 48.441604760962036, 35.43692235116902, -10.13150678375387, -26.67715543603883, -1.566783819996318, 8.64435076639581, 13.507852061978424, 10.10682286010122, 7.173740354733509, 10.828238445322913, 8.395071418619297, 6.963914107354697, 27.336584669555002, 18.413264608505777, -40.97649181156209, -55.41260712398561, 23.62186077734294, 13.742757889998503, -43.717582557537945, -26.20320338934752, 23.991730182269038, 8.086704587301444, 36.42530606559988, -21.840394835808965, 11.70463501211167, 30.8468445966545, 33.15668886583209, 31.87356132450489, -48.902459153284305, -53.867257905377336, -33.19309584538235, -32.239196622502405, -59.2382306800285, -29.87007268377088, -35.73876700443195, -28.32243430095717, 9.198495082622491, 33.14445087618016, 26.713708587517925, 25.01684427397882, 13.985763828914516, 32.228912747326646, -50.6669572593179, -52.39711854828284, 8.50320202975385, -1.5929269236142716, -0.1439948323853697, 35.658387286603926, 45.43251362491974, 19.155488476752122, 20.882658247601714, 12.460369686310743, 9.376798908934976, 32.94728140978612, -18.541998633918773, -45.69964955330209, 18.901564568532113, 12.862218840578947, -49.06279633351533, -63.146454592978245, -30.826364485679477, -45.88920458146222, 23.983514827420603, 17.431735110191863, -15.28030629725431, 13.920145309127383, 26.010066801210108, 31.008655534113966, -19.50532203398825, -36.84671712470389, 19.232405245145074, 19.564837256653504, 16.28235978725548, 14.427301277195223, -55.07367674367855, -47.17682006858992, 47.4539839274547, 40.769116199507735, 25.90338950375036, 28.28900556210426, 8.432463138060115, 5.433221355461903, 25.279215324802454, -14.031294918070373, 18.218252711436534, 14.033579277579696, 12.531119047275267, 7.488783924163528, 3.7059248173747044, 1.504700868914675, 3.1384910241887845, 0.5001166548847262, -30.556567051284432, -27.024753573378632, -17.317195113726704, -26.777103948161447, -2.72831567770983, 22.516072826678297, -29.128323874380037, -34.31174713835635, -29.21223504912212, -32.838448112666136, 18.717671683624317, 35.478128286496684, -42.08872592739213, -49.530176378405336, 28.141949058768404, 8.40763365214747, 30.655602858096916, 28.49824223082275, 27.94649580869598, 23.288268075196935, -49.44618369509697, -26.722817632413722, 36.741348232270454, 37.85754599717047, 26.07915770949397, 23.47780304237412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4349420040277472, "mean_inference_ms": 1.146232799356152, "mean_action_processing_ms": 0.18646501941180318, "mean_env_wait_ms": 0.07550115643095165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047490596771240234, "StateBufferConnector_ms": 0.003008604049682617, "ViewRequirementAgentConnector_ms": 0.08126366138458252}, "num_episodes": 16, "episode_return_max": 44.111550063481225, "episode_return_min": -56.10462546324677, "episode_return_mean": -3.6017184919628136}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.4684869210927, "num_env_steps_trained_throughput_per_sec": 446.4684869210927, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 8782.687, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8782.649, "sample_time_ms": 895.857, "learn_time_ms": 7872.105, "learn_throughput": 508.123, "synch_weights_time_ms": 14.2}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 32, "trial_id": "83a5c_00000", "date": "2024-08-10_12-18-24", "timestamp": 1723306704, "time_this_iter_s": 8.964693069458008, "time_total_s": 268.30807638168335, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f636a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 268.30807638168335, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 32.330769230769235, "ram_util_percent": 81.92307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.119091908420835, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.409341716261768, "policy_loss": -0.005965068524890633, "vf_loss": 5.413863865534465, "vf_explained_var": -0.13056680030292936, "kl": 0.017101305802245136, "entropy": 1.549660125926689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3749070934951306, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.885053336620331, "policy_loss": -0.0076282209765243655, "vf_loss": 4.890948578466972, "vf_explained_var": 0.32068443273504577, "kl": 0.015404104935086085, "entropy": 0.8236941845466693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "env_runners": {"episode_reward_max": 44.111550063481225, "episode_reward_min": -56.10462546324677, "episode_reward_mean": -3.2650066409946863, "episode_len_mean": 298.72, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 29872, "policy_reward_min": {"agent_policy": -44.11155006348118, "adversary_policy": -63.146454592978245}, "policy_reward_max": {"agent_policy": 56.10462546324678, "adversary_policy": 48.441604760962036}, "policy_reward_mean": {"agent_policy": 3.2650066409946863, "adversary_policy": -3.2650066409946867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.649113131657776, -17.521722969031, 4.3071703140429936, 9.19927530487533, -24.02810538078105, -7.260228536054651, -37.82008966315196, -20.90390725321028, -14.699711759250029, 0.1342408660639851, -14.713026647426943, -0.20238159918407916, -23.21794783290831, -22.756011526133467, -16.35035380328967, -19.344296241800954, -18.586665189888087, -19.367660483070946, 10.350561547758073, -9.949737479483284, -15.455243806145857, -17.319368019595245, 1.1230569174698797, 41.93926355606551, -18.40433110989635, 3.5387834731997474, 11.807337461039829, 9.000989400028223, 7.679492762986999, 22.874924639030386, -48.19454946777389, 18.68230933367071, -34.9603929734427, 16.039217384785246, 7.292455614895459, 21.27573980438308, 32.51512509516848, -51.384858529330806, -32.716146233942375, -44.55415168189967, -32.03060065269456, 21.17147297940132, 25.86527643074837, 23.107338288120594, -51.53203790380037, 3.4551375530697905, 17.757196227109265, 32.2940010508359, 16.671513966956205, 21.16204015936055, -32.12082409361043, 15.881891704555539, -56.10462546324677, -38.357784533570836, 20.707624968806236, -0.6800804940634633, 28.509361167662032, -28.17601957934607, 19.398621250899293, 15.354830532225352, -51.12524840613426, 44.111550063481225, 27.09619753292729, 6.932842246761007, 5.6239602033660345, 16.12591599450812, 10.0099514857194, 2.6053128431446986, 1.819303839536756, -28.790660312331532, -22.047149530944075, 9.893878574484232, -31.72003550636819, -31.02534158089413, 27.097899985060497, -45.80945115289876, 18.274791355457918, 29.576922544459848, 25.617381941946455, -38.08450066375535, 37.29944711472042, 24.77848037593406, -32.43473853089025, 32.49037852018902, -49.91632187456419, 30.443663039896226, 21.99026510578, 19.829337428685765, -46.857297069978145, 23.066350745251047, -45.99677869908623, 24.693279255038345, 14.717331483904095, 5.187725210953799, -51.53148741076947, 25.40284484102589, -41.41292277835881, -36.24931174142109, 17.96610840037291, 15.115185309788348], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 103, 400, 266, 400, 400, 400, 233, 400, 400, 400, 400, 187, 400, 400, 400, 400, 400, 400, 125, 167, 163, 400, 17, 280, 203, 400, 129, 400, 262, 400, 400, 181, 62, 198, 400, 170, 127, 400, 248, 240, 106, 63, 140, 113, 159, 129, 400, 400, 83, 400, 400, 100, 400, 175, 163, 339, 400, 213, 209, 400, 121, 400, 220, 174, 221, 400, 106, 400, 94, 241, 10, 400, 170, 400, 400, 251, 111], "policy_agent_policy_reward": [1.6491131316577743, 17.521722969030996, -4.307170314042992, -9.199275304875332, 24.028105380781042, 7.260228536054651, 37.82008966315194, 20.903907253210285, 14.699711759250025, -0.13424086606398422, 14.713026647426942, 0.20238159918407916, 23.21794783290831, 22.756011526133467, 16.35035380328968, 19.34429624180095, 18.586665189888112, 19.367660483070946, -10.35056154775807, 9.949737479483284, 15.455243806145845, 17.31936801959525, -1.123056917469878, -41.93926355606554, 18.404331109896354, -3.538783473199754, -11.807337461039834, -9.000989400028214, -7.679492762987003, -22.874924639030375, 48.19454946777388, -18.68230933367073, 34.96039297344271, -16.039217384785246, -7.2924556148954665, -21.27573980438307, -32.5151250951685, 51.38485852933083, 32.71614623394238, 44.554151681899675, 32.03060065269456, -21.17147297940133, -25.865276430748366, -23.10733828812059, 51.53203790380038, -3.4551375530697905, -17.75719622710929, -32.29400105083593, -16.671513966956205, -21.162040159360547, 32.12082409361043, -15.881891704555528, 56.10462546324678, 38.35778453357084, -20.707624968806225, 0.6800804940634624, -28.50936116766204, 28.17601957934607, -19.398621250899286, -15.354830532225357, 51.12524840613427, -44.11155006348118, -27.096197532927334, -6.932842246761009, -5.6239602033660345, -16.125915994508112, -10.009951485719393, -2.6053128431446924, -1.8193038395367584, 28.790660312331532, 22.047149530944075, -9.893878574484233, 31.72003550636819, 31.02534158089413, -27.0978999850605, 45.80945115289875, -18.274791355457932, -29.57692254445982, -25.617381941946466, 38.08450066375536, -37.299447114720444, -24.77848037593403, 32.43473853089025, -32.490378520189026, 49.91632187456418, -30.443663039896226, -21.99026510577999, -19.829337428685765, 46.85729706997815, -23.066350745251036, 45.996778699086235, -24.693279255038348, -14.717331483904122, -5.187725210953799, 51.53148741076948, -25.40284484102589, 41.412922778358805, 36.24931174142111, -17.966108400372903, -15.115185309788359], "policy_adversary_policy_reward": [-6.559570206749623, 3.2613439434340705, -24.93676987554196, -10.106676062520016, 26.352600292034303, -17.738259663948316, 8.458237263730869, 9.940313346019796, -25.25628985107246, -22.799920910489636, -27.523705671195387, 13.003248599086085, -38.937374115150526, -36.702805211153574, -3.3413579245800236, -38.466456581840525, -13.480523385759694, -15.918900132740358, -14.202323367932763, 14.47080510006073, -37.5927156119085, 8.166662317054616, 1.7443947277856537, -2.149157926153812, -26.36586802377937, -20.070027642037246, -19.626282153335723, -25.885740898931214, -18.627664976744622, -14.073042629834706, 2.8496302389222947, -41.5382227225242, -40.887604673080126, 3.7142742933038733, -4.879713395417575, -33.85560757072432, 7.562177429968244, 13.13894566554793, 5.595942877595284, -25.49541783656185, -25.203261196247382, -5.707226416044318, -7.875840547110371, -26.76289549208019, 10.817289476051986, -8.571175641112195, 48.441604760962036, 35.43692235116902, -10.13150678375387, -26.67715543603883, -1.566783819996318, 8.64435076639581, 13.507852061978424, 10.10682286010122, 7.173740354733509, 10.828238445322913, 8.395071418619297, 6.963914107354697, 27.336584669555002, 18.413264608505777, -40.97649181156209, -55.41260712398561, 23.62186077734294, 13.742757889998503, -43.717582557537945, -26.20320338934752, 23.991730182269038, 8.086704587301444, 36.42530606559988, -21.840394835808965, 11.70463501211167, 30.8468445966545, 33.15668886583209, 31.87356132450489, -48.902459153284305, -53.867257905377336, -33.19309584538235, -32.239196622502405, -59.2382306800285, -29.87007268377088, -35.73876700443195, -28.32243430095717, 9.198495082622491, 33.14445087618016, 26.713708587517925, 25.01684427397882, 13.985763828914516, 32.228912747326646, -50.6669572593179, -52.39711854828284, 8.50320202975385, -1.5929269236142716, -0.1439948323853697, 35.658387286603926, 45.43251362491974, 19.155488476752122, 20.882658247601714, 12.460369686310743, 9.376798908934976, 32.94728140978612, -18.541998633918773, -45.69964955330209, 18.901564568532113, 12.862218840578947, -49.06279633351533, -63.146454592978245, -30.826364485679477, -45.88920458146222, 23.983514827420603, 17.431735110191863, -15.28030629725431, 13.920145309127383, 26.010066801210108, 31.008655534113966, -19.50532203398825, -36.84671712470389, 19.232405245145074, 19.564837256653504, 16.28235978725548, 14.427301277195223, -55.07367674367855, -47.17682006858992, 47.4539839274547, 40.769116199507735, 25.90338950375036, 28.28900556210426, 8.432463138060115, 5.433221355461903, 25.279215324802454, -14.031294918070373, 18.218252711436534, 14.033579277579696, 12.531119047275267, 7.488783924163528, 3.7059248173747044, 1.504700868914675, 3.1384910241887845, 0.5001166548847262, -30.556567051284432, -27.024753573378632, -17.317195113726704, -26.777103948161447, -2.72831567770983, 22.516072826678297, -29.128323874380037, -34.31174713835635, -29.21223504912212, -32.838448112666136, 18.717671683624317, 35.478128286496684, -42.08872592739213, -49.530176378405336, 28.141949058768404, 8.40763365214747, 30.655602858096916, 28.49824223082275, 27.94649580869598, 23.288268075196935, -49.44618369509697, -26.722817632413722, 36.741348232270454, 37.85754599717047, 26.07915770949397, 23.47780304237412, -18.392873627340308, -46.4766034344402, 31.567029470511876, 33.41372756986613, -42.07268789852222, -57.75995585060616, 30.388278372834197, 30.499047706958233, 9.710482115692898, 34.27004809586708, 23.761786345961234, 15.8968885114103, -39.32359407690996, -54.39100006304632, 18.302084075531052, 27.830617414971027, -38.362712057307284, -53.63084534086522, 13.995234376994624, 35.39132413308208, 6.282368579709755, 23.15229438809849, 0.7383126083780382, 9.63713781352956, -46.23901248531765, -56.823962336221264, 26.661932393564392, 24.143757288487397, -57.043323451291634, -25.78252210542602, -23.45244274407301, -49.04618073876923, 32.477629205441666, 3.4545875953041367, 23.625970471329687, 6.604400148247037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4363954304747374, "mean_inference_ms": 1.1511095543898062, "mean_action_processing_ms": 0.18730924017577696, "mean_env_wait_ms": 0.07584271110848391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00478363037109375, "StateBufferConnector_ms": 0.003014087677001953, "ViewRequirementAgentConnector_ms": 0.0821382999420166}, "num_episodes": 18, "episode_return_max": 44.111550063481225, "episode_return_min": -56.10462546324677, "episode_return_mean": -3.2650066409946863}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.5885122415557, "num_env_steps_trained_throughput_per_sec": 297.5885122415557, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 9311.468, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9311.428, "sample_time_ms": 894.729, "learn_time_ms": 8399.887, "learn_throughput": 476.197, "synch_weights_time_ms": 16.129}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "training_iteration": 33, "trial_id": "83a5c_00000", "date": "2024-08-10_12-18-37", "timestamp": 1723306717, "time_this_iter_s": 13.494322061538696, "time_total_s": 281.80239844322205, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f636c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 281.80239844322205, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 53.252941176470586, "ram_util_percent": 83.04705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1467673924864914, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.628233957416797, "policy_loss": -0.0048531161581791896, "vf_loss": 4.63205796158503, "vf_explained_var": -0.458425884618961, "kl": 0.012196850371331041, "entropy": 1.5529799800701243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.25821317533652, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.297644275675217, "policy_loss": -0.0044237161263784705, "vf_loss": 4.3006410469611485, "vf_explained_var": 0.24955707074453434, "kl": 0.012683871017886098, "entropy": 0.8119284458458423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 44.111550063481225, "episode_reward_min": -56.10462546324677, "episode_reward_mean": -3.31386626185197, "episode_len_mean": 298.72, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 29872, "policy_reward_min": {"agent_policy": -44.11155006348118, "adversary_policy": -63.146454592978245}, "policy_reward_max": {"agent_policy": 56.10462546324678, "adversary_policy": 48.441604760962036}, "policy_reward_mean": {"agent_policy": 3.3138662618519703, "adversary_policy": -3.3138662618519716}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.1342408660639851, -14.713026647426943, -0.20238159918407916, -23.21794783290831, -22.756011526133467, -16.35035380328967, -19.344296241800954, -18.586665189888087, -19.367660483070946, 10.350561547758073, -9.949737479483284, -15.455243806145857, -17.319368019595245, 1.1230569174698797, 41.93926355606551, -18.40433110989635, 3.5387834731997474, 11.807337461039829, 9.000989400028223, 7.679492762986999, 22.874924639030386, -48.19454946777389, 18.68230933367071, -34.9603929734427, 16.039217384785246, 7.292455614895459, 21.27573980438308, 32.51512509516848, -51.384858529330806, -32.716146233942375, -44.55415168189967, -32.03060065269456, 21.17147297940132, 25.86527643074837, 23.107338288120594, -51.53203790380037, 3.4551375530697905, 17.757196227109265, 32.2940010508359, 16.671513966956205, 21.16204015936055, -32.12082409361043, 15.881891704555539, -56.10462546324677, -38.357784533570836, 20.707624968806236, -0.6800804940634633, 28.509361167662032, -28.17601957934607, 19.398621250899293, 15.354830532225352, -51.12524840613426, 44.111550063481225, 27.09619753292729, 6.932842246761007, 5.6239602033660345, 16.12591599450812, 10.0099514857194, 2.6053128431446986, 1.819303839536756, -28.790660312331532, -22.047149530944075, 9.893878574484232, -31.72003550636819, -31.02534158089413, 27.097899985060497, -45.80945115289876, 18.274791355457918, 29.576922544459848, 25.617381941946455, -38.08450066375535, 37.29944711472042, 24.77848037593406, -32.43473853089025, 32.49037852018902, -49.91632187456419, 30.443663039896226, 21.99026510578, 19.829337428685765, -46.857297069978145, 23.066350745251047, -45.99677869908623, 24.693279255038345, 14.717331483904095, 5.187725210953799, -51.53148741076947, 25.40284484102589, -41.41292277835881, -36.24931174142109, 17.96610840037291, 15.115185309788348, -48.1881291939375, 26.332834482188886, -52.68356814141108, 10.177525975808798, -23.947318657665647, -27.808939249370994, 23.77805861761878, 18.40318806579616, -41.326047058974225], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 103, 400, 266, 400, 400, 400, 233, 400, 400, 400, 400, 187, 400, 400, 400, 400, 400, 400, 125, 167, 163, 400, 17, 280, 203, 400, 129, 400, 262, 400, 400, 181, 62, 198, 400, 170, 127, 400, 248, 240, 106, 63, 140, 113, 159, 129, 400, 400, 83, 400, 400, 100, 400, 175, 163, 339, 400, 213, 209, 400, 121, 400, 220, 174, 221, 400, 106, 400, 94, 241, 10, 400, 170, 400, 400, 251, 111, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-0.13424086606398422, 14.713026647426942, 0.20238159918407916, 23.21794783290831, 22.756011526133467, 16.35035380328968, 19.34429624180095, 18.586665189888112, 19.367660483070946, -10.35056154775807, 9.949737479483284, 15.455243806145845, 17.31936801959525, -1.123056917469878, -41.93926355606554, 18.404331109896354, -3.538783473199754, -11.807337461039834, -9.000989400028214, -7.679492762987003, -22.874924639030375, 48.19454946777388, -18.68230933367073, 34.96039297344271, -16.039217384785246, -7.2924556148954665, -21.27573980438307, -32.5151250951685, 51.38485852933083, 32.71614623394238, 44.554151681899675, 32.03060065269456, -21.17147297940133, -25.865276430748366, -23.10733828812059, 51.53203790380038, -3.4551375530697905, -17.75719622710929, -32.29400105083593, -16.671513966956205, -21.162040159360547, 32.12082409361043, -15.881891704555528, 56.10462546324678, 38.35778453357084, -20.707624968806225, 0.6800804940634624, -28.50936116766204, 28.17601957934607, -19.398621250899286, -15.354830532225357, 51.12524840613427, -44.11155006348118, -27.096197532927334, -6.932842246761009, -5.6239602033660345, -16.125915994508112, -10.009951485719393, -2.6053128431446924, -1.8193038395367584, 28.790660312331532, 22.047149530944075, -9.893878574484233, 31.72003550636819, 31.02534158089413, -27.0978999850605, 45.80945115289875, -18.274791355457932, -29.57692254445982, -25.617381941946466, 38.08450066375536, -37.299447114720444, -24.77848037593403, 32.43473853089025, -32.490378520189026, 49.91632187456418, -30.443663039896226, -21.99026510577999, -19.829337428685765, 46.85729706997815, -23.066350745251036, 45.996778699086235, -24.693279255038348, -14.717331483904122, -5.187725210953799, 51.53148741076948, -25.40284484102589, 41.412922778358805, 36.24931174142111, -17.966108400372903, -15.115185309788359, 48.188129193937506, -26.33283448218887, 52.68356814141107, -10.177525975808788, 23.947318657665647, 27.808939249370994, -23.778058617618758, -18.403188065796165, 41.326047058974204], "policy_adversary_policy_reward": [-14.202323367932763, 14.47080510006073, -37.5927156119085, 8.166662317054616, 1.7443947277856537, -2.149157926153812, -26.36586802377937, -20.070027642037246, -19.626282153335723, -25.885740898931214, -18.627664976744622, -14.073042629834706, 2.8496302389222947, -41.5382227225242, -40.887604673080126, 3.7142742933038733, -4.879713395417575, -33.85560757072432, 7.562177429968244, 13.13894566554793, 5.595942877595284, -25.49541783656185, -25.203261196247382, -5.707226416044318, -7.875840547110371, -26.76289549208019, 10.817289476051986, -8.571175641112195, 48.441604760962036, 35.43692235116902, -10.13150678375387, -26.67715543603883, -1.566783819996318, 8.64435076639581, 13.507852061978424, 10.10682286010122, 7.173740354733509, 10.828238445322913, 8.395071418619297, 6.963914107354697, 27.336584669555002, 18.413264608505777, -40.97649181156209, -55.41260712398561, 23.62186077734294, 13.742757889998503, -43.717582557537945, -26.20320338934752, 23.991730182269038, 8.086704587301444, 36.42530606559988, -21.840394835808965, 11.70463501211167, 30.8468445966545, 33.15668886583209, 31.87356132450489, -48.902459153284305, -53.867257905377336, -33.19309584538235, -32.239196622502405, -59.2382306800285, -29.87007268377088, -35.73876700443195, -28.32243430095717, 9.198495082622491, 33.14445087618016, 26.713708587517925, 25.01684427397882, 13.985763828914516, 32.228912747326646, -50.6669572593179, -52.39711854828284, 8.50320202975385, -1.5929269236142716, -0.1439948323853697, 35.658387286603926, 45.43251362491974, 19.155488476752122, 20.882658247601714, 12.460369686310743, 9.376798908934976, 32.94728140978612, -18.541998633918773, -45.69964955330209, 18.901564568532113, 12.862218840578947, -49.06279633351533, -63.146454592978245, -30.826364485679477, -45.88920458146222, 23.983514827420603, 17.431735110191863, -15.28030629725431, 13.920145309127383, 26.010066801210108, 31.008655534113966, -19.50532203398825, -36.84671712470389, 19.232405245145074, 19.564837256653504, 16.28235978725548, 14.427301277195223, -55.07367674367855, -47.17682006858992, 47.4539839274547, 40.769116199507735, 25.90338950375036, 28.28900556210426, 8.432463138060115, 5.433221355461903, 25.279215324802454, -14.031294918070373, 18.218252711436534, 14.033579277579696, 12.531119047275267, 7.488783924163528, 3.7059248173747044, 1.504700868914675, 3.1384910241887845, 0.5001166548847262, -30.556567051284432, -27.024753573378632, -17.317195113726704, -26.777103948161447, -2.72831567770983, 22.516072826678297, -29.128323874380037, -34.31174713835635, -29.21223504912212, -32.838448112666136, 18.717671683624317, 35.478128286496684, -42.08872592739213, -49.530176378405336, 28.141949058768404, 8.40763365214747, 30.655602858096916, 28.49824223082275, 27.94649580869598, 23.288268075196935, -49.44618369509697, -26.722817632413722, 36.741348232270454, 37.85754599717047, 26.07915770949397, 23.47780304237412, -18.392873627340308, -46.4766034344402, 31.567029470511876, 33.41372756986613, -42.07268789852222, -57.75995585060616, 30.388278372834197, 30.499047706958233, 9.710482115692898, 34.27004809586708, 23.761786345961234, 15.8968885114103, -39.32359407690996, -54.39100006304632, 18.302084075531052, 27.830617414971027, -38.362712057307284, -53.63084534086522, 13.995234376994624, 35.39132413308208, 6.282368579709755, 23.15229438809849, 0.7383126083780382, 9.63713781352956, -46.23901248531765, -56.823962336221264, 26.661932393564392, 24.143757288487397, -57.043323451291634, -25.78252210542602, -23.45244274407301, -49.04618073876923, 32.477629205441666, 3.4545875953041367, 23.625970471329687, 6.604400148247037, -46.656352880252214, -49.71990550762289, 25.527358370341023, 27.138310594036714, -44.907911666813554, -60.4592246160087, 15.571997278845457, 4.783054672772142, -28.885675562095777, -19.008961753235518, -29.666571762913826, -25.951306735828155, 29.356095009244264, 18.200022225993273, 15.018856293605637, 21.7875198379867, -45.75509015799496, -36.897003959953516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4377253468836092, "mean_inference_ms": 1.156058777755151, "mean_action_processing_ms": 0.18805332441822173, "mean_env_wait_ms": 0.07620191641407592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005051136016845703, "StateBufferConnector_ms": 0.0030442476272583008, "ViewRequirementAgentConnector_ms": 0.08212828636169434}, "num_episodes": 9, "episode_return_max": 44.111550063481225, "episode_return_min": -56.10462546324677, "episode_return_mean": -3.31386626185197}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 411.98124354115924, "num_env_steps_trained_throughput_per_sec": 411.98124354115924, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 9476.198, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9476.144, "sample_time_ms": 977.247, "learn_time_ms": 8482.129, "learn_throughput": 471.58, "synch_weights_time_ms": 16.078}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 34, "trial_id": "83a5c_00000", "date": "2024-08-10_12-18-47", "timestamp": 1723306727, "time_this_iter_s": 9.715210914611816, "time_total_s": 291.51760935783386, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5c90d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 291.51760935783386, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 37.92857142857143, "ram_util_percent": 82.10714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.082877625122903, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.671365145779161, "policy_loss": -0.011288369416811123, "vf_loss": 4.6810157683791305, "vf_explained_var": -0.7470781602556743, "kl": 0.019410313205319593, "entropy": 1.5764368790798087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.513363560475409, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.285359308371941, "policy_loss": -0.0025635071911286407, "vf_loss": 4.287431132793427, "vf_explained_var": 0.22566161397844553, "kl": 0.004370471192132104, "entropy": 0.8571027239163717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "env_runners": {"episode_reward_max": 44.111550063481225, "episode_reward_min": -56.10462546324677, "episode_reward_mean": -2.7889439768325968, "episode_len_mean": 298.72, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 29872, "policy_reward_min": {"agent_policy": -44.11155006348118, "adversary_policy": -63.146454592978245}, "policy_reward_max": {"agent_policy": 56.10462546324678, "adversary_policy": 48.441604760962036}, "policy_reward_mean": {"agent_policy": 2.7889439768325963, "adversary_policy": -2.7889439768325985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.350561547758073, -9.949737479483284, -15.455243806145857, -17.319368019595245, 1.1230569174698797, 41.93926355606551, -18.40433110989635, 3.5387834731997474, 11.807337461039829, 9.000989400028223, 7.679492762986999, 22.874924639030386, -48.19454946777389, 18.68230933367071, -34.9603929734427, 16.039217384785246, 7.292455614895459, 21.27573980438308, 32.51512509516848, -51.384858529330806, -32.716146233942375, -44.55415168189967, -32.03060065269456, 21.17147297940132, 25.86527643074837, 23.107338288120594, -51.53203790380037, 3.4551375530697905, 17.757196227109265, 32.2940010508359, 16.671513966956205, 21.16204015936055, -32.12082409361043, 15.881891704555539, -56.10462546324677, -38.357784533570836, 20.707624968806236, -0.6800804940634633, 28.509361167662032, -28.17601957934607, 19.398621250899293, 15.354830532225352, -51.12524840613426, 44.111550063481225, 27.09619753292729, 6.932842246761007, 5.6239602033660345, 16.12591599450812, 10.0099514857194, 2.6053128431446986, 1.819303839536756, -28.790660312331532, -22.047149530944075, 9.893878574484232, -31.72003550636819, -31.02534158089413, 27.097899985060497, -45.80945115289876, 18.274791355457918, 29.576922544459848, 25.617381941946455, -38.08450066375535, 37.29944711472042, 24.77848037593406, -32.43473853089025, 32.49037852018902, -49.91632187456419, 30.443663039896226, 21.99026510578, 19.829337428685765, -46.857297069978145, 23.066350745251047, -45.99677869908623, 24.693279255038345, 14.717331483904095, 5.187725210953799, -51.53148741076947, 25.40284484102589, -41.41292277835881, -36.24931174142109, 17.96610840037291, 15.115185309788348, -48.1881291939375, 26.332834482188886, -52.68356814141108, 10.177525975808798, -23.947318657665647, -27.808939249370994, 23.77805861761878, 18.40318806579616, -41.326047058974225, -33.70375810176629, -38.68482736720319, -33.52537900855635, 19.938711457332037, -28.072139390640153, -44.38796667952856, 38.13736765724169, 28.634876278459192, 9.751241198960443], "episode_lengths": [400, 400, 400, 400, 400, 103, 400, 266, 400, 400, 400, 233, 400, 400, 400, 400, 187, 400, 400, 400, 400, 400, 400, 125, 167, 163, 400, 17, 280, 203, 400, 129, 400, 262, 400, 400, 181, 62, 198, 400, 170, 127, 400, 248, 240, 106, 63, 140, 113, 159, 129, 400, 400, 83, 400, 400, 100, 400, 175, 163, 339, 400, 213, 209, 400, 121, 400, 220, 174, 221, 400, 106, 400, 94, 241, 10, 400, 170, 400, 400, 251, 111, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-10.35056154775807, 9.949737479483284, 15.455243806145845, 17.31936801959525, -1.123056917469878, -41.93926355606554, 18.404331109896354, -3.538783473199754, -11.807337461039834, -9.000989400028214, -7.679492762987003, -22.874924639030375, 48.19454946777388, -18.68230933367073, 34.96039297344271, -16.039217384785246, -7.2924556148954665, -21.27573980438307, -32.5151250951685, 51.38485852933083, 32.71614623394238, 44.554151681899675, 32.03060065269456, -21.17147297940133, -25.865276430748366, -23.10733828812059, 51.53203790380038, -3.4551375530697905, -17.75719622710929, -32.29400105083593, -16.671513966956205, -21.162040159360547, 32.12082409361043, -15.881891704555528, 56.10462546324678, 38.35778453357084, -20.707624968806225, 0.6800804940634624, -28.50936116766204, 28.17601957934607, -19.398621250899286, -15.354830532225357, 51.12524840613427, -44.11155006348118, -27.096197532927334, -6.932842246761009, -5.6239602033660345, -16.125915994508112, -10.009951485719393, -2.6053128431446924, -1.8193038395367584, 28.790660312331532, 22.047149530944075, -9.893878574484233, 31.72003550636819, 31.02534158089413, -27.0978999850605, 45.80945115289875, -18.274791355457932, -29.57692254445982, -25.617381941946466, 38.08450066375536, -37.299447114720444, -24.77848037593403, 32.43473853089025, -32.490378520189026, 49.91632187456418, -30.443663039896226, -21.99026510577999, -19.829337428685765, 46.85729706997815, -23.066350745251036, 45.996778699086235, -24.693279255038348, -14.717331483904122, -5.187725210953799, 51.53148741076948, -25.40284484102589, 41.412922778358805, 36.24931174142111, -17.966108400372903, -15.115185309788359, 48.188129193937506, -26.33283448218887, 52.68356814141107, -10.177525975808788, 23.947318657665647, 27.808939249370994, -23.778058617618758, -18.403188065796165, 41.326047058974204, 33.7037581017663, 38.6848273672032, 33.52537900855636, -19.93871145733206, 28.072139390640146, 44.38796667952857, -38.13736765724177, -28.634876278459146, -9.751241198960434], "policy_adversary_policy_reward": [7.562177429968244, 13.13894566554793, 5.595942877595284, -25.49541783656185, -25.203261196247382, -5.707226416044318, -7.875840547110371, -26.76289549208019, 10.817289476051986, -8.571175641112195, 48.441604760962036, 35.43692235116902, -10.13150678375387, -26.67715543603883, -1.566783819996318, 8.64435076639581, 13.507852061978424, 10.10682286010122, 7.173740354733509, 10.828238445322913, 8.395071418619297, 6.963914107354697, 27.336584669555002, 18.413264608505777, -40.97649181156209, -55.41260712398561, 23.62186077734294, 13.742757889998503, -43.717582557537945, -26.20320338934752, 23.991730182269038, 8.086704587301444, 36.42530606559988, -21.840394835808965, 11.70463501211167, 30.8468445966545, 33.15668886583209, 31.87356132450489, -48.902459153284305, -53.867257905377336, -33.19309584538235, -32.239196622502405, -59.2382306800285, -29.87007268377088, -35.73876700443195, -28.32243430095717, 9.198495082622491, 33.14445087618016, 26.713708587517925, 25.01684427397882, 13.985763828914516, 32.228912747326646, -50.6669572593179, -52.39711854828284, 8.50320202975385, -1.5929269236142716, -0.1439948323853697, 35.658387286603926, 45.43251362491974, 19.155488476752122, 20.882658247601714, 12.460369686310743, 9.376798908934976, 32.94728140978612, -18.541998633918773, -45.69964955330209, 18.901564568532113, 12.862218840578947, -49.06279633351533, -63.146454592978245, -30.826364485679477, -45.88920458146222, 23.983514827420603, 17.431735110191863, -15.28030629725431, 13.920145309127383, 26.010066801210108, 31.008655534113966, -19.50532203398825, -36.84671712470389, 19.232405245145074, 19.564837256653504, 16.28235978725548, 14.427301277195223, -55.07367674367855, -47.17682006858992, 47.4539839274547, 40.769116199507735, 25.90338950375036, 28.28900556210426, 8.432463138060115, 5.433221355461903, 25.279215324802454, -14.031294918070373, 18.218252711436534, 14.033579277579696, 12.531119047275267, 7.488783924163528, 3.7059248173747044, 1.504700868914675, 3.1384910241887845, 0.5001166548847262, -30.556567051284432, -27.024753573378632, -17.317195113726704, -26.777103948161447, -2.72831567770983, 22.516072826678297, -29.128323874380037, -34.31174713835635, -29.21223504912212, -32.838448112666136, 18.717671683624317, 35.478128286496684, -42.08872592739213, -49.530176378405336, 28.141949058768404, 8.40763365214747, 30.655602858096916, 28.49824223082275, 27.94649580869598, 23.288268075196935, -49.44618369509697, -26.722817632413722, 36.741348232270454, 37.85754599717047, 26.07915770949397, 23.47780304237412, -18.392873627340308, -46.4766034344402, 31.567029470511876, 33.41372756986613, -42.07268789852222, -57.75995585060616, 30.388278372834197, 30.499047706958233, 9.710482115692898, 34.27004809586708, 23.761786345961234, 15.8968885114103, -39.32359407690996, -54.39100006304632, 18.302084075531052, 27.830617414971027, -38.362712057307284, -53.63084534086522, 13.995234376994624, 35.39132413308208, 6.282368579709755, 23.15229438809849, 0.7383126083780382, 9.63713781352956, -46.23901248531765, -56.823962336221264, 26.661932393564392, 24.143757288487397, -57.043323451291634, -25.78252210542602, -23.45244274407301, -49.04618073876923, 32.477629205441666, 3.4545875953041367, 23.625970471329687, 6.604400148247037, -46.656352880252214, -49.71990550762289, 25.527358370341023, 27.138310594036714, -44.907911666813554, -60.4592246160087, 15.571997278845457, 4.783054672772142, -28.885675562095777, -19.008961753235518, -29.666571762913826, -25.951306735828155, 29.356095009244264, 18.200022225993273, 15.018856293605637, 21.7875198379867, -45.75509015799496, -36.897003959953516, -36.90734165692947, -30.500174546603105, -36.346020371282066, -41.02363436312448, -32.39828753091192, -34.65247048620076, 30.725634912194973, 9.15178800246909, -34.17311384900787, -21.97116493227243, -42.84596325537344, -45.929970103683786, 45.91719798080144, 30.35753733368205, 24.15260122541623, 33.11715133150209, 3.6279814580525445, 15.874500939868305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4390099835884853, "mean_inference_ms": 1.1603814219418742, "mean_action_processing_ms": 0.18864048781926437, "mean_env_wait_ms": 0.07651385391682285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004025101661682129, "StateBufferConnector_ms": 0.0036450624465942383, "ViewRequirementAgentConnector_ms": 0.07981157302856445}, "num_episodes": 9, "episode_return_max": 44.111550063481225, "episode_return_min": -56.10462546324677, "episode_return_mean": -2.7889439768325968}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.8644164047018, "num_env_steps_trained_throughput_per_sec": 458.8644164047018, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 9516.049, "restore_workers_time_ms": 0.012, "training_step_time_ms": 9515.993, "sample_time_ms": 988.336, "learn_time_ms": 8510.963, "learn_throughput": 469.982, "synch_weights_time_ms": 15.996}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "training_iteration": 35, "trial_id": "83a5c_00000", "date": "2024-08-10_12-18-56", "timestamp": 1723306736, "time_this_iter_s": 8.723168849945068, "time_total_s": 300.24077820777893, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f635ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 300.24077820777893, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 31.191666666666674, "ram_util_percent": 81.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.935914753732227, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.455591674078079, "policy_loss": -0.010885383342466658, "vf_loss": 6.464724813693415, "vf_explained_var": -0.7041605090338087, "kl": 0.020767292593428292, "entropy": 1.5528733179682777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3004440423411627, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.044867128382126, "policy_loss": -0.002590081349868948, "vf_loss": 5.047061385711034, "vf_explained_var": 0.1418105732028683, "kl": 0.007036840296300006, "entropy": 0.7513603759929538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 44.111550063481225, "episode_reward_min": -56.10462546324677, "episode_reward_mean": -4.264509932852194, "episode_len_mean": 303.03, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 30303, "policy_reward_min": {"agent_policy": -44.11155006348118, "adversary_policy": -63.146454592978245}, "policy_reward_max": {"agent_policy": 56.10462546324678, "adversary_policy": 47.4539839274547}, "policy_reward_mean": {"agent_policy": 4.264509932852195, "adversary_policy": -4.264509932852196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.000989400028223, 7.679492762986999, 22.874924639030386, -48.19454946777389, 18.68230933367071, -34.9603929734427, 16.039217384785246, 7.292455614895459, 21.27573980438308, 32.51512509516848, -51.384858529330806, -32.716146233942375, -44.55415168189967, -32.03060065269456, 21.17147297940132, 25.86527643074837, 23.107338288120594, -51.53203790380037, 3.4551375530697905, 17.757196227109265, 32.2940010508359, 16.671513966956205, 21.16204015936055, -32.12082409361043, 15.881891704555539, -56.10462546324677, -38.357784533570836, 20.707624968806236, -0.6800804940634633, 28.509361167662032, -28.17601957934607, 19.398621250899293, 15.354830532225352, -51.12524840613426, 44.111550063481225, 27.09619753292729, 6.932842246761007, 5.6239602033660345, 16.12591599450812, 10.0099514857194, 2.6053128431446986, 1.819303839536756, -28.790660312331532, -22.047149530944075, 9.893878574484232, -31.72003550636819, -31.02534158089413, 27.097899985060497, -45.80945115289876, 18.274791355457918, 29.576922544459848, 25.617381941946455, -38.08450066375535, 37.29944711472042, 24.77848037593406, -32.43473853089025, 32.49037852018902, -49.91632187456419, 30.443663039896226, 21.99026510578, 19.829337428685765, -46.857297069978145, 23.066350745251047, -45.99677869908623, 24.693279255038345, 14.717331483904095, 5.187725210953799, -51.53148741076947, 25.40284484102589, -41.41292277835881, -36.24931174142109, 17.96610840037291, 15.115185309788348, -48.1881291939375, 26.332834482188886, -52.68356814141108, 10.177525975808798, -23.947318657665647, -27.808939249370994, 23.77805861761878, 18.40318806579616, -41.326047058974225, -33.70375810176629, -38.68482736720319, -33.52537900855635, 19.938711457332037, -28.072139390640153, -44.38796667952856, 38.13736765724169, 28.634876278459192, 9.751241198960443, -31.60703142569748, -28.7616336830579, -1.322805831148938, -40.88703423910196, -48.44996015466337, 5.725915338942468, -29.952840035125803, 23.689987388121892, 11.639129580183642], "episode_lengths": [400, 400, 233, 400, 400, 400, 400, 187, 400, 400, 400, 400, 400, 400, 125, 167, 163, 400, 17, 280, 203, 400, 129, 400, 262, 400, 400, 181, 62, 198, 400, 170, 127, 400, 248, 240, 106, 63, 140, 113, 159, 129, 400, 400, 83, 400, 400, 100, 400, 175, 163, 339, 400, 213, 209, 400, 121, 400, 220, 174, 221, 400, 106, 400, 94, 241, 10, 400, 170, 400, 400, 251, 111, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-9.000989400028214, -7.679492762987003, -22.874924639030375, 48.19454946777388, -18.68230933367073, 34.96039297344271, -16.039217384785246, -7.2924556148954665, -21.27573980438307, -32.5151250951685, 51.38485852933083, 32.71614623394238, 44.554151681899675, 32.03060065269456, -21.17147297940133, -25.865276430748366, -23.10733828812059, 51.53203790380038, -3.4551375530697905, -17.75719622710929, -32.29400105083593, -16.671513966956205, -21.162040159360547, 32.12082409361043, -15.881891704555528, 56.10462546324678, 38.35778453357084, -20.707624968806225, 0.6800804940634624, -28.50936116766204, 28.17601957934607, -19.398621250899286, -15.354830532225357, 51.12524840613427, -44.11155006348118, -27.096197532927334, -6.932842246761009, -5.6239602033660345, -16.125915994508112, -10.009951485719393, -2.6053128431446924, -1.8193038395367584, 28.790660312331532, 22.047149530944075, -9.893878574484233, 31.72003550636819, 31.02534158089413, -27.0978999850605, 45.80945115289875, -18.274791355457932, -29.57692254445982, -25.617381941946466, 38.08450066375536, -37.299447114720444, -24.77848037593403, 32.43473853089025, -32.490378520189026, 49.91632187456418, -30.443663039896226, -21.99026510577999, -19.829337428685765, 46.85729706997815, -23.066350745251036, 45.996778699086235, -24.693279255038348, -14.717331483904122, -5.187725210953799, 51.53148741076948, -25.40284484102589, 41.412922778358805, 36.24931174142111, -17.966108400372903, -15.115185309788359, 48.188129193937506, -26.33283448218887, 52.68356814141107, -10.177525975808788, 23.947318657665647, 27.808939249370994, -23.778058617618758, -18.403188065796165, 41.326047058974204, 33.7037581017663, 38.6848273672032, 33.52537900855636, -19.93871145733206, 28.072139390640146, 44.38796667952857, -38.13736765724177, -28.634876278459146, -9.751241198960434, 31.60703142569748, 28.7616336830579, 1.3228058311489383, 40.88703423910195, 48.449960154663366, -5.725915338942477, 29.952840035125764, -23.68998738812182, -11.639129580183639], "policy_adversary_policy_reward": [7.173740354733509, 10.828238445322913, 8.395071418619297, 6.963914107354697, 27.336584669555002, 18.413264608505777, -40.97649181156209, -55.41260712398561, 23.62186077734294, 13.742757889998503, -43.717582557537945, -26.20320338934752, 23.991730182269038, 8.086704587301444, 36.42530606559988, -21.840394835808965, 11.70463501211167, 30.8468445966545, 33.15668886583209, 31.87356132450489, -48.902459153284305, -53.867257905377336, -33.19309584538235, -32.239196622502405, -59.2382306800285, -29.87007268377088, -35.73876700443195, -28.32243430095717, 9.198495082622491, 33.14445087618016, 26.713708587517925, 25.01684427397882, 13.985763828914516, 32.228912747326646, -50.6669572593179, -52.39711854828284, 8.50320202975385, -1.5929269236142716, -0.1439948323853697, 35.658387286603926, 45.43251362491974, 19.155488476752122, 20.882658247601714, 12.460369686310743, 9.376798908934976, 32.94728140978612, -18.541998633918773, -45.69964955330209, 18.901564568532113, 12.862218840578947, -49.06279633351533, -63.146454592978245, -30.826364485679477, -45.88920458146222, 23.983514827420603, 17.431735110191863, -15.28030629725431, 13.920145309127383, 26.010066801210108, 31.008655534113966, -19.50532203398825, -36.84671712470389, 19.232405245145074, 19.564837256653504, 16.28235978725548, 14.427301277195223, -55.07367674367855, -47.17682006858992, 47.4539839274547, 40.769116199507735, 25.90338950375036, 28.28900556210426, 8.432463138060115, 5.433221355461903, 25.279215324802454, -14.031294918070373, 18.218252711436534, 14.033579277579696, 12.531119047275267, 7.488783924163528, 3.7059248173747044, 1.504700868914675, 3.1384910241887845, 0.5001166548847262, -30.556567051284432, -27.024753573378632, -17.317195113726704, -26.777103948161447, -2.72831567770983, 22.516072826678297, -29.128323874380037, -34.31174713835635, -29.21223504912212, -32.838448112666136, 18.717671683624317, 35.478128286496684, -42.08872592739213, -49.530176378405336, 28.141949058768404, 8.40763365214747, 30.655602858096916, 28.49824223082275, 27.94649580869598, 23.288268075196935, -49.44618369509697, -26.722817632413722, 36.741348232270454, 37.85754599717047, 26.07915770949397, 23.47780304237412, -18.392873627340308, -46.4766034344402, 31.567029470511876, 33.41372756986613, -42.07268789852222, -57.75995585060616, 30.388278372834197, 30.499047706958233, 9.710482115692898, 34.27004809586708, 23.761786345961234, 15.8968885114103, -39.32359407690996, -54.39100006304632, 18.302084075531052, 27.830617414971027, -38.362712057307284, -53.63084534086522, 13.995234376994624, 35.39132413308208, 6.282368579709755, 23.15229438809849, 0.7383126083780382, 9.63713781352956, -46.23901248531765, -56.823962336221264, 26.661932393564392, 24.143757288487397, -57.043323451291634, -25.78252210542602, -23.45244274407301, -49.04618073876923, 32.477629205441666, 3.4545875953041367, 23.625970471329687, 6.604400148247037, -46.656352880252214, -49.71990550762289, 25.527358370341023, 27.138310594036714, -44.907911666813554, -60.4592246160087, 15.571997278845457, 4.783054672772142, -28.885675562095777, -19.008961753235518, -29.666571762913826, -25.951306735828155, 29.356095009244264, 18.200022225993273, 15.018856293605637, 21.7875198379867, -45.75509015799496, -36.897003959953516, -36.90734165692947, -30.500174546603105, -36.346020371282066, -41.02363436312448, -32.39828753091192, -34.65247048620076, 30.725634912194973, 9.15178800246909, -34.17311384900787, -21.97116493227243, -42.84596325537344, -45.929970103683786, 45.91719798080144, 30.35753733368205, 24.15260122541623, 33.11715133150209, 3.6279814580525445, 15.874500939868305, -30.492684041528356, -32.7213788098666, -35.51536812602355, -22.00789924009225, 1.5910405106810295, -4.236652172978904, -23.773181244113395, -58.00088723409048, -50.53572278496693, -46.36419752435966, 8.686997565453078, 2.7648331124318677, -32.79455151808324, -27.11112855216826, 12.013529531679573, 35.36644524456406, 11.096076248188519, 12.182182912178764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43990243564744064, "mean_inference_ms": 1.1645040064334382, "mean_action_processing_ms": 0.1891595016568063, "mean_env_wait_ms": 0.07687749477174444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038825273513793945, "StateBufferConnector_ms": 0.003500223159790039, "ViewRequirementAgentConnector_ms": 0.07783734798431396}, "num_episodes": 9, "episode_return_max": 44.111550063481225, "episode_return_min": -56.10462546324677, "episode_return_mean": -4.264509932852194}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.4827899852198, "num_env_steps_trained_throughput_per_sec": 448.4827899852198, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 9554.315, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9554.258, "sample_time_ms": 1000.416, "learn_time_ms": 8537.092, "learn_throughput": 468.544, "synch_weights_time_ms": 16.048}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 36, "trial_id": "83a5c_00000", "date": "2024-08-10_12-19-05", "timestamp": 1723306745, "time_this_iter_s": 8.925488233566284, "time_total_s": 309.1662664413452, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f636a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.1662664413452, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 32.53846153846153, "ram_util_percent": 81.8076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.004625879109852, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.535452797803929, "policy_loss": -0.004088190217901554, "vf_loss": 6.538595622178739, "vf_explained_var": -0.020345289524270112, "kl": 0.007469640432849513, "entropy": 1.5245103782446927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.405494470273455, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5994968185822165, "policy_loss": -0.006323347066063434, "vf_loss": 5.605143479009469, "vf_explained_var": 0.03836477336784204, "kl": 0.012030422009456565, "entropy": 0.8544622339308262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "env_runners": {"episode_reward_max": 44.111550063481225, "episode_reward_min": -56.10462546324677, "episode_reward_mean": -6.244869566790979, "episode_len_mean": 306.83, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 30683, "policy_reward_min": {"agent_policy": -44.11155006348118, "adversary_policy": -63.146454592978245}, "policy_reward_max": {"agent_policy": 56.10462546324678, "adversary_policy": 47.4539839274547}, "policy_reward_mean": {"agent_policy": 6.244869566790979, "adversary_policy": -6.244869566790982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.384858529330806, -32.716146233942375, -44.55415168189967, -32.03060065269456, 21.17147297940132, 25.86527643074837, 23.107338288120594, -51.53203790380037, 3.4551375530697905, 17.757196227109265, 32.2940010508359, 16.671513966956205, 21.16204015936055, -32.12082409361043, 15.881891704555539, -56.10462546324677, -38.357784533570836, 20.707624968806236, -0.6800804940634633, 28.509361167662032, -28.17601957934607, 19.398621250899293, 15.354830532225352, -51.12524840613426, 44.111550063481225, 27.09619753292729, 6.932842246761007, 5.6239602033660345, 16.12591599450812, 10.0099514857194, 2.6053128431446986, 1.819303839536756, -28.790660312331532, -22.047149530944075, 9.893878574484232, -31.72003550636819, -31.02534158089413, 27.097899985060497, -45.80945115289876, 18.274791355457918, 29.576922544459848, 25.617381941946455, -38.08450066375535, 37.29944711472042, 24.77848037593406, -32.43473853089025, 32.49037852018902, -49.91632187456419, 30.443663039896226, 21.99026510578, 19.829337428685765, -46.857297069978145, 23.066350745251047, -45.99677869908623, 24.693279255038345, 14.717331483904095, 5.187725210953799, -51.53148741076947, 25.40284484102589, -41.41292277835881, -36.24931174142109, 17.96610840037291, 15.115185309788348, -48.1881291939375, 26.332834482188886, -52.68356814141108, 10.177525975808798, -23.947318657665647, -27.808939249370994, 23.77805861761878, 18.40318806579616, -41.326047058974225, -33.70375810176629, -38.68482736720319, -33.52537900855635, 19.938711457332037, -28.072139390640153, -44.38796667952856, 38.13736765724169, 28.634876278459192, 9.751241198960443, -31.60703142569748, -28.7616336830579, -1.322805831148938, -40.88703423910196, -48.44996015466337, 5.725915338942468, -29.952840035125803, 23.689987388121892, 11.639129580183642, -2.304513394207733, -46.81073481297438, -40.08768864724514, -8.896538713035357, -16.57258537161975, -19.58534741526314, 7.848175151536806, -3.851465597778583, -20.851839889450257, 5.281886889890966], "episode_lengths": [400, 400, 400, 400, 125, 167, 163, 400, 17, 280, 203, 400, 129, 400, 262, 400, 400, 181, 62, 198, 400, 170, 127, 400, 248, 240, 106, 63, 140, 113, 159, 129, 400, 400, 83, 400, 400, 100, 400, 175, 163, 339, 400, 213, 209, 400, 121, 400, 220, 174, 221, 400, 106, 400, 94, 241, 10, 400, 170, 400, 400, 251, 111, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [51.38485852933083, 32.71614623394238, 44.554151681899675, 32.03060065269456, -21.17147297940133, -25.865276430748366, -23.10733828812059, 51.53203790380038, -3.4551375530697905, -17.75719622710929, -32.29400105083593, -16.671513966956205, -21.162040159360547, 32.12082409361043, -15.881891704555528, 56.10462546324678, 38.35778453357084, -20.707624968806225, 0.6800804940634624, -28.50936116766204, 28.17601957934607, -19.398621250899286, -15.354830532225357, 51.12524840613427, -44.11155006348118, -27.096197532927334, -6.932842246761009, -5.6239602033660345, -16.125915994508112, -10.009951485719393, -2.6053128431446924, -1.8193038395367584, 28.790660312331532, 22.047149530944075, -9.893878574484233, 31.72003550636819, 31.02534158089413, -27.0978999850605, 45.80945115289875, -18.274791355457932, -29.57692254445982, -25.617381941946466, 38.08450066375536, -37.299447114720444, -24.77848037593403, 32.43473853089025, -32.490378520189026, 49.91632187456418, -30.443663039896226, -21.99026510577999, -19.829337428685765, 46.85729706997815, -23.066350745251036, 45.996778699086235, -24.693279255038348, -14.717331483904122, -5.187725210953799, 51.53148741076948, -25.40284484102589, 41.412922778358805, 36.24931174142111, -17.966108400372903, -15.115185309788359, 48.188129193937506, -26.33283448218887, 52.68356814141107, -10.177525975808788, 23.947318657665647, 27.808939249370994, -23.778058617618758, -18.403188065796165, 41.326047058974204, 33.7037581017663, 38.6848273672032, 33.52537900855636, -19.93871145733206, 28.072139390640146, 44.38796667952857, -38.13736765724177, -28.634876278459146, -9.751241198960434, 31.60703142569748, 28.7616336830579, 1.3228058311489383, 40.88703423910195, 48.449960154663366, -5.725915338942477, 29.952840035125764, -23.68998738812182, -11.639129580183639, 2.304513394207728, 46.810734812974374, 40.08768864724513, 8.896538713035353, 16.57258537161975, 19.58534741526314, -7.8481751515368, 3.851465597778583, 20.851839889450265, -5.281886889890966], "policy_adversary_policy_reward": [-48.902459153284305, -53.867257905377336, -33.19309584538235, -32.239196622502405, -59.2382306800285, -29.87007268377088, -35.73876700443195, -28.32243430095717, 9.198495082622491, 33.14445087618016, 26.713708587517925, 25.01684427397882, 13.985763828914516, 32.228912747326646, -50.6669572593179, -52.39711854828284, 8.50320202975385, -1.5929269236142716, -0.1439948323853697, 35.658387286603926, 45.43251362491974, 19.155488476752122, 20.882658247601714, 12.460369686310743, 9.376798908934976, 32.94728140978612, -18.541998633918773, -45.69964955330209, 18.901564568532113, 12.862218840578947, -49.06279633351533, -63.146454592978245, -30.826364485679477, -45.88920458146222, 23.983514827420603, 17.431735110191863, -15.28030629725431, 13.920145309127383, 26.010066801210108, 31.008655534113966, -19.50532203398825, -36.84671712470389, 19.232405245145074, 19.564837256653504, 16.28235978725548, 14.427301277195223, -55.07367674367855, -47.17682006858992, 47.4539839274547, 40.769116199507735, 25.90338950375036, 28.28900556210426, 8.432463138060115, 5.433221355461903, 25.279215324802454, -14.031294918070373, 18.218252711436534, 14.033579277579696, 12.531119047275267, 7.488783924163528, 3.7059248173747044, 1.504700868914675, 3.1384910241887845, 0.5001166548847262, -30.556567051284432, -27.024753573378632, -17.317195113726704, -26.777103948161447, -2.72831567770983, 22.516072826678297, -29.128323874380037, -34.31174713835635, -29.21223504912212, -32.838448112666136, 18.717671683624317, 35.478128286496684, -42.08872592739213, -49.530176378405336, 28.141949058768404, 8.40763365214747, 30.655602858096916, 28.49824223082275, 27.94649580869598, 23.288268075196935, -49.44618369509697, -26.722817632413722, 36.741348232270454, 37.85754599717047, 26.07915770949397, 23.47780304237412, -18.392873627340308, -46.4766034344402, 31.567029470511876, 33.41372756986613, -42.07268789852222, -57.75995585060616, 30.388278372834197, 30.499047706958233, 9.710482115692898, 34.27004809586708, 23.761786345961234, 15.8968885114103, -39.32359407690996, -54.39100006304632, 18.302084075531052, 27.830617414971027, -38.362712057307284, -53.63084534086522, 13.995234376994624, 35.39132413308208, 6.282368579709755, 23.15229438809849, 0.7383126083780382, 9.63713781352956, -46.23901248531765, -56.823962336221264, 26.661932393564392, 24.143757288487397, -57.043323451291634, -25.78252210542602, -23.45244274407301, -49.04618073876923, 32.477629205441666, 3.4545875953041367, 23.625970471329687, 6.604400148247037, -46.656352880252214, -49.71990550762289, 25.527358370341023, 27.138310594036714, -44.907911666813554, -60.4592246160087, 15.571997278845457, 4.783054672772142, -28.885675562095777, -19.008961753235518, -29.666571762913826, -25.951306735828155, 29.356095009244264, 18.200022225993273, 15.018856293605637, 21.7875198379867, -45.75509015799496, -36.897003959953516, -36.90734165692947, -30.500174546603105, -36.346020371282066, -41.02363436312448, -32.39828753091192, -34.65247048620076, 30.725634912194973, 9.15178800246909, -34.17311384900787, -21.97116493227243, -42.84596325537344, -45.929970103683786, 45.91719798080144, 30.35753733368205, 24.15260122541623, 33.11715133150209, 3.6279814580525445, 15.874500939868305, -30.492684041528356, -32.7213788098666, -35.51536812602355, -22.00789924009225, 1.5910405106810295, -4.236652172978904, -23.773181244113395, -58.00088723409048, -50.53572278496693, -46.36419752435966, 8.686997565453078, 2.7648331124318677, -32.79455151808324, -27.11112855216826, 12.013529531679573, 35.36644524456406, 11.096076248188519, 12.182182912178764, 1.7556884632928416, -6.364715251708311, -49.53011454693661, -44.09135507901217, -40.88182464506207, -39.29355264942811, -8.162905412346447, -9.630172013724263, 3.0837132432707506, -36.22888398651025, -19.505706826730574, -19.664988003795706, -0.7895649121453001, 16.485915215218892, -0.2961643385003079, -7.4067668570568586, -7.6302099366514184, -34.07346984224908, -6.689095746304723, 17.252869526086656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44139568367278365, "mean_inference_ms": 1.1693214876054299, "mean_action_processing_ms": 0.1900322567645449, "mean_env_wait_ms": 0.07725953942678938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038945674896240234, "StateBufferConnector_ms": 0.0034983158111572266, "ViewRequirementAgentConnector_ms": 0.08625662326812744}, "num_episodes": 10, "episode_return_max": 44.111550063481225, "episode_return_min": -56.10462546324677, "episode_return_mean": -6.244869566790979}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 424.1392040468078, "num_env_steps_trained_throughput_per_sec": 424.1392040468078, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 9532.798, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9532.742, "sample_time_ms": 1028.026, "learn_time_ms": 8488.543, "learn_throughput": 471.223, "synch_weights_time_ms": 15.477}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "training_iteration": 37, "trial_id": "83a5c_00000", "date": "2024-08-10_12-19-14", "timestamp": 1723306754, "time_this_iter_s": 9.436686038970947, "time_total_s": 318.60295248031616, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.60295248031616, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 36.292307692307695, "ram_util_percent": 81.23846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.137041603383564, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.749575223619976, "policy_loss": -0.005434608353282172, "vf_loss": 5.753547813526537, "vf_explained_var": 0.0653252382442434, "kl": 0.011551773191063168, "entropy": 1.495693526003096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3175276895674566, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.237023072441419, "policy_loss": -0.001343112856799659, "vf_loss": 4.2381068180004755, "vf_explained_var": 0.01444955039769411, "kl": 0.004611136364180032, "entropy": 0.8574169926345349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 44.111550063481225, "episode_reward_min": -56.10462546324677, "episode_reward_mean": -6.807499573624884, "episode_len_mean": 321.28, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 32128, "policy_reward_min": {"agent_policy": -44.11155006348118, "adversary_policy": -63.146454592978245}, "policy_reward_max": {"agent_policy": 56.10462546324678, "adversary_policy": 47.4539839274547}, "policy_reward_mean": {"agent_policy": 6.807499573624885, "adversary_policy": -6.807499573624885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.671513966956205, 21.16204015936055, -32.12082409361043, 15.881891704555539, -56.10462546324677, -38.357784533570836, 20.707624968806236, -0.6800804940634633, 28.509361167662032, -28.17601957934607, 19.398621250899293, 15.354830532225352, -51.12524840613426, 44.111550063481225, 27.09619753292729, 6.932842246761007, 5.6239602033660345, 16.12591599450812, 10.0099514857194, 2.6053128431446986, 1.819303839536756, -28.790660312331532, -22.047149530944075, 9.893878574484232, -31.72003550636819, -31.02534158089413, 27.097899985060497, -45.80945115289876, 18.274791355457918, 29.576922544459848, 25.617381941946455, -38.08450066375535, 37.29944711472042, 24.77848037593406, -32.43473853089025, 32.49037852018902, -49.91632187456419, 30.443663039896226, 21.99026510578, 19.829337428685765, -46.857297069978145, 23.066350745251047, -45.99677869908623, 24.693279255038345, 14.717331483904095, 5.187725210953799, -51.53148741076947, 25.40284484102589, -41.41292277835881, -36.24931174142109, 17.96610840037291, 15.115185309788348, -48.1881291939375, 26.332834482188886, -52.68356814141108, 10.177525975808798, -23.947318657665647, -27.808939249370994, 23.77805861761878, 18.40318806579616, -41.326047058974225, -33.70375810176629, -38.68482736720319, -33.52537900855635, 19.938711457332037, -28.072139390640153, -44.38796667952856, 38.13736765724169, 28.634876278459192, 9.751241198960443, -31.60703142569748, -28.7616336830579, -1.322805831148938, -40.88703423910196, -48.44996015466337, 5.725915338942468, -29.952840035125803, 23.689987388121892, 11.639129580183642, -2.304513394207733, -46.81073481297438, -40.08768864724514, -8.896538713035357, -16.57258537161975, -19.58534741526314, 7.848175151536806, -3.851465597778583, -20.851839889450257, 5.281886889890966, -9.277402461944286, -10.429327466933362, -10.701221549192237, -18.014619723362667, -15.743440103500664, -22.10764214277731, -7.4831318068207295, -3.4587234391410853, -10.910382028982623, -19.674129686797894, -17.030352746320098], "episode_lengths": [400, 129, 400, 262, 400, 400, 181, 62, 198, 400, 170, 127, 400, 248, 240, 106, 63, 140, 113, 159, 129, 400, 400, 83, 400, 400, 100, 400, 175, 163, 339, 400, 213, 209, 400, 121, 400, 220, 174, 221, 400, 106, 400, 94, 241, 10, 400, 170, 400, 400, 251, 111, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-16.671513966956205, -21.162040159360547, 32.12082409361043, -15.881891704555528, 56.10462546324678, 38.35778453357084, -20.707624968806225, 0.6800804940634624, -28.50936116766204, 28.17601957934607, -19.398621250899286, -15.354830532225357, 51.12524840613427, -44.11155006348118, -27.096197532927334, -6.932842246761009, -5.6239602033660345, -16.125915994508112, -10.009951485719393, -2.6053128431446924, -1.8193038395367584, 28.790660312331532, 22.047149530944075, -9.893878574484233, 31.72003550636819, 31.02534158089413, -27.0978999850605, 45.80945115289875, -18.274791355457932, -29.57692254445982, -25.617381941946466, 38.08450066375536, -37.299447114720444, -24.77848037593403, 32.43473853089025, -32.490378520189026, 49.91632187456418, -30.443663039896226, -21.99026510577999, -19.829337428685765, 46.85729706997815, -23.066350745251036, 45.996778699086235, -24.693279255038348, -14.717331483904122, -5.187725210953799, 51.53148741076948, -25.40284484102589, 41.412922778358805, 36.24931174142111, -17.966108400372903, -15.115185309788359, 48.188129193937506, -26.33283448218887, 52.68356814141107, -10.177525975808788, 23.947318657665647, 27.808939249370994, -23.778058617618758, -18.403188065796165, 41.326047058974204, 33.7037581017663, 38.6848273672032, 33.52537900855636, -19.93871145733206, 28.072139390640146, 44.38796667952857, -38.13736765724177, -28.634876278459146, -9.751241198960434, 31.60703142569748, 28.7616336830579, 1.3228058311489383, 40.88703423910195, 48.449960154663366, -5.725915338942477, 29.952840035125764, -23.68998738812182, -11.639129580183639, 2.304513394207728, 46.810734812974374, 40.08768864724513, 8.896538713035353, 16.57258537161975, 19.58534741526314, -7.8481751515368, 3.851465597778583, 20.851839889450265, -5.281886889890966, 9.277402461944286, 10.429327466933362, 10.701221549192239, 18.014619723362657, 15.743440103500665, 22.10764214277731, 7.483131806820728, 3.4587234391410853, 10.91038202898262, 19.674129686797897, 17.030352746320098], "policy_adversary_policy_reward": [20.882658247601714, 12.460369686310743, 9.376798908934976, 32.94728140978612, -18.541998633918773, -45.69964955330209, 18.901564568532113, 12.862218840578947, -49.06279633351533, -63.146454592978245, -30.826364485679477, -45.88920458146222, 23.983514827420603, 17.431735110191863, -15.28030629725431, 13.920145309127383, 26.010066801210108, 31.008655534113966, -19.50532203398825, -36.84671712470389, 19.232405245145074, 19.564837256653504, 16.28235978725548, 14.427301277195223, -55.07367674367855, -47.17682006858992, 47.4539839274547, 40.769116199507735, 25.90338950375036, 28.28900556210426, 8.432463138060115, 5.433221355461903, 25.279215324802454, -14.031294918070373, 18.218252711436534, 14.033579277579696, 12.531119047275267, 7.488783924163528, 3.7059248173747044, 1.504700868914675, 3.1384910241887845, 0.5001166548847262, -30.556567051284432, -27.024753573378632, -17.317195113726704, -26.777103948161447, -2.72831567770983, 22.516072826678297, -29.128323874380037, -34.31174713835635, -29.21223504912212, -32.838448112666136, 18.717671683624317, 35.478128286496684, -42.08872592739213, -49.530176378405336, 28.141949058768404, 8.40763365214747, 30.655602858096916, 28.49824223082275, 27.94649580869598, 23.288268075196935, -49.44618369509697, -26.722817632413722, 36.741348232270454, 37.85754599717047, 26.07915770949397, 23.47780304237412, -18.392873627340308, -46.4766034344402, 31.567029470511876, 33.41372756986613, -42.07268789852222, -57.75995585060616, 30.388278372834197, 30.499047706958233, 9.710482115692898, 34.27004809586708, 23.761786345961234, 15.8968885114103, -39.32359407690996, -54.39100006304632, 18.302084075531052, 27.830617414971027, -38.362712057307284, -53.63084534086522, 13.995234376994624, 35.39132413308208, 6.282368579709755, 23.15229438809849, 0.7383126083780382, 9.63713781352956, -46.23901248531765, -56.823962336221264, 26.661932393564392, 24.143757288487397, -57.043323451291634, -25.78252210542602, -23.45244274407301, -49.04618073876923, 32.477629205441666, 3.4545875953041367, 23.625970471329687, 6.604400148247037, -46.656352880252214, -49.71990550762289, 25.527358370341023, 27.138310594036714, -44.907911666813554, -60.4592246160087, 15.571997278845457, 4.783054672772142, -28.885675562095777, -19.008961753235518, -29.666571762913826, -25.951306735828155, 29.356095009244264, 18.200022225993273, 15.018856293605637, 21.7875198379867, -45.75509015799496, -36.897003959953516, -36.90734165692947, -30.500174546603105, -36.346020371282066, -41.02363436312448, -32.39828753091192, -34.65247048620076, 30.725634912194973, 9.15178800246909, -34.17311384900787, -21.97116493227243, -42.84596325537344, -45.929970103683786, 45.91719798080144, 30.35753733368205, 24.15260122541623, 33.11715133150209, 3.6279814580525445, 15.874500939868305, -30.492684041528356, -32.7213788098666, -35.51536812602355, -22.00789924009225, 1.5910405106810295, -4.236652172978904, -23.773181244113395, -58.00088723409048, -50.53572278496693, -46.36419752435966, 8.686997565453078, 2.7648331124318677, -32.79455151808324, -27.11112855216826, 12.013529531679573, 35.36644524456406, 11.096076248188519, 12.182182912178764, 1.7556884632928416, -6.364715251708311, -49.53011454693661, -44.09135507901217, -40.88182464506207, -39.29355264942811, -8.162905412346447, -9.630172013724263, 3.0837132432707506, -36.22888398651025, -19.505706826730574, -19.664988003795706, -0.7895649121453001, 16.485915215218892, -0.2961643385003079, -7.4067668570568586, -7.6302099366514184, -34.07346984224908, -6.689095746304723, 17.252869526086656, -2.3216388120669933, -16.23316611182158, -23.568276632483794, 2.7096216986170703, -9.616241779657422, -11.786201318727056, -10.104148722012347, -25.925090724712973, -23.215743184376382, -8.271137022624949, -11.814986563600092, -32.40029772195452, -10.197518611966423, -4.768745001675036, 1.4859936642370926, -8.403440542519263, 3.801736593672018, -25.622500651637253, -14.265446312880378, -25.08281306071541, -10.336073312943128, -23.72463217969706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44278277760352824, "mean_inference_ms": 1.174101737685122, "mean_action_processing_ms": 0.19093275654169872, "mean_env_wait_ms": 0.07767782168631837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038117170333862305, "StateBufferConnector_ms": 0.0034292936325073242, "ViewRequirementAgentConnector_ms": 0.08561122417449951}, "num_episodes": 11, "episode_return_max": 44.111550063481225, "episode_return_min": -56.10462546324677, "episode_return_mean": -6.807499573624884}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.1115919984331, "num_env_steps_trained_throughput_per_sec": 448.1115919984331, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 9506.113, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9506.056, "sample_time_ms": 1015.513, "learn_time_ms": 8474.861, "learn_throughput": 471.984, "synch_weights_time_ms": 14.977}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 38, "trial_id": "83a5c_00000", "date": "2024-08-10_12-19-23", "timestamp": 1723306763, "time_this_iter_s": 8.953845977783203, "time_total_s": 327.55679845809937, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5c90d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 327.55679845809937, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.44615384615384, "ram_util_percent": 80.46923076923076}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9874686753308333, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.085878687182431, "policy_loss": -0.0078063705010911226, "vf_loss": 5.0919443140584955, "vf_explained_var": -0.35291542139633625, "kl": 0.013754025677694974, "entropy": 1.4794017166687699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.585234976063172, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9639565301438173, "policy_loss": -0.005513531407147335, "vf_loss": 3.9690797959764796, "vf_explained_var": 0.046221254083017506, "kl": 0.013876944531185502, "entropy": 0.8592981619139513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "env_runners": {"episode_reward_max": 44.111550063481225, "episode_reward_min": -52.68356814141108, "episode_reward_mean": -7.077562610459913, "episode_len_mean": 332.96, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 33296, "policy_reward_min": {"agent_policy": -44.11155006348118, "adversary_policy": -60.4592246160087}, "policy_reward_max": {"agent_policy": 52.68356814141107, "adversary_policy": 47.4539839274547}, "policy_reward_mean": {"agent_policy": 7.077562610459913, "adversary_policy": -7.077562610459913}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.17601957934607, 19.398621250899293, 15.354830532225352, -51.12524840613426, 44.111550063481225, 27.09619753292729, 6.932842246761007, 5.6239602033660345, 16.12591599450812, 10.0099514857194, 2.6053128431446986, 1.819303839536756, -28.790660312331532, -22.047149530944075, 9.893878574484232, -31.72003550636819, -31.02534158089413, 27.097899985060497, -45.80945115289876, 18.274791355457918, 29.576922544459848, 25.617381941946455, -38.08450066375535, 37.29944711472042, 24.77848037593406, -32.43473853089025, 32.49037852018902, -49.91632187456419, 30.443663039896226, 21.99026510578, 19.829337428685765, -46.857297069978145, 23.066350745251047, -45.99677869908623, 24.693279255038345, 14.717331483904095, 5.187725210953799, -51.53148741076947, 25.40284484102589, -41.41292277835881, -36.24931174142109, 17.96610840037291, 15.115185309788348, -48.1881291939375, 26.332834482188886, -52.68356814141108, 10.177525975808798, -23.947318657665647, -27.808939249370994, 23.77805861761878, 18.40318806579616, -41.326047058974225, -33.70375810176629, -38.68482736720319, -33.52537900855635, 19.938711457332037, -28.072139390640153, -44.38796667952856, 38.13736765724169, 28.634876278459192, 9.751241198960443, -31.60703142569748, -28.7616336830579, -1.322805831148938, -40.88703423910196, -48.44996015466337, 5.725915338942468, -29.952840035125803, 23.689987388121892, 11.639129580183642, -2.304513394207733, -46.81073481297438, -40.08768864724514, -8.896538713035357, -16.57258537161975, -19.58534741526314, 7.848175151536806, -3.851465597778583, -20.851839889450257, 5.281886889890966, -9.277402461944286, -10.429327466933362, -10.701221549192237, -18.014619723362667, -15.743440103500664, -22.10764214277731, -7.4831318068207295, -3.4587234391410853, -10.910382028982623, -19.674129686797894, -17.030352746320098, -3.0867780537555607, -9.132814532464945, 12.623780373670504, -16.05340099133528, -26.105659992915257, 3.0818880351888716, 3.048706954411962, -17.66254028331142, 1.9496321898572848], "episode_lengths": [400, 170, 127, 400, 248, 240, 106, 63, 140, 113, 159, 129, 400, 400, 83, 400, 400, 100, 400, 175, 163, 339, 400, 213, 209, 400, 121, 400, 220, 174, 221, 400, 106, 400, 94, 241, 10, 400, 170, 400, 400, 251, 111, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [28.17601957934607, -19.398621250899286, -15.354830532225357, 51.12524840613427, -44.11155006348118, -27.096197532927334, -6.932842246761009, -5.6239602033660345, -16.125915994508112, -10.009951485719393, -2.6053128431446924, -1.8193038395367584, 28.790660312331532, 22.047149530944075, -9.893878574484233, 31.72003550636819, 31.02534158089413, -27.0978999850605, 45.80945115289875, -18.274791355457932, -29.57692254445982, -25.617381941946466, 38.08450066375536, -37.299447114720444, -24.77848037593403, 32.43473853089025, -32.490378520189026, 49.91632187456418, -30.443663039896226, -21.99026510577999, -19.829337428685765, 46.85729706997815, -23.066350745251036, 45.996778699086235, -24.693279255038348, -14.717331483904122, -5.187725210953799, 51.53148741076948, -25.40284484102589, 41.412922778358805, 36.24931174142111, -17.966108400372903, -15.115185309788359, 48.188129193937506, -26.33283448218887, 52.68356814141107, -10.177525975808788, 23.947318657665647, 27.808939249370994, -23.778058617618758, -18.403188065796165, 41.326047058974204, 33.7037581017663, 38.6848273672032, 33.52537900855636, -19.93871145733206, 28.072139390640146, 44.38796667952857, -38.13736765724177, -28.634876278459146, -9.751241198960434, 31.60703142569748, 28.7616336830579, 1.3228058311489383, 40.88703423910195, 48.449960154663366, -5.725915338942477, 29.952840035125764, -23.68998738812182, -11.639129580183639, 2.304513394207728, 46.810734812974374, 40.08768864724513, 8.896538713035353, 16.57258537161975, 19.58534741526314, -7.8481751515368, 3.851465597778583, 20.851839889450265, -5.281886889890966, 9.277402461944286, 10.429327466933362, 10.701221549192239, 18.014619723362657, 15.743440103500665, 22.10764214277731, 7.483131806820728, 3.4587234391410853, 10.91038202898262, 19.674129686797897, 17.030352746320098, 3.0867780537555607, 9.132814532464943, -12.623780373670503, 16.05340099133528, 26.105659992915253, -3.0818880351888716, -3.048706954411962, 17.662540283311397, -1.9496321898572848], "policy_adversary_policy_reward": [-19.50532203398825, -36.84671712470389, 19.232405245145074, 19.564837256653504, 16.28235978725548, 14.427301277195223, -55.07367674367855, -47.17682006858992, 47.4539839274547, 40.769116199507735, 25.90338950375036, 28.28900556210426, 8.432463138060115, 5.433221355461903, 25.279215324802454, -14.031294918070373, 18.218252711436534, 14.033579277579696, 12.531119047275267, 7.488783924163528, 3.7059248173747044, 1.504700868914675, 3.1384910241887845, 0.5001166548847262, -30.556567051284432, -27.024753573378632, -17.317195113726704, -26.777103948161447, -2.72831567770983, 22.516072826678297, -29.128323874380037, -34.31174713835635, -29.21223504912212, -32.838448112666136, 18.717671683624317, 35.478128286496684, -42.08872592739213, -49.530176378405336, 28.141949058768404, 8.40763365214747, 30.655602858096916, 28.49824223082275, 27.94649580869598, 23.288268075196935, -49.44618369509697, -26.722817632413722, 36.741348232270454, 37.85754599717047, 26.07915770949397, 23.47780304237412, -18.392873627340308, -46.4766034344402, 31.567029470511876, 33.41372756986613, -42.07268789852222, -57.75995585060616, 30.388278372834197, 30.499047706958233, 9.710482115692898, 34.27004809586708, 23.761786345961234, 15.8968885114103, -39.32359407690996, -54.39100006304632, 18.302084075531052, 27.830617414971027, -38.362712057307284, -53.63084534086522, 13.995234376994624, 35.39132413308208, 6.282368579709755, 23.15229438809849, 0.7383126083780382, 9.63713781352956, -46.23901248531765, -56.823962336221264, 26.661932393564392, 24.143757288487397, -57.043323451291634, -25.78252210542602, -23.45244274407301, -49.04618073876923, 32.477629205441666, 3.4545875953041367, 23.625970471329687, 6.604400148247037, -46.656352880252214, -49.71990550762289, 25.527358370341023, 27.138310594036714, -44.907911666813554, -60.4592246160087, 15.571997278845457, 4.783054672772142, -28.885675562095777, -19.008961753235518, -29.666571762913826, -25.951306735828155, 29.356095009244264, 18.200022225993273, 15.018856293605637, 21.7875198379867, -45.75509015799496, -36.897003959953516, -36.90734165692947, -30.500174546603105, -36.346020371282066, -41.02363436312448, -32.39828753091192, -34.65247048620076, 30.725634912194973, 9.15178800246909, -34.17311384900787, -21.97116493227243, -42.84596325537344, -45.929970103683786, 45.91719798080144, 30.35753733368205, 24.15260122541623, 33.11715133150209, 3.6279814580525445, 15.874500939868305, -30.492684041528356, -32.7213788098666, -35.51536812602355, -22.00789924009225, 1.5910405106810295, -4.236652172978904, -23.773181244113395, -58.00088723409048, -50.53572278496693, -46.36419752435966, 8.686997565453078, 2.7648331124318677, -32.79455151808324, -27.11112855216826, 12.013529531679573, 35.36644524456406, 11.096076248188519, 12.182182912178764, 1.7556884632928416, -6.364715251708311, -49.53011454693661, -44.09135507901217, -40.88182464506207, -39.29355264942811, -8.162905412346447, -9.630172013724263, 3.0837132432707506, -36.22888398651025, -19.505706826730574, -19.664988003795706, -0.7895649121453001, 16.485915215218892, -0.2961643385003079, -7.4067668570568586, -7.6302099366514184, -34.07346984224908, -6.689095746304723, 17.252869526086656, -2.3216388120669933, -16.23316611182158, -23.568276632483794, 2.7096216986170703, -9.616241779657422, -11.786201318727056, -10.104148722012347, -25.925090724712973, -23.215743184376382, -8.271137022624949, -11.814986563600092, -32.40029772195452, -10.197518611966423, -4.768745001675036, 1.4859936642370926, -8.403440542519263, 3.801736593672018, -25.622500651637253, -14.265446312880378, -25.08281306071541, -10.336073312943128, -23.72463217969706, -6.578822060817483, 0.4052659533063636, -2.3672621896575166, -15.898366875272359, 9.678306009731724, 15.569254737609281, -23.01788330285951, -9.088918679811052, -32.08415821399476, -20.12716177183576, -8.988517570137688, 15.152293640515431, 4.129463927069118, 1.9679499817548063, -17.43844915132486, -17.886631415297934, 19.24800956830113, -15.348745188586559]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4436612817684493, "mean_inference_ms": 1.1778126035004493, "mean_action_processing_ms": 0.19160537499779814, "mean_env_wait_ms": 0.0780421655069385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038368701934814453, "StateBufferConnector_ms": 0.003409862518310547, "ViewRequirementAgentConnector_ms": 0.0880812406539917}, "num_episodes": 9, "episode_return_max": 44.111550063481225, "episode_return_min": -52.68356814141108, "episode_return_mean": -7.077562610459913}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 440.54125824389337, "num_env_steps_trained_throughput_per_sec": 440.54125824389337, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 9555.312, "restore_workers_time_ms": 0.013, "training_step_time_ms": 9555.255, "sample_time_ms": 1016.466, "learn_time_ms": 8523.321, "learn_throughput": 469.301, "synch_weights_time_ms": 14.76}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "training_iteration": 39, "trial_id": "83a5c_00000", "date": "2024-08-10_12-19-32", "timestamp": 1723306772, "time_this_iter_s": 9.086005926132202, "time_total_s": 336.64280438423157, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f635ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 336.64280438423157, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 33.23076923076923, "ram_util_percent": 80.46153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0967530727071106, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.53857536845737, "policy_loss": -0.0010811052039985066, "vf_loss": 4.539216494434094, "vf_explained_var": 0.0031617677085614077, "kl": 0.0034762705749499983, "entropy": 1.4427149607390954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.101594617279867, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.229794029394785, "policy_loss": -0.010890753370767925, "vf_loss": 4.2400172638396425, "vf_explained_var": 0.06429834800461928, "kl": 0.02373369006448879, "entropy": 0.8140435178453723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 38.13736765724169, "episode_reward_min": -52.68356814141108, "episode_reward_mean": -8.390468596924018, "episode_len_mean": 355.3, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35530, "policy_reward_min": {"agent_policy": -38.13736765724177, "adversary_policy": -60.4592246160087}, "policy_reward_max": {"agent_policy": 52.68356814141107, "adversary_policy": 45.91719798080144}, "policy_reward_mean": {"agent_policy": 8.39046859692402, "adversary_policy": -8.39046859692402}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.819303839536756, -28.790660312331532, -22.047149530944075, 9.893878574484232, -31.72003550636819, -31.02534158089413, 27.097899985060497, -45.80945115289876, 18.274791355457918, 29.576922544459848, 25.617381941946455, -38.08450066375535, 37.29944711472042, 24.77848037593406, -32.43473853089025, 32.49037852018902, -49.91632187456419, 30.443663039896226, 21.99026510578, 19.829337428685765, -46.857297069978145, 23.066350745251047, -45.99677869908623, 24.693279255038345, 14.717331483904095, 5.187725210953799, -51.53148741076947, 25.40284484102589, -41.41292277835881, -36.24931174142109, 17.96610840037291, 15.115185309788348, -48.1881291939375, 26.332834482188886, -52.68356814141108, 10.177525975808798, -23.947318657665647, -27.808939249370994, 23.77805861761878, 18.40318806579616, -41.326047058974225, -33.70375810176629, -38.68482736720319, -33.52537900855635, 19.938711457332037, -28.072139390640153, -44.38796667952856, 38.13736765724169, 28.634876278459192, 9.751241198960443, -31.60703142569748, -28.7616336830579, -1.322805831148938, -40.88703423910196, -48.44996015466337, 5.725915338942468, -29.952840035125803, 23.689987388121892, 11.639129580183642, -2.304513394207733, -46.81073481297438, -40.08768864724514, -8.896538713035357, -16.57258537161975, -19.58534741526314, 7.848175151536806, -3.851465597778583, -20.851839889450257, 5.281886889890966, -9.277402461944286, -10.429327466933362, -10.701221549192237, -18.014619723362667, -15.743440103500664, -22.10764214277731, -7.4831318068207295, -3.4587234391410853, -10.910382028982623, -19.674129686797894, -17.030352746320098, -3.0867780537555607, -9.132814532464945, 12.623780373670504, -16.05340099133528, -26.105659992915257, 3.0818880351888716, 3.048706954411962, -17.66254028331142, 1.9496321898572848, -3.325446154939147, -6.862308701797264, 19.408664611598244, -18.51726508934289, -0.23815458711539605, -22.888697654240058, 6.063387982055762, -15.818653221556687, -9.29202155471464, -6.467820208791622, -5.3943699000148975], "episode_lengths": [129, 400, 400, 83, 400, 400, 100, 400, 175, 163, 339, 400, 213, 209, 400, 121, 400, 220, 174, 221, 400, 106, 400, 94, 241, 10, 400, 170, 400, 400, 251, 111, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-1.8193038395367584, 28.790660312331532, 22.047149530944075, -9.893878574484233, 31.72003550636819, 31.02534158089413, -27.0978999850605, 45.80945115289875, -18.274791355457932, -29.57692254445982, -25.617381941946466, 38.08450066375536, -37.299447114720444, -24.77848037593403, 32.43473853089025, -32.490378520189026, 49.91632187456418, -30.443663039896226, -21.99026510577999, -19.829337428685765, 46.85729706997815, -23.066350745251036, 45.996778699086235, -24.693279255038348, -14.717331483904122, -5.187725210953799, 51.53148741076948, -25.40284484102589, 41.412922778358805, 36.24931174142111, -17.966108400372903, -15.115185309788359, 48.188129193937506, -26.33283448218887, 52.68356814141107, -10.177525975808788, 23.947318657665647, 27.808939249370994, -23.778058617618758, -18.403188065796165, 41.326047058974204, 33.7037581017663, 38.6848273672032, 33.52537900855636, -19.93871145733206, 28.072139390640146, 44.38796667952857, -38.13736765724177, -28.634876278459146, -9.751241198960434, 31.60703142569748, 28.7616336830579, 1.3228058311489383, 40.88703423910195, 48.449960154663366, -5.725915338942477, 29.952840035125764, -23.68998738812182, -11.639129580183639, 2.304513394207728, 46.810734812974374, 40.08768864724513, 8.896538713035353, 16.57258537161975, 19.58534741526314, -7.8481751515368, 3.851465597778583, 20.851839889450265, -5.281886889890966, 9.277402461944286, 10.429327466933362, 10.701221549192239, 18.014619723362657, 15.743440103500665, 22.10764214277731, 7.483131806820728, 3.4587234391410853, 10.91038202898262, 19.674129686797897, 17.030352746320098, 3.0867780537555607, 9.132814532464943, -12.623780373670503, 16.05340099133528, 26.105659992915253, -3.0818880351888716, -3.048706954411962, 17.662540283311397, -1.9496321898572848, 3.325446154939147, 6.862308701797264, -19.408664611598248, 18.51726508934287, 0.23815458711539605, 22.88869765424006, -6.063387982055771, 15.818653221556687, 9.29202155471463, 6.467820208791622, 5.3943699000148975], "policy_adversary_policy_reward": [3.1384910241887845, 0.5001166548847262, -30.556567051284432, -27.024753573378632, -17.317195113726704, -26.777103948161447, -2.72831567770983, 22.516072826678297, -29.128323874380037, -34.31174713835635, -29.21223504912212, -32.838448112666136, 18.717671683624317, 35.478128286496684, -42.08872592739213, -49.530176378405336, 28.141949058768404, 8.40763365214747, 30.655602858096916, 28.49824223082275, 27.94649580869598, 23.288268075196935, -49.44618369509697, -26.722817632413722, 36.741348232270454, 37.85754599717047, 26.07915770949397, 23.47780304237412, -18.392873627340308, -46.4766034344402, 31.567029470511876, 33.41372756986613, -42.07268789852222, -57.75995585060616, 30.388278372834197, 30.499047706958233, 9.710482115692898, 34.27004809586708, 23.761786345961234, 15.8968885114103, -39.32359407690996, -54.39100006304632, 18.302084075531052, 27.830617414971027, -38.362712057307284, -53.63084534086522, 13.995234376994624, 35.39132413308208, 6.282368579709755, 23.15229438809849, 0.7383126083780382, 9.63713781352956, -46.23901248531765, -56.823962336221264, 26.661932393564392, 24.143757288487397, -57.043323451291634, -25.78252210542602, -23.45244274407301, -49.04618073876923, 32.477629205441666, 3.4545875953041367, 23.625970471329687, 6.604400148247037, -46.656352880252214, -49.71990550762289, 25.527358370341023, 27.138310594036714, -44.907911666813554, -60.4592246160087, 15.571997278845457, 4.783054672772142, -28.885675562095777, -19.008961753235518, -29.666571762913826, -25.951306735828155, 29.356095009244264, 18.200022225993273, 15.018856293605637, 21.7875198379867, -45.75509015799496, -36.897003959953516, -36.90734165692947, -30.500174546603105, -36.346020371282066, -41.02363436312448, -32.39828753091192, -34.65247048620076, 30.725634912194973, 9.15178800246909, -34.17311384900787, -21.97116493227243, -42.84596325537344, -45.929970103683786, 45.91719798080144, 30.35753733368205, 24.15260122541623, 33.11715133150209, 3.6279814580525445, 15.874500939868305, -30.492684041528356, -32.7213788098666, -35.51536812602355, -22.00789924009225, 1.5910405106810295, -4.236652172978904, -23.773181244113395, -58.00088723409048, -50.53572278496693, -46.36419752435966, 8.686997565453078, 2.7648331124318677, -32.79455151808324, -27.11112855216826, 12.013529531679573, 35.36644524456406, 11.096076248188519, 12.182182912178764, 1.7556884632928416, -6.364715251708311, -49.53011454693661, -44.09135507901217, -40.88182464506207, -39.29355264942811, -8.162905412346447, -9.630172013724263, 3.0837132432707506, -36.22888398651025, -19.505706826730574, -19.664988003795706, -0.7895649121453001, 16.485915215218892, -0.2961643385003079, -7.4067668570568586, -7.6302099366514184, -34.07346984224908, -6.689095746304723, 17.252869526086656, -2.3216388120669933, -16.23316611182158, -23.568276632483794, 2.7096216986170703, -9.616241779657422, -11.786201318727056, -10.104148722012347, -25.925090724712973, -23.215743184376382, -8.271137022624949, -11.814986563600092, -32.40029772195452, -10.197518611966423, -4.768745001675036, 1.4859936642370926, -8.403440542519263, 3.801736593672018, -25.622500651637253, -14.265446312880378, -25.08281306071541, -10.336073312943128, -23.72463217969706, -6.578822060817483, 0.4052659533063636, -2.3672621896575166, -15.898366875272359, 9.678306009731724, 15.569254737609281, -23.01788330285951, -9.088918679811052, -32.08415821399476, -20.12716177183576, -8.988517570137688, 15.152293640515431, 4.129463927069118, 1.9679499817548063, -17.43844915132486, -17.886631415297934, 19.24800956830113, -15.348745188586559, 6.01943603605006, -12.670328345928354, 0.8869311931692039, -14.611548596763736, 29.473916254239235, 9.343412968957253, -32.9251246207556, -4.10940555793016, -13.136211449817871, 12.65990227558708, -26.441046722170363, -19.336348586309757, 11.870507837885832, 0.25626812622568806, -15.061760735646036, -16.575545707467338, -12.258858124816697, -6.325184984612569, -12.832048272509596, -0.10359214507364811, -11.151860792042754, 0.3631209920129592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4448949484418847, "mean_inference_ms": 1.18179882182488, "mean_action_processing_ms": 0.1922392278028138, "mean_env_wait_ms": 0.07829189905967353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003849029541015625, "StateBufferConnector_ms": 0.0034056901931762695, "ViewRequirementAgentConnector_ms": 0.0870276689529419}, "num_episodes": 11, "episode_return_max": 38.13736765724169, "episode_return_min": -52.68356814141108, "episode_return_mean": -8.390468596924018}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.4649875890541, "num_env_steps_trained_throughput_per_sec": 447.4649875890541, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 9519.402, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9519.343, "sample_time_ms": 1002.926, "learn_time_ms": 8501.092, "learn_throughput": 470.528, "synch_weights_time_ms": 14.619}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 40, "trial_id": "83a5c_00000", "date": "2024-08-10_12-19-41", "timestamp": 1723306781, "time_this_iter_s": 8.944827795028687, "time_total_s": 345.58763217926025, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 345.58763217926025, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 29.623076923076926, "ram_util_percent": 80.43076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.868239923097469, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8626121606776325, "policy_loss": -0.004981444905038982, "vf_loss": 3.8668965580602173, "vf_explained_var": -0.20355991282791058, "kl": 0.01101509354803345, "entropy": 1.4579958901203498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2721007452656825, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.348544023061792, "policy_loss": -0.0022260571781468268, "vf_loss": 3.3504129966100056, "vf_explained_var": 0.1497524119913578, "kl": 0.00846424625382951, "entropy": 0.7681928327927987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "env_runners": {"episode_reward_max": 38.13736765724169, "episode_reward_min": -52.68356814141108, "episode_reward_mean": -9.43202151659673, "episode_len_mean": 369.41, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36941, "policy_reward_min": {"agent_policy": -38.13736765724177, "adversary_policy": -60.4592246160087}, "policy_reward_max": {"agent_policy": 52.68356814141107, "adversary_policy": 45.91719798080144}, "policy_reward_mean": {"agent_policy": 9.432021516596729, "adversary_policy": -9.432021516596732}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.08450066375535, 37.29944711472042, 24.77848037593406, -32.43473853089025, 32.49037852018902, -49.91632187456419, 30.443663039896226, 21.99026510578, 19.829337428685765, -46.857297069978145, 23.066350745251047, -45.99677869908623, 24.693279255038345, 14.717331483904095, 5.187725210953799, -51.53148741076947, 25.40284484102589, -41.41292277835881, -36.24931174142109, 17.96610840037291, 15.115185309788348, -48.1881291939375, 26.332834482188886, -52.68356814141108, 10.177525975808798, -23.947318657665647, -27.808939249370994, 23.77805861761878, 18.40318806579616, -41.326047058974225, -33.70375810176629, -38.68482736720319, -33.52537900855635, 19.938711457332037, -28.072139390640153, -44.38796667952856, 38.13736765724169, 28.634876278459192, 9.751241198960443, -31.60703142569748, -28.7616336830579, -1.322805831148938, -40.88703423910196, -48.44996015466337, 5.725915338942468, -29.952840035125803, 23.689987388121892, 11.639129580183642, -2.304513394207733, -46.81073481297438, -40.08768864724514, -8.896538713035357, -16.57258537161975, -19.58534741526314, 7.848175151536806, -3.851465597778583, -20.851839889450257, 5.281886889890966, -9.277402461944286, -10.429327466933362, -10.701221549192237, -18.014619723362667, -15.743440103500664, -22.10764214277731, -7.4831318068207295, -3.4587234391410853, -10.910382028982623, -19.674129686797894, -17.030352746320098, -3.0867780537555607, -9.132814532464945, 12.623780373670504, -16.05340099133528, -26.105659992915257, 3.0818880351888716, 3.048706954411962, -17.66254028331142, 1.9496321898572848, -3.325446154939147, -6.862308701797264, 19.408664611598244, -18.51726508934289, -0.23815458711539605, -22.888697654240058, 6.063387982055762, -15.818653221556687, -9.29202155471464, -6.467820208791622, -5.3943699000148975, -10.25667242622319, -15.889259260834962, -11.508602540670072, -27.8529811378939, -10.91539141431585, 10.019430219967148, -8.778313562401758, -23.461811585017134, -18.336443361658834, -14.898059923599607, -19.389646817113917], "episode_lengths": [400, 213, 209, 400, 121, 400, 220, 174, 221, 400, 106, 400, 94, 241, 10, 400, 170, 400, 400, 251, 111, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [38.08450066375536, -37.299447114720444, -24.77848037593403, 32.43473853089025, -32.490378520189026, 49.91632187456418, -30.443663039896226, -21.99026510577999, -19.829337428685765, 46.85729706997815, -23.066350745251036, 45.996778699086235, -24.693279255038348, -14.717331483904122, -5.187725210953799, 51.53148741076948, -25.40284484102589, 41.412922778358805, 36.24931174142111, -17.966108400372903, -15.115185309788359, 48.188129193937506, -26.33283448218887, 52.68356814141107, -10.177525975808788, 23.947318657665647, 27.808939249370994, -23.778058617618758, -18.403188065796165, 41.326047058974204, 33.7037581017663, 38.6848273672032, 33.52537900855636, -19.93871145733206, 28.072139390640146, 44.38796667952857, -38.13736765724177, -28.634876278459146, -9.751241198960434, 31.60703142569748, 28.7616336830579, 1.3228058311489383, 40.88703423910195, 48.449960154663366, -5.725915338942477, 29.952840035125764, -23.68998738812182, -11.639129580183639, 2.304513394207728, 46.810734812974374, 40.08768864724513, 8.896538713035353, 16.57258537161975, 19.58534741526314, -7.8481751515368, 3.851465597778583, 20.851839889450265, -5.281886889890966, 9.277402461944286, 10.429327466933362, 10.701221549192239, 18.014619723362657, 15.743440103500665, 22.10764214277731, 7.483131806820728, 3.4587234391410853, 10.91038202898262, 19.674129686797897, 17.030352746320098, 3.0867780537555607, 9.132814532464943, -12.623780373670503, 16.05340099133528, 26.105659992915253, -3.0818880351888716, -3.048706954411962, 17.662540283311397, -1.9496321898572848, 3.325446154939147, 6.862308701797264, -19.408664611598248, 18.51726508934287, 0.23815458711539605, 22.88869765424006, -6.063387982055771, 15.818653221556687, 9.29202155471463, 6.467820208791622, 5.3943699000148975, 10.25667242622319, 15.889259260834962, 11.508602540670072, 27.85298113789389, 10.91539141431585, -10.019430219967148, 8.778313562401761, 23.46181158501713, 18.336443361658834, 14.898059923599616, 19.389646817113917], "policy_adversary_policy_reward": [-49.44618369509697, -26.722817632413722, 36.741348232270454, 37.85754599717047, 26.07915770949397, 23.47780304237412, -18.392873627340308, -46.4766034344402, 31.567029470511876, 33.41372756986613, -42.07268789852222, -57.75995585060616, 30.388278372834197, 30.499047706958233, 9.710482115692898, 34.27004809586708, 23.761786345961234, 15.8968885114103, -39.32359407690996, -54.39100006304632, 18.302084075531052, 27.830617414971027, -38.362712057307284, -53.63084534086522, 13.995234376994624, 35.39132413308208, 6.282368579709755, 23.15229438809849, 0.7383126083780382, 9.63713781352956, -46.23901248531765, -56.823962336221264, 26.661932393564392, 24.143757288487397, -57.043323451291634, -25.78252210542602, -23.45244274407301, -49.04618073876923, 32.477629205441666, 3.4545875953041367, 23.625970471329687, 6.604400148247037, -46.656352880252214, -49.71990550762289, 25.527358370341023, 27.138310594036714, -44.907911666813554, -60.4592246160087, 15.571997278845457, 4.783054672772142, -28.885675562095777, -19.008961753235518, -29.666571762913826, -25.951306735828155, 29.356095009244264, 18.200022225993273, 15.018856293605637, 21.7875198379867, -45.75509015799496, -36.897003959953516, -36.90734165692947, -30.500174546603105, -36.346020371282066, -41.02363436312448, -32.39828753091192, -34.65247048620076, 30.725634912194973, 9.15178800246909, -34.17311384900787, -21.97116493227243, -42.84596325537344, -45.929970103683786, 45.91719798080144, 30.35753733368205, 24.15260122541623, 33.11715133150209, 3.6279814580525445, 15.874500939868305, -30.492684041528356, -32.7213788098666, -35.51536812602355, -22.00789924009225, 1.5910405106810295, -4.236652172978904, -23.773181244113395, -58.00088723409048, -50.53572278496693, -46.36419752435966, 8.686997565453078, 2.7648331124318677, -32.79455151808324, -27.11112855216826, 12.013529531679573, 35.36644524456406, 11.096076248188519, 12.182182912178764, 1.7556884632928416, -6.364715251708311, -49.53011454693661, -44.09135507901217, -40.88182464506207, -39.29355264942811, -8.162905412346447, -9.630172013724263, 3.0837132432707506, -36.22888398651025, -19.505706826730574, -19.664988003795706, -0.7895649121453001, 16.485915215218892, -0.2961643385003079, -7.4067668570568586, -7.6302099366514184, -34.07346984224908, -6.689095746304723, 17.252869526086656, -2.3216388120669933, -16.23316611182158, -23.568276632483794, 2.7096216986170703, -9.616241779657422, -11.786201318727056, -10.104148722012347, -25.925090724712973, -23.215743184376382, -8.271137022624949, -11.814986563600092, -32.40029772195452, -10.197518611966423, -4.768745001675036, 1.4859936642370926, -8.403440542519263, 3.801736593672018, -25.622500651637253, -14.265446312880378, -25.08281306071541, -10.336073312943128, -23.72463217969706, -6.578822060817483, 0.4052659533063636, -2.3672621896575166, -15.898366875272359, 9.678306009731724, 15.569254737609281, -23.01788330285951, -9.088918679811052, -32.08415821399476, -20.12716177183576, -8.988517570137688, 15.152293640515431, 4.129463927069118, 1.9679499817548063, -17.43844915132486, -17.886631415297934, 19.24800956830113, -15.348745188586559, 6.01943603605006, -12.670328345928354, 0.8869311931692039, -14.611548596763736, 29.473916254239235, 9.343412968957253, -32.9251246207556, -4.10940555793016, -13.136211449817871, 12.65990227558708, -26.441046722170363, -19.336348586309757, 11.870507837885832, 0.25626812622568806, -15.061760735646036, -16.575545707467338, -12.258858124816697, -6.325184984612569, -12.832048272509596, -0.10359214507364811, -11.151860792042754, 0.3631209920129592, -11.569823077844063, -8.943521774602317, -28.51891689498143, -3.259601626688493, 2.302440290984954, -25.3196453723251, -28.32152033986435, -27.384441935923462, -13.496664900702001, -8.334117927929707, 13.753564195823564, 6.285296244110732, -12.04318172216335, -5.513445402640169, -13.494476740289844, -33.42914642974442, -33.02125741561593, -3.6516293077017394, -3.2028887759880114, -26.593231071211203, -14.37853836031481, -24.40075527391302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4453695431044591, "mean_inference_ms": 1.1842975136100333, "mean_action_processing_ms": 0.19264549615030163, "mean_env_wait_ms": 0.07854496903996533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00408017635345459, "StateBufferConnector_ms": 0.0033485889434814453, "ViewRequirementAgentConnector_ms": 0.08633482456207275}, "num_episodes": 11, "episode_return_max": 38.13736765724169, "episode_return_min": -52.68356814141108, "episode_return_mean": -9.43202151659673}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.75246042170824, "num_env_steps_trained_throughput_per_sec": 452.75246042170824, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 9495.708, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9495.65, "sample_time_ms": 1002.391, "learn_time_ms": 8478.286, "learn_throughput": 471.793, "synch_weights_time_ms": 14.27}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "training_iteration": 41, "trial_id": "83a5c_00000", "date": "2024-08-10_12-19-50", "timestamp": 1723306790, "time_this_iter_s": 8.840678930282593, "time_total_s": 354.42831110954285, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fae5820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 354.42831110954285, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 31.23333333333333, "ram_util_percent": 80.32499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.844108484094105, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.575679613673498, "policy_loss": -0.0063406609461972956, "vf_loss": 4.581088804946375, "vf_explained_var": -0.5054770747820536, "kl": 0.014719480931734608, "entropy": 1.4650476023633645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0835903068383534, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.64559605071942, "policy_loss": -0.004671669106755871, "vf_loss": 3.649763135363658, "vf_explained_var": 0.20911932860811552, "kl": 0.011960344963585057, "entropy": 0.7996027600641052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 38.13736765724169, "episode_reward_min": -52.68356814141108, "episode_reward_mean": -11.004012413506004, "episode_len_mean": 384.77, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38477, "policy_reward_min": {"agent_policy": -38.13736765724177, "adversary_policy": -60.4592246160087}, "policy_reward_max": {"agent_policy": 52.68356814141107, "adversary_policy": 45.91719798080144}, "policy_reward_mean": {"agent_policy": 11.004012413506004, "adversary_policy": -11.004012413506008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.99677869908623, 24.693279255038345, 14.717331483904095, 5.187725210953799, -51.53148741076947, 25.40284484102589, -41.41292277835881, -36.24931174142109, 17.96610840037291, 15.115185309788348, -48.1881291939375, 26.332834482188886, -52.68356814141108, 10.177525975808798, -23.947318657665647, -27.808939249370994, 23.77805861761878, 18.40318806579616, -41.326047058974225, -33.70375810176629, -38.68482736720319, -33.52537900855635, 19.938711457332037, -28.072139390640153, -44.38796667952856, 38.13736765724169, 28.634876278459192, 9.751241198960443, -31.60703142569748, -28.7616336830579, -1.322805831148938, -40.88703423910196, -48.44996015466337, 5.725915338942468, -29.952840035125803, 23.689987388121892, 11.639129580183642, -2.304513394207733, -46.81073481297438, -40.08768864724514, -8.896538713035357, -16.57258537161975, -19.58534741526314, 7.848175151536806, -3.851465597778583, -20.851839889450257, 5.281886889890966, -9.277402461944286, -10.429327466933362, -10.701221549192237, -18.014619723362667, -15.743440103500664, -22.10764214277731, -7.4831318068207295, -3.4587234391410853, -10.910382028982623, -19.674129686797894, -17.030352746320098, -3.0867780537555607, -9.132814532464945, 12.623780373670504, -16.05340099133528, -26.105659992915257, 3.0818880351888716, 3.048706954411962, -17.66254028331142, 1.9496321898572848, -3.325446154939147, -6.862308701797264, 19.408664611598244, -18.51726508934289, -0.23815458711539605, -22.888697654240058, 6.063387982055762, -15.818653221556687, -9.29202155471464, -6.467820208791622, -5.3943699000148975, -10.25667242622319, -15.889259260834962, -11.508602540670072, -27.8529811378939, -10.91539141431585, 10.019430219967148, -8.778313562401758, -23.461811585017134, -18.336443361658834, -14.898059923599607, -19.389646817113917, -18.18567017786739, -18.318274198369526, -18.329948067348706, 3.3921925772429375, 13.601540003325267, -9.647640648570615, -10.804487742969751, -32.67803177984928, -20.67610276667873, -9.879662166419402, -13.067940532153566], "episode_lengths": [400, 94, 241, 10, 400, 170, 400, 400, 251, 111, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [45.996778699086235, -24.693279255038348, -14.717331483904122, -5.187725210953799, 51.53148741076948, -25.40284484102589, 41.412922778358805, 36.24931174142111, -17.966108400372903, -15.115185309788359, 48.188129193937506, -26.33283448218887, 52.68356814141107, -10.177525975808788, 23.947318657665647, 27.808939249370994, -23.778058617618758, -18.403188065796165, 41.326047058974204, 33.7037581017663, 38.6848273672032, 33.52537900855636, -19.93871145733206, 28.072139390640146, 44.38796667952857, -38.13736765724177, -28.634876278459146, -9.751241198960434, 31.60703142569748, 28.7616336830579, 1.3228058311489383, 40.88703423910195, 48.449960154663366, -5.725915338942477, 29.952840035125764, -23.68998738812182, -11.639129580183639, 2.304513394207728, 46.810734812974374, 40.08768864724513, 8.896538713035353, 16.57258537161975, 19.58534741526314, -7.8481751515368, 3.851465597778583, 20.851839889450265, -5.281886889890966, 9.277402461944286, 10.429327466933362, 10.701221549192239, 18.014619723362657, 15.743440103500665, 22.10764214277731, 7.483131806820728, 3.4587234391410853, 10.91038202898262, 19.674129686797897, 17.030352746320098, 3.0867780537555607, 9.132814532464943, -12.623780373670503, 16.05340099133528, 26.105659992915253, -3.0818880351888716, -3.048706954411962, 17.662540283311397, -1.9496321898572848, 3.325446154939147, 6.862308701797264, -19.408664611598248, 18.51726508934287, 0.23815458711539605, 22.88869765424006, -6.063387982055771, 15.818653221556687, 9.29202155471463, 6.467820208791622, 5.3943699000148975, 10.25667242622319, 15.889259260834962, 11.508602540670072, 27.85298113789389, 10.91539141431585, -10.019430219967148, 8.778313562401761, 23.46181158501713, 18.336443361658834, 14.898059923599616, 19.389646817113917, 18.1856701778674, 18.318274198369526, 18.329948067348695, -3.3921925772429375, -13.601540003325267, 9.647640648570615, 10.804487742969748, 32.678031779849256, 20.67610276667873, 9.879662166419402, 13.067940532153568], "policy_adversary_policy_reward": [-38.362712057307284, -53.63084534086522, 13.995234376994624, 35.39132413308208, 6.282368579709755, 23.15229438809849, 0.7383126083780382, 9.63713781352956, -46.23901248531765, -56.823962336221264, 26.661932393564392, 24.143757288487397, -57.043323451291634, -25.78252210542602, -23.45244274407301, -49.04618073876923, 32.477629205441666, 3.4545875953041367, 23.625970471329687, 6.604400148247037, -46.656352880252214, -49.71990550762289, 25.527358370341023, 27.138310594036714, -44.907911666813554, -60.4592246160087, 15.571997278845457, 4.783054672772142, -28.885675562095777, -19.008961753235518, -29.666571762913826, -25.951306735828155, 29.356095009244264, 18.200022225993273, 15.018856293605637, 21.7875198379867, -45.75509015799496, -36.897003959953516, -36.90734165692947, -30.500174546603105, -36.346020371282066, -41.02363436312448, -32.39828753091192, -34.65247048620076, 30.725634912194973, 9.15178800246909, -34.17311384900787, -21.97116493227243, -42.84596325537344, -45.929970103683786, 45.91719798080144, 30.35753733368205, 24.15260122541623, 33.11715133150209, 3.6279814580525445, 15.874500939868305, -30.492684041528356, -32.7213788098666, -35.51536812602355, -22.00789924009225, 1.5910405106810295, -4.236652172978904, -23.773181244113395, -58.00088723409048, -50.53572278496693, -46.36419752435966, 8.686997565453078, 2.7648331124318677, -32.79455151808324, -27.11112855216826, 12.013529531679573, 35.36644524456406, 11.096076248188519, 12.182182912178764, 1.7556884632928416, -6.364715251708311, -49.53011454693661, -44.09135507901217, -40.88182464506207, -39.29355264942811, -8.162905412346447, -9.630172013724263, 3.0837132432707506, -36.22888398651025, -19.505706826730574, -19.664988003795706, -0.7895649121453001, 16.485915215218892, -0.2961643385003079, -7.4067668570568586, -7.6302099366514184, -34.07346984224908, -6.689095746304723, 17.252869526086656, -2.3216388120669933, -16.23316611182158, -23.568276632483794, 2.7096216986170703, -9.616241779657422, -11.786201318727056, -10.104148722012347, -25.925090724712973, -23.215743184376382, -8.271137022624949, -11.814986563600092, -32.40029772195452, -10.197518611966423, -4.768745001675036, 1.4859936642370926, -8.403440542519263, 3.801736593672018, -25.622500651637253, -14.265446312880378, -25.08281306071541, -10.336073312943128, -23.72463217969706, -6.578822060817483, 0.4052659533063636, -2.3672621896575166, -15.898366875272359, 9.678306009731724, 15.569254737609281, -23.01788330285951, -9.088918679811052, -32.08415821399476, -20.12716177183576, -8.988517570137688, 15.152293640515431, 4.129463927069118, 1.9679499817548063, -17.43844915132486, -17.886631415297934, 19.24800956830113, -15.348745188586559, 6.01943603605006, -12.670328345928354, 0.8869311931692039, -14.611548596763736, 29.473916254239235, 9.343412968957253, -32.9251246207556, -4.10940555793016, -13.136211449817871, 12.65990227558708, -26.441046722170363, -19.336348586309757, 11.870507837885832, 0.25626812622568806, -15.061760735646036, -16.575545707467338, -12.258858124816697, -6.325184984612569, -12.832048272509596, -0.10359214507364811, -11.151860792042754, 0.3631209920129592, -11.569823077844063, -8.943521774602317, -28.51891689498143, -3.259601626688493, 2.302440290984954, -25.3196453723251, -28.32152033986435, -27.384441935923462, -13.496664900702001, -8.334117927929707, 13.753564195823564, 6.285296244110732, -12.04318172216335, -5.513445402640169, -13.494476740289844, -33.42914642974442, -33.02125741561593, -3.6516293077017394, -3.2028887759880114, -26.593231071211203, -14.37853836031481, -24.40075527391302, -24.358083159208363, -12.013257196526443, -15.86669694249111, -20.769851454247938, -22.957414129838842, -13.702482004858627, 4.827387139813936, 1.9569980146719388, 10.814357115540776, 16.388722891109737, 11.65356061261037, -30.9488419097516, -16.557655945100848, -5.051319540838655, -26.125831577627746, -39.230231982070705, -13.777400130264297, -27.574805403093166, -6.540285516527291, -13.219038816311514, -13.953609691681596, -12.18227137262554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4461581630831574, "mean_inference_ms": 1.1876969253078742, "mean_action_processing_ms": 0.19320950698260617, "mean_env_wait_ms": 0.07888109128710201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004200577735900879, "StateBufferConnector_ms": 0.0039043426513671875, "ViewRequirementAgentConnector_ms": 0.08903515338897705}, "num_episodes": 11, "episode_return_max": 38.13736765724169, "episode_return_min": -52.68356814141108, "episode_return_mean": -11.004012413506004}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.6083965839635, "num_env_steps_trained_throughput_per_sec": 449.6083965839635, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 9489.451, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9489.396, "sample_time_ms": 970.787, "learn_time_ms": 8504.304, "learn_throughput": 470.35, "synch_weights_time_ms": 13.668}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 42, "trial_id": "83a5c_00000", "date": "2024-08-10_12-19-59", "timestamp": 1723306799, "time_this_iter_s": 8.906705141067505, "time_total_s": 363.33501625061035, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a6dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 363.33501625061035, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 36.146153846153844, "ram_util_percent": 80.52307692307691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1594504986175154, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.587534304396816, "policy_loss": -0.006678399128011532, "vf_loss": 3.593255095885544, "vf_explained_var": -0.02462965729375365, "kl": 0.015132500578632125, "entropy": 1.4894046611256069, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3346801191568374, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.853916742652655, "policy_loss": -0.001866807768237777, "vf_loss": 2.8554407970358926, "vf_explained_var": 0.451465859139959, "kl": 0.008124828544888866, "entropy": 0.7712016822149356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "env_runners": {"episode_reward_max": 38.13736765724169, "episode_reward_min": -52.68356814141108, "episode_reward_mean": -11.169571469673174, "episode_len_mean": 397.11, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39711, "policy_reward_min": {"agent_policy": -38.13736765724177, "adversary_policy": -60.4592246160087}, "policy_reward_max": {"agent_policy": 52.68356814141107, "adversary_policy": 45.91719798080144}, "policy_reward_mean": {"agent_policy": 11.169571469673174, "adversary_policy": -11.169571469673174}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.115185309788348, -48.1881291939375, 26.332834482188886, -52.68356814141108, 10.177525975808798, -23.947318657665647, -27.808939249370994, 23.77805861761878, 18.40318806579616, -41.326047058974225, -33.70375810176629, -38.68482736720319, -33.52537900855635, 19.938711457332037, -28.072139390640153, -44.38796667952856, 38.13736765724169, 28.634876278459192, 9.751241198960443, -31.60703142569748, -28.7616336830579, -1.322805831148938, -40.88703423910196, -48.44996015466337, 5.725915338942468, -29.952840035125803, 23.689987388121892, 11.639129580183642, -2.304513394207733, -46.81073481297438, -40.08768864724514, -8.896538713035357, -16.57258537161975, -19.58534741526314, 7.848175151536806, -3.851465597778583, -20.851839889450257, 5.281886889890966, -9.277402461944286, -10.429327466933362, -10.701221549192237, -18.014619723362667, -15.743440103500664, -22.10764214277731, -7.4831318068207295, -3.4587234391410853, -10.910382028982623, -19.674129686797894, -17.030352746320098, -3.0867780537555607, -9.132814532464945, 12.623780373670504, -16.05340099133528, -26.105659992915257, 3.0818880351888716, 3.048706954411962, -17.66254028331142, 1.9496321898572848, -3.325446154939147, -6.862308701797264, 19.408664611598244, -18.51726508934289, -0.23815458711539605, -22.888697654240058, 6.063387982055762, -15.818653221556687, -9.29202155471464, -6.467820208791622, -5.3943699000148975, -10.25667242622319, -15.889259260834962, -11.508602540670072, -27.8529811378939, -10.91539141431585, 10.019430219967148, -8.778313562401758, -23.461811585017134, -18.336443361658834, -14.898059923599607, -19.389646817113917, -18.18567017786739, -18.318274198369526, -18.329948067348706, 3.3921925772429375, 13.601540003325267, -9.647640648570615, -10.804487742969751, -32.67803177984928, -20.67610276667873, -9.879662166419402, -13.067940532153566, -30.62075729209392, -8.236748850220602, -17.233470906812, 9.76152324738938, -15.305735478129863, -15.792307725709353, -10.703649387094064, -24.48166634926254, 8.83369568687548], "episode_lengths": [111, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-15.115185309788359, 48.188129193937506, -26.33283448218887, 52.68356814141107, -10.177525975808788, 23.947318657665647, 27.808939249370994, -23.778058617618758, -18.403188065796165, 41.326047058974204, 33.7037581017663, 38.6848273672032, 33.52537900855636, -19.93871145733206, 28.072139390640146, 44.38796667952857, -38.13736765724177, -28.634876278459146, -9.751241198960434, 31.60703142569748, 28.7616336830579, 1.3228058311489383, 40.88703423910195, 48.449960154663366, -5.725915338942477, 29.952840035125764, -23.68998738812182, -11.639129580183639, 2.304513394207728, 46.810734812974374, 40.08768864724513, 8.896538713035353, 16.57258537161975, 19.58534741526314, -7.8481751515368, 3.851465597778583, 20.851839889450265, -5.281886889890966, 9.277402461944286, 10.429327466933362, 10.701221549192239, 18.014619723362657, 15.743440103500665, 22.10764214277731, 7.483131806820728, 3.4587234391410853, 10.91038202898262, 19.674129686797897, 17.030352746320098, 3.0867780537555607, 9.132814532464943, -12.623780373670503, 16.05340099133528, 26.105659992915253, -3.0818880351888716, -3.048706954411962, 17.662540283311397, -1.9496321898572848, 3.325446154939147, 6.862308701797264, -19.408664611598248, 18.51726508934287, 0.23815458711539605, 22.88869765424006, -6.063387982055771, 15.818653221556687, 9.29202155471463, 6.467820208791622, 5.3943699000148975, 10.25667242622319, 15.889259260834962, 11.508602540670072, 27.85298113789389, 10.91539141431585, -10.019430219967148, 8.778313562401761, 23.46181158501713, 18.336443361658834, 14.898059923599616, 19.389646817113917, 18.1856701778674, 18.318274198369526, 18.329948067348695, -3.3921925772429375, -13.601540003325267, 9.647640648570615, 10.804487742969748, 32.678031779849256, 20.67610276667873, 9.879662166419402, 13.067940532153568, 30.620757292093884, 8.2367488502206, 17.233470906812, -9.76152324738938, 15.305735478129892, 15.792307725709353, 10.703649387094064, 24.481666349262543, -8.833695686875473], "policy_adversary_policy_reward": [23.625970471329687, 6.604400148247037, -46.656352880252214, -49.71990550762289, 25.527358370341023, 27.138310594036714, -44.907911666813554, -60.4592246160087, 15.571997278845457, 4.783054672772142, -28.885675562095777, -19.008961753235518, -29.666571762913826, -25.951306735828155, 29.356095009244264, 18.200022225993273, 15.018856293605637, 21.7875198379867, -45.75509015799496, -36.897003959953516, -36.90734165692947, -30.500174546603105, -36.346020371282066, -41.02363436312448, -32.39828753091192, -34.65247048620076, 30.725634912194973, 9.15178800246909, -34.17311384900787, -21.97116493227243, -42.84596325537344, -45.929970103683786, 45.91719798080144, 30.35753733368205, 24.15260122541623, 33.11715133150209, 3.6279814580525445, 15.874500939868305, -30.492684041528356, -32.7213788098666, -35.51536812602355, -22.00789924009225, 1.5910405106810295, -4.236652172978904, -23.773181244113395, -58.00088723409048, -50.53572278496693, -46.36419752435966, 8.686997565453078, 2.7648331124318677, -32.79455151808324, -27.11112855216826, 12.013529531679573, 35.36644524456406, 11.096076248188519, 12.182182912178764, 1.7556884632928416, -6.364715251708311, -49.53011454693661, -44.09135507901217, -40.88182464506207, -39.29355264942811, -8.162905412346447, -9.630172013724263, 3.0837132432707506, -36.22888398651025, -19.505706826730574, -19.664988003795706, -0.7895649121453001, 16.485915215218892, -0.2961643385003079, -7.4067668570568586, -7.6302099366514184, -34.07346984224908, -6.689095746304723, 17.252869526086656, -2.3216388120669933, -16.23316611182158, -23.568276632483794, 2.7096216986170703, -9.616241779657422, -11.786201318727056, -10.104148722012347, -25.925090724712973, -23.215743184376382, -8.271137022624949, -11.814986563600092, -32.40029772195452, -10.197518611966423, -4.768745001675036, 1.4859936642370926, -8.403440542519263, 3.801736593672018, -25.622500651637253, -14.265446312880378, -25.08281306071541, -10.336073312943128, -23.72463217969706, -6.578822060817483, 0.4052659533063636, -2.3672621896575166, -15.898366875272359, 9.678306009731724, 15.569254737609281, -23.01788330285951, -9.088918679811052, -32.08415821399476, -20.12716177183576, -8.988517570137688, 15.152293640515431, 4.129463927069118, 1.9679499817548063, -17.43844915132486, -17.886631415297934, 19.24800956830113, -15.348745188586559, 6.01943603605006, -12.670328345928354, 0.8869311931692039, -14.611548596763736, 29.473916254239235, 9.343412968957253, -32.9251246207556, -4.10940555793016, -13.136211449817871, 12.65990227558708, -26.441046722170363, -19.336348586309757, 11.870507837885832, 0.25626812622568806, -15.061760735646036, -16.575545707467338, -12.258858124816697, -6.325184984612569, -12.832048272509596, -0.10359214507364811, -11.151860792042754, 0.3631209920129592, -11.569823077844063, -8.943521774602317, -28.51891689498143, -3.259601626688493, 2.302440290984954, -25.3196453723251, -28.32152033986435, -27.384441935923462, -13.496664900702001, -8.334117927929707, 13.753564195823564, 6.285296244110732, -12.04318172216335, -5.513445402640169, -13.494476740289844, -33.42914642974442, -33.02125741561593, -3.6516293077017394, -3.2028887759880114, -26.593231071211203, -14.37853836031481, -24.40075527391302, -24.358083159208363, -12.013257196526443, -15.86669694249111, -20.769851454247938, -22.957414129838842, -13.702482004858627, 4.827387139813936, 1.9569980146719388, 10.814357115540776, 16.388722891109737, 11.65356061261037, -30.9488419097516, -16.557655945100848, -5.051319540838655, -26.125831577627746, -39.230231982070705, -13.777400130264297, -27.574805403093166, -6.540285516527291, -13.219038816311514, -13.953609691681596, -12.18227137262554, -23.668463249834502, -37.573051334353266, -26.719098336280688, 10.245600635839487, -12.907381981623057, -21.55955983200094, 16.873207542726867, 2.649838952051894, -17.946817787914753, -12.66465316834504, -30.033511145505578, -1.5511043059131282, -11.581132283919278, -9.82616649026885, -36.33734585926457, -12.625986839260499, -3.358988984120227, 21.026380357871176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4471821162609084, "mean_inference_ms": 1.1914349171921113, "mean_action_processing_ms": 0.1938726062424724, "mean_env_wait_ms": 0.07910479680348426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004259824752807617, "StateBufferConnector_ms": 0.003920435905456543, "ViewRequirementAgentConnector_ms": 0.09356141090393066}, "num_episodes": 9, "episode_return_max": 38.13736765724169, "episode_return_min": -52.68356814141108, "episode_return_mean": -11.169571469673174}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 415.4859014969583, "num_env_steps_trained_throughput_per_sec": 415.4859014969583, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 9108.04, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9107.988, "sample_time_ms": 1018.375, "learn_time_ms": 8077.566, "learn_throughput": 495.199, "synch_weights_time_ms": 11.598}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "training_iteration": 43, "trial_id": "83a5c_00000", "date": "2024-08-10_12-20-09", "timestamp": 1723306809, "time_this_iter_s": 9.632569074630737, "time_total_s": 372.9675853252411, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f570b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 372.9675853252411, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 44.66428571428571, "ram_util_percent": 81.4357142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4368361107571417, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.434192324315429, "policy_loss": -0.005238728880852697, "vf_loss": 4.438512399335387, "vf_explained_var": -0.07231026481068324, "kl": 0.014516961353197804, "entropy": 1.4923792186237517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3930488319757086, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.777243573466937, "policy_loss": -0.006900550815529035, "vf_loss": 2.783692765732606, "vf_explained_var": 0.46846977894504865, "kl": 0.010698546868601921, "entropy": 0.7680807030449311, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 38.13736765724169, "episode_reward_min": -48.44996015466337, "episode_reward_mean": -11.99044066117068, "episode_len_mean": 400.0, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 40000, "policy_reward_min": {"agent_policy": -38.13736765724177, "adversary_policy": -58.00088723409048}, "policy_reward_max": {"agent_policy": 48.449960154663366, "adversary_policy": 45.91719798080144}, "policy_reward_mean": {"agent_policy": 11.990440661170679, "adversary_policy": -11.99044066117068}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.326047058974225, -33.70375810176629, -38.68482736720319, -33.52537900855635, 19.938711457332037, -28.072139390640153, -44.38796667952856, 38.13736765724169, 28.634876278459192, 9.751241198960443, -31.60703142569748, -28.7616336830579, -1.322805831148938, -40.88703423910196, -48.44996015466337, 5.725915338942468, -29.952840035125803, 23.689987388121892, 11.639129580183642, -2.304513394207733, -46.81073481297438, -40.08768864724514, -8.896538713035357, -16.57258537161975, -19.58534741526314, 7.848175151536806, -3.851465597778583, -20.851839889450257, 5.281886889890966, -9.277402461944286, -10.429327466933362, -10.701221549192237, -18.014619723362667, -15.743440103500664, -22.10764214277731, -7.4831318068207295, -3.4587234391410853, -10.910382028982623, -19.674129686797894, -17.030352746320098, -3.0867780537555607, -9.132814532464945, 12.623780373670504, -16.05340099133528, -26.105659992915257, 3.0818880351888716, 3.048706954411962, -17.66254028331142, 1.9496321898572848, -3.325446154939147, -6.862308701797264, 19.408664611598244, -18.51726508934289, -0.23815458711539605, -22.888697654240058, 6.063387982055762, -15.818653221556687, -9.29202155471464, -6.467820208791622, -5.3943699000148975, -10.25667242622319, -15.889259260834962, -11.508602540670072, -27.8529811378939, -10.91539141431585, 10.019430219967148, -8.778313562401758, -23.461811585017134, -18.336443361658834, -14.898059923599607, -19.389646817113917, -18.18567017786739, -18.318274198369526, -18.329948067348706, 3.3921925772429375, 13.601540003325267, -9.647640648570615, -10.804487742969751, -32.67803177984928, -20.67610276667873, -9.879662166419402, -13.067940532153566, -30.62075729209392, -8.236748850220602, -17.233470906812, 9.76152324738938, -15.305735478129863, -15.792307725709353, -10.703649387094064, -24.48166634926254, 8.83369568687548, -12.818702304286935, -24.978740637798442, -16.643707278197244, -18.431768215277472, -14.946283070093346, -12.337910303231848, -16.143328868510345, -19.204529910467958, -5.403111353071409], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [41.326047058974204, 33.7037581017663, 38.6848273672032, 33.52537900855636, -19.93871145733206, 28.072139390640146, 44.38796667952857, -38.13736765724177, -28.634876278459146, -9.751241198960434, 31.60703142569748, 28.7616336830579, 1.3228058311489383, 40.88703423910195, 48.449960154663366, -5.725915338942477, 29.952840035125764, -23.68998738812182, -11.639129580183639, 2.304513394207728, 46.810734812974374, 40.08768864724513, 8.896538713035353, 16.57258537161975, 19.58534741526314, -7.8481751515368, 3.851465597778583, 20.851839889450265, -5.281886889890966, 9.277402461944286, 10.429327466933362, 10.701221549192239, 18.014619723362657, 15.743440103500665, 22.10764214277731, 7.483131806820728, 3.4587234391410853, 10.91038202898262, 19.674129686797897, 17.030352746320098, 3.0867780537555607, 9.132814532464943, -12.623780373670503, 16.05340099133528, 26.105659992915253, -3.0818880351888716, -3.048706954411962, 17.662540283311397, -1.9496321898572848, 3.325446154939147, 6.862308701797264, -19.408664611598248, 18.51726508934287, 0.23815458711539605, 22.88869765424006, -6.063387982055771, 15.818653221556687, 9.29202155471463, 6.467820208791622, 5.3943699000148975, 10.25667242622319, 15.889259260834962, 11.508602540670072, 27.85298113789389, 10.91539141431585, -10.019430219967148, 8.778313562401761, 23.46181158501713, 18.336443361658834, 14.898059923599616, 19.389646817113917, 18.1856701778674, 18.318274198369526, 18.329948067348695, -3.3921925772429375, -13.601540003325267, 9.647640648570615, 10.804487742969748, 32.678031779849256, 20.67610276667873, 9.879662166419402, 13.067940532153568, 30.620757292093884, 8.2367488502206, 17.233470906812, -9.76152324738938, 15.305735478129892, 15.792307725709353, 10.703649387094064, 24.481666349262543, -8.833695686875473, 12.818702304286939, 24.978740637798445, 16.64370727819725, 18.431768215277472, 14.946283070093349, 12.337910303231848, 16.143328868510352, 19.20452991046796, 5.403111353071409], "policy_adversary_policy_reward": [-45.75509015799496, -36.897003959953516, -36.90734165692947, -30.500174546603105, -36.346020371282066, -41.02363436312448, -32.39828753091192, -34.65247048620076, 30.725634912194973, 9.15178800246909, -34.17311384900787, -21.97116493227243, -42.84596325537344, -45.929970103683786, 45.91719798080144, 30.35753733368205, 24.15260122541623, 33.11715133150209, 3.6279814580525445, 15.874500939868305, -30.492684041528356, -32.7213788098666, -35.51536812602355, -22.00789924009225, 1.5910405106810295, -4.236652172978904, -23.773181244113395, -58.00088723409048, -50.53572278496693, -46.36419752435966, 8.686997565453078, 2.7648331124318677, -32.79455151808324, -27.11112855216826, 12.013529531679573, 35.36644524456406, 11.096076248188519, 12.182182912178764, 1.7556884632928416, -6.364715251708311, -49.53011454693661, -44.09135507901217, -40.88182464506207, -39.29355264942811, -8.162905412346447, -9.630172013724263, 3.0837132432707506, -36.22888398651025, -19.505706826730574, -19.664988003795706, -0.7895649121453001, 16.485915215218892, -0.2961643385003079, -7.4067668570568586, -7.6302099366514184, -34.07346984224908, -6.689095746304723, 17.252869526086656, -2.3216388120669933, -16.23316611182158, -23.568276632483794, 2.7096216986170703, -9.616241779657422, -11.786201318727056, -10.104148722012347, -25.925090724712973, -23.215743184376382, -8.271137022624949, -11.814986563600092, -32.40029772195452, -10.197518611966423, -4.768745001675036, 1.4859936642370926, -8.403440542519263, 3.801736593672018, -25.622500651637253, -14.265446312880378, -25.08281306071541, -10.336073312943128, -23.72463217969706, -6.578822060817483, 0.4052659533063636, -2.3672621896575166, -15.898366875272359, 9.678306009731724, 15.569254737609281, -23.01788330285951, -9.088918679811052, -32.08415821399476, -20.12716177183576, -8.988517570137688, 15.152293640515431, 4.129463927069118, 1.9679499817548063, -17.43844915132486, -17.886631415297934, 19.24800956830113, -15.348745188586559, 6.01943603605006, -12.670328345928354, 0.8869311931692039, -14.611548596763736, 29.473916254239235, 9.343412968957253, -32.9251246207556, -4.10940555793016, -13.136211449817871, 12.65990227558708, -26.441046722170363, -19.336348586309757, 11.870507837885832, 0.25626812622568806, -15.061760735646036, -16.575545707467338, -12.258858124816697, -6.325184984612569, -12.832048272509596, -0.10359214507364811, -11.151860792042754, 0.3631209920129592, -11.569823077844063, -8.943521774602317, -28.51891689498143, -3.259601626688493, 2.302440290984954, -25.3196453723251, -28.32152033986435, -27.384441935923462, -13.496664900702001, -8.334117927929707, 13.753564195823564, 6.285296244110732, -12.04318172216335, -5.513445402640169, -13.494476740289844, -33.42914642974442, -33.02125741561593, -3.6516293077017394, -3.2028887759880114, -26.593231071211203, -14.37853836031481, -24.40075527391302, -24.358083159208363, -12.013257196526443, -15.86669694249111, -20.769851454247938, -22.957414129838842, -13.702482004858627, 4.827387139813936, 1.9569980146719388, 10.814357115540776, 16.388722891109737, 11.65356061261037, -30.9488419097516, -16.557655945100848, -5.051319540838655, -26.125831577627746, -39.230231982070705, -13.777400130264297, -27.574805403093166, -6.540285516527291, -13.219038816311514, -13.953609691681596, -12.18227137262554, -23.668463249834502, -37.573051334353266, -26.719098336280688, 10.245600635839487, -12.907381981623057, -21.55955983200094, 16.873207542726867, 2.649838952051894, -17.946817787914753, -12.66465316834504, -30.033511145505578, -1.5511043059131282, -11.581132283919278, -9.82616649026885, -36.33734585926457, -12.625986839260499, -3.358988984120227, 21.026380357871176, -12.994166103792232, -12.643238504781639, -24.65172646956419, -25.305754806032688, -29.272574727717725, -4.014839828676781, -10.592313084342038, -26.271223346212903, -14.238871675415467, -15.65369446477122, -12.974376551114116, -11.701444055349576, -6.512919933979308, -25.77373780304138, -31.597399608327038, -6.811660212608903, -7.796681281536706, -3.0095414246061125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44759268509586386, "mean_inference_ms": 1.192815987244932, "mean_action_processing_ms": 0.1941576995142316, "mean_env_wait_ms": 0.07925342767398764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003945827484130859, "StateBufferConnector_ms": 0.003916144371032715, "ViewRequirementAgentConnector_ms": 0.09396469593048096}, "num_episodes": 9, "episode_return_max": 38.13736765724169, "episode_return_min": -48.44996015466337, "episode_return_mean": -11.99044066117068}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.10696189676923, "num_env_steps_trained_throughput_per_sec": 452.10696189676923, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 9021.863, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9021.825, "sample_time_ms": 951.458, "learn_time_ms": 8058.271, "learn_throughput": 496.384, "synch_weights_time_ms": 11.652}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 44, "trial_id": "83a5c_00000", "date": "2024-08-10_12-20-17", "timestamp": 1723306817, "time_this_iter_s": 8.852339267730713, "time_total_s": 381.8199245929718, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5c90d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 381.8199245929718, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 33.26666666666667, "ram_util_percent": 81.29166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2120219489884754, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9979261065286305, "policy_loss": -0.007255165097389922, "vf_loss": 4.004611456457269, "vf_explained_var": -0.04346453046041822, "kl": 0.00900437830449236, "entropy": 1.4846497232321079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3099529409160215, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8066723313182593, "policy_loss": -0.00660885052542047, "vf_loss": 2.812707916398843, "vf_explained_var": 0.29731843452900647, "kl": 0.013588508517152023, "entropy": 0.859379885904491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "env_runners": {"episode_reward_max": 23.689987388121892, "episode_reward_min": -48.44996015466337, "episode_reward_mean": -11.625473914412341, "episode_len_mean": 396.23, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39623, "policy_reward_min": {"agent_policy": -23.68998738812182, "adversary_policy": -58.00088723409048}, "policy_reward_max": {"agent_policy": 48.449960154663366, "adversary_policy": 35.36644524456406}, "policy_reward_mean": {"agent_policy": 11.625473914412341, "adversary_policy": -11.62547391441234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.60703142569748, -28.7616336830579, -1.322805831148938, -40.88703423910196, -48.44996015466337, 5.725915338942468, -29.952840035125803, 23.689987388121892, 11.639129580183642, -2.304513394207733, -46.81073481297438, -40.08768864724514, -8.896538713035357, -16.57258537161975, -19.58534741526314, 7.848175151536806, -3.851465597778583, -20.851839889450257, 5.281886889890966, -9.277402461944286, -10.429327466933362, -10.701221549192237, -18.014619723362667, -15.743440103500664, -22.10764214277731, -7.4831318068207295, -3.4587234391410853, -10.910382028982623, -19.674129686797894, -17.030352746320098, -3.0867780537555607, -9.132814532464945, 12.623780373670504, -16.05340099133528, -26.105659992915257, 3.0818880351888716, 3.048706954411962, -17.66254028331142, 1.9496321898572848, -3.325446154939147, -6.862308701797264, 19.408664611598244, -18.51726508934289, -0.23815458711539605, -22.888697654240058, 6.063387982055762, -15.818653221556687, -9.29202155471464, -6.467820208791622, -5.3943699000148975, -10.25667242622319, -15.889259260834962, -11.508602540670072, -27.8529811378939, -10.91539141431585, 10.019430219967148, -8.778313562401758, -23.461811585017134, -18.336443361658834, -14.898059923599607, -19.389646817113917, -18.18567017786739, -18.318274198369526, -18.329948067348706, 3.3921925772429375, 13.601540003325267, -9.647640648570615, -10.804487742969751, -32.67803177984928, -20.67610276667873, -9.879662166419402, -13.067940532153566, -30.62075729209392, -8.236748850220602, -17.233470906812, 9.76152324738938, -15.305735478129863, -15.792307725709353, -10.703649387094064, -24.48166634926254, 8.83369568687548, -12.818702304286935, -24.978740637798442, -16.643707278197244, -18.431768215277472, -14.946283070093346, -12.337910303231848, -16.143328868510345, -19.204529910467958, -5.403111353071409, -12.5094715646153, -12.21150720997915, 0.8812564074706746, -22.95419551970238, 22.49216610736979, -5.29574275743466, -0.6479577091859063, -20.798072642451377, -18.49448730307298, -17.20323414724022], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [31.60703142569748, 28.7616336830579, 1.3228058311489383, 40.88703423910195, 48.449960154663366, -5.725915338942477, 29.952840035125764, -23.68998738812182, -11.639129580183639, 2.304513394207728, 46.810734812974374, 40.08768864724513, 8.896538713035353, 16.57258537161975, 19.58534741526314, -7.8481751515368, 3.851465597778583, 20.851839889450265, -5.281886889890966, 9.277402461944286, 10.429327466933362, 10.701221549192239, 18.014619723362657, 15.743440103500665, 22.10764214277731, 7.483131806820728, 3.4587234391410853, 10.91038202898262, 19.674129686797897, 17.030352746320098, 3.0867780537555607, 9.132814532464943, -12.623780373670503, 16.05340099133528, 26.105659992915253, -3.0818880351888716, -3.048706954411962, 17.662540283311397, -1.9496321898572848, 3.325446154939147, 6.862308701797264, -19.408664611598248, 18.51726508934287, 0.23815458711539605, 22.88869765424006, -6.063387982055771, 15.818653221556687, 9.29202155471463, 6.467820208791622, 5.3943699000148975, 10.25667242622319, 15.889259260834962, 11.508602540670072, 27.85298113789389, 10.91539141431585, -10.019430219967148, 8.778313562401761, 23.46181158501713, 18.336443361658834, 14.898059923599616, 19.389646817113917, 18.1856701778674, 18.318274198369526, 18.329948067348695, -3.3921925772429375, -13.601540003325267, 9.647640648570615, 10.804487742969748, 32.678031779849256, 20.67610276667873, 9.879662166419402, 13.067940532153568, 30.620757292093884, 8.2367488502206, 17.233470906812, -9.76152324738938, 15.305735478129892, 15.792307725709353, 10.703649387094064, 24.481666349262543, -8.833695686875473, 12.818702304286939, 24.978740637798445, 16.64370727819725, 18.431768215277472, 14.946283070093349, 12.337910303231848, 16.143328868510352, 19.20452991046796, 5.403111353071409, 12.5094715646153, 12.21150720997915, -0.8812564074706746, 22.954195519702385, -22.492166107369787, 5.29574275743466, 0.6479577091859063, 20.798072642451373, 18.494487303072976, 17.20323414724023], "policy_adversary_policy_reward": [-30.492684041528356, -32.7213788098666, -35.51536812602355, -22.00789924009225, 1.5910405106810295, -4.236652172978904, -23.773181244113395, -58.00088723409048, -50.53572278496693, -46.36419752435966, 8.686997565453078, 2.7648331124318677, -32.79455151808324, -27.11112855216826, 12.013529531679573, 35.36644524456406, 11.096076248188519, 12.182182912178764, 1.7556884632928416, -6.364715251708311, -49.53011454693661, -44.09135507901217, -40.88182464506207, -39.29355264942811, -8.162905412346447, -9.630172013724263, 3.0837132432707506, -36.22888398651025, -19.505706826730574, -19.664988003795706, -0.7895649121453001, 16.485915215218892, -0.2961643385003079, -7.4067668570568586, -7.6302099366514184, -34.07346984224908, -6.689095746304723, 17.252869526086656, -2.3216388120669933, -16.23316611182158, -23.568276632483794, 2.7096216986170703, -9.616241779657422, -11.786201318727056, -10.104148722012347, -25.925090724712973, -23.215743184376382, -8.271137022624949, -11.814986563600092, -32.40029772195452, -10.197518611966423, -4.768745001675036, 1.4859936642370926, -8.403440542519263, 3.801736593672018, -25.622500651637253, -14.265446312880378, -25.08281306071541, -10.336073312943128, -23.72463217969706, -6.578822060817483, 0.4052659533063636, -2.3672621896575166, -15.898366875272359, 9.678306009731724, 15.569254737609281, -23.01788330285951, -9.088918679811052, -32.08415821399476, -20.12716177183576, -8.988517570137688, 15.152293640515431, 4.129463927069118, 1.9679499817548063, -17.43844915132486, -17.886631415297934, 19.24800956830113, -15.348745188586559, 6.01943603605006, -12.670328345928354, 0.8869311931692039, -14.611548596763736, 29.473916254239235, 9.343412968957253, -32.9251246207556, -4.10940555793016, -13.136211449817871, 12.65990227558708, -26.441046722170363, -19.336348586309757, 11.870507837885832, 0.25626812622568806, -15.061760735646036, -16.575545707467338, -12.258858124816697, -6.325184984612569, -12.832048272509596, -0.10359214507364811, -11.151860792042754, 0.3631209920129592, -11.569823077844063, -8.943521774602317, -28.51891689498143, -3.259601626688493, 2.302440290984954, -25.3196453723251, -28.32152033986435, -27.384441935923462, -13.496664900702001, -8.334117927929707, 13.753564195823564, 6.285296244110732, -12.04318172216335, -5.513445402640169, -13.494476740289844, -33.42914642974442, -33.02125741561593, -3.6516293077017394, -3.2028887759880114, -26.593231071211203, -14.37853836031481, -24.40075527391302, -24.358083159208363, -12.013257196526443, -15.86669694249111, -20.769851454247938, -22.957414129838842, -13.702482004858627, 4.827387139813936, 1.9569980146719388, 10.814357115540776, 16.388722891109737, 11.65356061261037, -30.9488419097516, -16.557655945100848, -5.051319540838655, -26.125831577627746, -39.230231982070705, -13.777400130264297, -27.574805403093166, -6.540285516527291, -13.219038816311514, -13.953609691681596, -12.18227137262554, -23.668463249834502, -37.573051334353266, -26.719098336280688, 10.245600635839487, -12.907381981623057, -21.55955983200094, 16.873207542726867, 2.649838952051894, -17.946817787914753, -12.66465316834504, -30.033511145505578, -1.5511043059131282, -11.581132283919278, -9.82616649026885, -36.33734585926457, -12.625986839260499, -3.358988984120227, 21.026380357871176, -12.994166103792232, -12.643238504781639, -24.65172646956419, -25.305754806032688, -29.272574727717725, -4.014839828676781, -10.592313084342038, -26.271223346212903, -14.238871675415467, -15.65369446477122, -12.974376551114116, -11.701444055349576, -6.512919933979308, -25.77373780304138, -31.597399608327038, -6.811660212608903, -7.796681281536706, -3.0095414246061125, -27.14059341475042, 2.12165028551982, -18.370824159336912, -6.052190260621387, -5.973318652044988, 7.735831466986337, -33.447263753258255, -12.461127286146507, 10.230679234226926, 34.75365298051265, -23.865717091832202, 13.274231576962883, 6.884600617231975, -8.180516035603787, -25.63447608150072, -15.961669203402025, -6.783485362110433, -30.20548924403552, -3.8848600130256727, -30.521608281454775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44792609255587074, "mean_inference_ms": 1.1939811140314465, "mean_action_processing_ms": 0.19440472755201388, "mean_env_wait_ms": 0.07939366630886333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003960847854614258, "StateBufferConnector_ms": 0.003281712532043457, "ViewRequirementAgentConnector_ms": 0.09474503993988037}, "num_episodes": 10, "episode_return_max": 23.689987388121892, "episode_return_min": -48.44996015466337, "episode_return_mean": -11.625473914412341}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.18122905136687, "num_env_steps_trained_throughput_per_sec": 446.18122905136687, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 9046.642, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9046.607, "sample_time_ms": 950.753, "learn_time_ms": 8083.798, "learn_throughput": 494.817, "synch_weights_time_ms": 11.613}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "training_iteration": 45, "trial_id": "83a5c_00000", "date": "2024-08-10_12-20-26", "timestamp": 1723306826, "time_this_iter_s": 9.004632949829102, "time_total_s": 390.8245575428009, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f635dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 390.8245575428009, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 31.976923076923075, "ram_util_percent": 81.20769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3582814671690504, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.04747053983981, "policy_loss": -0.006735487898723001, "vf_loss": 4.053114699308203, "vf_explained_var": -0.032999065881052975, "kl": 0.017245633237448103, "entropy": 1.468659151924981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4786795135277013, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2069019148747127, "policy_loss": -0.004691247186565306, "vf_loss": 3.2111482647558054, "vf_explained_var": 0.2680650306865573, "kl": 0.0105457250030535, "entropy": 0.8619089718908072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 22.49216610736979, "episode_reward_min": -46.81073481297438, "episode_reward_mean": -11.027948756876802, "episode_len_mean": 396.23, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 39623, "policy_reward_min": {"agent_policy": -22.492166107369787, "adversary_policy": -49.53011454693661}, "policy_reward_max": {"agent_policy": 46.810734812974374, "adversary_policy": 34.75365298051265}, "policy_reward_mean": {"agent_policy": 11.027948756876802, "adversary_policy": -11.027948756876802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.81073481297438, -40.08768864724514, -8.896538713035357, -16.57258537161975, -19.58534741526314, 7.848175151536806, -3.851465597778583, -20.851839889450257, 5.281886889890966, -9.277402461944286, -10.429327466933362, -10.701221549192237, -18.014619723362667, -15.743440103500664, -22.10764214277731, -7.4831318068207295, -3.4587234391410853, -10.910382028982623, -19.674129686797894, -17.030352746320098, -3.0867780537555607, -9.132814532464945, 12.623780373670504, -16.05340099133528, -26.105659992915257, 3.0818880351888716, 3.048706954411962, -17.66254028331142, 1.9496321898572848, -3.325446154939147, -6.862308701797264, 19.408664611598244, -18.51726508934289, -0.23815458711539605, -22.888697654240058, 6.063387982055762, -15.818653221556687, -9.29202155471464, -6.467820208791622, -5.3943699000148975, -10.25667242622319, -15.889259260834962, -11.508602540670072, -27.8529811378939, -10.91539141431585, 10.019430219967148, -8.778313562401758, -23.461811585017134, -18.336443361658834, -14.898059923599607, -19.389646817113917, -18.18567017786739, -18.318274198369526, -18.329948067348706, 3.3921925772429375, 13.601540003325267, -9.647640648570615, -10.804487742969751, -32.67803177984928, -20.67610276667873, -9.879662166419402, -13.067940532153566, -30.62075729209392, -8.236748850220602, -17.233470906812, 9.76152324738938, -15.305735478129863, -15.792307725709353, -10.703649387094064, -24.48166634926254, 8.83369568687548, -12.818702304286935, -24.978740637798442, -16.643707278197244, -18.431768215277472, -14.946283070093346, -12.337910303231848, -16.143328868510345, -19.204529910467958, -5.403111353071409, -12.5094715646153, -12.21150720997915, 0.8812564074706746, -22.95419551970238, 22.49216610736979, -5.29574275743466, -0.6479577091859063, -20.798072642451377, -18.49448730307298, -17.20323414724022, -16.71611278473466, -15.272198504792723, -12.441818665144076, 0.16991830563283905, -10.868805668971305, -13.454354990853348, -9.165036537728268, -4.431837874452823, 3.485050375994696, -3.7830743571515892], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [46.810734812974374, 40.08768864724513, 8.896538713035353, 16.57258537161975, 19.58534741526314, -7.8481751515368, 3.851465597778583, 20.851839889450265, -5.281886889890966, 9.277402461944286, 10.429327466933362, 10.701221549192239, 18.014619723362657, 15.743440103500665, 22.10764214277731, 7.483131806820728, 3.4587234391410853, 10.91038202898262, 19.674129686797897, 17.030352746320098, 3.0867780537555607, 9.132814532464943, -12.623780373670503, 16.05340099133528, 26.105659992915253, -3.0818880351888716, -3.048706954411962, 17.662540283311397, -1.9496321898572848, 3.325446154939147, 6.862308701797264, -19.408664611598248, 18.51726508934287, 0.23815458711539605, 22.88869765424006, -6.063387982055771, 15.818653221556687, 9.29202155471463, 6.467820208791622, 5.3943699000148975, 10.25667242622319, 15.889259260834962, 11.508602540670072, 27.85298113789389, 10.91539141431585, -10.019430219967148, 8.778313562401761, 23.46181158501713, 18.336443361658834, 14.898059923599616, 19.389646817113917, 18.1856701778674, 18.318274198369526, 18.329948067348695, -3.3921925772429375, -13.601540003325267, 9.647640648570615, 10.804487742969748, 32.678031779849256, 20.67610276667873, 9.879662166419402, 13.067940532153568, 30.620757292093884, 8.2367488502206, 17.233470906812, -9.76152324738938, 15.305735478129892, 15.792307725709353, 10.703649387094064, 24.481666349262543, -8.833695686875473, 12.818702304286939, 24.978740637798445, 16.64370727819725, 18.431768215277472, 14.946283070093349, 12.337910303231848, 16.143328868510352, 19.20452991046796, 5.403111353071409, 12.5094715646153, 12.21150720997915, -0.8812564074706746, 22.954195519702385, -22.492166107369787, 5.29574275743466, 0.6479577091859063, 20.798072642451373, 18.494487303072976, 17.20323414724023, 16.71611278473467, 15.272198504792712, 12.441818665144076, -0.16991830563283905, 10.868805668971305, 13.454354990853348, 9.165036537728266, 4.431837874452824, -3.485050375994698, 3.7830743571515892], "policy_adversary_policy_reward": [-49.53011454693661, -44.09135507901217, -40.88182464506207, -39.29355264942811, -8.162905412346447, -9.630172013724263, 3.0837132432707506, -36.22888398651025, -19.505706826730574, -19.664988003795706, -0.7895649121453001, 16.485915215218892, -0.2961643385003079, -7.4067668570568586, -7.6302099366514184, -34.07346984224908, -6.689095746304723, 17.252869526086656, -2.3216388120669933, -16.23316611182158, -23.568276632483794, 2.7096216986170703, -9.616241779657422, -11.786201318727056, -10.104148722012347, -25.925090724712973, -23.215743184376382, -8.271137022624949, -11.814986563600092, -32.40029772195452, -10.197518611966423, -4.768745001675036, 1.4859936642370926, -8.403440542519263, 3.801736593672018, -25.622500651637253, -14.265446312880378, -25.08281306071541, -10.336073312943128, -23.72463217969706, -6.578822060817483, 0.4052659533063636, -2.3672621896575166, -15.898366875272359, 9.678306009731724, 15.569254737609281, -23.01788330285951, -9.088918679811052, -32.08415821399476, -20.12716177183576, -8.988517570137688, 15.152293640515431, 4.129463927069118, 1.9679499817548063, -17.43844915132486, -17.886631415297934, 19.24800956830113, -15.348745188586559, 6.01943603605006, -12.670328345928354, 0.8869311931692039, -14.611548596763736, 29.473916254239235, 9.343412968957253, -32.9251246207556, -4.10940555793016, -13.136211449817871, 12.65990227558708, -26.441046722170363, -19.336348586309757, 11.870507837885832, 0.25626812622568806, -15.061760735646036, -16.575545707467338, -12.258858124816697, -6.325184984612569, -12.832048272509596, -0.10359214507364811, -11.151860792042754, 0.3631209920129592, -11.569823077844063, -8.943521774602317, -28.51891689498143, -3.259601626688493, 2.302440290984954, -25.3196453723251, -28.32152033986435, -27.384441935923462, -13.496664900702001, -8.334117927929707, 13.753564195823564, 6.285296244110732, -12.04318172216335, -5.513445402640169, -13.494476740289844, -33.42914642974442, -33.02125741561593, -3.6516293077017394, -3.2028887759880114, -26.593231071211203, -14.37853836031481, -24.40075527391302, -24.358083159208363, -12.013257196526443, -15.86669694249111, -20.769851454247938, -22.957414129838842, -13.702482004858627, 4.827387139813936, 1.9569980146719388, 10.814357115540776, 16.388722891109737, 11.65356061261037, -30.9488419097516, -16.557655945100848, -5.051319540838655, -26.125831577627746, -39.230231982070705, -13.777400130264297, -27.574805403093166, -6.540285516527291, -13.219038816311514, -13.953609691681596, -12.18227137262554, -23.668463249834502, -37.573051334353266, -26.719098336280688, 10.245600635839487, -12.907381981623057, -21.55955983200094, 16.873207542726867, 2.649838952051894, -17.946817787914753, -12.66465316834504, -30.033511145505578, -1.5511043059131282, -11.581132283919278, -9.82616649026885, -36.33734585926457, -12.625986839260499, -3.358988984120227, 21.026380357871176, -12.994166103792232, -12.643238504781639, -24.65172646956419, -25.305754806032688, -29.272574727717725, -4.014839828676781, -10.592313084342038, -26.271223346212903, -14.238871675415467, -15.65369446477122, -12.974376551114116, -11.701444055349576, -6.512919933979308, -25.77373780304138, -31.597399608327038, -6.811660212608903, -7.796681281536706, -3.0095414246061125, -27.14059341475042, 2.12165028551982, -18.370824159336912, -6.052190260621387, -5.973318652044988, 7.735831466986337, -33.447263753258255, -12.461127286146507, 10.230679234226926, 34.75365298051265, -23.865717091832202, 13.274231576962883, 6.884600617231975, -8.180516035603787, -25.63447608150072, -15.961669203402025, -6.783485362110433, -30.20548924403552, -3.8848600130256727, -30.521608281454775, -9.94133429634164, -23.49089127312765, -13.326849822619515, -17.21754718696591, -26.537190495316807, 1.6535531650286543, -6.8546641910284585, 7.194500802294137, -14.729709704536472, -7.007901633406139, -25.35703290399919, -1.5516770777075024, -19.01278289666074, 0.682709821204206, 0.4569134981213274, -9.320589247026984, 3.45048562920104, 3.5196151227883554, 1.2995218896139633, -8.865670603917142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44826708617924654, "mean_inference_ms": 1.1951491039972437, "mean_action_processing_ms": 0.19467234612108772, "mean_env_wait_ms": 0.07955600625218721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004048705101013184, "StateBufferConnector_ms": 0.0033893585205078125, "ViewRequirementAgentConnector_ms": 0.09570014476776123}, "num_episodes": 10, "episode_return_max": 22.49216610736979, "episode_return_min": -46.81073481297438, "episode_return_mean": -11.027948756876802}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.1231881589125, "num_env_steps_trained_throughput_per_sec": 407.1231881589125, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 9137.252, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9137.145, "sample_time_ms": 961.238, "learn_time_ms": 8162.457, "learn_throughput": 490.048, "synch_weights_time_ms": 12.751}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 46, "trial_id": "83a5c_00000", "date": "2024-08-10_12-20-36", "timestamp": 1723306836, "time_this_iter_s": 9.903958082199097, "time_total_s": 400.728515625, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb63c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 400.728515625, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 44.792857142857144, "ram_util_percent": 81.72857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.445922784262864, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.795480848998619, "policy_loss": -0.010118167693406422, "vf_loss": 4.804252734386101, "vf_explained_var": -0.045813538630803424, "kl": 0.021274608971372472, "entropy": 1.4545155288050415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.429209000679354, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2030762205521266, "policy_loss": -0.008634230929601472, "vf_loss": 3.2105651877820494, "vf_explained_var": 0.41215007367233436, "kl": 0.027147109744414876, "entropy": 0.8658206179117163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "env_runners": {"episode_reward_max": 22.49216610736979, "episode_reward_min": -32.67803177984928, "episode_reward_mean": -10.689510601011023, "episode_len_mean": 396.23, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39623, "policy_reward_min": {"agent_policy": -22.492166107369787, "adversary_policy": -39.230231982070705}, "policy_reward_max": {"agent_policy": 32.678031779849256, "adversary_policy": 34.75365298051265}, "policy_reward_mean": {"agent_policy": 10.68951060101102, "adversary_policy": -10.68951060101102}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.701221549192237, -18.014619723362667, -15.743440103500664, -22.10764214277731, -7.4831318068207295, -3.4587234391410853, -10.910382028982623, -19.674129686797894, -17.030352746320098, -3.0867780537555607, -9.132814532464945, 12.623780373670504, -16.05340099133528, -26.105659992915257, 3.0818880351888716, 3.048706954411962, -17.66254028331142, 1.9496321898572848, -3.325446154939147, -6.862308701797264, 19.408664611598244, -18.51726508934289, -0.23815458711539605, -22.888697654240058, 6.063387982055762, -15.818653221556687, -9.29202155471464, -6.467820208791622, -5.3943699000148975, -10.25667242622319, -15.889259260834962, -11.508602540670072, -27.8529811378939, -10.91539141431585, 10.019430219967148, -8.778313562401758, -23.461811585017134, -18.336443361658834, -14.898059923599607, -19.389646817113917, -18.18567017786739, -18.318274198369526, -18.329948067348706, 3.3921925772429375, 13.601540003325267, -9.647640648570615, -10.804487742969751, -32.67803177984928, -20.67610276667873, -9.879662166419402, -13.067940532153566, -30.62075729209392, -8.236748850220602, -17.233470906812, 9.76152324738938, -15.305735478129863, -15.792307725709353, -10.703649387094064, -24.48166634926254, 8.83369568687548, -12.818702304286935, -24.978740637798442, -16.643707278197244, -18.431768215277472, -14.946283070093346, -12.337910303231848, -16.143328868510345, -19.204529910467958, -5.403111353071409, -12.5094715646153, -12.21150720997915, 0.8812564074706746, -22.95419551970238, 22.49216610736979, -5.29574275743466, -0.6479577091859063, -20.798072642451377, -18.49448730307298, -17.20323414724022, -16.71611278473466, -15.272198504792723, -12.441818665144076, 0.16991830563283905, -10.868805668971305, -13.454354990853348, -9.165036537728268, -4.431837874452823, 3.485050375994696, -3.7830743571515892, -8.648565145508467, -19.510725235738082, 3.752986288151039, -23.73597860972613, -16.294571661357953, 2.5589573169573203, -8.036423409810782, -2.2786360004566806, -27.387619337107264, -5.934891771436217, -23.873585182205122], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [10.701221549192239, 18.014619723362657, 15.743440103500665, 22.10764214277731, 7.483131806820728, 3.4587234391410853, 10.91038202898262, 19.674129686797897, 17.030352746320098, 3.0867780537555607, 9.132814532464943, -12.623780373670503, 16.05340099133528, 26.105659992915253, -3.0818880351888716, -3.048706954411962, 17.662540283311397, -1.9496321898572848, 3.325446154939147, 6.862308701797264, -19.408664611598248, 18.51726508934287, 0.23815458711539605, 22.88869765424006, -6.063387982055771, 15.818653221556687, 9.29202155471463, 6.467820208791622, 5.3943699000148975, 10.25667242622319, 15.889259260834962, 11.508602540670072, 27.85298113789389, 10.91539141431585, -10.019430219967148, 8.778313562401761, 23.46181158501713, 18.336443361658834, 14.898059923599616, 19.389646817113917, 18.1856701778674, 18.318274198369526, 18.329948067348695, -3.3921925772429375, -13.601540003325267, 9.647640648570615, 10.804487742969748, 32.678031779849256, 20.67610276667873, 9.879662166419402, 13.067940532153568, 30.620757292093884, 8.2367488502206, 17.233470906812, -9.76152324738938, 15.305735478129892, 15.792307725709353, 10.703649387094064, 24.481666349262543, -8.833695686875473, 12.818702304286939, 24.978740637798445, 16.64370727819725, 18.431768215277472, 14.946283070093349, 12.337910303231848, 16.143328868510352, 19.20452991046796, 5.403111353071409, 12.5094715646153, 12.21150720997915, -0.8812564074706746, 22.954195519702385, -22.492166107369787, 5.29574275743466, 0.6479577091859063, 20.798072642451373, 18.494487303072976, 17.20323414724023, 16.71611278473467, 15.272198504792712, 12.441818665144076, -0.16991830563283905, 10.868805668971305, 13.454354990853348, 9.165036537728266, 4.431837874452824, -3.485050375994698, 3.7830743571515892, 8.648565145508467, 19.510725235738082, -3.752986288151039, 23.73597860972613, 16.294571661357953, -2.5589573169573203, 8.036423409810784, 2.2786360004566806, 27.38761933710726, 5.934891771436217, 23.873585182205122], "policy_adversary_policy_reward": [-9.616241779657422, -11.786201318727056, -10.104148722012347, -25.925090724712973, -23.215743184376382, -8.271137022624949, -11.814986563600092, -32.40029772195452, -10.197518611966423, -4.768745001675036, 1.4859936642370926, -8.403440542519263, 3.801736593672018, -25.622500651637253, -14.265446312880378, -25.08281306071541, -10.336073312943128, -23.72463217969706, -6.578822060817483, 0.4052659533063636, -2.3672621896575166, -15.898366875272359, 9.678306009731724, 15.569254737609281, -23.01788330285951, -9.088918679811052, -32.08415821399476, -20.12716177183576, -8.988517570137688, 15.152293640515431, 4.129463927069118, 1.9679499817548063, -17.43844915132486, -17.886631415297934, 19.24800956830113, -15.348745188586559, 6.01943603605006, -12.670328345928354, 0.8869311931692039, -14.611548596763736, 29.473916254239235, 9.343412968957253, -32.9251246207556, -4.10940555793016, -13.136211449817871, 12.65990227558708, -26.441046722170363, -19.336348586309757, 11.870507837885832, 0.25626812622568806, -15.061760735646036, -16.575545707467338, -12.258858124816697, -6.325184984612569, -12.832048272509596, -0.10359214507364811, -11.151860792042754, 0.3631209920129592, -11.569823077844063, -8.943521774602317, -28.51891689498143, -3.259601626688493, 2.302440290984954, -25.3196453723251, -28.32152033986435, -27.384441935923462, -13.496664900702001, -8.334117927929707, 13.753564195823564, 6.285296244110732, -12.04318172216335, -5.513445402640169, -13.494476740289844, -33.42914642974442, -33.02125741561593, -3.6516293077017394, -3.2028887759880114, -26.593231071211203, -14.37853836031481, -24.40075527391302, -24.358083159208363, -12.013257196526443, -15.86669694249111, -20.769851454247938, -22.957414129838842, -13.702482004858627, 4.827387139813936, 1.9569980146719388, 10.814357115540776, 16.388722891109737, 11.65356061261037, -30.9488419097516, -16.557655945100848, -5.051319540838655, -26.125831577627746, -39.230231982070705, -13.777400130264297, -27.574805403093166, -6.540285516527291, -13.219038816311514, -13.953609691681596, -12.18227137262554, -23.668463249834502, -37.573051334353266, -26.719098336280688, 10.245600635839487, -12.907381981623057, -21.55955983200094, 16.873207542726867, 2.649838952051894, -17.946817787914753, -12.66465316834504, -30.033511145505578, -1.5511043059131282, -11.581132283919278, -9.82616649026885, -36.33734585926457, -12.625986839260499, -3.358988984120227, 21.026380357871176, -12.994166103792232, -12.643238504781639, -24.65172646956419, -25.305754806032688, -29.272574727717725, -4.014839828676781, -10.592313084342038, -26.271223346212903, -14.238871675415467, -15.65369446477122, -12.974376551114116, -11.701444055349576, -6.512919933979308, -25.77373780304138, -31.597399608327038, -6.811660212608903, -7.796681281536706, -3.0095414246061125, -27.14059341475042, 2.12165028551982, -18.370824159336912, -6.052190260621387, -5.973318652044988, 7.735831466986337, -33.447263753258255, -12.461127286146507, 10.230679234226926, 34.75365298051265, -23.865717091832202, 13.274231576962883, 6.884600617231975, -8.180516035603787, -25.63447608150072, -15.961669203402025, -6.783485362110433, -30.20548924403552, -3.8848600130256727, -30.521608281454775, -9.94133429634164, -23.49089127312765, -13.326849822619515, -17.21754718696591, -26.537190495316807, 1.6535531650286543, -6.8546641910284585, 7.194500802294137, -14.729709704536472, -7.007901633406139, -25.35703290399919, -1.5516770777075024, -19.01278289666074, 0.682709821204206, 0.4569134981213274, -9.320589247026984, 3.45048562920104, 3.5196151227883554, 1.2995218896139633, -8.865670603917142, -14.64668337703435, -2.6504469139825844, -17.409524696265656, -21.611925775210498, 2.949898479516733, 4.556074096785345, -24.588685414539675, -22.88327180491258, -20.07646189958593, -12.512681423129973, 8.867763974796816, -3.749849340882175, -21.50471461249191, 5.431867792870342, 8.87601039978081, -13.433282400694171, -35.52939858551476, -19.245840088699758, 7.026287433209355, -18.896070976081788, -31.897804732826735, -15.849365631583513]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44871748956201507, "mean_inference_ms": 1.1965147430541443, "mean_action_processing_ms": 0.19496384522406518, "mean_env_wait_ms": 0.07969103587484123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004080057144165039, "StateBufferConnector_ms": 0.0034307241439819336, "ViewRequirementAgentConnector_ms": 0.08967089653015137}, "num_episodes": 11, "episode_return_max": 22.49216610736979, "episode_return_min": -32.67803177984928, "episode_return_mean": -10.689510601011023}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.360842950963, "num_env_steps_trained_throughput_per_sec": 444.360842950963, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 9094.345, "restore_workers_time_ms": 0.018, "training_step_time_ms": 9094.223, "sample_time_ms": 951.99, "learn_time_ms": 8128.986, "learn_throughput": 492.066, "synch_weights_time_ms": 12.54}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "training_iteration": 47, "trial_id": "83a5c_00000", "date": "2024-08-10_12-20-45", "timestamp": 1723306845, "time_this_iter_s": 9.006417751312256, "time_total_s": 409.73493337631226, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5c9b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 409.73493337631226, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 36.12307692307692, "ram_util_percent": 82.91538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.387328922275513, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.094789417710884, "policy_loss": -0.003489748878581893, "vf_loss": 5.097210024147437, "vf_explained_var": 0.01041022431913507, "kl": 0.011263239023837404, "entropy": 1.4788911277024204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8425183786079287, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.408887974917889, "policy_loss": -0.003690610293415375, "vf_loss": 4.4115990526974205, "vf_explained_var": 0.33644584361463786, "kl": 0.015479100821627541, "entropy": 0.7966090702762206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 22.49216610736979, "episode_reward_min": -32.67803177984928, "episode_reward_mean": -10.416591126856074, "episode_len_mean": 396.23, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 39623, "policy_reward_min": {"agent_policy": -22.492166107369787, "adversary_policy": -39.230231982070705}, "policy_reward_max": {"agent_policy": 32.678031779849256, "adversary_policy": 34.75365298051265}, "policy_reward_mean": {"agent_policy": 10.416591126856074, "adversary_policy": -10.416591126856074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0867780537555607, -9.132814532464945, 12.623780373670504, -16.05340099133528, -26.105659992915257, 3.0818880351888716, 3.048706954411962, -17.66254028331142, 1.9496321898572848, -3.325446154939147, -6.862308701797264, 19.408664611598244, -18.51726508934289, -0.23815458711539605, -22.888697654240058, 6.063387982055762, -15.818653221556687, -9.29202155471464, -6.467820208791622, -5.3943699000148975, -10.25667242622319, -15.889259260834962, -11.508602540670072, -27.8529811378939, -10.91539141431585, 10.019430219967148, -8.778313562401758, -23.461811585017134, -18.336443361658834, -14.898059923599607, -19.389646817113917, -18.18567017786739, -18.318274198369526, -18.329948067348706, 3.3921925772429375, 13.601540003325267, -9.647640648570615, -10.804487742969751, -32.67803177984928, -20.67610276667873, -9.879662166419402, -13.067940532153566, -30.62075729209392, -8.236748850220602, -17.233470906812, 9.76152324738938, -15.305735478129863, -15.792307725709353, -10.703649387094064, -24.48166634926254, 8.83369568687548, -12.818702304286935, -24.978740637798442, -16.643707278197244, -18.431768215277472, -14.946283070093346, -12.337910303231848, -16.143328868510345, -19.204529910467958, -5.403111353071409, -12.5094715646153, -12.21150720997915, 0.8812564074706746, -22.95419551970238, 22.49216610736979, -5.29574275743466, -0.6479577091859063, -20.798072642451377, -18.49448730307298, -17.20323414724022, -16.71611278473466, -15.272198504792723, -12.441818665144076, 0.16991830563283905, -10.868805668971305, -13.454354990853348, -9.165036537728268, -4.431837874452823, 3.485050375994696, -3.7830743571515892, -8.648565145508467, -19.510725235738082, 3.752986288151039, -23.73597860972613, -16.294571661357953, 2.5589573169573203, -8.036423409810782, -2.2786360004566806, -27.387619337107264, -5.934891771436217, -23.873585182205122, -20.671251803794394, -6.8825557052168485, -2.721463893191917, -4.362962580628537, -9.76134764538055, -9.99677129192053, -22.032516194988634, -13.918882444673422, -7.483944251605839], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [3.0867780537555607, 9.132814532464943, -12.623780373670503, 16.05340099133528, 26.105659992915253, -3.0818880351888716, -3.048706954411962, 17.662540283311397, -1.9496321898572848, 3.325446154939147, 6.862308701797264, -19.408664611598248, 18.51726508934287, 0.23815458711539605, 22.88869765424006, -6.063387982055771, 15.818653221556687, 9.29202155471463, 6.467820208791622, 5.3943699000148975, 10.25667242622319, 15.889259260834962, 11.508602540670072, 27.85298113789389, 10.91539141431585, -10.019430219967148, 8.778313562401761, 23.46181158501713, 18.336443361658834, 14.898059923599616, 19.389646817113917, 18.1856701778674, 18.318274198369526, 18.329948067348695, -3.3921925772429375, -13.601540003325267, 9.647640648570615, 10.804487742969748, 32.678031779849256, 20.67610276667873, 9.879662166419402, 13.067940532153568, 30.620757292093884, 8.2367488502206, 17.233470906812, -9.76152324738938, 15.305735478129892, 15.792307725709353, 10.703649387094064, 24.481666349262543, -8.833695686875473, 12.818702304286939, 24.978740637798445, 16.64370727819725, 18.431768215277472, 14.946283070093349, 12.337910303231848, 16.143328868510352, 19.20452991046796, 5.403111353071409, 12.5094715646153, 12.21150720997915, -0.8812564074706746, 22.954195519702385, -22.492166107369787, 5.29574275743466, 0.6479577091859063, 20.798072642451373, 18.494487303072976, 17.20323414724023, 16.71611278473467, 15.272198504792712, 12.441818665144076, -0.16991830563283905, 10.868805668971305, 13.454354990853348, 9.165036537728266, 4.431837874452824, -3.485050375994698, 3.7830743571515892, 8.648565145508467, 19.510725235738082, -3.752986288151039, 23.73597860972613, 16.294571661357953, -2.5589573169573203, 8.036423409810784, 2.2786360004566806, 27.38761933710726, 5.934891771436217, 23.873585182205122, 20.671251803794398, 6.8825557052168485, 2.721463893191917, 4.362962580628537, 9.76134764538055, 9.996771291920531, 22.03251619498863, 13.918882444673422, 7.483944251605839], "policy_adversary_policy_reward": [-6.578822060817483, 0.4052659533063636, -2.3672621896575166, -15.898366875272359, 9.678306009731724, 15.569254737609281, -23.01788330285951, -9.088918679811052, -32.08415821399476, -20.12716177183576, -8.988517570137688, 15.152293640515431, 4.129463927069118, 1.9679499817548063, -17.43844915132486, -17.886631415297934, 19.24800956830113, -15.348745188586559, 6.01943603605006, -12.670328345928354, 0.8869311931692039, -14.611548596763736, 29.473916254239235, 9.343412968957253, -32.9251246207556, -4.10940555793016, -13.136211449817871, 12.65990227558708, -26.441046722170363, -19.336348586309757, 11.870507837885832, 0.25626812622568806, -15.061760735646036, -16.575545707467338, -12.258858124816697, -6.325184984612569, -12.832048272509596, -0.10359214507364811, -11.151860792042754, 0.3631209920129592, -11.569823077844063, -8.943521774602317, -28.51891689498143, -3.259601626688493, 2.302440290984954, -25.3196453723251, -28.32152033986435, -27.384441935923462, -13.496664900702001, -8.334117927929707, 13.753564195823564, 6.285296244110732, -12.04318172216335, -5.513445402640169, -13.494476740289844, -33.42914642974442, -33.02125741561593, -3.6516293077017394, -3.2028887759880114, -26.593231071211203, -14.37853836031481, -24.40075527391302, -24.358083159208363, -12.013257196526443, -15.86669694249111, -20.769851454247938, -22.957414129838842, -13.702482004858627, 4.827387139813936, 1.9569980146719388, 10.814357115540776, 16.388722891109737, 11.65356061261037, -30.9488419097516, -16.557655945100848, -5.051319540838655, -26.125831577627746, -39.230231982070705, -13.777400130264297, -27.574805403093166, -6.540285516527291, -13.219038816311514, -13.953609691681596, -12.18227137262554, -23.668463249834502, -37.573051334353266, -26.719098336280688, 10.245600635839487, -12.907381981623057, -21.55955983200094, 16.873207542726867, 2.649838952051894, -17.946817787914753, -12.66465316834504, -30.033511145505578, -1.5511043059131282, -11.581132283919278, -9.82616649026885, -36.33734585926457, -12.625986839260499, -3.358988984120227, 21.026380357871176, -12.994166103792232, -12.643238504781639, -24.65172646956419, -25.305754806032688, -29.272574727717725, -4.014839828676781, -10.592313084342038, -26.271223346212903, -14.238871675415467, -15.65369446477122, -12.974376551114116, -11.701444055349576, -6.512919933979308, -25.77373780304138, -31.597399608327038, -6.811660212608903, -7.796681281536706, -3.0095414246061125, -27.14059341475042, 2.12165028551982, -18.370824159336912, -6.052190260621387, -5.973318652044988, 7.735831466986337, -33.447263753258255, -12.461127286146507, 10.230679234226926, 34.75365298051265, -23.865717091832202, 13.274231576962883, 6.884600617231975, -8.180516035603787, -25.63447608150072, -15.961669203402025, -6.783485362110433, -30.20548924403552, -3.8848600130256727, -30.521608281454775, -9.94133429634164, -23.49089127312765, -13.326849822619515, -17.21754718696591, -26.537190495316807, 1.6535531650286543, -6.8546641910284585, 7.194500802294137, -14.729709704536472, -7.007901633406139, -25.35703290399919, -1.5516770777075024, -19.01278289666074, 0.682709821204206, 0.4569134981213274, -9.320589247026984, 3.45048562920104, 3.5196151227883554, 1.2995218896139633, -8.865670603917142, -14.64668337703435, -2.6504469139825844, -17.409524696265656, -21.611925775210498, 2.949898479516733, 4.556074096785345, -24.588685414539675, -22.88327180491258, -20.07646189958593, -12.512681423129973, 8.867763974796816, -3.749849340882175, -21.50471461249191, 5.431867792870342, 8.87601039978081, -13.433282400694171, -35.52939858551476, -19.245840088699758, 7.026287433209355, -18.896070976081788, -31.897804732826735, -15.849365631583513, -15.225911107860718, -26.11659249972807, 10.119139560245607, -23.884250970679304, 2.6492924709483674, -8.092220257332201, -7.617467518538163, -1.1084576427189106, 13.530061745751581, -33.05275703651268, -17.211110622966167, -2.782431960874895, -36.538006932840744, -7.527025457136514, -15.529835599324091, -12.307929290022752, -7.605527811792811, -7.362360691418864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4489574848463883, "mean_inference_ms": 1.1976585365183376, "mean_action_processing_ms": 0.19501445771802894, "mean_env_wait_ms": 0.07978426712865105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004220128059387207, "StateBufferConnector_ms": 0.0035027265548706055, "ViewRequirementAgentConnector_ms": 0.0909569263458252}, "num_episodes": 9, "episode_return_max": 22.49216610736979, "episode_return_min": -32.67803177984928, "episode_return_mean": -10.416591126856074}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 445.6898557624656, "num_env_steps_trained_throughput_per_sec": 445.6898557624656, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 9099.195, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9099.074, "sample_time_ms": 950.992, "learn_time_ms": 8134.859, "learn_throughput": 491.711, "synch_weights_time_ms": 12.482}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 48, "trial_id": "83a5c_00000", "date": "2024-08-10_12-20-54", "timestamp": 1723306854, "time_this_iter_s": 9.028141736984253, "time_total_s": 418.7630751132965, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f570b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 418.7630751132965, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.923076923076927, "ram_util_percent": 82.95384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1761775635537646, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.438438211673152, "policy_loss": -0.005008889610815064, "vf_loss": 4.4423598531692745, "vf_explained_var": -0.018472921627539177, "kl": 0.011453962284881993, "entropy": 1.458774234945812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6199333481801053, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1870629859467345, "policy_loss": -0.005285083556373138, "vf_loss": 3.191894657413165, "vf_explained_var": 0.3349352051814397, "kl": 0.007165037524982595, "entropy": 0.7292949069291353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "env_runners": {"episode_reward_max": 22.49216610736979, "episode_reward_min": -32.67803177984928, "episode_reward_mean": -10.900146260719332, "episode_len_mean": 396.23, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39623, "policy_reward_min": {"agent_policy": -22.492166107369787, "adversary_policy": -39.230231982070705}, "policy_reward_max": {"agent_policy": 32.678031779849256, "adversary_policy": 34.75365298051265}, "policy_reward_mean": {"agent_policy": 10.900146260719334, "adversary_policy": -10.900146260719334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.408664611598244, -18.51726508934289, -0.23815458711539605, -22.888697654240058, 6.063387982055762, -15.818653221556687, -9.29202155471464, -6.467820208791622, -5.3943699000148975, -10.25667242622319, -15.889259260834962, -11.508602540670072, -27.8529811378939, -10.91539141431585, 10.019430219967148, -8.778313562401758, -23.461811585017134, -18.336443361658834, -14.898059923599607, -19.389646817113917, -18.18567017786739, -18.318274198369526, -18.329948067348706, 3.3921925772429375, 13.601540003325267, -9.647640648570615, -10.804487742969751, -32.67803177984928, -20.67610276667873, -9.879662166419402, -13.067940532153566, -30.62075729209392, -8.236748850220602, -17.233470906812, 9.76152324738938, -15.305735478129863, -15.792307725709353, -10.703649387094064, -24.48166634926254, 8.83369568687548, -12.818702304286935, -24.978740637798442, -16.643707278197244, -18.431768215277472, -14.946283070093346, -12.337910303231848, -16.143328868510345, -19.204529910467958, -5.403111353071409, -12.5094715646153, -12.21150720997915, 0.8812564074706746, -22.95419551970238, 22.49216610736979, -5.29574275743466, -0.6479577091859063, -20.798072642451377, -18.49448730307298, -17.20323414724022, -16.71611278473466, -15.272198504792723, -12.441818665144076, 0.16991830563283905, -10.868805668971305, -13.454354990853348, -9.165036537728268, -4.431837874452823, 3.485050375994696, -3.7830743571515892, -8.648565145508467, -19.510725235738082, 3.752986288151039, -23.73597860972613, -16.294571661357953, 2.5589573169573203, -8.036423409810782, -2.2786360004566806, -27.387619337107264, -5.934891771436217, -23.873585182205122, -20.671251803794394, -6.8825557052168485, -2.721463893191917, -4.362962580628537, -9.76134764538055, -9.99677129192053, -22.032516194988634, -13.918882444673422, -7.483944251605839, -6.560139571761097, -19.94233276885774, 3.2983927427962385, -2.142941746314767, -14.583229808471796, -16.55685360873525, -9.235001490438885, -7.780704963254893, -23.245056630428778, -2.1753409665631356, -10.957245731685912], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-19.408664611598248, 18.51726508934287, 0.23815458711539605, 22.88869765424006, -6.063387982055771, 15.818653221556687, 9.29202155471463, 6.467820208791622, 5.3943699000148975, 10.25667242622319, 15.889259260834962, 11.508602540670072, 27.85298113789389, 10.91539141431585, -10.019430219967148, 8.778313562401761, 23.46181158501713, 18.336443361658834, 14.898059923599616, 19.389646817113917, 18.1856701778674, 18.318274198369526, 18.329948067348695, -3.3921925772429375, -13.601540003325267, 9.647640648570615, 10.804487742969748, 32.678031779849256, 20.67610276667873, 9.879662166419402, 13.067940532153568, 30.620757292093884, 8.2367488502206, 17.233470906812, -9.76152324738938, 15.305735478129892, 15.792307725709353, 10.703649387094064, 24.481666349262543, -8.833695686875473, 12.818702304286939, 24.978740637798445, 16.64370727819725, 18.431768215277472, 14.946283070093349, 12.337910303231848, 16.143328868510352, 19.20452991046796, 5.403111353071409, 12.5094715646153, 12.21150720997915, -0.8812564074706746, 22.954195519702385, -22.492166107369787, 5.29574275743466, 0.6479577091859063, 20.798072642451373, 18.494487303072976, 17.20323414724023, 16.71611278473467, 15.272198504792712, 12.441818665144076, -0.16991830563283905, 10.868805668971305, 13.454354990853348, 9.165036537728266, 4.431837874452824, -3.485050375994698, 3.7830743571515892, 8.648565145508467, 19.510725235738082, -3.752986288151039, 23.73597860972613, 16.294571661357953, -2.5589573169573203, 8.036423409810784, 2.2786360004566806, 27.38761933710726, 5.934891771436217, 23.873585182205122, 20.671251803794398, 6.8825557052168485, 2.721463893191917, 4.362962580628537, 9.76134764538055, 9.996771291920531, 22.03251619498863, 13.918882444673422, 7.483944251605839, 6.560139571761097, 19.942332768857742, -3.2983927427962385, 2.1429417463147686, 14.583229808471796, 16.556853608735256, 9.235001490438888, 7.780704963254893, 23.24505663042878, 2.1753409665631356, 10.957245731685916], "policy_adversary_policy_reward": [29.473916254239235, 9.343412968957253, -32.9251246207556, -4.10940555793016, -13.136211449817871, 12.65990227558708, -26.441046722170363, -19.336348586309757, 11.870507837885832, 0.25626812622568806, -15.061760735646036, -16.575545707467338, -12.258858124816697, -6.325184984612569, -12.832048272509596, -0.10359214507364811, -11.151860792042754, 0.3631209920129592, -11.569823077844063, -8.943521774602317, -28.51891689498143, -3.259601626688493, 2.302440290984954, -25.3196453723251, -28.32152033986435, -27.384441935923462, -13.496664900702001, -8.334117927929707, 13.753564195823564, 6.285296244110732, -12.04318172216335, -5.513445402640169, -13.494476740289844, -33.42914642974442, -33.02125741561593, -3.6516293077017394, -3.2028887759880114, -26.593231071211203, -14.37853836031481, -24.40075527391302, -24.358083159208363, -12.013257196526443, -15.86669694249111, -20.769851454247938, -22.957414129838842, -13.702482004858627, 4.827387139813936, 1.9569980146719388, 10.814357115540776, 16.388722891109737, 11.65356061261037, -30.9488419097516, -16.557655945100848, -5.051319540838655, -26.125831577627746, -39.230231982070705, -13.777400130264297, -27.574805403093166, -6.540285516527291, -13.219038816311514, -13.953609691681596, -12.18227137262554, -23.668463249834502, -37.573051334353266, -26.719098336280688, 10.245600635839487, -12.907381981623057, -21.55955983200094, 16.873207542726867, 2.649838952051894, -17.946817787914753, -12.66465316834504, -30.033511145505578, -1.5511043059131282, -11.581132283919278, -9.82616649026885, -36.33734585926457, -12.625986839260499, -3.358988984120227, 21.026380357871176, -12.994166103792232, -12.643238504781639, -24.65172646956419, -25.305754806032688, -29.272574727717725, -4.014839828676781, -10.592313084342038, -26.271223346212903, -14.238871675415467, -15.65369446477122, -12.974376551114116, -11.701444055349576, -6.512919933979308, -25.77373780304138, -31.597399608327038, -6.811660212608903, -7.796681281536706, -3.0095414246061125, -27.14059341475042, 2.12165028551982, -18.370824159336912, -6.052190260621387, -5.973318652044988, 7.735831466986337, -33.447263753258255, -12.461127286146507, 10.230679234226926, 34.75365298051265, -23.865717091832202, 13.274231576962883, 6.884600617231975, -8.180516035603787, -25.63447608150072, -15.961669203402025, -6.783485362110433, -30.20548924403552, -3.8848600130256727, -30.521608281454775, -9.94133429634164, -23.49089127312765, -13.326849822619515, -17.21754718696591, -26.537190495316807, 1.6535531650286543, -6.8546641910284585, 7.194500802294137, -14.729709704536472, -7.007901633406139, -25.35703290399919, -1.5516770777075024, -19.01278289666074, 0.682709821204206, 0.4569134981213274, -9.320589247026984, 3.45048562920104, 3.5196151227883554, 1.2995218896139633, -8.865670603917142, -14.64668337703435, -2.6504469139825844, -17.409524696265656, -21.611925775210498, 2.949898479516733, 4.556074096785345, -24.588685414539675, -22.88327180491258, -20.07646189958593, -12.512681423129973, 8.867763974796816, -3.749849340882175, -21.50471461249191, 5.431867792870342, 8.87601039978081, -13.433282400694171, -35.52939858551476, -19.245840088699758, 7.026287433209355, -18.896070976081788, -31.897804732826735, -15.849365631583513, -15.225911107860718, -26.11659249972807, 10.119139560245607, -23.884250970679304, 2.6492924709483674, -8.092220257332201, -7.617467518538163, -1.1084576427189106, 13.530061745751581, -33.05275703651268, -17.211110622966167, -2.782431960874895, -36.538006932840744, -7.527025457136514, -15.529835599324091, -12.307929290022752, -7.605527811792811, -7.362360691418864, -5.696787061732948, -7.423492081789245, -33.50438749868255, -6.380278039032934, 18.14045919232472, -11.543673706732243, -2.2046006518911447, -2.0812828407383837, -18.51236460216719, -10.65409501477641, -11.735157307466093, -21.37854991000441, -19.93737063692328, 1.4673676560455018, -7.70248180038973, -7.858928126120055, -23.71398644248671, -22.776126818370827, -8.339825207384013, 3.989143274257742, -15.468994028178912, -6.445497435192916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4492885144730306, "mean_inference_ms": 1.198921383912024, "mean_action_processing_ms": 0.19524333453028325, "mean_env_wait_ms": 0.07993729377904311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004243135452270508, "StateBufferConnector_ms": 0.0034203529357910156, "ViewRequirementAgentConnector_ms": 0.08845734596252441}, "num_episodes": 11, "episode_return_max": 22.49216610736979, "episode_return_min": -32.67803177984928, "episode_return_mean": -10.900146260719332}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 451.97894021314534, "num_env_steps_trained_throughput_per_sec": 451.97894021314534, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 9076.218, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9076.097, "sample_time_ms": 954.962, "learn_time_ms": 8107.545, "learn_throughput": 493.368, "synch_weights_time_ms": 12.855}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "training_iteration": 49, "trial_id": "83a5c_00000", "date": "2024-08-10_12-21-03", "timestamp": 1723306863, "time_this_iter_s": 8.855771780014038, "time_total_s": 427.61884689331055, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a18b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 427.61884689331055, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 32.99166666666667, "ram_util_percent": 83.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.47115928571691, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.073098236417014, "policy_loss": -0.003606906494312974, "vf_loss": 4.075857693051535, "vf_explained_var": 0.19301832349842818, "kl": 0.008927917758214278, "entropy": 1.4324425597670216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2816815710316103, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6088627396772304, "policy_loss": -0.007082570683754359, "vf_loss": 2.6154170453548433, "vf_explained_var": 0.31573525021473564, "kl": 0.008347870460398591, "entropy": 0.7600668106228113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 22.49216610736979, "episode_reward_min": -32.67803177984928, "episode_reward_mean": -11.117342855202388, "episode_len_mean": 392.3, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 39230, "policy_reward_min": {"agent_policy": -22.492166107369787, "adversary_policy": -39.230231982070705}, "policy_reward_max": {"agent_policy": 32.678031779849256, "adversary_policy": 34.75365298051265}, "policy_reward_mean": {"agent_policy": 11.117342855202388, "adversary_policy": -11.11734285520239}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.508602540670072, -27.8529811378939, -10.91539141431585, 10.019430219967148, -8.778313562401758, -23.461811585017134, -18.336443361658834, -14.898059923599607, -19.389646817113917, -18.18567017786739, -18.318274198369526, -18.329948067348706, 3.3921925772429375, 13.601540003325267, -9.647640648570615, -10.804487742969751, -32.67803177984928, -20.67610276667873, -9.879662166419402, -13.067940532153566, -30.62075729209392, -8.236748850220602, -17.233470906812, 9.76152324738938, -15.305735478129863, -15.792307725709353, -10.703649387094064, -24.48166634926254, 8.83369568687548, -12.818702304286935, -24.978740637798442, -16.643707278197244, -18.431768215277472, -14.946283070093346, -12.337910303231848, -16.143328868510345, -19.204529910467958, -5.403111353071409, -12.5094715646153, -12.21150720997915, 0.8812564074706746, -22.95419551970238, 22.49216610736979, -5.29574275743466, -0.6479577091859063, -20.798072642451377, -18.49448730307298, -17.20323414724022, -16.71611278473466, -15.272198504792723, -12.441818665144076, 0.16991830563283905, -10.868805668971305, -13.454354990853348, -9.165036537728268, -4.431837874452823, 3.485050375994696, -3.7830743571515892, -8.648565145508467, -19.510725235738082, 3.752986288151039, -23.73597860972613, -16.294571661357953, 2.5589573169573203, -8.036423409810782, -2.2786360004566806, -27.387619337107264, -5.934891771436217, -23.873585182205122, -20.671251803794394, -6.8825557052168485, -2.721463893191917, -4.362962580628537, -9.76134764538055, -9.99677129192053, -22.032516194988634, -13.918882444673422, -7.483944251605839, -6.560139571761097, -19.94233276885774, 3.2983927427962385, -2.142941746314767, -14.583229808471796, -16.55685360873525, -9.235001490438885, -7.780704963254893, -23.245056630428778, -2.1753409665631356, -10.957245731685912, -8.195012316907821, -18.799396305367097, 3.4564370309371113, -20.916818375436456, -26.703532873809877, -13.244911162597631, -13.148607151901325, -7.004643119352302, -0.06998953525130958, -2.1091593685363854, 5.725112420737245], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [11.508602540670072, 27.85298113789389, 10.91539141431585, -10.019430219967148, 8.778313562401761, 23.46181158501713, 18.336443361658834, 14.898059923599616, 19.389646817113917, 18.1856701778674, 18.318274198369526, 18.329948067348695, -3.3921925772429375, -13.601540003325267, 9.647640648570615, 10.804487742969748, 32.678031779849256, 20.67610276667873, 9.879662166419402, 13.067940532153568, 30.620757292093884, 8.2367488502206, 17.233470906812, -9.76152324738938, 15.305735478129892, 15.792307725709353, 10.703649387094064, 24.481666349262543, -8.833695686875473, 12.818702304286939, 24.978740637798445, 16.64370727819725, 18.431768215277472, 14.946283070093349, 12.337910303231848, 16.143328868510352, 19.20452991046796, 5.403111353071409, 12.5094715646153, 12.21150720997915, -0.8812564074706746, 22.954195519702385, -22.492166107369787, 5.29574275743466, 0.6479577091859063, 20.798072642451373, 18.494487303072976, 17.20323414724023, 16.71611278473467, 15.272198504792712, 12.441818665144076, -0.16991830563283905, 10.868805668971305, 13.454354990853348, 9.165036537728266, 4.431837874452824, -3.485050375994698, 3.7830743571515892, 8.648565145508467, 19.510725235738082, -3.752986288151039, 23.73597860972613, 16.294571661357953, -2.5589573169573203, 8.036423409810784, 2.2786360004566806, 27.38761933710726, 5.934891771436217, 23.873585182205122, 20.671251803794398, 6.8825557052168485, 2.721463893191917, 4.362962580628537, 9.76134764538055, 9.996771291920531, 22.03251619498863, 13.918882444673422, 7.483944251605839, 6.560139571761097, 19.942332768857742, -3.2983927427962385, 2.1429417463147686, 14.583229808471796, 16.556853608735256, 9.235001490438888, 7.780704963254893, 23.24505663042878, 2.1753409665631356, 10.957245731685916, 8.19501231690782, 18.7993963053671, -3.456437030937111, 20.91681837543646, 26.703532873809873, 13.244911162597631, 13.148607151901325, 7.004643119352304, 0.06998953525130958, 2.1091593685363854, -5.725112420737245], "policy_adversary_policy_reward": [2.302440290984954, -25.3196453723251, -28.32152033986435, -27.384441935923462, -13.496664900702001, -8.334117927929707, 13.753564195823564, 6.285296244110732, -12.04318172216335, -5.513445402640169, -13.494476740289844, -33.42914642974442, -33.02125741561593, -3.6516293077017394, -3.2028887759880114, -26.593231071211203, -14.37853836031481, -24.40075527391302, -24.358083159208363, -12.013257196526443, -15.86669694249111, -20.769851454247938, -22.957414129838842, -13.702482004858627, 4.827387139813936, 1.9569980146719388, 10.814357115540776, 16.388722891109737, 11.65356061261037, -30.9488419097516, -16.557655945100848, -5.051319540838655, -26.125831577627746, -39.230231982070705, -13.777400130264297, -27.574805403093166, -6.540285516527291, -13.219038816311514, -13.953609691681596, -12.18227137262554, -23.668463249834502, -37.573051334353266, -26.719098336280688, 10.245600635839487, -12.907381981623057, -21.55955983200094, 16.873207542726867, 2.649838952051894, -17.946817787914753, -12.66465316834504, -30.033511145505578, -1.5511043059131282, -11.581132283919278, -9.82616649026885, -36.33734585926457, -12.625986839260499, -3.358988984120227, 21.026380357871176, -12.994166103792232, -12.643238504781639, -24.65172646956419, -25.305754806032688, -29.272574727717725, -4.014839828676781, -10.592313084342038, -26.271223346212903, -14.238871675415467, -15.65369446477122, -12.974376551114116, -11.701444055349576, -6.512919933979308, -25.77373780304138, -31.597399608327038, -6.811660212608903, -7.796681281536706, -3.0095414246061125, -27.14059341475042, 2.12165028551982, -18.370824159336912, -6.052190260621387, -5.973318652044988, 7.735831466986337, -33.447263753258255, -12.461127286146507, 10.230679234226926, 34.75365298051265, -23.865717091832202, 13.274231576962883, 6.884600617231975, -8.180516035603787, -25.63447608150072, -15.961669203402025, -6.783485362110433, -30.20548924403552, -3.8848600130256727, -30.521608281454775, -9.94133429634164, -23.49089127312765, -13.326849822619515, -17.21754718696591, -26.537190495316807, 1.6535531650286543, -6.8546641910284585, 7.194500802294137, -14.729709704536472, -7.007901633406139, -25.35703290399919, -1.5516770777075024, -19.01278289666074, 0.682709821204206, 0.4569134981213274, -9.320589247026984, 3.45048562920104, 3.5196151227883554, 1.2995218896139633, -8.865670603917142, -14.64668337703435, -2.6504469139825844, -17.409524696265656, -21.611925775210498, 2.949898479516733, 4.556074096785345, -24.588685414539675, -22.88327180491258, -20.07646189958593, -12.512681423129973, 8.867763974796816, -3.749849340882175, -21.50471461249191, 5.431867792870342, 8.87601039978081, -13.433282400694171, -35.52939858551476, -19.245840088699758, 7.026287433209355, -18.896070976081788, -31.897804732826735, -15.849365631583513, -15.225911107860718, -26.11659249972807, 10.119139560245607, -23.884250970679304, 2.6492924709483674, -8.092220257332201, -7.617467518538163, -1.1084576427189106, 13.530061745751581, -33.05275703651268, -17.211110622966167, -2.782431960874895, -36.538006932840744, -7.527025457136514, -15.529835599324091, -12.307929290022752, -7.605527811792811, -7.362360691418864, -5.696787061732948, -7.423492081789245, -33.50438749868255, -6.380278039032934, 18.14045919232472, -11.543673706732243, -2.2046006518911447, -2.0812828407383837, -18.51236460216719, -10.65409501477641, -11.735157307466093, -21.37854991000441, -19.93737063692328, 1.4673676560455018, -7.70248180038973, -7.858928126120055, -23.71398644248671, -22.776126818370827, -8.339825207384013, 3.989143274257742, -15.468994028178912, -6.445497435192916, -14.197952561310302, -2.1920720725053364, -23.109795453994785, -14.48899715673942, 3.359339521081568, 3.553534540792654, -33.02039216332854, -8.813244587544375, -26.444960681325554, -26.962105066294196, -17.381578289275968, -9.108244035919299, 2.0978358289036763, -28.395050132706324, -12.325961098118885, -1.6833251405857226, -4.677746582133665, 4.537767511631046, -10.504879395319591, 6.28656065824682, -1.4661184130435885, 12.916343254518079]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44981591046160463, "mean_inference_ms": 1.2004084272831022, "mean_action_processing_ms": 0.19546262713364673, "mean_env_wait_ms": 0.08009835883552517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004102230072021484, "StateBufferConnector_ms": 0.003434896469116211, "ViewRequirementAgentConnector_ms": 0.09054052829742432}, "num_episodes": 11, "episode_return_max": 22.49216610736979, "episode_return_min": -32.67803177984928, "episode_return_mean": -11.117342855202388}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 455.40742736959874, "num_env_steps_trained_throughput_per_sec": 455.40742736959874, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 9060.628, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9060.507, "sample_time_ms": 966.798, "learn_time_ms": 8079.885, "learn_throughput": 495.057, "synch_weights_time_ms": 13.092}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 50, "trial_id": "83a5c_00000", "date": "2024-08-10_12-21-12", "timestamp": 1723306872, "time_this_iter_s": 8.793673038482666, "time_total_s": 436.4125199317932, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61a0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 436.4125199317932, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 30.28461538461538, "ram_util_percent": 82.92307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2776845610646346, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.96273777573197, "policy_loss": -0.006238654797413835, "vf_loss": 3.9683303853191396, "vf_explained_var": 0.22745350829507938, "kl": 0.006806105502757525, "entropy": 1.4431502289242215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.498268133401871, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.046146371215582, "policy_loss": -0.003384966252876135, "vf_loss": 3.0491407748311756, "vf_explained_var": 0.5271821026379864, "kl": 0.006171730531532658, "entropy": 0.78494005681326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "env_runners": {"episode_reward_max": 22.49216610736979, "episode_reward_min": -32.67803177984928, "episode_reward_mean": -11.008627514345633, "episode_len_mean": 388.33, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38833, "policy_reward_min": {"agent_policy": -22.492166107369787, "adversary_policy": -39.230231982070705}, "policy_reward_max": {"agent_policy": 32.678031779849256, "adversary_policy": 34.75365298051265}, "policy_reward_mean": {"agent_policy": 11.008627514345635, "adversary_policy": -11.00862751434563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.601540003325267, -9.647640648570615, -10.804487742969751, -32.67803177984928, -20.67610276667873, -9.879662166419402, -13.067940532153566, -30.62075729209392, -8.236748850220602, -17.233470906812, 9.76152324738938, -15.305735478129863, -15.792307725709353, -10.703649387094064, -24.48166634926254, 8.83369568687548, -12.818702304286935, -24.978740637798442, -16.643707278197244, -18.431768215277472, -14.946283070093346, -12.337910303231848, -16.143328868510345, -19.204529910467958, -5.403111353071409, -12.5094715646153, -12.21150720997915, 0.8812564074706746, -22.95419551970238, 22.49216610736979, -5.29574275743466, -0.6479577091859063, -20.798072642451377, -18.49448730307298, -17.20323414724022, -16.71611278473466, -15.272198504792723, -12.441818665144076, 0.16991830563283905, -10.868805668971305, -13.454354990853348, -9.165036537728268, -4.431837874452823, 3.485050375994696, -3.7830743571515892, -8.648565145508467, -19.510725235738082, 3.752986288151039, -23.73597860972613, -16.294571661357953, 2.5589573169573203, -8.036423409810782, -2.2786360004566806, -27.387619337107264, -5.934891771436217, -23.873585182205122, -20.671251803794394, -6.8825557052168485, -2.721463893191917, -4.362962580628537, -9.76134764538055, -9.99677129192053, -22.032516194988634, -13.918882444673422, -7.483944251605839, -6.560139571761097, -19.94233276885774, 3.2983927427962385, -2.142941746314767, -14.583229808471796, -16.55685360873525, -9.235001490438885, -7.780704963254893, -23.245056630428778, -2.1753409665631356, -10.957245731685912, -8.195012316907821, -18.799396305367097, 3.4564370309371113, -20.916818375436456, -26.703532873809877, -13.244911162597631, -13.148607151901325, -7.004643119352302, -0.06998953525130958, -2.1091593685363854, 5.725112420737245, -4.402945759739168, -2.9606958850946317, -10.351605895057162, -22.024068931111092, 6.838808059974337, -21.073627680023396, -11.627511298501823, -24.24012965742099, -25.08697935884387, -17.62657966963421, -16.35737345861336, -19.041184236077846, 2.261907866772122], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3], "policy_agent_policy_reward": [-13.601540003325267, 9.647640648570615, 10.804487742969748, 32.678031779849256, 20.67610276667873, 9.879662166419402, 13.067940532153568, 30.620757292093884, 8.2367488502206, 17.233470906812, -9.76152324738938, 15.305735478129892, 15.792307725709353, 10.703649387094064, 24.481666349262543, -8.833695686875473, 12.818702304286939, 24.978740637798445, 16.64370727819725, 18.431768215277472, 14.946283070093349, 12.337910303231848, 16.143328868510352, 19.20452991046796, 5.403111353071409, 12.5094715646153, 12.21150720997915, -0.8812564074706746, 22.954195519702385, -22.492166107369787, 5.29574275743466, 0.6479577091859063, 20.798072642451373, 18.494487303072976, 17.20323414724023, 16.71611278473467, 15.272198504792712, 12.441818665144076, -0.16991830563283905, 10.868805668971305, 13.454354990853348, 9.165036537728266, 4.431837874452824, -3.485050375994698, 3.7830743571515892, 8.648565145508467, 19.510725235738082, -3.752986288151039, 23.73597860972613, 16.294571661357953, -2.5589573169573203, 8.036423409810784, 2.2786360004566806, 27.38761933710726, 5.934891771436217, 23.873585182205122, 20.671251803794398, 6.8825557052168485, 2.721463893191917, 4.362962580628537, 9.76134764538055, 9.996771291920531, 22.03251619498863, 13.918882444673422, 7.483944251605839, 6.560139571761097, 19.942332768857742, -3.2983927427962385, 2.1429417463147686, 14.583229808471796, 16.556853608735256, 9.235001490438888, 7.780704963254893, 23.24505663042878, 2.1753409665631356, 10.957245731685916, 8.19501231690782, 18.7993963053671, -3.456437030937111, 20.91681837543646, 26.703532873809873, 13.244911162597631, 13.148607151901325, 7.004643119352304, 0.06998953525130958, 2.1091593685363854, -5.725112420737245, 4.402945759739168, 2.9606958850946317, 10.351605895057162, 22.024068931111092, -6.838808059974337, 21.0736276800234, 11.627511298501824, 24.24012965742099, 25.086979358843873, 17.62657966963421, 16.35737345861336, 19.041184236077846, -2.261907866772122], "policy_adversary_policy_reward": [10.814357115540776, 16.388722891109737, 11.65356061261037, -30.9488419097516, -16.557655945100848, -5.051319540838655, -26.125831577627746, -39.230231982070705, -13.777400130264297, -27.574805403093166, -6.540285516527291, -13.219038816311514, -13.953609691681596, -12.18227137262554, -23.668463249834502, -37.573051334353266, -26.719098336280688, 10.245600635839487, -12.907381981623057, -21.55955983200094, 16.873207542726867, 2.649838952051894, -17.946817787914753, -12.66465316834504, -30.033511145505578, -1.5511043059131282, -11.581132283919278, -9.82616649026885, -36.33734585926457, -12.625986839260499, -3.358988984120227, 21.026380357871176, -12.994166103792232, -12.643238504781639, -24.65172646956419, -25.305754806032688, -29.272574727717725, -4.014839828676781, -10.592313084342038, -26.271223346212903, -14.238871675415467, -15.65369446477122, -12.974376551114116, -11.701444055349576, -6.512919933979308, -25.77373780304138, -31.597399608327038, -6.811660212608903, -7.796681281536706, -3.0095414246061125, -27.14059341475042, 2.12165028551982, -18.370824159336912, -6.052190260621387, -5.973318652044988, 7.735831466986337, -33.447263753258255, -12.461127286146507, 10.230679234226926, 34.75365298051265, -23.865717091832202, 13.274231576962883, 6.884600617231975, -8.180516035603787, -25.63447608150072, -15.961669203402025, -6.783485362110433, -30.20548924403552, -3.8848600130256727, -30.521608281454775, -9.94133429634164, -23.49089127312765, -13.326849822619515, -17.21754718696591, -26.537190495316807, 1.6535531650286543, -6.8546641910284585, 7.194500802294137, -14.729709704536472, -7.007901633406139, -25.35703290399919, -1.5516770777075024, -19.01278289666074, 0.682709821204206, 0.4569134981213274, -9.320589247026984, 3.45048562920104, 3.5196151227883554, 1.2995218896139633, -8.865670603917142, -14.64668337703435, -2.6504469139825844, -17.409524696265656, -21.611925775210498, 2.949898479516733, 4.556074096785345, -24.588685414539675, -22.88327180491258, -20.07646189958593, -12.512681423129973, 8.867763974796816, -3.749849340882175, -21.50471461249191, 5.431867792870342, 8.87601039978081, -13.433282400694171, -35.52939858551476, -19.245840088699758, 7.026287433209355, -18.896070976081788, -31.897804732826735, -15.849365631583513, -15.225911107860718, -26.11659249972807, 10.119139560245607, -23.884250970679304, 2.6492924709483674, -8.092220257332201, -7.617467518538163, -1.1084576427189106, 13.530061745751581, -33.05275703651268, -17.211110622966167, -2.782431960874895, -36.538006932840744, -7.527025457136514, -15.529835599324091, -12.307929290022752, -7.605527811792811, -7.362360691418864, -5.696787061732948, -7.423492081789245, -33.50438749868255, -6.380278039032934, 18.14045919232472, -11.543673706732243, -2.2046006518911447, -2.0812828407383837, -18.51236460216719, -10.65409501477641, -11.735157307466093, -21.37854991000441, -19.93737063692328, 1.4673676560455018, -7.70248180038973, -7.858928126120055, -23.71398644248671, -22.776126818370827, -8.339825207384013, 3.989143274257742, -15.468994028178912, -6.445497435192916, -14.197952561310302, -2.1920720725053364, -23.109795453994785, -14.48899715673942, 3.359339521081568, 3.553534540792654, -33.02039216332854, -8.813244587544375, -26.444960681325554, -26.962105066294196, -17.381578289275968, -9.108244035919299, 2.0978358289036763, -28.395050132706324, -12.325961098118885, -1.6833251405857226, -4.677746582133665, 4.537767511631046, -10.504879395319591, 6.28656065824682, -1.4661184130435885, 12.916343254518079, -1.5253104067439764, -7.28058111273436, 0.307491955640657, -6.22888372582992, -10.10295430467323, -10.600257485441094, -9.767303550781836, -34.280834311440344, 4.453279898580774, 9.2243362213679, -25.3561408771834, -16.79111448286337, -15.97626538010164, -7.278757216902008, -19.87009125053075, -28.61016806431123, -27.880289183289136, -22.293669534398603, -26.009023262439595, -9.244136076828823, -10.401395797459362, -22.31335111976736, -13.32875507636803, -24.753613395787667, 1.5534996415129478, 2.970316092031296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45023066020899594, "mean_inference_ms": 1.2019634314349665, "mean_action_processing_ms": 0.19568850109699223, "mean_env_wait_ms": 0.0802736502110878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040749311447143555, "StateBufferConnector_ms": 0.0030460357666015625, "ViewRequirementAgentConnector_ms": 0.09008288383483887}, "num_episodes": 13, "episode_return_max": 22.49216610736979, "episode_return_min": -32.67803177984928, "episode_return_mean": -11.008627514345633}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.98497922011825, "num_env_steps_trained_throughput_per_sec": 452.98497922011825, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 9060.175, "restore_workers_time_ms": 0.017, "training_step_time_ms": 9060.053, "sample_time_ms": 967.364, "learn_time_ms": 8078.393, "learn_throughput": 495.148, "synch_weights_time_ms": 13.551}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "training_iteration": 51, "trial_id": "83a5c_00000", "date": "2024-08-10_12-21-21", "timestamp": 1723306881, "time_this_iter_s": 8.836542844772339, "time_total_s": 445.24906277656555, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a6dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 445.24906277656555, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 31.875, "ram_util_percent": 82.98333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2311496696144184, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6443626353349634, "policy_loss": -0.005058253476169532, "vf_loss": 3.6485880870667713, "vf_explained_var": 0.11443632768575476, "kl": 0.008773589303426468, "entropy": 1.441739110278074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6593863921550414, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.657025297731161, "policy_loss": -0.006830611193921262, "vf_loss": 3.6628942511975766, "vf_explained_var": 0.4321943276251356, "kl": 0.015196602446142012, "entropy": 0.6978846414635579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 22.49216610736979, "episode_reward_min": -27.387619337107264, "episode_reward_mean": -10.883887402877098, "episode_len_mean": 388.33, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38833, "policy_reward_min": {"agent_policy": -22.492166107369787, "adversary_policy": -36.538006932840744}, "policy_reward_max": {"agent_policy": 27.38761933710726, "adversary_policy": 34.75365298051265}, "policy_reward_mean": {"agent_policy": 10.8838874028771, "adversary_policy": -10.883887402877098}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.233470906812, 9.76152324738938, -15.305735478129863, -15.792307725709353, -10.703649387094064, -24.48166634926254, 8.83369568687548, -12.818702304286935, -24.978740637798442, -16.643707278197244, -18.431768215277472, -14.946283070093346, -12.337910303231848, -16.143328868510345, -19.204529910467958, -5.403111353071409, -12.5094715646153, -12.21150720997915, 0.8812564074706746, -22.95419551970238, 22.49216610736979, -5.29574275743466, -0.6479577091859063, -20.798072642451377, -18.49448730307298, -17.20323414724022, -16.71611278473466, -15.272198504792723, -12.441818665144076, 0.16991830563283905, -10.868805668971305, -13.454354990853348, -9.165036537728268, -4.431837874452823, 3.485050375994696, -3.7830743571515892, -8.648565145508467, -19.510725235738082, 3.752986288151039, -23.73597860972613, -16.294571661357953, 2.5589573169573203, -8.036423409810782, -2.2786360004566806, -27.387619337107264, -5.934891771436217, -23.873585182205122, -20.671251803794394, -6.8825557052168485, -2.721463893191917, -4.362962580628537, -9.76134764538055, -9.99677129192053, -22.032516194988634, -13.918882444673422, -7.483944251605839, -6.560139571761097, -19.94233276885774, 3.2983927427962385, -2.142941746314767, -14.583229808471796, -16.55685360873525, -9.235001490438885, -7.780704963254893, -23.245056630428778, -2.1753409665631356, -10.957245731685912, -8.195012316907821, -18.799396305367097, 3.4564370309371113, -20.916818375436456, -26.703532873809877, -13.244911162597631, -13.148607151901325, -7.004643119352302, -0.06998953525130958, -2.1091593685363854, 5.725112420737245, -4.402945759739168, -2.9606958850946317, -10.351605895057162, -22.024068931111092, 6.838808059974337, -21.073627680023396, -11.627511298501823, -24.24012965742099, -25.08697935884387, -17.62657966963421, -16.35737345861336, -19.041184236077846, 2.261907866772122, -4.882300700905043, -12.602606901810145, -2.2386753520984453, -21.727863901466893, -16.207341540372482, -21.423400310627038, -11.160291759380844, 2.8644162275473306, -22.157756389663568], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [17.233470906812, -9.76152324738938, 15.305735478129892, 15.792307725709353, 10.703649387094064, 24.481666349262543, -8.833695686875473, 12.818702304286939, 24.978740637798445, 16.64370727819725, 18.431768215277472, 14.946283070093349, 12.337910303231848, 16.143328868510352, 19.20452991046796, 5.403111353071409, 12.5094715646153, 12.21150720997915, -0.8812564074706746, 22.954195519702385, -22.492166107369787, 5.29574275743466, 0.6479577091859063, 20.798072642451373, 18.494487303072976, 17.20323414724023, 16.71611278473467, 15.272198504792712, 12.441818665144076, -0.16991830563283905, 10.868805668971305, 13.454354990853348, 9.165036537728266, 4.431837874452824, -3.485050375994698, 3.7830743571515892, 8.648565145508467, 19.510725235738082, -3.752986288151039, 23.73597860972613, 16.294571661357953, -2.5589573169573203, 8.036423409810784, 2.2786360004566806, 27.38761933710726, 5.934891771436217, 23.873585182205122, 20.671251803794398, 6.8825557052168485, 2.721463893191917, 4.362962580628537, 9.76134764538055, 9.996771291920531, 22.03251619498863, 13.918882444673422, 7.483944251605839, 6.560139571761097, 19.942332768857742, -3.2983927427962385, 2.1429417463147686, 14.583229808471796, 16.556853608735256, 9.235001490438888, 7.780704963254893, 23.24505663042878, 2.1753409665631356, 10.957245731685916, 8.19501231690782, 18.7993963053671, -3.456437030937111, 20.91681837543646, 26.703532873809873, 13.244911162597631, 13.148607151901325, 7.004643119352304, 0.06998953525130958, 2.1091593685363854, -5.725112420737245, 4.402945759739168, 2.9606958850946317, 10.351605895057162, 22.024068931111092, -6.838808059974337, 21.0736276800234, 11.627511298501824, 24.24012965742099, 25.086979358843873, 17.62657966963421, 16.35737345861336, 19.041184236077846, -2.261907866772122, 4.882300700905043, 12.602606901810145, 2.2386753520984453, 21.727863901466904, 16.207341540372482, 21.423400310627038, 11.160291759380844, -2.8644162275473306, 22.157756389663568], "policy_adversary_policy_reward": [-12.907381981623057, -21.55955983200094, 16.873207542726867, 2.649838952051894, -17.946817787914753, -12.66465316834504, -30.033511145505578, -1.5511043059131282, -11.581132283919278, -9.82616649026885, -36.33734585926457, -12.625986839260499, -3.358988984120227, 21.026380357871176, -12.994166103792232, -12.643238504781639, -24.65172646956419, -25.305754806032688, -29.272574727717725, -4.014839828676781, -10.592313084342038, -26.271223346212903, -14.238871675415467, -15.65369446477122, -12.974376551114116, -11.701444055349576, -6.512919933979308, -25.77373780304138, -31.597399608327038, -6.811660212608903, -7.796681281536706, -3.0095414246061125, -27.14059341475042, 2.12165028551982, -18.370824159336912, -6.052190260621387, -5.973318652044988, 7.735831466986337, -33.447263753258255, -12.461127286146507, 10.230679234226926, 34.75365298051265, -23.865717091832202, 13.274231576962883, 6.884600617231975, -8.180516035603787, -25.63447608150072, -15.961669203402025, -6.783485362110433, -30.20548924403552, -3.8848600130256727, -30.521608281454775, -9.94133429634164, -23.49089127312765, -13.326849822619515, -17.21754718696591, -26.537190495316807, 1.6535531650286543, -6.8546641910284585, 7.194500802294137, -14.729709704536472, -7.007901633406139, -25.35703290399919, -1.5516770777075024, -19.01278289666074, 0.682709821204206, 0.4569134981213274, -9.320589247026984, 3.45048562920104, 3.5196151227883554, 1.2995218896139633, -8.865670603917142, -14.64668337703435, -2.6504469139825844, -17.409524696265656, -21.611925775210498, 2.949898479516733, 4.556074096785345, -24.588685414539675, -22.88327180491258, -20.07646189958593, -12.512681423129973, 8.867763974796816, -3.749849340882175, -21.50471461249191, 5.431867792870342, 8.87601039978081, -13.433282400694171, -35.52939858551476, -19.245840088699758, 7.026287433209355, -18.896070976081788, -31.897804732826735, -15.849365631583513, -15.225911107860718, -26.11659249972807, 10.119139560245607, -23.884250970679304, 2.6492924709483674, -8.092220257332201, -7.617467518538163, -1.1084576427189106, 13.530061745751581, -33.05275703651268, -17.211110622966167, -2.782431960874895, -36.538006932840744, -7.527025457136514, -15.529835599324091, -12.307929290022752, -7.605527811792811, -7.362360691418864, -5.696787061732948, -7.423492081789245, -33.50438749868255, -6.380278039032934, 18.14045919232472, -11.543673706732243, -2.2046006518911447, -2.0812828407383837, -18.51236460216719, -10.65409501477641, -11.735157307466093, -21.37854991000441, -19.93737063692328, 1.4673676560455018, -7.70248180038973, -7.858928126120055, -23.71398644248671, -22.776126818370827, -8.339825207384013, 3.989143274257742, -15.468994028178912, -6.445497435192916, -14.197952561310302, -2.1920720725053364, -23.109795453994785, -14.48899715673942, 3.359339521081568, 3.553534540792654, -33.02039216332854, -8.813244587544375, -26.444960681325554, -26.962105066294196, -17.381578289275968, -9.108244035919299, 2.0978358289036763, -28.395050132706324, -12.325961098118885, -1.6833251405857226, -4.677746582133665, 4.537767511631046, -10.504879395319591, 6.28656065824682, -1.4661184130435885, 12.916343254518079, -1.5253104067439764, -7.28058111273436, 0.307491955640657, -6.22888372582992, -10.10295430467323, -10.600257485441094, -9.767303550781836, -34.280834311440344, 4.453279898580774, 9.2243362213679, -25.3561408771834, -16.79111448286337, -15.97626538010164, -7.278757216902008, -19.87009125053075, -28.61016806431123, -27.880289183289136, -22.293669534398603, -26.009023262439595, -9.244136076828823, -10.401395797459362, -22.31335111976736, -13.32875507636803, -24.753613395787667, 1.5534996415129478, 2.970316092031296, 9.203989714969069, -18.968591116779155, -21.13650524187372, -4.068708561746593, 25.9607243522193, -30.438075056416196, -19.99467482356937, -23.461052979364457, -28.133484262876685, -4.28119881786828, -25.199853148770067, -17.646947472484012, -17.426629110689525, -4.893954408072158, -0.19770708417858174, 5.926539539273243, -29.126071682117534, -15.189441097209599]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4507147382988457, "mean_inference_ms": 1.2033939173266857, "mean_action_processing_ms": 0.19587552629624003, "mean_env_wait_ms": 0.08041454886141043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004074215888977051, "StateBufferConnector_ms": 0.003059864044189453, "ViewRequirementAgentConnector_ms": 0.08712172508239746}, "num_episodes": 9, "episode_return_max": 22.49216610736979, "episode_return_min": -27.387619337107264, "episode_return_mean": -10.883887402877098}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 439.85621184095925, "num_env_steps_trained_throughput_per_sec": 439.85621184095925, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 9079.9, "restore_workers_time_ms": 0.026, "training_step_time_ms": 9079.765, "sample_time_ms": 985.417, "learn_time_ms": 8079.867, "learn_throughput": 495.058, "synch_weights_time_ms": 13.689}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 52, "trial_id": "83a5c_00000", "date": "2024-08-10_12-21-30", "timestamp": 1723306890, "time_this_iter_s": 9.099162101745605, "time_total_s": 454.34822487831116, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fae5af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 454.34822487831116, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 32.55, "ram_util_percent": 82.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.260679877876605, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.508448675952891, "policy_loss": -0.0020633255876847125, "vf_loss": 3.5098656611467796, "vf_explained_var": -0.4134935023608031, "kl": 0.00680915554703002, "entropy": 1.4531337775881328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4383236136597892, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.969637832045555, "policy_loss": -0.0039557998553694535, "vf_loss": 2.9733256393422685, "vf_explained_var": 0.1351768699164192, "kl": 0.004234931062056983, "entropy": 0.6773313930258155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "env_runners": {"episode_reward_max": 22.49216610736979, "episode_reward_min": -27.387619337107264, "episode_reward_mean": -10.967240869805915, "episode_len_mean": 388.33, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38833, "policy_reward_min": {"agent_policy": -22.492166107369787, "adversary_policy": -36.538006932840744}, "policy_reward_max": {"agent_policy": 27.38761933710726, "adversary_policy": 34.75365298051265}, "policy_reward_mean": {"agent_policy": 10.967240869805915, "adversary_policy": -10.96724086980591}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.643707278197244, -18.431768215277472, -14.946283070093346, -12.337910303231848, -16.143328868510345, -19.204529910467958, -5.403111353071409, -12.5094715646153, -12.21150720997915, 0.8812564074706746, -22.95419551970238, 22.49216610736979, -5.29574275743466, -0.6479577091859063, -20.798072642451377, -18.49448730307298, -17.20323414724022, -16.71611278473466, -15.272198504792723, -12.441818665144076, 0.16991830563283905, -10.868805668971305, -13.454354990853348, -9.165036537728268, -4.431837874452823, 3.485050375994696, -3.7830743571515892, -8.648565145508467, -19.510725235738082, 3.752986288151039, -23.73597860972613, -16.294571661357953, 2.5589573169573203, -8.036423409810782, -2.2786360004566806, -27.387619337107264, -5.934891771436217, -23.873585182205122, -20.671251803794394, -6.8825557052168485, -2.721463893191917, -4.362962580628537, -9.76134764538055, -9.99677129192053, -22.032516194988634, -13.918882444673422, -7.483944251605839, -6.560139571761097, -19.94233276885774, 3.2983927427962385, -2.142941746314767, -14.583229808471796, -16.55685360873525, -9.235001490438885, -7.780704963254893, -23.245056630428778, -2.1753409665631356, -10.957245731685912, -8.195012316907821, -18.799396305367097, 3.4564370309371113, -20.916818375436456, -26.703532873809877, -13.244911162597631, -13.148607151901325, -7.004643119352302, -0.06998953525130958, -2.1091593685363854, 5.725112420737245, -4.402945759739168, -2.9606958850946317, -10.351605895057162, -22.024068931111092, 6.838808059974337, -21.073627680023396, -11.627511298501823, -24.24012965742099, -25.08697935884387, -17.62657966963421, -16.35737345861336, -19.041184236077846, 2.261907866772122, -4.882300700905043, -12.602606901810145, -2.2386753520984453, -21.727863901466893, -16.207341540372482, -21.423400310627038, -11.160291759380844, 2.8644162275473306, -22.157756389663568, -19.9590161704214, 0.415343685092596, -22.19093843990887, -5.767423947567499, -20.315853358297574, -20.686448094502687, -4.568738074528145, 3.094121127520417, -21.07544727509652], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 23, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [16.64370727819725, 18.431768215277472, 14.946283070093349, 12.337910303231848, 16.143328868510352, 19.20452991046796, 5.403111353071409, 12.5094715646153, 12.21150720997915, -0.8812564074706746, 22.954195519702385, -22.492166107369787, 5.29574275743466, 0.6479577091859063, 20.798072642451373, 18.494487303072976, 17.20323414724023, 16.71611278473467, 15.272198504792712, 12.441818665144076, -0.16991830563283905, 10.868805668971305, 13.454354990853348, 9.165036537728266, 4.431837874452824, -3.485050375994698, 3.7830743571515892, 8.648565145508467, 19.510725235738082, -3.752986288151039, 23.73597860972613, 16.294571661357953, -2.5589573169573203, 8.036423409810784, 2.2786360004566806, 27.38761933710726, 5.934891771436217, 23.873585182205122, 20.671251803794398, 6.8825557052168485, 2.721463893191917, 4.362962580628537, 9.76134764538055, 9.996771291920531, 22.03251619498863, 13.918882444673422, 7.483944251605839, 6.560139571761097, 19.942332768857742, -3.2983927427962385, 2.1429417463147686, 14.583229808471796, 16.556853608735256, 9.235001490438888, 7.780704963254893, 23.24505663042878, 2.1753409665631356, 10.957245731685916, 8.19501231690782, 18.7993963053671, -3.456437030937111, 20.91681837543646, 26.703532873809873, 13.244911162597631, 13.148607151901325, 7.004643119352304, 0.06998953525130958, 2.1091593685363854, -5.725112420737245, 4.402945759739168, 2.9606958850946317, 10.351605895057162, 22.024068931111092, -6.838808059974337, 21.0736276800234, 11.627511298501824, 24.24012965742099, 25.086979358843873, 17.62657966963421, 16.35737345861336, 19.041184236077846, -2.261907866772122, 4.882300700905043, 12.602606901810145, 2.2386753520984453, 21.727863901466904, 16.207341540372482, 21.423400310627038, 11.160291759380844, -2.8644162275473306, 22.157756389663568, 19.9590161704214, -0.415343685092596, 22.190938439908866, 5.767423947567499, 20.315853358297577, 20.686448094502698, 4.568738074528145, -3.094121127520417, 21.075447275096515], "policy_adversary_policy_reward": [-29.272574727717725, -4.014839828676781, -10.592313084342038, -26.271223346212903, -14.238871675415467, -15.65369446477122, -12.974376551114116, -11.701444055349576, -6.512919933979308, -25.77373780304138, -31.597399608327038, -6.811660212608903, -7.796681281536706, -3.0095414246061125, -27.14059341475042, 2.12165028551982, -18.370824159336912, -6.052190260621387, -5.973318652044988, 7.735831466986337, -33.447263753258255, -12.461127286146507, 10.230679234226926, 34.75365298051265, -23.865717091832202, 13.274231576962883, 6.884600617231975, -8.180516035603787, -25.63447608150072, -15.961669203402025, -6.783485362110433, -30.20548924403552, -3.8848600130256727, -30.521608281454775, -9.94133429634164, -23.49089127312765, -13.326849822619515, -17.21754718696591, -26.537190495316807, 1.6535531650286543, -6.8546641910284585, 7.194500802294137, -14.729709704536472, -7.007901633406139, -25.35703290399919, -1.5516770777075024, -19.01278289666074, 0.682709821204206, 0.4569134981213274, -9.320589247026984, 3.45048562920104, 3.5196151227883554, 1.2995218896139633, -8.865670603917142, -14.64668337703435, -2.6504469139825844, -17.409524696265656, -21.611925775210498, 2.949898479516733, 4.556074096785345, -24.588685414539675, -22.88327180491258, -20.07646189958593, -12.512681423129973, 8.867763974796816, -3.749849340882175, -21.50471461249191, 5.431867792870342, 8.87601039978081, -13.433282400694171, -35.52939858551476, -19.245840088699758, 7.026287433209355, -18.896070976081788, -31.897804732826735, -15.849365631583513, -15.225911107860718, -26.11659249972807, 10.119139560245607, -23.884250970679304, 2.6492924709483674, -8.092220257332201, -7.617467518538163, -1.1084576427189106, 13.530061745751581, -33.05275703651268, -17.211110622966167, -2.782431960874895, -36.538006932840744, -7.527025457136514, -15.529835599324091, -12.307929290022752, -7.605527811792811, -7.362360691418864, -5.696787061732948, -7.423492081789245, -33.50438749868255, -6.380278039032934, 18.14045919232472, -11.543673706732243, -2.2046006518911447, -2.0812828407383837, -18.51236460216719, -10.65409501477641, -11.735157307466093, -21.37854991000441, -19.93737063692328, 1.4673676560455018, -7.70248180038973, -7.858928126120055, -23.71398644248671, -22.776126818370827, -8.339825207384013, 3.989143274257742, -15.468994028178912, -6.445497435192916, -14.197952561310302, -2.1920720725053364, -23.109795453994785, -14.48899715673942, 3.359339521081568, 3.553534540792654, -33.02039216332854, -8.813244587544375, -26.444960681325554, -26.962105066294196, -17.381578289275968, -9.108244035919299, 2.0978358289036763, -28.395050132706324, -12.325961098118885, -1.6833251405857226, -4.677746582133665, 4.537767511631046, -10.504879395319591, 6.28656065824682, -1.4661184130435885, 12.916343254518079, -1.5253104067439764, -7.28058111273436, 0.307491955640657, -6.22888372582992, -10.10295430467323, -10.600257485441094, -9.767303550781836, -34.280834311440344, 4.453279898580774, 9.2243362213679, -25.3561408771834, -16.79111448286337, -15.97626538010164, -7.278757216902008, -19.87009125053075, -28.61016806431123, -27.880289183289136, -22.293669534398603, -26.009023262439595, -9.244136076828823, -10.401395797459362, -22.31335111976736, -13.32875507636803, -24.753613395787667, 1.5534996415129478, 2.970316092031296, 9.203989714969069, -18.968591116779155, -21.13650524187372, -4.068708561746593, 25.9607243522193, -30.438075056416196, -19.99467482356937, -23.461052979364457, -28.133484262876685, -4.28119881786828, -25.199853148770067, -17.646947472484012, -17.426629110689525, -4.893954408072158, -0.19770708417858174, 5.926539539273243, -29.126071682117534, -15.189441097209599, -21.720368987678757, -18.197663353164035, -8.854234977825858, 9.68492234801105, -20.16848325387838, -24.21339362593935, -2.036357685920983, -9.498490209214015, -26.838666232544995, -13.793040484050156, -22.457513897378895, -18.915382291626493, -10.981327062473824, 1.8438509134175334, 9.962325767296164, -3.7740835122553307, -16.18312258264764, -25.9677719675454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4508310880258234, "mean_inference_ms": 1.2041714165794835, "mean_action_processing_ms": 0.19590177897053063, "mean_env_wait_ms": 0.08048582615194937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004051923751831055, "StateBufferConnector_ms": 0.003088712692260742, "ViewRequirementAgentConnector_ms": 0.08539330959320068}, "num_episodes": 9, "episode_return_max": 22.49216610736979, "episode_return_min": -27.387619337107264, "episode_return_mean": -10.967240869805915}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.0841405915817, "num_env_steps_trained_throughput_per_sec": 426.0841405915817, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 9055.955, "restore_workers_time_ms": 0.031, "training_step_time_ms": 9055.811, "sample_time_ms": 969.22, "learn_time_ms": 8071.438, "learn_throughput": 495.575, "synch_weights_time_ms": 14.355}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "training_iteration": 53, "trial_id": "83a5c_00000", "date": "2024-08-10_12-21-40", "timestamp": 1723306900, "time_this_iter_s": 9.40972089767456, "time_total_s": 463.7579457759857, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb63670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 463.7579457759857, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 39.96923076923077, "ram_util_percent": 83.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1197939392120118, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.409395370155415, "policy_loss": -0.003030496496441109, "vf_loss": 3.412252267075594, "vf_explained_var": -0.11802559986947075, "kl": 0.0018289574710664697, "entropy": 1.4606572357435075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.369338671459506, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1778800752013923, "policy_loss": -0.004548335444269469, "vf_loss": 2.1821641214191914, "vf_explained_var": 0.24880409228305023, "kl": 0.00835269259830703, "entropy": 0.6999409069617589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 22.49216610736979, "episode_reward_min": -27.387619337107264, "episode_reward_mean": -9.820845501883511, "episode_len_mean": 384.51, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38451, "policy_reward_min": {"agent_policy": -22.492166107369787, "adversary_policy": -36.538006932840744}, "policy_reward_max": {"agent_policy": 27.38761933710726, "adversary_policy": 34.75365298051265}, "policy_reward_mean": {"agent_policy": 9.820845501883513, "adversary_policy": -9.820845501883511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.95419551970238, 22.49216610736979, -5.29574275743466, -0.6479577091859063, -20.798072642451377, -18.49448730307298, -17.20323414724022, -16.71611278473466, -15.272198504792723, -12.441818665144076, 0.16991830563283905, -10.868805668971305, -13.454354990853348, -9.165036537728268, -4.431837874452823, 3.485050375994696, -3.7830743571515892, -8.648565145508467, -19.510725235738082, 3.752986288151039, -23.73597860972613, -16.294571661357953, 2.5589573169573203, -8.036423409810782, -2.2786360004566806, -27.387619337107264, -5.934891771436217, -23.873585182205122, -20.671251803794394, -6.8825557052168485, -2.721463893191917, -4.362962580628537, -9.76134764538055, -9.99677129192053, -22.032516194988634, -13.918882444673422, -7.483944251605839, -6.560139571761097, -19.94233276885774, 3.2983927427962385, -2.142941746314767, -14.583229808471796, -16.55685360873525, -9.235001490438885, -7.780704963254893, -23.245056630428778, -2.1753409665631356, -10.957245731685912, -8.195012316907821, -18.799396305367097, 3.4564370309371113, -20.916818375436456, -26.703532873809877, -13.244911162597631, -13.148607151901325, -7.004643119352302, -0.06998953525130958, -2.1091593685363854, 5.725112420737245, -4.402945759739168, -2.9606958850946317, -10.351605895057162, -22.024068931111092, 6.838808059974337, -21.073627680023396, -11.627511298501823, -24.24012965742099, -25.08697935884387, -17.62657966963421, -16.35737345861336, -19.041184236077846, 2.261907866772122, -4.882300700905043, -12.602606901810145, -2.2386753520984453, -21.727863901466893, -16.207341540372482, -21.423400310627038, -11.160291759380844, 2.8644162275473306, -22.157756389663568, -19.9590161704214, 0.415343685092596, -22.19093843990887, -5.767423947567499, -20.315853358297574, -20.686448094502687, -4.568738074528145, 3.094121127520417, -21.07544727509652, -17.250059415397114, 1.1297224227435763, -2.241058836909259, 6.17906840296909, -3.283107470149945, -19.928427442282388, 10.544249422555, -5.283773640038435, 2.8796156252946243, 14.942946357481434], "episode_lengths": [400, 23, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18], "policy_agent_policy_reward": [22.954195519702385, -22.492166107369787, 5.29574275743466, 0.6479577091859063, 20.798072642451373, 18.494487303072976, 17.20323414724023, 16.71611278473467, 15.272198504792712, 12.441818665144076, -0.16991830563283905, 10.868805668971305, 13.454354990853348, 9.165036537728266, 4.431837874452824, -3.485050375994698, 3.7830743571515892, 8.648565145508467, 19.510725235738082, -3.752986288151039, 23.73597860972613, 16.294571661357953, -2.5589573169573203, 8.036423409810784, 2.2786360004566806, 27.38761933710726, 5.934891771436217, 23.873585182205122, 20.671251803794398, 6.8825557052168485, 2.721463893191917, 4.362962580628537, 9.76134764538055, 9.996771291920531, 22.03251619498863, 13.918882444673422, 7.483944251605839, 6.560139571761097, 19.942332768857742, -3.2983927427962385, 2.1429417463147686, 14.583229808471796, 16.556853608735256, 9.235001490438888, 7.780704963254893, 23.24505663042878, 2.1753409665631356, 10.957245731685916, 8.19501231690782, 18.7993963053671, -3.456437030937111, 20.91681837543646, 26.703532873809873, 13.244911162597631, 13.148607151901325, 7.004643119352304, 0.06998953525130958, 2.1091593685363854, -5.725112420737245, 4.402945759739168, 2.9606958850946317, 10.351605895057162, 22.024068931111092, -6.838808059974337, 21.0736276800234, 11.627511298501824, 24.24012965742099, 25.086979358843873, 17.62657966963421, 16.35737345861336, 19.041184236077846, -2.261907866772122, 4.882300700905043, 12.602606901810145, 2.2386753520984453, 21.727863901466904, 16.207341540372482, 21.423400310627038, 11.160291759380844, -2.8644162275473306, 22.157756389663568, 19.9590161704214, -0.415343685092596, 22.190938439908866, 5.767423947567499, 20.315853358297577, 20.686448094502698, 4.568738074528145, -3.094121127520417, 21.075447275096515, 17.250059415397114, -1.1297224227435763, 2.241058836909259, -6.17906840296909, 3.283107470149945, 19.928427442282377, -10.544249422554998, 5.28377364003844, -2.879615625294619, -14.942946357481434], "policy_adversary_policy_reward": [-33.447263753258255, -12.461127286146507, 10.230679234226926, 34.75365298051265, -23.865717091832202, 13.274231576962883, 6.884600617231975, -8.180516035603787, -25.63447608150072, -15.961669203402025, -6.783485362110433, -30.20548924403552, -3.8848600130256727, -30.521608281454775, -9.94133429634164, -23.49089127312765, -13.326849822619515, -17.21754718696591, -26.537190495316807, 1.6535531650286543, -6.8546641910284585, 7.194500802294137, -14.729709704536472, -7.007901633406139, -25.35703290399919, -1.5516770777075024, -19.01278289666074, 0.682709821204206, 0.4569134981213274, -9.320589247026984, 3.45048562920104, 3.5196151227883554, 1.2995218896139633, -8.865670603917142, -14.64668337703435, -2.6504469139825844, -17.409524696265656, -21.611925775210498, 2.949898479516733, 4.556074096785345, -24.588685414539675, -22.88327180491258, -20.07646189958593, -12.512681423129973, 8.867763974796816, -3.749849340882175, -21.50471461249191, 5.431867792870342, 8.87601039978081, -13.433282400694171, -35.52939858551476, -19.245840088699758, 7.026287433209355, -18.896070976081788, -31.897804732826735, -15.849365631583513, -15.225911107860718, -26.11659249972807, 10.119139560245607, -23.884250970679304, 2.6492924709483674, -8.092220257332201, -7.617467518538163, -1.1084576427189106, 13.530061745751581, -33.05275703651268, -17.211110622966167, -2.782431960874895, -36.538006932840744, -7.527025457136514, -15.529835599324091, -12.307929290022752, -7.605527811792811, -7.362360691418864, -5.696787061732948, -7.423492081789245, -33.50438749868255, -6.380278039032934, 18.14045919232472, -11.543673706732243, -2.2046006518911447, -2.0812828407383837, -18.51236460216719, -10.65409501477641, -11.735157307466093, -21.37854991000441, -19.93737063692328, 1.4673676560455018, -7.70248180038973, -7.858928126120055, -23.71398644248671, -22.776126818370827, -8.339825207384013, 3.989143274257742, -15.468994028178912, -6.445497435192916, -14.197952561310302, -2.1920720725053364, -23.109795453994785, -14.48899715673942, 3.359339521081568, 3.553534540792654, -33.02039216332854, -8.813244587544375, -26.444960681325554, -26.962105066294196, -17.381578289275968, -9.108244035919299, 2.0978358289036763, -28.395050132706324, -12.325961098118885, -1.6833251405857226, -4.677746582133665, 4.537767511631046, -10.504879395319591, 6.28656065824682, -1.4661184130435885, 12.916343254518079, -1.5253104067439764, -7.28058111273436, 0.307491955640657, -6.22888372582992, -10.10295430467323, -10.600257485441094, -9.767303550781836, -34.280834311440344, 4.453279898580774, 9.2243362213679, -25.3561408771834, -16.79111448286337, -15.97626538010164, -7.278757216902008, -19.87009125053075, -28.61016806431123, -27.880289183289136, -22.293669534398603, -26.009023262439595, -9.244136076828823, -10.401395797459362, -22.31335111976736, -13.32875507636803, -24.753613395787667, 1.5534996415129478, 2.970316092031296, 9.203989714969069, -18.968591116779155, -21.13650524187372, -4.068708561746593, 25.9607243522193, -30.438075056416196, -19.99467482356937, -23.461052979364457, -28.133484262876685, -4.28119881786828, -25.199853148770067, -17.646947472484012, -17.426629110689525, -4.893954408072158, -0.19770708417858174, 5.926539539273243, -29.126071682117534, -15.189441097209599, -21.720368987678757, -18.197663353164035, -8.854234977825858, 9.68492234801105, -20.16848325387838, -24.21339362593935, -2.036357685920983, -9.498490209214015, -26.838666232544995, -13.793040484050156, -22.457513897378895, -18.915382291626493, -10.981327062473824, 1.8438509134175334, 9.962325767296164, -3.7740835122553307, -16.18312258264764, -25.9677719675454, -9.492628242461713, -25.00749058833252, 4.7634681601654165, -2.504023314678264, 10.553677016474197, -15.035794690292715, 0.4001907129652764, 11.957946092972904, -6.680493384015687, 0.1142784437157971, -12.256439792083068, -27.600415092481686, 13.941484290184299, 7.147014554925697, -5.451645312806278, -5.115901967270606, -3.6134765944125338, 9.372707845001774, 18.549469324778904, 11.33642339018396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4510538984867778, "mean_inference_ms": 1.2061619684032734, "mean_action_processing_ms": 0.19588957261844364, "mean_env_wait_ms": 0.08058932842553332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00414431095123291, "StateBufferConnector_ms": 0.0031963586807250977, "ViewRequirementAgentConnector_ms": 0.0866016149520874}, "num_episodes": 10, "episode_return_max": 22.49216610736979, "episode_return_min": -27.387619337107264, "episode_return_mean": -9.820845501883511}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 433.04890015977975, "num_env_steps_trained_throughput_per_sec": 433.04890015977975, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 9094.892, "restore_workers_time_ms": 0.031, "training_step_time_ms": 9094.746, "sample_time_ms": 1006.854, "learn_time_ms": 8072.916, "learn_throughput": 495.484, "synch_weights_time_ms": 14.158}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 54, "trial_id": "83a5c_00000", "date": "2024-08-10_12-21-49", "timestamp": 1723306909, "time_this_iter_s": 9.266814947128296, "time_total_s": 473.024760723114, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f4e98b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 473.024760723114, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 36.0, "ram_util_percent": 82.6846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1908132344642013, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0198690591665804, "policy_loss": -0.0051991615344637206, "vf_loss": 3.0245856452240516, "vf_explained_var": 0.04502473927679516, "kl": 0.010167889975330238, "entropy": 1.4332478740227916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.637652982150515, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4690037224441768, "policy_loss": -0.0028909284636029044, "vf_loss": 2.4716251748303573, "vf_explained_var": 0.3607196866845091, "kl": 0.008516711037201755, "entropy": 0.665693033238252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "env_runners": {"episode_reward_max": 14.942946357481434, "episode_reward_min": -27.387619337107264, "episode_reward_mean": -9.450959495500477, "episode_len_mean": 384.41, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38441, "policy_reward_min": {"agent_policy": -14.942946357481434, "adversary_policy": -36.538006932840744}, "policy_reward_max": {"agent_policy": 27.38761933710726, "adversary_policy": 25.9607243522193}, "policy_reward_mean": {"agent_policy": 9.450959495500477, "adversary_policy": -9.450959495500477}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.16991830563283905, -10.868805668971305, -13.454354990853348, -9.165036537728268, -4.431837874452823, 3.485050375994696, -3.7830743571515892, -8.648565145508467, -19.510725235738082, 3.752986288151039, -23.73597860972613, -16.294571661357953, 2.5589573169573203, -8.036423409810782, -2.2786360004566806, -27.387619337107264, -5.934891771436217, -23.873585182205122, -20.671251803794394, -6.8825557052168485, -2.721463893191917, -4.362962580628537, -9.76134764538055, -9.99677129192053, -22.032516194988634, -13.918882444673422, -7.483944251605839, -6.560139571761097, -19.94233276885774, 3.2983927427962385, -2.142941746314767, -14.583229808471796, -16.55685360873525, -9.235001490438885, -7.780704963254893, -23.245056630428778, -2.1753409665631356, -10.957245731685912, -8.195012316907821, -18.799396305367097, 3.4564370309371113, -20.916818375436456, -26.703532873809877, -13.244911162597631, -13.148607151901325, -7.004643119352302, -0.06998953525130958, -2.1091593685363854, 5.725112420737245, -4.402945759739168, -2.9606958850946317, -10.351605895057162, -22.024068931111092, 6.838808059974337, -21.073627680023396, -11.627511298501823, -24.24012965742099, -25.08697935884387, -17.62657966963421, -16.35737345861336, -19.041184236077846, 2.261907866772122, -4.882300700905043, -12.602606901810145, -2.2386753520984453, -21.727863901466893, -16.207341540372482, -21.423400310627038, -11.160291759380844, 2.8644162275473306, -22.157756389663568, -19.9590161704214, 0.415343685092596, -22.19093843990887, -5.767423947567499, -20.315853358297574, -20.686448094502687, -4.568738074528145, 3.094121127520417, -21.07544727509652, -17.250059415397114, 1.1297224227435763, -2.241058836909259, 6.17906840296909, -3.283107470149945, -19.928427442282388, 10.544249422555, -5.283773640038435, 2.8796156252946243, 14.942946357481434, -12.064531219851478, -5.134413483786528, -18.630041081804855, 5.106841546416746, -14.496652689896537, 0.2808924304855651, 1.126894907418837, -8.349965286729221, -18.98629115663432, 0.8042127462960864], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13], "policy_agent_policy_reward": [-0.16991830563283905, 10.868805668971305, 13.454354990853348, 9.165036537728266, 4.431837874452824, -3.485050375994698, 3.7830743571515892, 8.648565145508467, 19.510725235738082, -3.752986288151039, 23.73597860972613, 16.294571661357953, -2.5589573169573203, 8.036423409810784, 2.2786360004566806, 27.38761933710726, 5.934891771436217, 23.873585182205122, 20.671251803794398, 6.8825557052168485, 2.721463893191917, 4.362962580628537, 9.76134764538055, 9.996771291920531, 22.03251619498863, 13.918882444673422, 7.483944251605839, 6.560139571761097, 19.942332768857742, -3.2983927427962385, 2.1429417463147686, 14.583229808471796, 16.556853608735256, 9.235001490438888, 7.780704963254893, 23.24505663042878, 2.1753409665631356, 10.957245731685916, 8.19501231690782, 18.7993963053671, -3.456437030937111, 20.91681837543646, 26.703532873809873, 13.244911162597631, 13.148607151901325, 7.004643119352304, 0.06998953525130958, 2.1091593685363854, -5.725112420737245, 4.402945759739168, 2.9606958850946317, 10.351605895057162, 22.024068931111092, -6.838808059974337, 21.0736276800234, 11.627511298501824, 24.24012965742099, 25.086979358843873, 17.62657966963421, 16.35737345861336, 19.041184236077846, -2.261907866772122, 4.882300700905043, 12.602606901810145, 2.2386753520984453, 21.727863901466904, 16.207341540372482, 21.423400310627038, 11.160291759380844, -2.8644162275473306, 22.157756389663568, 19.9590161704214, -0.415343685092596, 22.190938439908866, 5.767423947567499, 20.315853358297577, 20.686448094502698, 4.568738074528145, -3.094121127520417, 21.075447275096515, 17.250059415397114, -1.1297224227435763, 2.241058836909259, -6.17906840296909, 3.283107470149945, 19.928427442282377, -10.544249422554998, 5.28377364003844, -2.879615625294619, -14.942946357481434, 12.064531219851476, 5.134413483786528, 18.630041081804855, -5.106841546416746, 14.496652689896537, -0.2808924304855651, -1.126894907418837, 8.349965286729221, 18.98629115663432, -0.8042127462960864], "policy_adversary_policy_reward": [-6.8546641910284585, 7.194500802294137, -14.729709704536472, -7.007901633406139, -25.35703290399919, -1.5516770777075024, -19.01278289666074, 0.682709821204206, 0.4569134981213274, -9.320589247026984, 3.45048562920104, 3.5196151227883554, 1.2995218896139633, -8.865670603917142, -14.64668337703435, -2.6504469139825844, -17.409524696265656, -21.611925775210498, 2.949898479516733, 4.556074096785345, -24.588685414539675, -22.88327180491258, -20.07646189958593, -12.512681423129973, 8.867763974796816, -3.749849340882175, -21.50471461249191, 5.431867792870342, 8.87601039978081, -13.433282400694171, -35.52939858551476, -19.245840088699758, 7.026287433209355, -18.896070976081788, -31.897804732826735, -15.849365631583513, -15.225911107860718, -26.11659249972807, 10.119139560245607, -23.884250970679304, 2.6492924709483674, -8.092220257332201, -7.617467518538163, -1.1084576427189106, 13.530061745751581, -33.05275703651268, -17.211110622966167, -2.782431960874895, -36.538006932840744, -7.527025457136514, -15.529835599324091, -12.307929290022752, -7.605527811792811, -7.362360691418864, -5.696787061732948, -7.423492081789245, -33.50438749868255, -6.380278039032934, 18.14045919232472, -11.543673706732243, -2.2046006518911447, -2.0812828407383837, -18.51236460216719, -10.65409501477641, -11.735157307466093, -21.37854991000441, -19.93737063692328, 1.4673676560455018, -7.70248180038973, -7.858928126120055, -23.71398644248671, -22.776126818370827, -8.339825207384013, 3.989143274257742, -15.468994028178912, -6.445497435192916, -14.197952561310302, -2.1920720725053364, -23.109795453994785, -14.48899715673942, 3.359339521081568, 3.553534540792654, -33.02039216332854, -8.813244587544375, -26.444960681325554, -26.962105066294196, -17.381578289275968, -9.108244035919299, 2.0978358289036763, -28.395050132706324, -12.325961098118885, -1.6833251405857226, -4.677746582133665, 4.537767511631046, -10.504879395319591, 6.28656065824682, -1.4661184130435885, 12.916343254518079, -1.5253104067439764, -7.28058111273436, 0.307491955640657, -6.22888372582992, -10.10295430467323, -10.600257485441094, -9.767303550781836, -34.280834311440344, 4.453279898580774, 9.2243362213679, -25.3561408771834, -16.79111448286337, -15.97626538010164, -7.278757216902008, -19.87009125053075, -28.61016806431123, -27.880289183289136, -22.293669534398603, -26.009023262439595, -9.244136076828823, -10.401395797459362, -22.31335111976736, -13.32875507636803, -24.753613395787667, 1.5534996415129478, 2.970316092031296, 9.203989714969069, -18.968591116779155, -21.13650524187372, -4.068708561746593, 25.9607243522193, -30.438075056416196, -19.99467482356937, -23.461052979364457, -28.133484262876685, -4.28119881786828, -25.199853148770067, -17.646947472484012, -17.426629110689525, -4.893954408072158, -0.19770708417858174, 5.926539539273243, -29.126071682117534, -15.189441097209599, -21.720368987678757, -18.197663353164035, -8.854234977825858, 9.68492234801105, -20.16848325387838, -24.21339362593935, -2.036357685920983, -9.498490209214015, -26.838666232544995, -13.793040484050156, -22.457513897378895, -18.915382291626493, -10.981327062473824, 1.8438509134175334, 9.962325767296164, -3.7740835122553307, -16.18312258264764, -25.9677719675454, -9.492628242461713, -25.00749058833252, 4.7634681601654165, -2.504023314678264, 10.553677016474197, -15.035794690292715, 0.4001907129652764, 11.957946092972904, -6.680493384015687, 0.1142784437157971, -12.256439792083068, -27.600415092481686, 13.941484290184299, 7.147014554925697, -5.451645312806278, -5.115901967270606, -3.6134765944125338, 9.372707845001774, 18.549469324778904, 11.33642339018396, -13.355126307646522, -10.77393613205643, -15.597773742332706, 5.32894677475965, -10.282360350598292, -26.97772181301142, -0.919837653929946, 11.133520746763438, -15.40339119419292, -13.589914185600154, 15.308846379188132, -14.747061518217002, 14.252602886910225, -11.99881307207255, -5.725666171452559, -10.974264402005883, -25.94612649089133, -12.026455822377311, -10.095011512862156, 11.70343700545433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4514498269542869, "mean_inference_ms": 1.2083635017984227, "mean_action_processing_ms": 0.19598767760100733, "mean_env_wait_ms": 0.08072813625876547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044738054275512695, "StateBufferConnector_ms": 0.003214597702026367, "ViewRequirementAgentConnector_ms": 0.08646631240844727}, "num_episodes": 10, "episode_return_max": 14.942946357481434, "episode_return_min": -27.387619337107264, "episode_return_mean": -9.450959495500477}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.03583545641766, "num_env_steps_trained_throughput_per_sec": 444.03583545641766, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 9099.224, "restore_workers_time_ms": 0.032, "training_step_time_ms": 9099.078, "sample_time_ms": 1027.456, "learn_time_ms": 8056.537, "learn_throughput": 496.491, "synch_weights_time_ms": 14.268}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "training_iteration": 55, "trial_id": "83a5c_00000", "date": "2024-08-10_12-21-58", "timestamp": 1723306918, "time_this_iter_s": 9.013875961303711, "time_total_s": 482.0386366844177, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fae5af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 482.0386366844177, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 33.215384615384615, "ram_util_percent": 82.93076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0767441965284803, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.1192010506120305, "policy_loss": -0.004552212960663296, "vf_loss": 4.123323106513452, "vf_explained_var": -0.31797204292009745, "kl": 0.009063325205206252, "entropy": 1.3982833664884011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4912650012721618, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4281881312529245, "policy_loss": -0.004821910233295057, "vf_loss": 3.432724970082442, "vf_explained_var": 0.15307220841447514, "kl": 0.009009584675697476, "entropy": 0.6566088205203414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 14.942946357481434, "episode_reward_min": -27.387619337107264, "episode_reward_mean": -9.45666523969487, "episode_len_mean": 380.59, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38059, "policy_reward_min": {"agent_policy": -14.942946357481434, "adversary_policy": -36.538006932840744}, "policy_reward_max": {"agent_policy": 27.38761933710726, "adversary_policy": 25.9607243522193}, "policy_reward_mean": {"agent_policy": 9.45666523969487, "adversary_policy": -9.45666523969487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.5589573169573203, -8.036423409810782, -2.2786360004566806, -27.387619337107264, -5.934891771436217, -23.873585182205122, -20.671251803794394, -6.8825557052168485, -2.721463893191917, -4.362962580628537, -9.76134764538055, -9.99677129192053, -22.032516194988634, -13.918882444673422, -7.483944251605839, -6.560139571761097, -19.94233276885774, 3.2983927427962385, -2.142941746314767, -14.583229808471796, -16.55685360873525, -9.235001490438885, -7.780704963254893, -23.245056630428778, -2.1753409665631356, -10.957245731685912, -8.195012316907821, -18.799396305367097, 3.4564370309371113, -20.916818375436456, -26.703532873809877, -13.244911162597631, -13.148607151901325, -7.004643119352302, -0.06998953525130958, -2.1091593685363854, 5.725112420737245, -4.402945759739168, -2.9606958850946317, -10.351605895057162, -22.024068931111092, 6.838808059974337, -21.073627680023396, -11.627511298501823, -24.24012965742099, -25.08697935884387, -17.62657966963421, -16.35737345861336, -19.041184236077846, 2.261907866772122, -4.882300700905043, -12.602606901810145, -2.2386753520984453, -21.727863901466893, -16.207341540372482, -21.423400310627038, -11.160291759380844, 2.8644162275473306, -22.157756389663568, -19.9590161704214, 0.415343685092596, -22.19093843990887, -5.767423947567499, -20.315853358297574, -20.686448094502687, -4.568738074528145, 3.094121127520417, -21.07544727509652, -17.250059415397114, 1.1297224227435763, -2.241058836909259, 6.17906840296909, -3.283107470149945, -19.928427442282388, 10.544249422555, -5.283773640038435, 2.8796156252946243, 14.942946357481434, -12.064531219851478, -5.134413483786528, -18.630041081804855, 5.106841546416746, -14.496652689896537, 0.2808924304855651, 1.126894907418837, -8.349965286729221, -18.98629115663432, 0.8042127462960864, 9.907192644245074, -7.013814530751231, -1.4024439797826886, -10.807898655558102, -23.764674704162942, -16.09758828310276, -2.2534539356418364, -19.12602618264751, -9.570477208602846, 11.31102435141422, -24.82251671332354, -9.414892333234445], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400], "policy_agent_policy_reward": [-2.5589573169573203, 8.036423409810784, 2.2786360004566806, 27.38761933710726, 5.934891771436217, 23.873585182205122, 20.671251803794398, 6.8825557052168485, 2.721463893191917, 4.362962580628537, 9.76134764538055, 9.996771291920531, 22.03251619498863, 13.918882444673422, 7.483944251605839, 6.560139571761097, 19.942332768857742, -3.2983927427962385, 2.1429417463147686, 14.583229808471796, 16.556853608735256, 9.235001490438888, 7.780704963254893, 23.24505663042878, 2.1753409665631356, 10.957245731685916, 8.19501231690782, 18.7993963053671, -3.456437030937111, 20.91681837543646, 26.703532873809873, 13.244911162597631, 13.148607151901325, 7.004643119352304, 0.06998953525130958, 2.1091593685363854, -5.725112420737245, 4.402945759739168, 2.9606958850946317, 10.351605895057162, 22.024068931111092, -6.838808059974337, 21.0736276800234, 11.627511298501824, 24.24012965742099, 25.086979358843873, 17.62657966963421, 16.35737345861336, 19.041184236077846, -2.261907866772122, 4.882300700905043, 12.602606901810145, 2.2386753520984453, 21.727863901466904, 16.207341540372482, 21.423400310627038, 11.160291759380844, -2.8644162275473306, 22.157756389663568, 19.9590161704214, -0.415343685092596, 22.190938439908866, 5.767423947567499, 20.315853358297577, 20.686448094502698, 4.568738074528145, -3.094121127520417, 21.075447275096515, 17.250059415397114, -1.1297224227435763, 2.241058836909259, -6.17906840296909, 3.283107470149945, 19.928427442282377, -10.544249422554998, 5.28377364003844, -2.879615625294619, -14.942946357481434, 12.064531219851476, 5.134413483786528, 18.630041081804855, -5.106841546416746, 14.496652689896537, -0.2808924304855651, -1.126894907418837, 8.349965286729221, 18.98629115663432, -0.8042127462960864, -9.907192644245074, 7.013814530751231, 1.4024439797826886, 10.807898655558105, 23.764674704162946, 16.09758828310276, 2.2534539356418364, 19.12602618264751, 9.570477208602846, -11.311024351414222, 24.822516713323544, 9.414892333234445], "policy_adversary_policy_reward": [8.867763974796816, -3.749849340882175, -21.50471461249191, 5.431867792870342, 8.87601039978081, -13.433282400694171, -35.52939858551476, -19.245840088699758, 7.026287433209355, -18.896070976081788, -31.897804732826735, -15.849365631583513, -15.225911107860718, -26.11659249972807, 10.119139560245607, -23.884250970679304, 2.6492924709483674, -8.092220257332201, -7.617467518538163, -1.1084576427189106, 13.530061745751581, -33.05275703651268, -17.211110622966167, -2.782431960874895, -36.538006932840744, -7.527025457136514, -15.529835599324091, -12.307929290022752, -7.605527811792811, -7.362360691418864, -5.696787061732948, -7.423492081789245, -33.50438749868255, -6.380278039032934, 18.14045919232472, -11.543673706732243, -2.2046006518911447, -2.0812828407383837, -18.51236460216719, -10.65409501477641, -11.735157307466093, -21.37854991000441, -19.93737063692328, 1.4673676560455018, -7.70248180038973, -7.858928126120055, -23.71398644248671, -22.776126818370827, -8.339825207384013, 3.989143274257742, -15.468994028178912, -6.445497435192916, -14.197952561310302, -2.1920720725053364, -23.109795453994785, -14.48899715673942, 3.359339521081568, 3.553534540792654, -33.02039216332854, -8.813244587544375, -26.444960681325554, -26.962105066294196, -17.381578289275968, -9.108244035919299, 2.0978358289036763, -28.395050132706324, -12.325961098118885, -1.6833251405857226, -4.677746582133665, 4.537767511631046, -10.504879395319591, 6.28656065824682, -1.4661184130435885, 12.916343254518079, -1.5253104067439764, -7.28058111273436, 0.307491955640657, -6.22888372582992, -10.10295430467323, -10.600257485441094, -9.767303550781836, -34.280834311440344, 4.453279898580774, 9.2243362213679, -25.3561408771834, -16.79111448286337, -15.97626538010164, -7.278757216902008, -19.87009125053075, -28.61016806431123, -27.880289183289136, -22.293669534398603, -26.009023262439595, -9.244136076828823, -10.401395797459362, -22.31335111976736, -13.32875507636803, -24.753613395787667, 1.5534996415129478, 2.970316092031296, 9.203989714969069, -18.968591116779155, -21.13650524187372, -4.068708561746593, 25.9607243522193, -30.438075056416196, -19.99467482356937, -23.461052979364457, -28.133484262876685, -4.28119881786828, -25.199853148770067, -17.646947472484012, -17.426629110689525, -4.893954408072158, -0.19770708417858174, 5.926539539273243, -29.126071682117534, -15.189441097209599, -21.720368987678757, -18.197663353164035, -8.854234977825858, 9.68492234801105, -20.16848325387838, -24.21339362593935, -2.036357685920983, -9.498490209214015, -26.838666232544995, -13.793040484050156, -22.457513897378895, -18.915382291626493, -10.981327062473824, 1.8438509134175334, 9.962325767296164, -3.7740835122553307, -16.18312258264764, -25.9677719675454, -9.492628242461713, -25.00749058833252, 4.7634681601654165, -2.504023314678264, 10.553677016474197, -15.035794690292715, 0.4001907129652764, 11.957946092972904, -6.680493384015687, 0.1142784437157971, -12.256439792083068, -27.600415092481686, 13.941484290184299, 7.147014554925697, -5.451645312806278, -5.115901967270606, -3.6134765944125338, 9.372707845001774, 18.549469324778904, 11.33642339018396, -13.355126307646522, -10.77393613205643, -15.597773742332706, 5.32894677475965, -10.282360350598292, -26.97772181301142, -0.919837653929946, 11.133520746763438, -15.40339119419292, -13.589914185600154, 15.308846379188132, -14.747061518217002, 14.252602886910225, -11.99881307207255, -5.725666171452559, -10.974264402005883, -25.94612649089133, -12.026455822377311, -10.095011512862156, 11.70343700545433, 10.938331557253036, 8.87605373123711, -3.779315846762998, -10.248313214739465, 5.911441425609013, -8.71632938517439, 9.51504399231068, -31.13084130342689, -18.19658436788414, -29.332765040441764, -4.5887678639725, -27.60640870223302, -8.379541035986449, 3.8726331647027763, -18.27093839492583, -19.98111397036919, -9.014651898249241, -10.12630251895645, 3.547772245330293, 19.074276457498147, -28.26890420477436, -21.376129221872777, 0.9146108794164007, -19.74439554588529]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45182249565304133, "mean_inference_ms": 1.210747285910799, "mean_action_processing_ms": 0.19612689690067903, "mean_env_wait_ms": 0.08088174187656395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00437009334564209, "StateBufferConnector_ms": 0.0030804872512817383, "ViewRequirementAgentConnector_ms": 0.08503270149230957}, "num_episodes": 12, "episode_return_max": 14.942946357481434, "episode_return_min": -27.387619337107264, "episode_return_mean": -9.45666523969487}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 460.87356846235826, "num_env_steps_trained_throughput_per_sec": 460.87356846235826, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 8984.636, "restore_workers_time_ms": 0.032, "training_step_time_ms": 8984.56, "sample_time_ms": 1026.245, "learn_time_ms": 7944.663, "learn_throughput": 503.483, "synch_weights_time_ms": 13.093}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 56, "trial_id": "83a5c_00000", "date": "2024-08-10_12-22-07", "timestamp": 1723306927, "time_this_iter_s": 8.68458104133606, "time_total_s": 490.7232177257538, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 490.7232177257538, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 32.0, "ram_util_percent": 83.35833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3781905064822504, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.78023702719855, "policy_loss": -0.0068330170510326905, "vf_loss": 4.786006933923751, "vf_explained_var": -0.3311682654436303, "kl": 0.022399609256889927, "entropy": 1.347530553959034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.30259978082031, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7240044925361873, "policy_loss": -0.008018519744412818, "vf_loss": 2.7315504459043343, "vf_explained_var": 0.2621656462550163, "kl": 0.014935267713692883, "entropy": 0.4977510816728075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "env_runners": {"episode_reward_max": 17.085285624444538, "episode_reward_min": -26.703532873809877, "episode_reward_mean": -8.811401771550296, "episode_len_mean": 380.59, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38059, "policy_reward_min": {"agent_policy": -17.08528562444454, "adversary_policy": -36.538006932840744}, "policy_reward_max": {"agent_policy": 26.703532873809873, "adversary_policy": 25.9607243522193}, "policy_reward_mean": {"agent_policy": 8.811401771550296, "adversary_policy": -8.811401771550297}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.76134764538055, -9.99677129192053, -22.032516194988634, -13.918882444673422, -7.483944251605839, -6.560139571761097, -19.94233276885774, 3.2983927427962385, -2.142941746314767, -14.583229808471796, -16.55685360873525, -9.235001490438885, -7.780704963254893, -23.245056630428778, -2.1753409665631356, -10.957245731685912, -8.195012316907821, -18.799396305367097, 3.4564370309371113, -20.916818375436456, -26.703532873809877, -13.244911162597631, -13.148607151901325, -7.004643119352302, -0.06998953525130958, -2.1091593685363854, 5.725112420737245, -4.402945759739168, -2.9606958850946317, -10.351605895057162, -22.024068931111092, 6.838808059974337, -21.073627680023396, -11.627511298501823, -24.24012965742099, -25.08697935884387, -17.62657966963421, -16.35737345861336, -19.041184236077846, 2.261907866772122, -4.882300700905043, -12.602606901810145, -2.2386753520984453, -21.727863901466893, -16.207341540372482, -21.423400310627038, -11.160291759380844, 2.8644162275473306, -22.157756389663568, -19.9590161704214, 0.415343685092596, -22.19093843990887, -5.767423947567499, -20.315853358297574, -20.686448094502687, -4.568738074528145, 3.094121127520417, -21.07544727509652, -17.250059415397114, 1.1297224227435763, -2.241058836909259, 6.17906840296909, -3.283107470149945, -19.928427442282388, 10.544249422555, -5.283773640038435, 2.8796156252946243, 14.942946357481434, -12.064531219851478, -5.134413483786528, -18.630041081804855, 5.106841546416746, -14.496652689896537, 0.2808924304855651, 1.126894907418837, -8.349965286729221, -18.98629115663432, 0.8042127462960864, 9.907192644245074, -7.013814530751231, -1.4024439797826886, -10.807898655558102, -23.764674704162942, -16.09758828310276, -2.2534539356418364, -19.12602618264751, -9.570477208602846, 11.31102435141422, -24.82251671332354, -9.414892333234445, 8.208871758963362, 1.1146324066767477, 17.085285624444538, -1.4733463110229401, -10.229969716748174, -6.357534612905703, -14.393962786907078, -3.8831928901661534, -17.656578499437764, -7.478290525330053], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [9.76134764538055, 9.996771291920531, 22.03251619498863, 13.918882444673422, 7.483944251605839, 6.560139571761097, 19.942332768857742, -3.2983927427962385, 2.1429417463147686, 14.583229808471796, 16.556853608735256, 9.235001490438888, 7.780704963254893, 23.24505663042878, 2.1753409665631356, 10.957245731685916, 8.19501231690782, 18.7993963053671, -3.456437030937111, 20.91681837543646, 26.703532873809873, 13.244911162597631, 13.148607151901325, 7.004643119352304, 0.06998953525130958, 2.1091593685363854, -5.725112420737245, 4.402945759739168, 2.9606958850946317, 10.351605895057162, 22.024068931111092, -6.838808059974337, 21.0736276800234, 11.627511298501824, 24.24012965742099, 25.086979358843873, 17.62657966963421, 16.35737345861336, 19.041184236077846, -2.261907866772122, 4.882300700905043, 12.602606901810145, 2.2386753520984453, 21.727863901466904, 16.207341540372482, 21.423400310627038, 11.160291759380844, -2.8644162275473306, 22.157756389663568, 19.9590161704214, -0.415343685092596, 22.190938439908866, 5.767423947567499, 20.315853358297577, 20.686448094502698, 4.568738074528145, -3.094121127520417, 21.075447275096515, 17.250059415397114, -1.1297224227435763, 2.241058836909259, -6.17906840296909, 3.283107470149945, 19.928427442282377, -10.544249422554998, 5.28377364003844, -2.879615625294619, -14.942946357481434, 12.064531219851476, 5.134413483786528, 18.630041081804855, -5.106841546416746, 14.496652689896537, -0.2808924304855651, -1.126894907418837, 8.349965286729221, 18.98629115663432, -0.8042127462960864, -9.907192644245074, 7.013814530751231, 1.4024439797826886, 10.807898655558105, 23.764674704162946, 16.09758828310276, 2.2534539356418364, 19.12602618264751, 9.570477208602846, -11.311024351414222, 24.822516713323544, 9.414892333234445, -8.208871758963362, -1.1146324066767477, -17.08528562444454, 1.4733463110229401, 10.229969716748176, 6.3575346129057015, 14.393962786907078, 3.8831928901661623, 17.656578499437764, 7.478290525330053], "policy_adversary_policy_reward": [13.530061745751581, -33.05275703651268, -17.211110622966167, -2.782431960874895, -36.538006932840744, -7.527025457136514, -15.529835599324091, -12.307929290022752, -7.605527811792811, -7.362360691418864, -5.696787061732948, -7.423492081789245, -33.50438749868255, -6.380278039032934, 18.14045919232472, -11.543673706732243, -2.2046006518911447, -2.0812828407383837, -18.51236460216719, -10.65409501477641, -11.735157307466093, -21.37854991000441, -19.93737063692328, 1.4673676560455018, -7.70248180038973, -7.858928126120055, -23.71398644248671, -22.776126818370827, -8.339825207384013, 3.989143274257742, -15.468994028178912, -6.445497435192916, -14.197952561310302, -2.1920720725053364, -23.109795453994785, -14.48899715673942, 3.359339521081568, 3.553534540792654, -33.02039216332854, -8.813244587544375, -26.444960681325554, -26.962105066294196, -17.381578289275968, -9.108244035919299, 2.0978358289036763, -28.395050132706324, -12.325961098118885, -1.6833251405857226, -4.677746582133665, 4.537767511631046, -10.504879395319591, 6.28656065824682, -1.4661184130435885, 12.916343254518079, -1.5253104067439764, -7.28058111273436, 0.307491955640657, -6.22888372582992, -10.10295430467323, -10.600257485441094, -9.767303550781836, -34.280834311440344, 4.453279898580774, 9.2243362213679, -25.3561408771834, -16.79111448286337, -15.97626538010164, -7.278757216902008, -19.87009125053075, -28.61016806431123, -27.880289183289136, -22.293669534398603, -26.009023262439595, -9.244136076828823, -10.401395797459362, -22.31335111976736, -13.32875507636803, -24.753613395787667, 1.5534996415129478, 2.970316092031296, 9.203989714969069, -18.968591116779155, -21.13650524187372, -4.068708561746593, 25.9607243522193, -30.438075056416196, -19.99467482356937, -23.461052979364457, -28.133484262876685, -4.28119881786828, -25.199853148770067, -17.646947472484012, -17.426629110689525, -4.893954408072158, -0.19770708417858174, 5.926539539273243, -29.126071682117534, -15.189441097209599, -21.720368987678757, -18.197663353164035, -8.854234977825858, 9.68492234801105, -20.16848325387838, -24.21339362593935, -2.036357685920983, -9.498490209214015, -26.838666232544995, -13.793040484050156, -22.457513897378895, -18.915382291626493, -10.981327062473824, 1.8438509134175334, 9.962325767296164, -3.7740835122553307, -16.18312258264764, -25.9677719675454, -9.492628242461713, -25.00749058833252, 4.7634681601654165, -2.504023314678264, 10.553677016474197, -15.035794690292715, 0.4001907129652764, 11.957946092972904, -6.680493384015687, 0.1142784437157971, -12.256439792083068, -27.600415092481686, 13.941484290184299, 7.147014554925697, -5.451645312806278, -5.115901967270606, -3.6134765944125338, 9.372707845001774, 18.549469324778904, 11.33642339018396, -13.355126307646522, -10.77393613205643, -15.597773742332706, 5.32894677475965, -10.282360350598292, -26.97772181301142, -0.919837653929946, 11.133520746763438, -15.40339119419292, -13.589914185600154, 15.308846379188132, -14.747061518217002, 14.252602886910225, -11.99881307207255, -5.725666171452559, -10.974264402005883, -25.94612649089133, -12.026455822377311, -10.095011512862156, 11.70343700545433, 10.938331557253036, 8.87605373123711, -3.779315846762998, -10.248313214739465, 5.911441425609013, -8.71632938517439, 9.51504399231068, -31.13084130342689, -18.19658436788414, -29.332765040441764, -4.5887678639725, -27.60640870223302, -8.379541035986449, 3.8726331647027763, -18.27093839492583, -19.98111397036919, -9.014651898249241, -10.12630251895645, 3.547772245330293, 19.074276457498147, -28.26890420477436, -21.376129221872777, 0.9146108794164007, -19.74439554588529, 19.83375994367174, -3.416016425745017, -1.5541779915573812, 3.7834428049108766, 17.17278743387301, 16.997783815016113, 4.261884325179494, -7.2085769472253745, -1.1667403439522506, -19.293199089544103, 7.46960159624178, -20.184670822053185, -20.440549345467307, -8.34737622834685, -15.654307456112821, 7.887921675780486, -16.025730889600112, -19.28742610927542, -22.266829145063348, 7.310248094403242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4519921271771669, "mean_inference_ms": 1.2124070133536957, "mean_action_processing_ms": 0.19612653726837526, "mean_env_wait_ms": 0.08097049195040923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004277825355529785, "StateBufferConnector_ms": 0.003012537956237793, "ViewRequirementAgentConnector_ms": 0.08406150341033936}, "num_episodes": 10, "episode_return_max": 17.085285624444538, "episode_return_min": -26.703532873809877, "episode_return_mean": -8.811401771550296}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 451.6360471401068, "num_env_steps_trained_throughput_per_sec": 451.6360471401068, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 8970.126, "restore_workers_time_ms": 0.028, "training_step_time_ms": 8970.064, "sample_time_ms": 1002.581, "learn_time_ms": 7953.421, "learn_throughput": 502.928, "synch_weights_time_ms": 13.514}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "training_iteration": 57, "trial_id": "83a5c_00000", "date": "2024-08-10_12-22-16", "timestamp": 1723306936, "time_this_iter_s": 8.861523151397705, "time_total_s": 499.5847408771515, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61a4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 499.5847408771515, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 32.307692307692314, "ram_util_percent": 83.07692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.36971122061134, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.1378595565361955, "policy_loss": -0.003188897581973049, "vf_loss": 4.140453753017244, "vf_explained_var": -0.024896896957720398, "kl": 0.00835346944092187, "entropy": 1.3478535970682821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5117294679706297, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.512426128735145, "policy_loss": -0.0018637227163708302, "vf_loss": 3.5139599432547888, "vf_explained_var": 0.31412226129323245, "kl": 0.010426781643909066, "entropy": 0.5858142122005423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 20.860401792069258, "episode_reward_min": -26.703532873809877, "episode_reward_mean": -8.159118393946448, "episode_len_mean": 380.59, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38059, "policy_reward_min": {"agent_policy": -20.86040179206927, "adversary_policy": -34.280834311440344}, "policy_reward_max": {"agent_policy": 26.703532873809873, "adversary_policy": 25.9607243522193}, "policy_reward_mean": {"agent_policy": 8.159118393946448, "adversary_policy": -8.159118393946448}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.235001490438885, -7.780704963254893, -23.245056630428778, -2.1753409665631356, -10.957245731685912, -8.195012316907821, -18.799396305367097, 3.4564370309371113, -20.916818375436456, -26.703532873809877, -13.244911162597631, -13.148607151901325, -7.004643119352302, -0.06998953525130958, -2.1091593685363854, 5.725112420737245, -4.402945759739168, -2.9606958850946317, -10.351605895057162, -22.024068931111092, 6.838808059974337, -21.073627680023396, -11.627511298501823, -24.24012965742099, -25.08697935884387, -17.62657966963421, -16.35737345861336, -19.041184236077846, 2.261907866772122, -4.882300700905043, -12.602606901810145, -2.2386753520984453, -21.727863901466893, -16.207341540372482, -21.423400310627038, -11.160291759380844, 2.8644162275473306, -22.157756389663568, -19.9590161704214, 0.415343685092596, -22.19093843990887, -5.767423947567499, -20.315853358297574, -20.686448094502687, -4.568738074528145, 3.094121127520417, -21.07544727509652, -17.250059415397114, 1.1297224227435763, -2.241058836909259, 6.17906840296909, -3.283107470149945, -19.928427442282388, 10.544249422555, -5.283773640038435, 2.8796156252946243, 14.942946357481434, -12.064531219851478, -5.134413483786528, -18.630041081804855, 5.106841546416746, -14.496652689896537, 0.2808924304855651, 1.126894907418837, -8.349965286729221, -18.98629115663432, 0.8042127462960864, 9.907192644245074, -7.013814530751231, -1.4024439797826886, -10.807898655558102, -23.764674704162942, -16.09758828310276, -2.2534539356418364, -19.12602618264751, -9.570477208602846, 11.31102435141422, -24.82251671332354, -9.414892333234445, 8.208871758963362, 1.1146324066767477, 17.085285624444538, -1.4733463110229401, -10.229969716748174, -6.357534612905703, -14.393962786907078, -3.8831928901661534, -17.656578499437764, -7.478290525330053, 7.549970580703839, -9.019443872208612, -9.904333541612832, -12.708170474061355, -6.794779805849602, -3.780227816297078, 9.741940060173894, -25.26265433137615, -21.413288660383717, 20.860401792069258, -3.72164276068618], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [9.235001490438888, 7.780704963254893, 23.24505663042878, 2.1753409665631356, 10.957245731685916, 8.19501231690782, 18.7993963053671, -3.456437030937111, 20.91681837543646, 26.703532873809873, 13.244911162597631, 13.148607151901325, 7.004643119352304, 0.06998953525130958, 2.1091593685363854, -5.725112420737245, 4.402945759739168, 2.9606958850946317, 10.351605895057162, 22.024068931111092, -6.838808059974337, 21.0736276800234, 11.627511298501824, 24.24012965742099, 25.086979358843873, 17.62657966963421, 16.35737345861336, 19.041184236077846, -2.261907866772122, 4.882300700905043, 12.602606901810145, 2.2386753520984453, 21.727863901466904, 16.207341540372482, 21.423400310627038, 11.160291759380844, -2.8644162275473306, 22.157756389663568, 19.9590161704214, -0.415343685092596, 22.190938439908866, 5.767423947567499, 20.315853358297577, 20.686448094502698, 4.568738074528145, -3.094121127520417, 21.075447275096515, 17.250059415397114, -1.1297224227435763, 2.241058836909259, -6.17906840296909, 3.283107470149945, 19.928427442282377, -10.544249422554998, 5.28377364003844, -2.879615625294619, -14.942946357481434, 12.064531219851476, 5.134413483786528, 18.630041081804855, -5.106841546416746, 14.496652689896537, -0.2808924304855651, -1.126894907418837, 8.349965286729221, 18.98629115663432, -0.8042127462960864, -9.907192644245074, 7.013814530751231, 1.4024439797826886, 10.807898655558105, 23.764674704162946, 16.09758828310276, 2.2534539356418364, 19.12602618264751, 9.570477208602846, -11.311024351414222, 24.822516713323544, 9.414892333234445, -8.208871758963362, -1.1146324066767477, -17.08528562444454, 1.4733463110229401, 10.229969716748176, 6.3575346129057015, 14.393962786907078, 3.8831928901661623, 17.656578499437764, 7.478290525330053, -7.549970580703839, 9.01944387220861, 9.904333541612832, 12.70817047406136, 6.794779805849602, 3.780227816297078, -9.741940060173894, 25.262654331376154, 21.413288660383717, -20.86040179206927, 3.72164276068618], "policy_adversary_policy_reward": [-19.93737063692328, 1.4673676560455018, -7.70248180038973, -7.858928126120055, -23.71398644248671, -22.776126818370827, -8.339825207384013, 3.989143274257742, -15.468994028178912, -6.445497435192916, -14.197952561310302, -2.1920720725053364, -23.109795453994785, -14.48899715673942, 3.359339521081568, 3.553534540792654, -33.02039216332854, -8.813244587544375, -26.444960681325554, -26.962105066294196, -17.381578289275968, -9.108244035919299, 2.0978358289036763, -28.395050132706324, -12.325961098118885, -1.6833251405857226, -4.677746582133665, 4.537767511631046, -10.504879395319591, 6.28656065824682, -1.4661184130435885, 12.916343254518079, -1.5253104067439764, -7.28058111273436, 0.307491955640657, -6.22888372582992, -10.10295430467323, -10.600257485441094, -9.767303550781836, -34.280834311440344, 4.453279898580774, 9.2243362213679, -25.3561408771834, -16.79111448286337, -15.97626538010164, -7.278757216902008, -19.87009125053075, -28.61016806431123, -27.880289183289136, -22.293669534398603, -26.009023262439595, -9.244136076828823, -10.401395797459362, -22.31335111976736, -13.32875507636803, -24.753613395787667, 1.5534996415129478, 2.970316092031296, 9.203989714969069, -18.968591116779155, -21.13650524187372, -4.068708561746593, 25.9607243522193, -30.438075056416196, -19.99467482356937, -23.461052979364457, -28.133484262876685, -4.28119881786828, -25.199853148770067, -17.646947472484012, -17.426629110689525, -4.893954408072158, -0.19770708417858174, 5.926539539273243, -29.126071682117534, -15.189441097209599, -21.720368987678757, -18.197663353164035, -8.854234977825858, 9.68492234801105, -20.16848325387838, -24.21339362593935, -2.036357685920983, -9.498490209214015, -26.838666232544995, -13.793040484050156, -22.457513897378895, -18.915382291626493, -10.981327062473824, 1.8438509134175334, 9.962325767296164, -3.7740835122553307, -16.18312258264764, -25.9677719675454, -9.492628242461713, -25.00749058833252, 4.7634681601654165, -2.504023314678264, 10.553677016474197, -15.035794690292715, 0.4001907129652764, 11.957946092972904, -6.680493384015687, 0.1142784437157971, -12.256439792083068, -27.600415092481686, 13.941484290184299, 7.147014554925697, -5.451645312806278, -5.115901967270606, -3.6134765944125338, 9.372707845001774, 18.549469324778904, 11.33642339018396, -13.355126307646522, -10.77393613205643, -15.597773742332706, 5.32894677475965, -10.282360350598292, -26.97772181301142, -0.919837653929946, 11.133520746763438, -15.40339119419292, -13.589914185600154, 15.308846379188132, -14.747061518217002, 14.252602886910225, -11.99881307207255, -5.725666171452559, -10.974264402005883, -25.94612649089133, -12.026455822377311, -10.095011512862156, 11.70343700545433, 10.938331557253036, 8.87605373123711, -3.779315846762998, -10.248313214739465, 5.911441425609013, -8.71632938517439, 9.51504399231068, -31.13084130342689, -18.19658436788414, -29.332765040441764, -4.5887678639725, -27.60640870223302, -8.379541035986449, 3.8726331647027763, -18.27093839492583, -19.98111397036919, -9.014651898249241, -10.12630251895645, 3.547772245330293, 19.074276457498147, -28.26890420477436, -21.376129221872777, 0.9146108794164007, -19.74439554588529, 19.83375994367174, -3.416016425745017, -1.5541779915573812, 3.7834428049108766, 17.17278743387301, 16.997783815016113, 4.261884325179494, -7.2085769472253745, -1.1667403439522506, -19.293199089544103, 7.46960159624178, -20.184670822053185, -20.440549345467307, -8.34737622834685, -15.654307456112821, 7.887921675780486, -16.025730889600112, -19.28742610927542, -22.266829145063348, 7.310248094403242, 6.763268088120199, 8.336673073287479, 8.505266801521948, -26.54415454593917, 9.032898655373558, -28.841565738599222, -18.750133557094326, -6.666207391028404, -17.934613891333047, 4.345054279633846, -5.339749029510223, -2.220706603083933, 13.557255395292128, 5.92662472505566, -33.78431833720872, -16.74099032554358, -11.867924414575981, -30.958652906191453, 17.692361054305874, 24.028442529832642, -4.779994298153973, -2.663291223218387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4521617313321912, "mean_inference_ms": 1.2139936180545035, "mean_action_processing_ms": 0.19611172024928158, "mean_env_wait_ms": 0.08104713835611298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004156589508056641, "StateBufferConnector_ms": 0.0030171871185302734, "ViewRequirementAgentConnector_ms": 0.08258652687072754}, "num_episodes": 11, "episode_return_max": 20.860401792069258, "episode_return_min": -26.703532873809877, "episode_return_mean": -8.159118393946448}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.3314313923039, "num_env_steps_trained_throughput_per_sec": 446.3314313923039, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 8968.836, "restore_workers_time_ms": 0.028, "training_step_time_ms": 8968.774, "sample_time_ms": 999.705, "learn_time_ms": 7954.339, "learn_throughput": 502.87, "synch_weights_time_ms": 14.224}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 58, "trial_id": "83a5c_00000", "date": "2024-08-10_12-22-25", "timestamp": 1723306945, "time_this_iter_s": 8.998420000076294, "time_total_s": 508.5831608772278, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faaeca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 508.5831608772278, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 32.199999999999996, "ram_util_percent": 83.07692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2171936581689846, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.367576522045034, "policy_loss": -0.007137688693575679, "vf_loss": 4.373883024725334, "vf_explained_var": -0.009929531749594149, "kl": 0.011675342706494658, "entropy": 1.0950975913219352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.251895549086233, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4364614109198253, "policy_loss": -0.0051502662642936535, "vf_loss": 3.4411709065238636, "vf_explained_var": 0.41297649530073005, "kl": 0.013930879121186101, "entropy": 0.5937789580474298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "env_runners": {"episode_reward_max": 20.860401792069258, "episode_reward_min": -30.30262228387499, "episode_reward_mean": -7.861568004496182, "episode_len_mean": 380.9, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38090, "policy_reward_min": {"agent_policy": -20.86040179206927, "adversary_policy": -46.95672069478509}, "policy_reward_max": {"agent_policy": 30.302622283874992, "adversary_policy": 25.9607243522193}, "policy_reward_mean": {"agent_policy": 7.861568004496183, "adversary_policy": -7.861568004496182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.004643119352302, -0.06998953525130958, -2.1091593685363854, 5.725112420737245, -4.402945759739168, -2.9606958850946317, -10.351605895057162, -22.024068931111092, 6.838808059974337, -21.073627680023396, -11.627511298501823, -24.24012965742099, -25.08697935884387, -17.62657966963421, -16.35737345861336, -19.041184236077846, 2.261907866772122, -4.882300700905043, -12.602606901810145, -2.2386753520984453, -21.727863901466893, -16.207341540372482, -21.423400310627038, -11.160291759380844, 2.8644162275473306, -22.157756389663568, -19.9590161704214, 0.415343685092596, -22.19093843990887, -5.767423947567499, -20.315853358297574, -20.686448094502687, -4.568738074528145, 3.094121127520417, -21.07544727509652, -17.250059415397114, 1.1297224227435763, -2.241058836909259, 6.17906840296909, -3.283107470149945, -19.928427442282388, 10.544249422555, -5.283773640038435, 2.8796156252946243, 14.942946357481434, -12.064531219851478, -5.134413483786528, -18.630041081804855, 5.106841546416746, -14.496652689896537, 0.2808924304855651, 1.126894907418837, -8.349965286729221, -18.98629115663432, 0.8042127462960864, 9.907192644245074, -7.013814530751231, -1.4024439797826886, -10.807898655558102, -23.764674704162942, -16.09758828310276, -2.2534539356418364, -19.12602618264751, -9.570477208602846, 11.31102435141422, -24.82251671332354, -9.414892333234445, 8.208871758963362, 1.1146324066767477, 17.085285624444538, -1.4733463110229401, -10.229969716748174, -6.357534612905703, -14.393962786907078, -3.8831928901661534, -17.656578499437764, -7.478290525330053, 7.549970580703839, -9.019443872208612, -9.904333541612832, -12.708170474061355, -6.794779805849602, -3.780227816297078, 9.741940060173894, -25.26265433137615, -21.413288660383717, 20.860401792069258, -3.72164276068618, -1.271014967760694, -7.27491001307088, -20.47524174894268, -0.7964812712716509, 1.8583714094952395, -23.209901877322096, 15.868121843150021, -30.30262228387499, -3.337784315767239, -16.81411954634214, -28.209801819517835, -7.224767401203158], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [7.004643119352304, 0.06998953525130958, 2.1091593685363854, -5.725112420737245, 4.402945759739168, 2.9606958850946317, 10.351605895057162, 22.024068931111092, -6.838808059974337, 21.0736276800234, 11.627511298501824, 24.24012965742099, 25.086979358843873, 17.62657966963421, 16.35737345861336, 19.041184236077846, -2.261907866772122, 4.882300700905043, 12.602606901810145, 2.2386753520984453, 21.727863901466904, 16.207341540372482, 21.423400310627038, 11.160291759380844, -2.8644162275473306, 22.157756389663568, 19.9590161704214, -0.415343685092596, 22.190938439908866, 5.767423947567499, 20.315853358297577, 20.686448094502698, 4.568738074528145, -3.094121127520417, 21.075447275096515, 17.250059415397114, -1.1297224227435763, 2.241058836909259, -6.17906840296909, 3.283107470149945, 19.928427442282377, -10.544249422554998, 5.28377364003844, -2.879615625294619, -14.942946357481434, 12.064531219851476, 5.134413483786528, 18.630041081804855, -5.106841546416746, 14.496652689896537, -0.2808924304855651, -1.126894907418837, 8.349965286729221, 18.98629115663432, -0.8042127462960864, -9.907192644245074, 7.013814530751231, 1.4024439797826886, 10.807898655558105, 23.764674704162946, 16.09758828310276, 2.2534539356418364, 19.12602618264751, 9.570477208602846, -11.311024351414222, 24.822516713323544, 9.414892333234445, -8.208871758963362, -1.1146324066767477, -17.08528562444454, 1.4733463110229401, 10.229969716748176, 6.3575346129057015, 14.393962786907078, 3.8831928901661623, 17.656578499437764, 7.478290525330053, -7.549970580703839, 9.01944387220861, 9.904333541612832, 12.70817047406136, 6.794779805849602, 3.780227816297078, -9.741940060173894, 25.262654331376154, 21.413288660383717, -20.86040179206927, 3.72164276068618, 1.271014967760694, 7.274910013070876, 20.47524174894268, 0.7964812712716509, -1.8583714094952395, 23.209901877322096, -15.868121843150012, 30.302622283874992, 3.337784315767239, 16.81411954634214, 28.209801819517832, 7.224767401203154], "policy_adversary_policy_reward": [-12.325961098118885, -1.6833251405857226, -4.677746582133665, 4.537767511631046, -10.504879395319591, 6.28656065824682, -1.4661184130435885, 12.916343254518079, -1.5253104067439764, -7.28058111273436, 0.307491955640657, -6.22888372582992, -10.10295430467323, -10.600257485441094, -9.767303550781836, -34.280834311440344, 4.453279898580774, 9.2243362213679, -25.3561408771834, -16.79111448286337, -15.97626538010164, -7.278757216902008, -19.87009125053075, -28.61016806431123, -27.880289183289136, -22.293669534398603, -26.009023262439595, -9.244136076828823, -10.401395797459362, -22.31335111976736, -13.32875507636803, -24.753613395787667, 1.5534996415129478, 2.970316092031296, 9.203989714969069, -18.968591116779155, -21.13650524187372, -4.068708561746593, 25.9607243522193, -30.438075056416196, -19.99467482356937, -23.461052979364457, -28.133484262876685, -4.28119881786828, -25.199853148770067, -17.646947472484012, -17.426629110689525, -4.893954408072158, -0.19770708417858174, 5.926539539273243, -29.126071682117534, -15.189441097209599, -21.720368987678757, -18.197663353164035, -8.854234977825858, 9.68492234801105, -20.16848325387838, -24.21339362593935, -2.036357685920983, -9.498490209214015, -26.838666232544995, -13.793040484050156, -22.457513897378895, -18.915382291626493, -10.981327062473824, 1.8438509134175334, 9.962325767296164, -3.7740835122553307, -16.18312258264764, -25.9677719675454, -9.492628242461713, -25.00749058833252, 4.7634681601654165, -2.504023314678264, 10.553677016474197, -15.035794690292715, 0.4001907129652764, 11.957946092972904, -6.680493384015687, 0.1142784437157971, -12.256439792083068, -27.600415092481686, 13.941484290184299, 7.147014554925697, -5.451645312806278, -5.115901967270606, -3.6134765944125338, 9.372707845001774, 18.549469324778904, 11.33642339018396, -13.355126307646522, -10.77393613205643, -15.597773742332706, 5.32894677475965, -10.282360350598292, -26.97772181301142, -0.919837653929946, 11.133520746763438, -15.40339119419292, -13.589914185600154, 15.308846379188132, -14.747061518217002, 14.252602886910225, -11.99881307207255, -5.725666171452559, -10.974264402005883, -25.94612649089133, -12.026455822377311, -10.095011512862156, 11.70343700545433, 10.938331557253036, 8.87605373123711, -3.779315846762998, -10.248313214739465, 5.911441425609013, -8.71632938517439, 9.51504399231068, -31.13084130342689, -18.19658436788414, -29.332765040441764, -4.5887678639725, -27.60640870223302, -8.379541035986449, 3.8726331647027763, -18.27093839492583, -19.98111397036919, -9.014651898249241, -10.12630251895645, 3.547772245330293, 19.074276457498147, -28.26890420477436, -21.376129221872777, 0.9146108794164007, -19.74439554588529, 19.83375994367174, -3.416016425745017, -1.5541779915573812, 3.7834428049108766, 17.17278743387301, 16.997783815016113, 4.261884325179494, -7.2085769472253745, -1.1667403439522506, -19.293199089544103, 7.46960159624178, -20.184670822053185, -20.440549345467307, -8.34737622834685, -15.654307456112821, 7.887921675780486, -16.025730889600112, -19.28742610927542, -22.266829145063348, 7.310248094403242, 6.763268088120199, 8.336673073287479, 8.505266801521948, -26.54415454593917, 9.032898655373558, -28.841565738599222, -18.750133557094326, -6.666207391028404, -17.934613891333047, 4.345054279633846, -5.339749029510223, -2.220706603083933, 13.557255395292128, 5.92662472505566, -33.78431833720872, -16.74099032554358, -11.867924414575981, -30.958652906191453, 17.692361054305874, 24.028442529832642, -4.779994298153973, -2.663291223218387, -2.626892275650384, 0.0848623401289963, 1.4027527763133492, -15.95257280245512, -20.89875848521026, -20.0517250126751, -26.716341400664916, 25.12337885812161, 9.560955716813428, -5.844212897822949, 0.5369169401408982, -46.95672069478509, 9.424126070912838, 22.31211761538727, -31.499814591493454, -29.10542997625654, -15.757729054089914, 9.082160422555436, -26.411833522379755, -7.2164055703045396, -15.47156754205766, -40.94803609697801, -27.337912275503324, 12.888377473097016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45260371161065877, "mean_inference_ms": 1.216293244523882, "mean_action_processing_ms": 0.19612711164072447, "mean_env_wait_ms": 0.08116470111136496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040895938873291016, "StateBufferConnector_ms": 0.002971649169921875, "ViewRequirementAgentConnector_ms": 0.08307850360870361}, "num_episodes": 12, "episode_return_max": 20.860401792069258, "episode_return_min": -30.30262228387499, "episode_return_mean": -7.861568004496182}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.79890696356296, "num_env_steps_trained_throughput_per_sec": 438.79890696356296, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 8995.418, "restore_workers_time_ms": 0.028, "training_step_time_ms": 8995.357, "sample_time_ms": 1012.41, "learn_time_ms": 7968.598, "learn_throughput": 501.97, "synch_weights_time_ms": 13.836}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "training_iteration": 59, "trial_id": "83a5c_00000", "date": "2024-08-10_12-22-34", "timestamp": 1723306954, "time_this_iter_s": 9.122259855270386, "time_total_s": 517.7054207324982, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fae5af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 517.7054207324982, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 33.823076923076925, "ram_util_percent": 82.97692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.305395297367106, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.226284259589261, "policy_loss": -0.011338239344989969, "vf_loss": 4.236556402968351, "vf_explained_var": -0.06923372679286532, "kl": 0.014975156645872196, "entropy": 1.092183792559558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1969703966751695, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0176984143753844, "policy_loss": -0.009303001122316346, "vf_loss": 3.0263997835417586, "vf_explained_var": 0.4069873283927639, "kl": 0.019014532472152724, "entropy": 0.7049594700957338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 20.860401792069258, "episode_reward_min": -31.117761429620444, "episode_reward_mean": -9.014435317412278, "episode_len_mean": 380.9, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38090, "policy_reward_min": {"agent_policy": -20.86040179206927, "adversary_policy": -46.95672069478509}, "policy_reward_max": {"agent_policy": 31.117761429620447, "adversary_policy": 25.9607243522193}, "policy_reward_mean": {"agent_policy": 9.01443531741228, "adversary_policy": -9.01443531741228}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.627511298501823, -24.24012965742099, -25.08697935884387, -17.62657966963421, -16.35737345861336, -19.041184236077846, 2.261907866772122, -4.882300700905043, -12.602606901810145, -2.2386753520984453, -21.727863901466893, -16.207341540372482, -21.423400310627038, -11.160291759380844, 2.8644162275473306, -22.157756389663568, -19.9590161704214, 0.415343685092596, -22.19093843990887, -5.767423947567499, -20.315853358297574, -20.686448094502687, -4.568738074528145, 3.094121127520417, -21.07544727509652, -17.250059415397114, 1.1297224227435763, -2.241058836909259, 6.17906840296909, -3.283107470149945, -19.928427442282388, 10.544249422555, -5.283773640038435, 2.8796156252946243, 14.942946357481434, -12.064531219851478, -5.134413483786528, -18.630041081804855, 5.106841546416746, -14.496652689896537, 0.2808924304855651, 1.126894907418837, -8.349965286729221, -18.98629115663432, 0.8042127462960864, 9.907192644245074, -7.013814530751231, -1.4024439797826886, -10.807898655558102, -23.764674704162942, -16.09758828310276, -2.2534539356418364, -19.12602618264751, -9.570477208602846, 11.31102435141422, -24.82251671332354, -9.414892333234445, 8.208871758963362, 1.1146324066767477, 17.085285624444538, -1.4733463110229401, -10.229969716748174, -6.357534612905703, -14.393962786907078, -3.8831928901661534, -17.656578499437764, -7.478290525330053, 7.549970580703839, -9.019443872208612, -9.904333541612832, -12.708170474061355, -6.794779805849602, -3.780227816297078, 9.741940060173894, -25.26265433137615, -21.413288660383717, 20.860401792069258, -3.72164276068618, -1.271014967760694, -7.27491001307088, -20.47524174894268, -0.7964812712716509, 1.8583714094952395, -23.209901877322096, 15.868121843150021, -30.30262228387499, -3.337784315767239, -16.81411954634214, -28.209801819517835, -7.224767401203158, -29.66058874571329, -31.117761429620444, -24.43900033214138, -27.34362285692223, 0.15030028873241008, -9.365709855026749, -4.880659325492124, -20.084116177557732, -6.118320361797475, -19.860068189524544], "episode_lengths": [400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [11.627511298501824, 24.24012965742099, 25.086979358843873, 17.62657966963421, 16.35737345861336, 19.041184236077846, -2.261907866772122, 4.882300700905043, 12.602606901810145, 2.2386753520984453, 21.727863901466904, 16.207341540372482, 21.423400310627038, 11.160291759380844, -2.8644162275473306, 22.157756389663568, 19.9590161704214, -0.415343685092596, 22.190938439908866, 5.767423947567499, 20.315853358297577, 20.686448094502698, 4.568738074528145, -3.094121127520417, 21.075447275096515, 17.250059415397114, -1.1297224227435763, 2.241058836909259, -6.17906840296909, 3.283107470149945, 19.928427442282377, -10.544249422554998, 5.28377364003844, -2.879615625294619, -14.942946357481434, 12.064531219851476, 5.134413483786528, 18.630041081804855, -5.106841546416746, 14.496652689896537, -0.2808924304855651, -1.126894907418837, 8.349965286729221, 18.98629115663432, -0.8042127462960864, -9.907192644245074, 7.013814530751231, 1.4024439797826886, 10.807898655558105, 23.764674704162946, 16.09758828310276, 2.2534539356418364, 19.12602618264751, 9.570477208602846, -11.311024351414222, 24.822516713323544, 9.414892333234445, -8.208871758963362, -1.1146324066767477, -17.08528562444454, 1.4733463110229401, 10.229969716748176, 6.3575346129057015, 14.393962786907078, 3.8831928901661623, 17.656578499437764, 7.478290525330053, -7.549970580703839, 9.01944387220861, 9.904333541612832, 12.70817047406136, 6.794779805849602, 3.780227816297078, -9.741940060173894, 25.262654331376154, 21.413288660383717, -20.86040179206927, 3.72164276068618, 1.271014967760694, 7.274910013070876, 20.47524174894268, 0.7964812712716509, -1.8583714094952395, 23.209901877322096, -15.868121843150012, 30.302622283874992, 3.337784315767239, 16.81411954634214, 28.209801819517832, 7.224767401203154, 29.660588745713284, 31.117761429620447, 24.439000332141383, 27.34362285692223, -0.15030028873241008, 9.365709855026749, 4.880659325492124, 20.084116177557732, 6.118320361797475, 19.860068189524544], "policy_adversary_policy_reward": [-15.97626538010164, -7.278757216902008, -19.87009125053075, -28.61016806431123, -27.880289183289136, -22.293669534398603, -26.009023262439595, -9.244136076828823, -10.401395797459362, -22.31335111976736, -13.32875507636803, -24.753613395787667, 1.5534996415129478, 2.970316092031296, 9.203989714969069, -18.968591116779155, -21.13650524187372, -4.068708561746593, 25.9607243522193, -30.438075056416196, -19.99467482356937, -23.461052979364457, -28.133484262876685, -4.28119881786828, -25.199853148770067, -17.646947472484012, -17.426629110689525, -4.893954408072158, -0.19770708417858174, 5.926539539273243, -29.126071682117534, -15.189441097209599, -21.720368987678757, -18.197663353164035, -8.854234977825858, 9.68492234801105, -20.16848325387838, -24.21339362593935, -2.036357685920983, -9.498490209214015, -26.838666232544995, -13.793040484050156, -22.457513897378895, -18.915382291626493, -10.981327062473824, 1.8438509134175334, 9.962325767296164, -3.7740835122553307, -16.18312258264764, -25.9677719675454, -9.492628242461713, -25.00749058833252, 4.7634681601654165, -2.504023314678264, 10.553677016474197, -15.035794690292715, 0.4001907129652764, 11.957946092972904, -6.680493384015687, 0.1142784437157971, -12.256439792083068, -27.600415092481686, 13.941484290184299, 7.147014554925697, -5.451645312806278, -5.115901967270606, -3.6134765944125338, 9.372707845001774, 18.549469324778904, 11.33642339018396, -13.355126307646522, -10.77393613205643, -15.597773742332706, 5.32894677475965, -10.282360350598292, -26.97772181301142, -0.919837653929946, 11.133520746763438, -15.40339119419292, -13.589914185600154, 15.308846379188132, -14.747061518217002, 14.252602886910225, -11.99881307207255, -5.725666171452559, -10.974264402005883, -25.94612649089133, -12.026455822377311, -10.095011512862156, 11.70343700545433, 10.938331557253036, 8.87605373123711, -3.779315846762998, -10.248313214739465, 5.911441425609013, -8.71632938517439, 9.51504399231068, -31.13084130342689, -18.19658436788414, -29.332765040441764, -4.5887678639725, -27.60640870223302, -8.379541035986449, 3.8726331647027763, -18.27093839492583, -19.98111397036919, -9.014651898249241, -10.12630251895645, 3.547772245330293, 19.074276457498147, -28.26890420477436, -21.376129221872777, 0.9146108794164007, -19.74439554588529, 19.83375994367174, -3.416016425745017, -1.5541779915573812, 3.7834428049108766, 17.17278743387301, 16.997783815016113, 4.261884325179494, -7.2085769472253745, -1.1667403439522506, -19.293199089544103, 7.46960159624178, -20.184670822053185, -20.440549345467307, -8.34737622834685, -15.654307456112821, 7.887921675780486, -16.025730889600112, -19.28742610927542, -22.266829145063348, 7.310248094403242, 6.763268088120199, 8.336673073287479, 8.505266801521948, -26.54415454593917, 9.032898655373558, -28.841565738599222, -18.750133557094326, -6.666207391028404, -17.934613891333047, 4.345054279633846, -5.339749029510223, -2.220706603083933, 13.557255395292128, 5.92662472505566, -33.78431833720872, -16.74099032554358, -11.867924414575981, -30.958652906191453, 17.692361054305874, 24.028442529832642, -4.779994298153973, -2.663291223218387, -2.626892275650384, 0.0848623401289963, 1.4027527763133492, -15.95257280245512, -20.89875848521026, -20.0517250126751, -26.716341400664916, 25.12337885812161, 9.560955716813428, -5.844212897822949, 0.5369169401408982, -46.95672069478509, 9.424126070912838, 22.31211761538727, -31.499814591493454, -29.10542997625654, -15.757729054089914, 9.082160422555436, -26.411833522379755, -7.2164055703045396, -15.47156754205766, -40.94803609697801, -27.337912275503324, 12.888377473097016, -28.408557934520847, -30.912619556905728, -25.743945007726584, -36.491577851514315, -18.96959644625113, -29.908404218031624, -19.403346259735308, -35.28389945410916, -5.616056825360857, 5.9166574028256775, -0.9133604090261898, -17.818059301027308, 6.437111264502754, -16.198429915487, -26.258658666006735, -13.909573689108726, -13.02863677689386, 0.7919960532989094, -13.700522566437385, -26.019613812611702]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4530021685312526, "mean_inference_ms": 1.2185672011291366, "mean_action_processing_ms": 0.1962423364653405, "mean_env_wait_ms": 0.08131395943787917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041217803955078125, "StateBufferConnector_ms": 0.0029172897338867188, "ViewRequirementAgentConnector_ms": 0.08437871932983398}, "num_episodes": 10, "episode_return_max": 20.860401792069258, "episode_return_min": -31.117761429620444, "episode_return_mean": -9.014435317412278}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.1300885972281, "num_env_steps_trained_throughput_per_sec": 418.1300885972281, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 9073.723, "restore_workers_time_ms": 0.029, "training_step_time_ms": 9073.662, "sample_time_ms": 1025.256, "learn_time_ms": 8033.936, "learn_throughput": 497.888, "synch_weights_time_ms": 13.938}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 60, "trial_id": "83a5c_00000", "date": "2024-08-10_12-22-43", "timestamp": 1723306963, "time_this_iter_s": 9.572237253189087, "time_total_s": 527.2776579856873, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 527.2776579856873, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 42.0, "ram_util_percent": 83.29230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6556470235504173, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7052388652922614, "policy_loss": -0.004315282361921928, "vf_loss": 3.708863193017465, "vf_explained_var": -0.027962222994950714, "kl": 0.009705589396765253, "entropy": 1.0877346809263582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.332215193659067, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.211055474790434, "policy_loss": -0.008611988527021216, "vf_loss": 2.2193634612485766, "vf_explained_var": -0.13233254235237837, "kl": 0.009608136234139883, "entropy": 0.6352601440002521, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "env_runners": {"episode_reward_max": 20.860401792069258, "episode_reward_min": -31.117761429620444, "episode_reward_mean": -8.919455517922401, "episode_len_mean": 384.87, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38487, "policy_reward_min": {"agent_policy": -20.86040179206927, "adversary_policy": -46.95672069478509}, "policy_reward_max": {"agent_policy": 31.117761429620447, "adversary_policy": 25.12337885812161}, "policy_reward_mean": {"agent_policy": 8.919455517922401, "adversary_policy": -8.919455517922401}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.727863901466893, -16.207341540372482, -21.423400310627038, -11.160291759380844, 2.8644162275473306, -22.157756389663568, -19.9590161704214, 0.415343685092596, -22.19093843990887, -5.767423947567499, -20.315853358297574, -20.686448094502687, -4.568738074528145, 3.094121127520417, -21.07544727509652, -17.250059415397114, 1.1297224227435763, -2.241058836909259, 6.17906840296909, -3.283107470149945, -19.928427442282388, 10.544249422555, -5.283773640038435, 2.8796156252946243, 14.942946357481434, -12.064531219851478, -5.134413483786528, -18.630041081804855, 5.106841546416746, -14.496652689896537, 0.2808924304855651, 1.126894907418837, -8.349965286729221, -18.98629115663432, 0.8042127462960864, 9.907192644245074, -7.013814530751231, -1.4024439797826886, -10.807898655558102, -23.764674704162942, -16.09758828310276, -2.2534539356418364, -19.12602618264751, -9.570477208602846, 11.31102435141422, -24.82251671332354, -9.414892333234445, 8.208871758963362, 1.1146324066767477, 17.085285624444538, -1.4733463110229401, -10.229969716748174, -6.357534612905703, -14.393962786907078, -3.8831928901661534, -17.656578499437764, -7.478290525330053, 7.549970580703839, -9.019443872208612, -9.904333541612832, -12.708170474061355, -6.794779805849602, -3.780227816297078, 9.741940060173894, -25.26265433137615, -21.413288660383717, 20.860401792069258, -3.72164276068618, -1.271014967760694, -7.27491001307088, -20.47524174894268, -0.7964812712716509, 1.8583714094952395, -23.209901877322096, 15.868121843150021, -30.30262228387499, -3.337784315767239, -16.81411954634214, -28.209801819517835, -7.224767401203158, -29.66058874571329, -31.117761429620444, -24.43900033214138, -27.34362285692223, 0.15030028873241008, -9.365709855026749, -4.880659325492124, -20.084116177557732, -6.118320361797475, -19.860068189524544, -17.378349586729644, -8.515627363230173, -8.019205580505494, -7.847631773355902, -14.383145918639848, -12.327034749997772, -4.351842218600928, -30.470435243429833, -13.100892957273864, -5.549287426382266], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [21.727863901466904, 16.207341540372482, 21.423400310627038, 11.160291759380844, -2.8644162275473306, 22.157756389663568, 19.9590161704214, -0.415343685092596, 22.190938439908866, 5.767423947567499, 20.315853358297577, 20.686448094502698, 4.568738074528145, -3.094121127520417, 21.075447275096515, 17.250059415397114, -1.1297224227435763, 2.241058836909259, -6.17906840296909, 3.283107470149945, 19.928427442282377, -10.544249422554998, 5.28377364003844, -2.879615625294619, -14.942946357481434, 12.064531219851476, 5.134413483786528, 18.630041081804855, -5.106841546416746, 14.496652689896537, -0.2808924304855651, -1.126894907418837, 8.349965286729221, 18.98629115663432, -0.8042127462960864, -9.907192644245074, 7.013814530751231, 1.4024439797826886, 10.807898655558105, 23.764674704162946, 16.09758828310276, 2.2534539356418364, 19.12602618264751, 9.570477208602846, -11.311024351414222, 24.822516713323544, 9.414892333234445, -8.208871758963362, -1.1146324066767477, -17.08528562444454, 1.4733463110229401, 10.229969716748176, 6.3575346129057015, 14.393962786907078, 3.8831928901661623, 17.656578499437764, 7.478290525330053, -7.549970580703839, 9.01944387220861, 9.904333541612832, 12.70817047406136, 6.794779805849602, 3.780227816297078, -9.741940060173894, 25.262654331376154, 21.413288660383717, -20.86040179206927, 3.72164276068618, 1.271014967760694, 7.274910013070876, 20.47524174894268, 0.7964812712716509, -1.8583714094952395, 23.209901877322096, -15.868121843150012, 30.302622283874992, 3.337784315767239, 16.81411954634214, 28.209801819517832, 7.224767401203154, 29.660588745713284, 31.117761429620447, 24.439000332141383, 27.34362285692223, -0.15030028873241008, 9.365709855026749, 4.880659325492124, 20.084116177557732, 6.118320361797475, 19.860068189524544, 17.378349586729648, 8.515627363230173, 8.0192055805055, 7.847631773355902, 14.383145918639848, 12.327034749997773, 4.351842218600929, 30.47043524342983, 13.100892957273864, 5.549287426382266], "policy_adversary_policy_reward": [-19.99467482356937, -23.461052979364457, -28.133484262876685, -4.28119881786828, -25.199853148770067, -17.646947472484012, -17.426629110689525, -4.893954408072158, -0.19770708417858174, 5.926539539273243, -29.126071682117534, -15.189441097209599, -21.720368987678757, -18.197663353164035, -8.854234977825858, 9.68492234801105, -20.16848325387838, -24.21339362593935, -2.036357685920983, -9.498490209214015, -26.838666232544995, -13.793040484050156, -22.457513897378895, -18.915382291626493, -10.981327062473824, 1.8438509134175334, 9.962325767296164, -3.7740835122553307, -16.18312258264764, -25.9677719675454, -9.492628242461713, -25.00749058833252, 4.7634681601654165, -2.504023314678264, 10.553677016474197, -15.035794690292715, 0.4001907129652764, 11.957946092972904, -6.680493384015687, 0.1142784437157971, -12.256439792083068, -27.600415092481686, 13.941484290184299, 7.147014554925697, -5.451645312806278, -5.115901967270606, -3.6134765944125338, 9.372707845001774, 18.549469324778904, 11.33642339018396, -13.355126307646522, -10.77393613205643, -15.597773742332706, 5.32894677475965, -10.282360350598292, -26.97772181301142, -0.919837653929946, 11.133520746763438, -15.40339119419292, -13.589914185600154, 15.308846379188132, -14.747061518217002, 14.252602886910225, -11.99881307207255, -5.725666171452559, -10.974264402005883, -25.94612649089133, -12.026455822377311, -10.095011512862156, 11.70343700545433, 10.938331557253036, 8.87605373123711, -3.779315846762998, -10.248313214739465, 5.911441425609013, -8.71632938517439, 9.51504399231068, -31.13084130342689, -18.19658436788414, -29.332765040441764, -4.5887678639725, -27.60640870223302, -8.379541035986449, 3.8726331647027763, -18.27093839492583, -19.98111397036919, -9.014651898249241, -10.12630251895645, 3.547772245330293, 19.074276457498147, -28.26890420477436, -21.376129221872777, 0.9146108794164007, -19.74439554588529, 19.83375994367174, -3.416016425745017, -1.5541779915573812, 3.7834428049108766, 17.17278743387301, 16.997783815016113, 4.261884325179494, -7.2085769472253745, -1.1667403439522506, -19.293199089544103, 7.46960159624178, -20.184670822053185, -20.440549345467307, -8.34737622834685, -15.654307456112821, 7.887921675780486, -16.025730889600112, -19.28742610927542, -22.266829145063348, 7.310248094403242, 6.763268088120199, 8.336673073287479, 8.505266801521948, -26.54415454593917, 9.032898655373558, -28.841565738599222, -18.750133557094326, -6.666207391028404, -17.934613891333047, 4.345054279633846, -5.339749029510223, -2.220706603083933, 13.557255395292128, 5.92662472505566, -33.78431833720872, -16.74099032554358, -11.867924414575981, -30.958652906191453, 17.692361054305874, 24.028442529832642, -4.779994298153973, -2.663291223218387, -2.626892275650384, 0.0848623401289963, 1.4027527763133492, -15.95257280245512, -20.89875848521026, -20.0517250126751, -26.716341400664916, 25.12337885812161, 9.560955716813428, -5.844212897822949, 0.5369169401408982, -46.95672069478509, 9.424126070912838, 22.31211761538727, -31.499814591493454, -29.10542997625654, -15.757729054089914, 9.082160422555436, -26.411833522379755, -7.2164055703045396, -15.47156754205766, -40.94803609697801, -27.337912275503324, 12.888377473097016, -28.408557934520847, -30.912619556905728, -25.743945007726584, -36.491577851514315, -18.96959644625113, -29.908404218031624, -19.403346259735308, -35.28389945410916, -5.616056825360857, 5.9166574028256775, -0.9133604090261898, -17.818059301027308, 6.437111264502754, -16.198429915487, -26.258658666006735, -13.909573689108726, -13.02863677689386, 0.7919960532989094, -13.700522566437385, -26.019613812611702, -10.223631188735492, -24.533067984723818, -2.7572199428524087, -14.274034783607938, -20.486434656669168, 4.448023495658173, 3.2700293115961756, -18.96529285830798, -22.42064559335436, -6.34564624392533, -31.60187947863286, 6.947809978637316, -9.425590510059827, 0.7219060728579709, -25.851336005776307, -35.08953448108335, -4.00761287115472, -22.194173043393004, -14.330112134582997, 3.231537281818465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4535107873148385, "mean_inference_ms": 1.2206348532005387, "mean_action_processing_ms": 0.19629341316693705, "mean_env_wait_ms": 0.08142589194586819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040961503982543945, "StateBufferConnector_ms": 0.0028988122940063477, "ViewRequirementAgentConnector_ms": 0.08424687385559082}, "num_episodes": 10, "episode_return_max": 20.860401792069258, "episode_return_min": -31.117761429620444, "episode_return_mean": -8.919455517922401}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 443.0607107101952, "num_env_steps_trained_throughput_per_sec": 443.0607107101952, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 732000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 9093.505, "restore_workers_time_ms": 0.03, "training_step_time_ms": 9093.441, "sample_time_ms": 1030.64, "learn_time_ms": 8047.934, "learn_throughput": 497.022, "synch_weights_time_ms": 14.337}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "training_iteration": 61, "trial_id": "83a5c_00000", "date": "2024-08-10_12-22-52", "timestamp": 1723306972, "time_this_iter_s": 9.0417320728302, "time_total_s": 536.3193900585175, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faaed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 536.3193900585175, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 33.41538461538462, "ram_util_percent": 82.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.629714899466782, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.273753019615456, "policy_loss": -0.0036846012727076573, "vf_loss": 4.2765492141562165, "vf_explained_var": 0.03383353321009843, "kl": 0.012478952748363518, "entropy": 1.123286472300373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.357531017716974, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.640488533427318, "policy_loss": -0.0031008672866543446, "vf_loss": 3.6434059170385202, "vf_explained_var": 0.1100747666011254, "kl": 0.005799405233349863, "entropy": 0.6104105566317837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 20.860401792069258, "episode_reward_min": -31.117761429620444, "episode_reward_mean": -8.040563888231157, "episode_len_mean": 384.87, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38487, "policy_reward_min": {"agent_policy": -20.86040179206927, "adversary_policy": -46.95672069478509}, "policy_reward_max": {"agent_policy": 31.117761429620447, "adversary_policy": 25.12337885812161}, "policy_reward_mean": {"agent_policy": 8.040563888231157, "adversary_policy": -8.040563888231155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.767423947567499, -20.315853358297574, -20.686448094502687, -4.568738074528145, 3.094121127520417, -21.07544727509652, -17.250059415397114, 1.1297224227435763, -2.241058836909259, 6.17906840296909, -3.283107470149945, -19.928427442282388, 10.544249422555, -5.283773640038435, 2.8796156252946243, 14.942946357481434, -12.064531219851478, -5.134413483786528, -18.630041081804855, 5.106841546416746, -14.496652689896537, 0.2808924304855651, 1.126894907418837, -8.349965286729221, -18.98629115663432, 0.8042127462960864, 9.907192644245074, -7.013814530751231, -1.4024439797826886, -10.807898655558102, -23.764674704162942, -16.09758828310276, -2.2534539356418364, -19.12602618264751, -9.570477208602846, 11.31102435141422, -24.82251671332354, -9.414892333234445, 8.208871758963362, 1.1146324066767477, 17.085285624444538, -1.4733463110229401, -10.229969716748174, -6.357534612905703, -14.393962786907078, -3.8831928901661534, -17.656578499437764, -7.478290525330053, 7.549970580703839, -9.019443872208612, -9.904333541612832, -12.708170474061355, -6.794779805849602, -3.780227816297078, 9.741940060173894, -25.26265433137615, -21.413288660383717, 20.860401792069258, -3.72164276068618, -1.271014967760694, -7.27491001307088, -20.47524174894268, -0.7964812712716509, 1.8583714094952395, -23.209901877322096, 15.868121843150021, -30.30262228387499, -3.337784315767239, -16.81411954634214, -28.209801819517835, -7.224767401203158, -29.66058874571329, -31.117761429620444, -24.43900033214138, -27.34362285692223, 0.15030028873241008, -9.365709855026749, -4.880659325492124, -20.084116177557732, -6.118320361797475, -19.860068189524544, -17.378349586729644, -8.515627363230173, -8.019205580505494, -7.847631773355902, -14.383145918639848, -12.327034749997772, -4.351842218600928, -30.470435243429833, -13.100892957273864, -5.549287426382266, 3.546193117947304, -16.12320755426891, 1.35509783359554, 10.739356546627171, -5.05108385223235, -0.8315174799329066, -17.93497503170915, -17.019765766381568, -2.3377834437218015], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [5.767423947567499, 20.315853358297577, 20.686448094502698, 4.568738074528145, -3.094121127520417, 21.075447275096515, 17.250059415397114, -1.1297224227435763, 2.241058836909259, -6.17906840296909, 3.283107470149945, 19.928427442282377, -10.544249422554998, 5.28377364003844, -2.879615625294619, -14.942946357481434, 12.064531219851476, 5.134413483786528, 18.630041081804855, -5.106841546416746, 14.496652689896537, -0.2808924304855651, -1.126894907418837, 8.349965286729221, 18.98629115663432, -0.8042127462960864, -9.907192644245074, 7.013814530751231, 1.4024439797826886, 10.807898655558105, 23.764674704162946, 16.09758828310276, 2.2534539356418364, 19.12602618264751, 9.570477208602846, -11.311024351414222, 24.822516713323544, 9.414892333234445, -8.208871758963362, -1.1146324066767477, -17.08528562444454, 1.4733463110229401, 10.229969716748176, 6.3575346129057015, 14.393962786907078, 3.8831928901661623, 17.656578499437764, 7.478290525330053, -7.549970580703839, 9.01944387220861, 9.904333541612832, 12.70817047406136, 6.794779805849602, 3.780227816297078, -9.741940060173894, 25.262654331376154, 21.413288660383717, -20.86040179206927, 3.72164276068618, 1.271014967760694, 7.274910013070876, 20.47524174894268, 0.7964812712716509, -1.8583714094952395, 23.209901877322096, -15.868121843150012, 30.302622283874992, 3.337784315767239, 16.81411954634214, 28.209801819517832, 7.224767401203154, 29.660588745713284, 31.117761429620447, 24.439000332141383, 27.34362285692223, -0.15030028873241008, 9.365709855026749, 4.880659325492124, 20.084116177557732, 6.118320361797475, 19.860068189524544, 17.378349586729648, 8.515627363230173, 8.0192055805055, 7.847631773355902, 14.383145918639848, 12.327034749997773, 4.351842218600929, 30.47043524342983, 13.100892957273864, 5.549287426382266, -3.546193117947304, 16.1232075542689, -1.35509783359554, -10.739356546627171, 5.051083852232351, 0.8315174799328959, 17.934975031709154, 17.01976576638157, 2.3377834437218006], "policy_adversary_policy_reward": [-2.036357685920983, -9.498490209214015, -26.838666232544995, -13.793040484050156, -22.457513897378895, -18.915382291626493, -10.981327062473824, 1.8438509134175334, 9.962325767296164, -3.7740835122553307, -16.18312258264764, -25.9677719675454, -9.492628242461713, -25.00749058833252, 4.7634681601654165, -2.504023314678264, 10.553677016474197, -15.035794690292715, 0.4001907129652764, 11.957946092972904, -6.680493384015687, 0.1142784437157971, -12.256439792083068, -27.600415092481686, 13.941484290184299, 7.147014554925697, -5.451645312806278, -5.115901967270606, -3.6134765944125338, 9.372707845001774, 18.549469324778904, 11.33642339018396, -13.355126307646522, -10.77393613205643, -15.597773742332706, 5.32894677475965, -10.282360350598292, -26.97772181301142, -0.919837653929946, 11.133520746763438, -15.40339119419292, -13.589914185600154, 15.308846379188132, -14.747061518217002, 14.252602886910225, -11.99881307207255, -5.725666171452559, -10.974264402005883, -25.94612649089133, -12.026455822377311, -10.095011512862156, 11.70343700545433, 10.938331557253036, 8.87605373123711, -3.779315846762998, -10.248313214739465, 5.911441425609013, -8.71632938517439, 9.51504399231068, -31.13084130342689, -18.19658436788414, -29.332765040441764, -4.5887678639725, -27.60640870223302, -8.379541035986449, 3.8726331647027763, -18.27093839492583, -19.98111397036919, -9.014651898249241, -10.12630251895645, 3.547772245330293, 19.074276457498147, -28.26890420477436, -21.376129221872777, 0.9146108794164007, -19.74439554588529, 19.83375994367174, -3.416016425745017, -1.5541779915573812, 3.7834428049108766, 17.17278743387301, 16.997783815016113, 4.261884325179494, -7.2085769472253745, -1.1667403439522506, -19.293199089544103, 7.46960159624178, -20.184670822053185, -20.440549345467307, -8.34737622834685, -15.654307456112821, 7.887921675780486, -16.025730889600112, -19.28742610927542, -22.266829145063348, 7.310248094403242, 6.763268088120199, 8.336673073287479, 8.505266801521948, -26.54415454593917, 9.032898655373558, -28.841565738599222, -18.750133557094326, -6.666207391028404, -17.934613891333047, 4.345054279633846, -5.339749029510223, -2.220706603083933, 13.557255395292128, 5.92662472505566, -33.78431833720872, -16.74099032554358, -11.867924414575981, -30.958652906191453, 17.692361054305874, 24.028442529832642, -4.779994298153973, -2.663291223218387, -2.626892275650384, 0.0848623401289963, 1.4027527763133492, -15.95257280245512, -20.89875848521026, -20.0517250126751, -26.716341400664916, 25.12337885812161, 9.560955716813428, -5.844212897822949, 0.5369169401408982, -46.95672069478509, 9.424126070912838, 22.31211761538727, -31.499814591493454, -29.10542997625654, -15.757729054089914, 9.082160422555436, -26.411833522379755, -7.2164055703045396, -15.47156754205766, -40.94803609697801, -27.337912275503324, 12.888377473097016, -28.408557934520847, -30.912619556905728, -25.743945007726584, -36.491577851514315, -18.96959644625113, -29.908404218031624, -19.403346259735308, -35.28389945410916, -5.616056825360857, 5.9166574028256775, -0.9133604090261898, -17.818059301027308, 6.437111264502754, -16.198429915487, -26.258658666006735, -13.909573689108726, -13.02863677689386, 0.7919960532989094, -13.700522566437385, -26.019613812611702, -10.223631188735492, -24.533067984723818, -2.7572199428524087, -14.274034783607938, -20.486434656669168, 4.448023495658173, 3.2700293115961756, -18.96529285830798, -22.42064559335436, -6.34564624392533, -31.60187947863286, 6.947809978637316, -9.425590510059827, 0.7219060728579709, -25.851336005776307, -35.08953448108335, -4.00761287115472, -22.194173043393004, -14.330112134582997, 3.231537281818465, 5.622560036378189, 1.4698261995164188, -9.499288616153589, -22.74712649238423, -7.583238575715683, 10.293434242906763, 6.589898189542993, 14.88881490371135, -12.007955154320673, 1.9057874498559748, 11.592382509645004, -13.255417469510785, -34.30827389658435, -1.5616761668339478, -26.2967368509992, -7.7427946817639395, 9.517029951670985, -14.19259683911459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4538452559225186, "mean_inference_ms": 1.2221939314678123, "mean_action_processing_ms": 0.19634981079086639, "mean_env_wait_ms": 0.08152749950124956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004110217094421387, "StateBufferConnector_ms": 0.0029076337814331055, "ViewRequirementAgentConnector_ms": 0.08385074138641357}, "num_episodes": 9, "episode_return_max": 20.860401792069258, "episode_return_min": -31.117761429620444, "episode_return_mean": -8.040563888231157}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 463.8557174865576, "num_env_steps_trained_throughput_per_sec": 463.8557174865576, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 9046.454, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9046.403, "sample_time_ms": 1013.113, "learn_time_ms": 8018.527, "learn_throughput": 498.845, "synch_weights_time_ms": 14.285}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 62, "trial_id": "83a5c_00000", "date": "2024-08-10_12-23-01", "timestamp": 1723306981, "time_this_iter_s": 8.629614114761353, "time_total_s": 544.9490041732788, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f60eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 544.9490041732788, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 31.266666666666662, "ram_util_percent": 82.95833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3720321895584227, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0987704314882794, "policy_loss": -0.004591438832333085, "vf_loss": 3.102746814394754, "vf_explained_var": -0.026535358504643516, "kl": 0.008639485984922715, "entropy": 0.9413145347877785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2367380537713566, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.285750868792335, "policy_loss": -0.0012455459701110764, "vf_loss": 2.2868734881281854, "vf_explained_var": 0.45368670535584293, "kl": 0.0038848780060783366, "entropy": 0.6033358220631878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "env_runners": {"episode_reward_max": 21.829957019390253, "episode_reward_min": -38.67235250111292, "episode_reward_mean": -7.756434767635377, "episode_len_mean": 384.87, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38487, "policy_reward_min": {"agent_policy": -21.829957019390246, "adversary_policy": -46.95672069478509}, "policy_reward_max": {"agent_policy": 38.672352501112925, "adversary_policy": 38.6227644428638}, "policy_reward_mean": {"agent_policy": 7.756434767635378, "adversary_policy": -7.75643476763538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.17906840296909, -3.283107470149945, -19.928427442282388, 10.544249422555, -5.283773640038435, 2.8796156252946243, 14.942946357481434, -12.064531219851478, -5.134413483786528, -18.630041081804855, 5.106841546416746, -14.496652689896537, 0.2808924304855651, 1.126894907418837, -8.349965286729221, -18.98629115663432, 0.8042127462960864, 9.907192644245074, -7.013814530751231, -1.4024439797826886, -10.807898655558102, -23.764674704162942, -16.09758828310276, -2.2534539356418364, -19.12602618264751, -9.570477208602846, 11.31102435141422, -24.82251671332354, -9.414892333234445, 8.208871758963362, 1.1146324066767477, 17.085285624444538, -1.4733463110229401, -10.229969716748174, -6.357534612905703, -14.393962786907078, -3.8831928901661534, -17.656578499437764, -7.478290525330053, 7.549970580703839, -9.019443872208612, -9.904333541612832, -12.708170474061355, -6.794779805849602, -3.780227816297078, 9.741940060173894, -25.26265433137615, -21.413288660383717, 20.860401792069258, -3.72164276068618, -1.271014967760694, -7.27491001307088, -20.47524174894268, -0.7964812712716509, 1.8583714094952395, -23.209901877322096, 15.868121843150021, -30.30262228387499, -3.337784315767239, -16.81411954634214, -28.209801819517835, -7.224767401203158, -29.66058874571329, -31.117761429620444, -24.43900033214138, -27.34362285692223, 0.15030028873241008, -9.365709855026749, -4.880659325492124, -20.084116177557732, -6.118320361797475, -19.860068189524544, -17.378349586729644, -8.515627363230173, -8.019205580505494, -7.847631773355902, -14.383145918639848, -12.327034749997772, -4.351842218600928, -30.470435243429833, -13.100892957273864, -5.549287426382266, 3.546193117947304, -16.12320755426891, 1.35509783359554, 10.739356546627171, -5.05108385223235, -0.8315174799329066, -17.93497503170915, -17.019765766381568, -2.3377834437218015, -2.7068369877175513, -10.136385904518384, 21.829957019390253, 12.96427775339144, -5.910112359103975, -9.032088822299874, -17.250697412775416, -38.67235250111292, -10.354034177710728], "episode_lengths": [400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-6.17906840296909, 3.283107470149945, 19.928427442282377, -10.544249422554998, 5.28377364003844, -2.879615625294619, -14.942946357481434, 12.064531219851476, 5.134413483786528, 18.630041081804855, -5.106841546416746, 14.496652689896537, -0.2808924304855651, -1.126894907418837, 8.349965286729221, 18.98629115663432, -0.8042127462960864, -9.907192644245074, 7.013814530751231, 1.4024439797826886, 10.807898655558105, 23.764674704162946, 16.09758828310276, 2.2534539356418364, 19.12602618264751, 9.570477208602846, -11.311024351414222, 24.822516713323544, 9.414892333234445, -8.208871758963362, -1.1146324066767477, -17.08528562444454, 1.4733463110229401, 10.229969716748176, 6.3575346129057015, 14.393962786907078, 3.8831928901661623, 17.656578499437764, 7.478290525330053, -7.549970580703839, 9.01944387220861, 9.904333541612832, 12.70817047406136, 6.794779805849602, 3.780227816297078, -9.741940060173894, 25.262654331376154, 21.413288660383717, -20.86040179206927, 3.72164276068618, 1.271014967760694, 7.274910013070876, 20.47524174894268, 0.7964812712716509, -1.8583714094952395, 23.209901877322096, -15.868121843150012, 30.302622283874992, 3.337784315767239, 16.81411954634214, 28.209801819517832, 7.224767401203154, 29.660588745713284, 31.117761429620447, 24.439000332141383, 27.34362285692223, -0.15030028873241008, 9.365709855026749, 4.880659325492124, 20.084116177557732, 6.118320361797475, 19.860068189524544, 17.378349586729648, 8.515627363230173, 8.0192055805055, 7.847631773355902, 14.383145918639848, 12.327034749997773, 4.351842218600929, 30.47043524342983, 13.100892957273864, 5.549287426382266, -3.546193117947304, 16.1232075542689, -1.35509783359554, -10.739356546627171, 5.051083852232351, 0.8315174799328959, 17.934975031709154, 17.01976576638157, 2.3377834437218006, 2.7068369877175513, 10.136385904518384, -21.829957019390246, -12.964277753391446, 5.910112359103975, 9.032088822299874, 17.250697412775416, 38.672352501112925, 10.354034177710728], "policy_adversary_policy_reward": [0.4001907129652764, 11.957946092972904, -6.680493384015687, 0.1142784437157971, -12.256439792083068, -27.600415092481686, 13.941484290184299, 7.147014554925697, -5.451645312806278, -5.115901967270606, -3.6134765944125338, 9.372707845001774, 18.549469324778904, 11.33642339018396, -13.355126307646522, -10.77393613205643, -15.597773742332706, 5.32894677475965, -10.282360350598292, -26.97772181301142, -0.919837653929946, 11.133520746763438, -15.40339119419292, -13.589914185600154, 15.308846379188132, -14.747061518217002, 14.252602886910225, -11.99881307207255, -5.725666171452559, -10.974264402005883, -25.94612649089133, -12.026455822377311, -10.095011512862156, 11.70343700545433, 10.938331557253036, 8.87605373123711, -3.779315846762998, -10.248313214739465, 5.911441425609013, -8.71632938517439, 9.51504399231068, -31.13084130342689, -18.19658436788414, -29.332765040441764, -4.5887678639725, -27.60640870223302, -8.379541035986449, 3.8726331647027763, -18.27093839492583, -19.98111397036919, -9.014651898249241, -10.12630251895645, 3.547772245330293, 19.074276457498147, -28.26890420477436, -21.376129221872777, 0.9146108794164007, -19.74439554588529, 19.83375994367174, -3.416016425745017, -1.5541779915573812, 3.7834428049108766, 17.17278743387301, 16.997783815016113, 4.261884325179494, -7.2085769472253745, -1.1667403439522506, -19.293199089544103, 7.46960159624178, -20.184670822053185, -20.440549345467307, -8.34737622834685, -15.654307456112821, 7.887921675780486, -16.025730889600112, -19.28742610927542, -22.266829145063348, 7.310248094403242, 6.763268088120199, 8.336673073287479, 8.505266801521948, -26.54415454593917, 9.032898655373558, -28.841565738599222, -18.750133557094326, -6.666207391028404, -17.934613891333047, 4.345054279633846, -5.339749029510223, -2.220706603083933, 13.557255395292128, 5.92662472505566, -33.78431833720872, -16.74099032554358, -11.867924414575981, -30.958652906191453, 17.692361054305874, 24.028442529832642, -4.779994298153973, -2.663291223218387, -2.626892275650384, 0.0848623401289963, 1.4027527763133492, -15.95257280245512, -20.89875848521026, -20.0517250126751, -26.716341400664916, 25.12337885812161, 9.560955716813428, -5.844212897822949, 0.5369169401408982, -46.95672069478509, 9.424126070912838, 22.31211761538727, -31.499814591493454, -29.10542997625654, -15.757729054089914, 9.082160422555436, -26.411833522379755, -7.2164055703045396, -15.47156754205766, -40.94803609697801, -27.337912275503324, 12.888377473097016, -28.408557934520847, -30.912619556905728, -25.743945007726584, -36.491577851514315, -18.96959644625113, -29.908404218031624, -19.403346259735308, -35.28389945410916, -5.616056825360857, 5.9166574028256775, -0.9133604090261898, -17.818059301027308, 6.437111264502754, -16.198429915487, -26.258658666006735, -13.909573689108726, -13.02863677689386, 0.7919960532989094, -13.700522566437385, -26.019613812611702, -10.223631188735492, -24.533067984723818, -2.7572199428524087, -14.274034783607938, -20.486434656669168, 4.448023495658173, 3.2700293115961756, -18.96529285830798, -22.42064559335436, -6.34564624392533, -31.60187947863286, 6.947809978637316, -9.425590510059827, 0.7219060728579709, -25.851336005776307, -35.08953448108335, -4.00761287115472, -22.194173043393004, -14.330112134582997, 3.231537281818465, 5.622560036378189, 1.4698261995164188, -9.499288616153589, -22.74712649238423, -7.583238575715683, 10.293434242906763, 6.589898189542993, 14.88881490371135, -12.007955154320673, 1.9057874498559748, 11.592382509645004, -13.255417469510785, -34.30827389658435, -1.5616761668339478, -26.2967368509992, -7.7427946817639395, 9.517029951670985, -14.19259683911459, 4.018778381313517, -9.43245235674862, -16.359521835739148, -3.9132499732976243, 38.6227644428638, 5.037149595916723, 14.142652395808147, 11.785903110974736, -3.6645827832774174, -8.155641934930532, -13.152177635330759, -4.91200000926899, -9.06654997540295, -25.43484485014788, -43.14396469215309, -34.20074031007277, -11.329419484324113, -9.378648871097344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4541356683580097, "mean_inference_ms": 1.2232731347184662, "mean_action_processing_ms": 0.19639304843064742, "mean_env_wait_ms": 0.08161352406362521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004102349281311035, "StateBufferConnector_ms": 0.002863168716430664, "ViewRequirementAgentConnector_ms": 0.08406448364257812}, "num_episodes": 9, "episode_return_max": 21.829957019390253, "episode_return_min": -38.67235250111292, "episode_return_mean": -7.756434767635377}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 438.6863509324822, "num_env_steps_trained_throughput_per_sec": 438.6863509324822, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 756000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 9019.483, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9019.441, "sample_time_ms": 993.377, "learn_time_ms": 8011.652, "learn_throughput": 499.273, "synch_weights_time_ms": 13.909}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "training_iteration": 63, "trial_id": "83a5c_00000", "date": "2024-08-10_12-23-10", "timestamp": 1723306990, "time_this_iter_s": 9.12587594985962, "time_total_s": 554.0748801231384, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5c9ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 554.0748801231384, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 31.292307692307695, "ram_util_percent": 82.9076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.075733615765496, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.873692171472721, "policy_loss": -0.0036673226962900822, "vf_loss": 2.876877803903408, "vf_explained_var": 0.05496788028056029, "kl": 0.0067661368665821574, "entropy": 1.1328231414789875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7802338511683047, "cur_kl_coeff": 0.015820312499999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.527541720122099, "policy_loss": -0.0014252789980673697, "vf_loss": 3.528689182549715, "vf_explained_var": 0.07417157720774412, "kl": 0.017560571000110516, "entropy": 0.7039725911493103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 21.829957019390253, "episode_reward_min": -38.67235250111292, "episode_reward_mean": -7.910123455026156, "episode_len_mean": 385.08, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38508, "policy_reward_min": {"agent_policy": -21.829957019390246, "adversary_policy": -46.95672069478509}, "policy_reward_max": {"agent_policy": 38.672352501112925, "adversary_policy": 38.6227644428638}, "policy_reward_mean": {"agent_policy": 7.910123455026158, "adversary_policy": -7.910123455026156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.106841546416746, -14.496652689896537, 0.2808924304855651, 1.126894907418837, -8.349965286729221, -18.98629115663432, 0.8042127462960864, 9.907192644245074, -7.013814530751231, -1.4024439797826886, -10.807898655558102, -23.764674704162942, -16.09758828310276, -2.2534539356418364, -19.12602618264751, -9.570477208602846, 11.31102435141422, -24.82251671332354, -9.414892333234445, 8.208871758963362, 1.1146324066767477, 17.085285624444538, -1.4733463110229401, -10.229969716748174, -6.357534612905703, -14.393962786907078, -3.8831928901661534, -17.656578499437764, -7.478290525330053, 7.549970580703839, -9.019443872208612, -9.904333541612832, -12.708170474061355, -6.794779805849602, -3.780227816297078, 9.741940060173894, -25.26265433137615, -21.413288660383717, 20.860401792069258, -3.72164276068618, -1.271014967760694, -7.27491001307088, -20.47524174894268, -0.7964812712716509, 1.8583714094952395, -23.209901877322096, 15.868121843150021, -30.30262228387499, -3.337784315767239, -16.81411954634214, -28.209801819517835, -7.224767401203158, -29.66058874571329, -31.117761429620444, -24.43900033214138, -27.34362285692223, 0.15030028873241008, -9.365709855026749, -4.880659325492124, -20.084116177557732, -6.118320361797475, -19.860068189524544, -17.378349586729644, -8.515627363230173, -8.019205580505494, -7.847631773355902, -14.383145918639848, -12.327034749997772, -4.351842218600928, -30.470435243429833, -13.100892957273864, -5.549287426382266, 3.546193117947304, -16.12320755426891, 1.35509783359554, 10.739356546627171, -5.05108385223235, -0.8315174799329066, -17.93497503170915, -17.019765766381568, -2.3377834437218015, -2.7068369877175513, -10.136385904518384, 21.829957019390253, 12.96427775339144, -5.910112359103975, -9.032088822299874, -17.250697412775416, -38.67235250111292, -10.354034177710728, -3.3930537773321774, 7.886614292977754, -8.180804197391328, -21.333093553263197, -4.883604793333037, 18.513179573344246, -29.80457764758935, 4.950875258261925, 1.6127579493139867, -10.515576373680096], "episode_lengths": [400, 400, 400, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400], "policy_agent_policy_reward": [-5.106841546416746, 14.496652689896537, -0.2808924304855651, -1.126894907418837, 8.349965286729221, 18.98629115663432, -0.8042127462960864, -9.907192644245074, 7.013814530751231, 1.4024439797826886, 10.807898655558105, 23.764674704162946, 16.09758828310276, 2.2534539356418364, 19.12602618264751, 9.570477208602846, -11.311024351414222, 24.822516713323544, 9.414892333234445, -8.208871758963362, -1.1146324066767477, -17.08528562444454, 1.4733463110229401, 10.229969716748176, 6.3575346129057015, 14.393962786907078, 3.8831928901661623, 17.656578499437764, 7.478290525330053, -7.549970580703839, 9.01944387220861, 9.904333541612832, 12.70817047406136, 6.794779805849602, 3.780227816297078, -9.741940060173894, 25.262654331376154, 21.413288660383717, -20.86040179206927, 3.72164276068618, 1.271014967760694, 7.274910013070876, 20.47524174894268, 0.7964812712716509, -1.8583714094952395, 23.209901877322096, -15.868121843150012, 30.302622283874992, 3.337784315767239, 16.81411954634214, 28.209801819517832, 7.224767401203154, 29.660588745713284, 31.117761429620447, 24.439000332141383, 27.34362285692223, -0.15030028873241008, 9.365709855026749, 4.880659325492124, 20.084116177557732, 6.118320361797475, 19.860068189524544, 17.378349586729648, 8.515627363230173, 8.0192055805055, 7.847631773355902, 14.383145918639848, 12.327034749997773, 4.351842218600929, 30.47043524342983, 13.100892957273864, 5.549287426382266, -3.546193117947304, 16.1232075542689, -1.35509783359554, -10.739356546627171, 5.051083852232351, 0.8315174799328959, 17.934975031709154, 17.01976576638157, 2.3377834437218006, 2.7068369877175513, 10.136385904518384, -21.829957019390246, -12.964277753391446, 5.910112359103975, 9.032088822299874, 17.250697412775416, 38.672352501112925, 10.354034177710728, 3.3930537773321774, -7.886614292977754, 8.180804197391332, 21.3330935532632, 4.883604793333037, -18.51317957334425, 29.804577647589323, -4.9508752582619255, -1.612757949313985, 10.515576373680094], "policy_adversary_policy_reward": [-0.919837653929946, 11.133520746763438, -15.40339119419292, -13.589914185600154, 15.308846379188132, -14.747061518217002, 14.252602886910225, -11.99881307207255, -5.725666171452559, -10.974264402005883, -25.94612649089133, -12.026455822377311, -10.095011512862156, 11.70343700545433, 10.938331557253036, 8.87605373123711, -3.779315846762998, -10.248313214739465, 5.911441425609013, -8.71632938517439, 9.51504399231068, -31.13084130342689, -18.19658436788414, -29.332765040441764, -4.5887678639725, -27.60640870223302, -8.379541035986449, 3.8726331647027763, -18.27093839492583, -19.98111397036919, -9.014651898249241, -10.12630251895645, 3.547772245330293, 19.074276457498147, -28.26890420477436, -21.376129221872777, 0.9146108794164007, -19.74439554588529, 19.83375994367174, -3.416016425745017, -1.5541779915573812, 3.7834428049108766, 17.17278743387301, 16.997783815016113, 4.261884325179494, -7.2085769472253745, -1.1667403439522506, -19.293199089544103, 7.46960159624178, -20.184670822053185, -20.440549345467307, -8.34737622834685, -15.654307456112821, 7.887921675780486, -16.025730889600112, -19.28742610927542, -22.266829145063348, 7.310248094403242, 6.763268088120199, 8.336673073287479, 8.505266801521948, -26.54415454593917, 9.032898655373558, -28.841565738599222, -18.750133557094326, -6.666207391028404, -17.934613891333047, 4.345054279633846, -5.339749029510223, -2.220706603083933, 13.557255395292128, 5.92662472505566, -33.78431833720872, -16.74099032554358, -11.867924414575981, -30.958652906191453, 17.692361054305874, 24.028442529832642, -4.779994298153973, -2.663291223218387, -2.626892275650384, 0.0848623401289963, 1.4027527763133492, -15.95257280245512, -20.89875848521026, -20.0517250126751, -26.716341400664916, 25.12337885812161, 9.560955716813428, -5.844212897822949, 0.5369169401408982, -46.95672069478509, 9.424126070912838, 22.31211761538727, -31.499814591493454, -29.10542997625654, -15.757729054089914, 9.082160422555436, -26.411833522379755, -7.2164055703045396, -15.47156754205766, -40.94803609697801, -27.337912275503324, 12.888377473097016, -28.408557934520847, -30.912619556905728, -25.743945007726584, -36.491577851514315, -18.96959644625113, -29.908404218031624, -19.403346259735308, -35.28389945410916, -5.616056825360857, 5.9166574028256775, -0.9133604090261898, -17.818059301027308, 6.437111264502754, -16.198429915487, -26.258658666006735, -13.909573689108726, -13.02863677689386, 0.7919960532989094, -13.700522566437385, -26.019613812611702, -10.223631188735492, -24.533067984723818, -2.7572199428524087, -14.274034783607938, -20.486434656669168, 4.448023495658173, 3.2700293115961756, -18.96529285830798, -22.42064559335436, -6.34564624392533, -31.60187947863286, 6.947809978637316, -9.425590510059827, 0.7219060728579709, -25.851336005776307, -35.08953448108335, -4.00761287115472, -22.194173043393004, -14.330112134582997, 3.231537281818465, 5.622560036378189, 1.4698261995164188, -9.499288616153589, -22.74712649238423, -7.583238575715683, 10.293434242906763, 6.589898189542993, 14.88881490371135, -12.007955154320673, 1.9057874498559748, 11.592382509645004, -13.255417469510785, -34.30827389658435, -1.5616761668339478, -26.2967368509992, -7.7427946817639395, 9.517029951670985, -14.19259683911459, 4.018778381313517, -9.43245235674862, -16.359521835739148, -3.9132499732976243, 38.6227644428638, 5.037149595916723, 14.142652395808147, 11.785903110974736, -3.6645827832774174, -8.155641934930532, -13.152177635330759, -4.91200000926899, -9.06654997540295, -25.43484485014788, -43.14396469215309, -34.20074031007277, -11.329419484324113, -9.378648871097344, -1.3017309328966604, -5.484376621767694, 13.968858464303734, 1.8043701216517718, 1.1382909255548341, -17.49989932033749, -18.85119869638043, -23.814988410145965, 7.722374904613687, -17.48958449127976, 14.283765330036939, 22.74259381665156, -31.92822362798428, -27.680931667194407, -12.10078488082906, 22.00253539735291, 2.0454534038972767, 1.180062494730695, 6.655837903199346, -27.68699065055955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4542730920363109, "mean_inference_ms": 1.2236656312761212, "mean_action_processing_ms": 0.19645624582482563, "mean_env_wait_ms": 0.08169830613193013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004048347473144531, "StateBufferConnector_ms": 0.002776503562927246, "ViewRequirementAgentConnector_ms": 0.0820237398147583}, "num_episodes": 10, "episode_return_max": 21.829957019390253, "episode_return_min": -38.67235250111292, "episode_return_mean": -7.910123455026156}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 453.1642651097558, "num_env_steps_trained_throughput_per_sec": 453.1642651097558, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 8978.483, "restore_workers_time_ms": 0.016, "training_step_time_ms": 8978.441, "sample_time_ms": 956.466, "learn_time_ms": 8006.973, "learn_throughput": 499.565, "synch_weights_time_ms": 14.51}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 64, "trial_id": "83a5c_00000", "date": "2024-08-10_12-23-19", "timestamp": 1723306999, "time_this_iter_s": 8.83456301689148, "time_total_s": 562.9094431400299, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb63f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 562.9094431400299, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 31.10769230769231, "ram_util_percent": 83.0769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0358371638116384, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9048004031812074, "policy_loss": -0.002480467210435087, "vf_loss": 3.9068874437342247, "vf_explained_var": -0.21480152061376623, "kl": 0.0055261966888730165, "entropy": 1.0469163360419096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2081543295023343, "cur_kl_coeff": 0.015820312499999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.192403333385785, "policy_loss": -0.003136880310194101, "vf_loss": 4.195198504130046, "vf_explained_var": 0.2661863596489032, "kl": 0.02160006715407983, "entropy": 0.5734679534410437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "env_runners": {"episode_reward_max": 21.829957019390253, "episode_reward_min": -51.10532921270376, "episode_reward_mean": -7.677200261465084, "episode_len_mean": 377.49, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 37749, "policy_reward_min": {"agent_policy": -21.829957019390246, "adversary_policy": -51.163421373343766}, "policy_reward_max": {"agent_policy": 51.105329212703765, "adversary_policy": 44.30412310813609}, "policy_reward_mean": {"agent_policy": 7.677200261465084, "adversary_policy": -7.677200261465084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.12602618264751, -9.570477208602846, 11.31102435141422, -24.82251671332354, -9.414892333234445, 8.208871758963362, 1.1146324066767477, 17.085285624444538, -1.4733463110229401, -10.229969716748174, -6.357534612905703, -14.393962786907078, -3.8831928901661534, -17.656578499437764, -7.478290525330053, 7.549970580703839, -9.019443872208612, -9.904333541612832, -12.708170474061355, -6.794779805849602, -3.780227816297078, 9.741940060173894, -25.26265433137615, -21.413288660383717, 20.860401792069258, -3.72164276068618, -1.271014967760694, -7.27491001307088, -20.47524174894268, -0.7964812712716509, 1.8583714094952395, -23.209901877322096, 15.868121843150021, -30.30262228387499, -3.337784315767239, -16.81411954634214, -28.209801819517835, -7.224767401203158, -29.66058874571329, -31.117761429620444, -24.43900033214138, -27.34362285692223, 0.15030028873241008, -9.365709855026749, -4.880659325492124, -20.084116177557732, -6.118320361797475, -19.860068189524544, -17.378349586729644, -8.515627363230173, -8.019205580505494, -7.847631773355902, -14.383145918639848, -12.327034749997772, -4.351842218600928, -30.470435243429833, -13.100892957273864, -5.549287426382266, 3.546193117947304, -16.12320755426891, 1.35509783359554, 10.739356546627171, -5.05108385223235, -0.8315174799329066, -17.93497503170915, -17.019765766381568, -2.3377834437218015, -2.7068369877175513, -10.136385904518384, 21.829957019390253, 12.96427775339144, -5.910112359103975, -9.032088822299874, -17.250697412775416, -38.67235250111292, -10.354034177710728, -3.3930537773321774, 7.886614292977754, -8.180804197391328, -21.333093553263197, -4.883604793333037, 18.513179573344246, -29.80457764758935, 4.950875258261925, 1.6127579493139867, -10.515576373680096, 2.7014990767998865, -12.495249277042344, 2.957687787173896, -15.856986388148496, -25.219146545393855, 1.840451590441197, -7.592693293568308, 14.825412157686396, 12.473591803131333, 15.6330428009879, -9.331770269766416, 2.557157515684869, 5.957902663427561, -51.10532921270376], "episode_lengths": [400, 400, 18, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 13, 400, 400, 2, 400, 400, 400, 400, 400, 39, 400, 400], "policy_agent_policy_reward": [19.12602618264751, 9.570477208602846, -11.311024351414222, 24.822516713323544, 9.414892333234445, -8.208871758963362, -1.1146324066767477, -17.08528562444454, 1.4733463110229401, 10.229969716748176, 6.3575346129057015, 14.393962786907078, 3.8831928901661623, 17.656578499437764, 7.478290525330053, -7.549970580703839, 9.01944387220861, 9.904333541612832, 12.70817047406136, 6.794779805849602, 3.780227816297078, -9.741940060173894, 25.262654331376154, 21.413288660383717, -20.86040179206927, 3.72164276068618, 1.271014967760694, 7.274910013070876, 20.47524174894268, 0.7964812712716509, -1.8583714094952395, 23.209901877322096, -15.868121843150012, 30.302622283874992, 3.337784315767239, 16.81411954634214, 28.209801819517832, 7.224767401203154, 29.660588745713284, 31.117761429620447, 24.439000332141383, 27.34362285692223, -0.15030028873241008, 9.365709855026749, 4.880659325492124, 20.084116177557732, 6.118320361797475, 19.860068189524544, 17.378349586729648, 8.515627363230173, 8.0192055805055, 7.847631773355902, 14.383145918639848, 12.327034749997773, 4.351842218600929, 30.47043524342983, 13.100892957273864, 5.549287426382266, -3.546193117947304, 16.1232075542689, -1.35509783359554, -10.739356546627171, 5.051083852232351, 0.8315174799328959, 17.934975031709154, 17.01976576638157, 2.3377834437218006, 2.7068369877175513, 10.136385904518384, -21.829957019390246, -12.964277753391446, 5.910112359103975, 9.032088822299874, 17.250697412775416, 38.672352501112925, 10.354034177710728, 3.3930537773321774, -7.886614292977754, 8.180804197391332, 21.3330935532632, 4.883604793333037, -18.51317957334425, 29.804577647589323, -4.9508752582619255, -1.612757949313985, 10.515576373680094, -2.7014990767998874, 12.495249277042348, -2.9576877871738962, 15.856986388148492, 25.21914654539385, -1.840451590441197, 7.592693293568308, -14.825412157686394, -12.473591803131317, -15.6330428009879, 9.331770269766416, -2.557157515684869, -5.957902663427561, 51.105329212703765], "policy_adversary_policy_reward": [-18.27093839492583, -19.98111397036919, -9.014651898249241, -10.12630251895645, 3.547772245330293, 19.074276457498147, -28.26890420477436, -21.376129221872777, 0.9146108794164007, -19.74439554588529, 19.83375994367174, -3.416016425745017, -1.5541779915573812, 3.7834428049108766, 17.17278743387301, 16.997783815016113, 4.261884325179494, -7.2085769472253745, -1.1667403439522506, -19.293199089544103, 7.46960159624178, -20.184670822053185, -20.440549345467307, -8.34737622834685, -15.654307456112821, 7.887921675780486, -16.025730889600112, -19.28742610927542, -22.266829145063348, 7.310248094403242, 6.763268088120199, 8.336673073287479, 8.505266801521948, -26.54415454593917, 9.032898655373558, -28.841565738599222, -18.750133557094326, -6.666207391028404, -17.934613891333047, 4.345054279633846, -5.339749029510223, -2.220706603083933, 13.557255395292128, 5.92662472505566, -33.78431833720872, -16.74099032554358, -11.867924414575981, -30.958652906191453, 17.692361054305874, 24.028442529832642, -4.779994298153973, -2.663291223218387, -2.626892275650384, 0.0848623401289963, 1.4027527763133492, -15.95257280245512, -20.89875848521026, -20.0517250126751, -26.716341400664916, 25.12337885812161, 9.560955716813428, -5.844212897822949, 0.5369169401408982, -46.95672069478509, 9.424126070912838, 22.31211761538727, -31.499814591493454, -29.10542997625654, -15.757729054089914, 9.082160422555436, -26.411833522379755, -7.2164055703045396, -15.47156754205766, -40.94803609697801, -27.337912275503324, 12.888377473097016, -28.408557934520847, -30.912619556905728, -25.743945007726584, -36.491577851514315, -18.96959644625113, -29.908404218031624, -19.403346259735308, -35.28389945410916, -5.616056825360857, 5.9166574028256775, -0.9133604090261898, -17.818059301027308, 6.437111264502754, -16.198429915487, -26.258658666006735, -13.909573689108726, -13.02863677689386, 0.7919960532989094, -13.700522566437385, -26.019613812611702, -10.223631188735492, -24.533067984723818, -2.7572199428524087, -14.274034783607938, -20.486434656669168, 4.448023495658173, 3.2700293115961756, -18.96529285830798, -22.42064559335436, -6.34564624392533, -31.60187947863286, 6.947809978637316, -9.425590510059827, 0.7219060728579709, -25.851336005776307, -35.08953448108335, -4.00761287115472, -22.194173043393004, -14.330112134582997, 3.231537281818465, 5.622560036378189, 1.4698261995164188, -9.499288616153589, -22.74712649238423, -7.583238575715683, 10.293434242906763, 6.589898189542993, 14.88881490371135, -12.007955154320673, 1.9057874498559748, 11.592382509645004, -13.255417469510785, -34.30827389658435, -1.5616761668339478, -26.2967368509992, -7.7427946817639395, 9.517029951670985, -14.19259683911459, 4.018778381313517, -9.43245235674862, -16.359521835739148, -3.9132499732976243, 38.6227644428638, 5.037149595916723, 14.142652395808147, 11.785903110974736, -3.6645827832774174, -8.155641934930532, -13.152177635330759, -4.91200000926899, -9.06654997540295, -25.43484485014788, -43.14396469215309, -34.20074031007277, -11.329419484324113, -9.378648871097344, -1.3017309328966604, -5.484376621767694, 13.968858464303734, 1.8043701216517718, 1.1382909255548341, -17.49989932033749, -18.85119869638043, -23.814988410145965, 7.722374904613687, -17.48958449127976, 14.283765330036939, 22.74259381665156, -31.92822362798428, -27.680931667194407, -12.10078488082906, 22.00253539735291, 2.0454534038972767, 1.180062494730695, 6.655837903199346, -27.68699065055955, 7.785301808949621, -2.382303655349851, -2.2938510762388837, -22.6966474778458, -8.235804249017697, 14.151179823365489, -18.834043550298162, -12.87992922599885, -36.09309300430303, -14.345200086484688, 2.8232594409325795, 0.8576437399498147, -5.6749858957382635, -9.510400691398349, 8.739780810541138, 20.911043504831653, -19.356939501873438, 44.30412310813609, 16.33319815946836, 14.93288744250744, -21.35183909094234, 2.6882985514095097, 25.774193881783056, -20.65987885041332, 10.05670447127175, 1.859100855583371, -51.04723705206369, -51.163421373343766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4546300802322866, "mean_inference_ms": 1.2236651775956278, "mean_action_processing_ms": 0.1965490921376252, "mean_env_wait_ms": 0.08179694064939154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003875732421875, "StateBufferConnector_ms": 0.002909421920776367, "ViewRequirementAgentConnector_ms": 0.08385825157165527}, "num_episodes": 14, "episode_return_max": 21.829957019390253, "episode_return_min": -51.10532921270376, "episode_return_mean": -7.677200261465084}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.2120113492461, "num_env_steps_trained_throughput_per_sec": 428.2120113492461, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 780000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 9011.771, "restore_workers_time_ms": 0.016, "training_step_time_ms": 9011.73, "sample_time_ms": 940.925, "learn_time_ms": 8055.35, "learn_throughput": 496.564, "synch_weights_time_ms": 14.93}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "training_iteration": 65, "trial_id": "83a5c_00000", "date": "2024-08-10_12-23-29", "timestamp": 1723307009, "time_this_iter_s": 9.389854907989502, "time_total_s": 572.2992980480194, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faca1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 572.2992980480194, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 34.56153846153847, "ram_util_percent": 82.78461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9249129159109932, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6395323038731933, "policy_loss": -0.007791748361676813, "vf_loss": 3.6464456999743424, "vf_explained_var": -0.0002353784583863758, "kl": 0.01233797085582386, "entropy": 0.8934487228986447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.678802412344764, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3134592272341252, "policy_loss": -0.005703694716794416, "vf_loss": 3.319012318799893, "vf_explained_var": 0.5050269771367312, "kl": 0.006346736844852785, "entropy": 0.509193010845532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 21.829957019390253, "episode_reward_min": -51.10532921270376, "episode_reward_mean": -8.760303589567064, "episode_len_mean": 381.31, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38131, "policy_reward_min": {"agent_policy": -21.829957019390246, "adversary_policy": -51.163421373343766}, "policy_reward_max": {"agent_policy": 51.105329212703765, "adversary_policy": 44.30412310813609}, "policy_reward_mean": {"agent_policy": 8.760303589567066, "adversary_policy": -8.760303589567064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.357534612905703, -14.393962786907078, -3.8831928901661534, -17.656578499437764, -7.478290525330053, 7.549970580703839, -9.019443872208612, -9.904333541612832, -12.708170474061355, -6.794779805849602, -3.780227816297078, 9.741940060173894, -25.26265433137615, -21.413288660383717, 20.860401792069258, -3.72164276068618, -1.271014967760694, -7.27491001307088, -20.47524174894268, -0.7964812712716509, 1.8583714094952395, -23.209901877322096, 15.868121843150021, -30.30262228387499, -3.337784315767239, -16.81411954634214, -28.209801819517835, -7.224767401203158, -29.66058874571329, -31.117761429620444, -24.43900033214138, -27.34362285692223, 0.15030028873241008, -9.365709855026749, -4.880659325492124, -20.084116177557732, -6.118320361797475, -19.860068189524544, -17.378349586729644, -8.515627363230173, -8.019205580505494, -7.847631773355902, -14.383145918639848, -12.327034749997772, -4.351842218600928, -30.470435243429833, -13.100892957273864, -5.549287426382266, 3.546193117947304, -16.12320755426891, 1.35509783359554, 10.739356546627171, -5.05108385223235, -0.8315174799329066, -17.93497503170915, -17.019765766381568, -2.3377834437218015, -2.7068369877175513, -10.136385904518384, 21.829957019390253, 12.96427775339144, -5.910112359103975, -9.032088822299874, -17.250697412775416, -38.67235250111292, -10.354034177710728, -3.3930537773321774, 7.886614292977754, -8.180804197391328, -21.333093553263197, -4.883604793333037, 18.513179573344246, -29.80457764758935, 4.950875258261925, 1.6127579493139867, -10.515576373680096, 2.7014990767998865, -12.495249277042344, 2.957687787173896, -15.856986388148496, -25.219146545393855, 1.840451590441197, -7.592693293568308, 14.825412157686396, 12.473591803131333, 15.6330428009879, -9.331770269766416, 2.557157515684869, 5.957902663427561, -51.10532921270376, -2.94800759260265, 18.218082772339045, -30.738576679034146, -10.307177723112467, -2.24247637095767, -37.26039927667191, -42.18602470349446, -2.2106592146061885, 8.187080740261422, -43.73958908639944], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 13, 400, 400, 2, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [6.3575346129057015, 14.393962786907078, 3.8831928901661623, 17.656578499437764, 7.478290525330053, -7.549970580703839, 9.01944387220861, 9.904333541612832, 12.70817047406136, 6.794779805849602, 3.780227816297078, -9.741940060173894, 25.262654331376154, 21.413288660383717, -20.86040179206927, 3.72164276068618, 1.271014967760694, 7.274910013070876, 20.47524174894268, 0.7964812712716509, -1.8583714094952395, 23.209901877322096, -15.868121843150012, 30.302622283874992, 3.337784315767239, 16.81411954634214, 28.209801819517832, 7.224767401203154, 29.660588745713284, 31.117761429620447, 24.439000332141383, 27.34362285692223, -0.15030028873241008, 9.365709855026749, 4.880659325492124, 20.084116177557732, 6.118320361797475, 19.860068189524544, 17.378349586729648, 8.515627363230173, 8.0192055805055, 7.847631773355902, 14.383145918639848, 12.327034749997773, 4.351842218600929, 30.47043524342983, 13.100892957273864, 5.549287426382266, -3.546193117947304, 16.1232075542689, -1.35509783359554, -10.739356546627171, 5.051083852232351, 0.8315174799328959, 17.934975031709154, 17.01976576638157, 2.3377834437218006, 2.7068369877175513, 10.136385904518384, -21.829957019390246, -12.964277753391446, 5.910112359103975, 9.032088822299874, 17.250697412775416, 38.672352501112925, 10.354034177710728, 3.3930537773321774, -7.886614292977754, 8.180804197391332, 21.3330935532632, 4.883604793333037, -18.51317957334425, 29.804577647589323, -4.9508752582619255, -1.612757949313985, 10.515576373680094, -2.7014990767998874, 12.495249277042348, -2.9576877871738962, 15.856986388148492, 25.21914654539385, -1.840451590441197, 7.592693293568308, -14.825412157686394, -12.473591803131317, -15.6330428009879, 9.331770269766416, -2.557157515684869, -5.957902663427561, 51.105329212703765, 2.948007592602652, -18.218082772339034, 30.738576679034097, 10.307177723112467, 2.24247637095767, 37.26039927667193, 42.18602470349448, 2.2106592146061885, -8.187080740261429, 43.73958908639948], "policy_adversary_policy_reward": [7.46960159624178, -20.184670822053185, -20.440549345467307, -8.34737622834685, -15.654307456112821, 7.887921675780486, -16.025730889600112, -19.28742610927542, -22.266829145063348, 7.310248094403242, 6.763268088120199, 8.336673073287479, 8.505266801521948, -26.54415454593917, 9.032898655373558, -28.841565738599222, -18.750133557094326, -6.666207391028404, -17.934613891333047, 4.345054279633846, -5.339749029510223, -2.220706603083933, 13.557255395292128, 5.92662472505566, -33.78431833720872, -16.74099032554358, -11.867924414575981, -30.958652906191453, 17.692361054305874, 24.028442529832642, -4.779994298153973, -2.663291223218387, -2.626892275650384, 0.0848623401289963, 1.4027527763133492, -15.95257280245512, -20.89875848521026, -20.0517250126751, -26.716341400664916, 25.12337885812161, 9.560955716813428, -5.844212897822949, 0.5369169401408982, -46.95672069478509, 9.424126070912838, 22.31211761538727, -31.499814591493454, -29.10542997625654, -15.757729054089914, 9.082160422555436, -26.411833522379755, -7.2164055703045396, -15.47156754205766, -40.94803609697801, -27.337912275503324, 12.888377473097016, -28.408557934520847, -30.912619556905728, -25.743945007726584, -36.491577851514315, -18.96959644625113, -29.908404218031624, -19.403346259735308, -35.28389945410916, -5.616056825360857, 5.9166574028256775, -0.9133604090261898, -17.818059301027308, 6.437111264502754, -16.198429915487, -26.258658666006735, -13.909573689108726, -13.02863677689386, 0.7919960532989094, -13.700522566437385, -26.019613812611702, -10.223631188735492, -24.533067984723818, -2.7572199428524087, -14.274034783607938, -20.486434656669168, 4.448023495658173, 3.2700293115961756, -18.96529285830798, -22.42064559335436, -6.34564624392533, -31.60187947863286, 6.947809978637316, -9.425590510059827, 0.7219060728579709, -25.851336005776307, -35.08953448108335, -4.00761287115472, -22.194173043393004, -14.330112134582997, 3.231537281818465, 5.622560036378189, 1.4698261995164188, -9.499288616153589, -22.74712649238423, -7.583238575715683, 10.293434242906763, 6.589898189542993, 14.88881490371135, -12.007955154320673, 1.9057874498559748, 11.592382509645004, -13.255417469510785, -34.30827389658435, -1.5616761668339478, -26.2967368509992, -7.7427946817639395, 9.517029951670985, -14.19259683911459, 4.018778381313517, -9.43245235674862, -16.359521835739148, -3.9132499732976243, 38.6227644428638, 5.037149595916723, 14.142652395808147, 11.785903110974736, -3.6645827832774174, -8.155641934930532, -13.152177635330759, -4.91200000926899, -9.06654997540295, -25.43484485014788, -43.14396469215309, -34.20074031007277, -11.329419484324113, -9.378648871097344, -1.3017309328966604, -5.484376621767694, 13.968858464303734, 1.8043701216517718, 1.1382909255548341, -17.49989932033749, -18.85119869638043, -23.814988410145965, 7.722374904613687, -17.48958449127976, 14.283765330036939, 22.74259381665156, -31.92822362798428, -27.680931667194407, -12.10078488082906, 22.00253539735291, 2.0454534038972767, 1.180062494730695, 6.655837903199346, -27.68699065055955, 7.785301808949621, -2.382303655349851, -2.2938510762388837, -22.6966474778458, -8.235804249017697, 14.151179823365489, -18.834043550298162, -12.87992922599885, -36.09309300430303, -14.345200086484688, 2.8232594409325795, 0.8576437399498147, -5.6749858957382635, -9.510400691398349, 8.739780810541138, 20.911043504831653, -19.356939501873438, 44.30412310813609, 16.33319815946836, 14.93288744250744, -21.35183909094234, 2.6882985514095097, 25.774193881783056, -20.65987885041332, 10.05670447127175, 1.859100855583371, -51.04723705206369, -51.163421373343766, -1.9084649205492443, -3.9875502646560754, 32.861106606077826, 3.5750589386002503, -30.411669743300962, -31.065483614767217, -4.771673564238881, -15.842681881986053, 4.819004935933705, -9.303957677849045, -37.19199401225579, -37.328804541088076, -39.40142816397294, -44.97062124301602, -5.875724991358641, 1.4544065621462643, 6.661574675524836, 9.712586804998011, -45.299397931859744, -42.17978024093903]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4547761287602312, "mean_inference_ms": 1.2241838117588708, "mean_action_processing_ms": 0.19658371730432506, "mean_env_wait_ms": 0.08188750624541631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003970146179199219, "StateBufferConnector_ms": 0.002953052520751953, "ViewRequirementAgentConnector_ms": 0.08448565006256104}, "num_episodes": 10, "episode_return_max": 21.829957019390253, "episode_return_min": -51.10532921270376, "episode_return_mean": -8.760303589567064}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.1117507871655, "num_env_steps_trained_throughput_per_sec": 436.1117507871655, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 9061.05, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9061.009, "sample_time_ms": 943.063, "learn_time_ms": 8102.683, "learn_throughput": 493.664, "synch_weights_time_ms": 14.739}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 66, "trial_id": "83a5c_00000", "date": "2024-08-10_12-23-38", "timestamp": 1723307018, "time_this_iter_s": 9.178966999053955, "time_total_s": 581.4782650470734, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31facae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 581.4782650470734, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 32.26153846153847, "ram_util_percent": 82.5769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0035236279169717, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5698724306449687, "policy_loss": -0.007554282233483656, "vf_loss": 3.5766734063940704, "vf_explained_var": -0.06294023372508861, "kl": 0.010581504527778616, "entropy": 1.114543481762447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.276293220153699, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1388947336624065, "policy_loss": -0.007402506935371396, "vf_loss": 3.1460720052321753, "vf_explained_var": -0.29637932653228444, "kl": 0.009491120701434616, "entropy": 0.634055045619607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "env_runners": {"episode_reward_max": 22.97369962848529, "episode_reward_min": -51.10532921270376, "episode_reward_mean": -9.34967798415947, "episode_len_mean": 381.31, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38131, "policy_reward_min": {"agent_policy": -22.9736996284853, "adversary_policy": -52.72021644974067}, "policy_reward_max": {"agent_policy": 51.105329212703765, "adversary_policy": 44.30412310813609}, "policy_reward_mean": {"agent_policy": 9.349677984159472, "adversary_policy": -9.349677984159472}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.794779805849602, -3.780227816297078, 9.741940060173894, -25.26265433137615, -21.413288660383717, 20.860401792069258, -3.72164276068618, -1.271014967760694, -7.27491001307088, -20.47524174894268, -0.7964812712716509, 1.8583714094952395, -23.209901877322096, 15.868121843150021, -30.30262228387499, -3.337784315767239, -16.81411954634214, -28.209801819517835, -7.224767401203158, -29.66058874571329, -31.117761429620444, -24.43900033214138, -27.34362285692223, 0.15030028873241008, -9.365709855026749, -4.880659325492124, -20.084116177557732, -6.118320361797475, -19.860068189524544, -17.378349586729644, -8.515627363230173, -8.019205580505494, -7.847631773355902, -14.383145918639848, -12.327034749997772, -4.351842218600928, -30.470435243429833, -13.100892957273864, -5.549287426382266, 3.546193117947304, -16.12320755426891, 1.35509783359554, 10.739356546627171, -5.05108385223235, -0.8315174799329066, -17.93497503170915, -17.019765766381568, -2.3377834437218015, -2.7068369877175513, -10.136385904518384, 21.829957019390253, 12.96427775339144, -5.910112359103975, -9.032088822299874, -17.250697412775416, -38.67235250111292, -10.354034177710728, -3.3930537773321774, 7.886614292977754, -8.180804197391328, -21.333093553263197, -4.883604793333037, 18.513179573344246, -29.80457764758935, 4.950875258261925, 1.6127579493139867, -10.515576373680096, 2.7014990767998865, -12.495249277042344, 2.957687787173896, -15.856986388148496, -25.219146545393855, 1.840451590441197, -7.592693293568308, 14.825412157686396, 12.473591803131333, 15.6330428009879, -9.331770269766416, 2.557157515684869, 5.957902663427561, -51.10532921270376, -2.94800759260265, 18.218082772339045, -30.738576679034146, -10.307177723112467, -2.24247637095767, -37.26039927667191, -42.18602470349446, -2.2106592146061885, 8.187080740261422, -43.73958908639944, -31.58995514829347, 22.97369962848529, -35.542713530626074, 2.2274022988121565, -32.40959444661043, -8.371746780510094, -23.60370881669998, -33.462311542859474, 6.989952257135515], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 38, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 13, 400, 400, 2, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [6.794779805849602, 3.780227816297078, -9.741940060173894, 25.262654331376154, 21.413288660383717, -20.86040179206927, 3.72164276068618, 1.271014967760694, 7.274910013070876, 20.47524174894268, 0.7964812712716509, -1.8583714094952395, 23.209901877322096, -15.868121843150012, 30.302622283874992, 3.337784315767239, 16.81411954634214, 28.209801819517832, 7.224767401203154, 29.660588745713284, 31.117761429620447, 24.439000332141383, 27.34362285692223, -0.15030028873241008, 9.365709855026749, 4.880659325492124, 20.084116177557732, 6.118320361797475, 19.860068189524544, 17.378349586729648, 8.515627363230173, 8.0192055805055, 7.847631773355902, 14.383145918639848, 12.327034749997773, 4.351842218600929, 30.47043524342983, 13.100892957273864, 5.549287426382266, -3.546193117947304, 16.1232075542689, -1.35509783359554, -10.739356546627171, 5.051083852232351, 0.8315174799328959, 17.934975031709154, 17.01976576638157, 2.3377834437218006, 2.7068369877175513, 10.136385904518384, -21.829957019390246, -12.964277753391446, 5.910112359103975, 9.032088822299874, 17.250697412775416, 38.672352501112925, 10.354034177710728, 3.3930537773321774, -7.886614292977754, 8.180804197391332, 21.3330935532632, 4.883604793333037, -18.51317957334425, 29.804577647589323, -4.9508752582619255, -1.612757949313985, 10.515576373680094, -2.7014990767998874, 12.495249277042348, -2.9576877871738962, 15.856986388148492, 25.21914654539385, -1.840451590441197, 7.592693293568308, -14.825412157686394, -12.473591803131317, -15.6330428009879, 9.331770269766416, -2.557157515684869, -5.957902663427561, 51.105329212703765, 2.948007592602652, -18.218082772339034, 30.738576679034097, 10.307177723112467, 2.24247637095767, 37.26039927667193, 42.18602470349448, 2.2106592146061885, -8.187080740261429, 43.73958908639948, 31.58995514829348, -22.9736996284853, 35.54271353062605, -2.2274022988121565, 32.40959444661046, 8.371746780510094, 23.603708816699985, 33.462311542859496, -6.989952257135516], "policy_adversary_policy_reward": [-17.934613891333047, 4.345054279633846, -5.339749029510223, -2.220706603083933, 13.557255395292128, 5.92662472505566, -33.78431833720872, -16.74099032554358, -11.867924414575981, -30.958652906191453, 17.692361054305874, 24.028442529832642, -4.779994298153973, -2.663291223218387, -2.626892275650384, 0.0848623401289963, 1.4027527763133492, -15.95257280245512, -20.89875848521026, -20.0517250126751, -26.716341400664916, 25.12337885812161, 9.560955716813428, -5.844212897822949, 0.5369169401408982, -46.95672069478509, 9.424126070912838, 22.31211761538727, -31.499814591493454, -29.10542997625654, -15.757729054089914, 9.082160422555436, -26.411833522379755, -7.2164055703045396, -15.47156754205766, -40.94803609697801, -27.337912275503324, 12.888377473097016, -28.408557934520847, -30.912619556905728, -25.743945007726584, -36.491577851514315, -18.96959644625113, -29.908404218031624, -19.403346259735308, -35.28389945410916, -5.616056825360857, 5.9166574028256775, -0.9133604090261898, -17.818059301027308, 6.437111264502754, -16.198429915487, -26.258658666006735, -13.909573689108726, -13.02863677689386, 0.7919960532989094, -13.700522566437385, -26.019613812611702, -10.223631188735492, -24.533067984723818, -2.7572199428524087, -14.274034783607938, -20.486434656669168, 4.448023495658173, 3.2700293115961756, -18.96529285830798, -22.42064559335436, -6.34564624392533, -31.60187947863286, 6.947809978637316, -9.425590510059827, 0.7219060728579709, -25.851336005776307, -35.08953448108335, -4.00761287115472, -22.194173043393004, -14.330112134582997, 3.231537281818465, 5.622560036378189, 1.4698261995164188, -9.499288616153589, -22.74712649238423, -7.583238575715683, 10.293434242906763, 6.589898189542993, 14.88881490371135, -12.007955154320673, 1.9057874498559748, 11.592382509645004, -13.255417469510785, -34.30827389658435, -1.5616761668339478, -26.2967368509992, -7.7427946817639395, 9.517029951670985, -14.19259683911459, 4.018778381313517, -9.43245235674862, -16.359521835739148, -3.9132499732976243, 38.6227644428638, 5.037149595916723, 14.142652395808147, 11.785903110974736, -3.6645827832774174, -8.155641934930532, -13.152177635330759, -4.91200000926899, -9.06654997540295, -25.43484485014788, -43.14396469215309, -34.20074031007277, -11.329419484324113, -9.378648871097344, -1.3017309328966604, -5.484376621767694, 13.968858464303734, 1.8043701216517718, 1.1382909255548341, -17.49989932033749, -18.85119869638043, -23.814988410145965, 7.722374904613687, -17.48958449127976, 14.283765330036939, 22.74259381665156, -31.92822362798428, -27.680931667194407, -12.10078488082906, 22.00253539735291, 2.0454534038972767, 1.180062494730695, 6.655837903199346, -27.68699065055955, 7.785301808949621, -2.382303655349851, -2.2938510762388837, -22.6966474778458, -8.235804249017697, 14.151179823365489, -18.834043550298162, -12.87992922599885, -36.09309300430303, -14.345200086484688, 2.8232594409325795, 0.8576437399498147, -5.6749858957382635, -9.510400691398349, 8.739780810541138, 20.911043504831653, -19.356939501873438, 44.30412310813609, 16.33319815946836, 14.93288744250744, -21.35183909094234, 2.6882985514095097, 25.774193881783056, -20.65987885041332, 10.05670447127175, 1.859100855583371, -51.04723705206369, -51.163421373343766, -1.9084649205492443, -3.9875502646560754, 32.861106606077826, 3.5750589386002503, -30.411669743300962, -31.065483614767217, -4.771673564238881, -15.842681881986053, 4.819004935933705, -9.303957677849045, -37.19199401225579, -37.328804541088076, -39.40142816397294, -44.97062124301602, -5.875724991358641, 1.4544065621462643, 6.661574675524836, 9.712586804998011, -45.299397931859744, -42.17978024093903, -33.86455355799069, -29.31535673859629, 13.941710188432324, 32.005689068538274, -18.36521061151143, -52.72021644974067, -8.773252740879876, 13.228057338504183, -25.89329239318785, -38.92589650003315, -12.834095432539279, -3.909398128480909, 0.9638577947307034, -48.171275428130656, -38.78353522672353, -28.141087858995398, 18.163920346016525, -4.184015831745491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45484836282441415, "mean_inference_ms": 1.2243254810318842, "mean_action_processing_ms": 0.19659158535540708, "mean_env_wait_ms": 0.08193349374584775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004194974899291992, "StateBufferConnector_ms": 0.004470229148864746, "ViewRequirementAgentConnector_ms": 0.08509564399719238}, "num_episodes": 9, "episode_return_max": 22.97369962848529, "episode_return_min": -51.10532921270376, "episode_return_mean": -9.34967798415947}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 450.2184539047394, "num_env_steps_trained_throughput_per_sec": 450.2184539047394, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 804000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 9063.839, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9063.797, "sample_time_ms": 944.274, "learn_time_ms": 8104.445, "learn_throughput": 493.556, "synch_weights_time_ms": 14.549}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "training_iteration": 67, "trial_id": "83a5c_00000", "date": "2024-08-10_12-23-47", "timestamp": 1723307027, "time_this_iter_s": 8.890523910522461, "time_total_s": 590.3687889575958, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faca310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 590.3687889575958, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 32.01538461538462, "ram_util_percent": 82.80769230769229}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1905401259503035, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.954277374126293, "policy_loss": -0.007150104917369034, "vf_loss": 3.9606039194833667, "vf_explained_var": -0.013515051237489811, "kl": 0.01156827984180714, "entropy": 1.0412043598593859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1943225992222626, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3162109846870105, "policy_loss": -0.019289351562474622, "vf_loss": 3.334828821818034, "vf_explained_var": 0.07078124471008777, "kl": 0.02829755943226812, "entropy": 0.6822481727227568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 33.789079841147476, "episode_reward_min": -51.10532921270376, "episode_reward_mean": -8.715757673895316, "episode_len_mean": 384.66, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38466, "policy_reward_min": {"agent_policy": -33.78907984114755, "adversary_policy": -52.72021644974067}, "policy_reward_max": {"agent_policy": 51.105329212703765, "adversary_policy": 44.30412310813609}, "policy_reward_mean": {"agent_policy": 8.715757673895316, "adversary_policy": -8.715757673895316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.209901877322096, 15.868121843150021, -30.30262228387499, -3.337784315767239, -16.81411954634214, -28.209801819517835, -7.224767401203158, -29.66058874571329, -31.117761429620444, -24.43900033214138, -27.34362285692223, 0.15030028873241008, -9.365709855026749, -4.880659325492124, -20.084116177557732, -6.118320361797475, -19.860068189524544, -17.378349586729644, -8.515627363230173, -8.019205580505494, -7.847631773355902, -14.383145918639848, -12.327034749997772, -4.351842218600928, -30.470435243429833, -13.100892957273864, -5.549287426382266, 3.546193117947304, -16.12320755426891, 1.35509783359554, 10.739356546627171, -5.05108385223235, -0.8315174799329066, -17.93497503170915, -17.019765766381568, -2.3377834437218015, -2.7068369877175513, -10.136385904518384, 21.829957019390253, 12.96427775339144, -5.910112359103975, -9.032088822299874, -17.250697412775416, -38.67235250111292, -10.354034177710728, -3.3930537773321774, 7.886614292977754, -8.180804197391328, -21.333093553263197, -4.883604793333037, 18.513179573344246, -29.80457764758935, 4.950875258261925, 1.6127579493139867, -10.515576373680096, 2.7014990767998865, -12.495249277042344, 2.957687787173896, -15.856986388148496, -25.219146545393855, 1.840451590441197, -7.592693293568308, 14.825412157686396, 12.473591803131333, 15.6330428009879, -9.331770269766416, 2.557157515684869, 5.957902663427561, -51.10532921270376, -2.94800759260265, 18.218082772339045, -30.738576679034146, -10.307177723112467, -2.24247637095767, -37.26039927667191, -42.18602470349446, -2.2106592146061885, 8.187080740261422, -43.73958908639944, -31.58995514829347, 22.97369962848529, -35.542713530626074, 2.2274022988121565, -32.40959444661043, -8.371746780510094, -23.60370881669998, -33.462311542859474, 6.989952257135515, 2.023574991295929, 12.912511849052857, -2.3414129153011984, -36.77846041922279, 33.789079841147476, -13.776905281322925, -9.34683928892675, -1.3525945383883133, -8.725727041147174, 23.194388508171105, 8.46330793647136, -2.9984207293142244], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 13, 400, 400, 2, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 373, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [23.209901877322096, -15.868121843150012, 30.302622283874992, 3.337784315767239, 16.81411954634214, 28.209801819517832, 7.224767401203154, 29.660588745713284, 31.117761429620447, 24.439000332141383, 27.34362285692223, -0.15030028873241008, 9.365709855026749, 4.880659325492124, 20.084116177557732, 6.118320361797475, 19.860068189524544, 17.378349586729648, 8.515627363230173, 8.0192055805055, 7.847631773355902, 14.383145918639848, 12.327034749997773, 4.351842218600929, 30.47043524342983, 13.100892957273864, 5.549287426382266, -3.546193117947304, 16.1232075542689, -1.35509783359554, -10.739356546627171, 5.051083852232351, 0.8315174799328959, 17.934975031709154, 17.01976576638157, 2.3377834437218006, 2.7068369877175513, 10.136385904518384, -21.829957019390246, -12.964277753391446, 5.910112359103975, 9.032088822299874, 17.250697412775416, 38.672352501112925, 10.354034177710728, 3.3930537773321774, -7.886614292977754, 8.180804197391332, 21.3330935532632, 4.883604793333037, -18.51317957334425, 29.804577647589323, -4.9508752582619255, -1.612757949313985, 10.515576373680094, -2.7014990767998874, 12.495249277042348, -2.9576877871738962, 15.856986388148492, 25.21914654539385, -1.840451590441197, 7.592693293568308, -14.825412157686394, -12.473591803131317, -15.6330428009879, 9.331770269766416, -2.557157515684869, -5.957902663427561, 51.105329212703765, 2.948007592602652, -18.218082772339034, 30.738576679034097, 10.307177723112467, 2.24247637095767, 37.26039927667193, 42.18602470349448, 2.2106592146061885, -8.187080740261429, 43.73958908639948, 31.58995514829348, -22.9736996284853, 35.54271353062605, -2.2274022988121565, 32.40959444661046, 8.371746780510094, 23.603708816699985, 33.462311542859496, -6.989952257135516, -2.023574991295929, -12.912511849052862, 2.3414129153011984, 36.77846041922278, -33.78907984114755, 13.776905281322913, 9.34683928892675, 1.3525945383883133, 8.725727041147174, -23.1943885081711, -8.463307936471349, 2.998420729314221], "policy_adversary_policy_reward": [0.5369169401408982, -46.95672069478509, 9.424126070912838, 22.31211761538727, -31.499814591493454, -29.10542997625654, -15.757729054089914, 9.082160422555436, -26.411833522379755, -7.2164055703045396, -15.47156754205766, -40.94803609697801, -27.337912275503324, 12.888377473097016, -28.408557934520847, -30.912619556905728, -25.743945007726584, -36.491577851514315, -18.96959644625113, -29.908404218031624, -19.403346259735308, -35.28389945410916, -5.616056825360857, 5.9166574028256775, -0.9133604090261898, -17.818059301027308, 6.437111264502754, -16.198429915487, -26.258658666006735, -13.909573689108726, -13.02863677689386, 0.7919960532989094, -13.700522566437385, -26.019613812611702, -10.223631188735492, -24.533067984723818, -2.7572199428524087, -14.274034783607938, -20.486434656669168, 4.448023495658173, 3.2700293115961756, -18.96529285830798, -22.42064559335436, -6.34564624392533, -31.60187947863286, 6.947809978637316, -9.425590510059827, 0.7219060728579709, -25.851336005776307, -35.08953448108335, -4.00761287115472, -22.194173043393004, -14.330112134582997, 3.231537281818465, 5.622560036378189, 1.4698261995164188, -9.499288616153589, -22.74712649238423, -7.583238575715683, 10.293434242906763, 6.589898189542993, 14.88881490371135, -12.007955154320673, 1.9057874498559748, 11.592382509645004, -13.255417469510785, -34.30827389658435, -1.5616761668339478, -26.2967368509992, -7.7427946817639395, 9.517029951670985, -14.19259683911459, 4.018778381313517, -9.43245235674862, -16.359521835739148, -3.9132499732976243, 38.6227644428638, 5.037149595916723, 14.142652395808147, 11.785903110974736, -3.6645827832774174, -8.155641934930532, -13.152177635330759, -4.91200000926899, -9.06654997540295, -25.43484485014788, -43.14396469215309, -34.20074031007277, -11.329419484324113, -9.378648871097344, -1.3017309328966604, -5.484376621767694, 13.968858464303734, 1.8043701216517718, 1.1382909255548341, -17.49989932033749, -18.85119869638043, -23.814988410145965, 7.722374904613687, -17.48958449127976, 14.283765330036939, 22.74259381665156, -31.92822362798428, -27.680931667194407, -12.10078488082906, 22.00253539735291, 2.0454534038972767, 1.180062494730695, 6.655837903199346, -27.68699065055955, 7.785301808949621, -2.382303655349851, -2.2938510762388837, -22.6966474778458, -8.235804249017697, 14.151179823365489, -18.834043550298162, -12.87992922599885, -36.09309300430303, -14.345200086484688, 2.8232594409325795, 0.8576437399498147, -5.6749858957382635, -9.510400691398349, 8.739780810541138, 20.911043504831653, -19.356939501873438, 44.30412310813609, 16.33319815946836, 14.93288744250744, -21.35183909094234, 2.6882985514095097, 25.774193881783056, -20.65987885041332, 10.05670447127175, 1.859100855583371, -51.04723705206369, -51.163421373343766, -1.9084649205492443, -3.9875502646560754, 32.861106606077826, 3.5750589386002503, -30.411669743300962, -31.065483614767217, -4.771673564238881, -15.842681881986053, 4.819004935933705, -9.303957677849045, -37.19199401225579, -37.328804541088076, -39.40142816397294, -44.97062124301602, -5.875724991358641, 1.4544065621462643, 6.661574675524836, 9.712586804998011, -45.299397931859744, -42.17978024093903, -33.86455355799069, -29.31535673859629, 13.941710188432324, 32.005689068538274, -18.36521061151143, -52.72021644974067, -8.773252740879876, 13.228057338504183, -25.89329239318785, -38.92589650003315, -12.834095432539279, -3.909398128480909, 0.9638577947307034, -48.171275428130656, -38.78353522672353, -28.141087858995398, 18.163920346016525, -4.184015831745491, 16.03259228366847, -11.985442301076613, 3.4410049079351204, 22.3840187901706, 1.9877585911518096, -6.6705844217542065, -35.18133501660544, -38.375585821840176, 34.55112648435363, 33.02703319794141, 3.4384525880640595, -30.99226315070991, -5.066703289531482, -13.626975288322019, 7.154054068716409, -9.859243145493036, -4.571604119383807, -12.879849962910544, 16.0099295007709, 30.378847515571298, 31.878000805904705, -14.951384932962, -19.523945240037364, 13.527103781408915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4549701350817766, "mean_inference_ms": 1.2243094233508398, "mean_action_processing_ms": 0.1966053841581607, "mean_env_wait_ms": 0.081996670167259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004172682762145996, "StateBufferConnector_ms": 0.004434108734130859, "ViewRequirementAgentConnector_ms": 0.08409619331359863}, "num_episodes": 12, "episode_return_max": 33.789079841147476, "episode_return_min": -51.10532921270376, "episode_return_mean": -8.715757673895316}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 457.3719783189336, "num_env_steps_trained_throughput_per_sec": 457.3719783189336, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 9042.206, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9042.164, "sample_time_ms": 943.735, "learn_time_ms": 8083.521, "learn_throughput": 494.834, "synch_weights_time_ms": 14.359}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 68, "trial_id": "83a5c_00000", "date": "2024-08-10_12-23-55", "timestamp": 1723307035, "time_this_iter_s": 8.751200199127197, "time_total_s": 599.119989156723, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fae5b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 599.119989156723, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 31.45384615384615, "ram_util_percent": 82.73076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.996586891109981, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.296980187123415, "policy_loss": -0.005503104720757436, "vf_loss": 4.301721716557861, "vf_explained_var": 0.020838341290357883, "kl": 0.010697498924419575, "entropy": 0.926141640370485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1129101941982906, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.315644912173351, "policy_loss": -0.006061450243093228, "vf_loss": 4.321180851757527, "vf_explained_var": 0.5161849263434609, "kl": 0.014763498438606604, "entropy": 0.5557589302149911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "env_runners": {"episode_reward_max": 35.96029659893267, "episode_reward_min": -51.10532921270376, "episode_reward_mean": -7.724994354679468, "episode_len_mean": 380.98, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 38098, "policy_reward_min": {"agent_policy": -35.96029659893268, "adversary_policy": -52.72021644974067}, "policy_reward_max": {"agent_policy": 51.105329212703765, "adversary_policy": 50.80170750435554}, "policy_reward_mean": {"agent_policy": 7.724994354679468, "adversary_policy": -7.724994354679466}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.365709855026749, -4.880659325492124, -20.084116177557732, -6.118320361797475, -19.860068189524544, -17.378349586729644, -8.515627363230173, -8.019205580505494, -7.847631773355902, -14.383145918639848, -12.327034749997772, -4.351842218600928, -30.470435243429833, -13.100892957273864, -5.549287426382266, 3.546193117947304, -16.12320755426891, 1.35509783359554, 10.739356546627171, -5.05108385223235, -0.8315174799329066, -17.93497503170915, -17.019765766381568, -2.3377834437218015, -2.7068369877175513, -10.136385904518384, 21.829957019390253, 12.96427775339144, -5.910112359103975, -9.032088822299874, -17.250697412775416, -38.67235250111292, -10.354034177710728, -3.3930537773321774, 7.886614292977754, -8.180804197391328, -21.333093553263197, -4.883604793333037, 18.513179573344246, -29.80457764758935, 4.950875258261925, 1.6127579493139867, -10.515576373680096, 2.7014990767998865, -12.495249277042344, 2.957687787173896, -15.856986388148496, -25.219146545393855, 1.840451590441197, -7.592693293568308, 14.825412157686396, 12.473591803131333, 15.6330428009879, -9.331770269766416, 2.557157515684869, 5.957902663427561, -51.10532921270376, -2.94800759260265, 18.218082772339045, -30.738576679034146, -10.307177723112467, -2.24247637095767, -37.26039927667191, -42.18602470349446, -2.2106592146061885, 8.187080740261422, -43.73958908639944, -31.58995514829347, 22.97369962848529, -35.542713530626074, 2.2274022988121565, -32.40959444661043, -8.371746780510094, -23.60370881669998, -33.462311542859474, 6.989952257135515, 2.023574991295929, 12.912511849052857, -2.3414129153011984, -36.77846041922279, 33.789079841147476, -13.776905281322925, -9.34683928892675, -1.3525945383883133, -8.725727041147174, 23.194388508171105, 8.46330793647136, -2.9984207293142244, -33.63706599154927, -28.17827100033932, -1.8530407689666415, -5.740390230374544, -31.58381515498982, -9.016447704079361, 35.96029659893267, -20.317990023927617, -15.57419036505599, -16.10235930924134, 16.631148977149614, 2.8469084174841597], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 13, 400, 400, 2, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 373, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 383, 400, 400, 400, 400, 49], "policy_agent_policy_reward": [9.365709855026749, 4.880659325492124, 20.084116177557732, 6.118320361797475, 19.860068189524544, 17.378349586729648, 8.515627363230173, 8.0192055805055, 7.847631773355902, 14.383145918639848, 12.327034749997773, 4.351842218600929, 30.47043524342983, 13.100892957273864, 5.549287426382266, -3.546193117947304, 16.1232075542689, -1.35509783359554, -10.739356546627171, 5.051083852232351, 0.8315174799328959, 17.934975031709154, 17.01976576638157, 2.3377834437218006, 2.7068369877175513, 10.136385904518384, -21.829957019390246, -12.964277753391446, 5.910112359103975, 9.032088822299874, 17.250697412775416, 38.672352501112925, 10.354034177710728, 3.3930537773321774, -7.886614292977754, 8.180804197391332, 21.3330935532632, 4.883604793333037, -18.51317957334425, 29.804577647589323, -4.9508752582619255, -1.612757949313985, 10.515576373680094, -2.7014990767998874, 12.495249277042348, -2.9576877871738962, 15.856986388148492, 25.21914654539385, -1.840451590441197, 7.592693293568308, -14.825412157686394, -12.473591803131317, -15.6330428009879, 9.331770269766416, -2.557157515684869, -5.957902663427561, 51.105329212703765, 2.948007592602652, -18.218082772339034, 30.738576679034097, 10.307177723112467, 2.24247637095767, 37.26039927667193, 42.18602470349448, 2.2106592146061885, -8.187080740261429, 43.73958908639948, 31.58995514829348, -22.9736996284853, 35.54271353062605, -2.2274022988121565, 32.40959444661046, 8.371746780510094, 23.603708816699985, 33.462311542859496, -6.989952257135516, -2.023574991295929, -12.912511849052862, 2.3414129153011984, 36.77846041922278, -33.78907984114755, 13.776905281322913, 9.34683928892675, 1.3525945383883133, 8.725727041147174, -23.1943885081711, -8.463307936471349, 2.998420729314221, 33.63706599154928, 28.178271000339322, 1.8530407689666273, 5.740390230374546, 31.583815154989818, 9.016447704079361, -35.96029659893268, 20.317990023927614, 15.57419036505599, 16.10235930924134, -16.63114897714961, -2.84690841748416], "policy_adversary_policy_reward": [-0.9133604090261898, -17.818059301027308, 6.437111264502754, -16.198429915487, -26.258658666006735, -13.909573689108726, -13.02863677689386, 0.7919960532989094, -13.700522566437385, -26.019613812611702, -10.223631188735492, -24.533067984723818, -2.7572199428524087, -14.274034783607938, -20.486434656669168, 4.448023495658173, 3.2700293115961756, -18.96529285830798, -22.42064559335436, -6.34564624392533, -31.60187947863286, 6.947809978637316, -9.425590510059827, 0.7219060728579709, -25.851336005776307, -35.08953448108335, -4.00761287115472, -22.194173043393004, -14.330112134582997, 3.231537281818465, 5.622560036378189, 1.4698261995164188, -9.499288616153589, -22.74712649238423, -7.583238575715683, 10.293434242906763, 6.589898189542993, 14.88881490371135, -12.007955154320673, 1.9057874498559748, 11.592382509645004, -13.255417469510785, -34.30827389658435, -1.5616761668339478, -26.2967368509992, -7.7427946817639395, 9.517029951670985, -14.19259683911459, 4.018778381313517, -9.43245235674862, -16.359521835739148, -3.9132499732976243, 38.6227644428638, 5.037149595916723, 14.142652395808147, 11.785903110974736, -3.6645827832774174, -8.155641934930532, -13.152177635330759, -4.91200000926899, -9.06654997540295, -25.43484485014788, -43.14396469215309, -34.20074031007277, -11.329419484324113, -9.378648871097344, -1.3017309328966604, -5.484376621767694, 13.968858464303734, 1.8043701216517718, 1.1382909255548341, -17.49989932033749, -18.85119869638043, -23.814988410145965, 7.722374904613687, -17.48958449127976, 14.283765330036939, 22.74259381665156, -31.92822362798428, -27.680931667194407, -12.10078488082906, 22.00253539735291, 2.0454534038972767, 1.180062494730695, 6.655837903199346, -27.68699065055955, 7.785301808949621, -2.382303655349851, -2.2938510762388837, -22.6966474778458, -8.235804249017697, 14.151179823365489, -18.834043550298162, -12.87992922599885, -36.09309300430303, -14.345200086484688, 2.8232594409325795, 0.8576437399498147, -5.6749858957382635, -9.510400691398349, 8.739780810541138, 20.911043504831653, -19.356939501873438, 44.30412310813609, 16.33319815946836, 14.93288744250744, -21.35183909094234, 2.6882985514095097, 25.774193881783056, -20.65987885041332, 10.05670447127175, 1.859100855583371, -51.04723705206369, -51.163421373343766, -1.9084649205492443, -3.9875502646560754, 32.861106606077826, 3.5750589386002503, -30.411669743300962, -31.065483614767217, -4.771673564238881, -15.842681881986053, 4.819004935933705, -9.303957677849045, -37.19199401225579, -37.328804541088076, -39.40142816397294, -44.97062124301602, -5.875724991358641, 1.4544065621462643, 6.661574675524836, 9.712586804998011, -45.299397931859744, -42.17978024093903, -33.86455355799069, -29.31535673859629, 13.941710188432324, 32.005689068538274, -18.36521061151143, -52.72021644974067, -8.773252740879876, 13.228057338504183, -25.89329239318785, -38.92589650003315, -12.834095432539279, -3.909398128480909, 0.9638577947307034, -48.171275428130656, -38.78353522672353, -28.141087858995398, 18.163920346016525, -4.184015831745491, 16.03259228366847, -11.985442301076613, 3.4410049079351204, 22.3840187901706, 1.9877585911518096, -6.6705844217542065, -35.18133501660544, -38.375585821840176, 34.55112648435363, 33.02703319794141, 3.4384525880640595, -30.99226315070991, -5.066703289531482, -13.626975288322019, 7.154054068716409, -9.859243145493036, -4.571604119383807, -12.879849962910544, 16.0099295007709, 30.378847515571298, 31.878000805904705, -14.951384932962, -19.523945240037364, 13.527103781408915, -41.095714878092856, -26.17841710500565, -25.308318674986147, -31.048223325692508, -1.186500541554615, -2.519580996378636, -0.4717022305311005, -11.009078230217987, -29.973323867515962, -33.19430644246366, -23.75823395523995, 5.725338547081229, 50.80170750435554, 21.11888569350978, -12.51189582856312, -28.124084219292094, -12.471572317135028, -18.676808412976953, -19.518162340653873, -12.686556277828807, 10.514204281226387, 22.748093673072844, -4.7639516625004035, 10.457768497468725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45485476434257044, "mean_inference_ms": 1.2238862718497285, "mean_action_processing_ms": 0.1966099811907458, "mean_env_wait_ms": 0.08202172894647385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004210233688354492, "StateBufferConnector_ms": 0.004475235939025879, "ViewRequirementAgentConnector_ms": 0.08388900756835938}, "num_episodes": 12, "episode_return_max": 35.96029659893267, "episode_return_min": -51.10532921270376, "episode_return_mean": -7.724994354679468}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.3326836150614, "num_env_steps_trained_throughput_per_sec": 452.3326836150614, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 828000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 9014.931, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9014.889, "sample_time_ms": 925.416, "learn_time_ms": 8074.694, "learn_throughput": 495.375, "synch_weights_time_ms": 14.234}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "training_iteration": 69, "trial_id": "83a5c_00000", "date": "2024-08-10_12-24-04", "timestamp": 1723307044, "time_this_iter_s": 8.849898099899292, "time_total_s": 607.9698872566223, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f60eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 607.9698872566223, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 32.66666666666667, "ram_util_percent": 82.91666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.146959852131586, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6790988896889663, "policy_loss": -0.01353975721036217, "vf_loss": 3.6912822366391542, "vf_explained_var": 0.12313767163841813, "kl": 0.019052956633056263, "entropy": 1.0353888799589146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.182234366827955, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3821566730116803, "policy_loss": -0.0021892257335518178, "vf_loss": 2.384168978656332, "vf_explained_var": 0.4531841966013114, "kl": 0.004970272621309046, "entropy": 0.5483486455244323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 35.96029659893267, "episode_reward_min": -52.053433828897575, "episode_reward_mean": -8.502064944724768, "episode_len_mean": 380.98, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38098, "policy_reward_min": {"agent_policy": -35.96029659893268, "adversary_policy": -57.52178386465017}, "policy_reward_max": {"agent_policy": 52.05343382889758, "adversary_policy": 50.80170750435554}, "policy_reward_mean": {"agent_policy": 8.502064944724768, "adversary_policy": -8.502064944724767}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.383145918639848, -12.327034749997772, -4.351842218600928, -30.470435243429833, -13.100892957273864, -5.549287426382266, 3.546193117947304, -16.12320755426891, 1.35509783359554, 10.739356546627171, -5.05108385223235, -0.8315174799329066, -17.93497503170915, -17.019765766381568, -2.3377834437218015, -2.7068369877175513, -10.136385904518384, 21.829957019390253, 12.96427775339144, -5.910112359103975, -9.032088822299874, -17.250697412775416, -38.67235250111292, -10.354034177710728, -3.3930537773321774, 7.886614292977754, -8.180804197391328, -21.333093553263197, -4.883604793333037, 18.513179573344246, -29.80457764758935, 4.950875258261925, 1.6127579493139867, -10.515576373680096, 2.7014990767998865, -12.495249277042344, 2.957687787173896, -15.856986388148496, -25.219146545393855, 1.840451590441197, -7.592693293568308, 14.825412157686396, 12.473591803131333, 15.6330428009879, -9.331770269766416, 2.557157515684869, 5.957902663427561, -51.10532921270376, -2.94800759260265, 18.218082772339045, -30.738576679034146, -10.307177723112467, -2.24247637095767, -37.26039927667191, -42.18602470349446, -2.2106592146061885, 8.187080740261422, -43.73958908639944, -31.58995514829347, 22.97369962848529, -35.542713530626074, 2.2274022988121565, -32.40959444661043, -8.371746780510094, -23.60370881669998, -33.462311542859474, 6.989952257135515, 2.023574991295929, 12.912511849052857, -2.3414129153011984, -36.77846041922279, 33.789079841147476, -13.776905281322925, -9.34683928892675, -1.3525945383883133, -8.725727041147174, 23.194388508171105, 8.46330793647136, -2.9984207293142244, -33.63706599154927, -28.17827100033932, -1.8530407689666415, -5.740390230374544, -31.58381515498982, -9.016447704079361, 35.96029659893267, -20.317990023927617, -15.57419036505599, -16.10235930924134, 16.631148977149614, 2.8469084174841597, -3.270684888584663, 11.434219281049229, 1.346390902078178, 3.8033111616988915, -44.23423409517831, -52.053433828897575, -27.02571919488909, -46.224065516221934, -23.552531038804712], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 13, 400, 400, 2, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 373, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 383, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [14.383145918639848, 12.327034749997773, 4.351842218600929, 30.47043524342983, 13.100892957273864, 5.549287426382266, -3.546193117947304, 16.1232075542689, -1.35509783359554, -10.739356546627171, 5.051083852232351, 0.8315174799328959, 17.934975031709154, 17.01976576638157, 2.3377834437218006, 2.7068369877175513, 10.136385904518384, -21.829957019390246, -12.964277753391446, 5.910112359103975, 9.032088822299874, 17.250697412775416, 38.672352501112925, 10.354034177710728, 3.3930537773321774, -7.886614292977754, 8.180804197391332, 21.3330935532632, 4.883604793333037, -18.51317957334425, 29.804577647589323, -4.9508752582619255, -1.612757949313985, 10.515576373680094, -2.7014990767998874, 12.495249277042348, -2.9576877871738962, 15.856986388148492, 25.21914654539385, -1.840451590441197, 7.592693293568308, -14.825412157686394, -12.473591803131317, -15.6330428009879, 9.331770269766416, -2.557157515684869, -5.957902663427561, 51.105329212703765, 2.948007592602652, -18.218082772339034, 30.738576679034097, 10.307177723112467, 2.24247637095767, 37.26039927667193, 42.18602470349448, 2.2106592146061885, -8.187080740261429, 43.73958908639948, 31.58995514829348, -22.9736996284853, 35.54271353062605, -2.2274022988121565, 32.40959444661046, 8.371746780510094, 23.603708816699985, 33.462311542859496, -6.989952257135516, -2.023574991295929, -12.912511849052862, 2.3414129153011984, 36.77846041922278, -33.78907984114755, 13.776905281322913, 9.34683928892675, 1.3525945383883133, 8.725727041147174, -23.1943885081711, -8.463307936471349, 2.998420729314221, 33.63706599154928, 28.178271000339322, 1.8530407689666273, 5.740390230374546, 31.583815154989818, 9.016447704079361, -35.96029659893268, 20.317990023927614, 15.57419036505599, 16.10235930924134, -16.63114897714961, -2.84690841748416, 3.270684888584663, -11.434219281049227, -1.3463909020781797, -3.803311161698895, 44.2342340951783, 52.05343382889758, 27.025719194889085, 46.22406551622193, 23.55253103880471], "policy_adversary_policy_reward": [-22.42064559335436, -6.34564624392533, -31.60187947863286, 6.947809978637316, -9.425590510059827, 0.7219060728579709, -25.851336005776307, -35.08953448108335, -4.00761287115472, -22.194173043393004, -14.330112134582997, 3.231537281818465, 5.622560036378189, 1.4698261995164188, -9.499288616153589, -22.74712649238423, -7.583238575715683, 10.293434242906763, 6.589898189542993, 14.88881490371135, -12.007955154320673, 1.9057874498559748, 11.592382509645004, -13.255417469510785, -34.30827389658435, -1.5616761668339478, -26.2967368509992, -7.7427946817639395, 9.517029951670985, -14.19259683911459, 4.018778381313517, -9.43245235674862, -16.359521835739148, -3.9132499732976243, 38.6227644428638, 5.037149595916723, 14.142652395808147, 11.785903110974736, -3.6645827832774174, -8.155641934930532, -13.152177635330759, -4.91200000926899, -9.06654997540295, -25.43484485014788, -43.14396469215309, -34.20074031007277, -11.329419484324113, -9.378648871097344, -1.3017309328966604, -5.484376621767694, 13.968858464303734, 1.8043701216517718, 1.1382909255548341, -17.49989932033749, -18.85119869638043, -23.814988410145965, 7.722374904613687, -17.48958449127976, 14.283765330036939, 22.74259381665156, -31.92822362798428, -27.680931667194407, -12.10078488082906, 22.00253539735291, 2.0454534038972767, 1.180062494730695, 6.655837903199346, -27.68699065055955, 7.785301808949621, -2.382303655349851, -2.2938510762388837, -22.6966474778458, -8.235804249017697, 14.151179823365489, -18.834043550298162, -12.87992922599885, -36.09309300430303, -14.345200086484688, 2.8232594409325795, 0.8576437399498147, -5.6749858957382635, -9.510400691398349, 8.739780810541138, 20.911043504831653, -19.356939501873438, 44.30412310813609, 16.33319815946836, 14.93288744250744, -21.35183909094234, 2.6882985514095097, 25.774193881783056, -20.65987885041332, 10.05670447127175, 1.859100855583371, -51.04723705206369, -51.163421373343766, -1.9084649205492443, -3.9875502646560754, 32.861106606077826, 3.5750589386002503, -30.411669743300962, -31.065483614767217, -4.771673564238881, -15.842681881986053, 4.819004935933705, -9.303957677849045, -37.19199401225579, -37.328804541088076, -39.40142816397294, -44.97062124301602, -5.875724991358641, 1.4544065621462643, 6.661574675524836, 9.712586804998011, -45.299397931859744, -42.17978024093903, -33.86455355799069, -29.31535673859629, 13.941710188432324, 32.005689068538274, -18.36521061151143, -52.72021644974067, -8.773252740879876, 13.228057338504183, -25.89329239318785, -38.92589650003315, -12.834095432539279, -3.909398128480909, 0.9638577947307034, -48.171275428130656, -38.78353522672353, -28.141087858995398, 18.163920346016525, -4.184015831745491, 16.03259228366847, -11.985442301076613, 3.4410049079351204, 22.3840187901706, 1.9877585911518096, -6.6705844217542065, -35.18133501660544, -38.375585821840176, 34.55112648435363, 33.02703319794141, 3.4384525880640595, -30.99226315070991, -5.066703289531482, -13.626975288322019, 7.154054068716409, -9.859243145493036, -4.571604119383807, -12.879849962910544, 16.0099295007709, 30.378847515571298, 31.878000805904705, -14.951384932962, -19.523945240037364, 13.527103781408915, -41.095714878092856, -26.17841710500565, -25.308318674986147, -31.048223325692508, -1.186500541554615, -2.519580996378636, -0.4717022305311005, -11.009078230217987, -29.973323867515962, -33.19430644246366, -23.75823395523995, 5.725338547081229, 50.80170750435554, 21.11888569350978, -12.51189582856312, -28.124084219292094, -12.471572317135028, -18.676808412976953, -19.518162340653873, -12.686556277828807, 10.514204281226387, 22.748093673072844, -4.7639516625004035, 10.457768497468725, 9.009133414397613, -15.55050319156694, 2.2166306500467883, 20.651807912051666, 1.0321378214043833, 1.660643982751976, 18.465104083457827, -10.858481760060052, -38.54391580082998, -49.9245523895266, -46.58508379314502, -57.52178386465017, -18.117278076278232, -35.934160313499916, -46.61600529588664, -45.83212573655729, -2.1425632262118306, -44.962498851397605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45473574698403346, "mean_inference_ms": 1.2235450503992689, "mean_action_processing_ms": 0.19658850039545953, "mean_env_wait_ms": 0.08203098413903603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00426793098449707, "StateBufferConnector_ms": 0.0045005083084106445, "ViewRequirementAgentConnector_ms": 0.08379745483398438}, "num_episodes": 9, "episode_return_max": 35.96029659893267, "episode_return_min": -52.053433828897575, "episode_return_mean": -8.502064944724768}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 435.5611796175154, "num_env_steps_trained_throughput_per_sec": 435.5611796175154, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 8976.646, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8976.606, "sample_time_ms": 911.466, "learn_time_ms": 8050.627, "learn_throughput": 496.856, "synch_weights_time_ms": 13.972}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 70, "trial_id": "83a5c_00000", "date": "2024-08-10_12-24-14", "timestamp": 1723307054, "time_this_iter_s": 9.214629173278809, "time_total_s": 617.1845164299011, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31facae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 617.1845164299011, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 34.607692307692304, "ram_util_percent": 83.28461538461536}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.041693614714991, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.301171749798709, "policy_loss": -0.0036932726781174698, "vf_loss": 3.3043315575867105, "vf_explained_var": 0.031972247519821084, "kl": 0.007493451547855277, "entropy": 0.8751179458603027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1580735385417937, "cur_kl_coeff": 0.017797851562499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6999769726147256, "policy_loss": -0.0040016332641243935, "vf_loss": 2.7038606560478606, "vf_explained_var": 0.06809955189625422, "kl": 0.006626677726038436, "entropy": 0.5604453741262356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "env_runners": {"episode_reward_max": 35.96029659893267, "episode_reward_min": -52.053433828897575, "episode_reward_mean": -8.494863653593606, "episode_len_mean": 380.98, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38098, "policy_reward_min": {"agent_policy": -35.96029659893268, "adversary_policy": -57.52178386465017}, "policy_reward_max": {"agent_policy": 52.05343382889758, "adversary_policy": 50.80170750435554}, "policy_reward_mean": {"agent_policy": 8.494863653593605, "adversary_policy": -8.494863653593606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.05108385223235, -0.8315174799329066, -17.93497503170915, -17.019765766381568, -2.3377834437218015, -2.7068369877175513, -10.136385904518384, 21.829957019390253, 12.96427775339144, -5.910112359103975, -9.032088822299874, -17.250697412775416, -38.67235250111292, -10.354034177710728, -3.3930537773321774, 7.886614292977754, -8.180804197391328, -21.333093553263197, -4.883604793333037, 18.513179573344246, -29.80457764758935, 4.950875258261925, 1.6127579493139867, -10.515576373680096, 2.7014990767998865, -12.495249277042344, 2.957687787173896, -15.856986388148496, -25.219146545393855, 1.840451590441197, -7.592693293568308, 14.825412157686396, 12.473591803131333, 15.6330428009879, -9.331770269766416, 2.557157515684869, 5.957902663427561, -51.10532921270376, -2.94800759260265, 18.218082772339045, -30.738576679034146, -10.307177723112467, -2.24247637095767, -37.26039927667191, -42.18602470349446, -2.2106592146061885, 8.187080740261422, -43.73958908639944, -31.58995514829347, 22.97369962848529, -35.542713530626074, 2.2274022988121565, -32.40959444661043, -8.371746780510094, -23.60370881669998, -33.462311542859474, 6.989952257135515, 2.023574991295929, 12.912511849052857, -2.3414129153011984, -36.77846041922279, 33.789079841147476, -13.776905281322925, -9.34683928892675, -1.3525945383883133, -8.725727041147174, 23.194388508171105, 8.46330793647136, -2.9984207293142244, -33.63706599154927, -28.17827100033932, -1.8530407689666415, -5.740390230374544, -31.58381515498982, -9.016447704079361, 35.96029659893267, -20.317990023927617, -15.57419036505599, -16.10235930924134, 16.631148977149614, 2.8469084174841597, -3.270684888584663, 11.434219281049229, 1.346390902078178, 3.8033111616988915, -44.23423409517831, -52.053433828897575, -27.02571919488909, -46.224065516221934, -23.552531038804712, -13.956849708116705, -16.780495063817266, 7.537050810011419, 0.39264079780495464, 2.4547165084561353, -28.76328104100848, -3.5006856366702834, -9.992249176647148, -5.724845152156111, -11.611071795163674], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 13, 400, 400, 2, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 373, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 383, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [5.051083852232351, 0.8315174799328959, 17.934975031709154, 17.01976576638157, 2.3377834437218006, 2.7068369877175513, 10.136385904518384, -21.829957019390246, -12.964277753391446, 5.910112359103975, 9.032088822299874, 17.250697412775416, 38.672352501112925, 10.354034177710728, 3.3930537773321774, -7.886614292977754, 8.180804197391332, 21.3330935532632, 4.883604793333037, -18.51317957334425, 29.804577647589323, -4.9508752582619255, -1.612757949313985, 10.515576373680094, -2.7014990767998874, 12.495249277042348, -2.9576877871738962, 15.856986388148492, 25.21914654539385, -1.840451590441197, 7.592693293568308, -14.825412157686394, -12.473591803131317, -15.6330428009879, 9.331770269766416, -2.557157515684869, -5.957902663427561, 51.105329212703765, 2.948007592602652, -18.218082772339034, 30.738576679034097, 10.307177723112467, 2.24247637095767, 37.26039927667193, 42.18602470349448, 2.2106592146061885, -8.187080740261429, 43.73958908639948, 31.58995514829348, -22.9736996284853, 35.54271353062605, -2.2274022988121565, 32.40959444661046, 8.371746780510094, 23.603708816699985, 33.462311542859496, -6.989952257135516, -2.023574991295929, -12.912511849052862, 2.3414129153011984, 36.77846041922278, -33.78907984114755, 13.776905281322913, 9.34683928892675, 1.3525945383883133, 8.725727041147174, -23.1943885081711, -8.463307936471349, 2.998420729314221, 33.63706599154928, 28.178271000339322, 1.8530407689666273, 5.740390230374546, 31.583815154989818, 9.016447704079361, -35.96029659893268, 20.317990023927614, 15.57419036505599, 16.10235930924134, -16.63114897714961, -2.84690841748416, 3.270684888584663, -11.434219281049227, -1.3463909020781797, -3.803311161698895, 44.2342340951783, 52.05343382889758, 27.025719194889085, 46.22406551622193, 23.55253103880471, 13.95684970811671, 16.780495063817263, -7.537050810011436, -0.39264079780495464, -2.4547165084561353, 28.763281041008476, 3.5006856366702834, 9.992249176647153, 5.72484515215611, 11.611071795163676], "policy_adversary_policy_reward": [-12.007955154320673, 1.9057874498559748, 11.592382509645004, -13.255417469510785, -34.30827389658435, -1.5616761668339478, -26.2967368509992, -7.7427946817639395, 9.517029951670985, -14.19259683911459, 4.018778381313517, -9.43245235674862, -16.359521835739148, -3.9132499732976243, 38.6227644428638, 5.037149595916723, 14.142652395808147, 11.785903110974736, -3.6645827832774174, -8.155641934930532, -13.152177635330759, -4.91200000926899, -9.06654997540295, -25.43484485014788, -43.14396469215309, -34.20074031007277, -11.329419484324113, -9.378648871097344, -1.3017309328966604, -5.484376621767694, 13.968858464303734, 1.8043701216517718, 1.1382909255548341, -17.49989932033749, -18.85119869638043, -23.814988410145965, 7.722374904613687, -17.48958449127976, 14.283765330036939, 22.74259381665156, -31.92822362798428, -27.680931667194407, -12.10078488082906, 22.00253539735291, 2.0454534038972767, 1.180062494730695, 6.655837903199346, -27.68699065055955, 7.785301808949621, -2.382303655349851, -2.2938510762388837, -22.6966474778458, -8.235804249017697, 14.151179823365489, -18.834043550298162, -12.87992922599885, -36.09309300430303, -14.345200086484688, 2.8232594409325795, 0.8576437399498147, -5.6749858957382635, -9.510400691398349, 8.739780810541138, 20.911043504831653, -19.356939501873438, 44.30412310813609, 16.33319815946836, 14.93288744250744, -21.35183909094234, 2.6882985514095097, 25.774193881783056, -20.65987885041332, 10.05670447127175, 1.859100855583371, -51.04723705206369, -51.163421373343766, -1.9084649205492443, -3.9875502646560754, 32.861106606077826, 3.5750589386002503, -30.411669743300962, -31.065483614767217, -4.771673564238881, -15.842681881986053, 4.819004935933705, -9.303957677849045, -37.19199401225579, -37.328804541088076, -39.40142816397294, -44.97062124301602, -5.875724991358641, 1.4544065621462643, 6.661574675524836, 9.712586804998011, -45.299397931859744, -42.17978024093903, -33.86455355799069, -29.31535673859629, 13.941710188432324, 32.005689068538274, -18.36521061151143, -52.72021644974067, -8.773252740879876, 13.228057338504183, -25.89329239318785, -38.92589650003315, -12.834095432539279, -3.909398128480909, 0.9638577947307034, -48.171275428130656, -38.78353522672353, -28.141087858995398, 18.163920346016525, -4.184015831745491, 16.03259228366847, -11.985442301076613, 3.4410049079351204, 22.3840187901706, 1.9877585911518096, -6.6705844217542065, -35.18133501660544, -38.375585821840176, 34.55112648435363, 33.02703319794141, 3.4384525880640595, -30.99226315070991, -5.066703289531482, -13.626975288322019, 7.154054068716409, -9.859243145493036, -4.571604119383807, -12.879849962910544, 16.0099295007709, 30.378847515571298, 31.878000805904705, -14.951384932962, -19.523945240037364, 13.527103781408915, -41.095714878092856, -26.17841710500565, -25.308318674986147, -31.048223325692508, -1.186500541554615, -2.519580996378636, -0.4717022305311005, -11.009078230217987, -29.973323867515962, -33.19430644246366, -23.75823395523995, 5.725338547081229, 50.80170750435554, 21.11888569350978, -12.51189582856312, -28.124084219292094, -12.471572317135028, -18.676808412976953, -19.518162340653873, -12.686556277828807, 10.514204281226387, 22.748093673072844, -4.7639516625004035, 10.457768497468725, 9.009133414397613, -15.55050319156694, 2.2166306500467883, 20.651807912051666, 1.0321378214043833, 1.660643982751976, 18.465104083457827, -10.858481760060052, -38.54391580082998, -49.9245523895266, -46.58508379314502, -57.52178386465017, -18.117278076278232, -35.934160313499916, -46.61600529588664, -45.83212573655729, -2.1425632262118306, -44.962498851397605, 0.09564282793831325, -28.00934224417174, -30.972366276877175, -2.588623850757301, 31.038774907278217, -15.964673287255351, -5.243384846983307, 6.028666442593213, -9.471605616204762, 14.381038633117042, -26.883221961567486, -30.64334012044948, -26.32160869614527, 19.320237422804702, -16.40352819016705, -3.580970163127251, -19.421952133450347, 7.972261829138127, 13.15842377772685, -36.380567368054194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4546635051898877, "mean_inference_ms": 1.223322572425484, "mean_action_processing_ms": 0.19657710921393093, "mean_env_wait_ms": 0.08205448652679662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004567503929138184, "StateBufferConnector_ms": 0.004918456077575684, "ViewRequirementAgentConnector_ms": 0.08666872978210449}, "num_episodes": 10, "episode_return_max": 35.96029659893267, "episode_return_min": -52.053433828897575, "episode_return_mean": -8.494863653593606}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 418.3578351002617, "num_env_steps_trained_throughput_per_sec": 418.3578351002617, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 852000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 9029.955, "restore_workers_time_ms": 0.014, "training_step_time_ms": 9029.845, "sample_time_ms": 917.278, "learn_time_ms": 8097.198, "learn_throughput": 493.998, "synch_weights_time_ms": 14.702}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "training_iteration": 71, "trial_id": "83a5c_00000", "date": "2024-08-10_12-24-23", "timestamp": 1723307063, "time_this_iter_s": 9.581146001815796, "time_total_s": 626.7656624317169, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 626.7656624317169, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 43.878571428571426, "ram_util_percent": 83.02142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7070095492733848, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9471497949784395, "policy_loss": -0.005268864781058654, "vf_loss": 1.9519597816088843, "vf_explained_var": 0.18599630373495596, "kl": 0.006445680075034339, "entropy": 0.7162565699014715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.121060618649547, "cur_kl_coeff": 0.017797851562499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.449301461378733, "policy_loss": -0.00011169792002571436, "vf_loss": 2.449393658215801, "vf_explained_var": 0.5373234707241257, "kl": 0.001095103418397514, "entropy": 0.5167951756467422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 35.96029659893267, "episode_reward_min": -52.053433828897575, "episode_reward_mean": -7.999567387696003, "episode_len_mean": 377.09, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37709, "policy_reward_min": {"agent_policy": -35.96029659893268, "adversary_policy": -57.52178386465017}, "policy_reward_max": {"agent_policy": 52.05343382889758, "adversary_policy": 50.80170750435554}, "policy_reward_mean": {"agent_policy": 7.999567387696001, "adversary_policy": -7.999567387696001}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.032088822299874, -17.250697412775416, -38.67235250111292, -10.354034177710728, -3.3930537773321774, 7.886614292977754, -8.180804197391328, -21.333093553263197, -4.883604793333037, 18.513179573344246, -29.80457764758935, 4.950875258261925, 1.6127579493139867, -10.515576373680096, 2.7014990767998865, -12.495249277042344, 2.957687787173896, -15.856986388148496, -25.219146545393855, 1.840451590441197, -7.592693293568308, 14.825412157686396, 12.473591803131333, 15.6330428009879, -9.331770269766416, 2.557157515684869, 5.957902663427561, -51.10532921270376, -2.94800759260265, 18.218082772339045, -30.738576679034146, -10.307177723112467, -2.24247637095767, -37.26039927667191, -42.18602470349446, -2.2106592146061885, 8.187080740261422, -43.73958908639944, -31.58995514829347, 22.97369962848529, -35.542713530626074, 2.2274022988121565, -32.40959444661043, -8.371746780510094, -23.60370881669998, -33.462311542859474, 6.989952257135515, 2.023574991295929, 12.912511849052857, -2.3414129153011984, -36.77846041922279, 33.789079841147476, -13.776905281322925, -9.34683928892675, -1.3525945383883133, -8.725727041147174, 23.194388508171105, 8.46330793647136, -2.9984207293142244, -33.63706599154927, -28.17827100033932, -1.8530407689666415, -5.740390230374544, -31.58381515498982, -9.016447704079361, 35.96029659893267, -20.317990023927617, -15.57419036505599, -16.10235930924134, 16.631148977149614, 2.8469084174841597, -3.270684888584663, 11.434219281049229, 1.346390902078178, 3.8033111616988915, -44.23423409517831, -52.053433828897575, -27.02571919488909, -46.224065516221934, -23.552531038804712, -13.956849708116705, -16.780495063817266, 7.537050810011419, 0.39264079780495464, 2.4547165084561353, -28.76328104100848, -3.5006856366702834, -9.992249176647148, -5.724845152156111, -11.611071795163674, 14.925017859112172, 17.419541366865136, -11.754037888941003, -25.924567127237697, -6.608118724449752, 33.889161861464366, 10.983083935690834, 10.118817907019396, 6.6176864559916515, -27.27118510829079], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 13, 400, 400, 2, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 373, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 383, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400], "policy_agent_policy_reward": [9.032088822299874, 17.250697412775416, 38.672352501112925, 10.354034177710728, 3.3930537773321774, -7.886614292977754, 8.180804197391332, 21.3330935532632, 4.883604793333037, -18.51317957334425, 29.804577647589323, -4.9508752582619255, -1.612757949313985, 10.515576373680094, -2.7014990767998874, 12.495249277042348, -2.9576877871738962, 15.856986388148492, 25.21914654539385, -1.840451590441197, 7.592693293568308, -14.825412157686394, -12.473591803131317, -15.6330428009879, 9.331770269766416, -2.557157515684869, -5.957902663427561, 51.105329212703765, 2.948007592602652, -18.218082772339034, 30.738576679034097, 10.307177723112467, 2.24247637095767, 37.26039927667193, 42.18602470349448, 2.2106592146061885, -8.187080740261429, 43.73958908639948, 31.58995514829348, -22.9736996284853, 35.54271353062605, -2.2274022988121565, 32.40959444661046, 8.371746780510094, 23.603708816699985, 33.462311542859496, -6.989952257135516, -2.023574991295929, -12.912511849052862, 2.3414129153011984, 36.77846041922278, -33.78907984114755, 13.776905281322913, 9.34683928892675, 1.3525945383883133, 8.725727041147174, -23.1943885081711, -8.463307936471349, 2.998420729314221, 33.63706599154928, 28.178271000339322, 1.8530407689666273, 5.740390230374546, 31.583815154989818, 9.016447704079361, -35.96029659893268, 20.317990023927614, 15.57419036505599, 16.10235930924134, -16.63114897714961, -2.84690841748416, 3.270684888584663, -11.434219281049227, -1.3463909020781797, -3.803311161698895, 44.2342340951783, 52.05343382889758, 27.025719194889085, 46.22406551622193, 23.55253103880471, 13.95684970811671, 16.780495063817263, -7.537050810011436, -0.39264079780495464, -2.4547165084561353, 28.763281041008476, 3.5006856366702834, 9.992249176647153, 5.72484515215611, 11.611071795163676, -14.925017859112174, -17.41954136686513, 11.754037888941003, 25.924567127237694, 6.608118724449753, -33.88916186146434, -10.983083935690836, -10.118817907019398, -6.617686455991651, 27.27118510829078], "policy_adversary_policy_reward": [-13.152177635330759, -4.91200000926899, -9.06654997540295, -25.43484485014788, -43.14396469215309, -34.20074031007277, -11.329419484324113, -9.378648871097344, -1.3017309328966604, -5.484376621767694, 13.968858464303734, 1.8043701216517718, 1.1382909255548341, -17.49989932033749, -18.85119869638043, -23.814988410145965, 7.722374904613687, -17.48958449127976, 14.283765330036939, 22.74259381665156, -31.92822362798428, -27.680931667194407, -12.10078488082906, 22.00253539735291, 2.0454534038972767, 1.180062494730695, 6.655837903199346, -27.68699065055955, 7.785301808949621, -2.382303655349851, -2.2938510762388837, -22.6966474778458, -8.235804249017697, 14.151179823365489, -18.834043550298162, -12.87992922599885, -36.09309300430303, -14.345200086484688, 2.8232594409325795, 0.8576437399498147, -5.6749858957382635, -9.510400691398349, 8.739780810541138, 20.911043504831653, -19.356939501873438, 44.30412310813609, 16.33319815946836, 14.93288744250744, -21.35183909094234, 2.6882985514095097, 25.774193881783056, -20.65987885041332, 10.05670447127175, 1.859100855583371, -51.04723705206369, -51.163421373343766, -1.9084649205492443, -3.9875502646560754, 32.861106606077826, 3.5750589386002503, -30.411669743300962, -31.065483614767217, -4.771673564238881, -15.842681881986053, 4.819004935933705, -9.303957677849045, -37.19199401225579, -37.328804541088076, -39.40142816397294, -44.97062124301602, -5.875724991358641, 1.4544065621462643, 6.661574675524836, 9.712586804998011, -45.299397931859744, -42.17978024093903, -33.86455355799069, -29.31535673859629, 13.941710188432324, 32.005689068538274, -18.36521061151143, -52.72021644974067, -8.773252740879876, 13.228057338504183, -25.89329239318785, -38.92589650003315, -12.834095432539279, -3.909398128480909, 0.9638577947307034, -48.171275428130656, -38.78353522672353, -28.141087858995398, 18.163920346016525, -4.184015831745491, 16.03259228366847, -11.985442301076613, 3.4410049079351204, 22.3840187901706, 1.9877585911518096, -6.6705844217542065, -35.18133501660544, -38.375585821840176, 34.55112648435363, 33.02703319794141, 3.4384525880640595, -30.99226315070991, -5.066703289531482, -13.626975288322019, 7.154054068716409, -9.859243145493036, -4.571604119383807, -12.879849962910544, 16.0099295007709, 30.378847515571298, 31.878000805904705, -14.951384932962, -19.523945240037364, 13.527103781408915, -41.095714878092856, -26.17841710500565, -25.308318674986147, -31.048223325692508, -1.186500541554615, -2.519580996378636, -0.4717022305311005, -11.009078230217987, -29.973323867515962, -33.19430644246366, -23.75823395523995, 5.725338547081229, 50.80170750435554, 21.11888569350978, -12.51189582856312, -28.124084219292094, -12.471572317135028, -18.676808412976953, -19.518162340653873, -12.686556277828807, 10.514204281226387, 22.748093673072844, -4.7639516625004035, 10.457768497468725, 9.009133414397613, -15.55050319156694, 2.2166306500467883, 20.651807912051666, 1.0321378214043833, 1.660643982751976, 18.465104083457827, -10.858481760060052, -38.54391580082998, -49.9245523895266, -46.58508379314502, -57.52178386465017, -18.117278076278232, -35.934160313499916, -46.61600529588664, -45.83212573655729, -2.1425632262118306, -44.962498851397605, 0.09564282793831325, -28.00934224417174, -30.972366276877175, -2.588623850757301, 31.038774907278217, -15.964673287255351, -5.243384846983307, 6.028666442593213, -9.471605616204762, 14.381038633117042, -26.883221961567486, -30.64334012044948, -26.32160869614527, 19.320237422804702, -16.40352819016705, -3.580970163127251, -19.421952133450347, 7.972261829138127, 13.15842377772685, -36.380567368054194, 28.1748861760208, 1.6751495422035463, 29.252775081728103, 5.586307652002137, 17.996150463176935, -41.50422624105894, -0.5782966350054295, -51.270837619469916, -35.75844294577169, 22.54220549687219, 30.80818790505173, 36.97013581787693, 17.154969996546473, 4.811197874835202, 9.090269129454114, 11.147366684584686, 8.402785796989253, 4.832587114994048, -4.151514745550067, -50.390855471031514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4548152099685294, "mean_inference_ms": 1.2234973845092472, "mean_action_processing_ms": 0.19664114707773822, "mean_env_wait_ms": 0.08212139402077709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004701852798461914, "StateBufferConnector_ms": 0.004933953285217285, "ViewRequirementAgentConnector_ms": 0.08692789077758789}, "num_episodes": 10, "episode_return_max": 35.96029659893267, "episode_return_min": -52.053433828897575, "episode_return_mean": -7.999567387696003}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 459.85251688785735, "num_env_steps_trained_throughput_per_sec": 459.85251688785735, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 9037.465, "restore_workers_time_ms": 0.015, "training_step_time_ms": 9037.35, "sample_time_ms": 939.339, "learn_time_ms": 8082.541, "learn_throughput": 494.894, "synch_weights_time_ms": 14.746}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 72, "trial_id": "83a5c_00000", "date": "2024-08-10_12-24-32", "timestamp": 1723307072, "time_this_iter_s": 8.709352254867554, "time_total_s": 635.4750146865845, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faaee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 635.4750146865845, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 32.40833333333333, "ram_util_percent": 82.33333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.67393179863849, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.55717562001849, "policy_loss": -0.006610734851491298, "vf_loss": 2.563401944233627, "vf_explained_var": -0.10468549753623034, "kl": 0.005399650462591583, "entropy": 0.6085897289255939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7663974399367968, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.422643122387429, "policy_loss": -0.002924466626670134, "vf_loss": 2.4255115520829955, "vf_explained_var": -0.20066395147393148, "kl": 0.00629688077910752, "entropy": 0.4871926880441606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "env_runners": {"episode_reward_max": 35.96029659893267, "episode_reward_min": -52.053433828897575, "episode_reward_mean": -8.020441765776605, "episode_len_mean": 373.42, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37342, "policy_reward_min": {"agent_policy": -35.96029659893268, "adversary_policy": -57.52178386465017}, "policy_reward_max": {"agent_policy": 52.05343382889758, "adversary_policy": 50.80170750435554}, "policy_reward_mean": {"agent_policy": 8.020441765776607, "adversary_policy": -8.020441765776605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6127579493139867, -10.515576373680096, 2.7014990767998865, -12.495249277042344, 2.957687787173896, -15.856986388148496, -25.219146545393855, 1.840451590441197, -7.592693293568308, 14.825412157686396, 12.473591803131333, 15.6330428009879, -9.331770269766416, 2.557157515684869, 5.957902663427561, -51.10532921270376, -2.94800759260265, 18.218082772339045, -30.738576679034146, -10.307177723112467, -2.24247637095767, -37.26039927667191, -42.18602470349446, -2.2106592146061885, 8.187080740261422, -43.73958908639944, -31.58995514829347, 22.97369962848529, -35.542713530626074, 2.2274022988121565, -32.40959444661043, -8.371746780510094, -23.60370881669998, -33.462311542859474, 6.989952257135515, 2.023574991295929, 12.912511849052857, -2.3414129153011984, -36.77846041922279, 33.789079841147476, -13.776905281322925, -9.34683928892675, -1.3525945383883133, -8.725727041147174, 23.194388508171105, 8.46330793647136, -2.9984207293142244, -33.63706599154927, -28.17827100033932, -1.8530407689666415, -5.740390230374544, -31.58381515498982, -9.016447704079361, 35.96029659893267, -20.317990023927617, -15.57419036505599, -16.10235930924134, 16.631148977149614, 2.8469084174841597, -3.270684888584663, 11.434219281049229, 1.346390902078178, 3.8033111616988915, -44.23423409517831, -52.053433828897575, -27.02571919488909, -46.224065516221934, -23.552531038804712, -13.956849708116705, -16.780495063817266, 7.537050810011419, 0.39264079780495464, 2.4547165084561353, -28.76328104100848, -3.5006856366702834, -9.992249176647148, -5.724845152156111, -11.611071795163674, 14.925017859112172, 17.419541366865136, -11.754037888941003, -25.924567127237697, -6.608118724449752, 33.889161861464366, 10.983083935690834, 10.118817907019396, 6.6176864559916515, -27.27118510829079, -34.46197309043969, 0.05879468983709213, 27.7271038849597, -2.331392273319233, -17.890354416422767, 6.190615390323811, -21.48090245930175, -29.89631895107682, -48.50612747064995, -9.155305783298703, 10.152581728541447, 5.9522031845625225], "episode_lengths": [400, 400, 400, 400, 13, 400, 400, 2, 400, 400, 400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 373, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 383, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 41], "policy_agent_policy_reward": [-1.612757949313985, 10.515576373680094, -2.7014990767998874, 12.495249277042348, -2.9576877871738962, 15.856986388148492, 25.21914654539385, -1.840451590441197, 7.592693293568308, -14.825412157686394, -12.473591803131317, -15.6330428009879, 9.331770269766416, -2.557157515684869, -5.957902663427561, 51.105329212703765, 2.948007592602652, -18.218082772339034, 30.738576679034097, 10.307177723112467, 2.24247637095767, 37.26039927667193, 42.18602470349448, 2.2106592146061885, -8.187080740261429, 43.73958908639948, 31.58995514829348, -22.9736996284853, 35.54271353062605, -2.2274022988121565, 32.40959444661046, 8.371746780510094, 23.603708816699985, 33.462311542859496, -6.989952257135516, -2.023574991295929, -12.912511849052862, 2.3414129153011984, 36.77846041922278, -33.78907984114755, 13.776905281322913, 9.34683928892675, 1.3525945383883133, 8.725727041147174, -23.1943885081711, -8.463307936471349, 2.998420729314221, 33.63706599154928, 28.178271000339322, 1.8530407689666273, 5.740390230374546, 31.583815154989818, 9.016447704079361, -35.96029659893268, 20.317990023927614, 15.57419036505599, 16.10235930924134, -16.63114897714961, -2.84690841748416, 3.270684888584663, -11.434219281049227, -1.3463909020781797, -3.803311161698895, 44.2342340951783, 52.05343382889758, 27.025719194889085, 46.22406551622193, 23.55253103880471, 13.95684970811671, 16.780495063817263, -7.537050810011436, -0.39264079780495464, -2.4547165084561353, 28.763281041008476, 3.5006856366702834, 9.992249176647153, 5.72484515215611, 11.611071795163676, -14.925017859112174, -17.41954136686513, 11.754037888941003, 25.924567127237694, 6.608118724449753, -33.88916186146434, -10.983083935690836, -10.118817907019398, -6.617686455991651, 27.27118510829078, 34.4619730904397, -0.05879468983709213, -27.7271038849597, 2.331392273319233, 17.890354416422767, -6.190615390323811, 21.480902459301756, 29.89631895107689, 48.50612747064996, 9.1553057832987, -10.152581728541453, -5.952203184562523], "policy_adversary_policy_reward": [2.0454534038972767, 1.180062494730695, 6.655837903199346, -27.68699065055955, 7.785301808949621, -2.382303655349851, -2.2938510762388837, -22.6966474778458, -8.235804249017697, 14.151179823365489, -18.834043550298162, -12.87992922599885, -36.09309300430303, -14.345200086484688, 2.8232594409325795, 0.8576437399498147, -5.6749858957382635, -9.510400691398349, 8.739780810541138, 20.911043504831653, -19.356939501873438, 44.30412310813609, 16.33319815946836, 14.93288744250744, -21.35183909094234, 2.6882985514095097, 25.774193881783056, -20.65987885041332, 10.05670447127175, 1.859100855583371, -51.04723705206369, -51.163421373343766, -1.9084649205492443, -3.9875502646560754, 32.861106606077826, 3.5750589386002503, -30.411669743300962, -31.065483614767217, -4.771673564238881, -15.842681881986053, 4.819004935933705, -9.303957677849045, -37.19199401225579, -37.328804541088076, -39.40142816397294, -44.97062124301602, -5.875724991358641, 1.4544065621462643, 6.661574675524836, 9.712586804998011, -45.299397931859744, -42.17978024093903, -33.86455355799069, -29.31535673859629, 13.941710188432324, 32.005689068538274, -18.36521061151143, -52.72021644974067, -8.773252740879876, 13.228057338504183, -25.89329239318785, -38.92589650003315, -12.834095432539279, -3.909398128480909, 0.9638577947307034, -48.171275428130656, -38.78353522672353, -28.141087858995398, 18.163920346016525, -4.184015831745491, 16.03259228366847, -11.985442301076613, 3.4410049079351204, 22.3840187901706, 1.9877585911518096, -6.6705844217542065, -35.18133501660544, -38.375585821840176, 34.55112648435363, 33.02703319794141, 3.4384525880640595, -30.99226315070991, -5.066703289531482, -13.626975288322019, 7.154054068716409, -9.859243145493036, -4.571604119383807, -12.879849962910544, 16.0099295007709, 30.378847515571298, 31.878000805904705, -14.951384932962, -19.523945240037364, 13.527103781408915, -41.095714878092856, -26.17841710500565, -25.308318674986147, -31.048223325692508, -1.186500541554615, -2.519580996378636, -0.4717022305311005, -11.009078230217987, -29.973323867515962, -33.19430644246366, -23.75823395523995, 5.725338547081229, 50.80170750435554, 21.11888569350978, -12.51189582856312, -28.124084219292094, -12.471572317135028, -18.676808412976953, -19.518162340653873, -12.686556277828807, 10.514204281226387, 22.748093673072844, -4.7639516625004035, 10.457768497468725, 9.009133414397613, -15.55050319156694, 2.2166306500467883, 20.651807912051666, 1.0321378214043833, 1.660643982751976, 18.465104083457827, -10.858481760060052, -38.54391580082998, -49.9245523895266, -46.58508379314502, -57.52178386465017, -18.117278076278232, -35.934160313499916, -46.61600529588664, -45.83212573655729, -2.1425632262118306, -44.962498851397605, 0.09564282793831325, -28.00934224417174, -30.972366276877175, -2.588623850757301, 31.038774907278217, -15.964673287255351, -5.243384846983307, 6.028666442593213, -9.471605616204762, 14.381038633117042, -26.883221961567486, -30.64334012044948, -26.32160869614527, 19.320237422804702, -16.40352819016705, -3.580970163127251, -19.421952133450347, 7.972261829138127, 13.15842377772685, -36.380567368054194, 28.1748861760208, 1.6751495422035463, 29.252775081728103, 5.586307652002137, 17.996150463176935, -41.50422624105894, -0.5782966350054295, -51.270837619469916, -35.75844294577169, 22.54220549687219, 30.80818790505173, 36.97013581787693, 17.154969996546473, 4.811197874835202, 9.090269129454114, 11.147366684584686, 8.402785796989253, 4.832587114994048, -4.151514745550067, -50.390855471031514, -24.974279684249268, -43.949666496630165, 23.176486080124146, -23.05889670044997, 25.90688866270908, 29.547319107210313, 14.435758063333745, -19.098542609972213, -14.75362387278134, -21.027084960064194, -0.8128857751543279, 13.19411655580195, -53.7919841582828, 10.830179239679296, -2.615385784451991, -57.177252117701705, -41.80564294656093, -55.20661199473898, -17.647151179437323, -0.6634603871600806, 10.65304100467911, 9.652122452403784, -30.198171472619617, 42.10257784174467]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45494760917455507, "mean_inference_ms": 1.2231636437551259, "mean_action_processing_ms": 0.1965776140967944, "mean_env_wait_ms": 0.08216397756327481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004608273506164551, "StateBufferConnector_ms": 0.0048711299896240234, "ViewRequirementAgentConnector_ms": 0.08321928977966309}, "num_episodes": 12, "episode_return_max": 35.96029659893267, "episode_return_min": -52.053433828897575, "episode_return_mean": -8.020441765776605}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.50891975171595, "num_env_steps_trained_throughput_per_sec": 488.50891975171595, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 876000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 8944.47, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8944.355, "sample_time_ms": 927.193, "learn_time_ms": 8001.663, "learn_throughput": 499.896, "synch_weights_time_ms": 14.815}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "training_iteration": 73, "trial_id": "83a5c_00000", "date": "2024-08-10_12-24-40", "timestamp": 1723307080, "time_this_iter_s": 8.192795991897583, "time_total_s": 643.667810678482, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb6bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 643.667810678482, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 26.266666666666666, "ram_util_percent": 82.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9812314764532464, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3895657840859954, "policy_loss": -0.005034457356176246, "vf_loss": 2.394263055337169, "vf_explained_var": 0.05690958793201144, "kl": 0.004736423559473585, "entropy": 0.5771577940889137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9913690496856966, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4913117768863837, "policy_loss": -0.006691498592166075, "vf_loss": 2.497928125659625, "vf_explained_var": -0.4732235091427962, "kl": 0.00844377065901374, "entropy": 0.4995994630890588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": 35.96029659893267, "episode_reward_min": -52.053433828897575, "episode_reward_mean": -7.468112752002968, "episode_len_mean": 381.27, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38127, "policy_reward_min": {"agent_policy": -35.96029659893268, "adversary_policy": -57.52178386465017}, "policy_reward_max": {"agent_policy": 52.05343382889758, "adversary_policy": 50.80170750435554}, "policy_reward_mean": {"agent_policy": 7.468112752002969, "adversary_policy": -7.468112752002969}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.473591803131333, 15.6330428009879, -9.331770269766416, 2.557157515684869, 5.957902663427561, -51.10532921270376, -2.94800759260265, 18.218082772339045, -30.738576679034146, -10.307177723112467, -2.24247637095767, -37.26039927667191, -42.18602470349446, -2.2106592146061885, 8.187080740261422, -43.73958908639944, -31.58995514829347, 22.97369962848529, -35.542713530626074, 2.2274022988121565, -32.40959444661043, -8.371746780510094, -23.60370881669998, -33.462311542859474, 6.989952257135515, 2.023574991295929, 12.912511849052857, -2.3414129153011984, -36.77846041922279, 33.789079841147476, -13.776905281322925, -9.34683928892675, -1.3525945383883133, -8.725727041147174, 23.194388508171105, 8.46330793647136, -2.9984207293142244, -33.63706599154927, -28.17827100033932, -1.8530407689666415, -5.740390230374544, -31.58381515498982, -9.016447704079361, 35.96029659893267, -20.317990023927617, -15.57419036505599, -16.10235930924134, 16.631148977149614, 2.8469084174841597, -3.270684888584663, 11.434219281049229, 1.346390902078178, 3.8033111616988915, -44.23423409517831, -52.053433828897575, -27.02571919488909, -46.224065516221934, -23.552531038804712, -13.956849708116705, -16.780495063817266, 7.537050810011419, 0.39264079780495464, 2.4547165084561353, -28.76328104100848, -3.5006856366702834, -9.992249176647148, -5.724845152156111, -11.611071795163674, 14.925017859112172, 17.419541366865136, -11.754037888941003, -25.924567127237697, -6.608118724449752, 33.889161861464366, 10.983083935690834, 10.118817907019396, 6.6176864559916515, -27.27118510829079, -34.46197309043969, 0.05879468983709213, 27.7271038849597, -2.331392273319233, -17.890354416422767, 6.190615390323811, -21.48090245930175, -29.89631895107682, -48.50612747064995, -9.155305783298703, 10.152581728541447, 5.9522031845625225, 7.815309740075693, -31.173864090374543, 10.259209223428131, -23.24887237721759, 9.876054883281302, 14.06472172765102, 19.542892446313235, 12.236598632731509, -19.855234279422366, 7.974242154479457], "episode_lengths": [400, 400, 400, 39, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 373, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 383, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-12.473591803131317, -15.6330428009879, 9.331770269766416, -2.557157515684869, -5.957902663427561, 51.105329212703765, 2.948007592602652, -18.218082772339034, 30.738576679034097, 10.307177723112467, 2.24247637095767, 37.26039927667193, 42.18602470349448, 2.2106592146061885, -8.187080740261429, 43.73958908639948, 31.58995514829348, -22.9736996284853, 35.54271353062605, -2.2274022988121565, 32.40959444661046, 8.371746780510094, 23.603708816699985, 33.462311542859496, -6.989952257135516, -2.023574991295929, -12.912511849052862, 2.3414129153011984, 36.77846041922278, -33.78907984114755, 13.776905281322913, 9.34683928892675, 1.3525945383883133, 8.725727041147174, -23.1943885081711, -8.463307936471349, 2.998420729314221, 33.63706599154928, 28.178271000339322, 1.8530407689666273, 5.740390230374546, 31.583815154989818, 9.016447704079361, -35.96029659893268, 20.317990023927614, 15.57419036505599, 16.10235930924134, -16.63114897714961, -2.84690841748416, 3.270684888584663, -11.434219281049227, -1.3463909020781797, -3.803311161698895, 44.2342340951783, 52.05343382889758, 27.025719194889085, 46.22406551622193, 23.55253103880471, 13.95684970811671, 16.780495063817263, -7.537050810011436, -0.39264079780495464, -2.4547165084561353, 28.763281041008476, 3.5006856366702834, 9.992249176647153, 5.72484515215611, 11.611071795163676, -14.925017859112174, -17.41954136686513, 11.754037888941003, 25.924567127237694, 6.608118724449753, -33.88916186146434, -10.983083935690836, -10.118817907019398, -6.617686455991651, 27.27118510829078, 34.4619730904397, -0.05879468983709213, -27.7271038849597, 2.331392273319233, 17.890354416422767, -6.190615390323811, 21.480902459301756, 29.89631895107689, 48.50612747064996, 9.1553057832987, -10.152581728541453, -5.952203184562523, -7.815309740075693, 31.173864090374547, -10.25920922342813, 23.248872377217594, -9.876054883281304, -14.06472172765102, -19.54289244631321, -12.236598632731507, 19.855234279422362, -7.974242154479458], "policy_adversary_policy_reward": [-19.356939501873438, 44.30412310813609, 16.33319815946836, 14.93288744250744, -21.35183909094234, 2.6882985514095097, 25.774193881783056, -20.65987885041332, 10.05670447127175, 1.859100855583371, -51.04723705206369, -51.163421373343766, -1.9084649205492443, -3.9875502646560754, 32.861106606077826, 3.5750589386002503, -30.411669743300962, -31.065483614767217, -4.771673564238881, -15.842681881986053, 4.819004935933705, -9.303957677849045, -37.19199401225579, -37.328804541088076, -39.40142816397294, -44.97062124301602, -5.875724991358641, 1.4544065621462643, 6.661574675524836, 9.712586804998011, -45.299397931859744, -42.17978024093903, -33.86455355799069, -29.31535673859629, 13.941710188432324, 32.005689068538274, -18.36521061151143, -52.72021644974067, -8.773252740879876, 13.228057338504183, -25.89329239318785, -38.92589650003315, -12.834095432539279, -3.909398128480909, 0.9638577947307034, -48.171275428130656, -38.78353522672353, -28.141087858995398, 18.163920346016525, -4.184015831745491, 16.03259228366847, -11.985442301076613, 3.4410049079351204, 22.3840187901706, 1.9877585911518096, -6.6705844217542065, -35.18133501660544, -38.375585821840176, 34.55112648435363, 33.02703319794141, 3.4384525880640595, -30.99226315070991, -5.066703289531482, -13.626975288322019, 7.154054068716409, -9.859243145493036, -4.571604119383807, -12.879849962910544, 16.0099295007709, 30.378847515571298, 31.878000805904705, -14.951384932962, -19.523945240037364, 13.527103781408915, -41.095714878092856, -26.17841710500565, -25.308318674986147, -31.048223325692508, -1.186500541554615, -2.519580996378636, -0.4717022305311005, -11.009078230217987, -29.973323867515962, -33.19430644246366, -23.75823395523995, 5.725338547081229, 50.80170750435554, 21.11888569350978, -12.51189582856312, -28.124084219292094, -12.471572317135028, -18.676808412976953, -19.518162340653873, -12.686556277828807, 10.514204281226387, 22.748093673072844, -4.7639516625004035, 10.457768497468725, 9.009133414397613, -15.55050319156694, 2.2166306500467883, 20.651807912051666, 1.0321378214043833, 1.660643982751976, 18.465104083457827, -10.858481760060052, -38.54391580082998, -49.9245523895266, -46.58508379314502, -57.52178386465017, -18.117278076278232, -35.934160313499916, -46.61600529588664, -45.83212573655729, -2.1425632262118306, -44.962498851397605, 0.09564282793831325, -28.00934224417174, -30.972366276877175, -2.588623850757301, 31.038774907278217, -15.964673287255351, -5.243384846983307, 6.028666442593213, -9.471605616204762, 14.381038633117042, -26.883221961567486, -30.64334012044948, -26.32160869614527, 19.320237422804702, -16.40352819016705, -3.580970163127251, -19.421952133450347, 7.972261829138127, 13.15842377772685, -36.380567368054194, 28.1748861760208, 1.6751495422035463, 29.252775081728103, 5.586307652002137, 17.996150463176935, -41.50422624105894, -0.5782966350054295, -51.270837619469916, -35.75844294577169, 22.54220549687219, 30.80818790505173, 36.97013581787693, 17.154969996546473, 4.811197874835202, 9.090269129454114, 11.147366684584686, 8.402785796989253, 4.832587114994048, -4.151514745550067, -50.390855471031514, -24.974279684249268, -43.949666496630165, 23.176486080124146, -23.05889670044997, 25.90688866270908, 29.547319107210313, 14.435758063333745, -19.098542609972213, -14.75362387278134, -21.027084960064194, -0.8128857751543279, 13.19411655580195, -53.7919841582828, 10.830179239679296, -2.615385784451991, -57.177252117701705, -41.80564294656093, -55.20661199473898, -17.647151179437323, -0.6634603871600806, 10.65304100467911, 9.652122452403784, -30.198171472619617, 42.10257784174467, 12.237908410361747, 3.3927110697896374, -40.70909178720591, -21.638636393543187, 16.514098729160835, 4.004319717695429, 0.3632187567682976, -46.86096351120349, 33.564341814202294, -13.812232047639675, 23.03043805796758, 5.099005397334452, 13.876237009341219, 25.209547883285218, 3.235499013739955, 21.237698251723067, -35.08808829658183, -4.622380262262892, 4.8926165258563135, 11.055867783102604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45474265997557717, "mean_inference_ms": 1.2232713802163284, "mean_action_processing_ms": 0.19653233737102555, "mean_env_wait_ms": 0.08221061146150462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004430651664733887, "StateBufferConnector_ms": 0.004814505577087402, "ViewRequirementAgentConnector_ms": 0.0800778865814209}, "num_episodes": 10, "episode_return_max": 35.96029659893267, "episode_return_min": -52.053433828897575, "episode_return_mean": -7.468112752002968}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.64219278121334, "num_env_steps_trained_throughput_per_sec": 482.64219278121334, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 8890.558, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8890.445, "sample_time_ms": 910.567, "learn_time_ms": 7964.837, "learn_throughput": 502.207, "synch_weights_time_ms": 14.355}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 74, "trial_id": "83a5c_00000", "date": "2024-08-10_12-24-48", "timestamp": 1723307088, "time_this_iter_s": 8.292571306228638, "time_total_s": 651.9603819847107, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faae0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 651.9603819847107, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 29.799999999999997, "ram_util_percent": 82.54166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9091977218156138, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.918544849012264, "policy_loss": -0.004299206063693399, "vf_loss": 2.9226379775496385, "vf_explained_var": -0.2221094198643215, "kl": 0.005789417134382218, "entropy": 0.6188827332996186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2603304761151475, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7979186528672773, "policy_loss": -0.013461587683559628, "vf_loss": 2.8112329430878162, "vf_explained_var": -0.624499365563194, "kl": 0.016551371253488496, "entropy": 0.4415791591318945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "env_runners": {"episode_reward_max": 35.96029659893267, "episode_reward_min": -52.053433828897575, "episode_reward_mean": -6.6222788498515275, "episode_len_mean": 381.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38100, "policy_reward_min": {"agent_policy": -35.96029659893268, "adversary_policy": -57.52178386465017}, "policy_reward_max": {"agent_policy": 52.05343382889758, "adversary_policy": 50.80170750435554}, "policy_reward_mean": {"agent_policy": 6.6222788498515275, "adversary_policy": -6.622278849851527}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.24247637095767, -37.26039927667191, -42.18602470349446, -2.2106592146061885, 8.187080740261422, -43.73958908639944, -31.58995514829347, 22.97369962848529, -35.542713530626074, 2.2274022988121565, -32.40959444661043, -8.371746780510094, -23.60370881669998, -33.462311542859474, 6.989952257135515, 2.023574991295929, 12.912511849052857, -2.3414129153011984, -36.77846041922279, 33.789079841147476, -13.776905281322925, -9.34683928892675, -1.3525945383883133, -8.725727041147174, 23.194388508171105, 8.46330793647136, -2.9984207293142244, -33.63706599154927, -28.17827100033932, -1.8530407689666415, -5.740390230374544, -31.58381515498982, -9.016447704079361, 35.96029659893267, -20.317990023927617, -15.57419036505599, -16.10235930924134, 16.631148977149614, 2.8469084174841597, -3.270684888584663, 11.434219281049229, 1.346390902078178, 3.8033111616988915, -44.23423409517831, -52.053433828897575, -27.02571919488909, -46.224065516221934, -23.552531038804712, -13.956849708116705, -16.780495063817266, 7.537050810011419, 0.39264079780495464, 2.4547165084561353, -28.76328104100848, -3.5006856366702834, -9.992249176647148, -5.724845152156111, -11.611071795163674, 14.925017859112172, 17.419541366865136, -11.754037888941003, -25.924567127237697, -6.608118724449752, 33.889161861464366, 10.983083935690834, 10.118817907019396, 6.6176864559916515, -27.27118510829079, -34.46197309043969, 0.05879468983709213, 27.7271038849597, -2.331392273319233, -17.890354416422767, 6.190615390323811, -21.48090245930175, -29.89631895107682, -48.50612747064995, -9.155305783298703, 10.152581728541447, 5.9522031845625225, 7.815309740075693, -31.173864090374543, 10.259209223428131, -23.24887237721759, 9.876054883281302, 14.06472172765102, 19.542892446313235, 12.236598632731509, -19.855234279422366, 7.974242154479457, 10.211487887177219, -7.561776589616111, 18.880898773761274, -2.745470913880012, 27.201288498205273, 22.351558983829577, -3.2441478911918633, -17.215254639026927, 20.93350322743865, -33.81978104320155], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 373, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 383, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [2.24247637095767, 37.26039927667193, 42.18602470349448, 2.2106592146061885, -8.187080740261429, 43.73958908639948, 31.58995514829348, -22.9736996284853, 35.54271353062605, -2.2274022988121565, 32.40959444661046, 8.371746780510094, 23.603708816699985, 33.462311542859496, -6.989952257135516, -2.023574991295929, -12.912511849052862, 2.3414129153011984, 36.77846041922278, -33.78907984114755, 13.776905281322913, 9.34683928892675, 1.3525945383883133, 8.725727041147174, -23.1943885081711, -8.463307936471349, 2.998420729314221, 33.63706599154928, 28.178271000339322, 1.8530407689666273, 5.740390230374546, 31.583815154989818, 9.016447704079361, -35.96029659893268, 20.317990023927614, 15.57419036505599, 16.10235930924134, -16.63114897714961, -2.84690841748416, 3.270684888584663, -11.434219281049227, -1.3463909020781797, -3.803311161698895, 44.2342340951783, 52.05343382889758, 27.025719194889085, 46.22406551622193, 23.55253103880471, 13.95684970811671, 16.780495063817263, -7.537050810011436, -0.39264079780495464, -2.4547165084561353, 28.763281041008476, 3.5006856366702834, 9.992249176647153, 5.72484515215611, 11.611071795163676, -14.925017859112174, -17.41954136686513, 11.754037888941003, 25.924567127237694, 6.608118724449753, -33.88916186146434, -10.983083935690836, -10.118817907019398, -6.617686455991651, 27.27118510829078, 34.4619730904397, -0.05879468983709213, -27.7271038849597, 2.331392273319233, 17.890354416422767, -6.190615390323811, 21.480902459301756, 29.89631895107689, 48.50612747064996, 9.1553057832987, -10.152581728541453, -5.952203184562523, -7.815309740075693, 31.173864090374547, -10.25920922342813, 23.248872377217594, -9.876054883281304, -14.06472172765102, -19.54289244631321, -12.236598632731507, 19.855234279422362, -7.974242154479458, -10.211487887177213, 7.561776589616109, -18.880898773761277, 2.7454709138800117, -27.20128849820526, -22.351558983829587, 3.2441478911918615, 17.215254639026924, -20.933503227438653, 33.81978104320153], "policy_adversary_policy_reward": [4.819004935933705, -9.303957677849045, -37.19199401225579, -37.328804541088076, -39.40142816397294, -44.97062124301602, -5.875724991358641, 1.4544065621462643, 6.661574675524836, 9.712586804998011, -45.299397931859744, -42.17978024093903, -33.86455355799069, -29.31535673859629, 13.941710188432324, 32.005689068538274, -18.36521061151143, -52.72021644974067, -8.773252740879876, 13.228057338504183, -25.89329239318785, -38.92589650003315, -12.834095432539279, -3.909398128480909, 0.9638577947307034, -48.171275428130656, -38.78353522672353, -28.141087858995398, 18.163920346016525, -4.184015831745491, 16.03259228366847, -11.985442301076613, 3.4410049079351204, 22.3840187901706, 1.9877585911518096, -6.6705844217542065, -35.18133501660544, -38.375585821840176, 34.55112648435363, 33.02703319794141, 3.4384525880640595, -30.99226315070991, -5.066703289531482, -13.626975288322019, 7.154054068716409, -9.859243145493036, -4.571604119383807, -12.879849962910544, 16.0099295007709, 30.378847515571298, 31.878000805904705, -14.951384932962, -19.523945240037364, 13.527103781408915, -41.095714878092856, -26.17841710500565, -25.308318674986147, -31.048223325692508, -1.186500541554615, -2.519580996378636, -0.4717022305311005, -11.009078230217987, -29.973323867515962, -33.19430644246366, -23.75823395523995, 5.725338547081229, 50.80170750435554, 21.11888569350978, -12.51189582856312, -28.124084219292094, -12.471572317135028, -18.676808412976953, -19.518162340653873, -12.686556277828807, 10.514204281226387, 22.748093673072844, -4.7639516625004035, 10.457768497468725, 9.009133414397613, -15.55050319156694, 2.2166306500467883, 20.651807912051666, 1.0321378214043833, 1.660643982751976, 18.465104083457827, -10.858481760060052, -38.54391580082998, -49.9245523895266, -46.58508379314502, -57.52178386465017, -18.117278076278232, -35.934160313499916, -46.61600529588664, -45.83212573655729, -2.1425632262118306, -44.962498851397605, 0.09564282793831325, -28.00934224417174, -30.972366276877175, -2.588623850757301, 31.038774907278217, -15.964673287255351, -5.243384846983307, 6.028666442593213, -9.471605616204762, 14.381038633117042, -26.883221961567486, -30.64334012044948, -26.32160869614527, 19.320237422804702, -16.40352819016705, -3.580970163127251, -19.421952133450347, 7.972261829138127, 13.15842377772685, -36.380567368054194, 28.1748861760208, 1.6751495422035463, 29.252775081728103, 5.586307652002137, 17.996150463176935, -41.50422624105894, -0.5782966350054295, -51.270837619469916, -35.75844294577169, 22.54220549687219, 30.80818790505173, 36.97013581787693, 17.154969996546473, 4.811197874835202, 9.090269129454114, 11.147366684584686, 8.402785796989253, 4.832587114994048, -4.151514745550067, -50.390855471031514, -24.974279684249268, -43.949666496630165, 23.176486080124146, -23.05889670044997, 25.90688866270908, 29.547319107210313, 14.435758063333745, -19.098542609972213, -14.75362387278134, -21.027084960064194, -0.8128857751543279, 13.19411655580195, -53.7919841582828, 10.830179239679296, -2.615385784451991, -57.177252117701705, -41.80564294656093, -55.20661199473898, -17.647151179437323, -0.6634603871600806, 10.65304100467911, 9.652122452403784, -30.198171472619617, 42.10257784174467, 12.237908410361747, 3.3927110697896374, -40.70909178720591, -21.638636393543187, 16.514098729160835, 4.004319717695429, 0.3632187567682976, -46.86096351120349, 33.564341814202294, -13.812232047639675, 23.03043805796758, 5.099005397334452, 13.876237009341219, 25.209547883285218, 3.235499013739955, 21.237698251723067, -35.08808829658183, -4.622380262262892, 4.8926165258563135, 11.055867783102604, 1.5005152704941143, 18.9224605038603, -37.68611964810349, 22.56256646887128, 12.771434436826524, 24.990363110696038, -18.10348585300218, 12.612544025242155, 27.976182991508757, 26.42639400490176, 29.391589999352394, 15.311527968306764, -7.474508429307857, 0.986212646924109, 15.400143852466499, -49.83065313052033, 15.718043131390644, 26.148963323486647, -25.972105984424154, -41.667456101978864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4545353435086249, "mean_inference_ms": 1.2227255700207529, "mean_action_processing_ms": 0.1964323982125896, "mean_env_wait_ms": 0.08220796001783694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004380226135253906, "StateBufferConnector_ms": 0.0047495365142822266, "ViewRequirementAgentConnector_ms": 0.07863235473632812}, "num_episodes": 10, "episode_return_max": 35.96029659893267, "episode_return_min": -52.053433828897575, "episode_return_mean": -6.6222788498515275}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.393240820792, "num_env_steps_trained_throughput_per_sec": 501.393240820792, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 900000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 8754.22, "restore_workers_time_ms": 0.016, "training_step_time_ms": 8754.105, "sample_time_ms": 901.797, "learn_time_ms": 7837.712, "learn_throughput": 510.353, "synch_weights_time_ms": 13.945}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "training_iteration": 75, "trial_id": "83a5c_00000", "date": "2024-08-10_12-24-56", "timestamp": 1723307096, "time_this_iter_s": 7.9843971729278564, "time_total_s": 659.9447791576385, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faae310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 659.9447791576385, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 26.545454545454547, "ram_util_percent": 82.34545454545453}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.336303211330737, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5360537139196246, "policy_loss": -0.00843847902459659, "vf_loss": 2.5442529938208365, "vf_explained_var": -0.014947624370534584, "kl": 0.00672013692588796, "entropy": 0.552901019857674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.292636384939154, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.224873411655426, "policy_loss": -0.011865848206192216, "vf_loss": 2.2366633298496406, "vf_explained_var": 0.06958486971755823, "kl": 0.008532539802431908, "entropy": 0.49059014410401386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 35.96029659893267, "episode_reward_min": -52.053433828897575, "episode_reward_mean": -4.075496849010083, "episode_len_mean": 381.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38100, "policy_reward_min": {"agent_policy": -35.96029659893268, "adversary_policy": -57.52178386465017}, "policy_reward_max": {"agent_policy": 52.05343382889758, "adversary_policy": 50.80170750435554}, "policy_reward_mean": {"agent_policy": 4.075496849010083, "adversary_policy": -4.075496849010085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.40959444661043, -8.371746780510094, -23.60370881669998, -33.462311542859474, 6.989952257135515, 2.023574991295929, 12.912511849052857, -2.3414129153011984, -36.77846041922279, 33.789079841147476, -13.776905281322925, -9.34683928892675, -1.3525945383883133, -8.725727041147174, 23.194388508171105, 8.46330793647136, -2.9984207293142244, -33.63706599154927, -28.17827100033932, -1.8530407689666415, -5.740390230374544, -31.58381515498982, -9.016447704079361, 35.96029659893267, -20.317990023927617, -15.57419036505599, -16.10235930924134, 16.631148977149614, 2.8469084174841597, -3.270684888584663, 11.434219281049229, 1.346390902078178, 3.8033111616988915, -44.23423409517831, -52.053433828897575, -27.02571919488909, -46.224065516221934, -23.552531038804712, -13.956849708116705, -16.780495063817266, 7.537050810011419, 0.39264079780495464, 2.4547165084561353, -28.76328104100848, -3.5006856366702834, -9.992249176647148, -5.724845152156111, -11.611071795163674, 14.925017859112172, 17.419541366865136, -11.754037888941003, -25.924567127237697, -6.608118724449752, 33.889161861464366, 10.983083935690834, 10.118817907019396, 6.6176864559916515, -27.27118510829079, -34.46197309043969, 0.05879468983709213, 27.7271038849597, -2.331392273319233, -17.890354416422767, 6.190615390323811, -21.48090245930175, -29.89631895107682, -48.50612747064995, -9.155305783298703, 10.152581728541447, 5.9522031845625225, 7.815309740075693, -31.173864090374543, 10.259209223428131, -23.24887237721759, 9.876054883281302, 14.06472172765102, 19.542892446313235, 12.236598632731509, -19.855234279422366, 7.974242154479457, 10.211487887177219, -7.561776589616111, 18.880898773761274, -2.745470913880012, 27.201288498205273, 22.351558983829577, -3.2441478911918633, -17.215254639026927, 20.93350322743865, -33.81978104320155, -20.974861429362832, 23.880917505930316, 15.014707924475358, 22.35523010029601, 29.006199697719545, -20.339537033670332, -13.434581001413637, 22.96923868971974, 18.812532194199, 16.00471877276077], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 373, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 383, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [32.40959444661046, 8.371746780510094, 23.603708816699985, 33.462311542859496, -6.989952257135516, -2.023574991295929, -12.912511849052862, 2.3414129153011984, 36.77846041922278, -33.78907984114755, 13.776905281322913, 9.34683928892675, 1.3525945383883133, 8.725727041147174, -23.1943885081711, -8.463307936471349, 2.998420729314221, 33.63706599154928, 28.178271000339322, 1.8530407689666273, 5.740390230374546, 31.583815154989818, 9.016447704079361, -35.96029659893268, 20.317990023927614, 15.57419036505599, 16.10235930924134, -16.63114897714961, -2.84690841748416, 3.270684888584663, -11.434219281049227, -1.3463909020781797, -3.803311161698895, 44.2342340951783, 52.05343382889758, 27.025719194889085, 46.22406551622193, 23.55253103880471, 13.95684970811671, 16.780495063817263, -7.537050810011436, -0.39264079780495464, -2.4547165084561353, 28.763281041008476, 3.5006856366702834, 9.992249176647153, 5.72484515215611, 11.611071795163676, -14.925017859112174, -17.41954136686513, 11.754037888941003, 25.924567127237694, 6.608118724449753, -33.88916186146434, -10.983083935690836, -10.118817907019398, -6.617686455991651, 27.27118510829078, 34.4619730904397, -0.05879468983709213, -27.7271038849597, 2.331392273319233, 17.890354416422767, -6.190615390323811, 21.480902459301756, 29.89631895107689, 48.50612747064996, 9.1553057832987, -10.152581728541453, -5.952203184562523, -7.815309740075693, 31.173864090374547, -10.25920922342813, 23.248872377217594, -9.876054883281304, -14.06472172765102, -19.54289244631321, -12.236598632731507, 19.855234279422362, -7.974242154479458, -10.211487887177213, 7.561776589616109, -18.880898773761277, 2.7454709138800117, -27.20128849820526, -22.351558983829587, 3.2441478911918615, 17.215254639026924, -20.933503227438653, 33.81978104320153, 20.974861429362832, -23.88091750593032, -15.01470792447535, -22.355230100296005, -29.006199697719584, 20.339537033670332, 13.434581001413632, -22.96923868971976, -18.812532194199015, -16.004718772760768], "policy_adversary_policy_reward": [-25.89329239318785, -38.92589650003315, -12.834095432539279, -3.909398128480909, 0.9638577947307034, -48.171275428130656, -38.78353522672353, -28.141087858995398, 18.163920346016525, -4.184015831745491, 16.03259228366847, -11.985442301076613, 3.4410049079351204, 22.3840187901706, 1.9877585911518096, -6.6705844217542065, -35.18133501660544, -38.375585821840176, 34.55112648435363, 33.02703319794141, 3.4384525880640595, -30.99226315070991, -5.066703289531482, -13.626975288322019, 7.154054068716409, -9.859243145493036, -4.571604119383807, -12.879849962910544, 16.0099295007709, 30.378847515571298, 31.878000805904705, -14.951384932962, -19.523945240037364, 13.527103781408915, -41.095714878092856, -26.17841710500565, -25.308318674986147, -31.048223325692508, -1.186500541554615, -2.519580996378636, -0.4717022305311005, -11.009078230217987, -29.973323867515962, -33.19430644246366, -23.75823395523995, 5.725338547081229, 50.80170750435554, 21.11888569350978, -12.51189582856312, -28.124084219292094, -12.471572317135028, -18.676808412976953, -19.518162340653873, -12.686556277828807, 10.514204281226387, 22.748093673072844, -4.7639516625004035, 10.457768497468725, 9.009133414397613, -15.55050319156694, 2.2166306500467883, 20.651807912051666, 1.0321378214043833, 1.660643982751976, 18.465104083457827, -10.858481760060052, -38.54391580082998, -49.9245523895266, -46.58508379314502, -57.52178386465017, -18.117278076278232, -35.934160313499916, -46.61600529588664, -45.83212573655729, -2.1425632262118306, -44.962498851397605, 0.09564282793831325, -28.00934224417174, -30.972366276877175, -2.588623850757301, 31.038774907278217, -15.964673287255351, -5.243384846983307, 6.028666442593213, -9.471605616204762, 14.381038633117042, -26.883221961567486, -30.64334012044948, -26.32160869614527, 19.320237422804702, -16.40352819016705, -3.580970163127251, -19.421952133450347, 7.972261829138127, 13.15842377772685, -36.380567368054194, 28.1748861760208, 1.6751495422035463, 29.252775081728103, 5.586307652002137, 17.996150463176935, -41.50422624105894, -0.5782966350054295, -51.270837619469916, -35.75844294577169, 22.54220549687219, 30.80818790505173, 36.97013581787693, 17.154969996546473, 4.811197874835202, 9.090269129454114, 11.147366684584686, 8.402785796989253, 4.832587114994048, -4.151514745550067, -50.390855471031514, -24.974279684249268, -43.949666496630165, 23.176486080124146, -23.05889670044997, 25.90688866270908, 29.547319107210313, 14.435758063333745, -19.098542609972213, -14.75362387278134, -21.027084960064194, -0.8128857751543279, 13.19411655580195, -53.7919841582828, 10.830179239679296, -2.615385784451991, -57.177252117701705, -41.80564294656093, -55.20661199473898, -17.647151179437323, -0.6634603871600806, 10.65304100467911, 9.652122452403784, -30.198171472619617, 42.10257784174467, 12.237908410361747, 3.3927110697896374, -40.70909178720591, -21.638636393543187, 16.514098729160835, 4.004319717695429, 0.3632187567682976, -46.86096351120349, 33.564341814202294, -13.812232047639675, 23.03043805796758, 5.099005397334452, 13.876237009341219, 25.209547883285218, 3.235499013739955, 21.237698251723067, -35.08808829658183, -4.622380262262892, 4.8926165258563135, 11.055867783102604, 1.5005152704941143, 18.9224605038603, -37.68611964810349, 22.56256646887128, 12.771434436826524, 24.990363110696038, -18.10348585300218, 12.612544025242155, 27.976182991508757, 26.42639400490176, 29.391589999352394, 15.311527968306764, -7.474508429307857, 0.986212646924109, 15.400143852466499, -49.83065313052033, 15.718043131390644, 26.148963323486647, -25.972105984424154, -41.667456101978864, -23.166589783292785, -18.78313307543288, 21.789707585400187, 25.972127426460467, 10.616086155680946, 19.41332969326976, 14.550621778301004, 30.15983842229101, 30.522914053731473, 27.48948534170762, -49.25650696918875, 8.577432901848077, -50.802284435119844, 23.933122432292567, 18.484744961081113, 27.4537324183584, 26.152141921710744, 11.472922466687283, 30.853276030900034, 1.1561615146215054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45424186585187665, "mean_inference_ms": 1.2216509455257556, "mean_action_processing_ms": 0.19625847551834685, "mean_env_wait_ms": 0.08215609983611155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004320859909057617, "StateBufferConnector_ms": 0.004701852798461914, "ViewRequirementAgentConnector_ms": 0.07785177230834961}, "num_episodes": 10, "episode_return_max": 35.96029659893267, "episode_return_min": -52.053433828897575, "episode_return_mean": -4.075496849010083}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.60095380912105, "num_env_steps_trained_throughput_per_sec": 486.60095380912105, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 8659.053, "restore_workers_time_ms": 0.016, "training_step_time_ms": 8658.938, "sample_time_ms": 876.503, "learn_time_ms": 7768.148, "learn_throughput": 514.923, "synch_weights_time_ms": 13.638}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 76, "trial_id": "83a5c_00000", "date": "2024-08-10_12-25-05", "timestamp": 1723307105, "time_this_iter_s": 8.225758075714111, "time_total_s": 668.1705372333527, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb6be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 668.1705372333527, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 26.591666666666665, "ram_util_percent": 81.73333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.131809144108384, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.050866623530312, "policy_loss": -0.0037338747247491802, "vf_loss": 4.054429942968661, "vf_explained_var": -0.3283236628486997, "kl": 0.004791696890293738, "entropy": 0.5525734301281985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7704766313234965, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9940040978292624, "policy_loss": -0.00230577787006041, "vf_loss": 2.9962509756286937, "vf_explained_var": 0.5576952965309222, "kl": 0.0066190142489446135, "entropy": 0.5848620308873554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "env_runners": {"episode_reward_max": 35.96029659893267, "episode_reward_min": -52.053433828897575, "episode_reward_mean": -3.110563892569761, "episode_len_mean": 380.0, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38000, "policy_reward_min": {"agent_policy": -35.96029659893268, "adversary_policy": -57.52178386465017}, "policy_reward_max": {"agent_policy": 52.05343382889758, "adversary_policy": 52.166527685187084}, "policy_reward_mean": {"agent_policy": 3.1105638925697603, "adversary_policy": -3.110563892569761}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.725727041147174, 23.194388508171105, 8.46330793647136, -2.9984207293142244, -33.63706599154927, -28.17827100033932, -1.8530407689666415, -5.740390230374544, -31.58381515498982, -9.016447704079361, 35.96029659893267, -20.317990023927617, -15.57419036505599, -16.10235930924134, 16.631148977149614, 2.8469084174841597, -3.270684888584663, 11.434219281049229, 1.346390902078178, 3.8033111616988915, -44.23423409517831, -52.053433828897575, -27.02571919488909, -46.224065516221934, -23.552531038804712, -13.956849708116705, -16.780495063817266, 7.537050810011419, 0.39264079780495464, 2.4547165084561353, -28.76328104100848, -3.5006856366702834, -9.992249176647148, -5.724845152156111, -11.611071795163674, 14.925017859112172, 17.419541366865136, -11.754037888941003, -25.924567127237697, -6.608118724449752, 33.889161861464366, 10.983083935690834, 10.118817907019396, 6.6176864559916515, -27.27118510829079, -34.46197309043969, 0.05879468983709213, 27.7271038849597, -2.331392273319233, -17.890354416422767, 6.190615390323811, -21.48090245930175, -29.89631895107682, -48.50612747064995, -9.155305783298703, 10.152581728541447, 5.9522031845625225, 7.815309740075693, -31.173864090374543, 10.259209223428131, -23.24887237721759, 9.876054883281302, 14.06472172765102, 19.542892446313235, 12.236598632731509, -19.855234279422366, 7.974242154479457, 10.211487887177219, -7.561776589616111, 18.880898773761274, -2.745470913880012, 27.201288498205273, 22.351558983829577, -3.2441478911918633, -17.215254639026927, 20.93350322743865, -33.81978104320155, -20.974861429362832, 23.880917505930316, 15.014707924475358, 22.35523010029601, 29.006199697719545, -20.339537033670332, -13.434581001413637, 22.96923868971974, 18.812532194199, 16.00471877276077, -13.736061519320035, 4.514348671069042, -29.51468015322251, -33.53171827220823, 19.510495066189062, -38.323527848836115, 23.806482459230327, -28.450893990651593, 12.760599488114405, 33.61527056610231, 16.505778416146594, 11.44022224385591, 12.168525426352947], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 383, 400, 400, 400, 400, 49, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 273, 400, 400], "policy_agent_policy_reward": [8.725727041147174, -23.1943885081711, -8.463307936471349, 2.998420729314221, 33.63706599154928, 28.178271000339322, 1.8530407689666273, 5.740390230374546, 31.583815154989818, 9.016447704079361, -35.96029659893268, 20.317990023927614, 15.57419036505599, 16.10235930924134, -16.63114897714961, -2.84690841748416, 3.270684888584663, -11.434219281049227, -1.3463909020781797, -3.803311161698895, 44.2342340951783, 52.05343382889758, 27.025719194889085, 46.22406551622193, 23.55253103880471, 13.95684970811671, 16.780495063817263, -7.537050810011436, -0.39264079780495464, -2.4547165084561353, 28.763281041008476, 3.5006856366702834, 9.992249176647153, 5.72484515215611, 11.611071795163676, -14.925017859112174, -17.41954136686513, 11.754037888941003, 25.924567127237694, 6.608118724449753, -33.88916186146434, -10.983083935690836, -10.118817907019398, -6.617686455991651, 27.27118510829078, 34.4619730904397, -0.05879468983709213, -27.7271038849597, 2.331392273319233, 17.890354416422767, -6.190615390323811, 21.480902459301756, 29.89631895107689, 48.50612747064996, 9.1553057832987, -10.152581728541453, -5.952203184562523, -7.815309740075693, 31.173864090374547, -10.25920922342813, 23.248872377217594, -9.876054883281304, -14.06472172765102, -19.54289244631321, -12.236598632731507, 19.855234279422362, -7.974242154479458, -10.211487887177213, 7.561776589616109, -18.880898773761277, 2.7454709138800117, -27.20128849820526, -22.351558983829587, 3.2441478911918615, 17.215254639026924, -20.933503227438653, 33.81978104320153, 20.974861429362832, -23.88091750593032, -15.01470792447535, -22.355230100296005, -29.006199697719584, 20.339537033670332, 13.434581001413632, -22.96923868971976, -18.812532194199015, -16.004718772760768, 13.736061519320037, -4.514348671069041, 29.51468015322251, 33.53171827220823, -19.51049506618907, 38.32352784883611, -23.806482459230352, 28.450893990651593, -12.760599488114405, -33.6152705661023, -16.505778416146594, -11.440222243855914, -12.168525426352941], "policy_adversary_policy_reward": [-4.571604119383807, -12.879849962910544, 16.0099295007709, 30.378847515571298, 31.878000805904705, -14.951384932962, -19.523945240037364, 13.527103781408915, -41.095714878092856, -26.17841710500565, -25.308318674986147, -31.048223325692508, -1.186500541554615, -2.519580996378636, -0.4717022305311005, -11.009078230217987, -29.973323867515962, -33.19430644246366, -23.75823395523995, 5.725338547081229, 50.80170750435554, 21.11888569350978, -12.51189582856312, -28.124084219292094, -12.471572317135028, -18.676808412976953, -19.518162340653873, -12.686556277828807, 10.514204281226387, 22.748093673072844, -4.7639516625004035, 10.457768497468725, 9.009133414397613, -15.55050319156694, 2.2166306500467883, 20.651807912051666, 1.0321378214043833, 1.660643982751976, 18.465104083457827, -10.858481760060052, -38.54391580082998, -49.9245523895266, -46.58508379314502, -57.52178386465017, -18.117278076278232, -35.934160313499916, -46.61600529588664, -45.83212573655729, -2.1425632262118306, -44.962498851397605, 0.09564282793831325, -28.00934224417174, -30.972366276877175, -2.588623850757301, 31.038774907278217, -15.964673287255351, -5.243384846983307, 6.028666442593213, -9.471605616204762, 14.381038633117042, -26.883221961567486, -30.64334012044948, -26.32160869614527, 19.320237422804702, -16.40352819016705, -3.580970163127251, -19.421952133450347, 7.972261829138127, 13.15842377772685, -36.380567368054194, 28.1748861760208, 1.6751495422035463, 29.252775081728103, 5.586307652002137, 17.996150463176935, -41.50422624105894, -0.5782966350054295, -51.270837619469916, -35.75844294577169, 22.54220549687219, 30.80818790505173, 36.97013581787693, 17.154969996546473, 4.811197874835202, 9.090269129454114, 11.147366684584686, 8.402785796989253, 4.832587114994048, -4.151514745550067, -50.390855471031514, -24.974279684249268, -43.949666496630165, 23.176486080124146, -23.05889670044997, 25.90688866270908, 29.547319107210313, 14.435758063333745, -19.098542609972213, -14.75362387278134, -21.027084960064194, -0.8128857751543279, 13.19411655580195, -53.7919841582828, 10.830179239679296, -2.615385784451991, -57.177252117701705, -41.80564294656093, -55.20661199473898, -17.647151179437323, -0.6634603871600806, 10.65304100467911, 9.652122452403784, -30.198171472619617, 42.10257784174467, 12.237908410361747, 3.3927110697896374, -40.70909178720591, -21.638636393543187, 16.514098729160835, 4.004319717695429, 0.3632187567682976, -46.86096351120349, 33.564341814202294, -13.812232047639675, 23.03043805796758, 5.099005397334452, 13.876237009341219, 25.209547883285218, 3.235499013739955, 21.237698251723067, -35.08808829658183, -4.622380262262892, 4.8926165258563135, 11.055867783102604, 1.5005152704941143, 18.9224605038603, -37.68611964810349, 22.56256646887128, 12.771434436826524, 24.990363110696038, -18.10348585300218, 12.612544025242155, 27.976182991508757, 26.42639400490176, 29.391589999352394, 15.311527968306764, -7.474508429307857, 0.986212646924109, 15.400143852466499, -49.83065313052033, 15.718043131390644, 26.148963323486647, -25.972105984424154, -41.667456101978864, -23.166589783292785, -18.78313307543288, 21.789707585400187, 25.972127426460467, 10.616086155680946, 19.41332969326976, 14.550621778301004, 30.15983842229101, 30.522914053731473, 27.48948534170762, -49.25650696918875, 8.577432901848077, -50.802284435119844, 23.933122432292567, 18.484744961081113, 27.4537324183584, 26.152141921710744, 11.472922466687283, 30.853276030900034, 1.1561615146215054, -39.35733477293261, 11.885211734292529, 3.4574191170333153, 5.571278225104769, -42.42937385426278, -16.599986452182243, -30.339891714606566, -36.723544829809896, 24.38355797622904, 14.637432156149089, -37.42404536058945, -39.22301033708276, 22.11945132369667, 25.493513594764064, -16.33392911684261, -40.567858864460575, -12.028145039128276, 37.549344015357086, 52.166527685187084, 15.06401344701759, -4.588561599889408, 37.600118432182576, 20.078850694119673, 2.801593793592156, 10.955498096576697, 13.381552756129192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45392020794475946, "mean_inference_ms": 1.2202163783976505, "mean_action_processing_ms": 0.19607565491846135, "mean_env_wait_ms": 0.08208959115876083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004037022590637207, "StateBufferConnector_ms": 0.003138422966003418, "ViewRequirementAgentConnector_ms": 0.07499420642852783}, "num_episodes": 13, "episode_return_max": 35.96029659893267, "episode_return_min": -52.053433828897575, "episode_return_mean": -3.110563892569761}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.2096578069746, "num_env_steps_trained_throughput_per_sec": 500.2096578069746, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 924000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 8570.259, "restore_workers_time_ms": 0.016, "training_step_time_ms": 8570.146, "sample_time_ms": 866.166, "learn_time_ms": 7689.479, "learn_throughput": 520.191, "synch_weights_time_ms": 13.803}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "training_iteration": 77, "trial_id": "83a5c_00000", "date": "2024-08-10_12-25-13", "timestamp": 1723307113, "time_this_iter_s": 8.002275228500366, "time_total_s": 676.172812461853, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a6310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 676.172812461853, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 26.318181818181817, "ram_util_percent": 81.55454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1605366813442695, "cur_kl_coeff": 0.01779785156249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.974195938766318, "policy_loss": -0.00587445688261478, "vf_loss": 3.979957100827858, "vf_explained_var": 0.008436315967923118, "kl": 0.006365652644506653, "entropy": 0.5012617138485429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.929350340086967, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.539252842217684, "policy_loss": -0.012868629369525783, "vf_loss": 2.552019839733839, "vf_explained_var": 0.3643736980234583, "kl": 0.011420260841494596, "entropy": 0.5558294161533316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": 33.889161861464366, "episode_reward_min": -52.053433828897575, "episode_reward_mean": -3.0488592023473817, "episode_len_mean": 369.47, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 36947, "policy_reward_min": {"agent_policy": -33.88916186146434, "adversary_policy": -57.52178386465017}, "policy_reward_max": {"agent_policy": 52.05343382889758, "adversary_policy": 52.166527685187084}, "policy_reward_mean": {"agent_policy": 3.048859202347383, "adversary_policy": -3.048859202347383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.631148977149614, 2.8469084174841597, -3.270684888584663, 11.434219281049229, 1.346390902078178, 3.8033111616988915, -44.23423409517831, -52.053433828897575, -27.02571919488909, -46.224065516221934, -23.552531038804712, -13.956849708116705, -16.780495063817266, 7.537050810011419, 0.39264079780495464, 2.4547165084561353, -28.76328104100848, -3.5006856366702834, -9.992249176647148, -5.724845152156111, -11.611071795163674, 14.925017859112172, 17.419541366865136, -11.754037888941003, -25.924567127237697, -6.608118724449752, 33.889161861464366, 10.983083935690834, 10.118817907019396, 6.6176864559916515, -27.27118510829079, -34.46197309043969, 0.05879468983709213, 27.7271038849597, -2.331392273319233, -17.890354416422767, 6.190615390323811, -21.48090245930175, -29.89631895107682, -48.50612747064995, -9.155305783298703, 10.152581728541447, 5.9522031845625225, 7.815309740075693, -31.173864090374543, 10.259209223428131, -23.24887237721759, 9.876054883281302, 14.06472172765102, 19.542892446313235, 12.236598632731509, -19.855234279422366, 7.974242154479457, 10.211487887177219, -7.561776589616111, 18.880898773761274, -2.745470913880012, 27.201288498205273, 22.351558983829577, -3.2441478911918633, -17.215254639026927, 20.93350322743865, -33.81978104320155, -20.974861429362832, 23.880917505930316, 15.014707924475358, 22.35523010029601, 29.006199697719545, -20.339537033670332, -13.434581001413637, 22.96923868971974, 18.812532194199, 16.00471877276077, -13.736061519320035, 4.514348671069042, -29.51468015322251, -33.53171827220823, 19.510495066189062, -38.323527848836115, 23.806482459230327, -28.450893990651593, 12.760599488114405, 33.61527056610231, 16.505778416146594, 11.44022224385591, 12.168525426352947, 9.213918493476415, 24.198833240277935, -18.9646300738758, -46.90077273755174, 9.832852033427711, -21.84181090201774, 11.25722778994232, -49.53910943493046, -24.83128846185686, -42.64827727863122, 6.308922752454167, 25.01306522879876, 9.040116271282608, 9.92169682603156], "episode_lengths": [400, 49, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 273, 400, 400, 28, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 82, 387], "policy_agent_policy_reward": [-16.63114897714961, -2.84690841748416, 3.270684888584663, -11.434219281049227, -1.3463909020781797, -3.803311161698895, 44.2342340951783, 52.05343382889758, 27.025719194889085, 46.22406551622193, 23.55253103880471, 13.95684970811671, 16.780495063817263, -7.537050810011436, -0.39264079780495464, -2.4547165084561353, 28.763281041008476, 3.5006856366702834, 9.992249176647153, 5.72484515215611, 11.611071795163676, -14.925017859112174, -17.41954136686513, 11.754037888941003, 25.924567127237694, 6.608118724449753, -33.88916186146434, -10.983083935690836, -10.118817907019398, -6.617686455991651, 27.27118510829078, 34.4619730904397, -0.05879468983709213, -27.7271038849597, 2.331392273319233, 17.890354416422767, -6.190615390323811, 21.480902459301756, 29.89631895107689, 48.50612747064996, 9.1553057832987, -10.152581728541453, -5.952203184562523, -7.815309740075693, 31.173864090374547, -10.25920922342813, 23.248872377217594, -9.876054883281304, -14.06472172765102, -19.54289244631321, -12.236598632731507, 19.855234279422362, -7.974242154479458, -10.211487887177213, 7.561776589616109, -18.880898773761277, 2.7454709138800117, -27.20128849820526, -22.351558983829587, 3.2441478911918615, 17.215254639026924, -20.933503227438653, 33.81978104320153, 20.974861429362832, -23.88091750593032, -15.01470792447535, -22.355230100296005, -29.006199697719584, 20.339537033670332, 13.434581001413632, -22.96923868971976, -18.812532194199015, -16.004718772760768, 13.736061519320037, -4.514348671069041, 29.51468015322251, 33.53171827220823, -19.51049506618907, 38.32352784883611, -23.806482459230352, 28.450893990651593, -12.760599488114405, -33.6152705661023, -16.505778416146594, -11.440222243855914, -12.168525426352941, -9.213918493476417, -24.19883324027792, 18.9646300738758, 46.90077273755175, -9.83285203342771, 21.84181090201774, -11.257227789942315, 49.53910943493045, 24.83128846185686, 42.64827727863123, -6.308922752454168, -25.013065228798773, -9.040116271282606, -9.921696826031559], "policy_adversary_policy_reward": [10.514204281226387, 22.748093673072844, -4.7639516625004035, 10.457768497468725, 9.009133414397613, -15.55050319156694, 2.2166306500467883, 20.651807912051666, 1.0321378214043833, 1.660643982751976, 18.465104083457827, -10.858481760060052, -38.54391580082998, -49.9245523895266, -46.58508379314502, -57.52178386465017, -18.117278076278232, -35.934160313499916, -46.61600529588664, -45.83212573655729, -2.1425632262118306, -44.962498851397605, 0.09564282793831325, -28.00934224417174, -30.972366276877175, -2.588623850757301, 31.038774907278217, -15.964673287255351, -5.243384846983307, 6.028666442593213, -9.471605616204762, 14.381038633117042, -26.883221961567486, -30.64334012044948, -26.32160869614527, 19.320237422804702, -16.40352819016705, -3.580970163127251, -19.421952133450347, 7.972261829138127, 13.15842377772685, -36.380567368054194, 28.1748861760208, 1.6751495422035463, 29.252775081728103, 5.586307652002137, 17.996150463176935, -41.50422624105894, -0.5782966350054295, -51.270837619469916, -35.75844294577169, 22.54220549687219, 30.80818790505173, 36.97013581787693, 17.154969996546473, 4.811197874835202, 9.090269129454114, 11.147366684584686, 8.402785796989253, 4.832587114994048, -4.151514745550067, -50.390855471031514, -24.974279684249268, -43.949666496630165, 23.176486080124146, -23.05889670044997, 25.90688866270908, 29.547319107210313, 14.435758063333745, -19.098542609972213, -14.75362387278134, -21.027084960064194, -0.8128857751543279, 13.19411655580195, -53.7919841582828, 10.830179239679296, -2.615385784451991, -57.177252117701705, -41.80564294656093, -55.20661199473898, -17.647151179437323, -0.6634603871600806, 10.65304100467911, 9.652122452403784, -30.198171472619617, 42.10257784174467, 12.237908410361747, 3.3927110697896374, -40.70909178720591, -21.638636393543187, 16.514098729160835, 4.004319717695429, 0.3632187567682976, -46.86096351120349, 33.564341814202294, -13.812232047639675, 23.03043805796758, 5.099005397334452, 13.876237009341219, 25.209547883285218, 3.235499013739955, 21.237698251723067, -35.08808829658183, -4.622380262262892, 4.8926165258563135, 11.055867783102604, 1.5005152704941143, 18.9224605038603, -37.68611964810349, 22.56256646887128, 12.771434436826524, 24.990363110696038, -18.10348585300218, 12.612544025242155, 27.976182991508757, 26.42639400490176, 29.391589999352394, 15.311527968306764, -7.474508429307857, 0.986212646924109, 15.400143852466499, -49.83065313052033, 15.718043131390644, 26.148963323486647, -25.972105984424154, -41.667456101978864, -23.166589783292785, -18.78313307543288, 21.789707585400187, 25.972127426460467, 10.616086155680946, 19.41332969326976, 14.550621778301004, 30.15983842229101, 30.522914053731473, 27.48948534170762, -49.25650696918875, 8.577432901848077, -50.802284435119844, 23.933122432292567, 18.484744961081113, 27.4537324183584, 26.152141921710744, 11.472922466687283, 30.853276030900034, 1.1561615146215054, -39.35733477293261, 11.885211734292529, 3.4574191170333153, 5.571278225104769, -42.42937385426278, -16.599986452182243, -30.339891714606566, -36.723544829809896, 24.38355797622904, 14.637432156149089, -37.42404536058945, -39.22301033708276, 22.11945132369667, 25.493513594764064, -16.33392911684261, -40.567858864460575, -12.028145039128276, 37.549344015357086, 52.166527685187084, 15.06401344701759, -4.588561599889408, 37.600118432182576, 20.078850694119673, 2.801593793592156, 10.955498096576697, 13.381552756129192, 9.269278668256092, 9.158558318696743, 13.845065298914044, 34.55260118164181, -17.475600808250633, -20.453659339500962, -41.88043159456177, -51.92111388054176, 4.452132496370773, 15.21357157048465, -13.331149119944165, -30.352472684091317, -2.9763464108323454, 25.490801990716978, -46.13709813232458, -52.94112073753635, -29.1100423452473, -20.55253457846642, -48.65262160468291, -36.64393295257956, 14.493859132194892, -1.8760136272865502, 34.39952150054997, 15.626608957047585, 4.5060963679853465, 13.574136174579866, 16.01104924450622, 3.8323444075568975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45329387257638254, "mean_inference_ms": 1.2181276194874773, "mean_action_processing_ms": 0.19565512676803004, "mean_env_wait_ms": 0.08195753312457114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004001736640930176, "StateBufferConnector_ms": 0.0030978918075561523, "ViewRequirementAgentConnector_ms": 0.0729217529296875}, "num_episodes": 14, "episode_return_max": 33.889161861464366, "episode_return_min": -52.053433828897575, "episode_return_mean": -3.0488592023473817}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.155404347967, "num_env_steps_trained_throughput_per_sec": 492.155404347967, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 8508.449, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8508.335, "sample_time_ms": 855.221, "learn_time_ms": 7638.766, "learn_throughput": 523.645, "synch_weights_time_ms": 13.65}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 78, "trial_id": "83a5c_00000", "date": "2024-08-10_12-25-21", "timestamp": 1723307121, "time_this_iter_s": 8.132114887237549, "time_total_s": 684.3049273490906, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fae5a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 684.3049273490906, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 28.075, "ram_util_percent": 81.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.273390958233485, "cur_kl_coeff": 0.01779785156249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4366260825010833, "policy_loss": -0.0054531376050026325, "vf_loss": 3.441954118864877, "vf_explained_var": -0.19917748270842134, "kl": 0.007028728785146433, "entropy": 0.5414342342861115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.165121607389301, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8251569596429666, "policy_loss": -0.004691349721785324, "vf_loss": 2.8297462354103726, "vf_explained_var": 0.5701167096694311, "kl": 0.011470847272412524, "entropy": 0.4325335874222219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "env_runners": {"episode_reward_max": 36.22975274774386, "episode_reward_min": -49.53910943493046, "episode_reward_mean": -1.9881199286527687, "episode_len_mean": 372.55, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37255, "policy_reward_min": {"agent_policy": -36.229752747743895, "adversary_policy": -57.177252117701705}, "policy_reward_max": {"agent_policy": 49.53910943493045, "adversary_policy": 52.166527685187084}, "policy_reward_mean": {"agent_policy": 1.9881199286527684, "adversary_policy": -1.9881199286527678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.224065516221934, -23.552531038804712, -13.956849708116705, -16.780495063817266, 7.537050810011419, 0.39264079780495464, 2.4547165084561353, -28.76328104100848, -3.5006856366702834, -9.992249176647148, -5.724845152156111, -11.611071795163674, 14.925017859112172, 17.419541366865136, -11.754037888941003, -25.924567127237697, -6.608118724449752, 33.889161861464366, 10.983083935690834, 10.118817907019396, 6.6176864559916515, -27.27118510829079, -34.46197309043969, 0.05879468983709213, 27.7271038849597, -2.331392273319233, -17.890354416422767, 6.190615390323811, -21.48090245930175, -29.89631895107682, -48.50612747064995, -9.155305783298703, 10.152581728541447, 5.9522031845625225, 7.815309740075693, -31.173864090374543, 10.259209223428131, -23.24887237721759, 9.876054883281302, 14.06472172765102, 19.542892446313235, 12.236598632731509, -19.855234279422366, 7.974242154479457, 10.211487887177219, -7.561776589616111, 18.880898773761274, -2.745470913880012, 27.201288498205273, 22.351558983829577, -3.2441478911918633, -17.215254639026927, 20.93350322743865, -33.81978104320155, -20.974861429362832, 23.880917505930316, 15.014707924475358, 22.35523010029601, 29.006199697719545, -20.339537033670332, -13.434581001413637, 22.96923868971974, 18.812532194199, 16.00471877276077, -13.736061519320035, 4.514348671069042, -29.51468015322251, -33.53171827220823, 19.510495066189062, -38.323527848836115, 23.806482459230327, -28.450893990651593, 12.760599488114405, 33.61527056610231, 16.505778416146594, 11.44022224385591, 12.168525426352947, 9.213918493476415, 24.198833240277935, -18.9646300738758, -46.90077273755174, 9.832852033427711, -21.84181090201774, 11.25722778994232, -49.53910943493046, -24.83128846185686, -42.64827727863122, 6.308922752454167, 25.01306522879876, 9.040116271282608, 9.92169682603156, -3.4017194082911653, 8.023029473464963, 36.22975274774386, -12.04884837325999, -45.76597445070472, 12.371501767737382, 31.882214323463007, 29.587283628100653, -41.32540560688212], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 273, 400, 400, 28, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 82, 387, 400, 400, 361, 400, 400, 400, 400, 396, 400], "policy_agent_policy_reward": [46.22406551622193, 23.55253103880471, 13.95684970811671, 16.780495063817263, -7.537050810011436, -0.39264079780495464, -2.4547165084561353, 28.763281041008476, 3.5006856366702834, 9.992249176647153, 5.72484515215611, 11.611071795163676, -14.925017859112174, -17.41954136686513, 11.754037888941003, 25.924567127237694, 6.608118724449753, -33.88916186146434, -10.983083935690836, -10.118817907019398, -6.617686455991651, 27.27118510829078, 34.4619730904397, -0.05879468983709213, -27.7271038849597, 2.331392273319233, 17.890354416422767, -6.190615390323811, 21.480902459301756, 29.89631895107689, 48.50612747064996, 9.1553057832987, -10.152581728541453, -5.952203184562523, -7.815309740075693, 31.173864090374547, -10.25920922342813, 23.248872377217594, -9.876054883281304, -14.06472172765102, -19.54289244631321, -12.236598632731507, 19.855234279422362, -7.974242154479458, -10.211487887177213, 7.561776589616109, -18.880898773761277, 2.7454709138800117, -27.20128849820526, -22.351558983829587, 3.2441478911918615, 17.215254639026924, -20.933503227438653, 33.81978104320153, 20.974861429362832, -23.88091750593032, -15.01470792447535, -22.355230100296005, -29.006199697719584, 20.339537033670332, 13.434581001413632, -22.96923868971976, -18.812532194199015, -16.004718772760768, 13.736061519320037, -4.514348671069041, 29.51468015322251, 33.53171827220823, -19.51049506618907, 38.32352784883611, -23.806482459230352, 28.450893990651593, -12.760599488114405, -33.6152705661023, -16.505778416146594, -11.440222243855914, -12.168525426352941, -9.213918493476417, -24.19883324027792, 18.9646300738758, 46.90077273755175, -9.83285203342771, 21.84181090201774, -11.257227789942315, 49.53910943493045, 24.83128846185686, 42.64827727863123, -6.308922752454168, -25.013065228798773, -9.040116271282606, -9.921696826031559, 3.4017194082911626, -8.023029473464963, -36.229752747743895, 12.048848373259988, 45.76597445070471, -12.371501767737385, -31.882214323463007, -29.587283628100675, 41.32540560688213], "policy_adversary_policy_reward": [-46.61600529588664, -45.83212573655729, -2.1425632262118306, -44.962498851397605, 0.09564282793831325, -28.00934224417174, -30.972366276877175, -2.588623850757301, 31.038774907278217, -15.964673287255351, -5.243384846983307, 6.028666442593213, -9.471605616204762, 14.381038633117042, -26.883221961567486, -30.64334012044948, -26.32160869614527, 19.320237422804702, -16.40352819016705, -3.580970163127251, -19.421952133450347, 7.972261829138127, 13.15842377772685, -36.380567368054194, 28.1748861760208, 1.6751495422035463, 29.252775081728103, 5.586307652002137, 17.996150463176935, -41.50422624105894, -0.5782966350054295, -51.270837619469916, -35.75844294577169, 22.54220549687219, 30.80818790505173, 36.97013581787693, 17.154969996546473, 4.811197874835202, 9.090269129454114, 11.147366684584686, 8.402785796989253, 4.832587114994048, -4.151514745550067, -50.390855471031514, -24.974279684249268, -43.949666496630165, 23.176486080124146, -23.05889670044997, 25.90688866270908, 29.547319107210313, 14.435758063333745, -19.098542609972213, -14.75362387278134, -21.027084960064194, -0.8128857751543279, 13.19411655580195, -53.7919841582828, 10.830179239679296, -2.615385784451991, -57.177252117701705, -41.80564294656093, -55.20661199473898, -17.647151179437323, -0.6634603871600806, 10.65304100467911, 9.652122452403784, -30.198171472619617, 42.10257784174467, 12.237908410361747, 3.3927110697896374, -40.70909178720591, -21.638636393543187, 16.514098729160835, 4.004319717695429, 0.3632187567682976, -46.86096351120349, 33.564341814202294, -13.812232047639675, 23.03043805796758, 5.099005397334452, 13.876237009341219, 25.209547883285218, 3.235499013739955, 21.237698251723067, -35.08808829658183, -4.622380262262892, 4.8926165258563135, 11.055867783102604, 1.5005152704941143, 18.9224605038603, -37.68611964810349, 22.56256646887128, 12.771434436826524, 24.990363110696038, -18.10348585300218, 12.612544025242155, 27.976182991508757, 26.42639400490176, 29.391589999352394, 15.311527968306764, -7.474508429307857, 0.986212646924109, 15.400143852466499, -49.83065313052033, 15.718043131390644, 26.148963323486647, -25.972105984424154, -41.667456101978864, -23.166589783292785, -18.78313307543288, 21.789707585400187, 25.972127426460467, 10.616086155680946, 19.41332969326976, 14.550621778301004, 30.15983842229101, 30.522914053731473, 27.48948534170762, -49.25650696918875, 8.577432901848077, -50.802284435119844, 23.933122432292567, 18.484744961081113, 27.4537324183584, 26.152141921710744, 11.472922466687283, 30.853276030900034, 1.1561615146215054, -39.35733477293261, 11.885211734292529, 3.4574191170333153, 5.571278225104769, -42.42937385426278, -16.599986452182243, -30.339891714606566, -36.723544829809896, 24.38355797622904, 14.637432156149089, -37.42404536058945, -39.22301033708276, 22.11945132369667, 25.493513594764064, -16.33392911684261, -40.567858864460575, -12.028145039128276, 37.549344015357086, 52.166527685187084, 15.06401344701759, -4.588561599889408, 37.600118432182576, 20.078850694119673, 2.801593793592156, 10.955498096576697, 13.381552756129192, 9.269278668256092, 9.158558318696743, 13.845065298914044, 34.55260118164181, -17.475600808250633, -20.453659339500962, -41.88043159456177, -51.92111388054176, 4.452132496370773, 15.21357157048465, -13.331149119944165, -30.352472684091317, -2.9763464108323454, 25.490801990716978, -46.13709813232458, -52.94112073753635, -29.1100423452473, -20.55253457846642, -48.65262160468291, -36.64393295257956, 14.493859132194892, -1.8760136272865502, 34.39952150054997, 15.626608957047585, 4.5060963679853465, 13.574136174579866, 16.01104924450622, 3.8323444075568975, -33.629517426760685, 26.826078610178353, -7.656429752955333, 23.702488699885258, 38.46337853884191, 33.99612695664586, 7.650576697169701, -31.74827344368967, -50.83776515725999, -40.694183744149356, 7.844051719619668, 16.898951815855096, 44.530312179148076, 19.234116467777945, 28.32584051310147, 30.84872674309988, -40.78733358867024, -41.863477625094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4529485833947557, "mean_inference_ms": 1.2169832439884747, "mean_action_processing_ms": 0.19552741006904475, "mean_env_wait_ms": 0.081913161841364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003907561302185059, "StateBufferConnector_ms": 0.0030090808868408203, "ViewRequirementAgentConnector_ms": 0.07159364223480225}, "num_episodes": 9, "episode_return_max": 36.22975274774386, "episode_return_min": -49.53910943493046, "episode_return_mean": -1.9881199286527687}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.72336172278125, "num_env_steps_trained_throughput_per_sec": 480.72336172278125, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 948000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 8456.223, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8456.111, "sample_time_ms": 863.232, "learn_time_ms": 7578.177, "learn_throughput": 527.831, "synch_weights_time_ms": 13.99}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "training_iteration": 79, "trial_id": "83a5c_00000", "date": "2024-08-10_12-25-29", "timestamp": 1723307129, "time_this_iter_s": 8.326236724853516, "time_total_s": 692.6311640739441, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f580ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 692.6311640739441, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 28.200000000000003, "ram_util_percent": 81.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.657564691702525, "cur_kl_coeff": 0.01779785156249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.800430062712816, "policy_loss": -0.005162884961449043, "vf_loss": 3.8054491063274405, "vf_explained_var": -0.33959707797519745, "kl": 0.00808261691369567, "entropy": 0.47134396547362917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0967995441829164, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.678972794612249, "policy_loss": -0.0025399792337945353, "vf_loss": 2.68142733934025, "vf_explained_var": 0.6647293452173472, "kl": 0.00959992962415147, "entropy": 0.4926713155272106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 36.22975274774386, "episode_reward_min": -49.53910943493046, "episode_reward_mean": -0.6474813686760689, "episode_len_mean": 370.23, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37023, "policy_reward_min": {"agent_policy": -36.229752747743895, "adversary_policy": -57.177252117701705}, "policy_reward_max": {"agent_policy": 49.53910943493045, "adversary_policy": 52.166527685187084}, "policy_reward_mean": {"agent_policy": 0.647481368676068, "adversary_policy": -0.6474813686760683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.992249176647148, -5.724845152156111, -11.611071795163674, 14.925017859112172, 17.419541366865136, -11.754037888941003, -25.924567127237697, -6.608118724449752, 33.889161861464366, 10.983083935690834, 10.118817907019396, 6.6176864559916515, -27.27118510829079, -34.46197309043969, 0.05879468983709213, 27.7271038849597, -2.331392273319233, -17.890354416422767, 6.190615390323811, -21.48090245930175, -29.89631895107682, -48.50612747064995, -9.155305783298703, 10.152581728541447, 5.9522031845625225, 7.815309740075693, -31.173864090374543, 10.259209223428131, -23.24887237721759, 9.876054883281302, 14.06472172765102, 19.542892446313235, 12.236598632731509, -19.855234279422366, 7.974242154479457, 10.211487887177219, -7.561776589616111, 18.880898773761274, -2.745470913880012, 27.201288498205273, 22.351558983829577, -3.2441478911918633, -17.215254639026927, 20.93350322743865, -33.81978104320155, -20.974861429362832, 23.880917505930316, 15.014707924475358, 22.35523010029601, 29.006199697719545, -20.339537033670332, -13.434581001413637, 22.96923868971974, 18.812532194199, 16.00471877276077, -13.736061519320035, 4.514348671069042, -29.51468015322251, -33.53171827220823, 19.510495066189062, -38.323527848836115, 23.806482459230327, -28.450893990651593, 12.760599488114405, 33.61527056610231, 16.505778416146594, 11.44022224385591, 12.168525426352947, 9.213918493476415, 24.198833240277935, -18.9646300738758, -46.90077273755174, 9.832852033427711, -21.84181090201774, 11.25722778994232, -49.53910943493046, -24.83128846185686, -42.64827727863122, 6.308922752454167, 25.01306522879876, 9.040116271282608, 9.92169682603156, -3.4017194082911653, 8.023029473464963, 36.22975274774386, -12.04884837325999, -45.76597445070472, 12.371501767737382, 31.882214323463007, 29.587283628100653, -41.32540560688212, -27.418302768196074, 18.51854179683606, 23.912108604703686, -29.342364986469583, -43.02293543740614, 6.512114537695189, 30.499657704882154, 10.224789715799602, 21.786746941458226], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 11, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 273, 400, 400, 28, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 82, 387, 400, 400, 361, 400, 400, 400, 400, 396, 400, 400, 400, 400, 400, 400, 400, 400, 168, 400], "policy_agent_policy_reward": [9.992249176647153, 5.72484515215611, 11.611071795163676, -14.925017859112174, -17.41954136686513, 11.754037888941003, 25.924567127237694, 6.608118724449753, -33.88916186146434, -10.983083935690836, -10.118817907019398, -6.617686455991651, 27.27118510829078, 34.4619730904397, -0.05879468983709213, -27.7271038849597, 2.331392273319233, 17.890354416422767, -6.190615390323811, 21.480902459301756, 29.89631895107689, 48.50612747064996, 9.1553057832987, -10.152581728541453, -5.952203184562523, -7.815309740075693, 31.173864090374547, -10.25920922342813, 23.248872377217594, -9.876054883281304, -14.06472172765102, -19.54289244631321, -12.236598632731507, 19.855234279422362, -7.974242154479458, -10.211487887177213, 7.561776589616109, -18.880898773761277, 2.7454709138800117, -27.20128849820526, -22.351558983829587, 3.2441478911918615, 17.215254639026924, -20.933503227438653, 33.81978104320153, 20.974861429362832, -23.88091750593032, -15.01470792447535, -22.355230100296005, -29.006199697719584, 20.339537033670332, 13.434581001413632, -22.96923868971976, -18.812532194199015, -16.004718772760768, 13.736061519320037, -4.514348671069041, 29.51468015322251, 33.53171827220823, -19.51049506618907, 38.32352784883611, -23.806482459230352, 28.450893990651593, -12.760599488114405, -33.6152705661023, -16.505778416146594, -11.440222243855914, -12.168525426352941, -9.213918493476417, -24.19883324027792, 18.9646300738758, 46.90077273755175, -9.83285203342771, 21.84181090201774, -11.257227789942315, 49.53910943493045, 24.83128846185686, 42.64827727863123, -6.308922752454168, -25.013065228798773, -9.040116271282606, -9.921696826031559, 3.4017194082911626, -8.023029473464963, -36.229752747743895, 12.048848373259988, 45.76597445070471, -12.371501767737385, -31.882214323463007, -29.587283628100675, 41.32540560688213, 27.418302768196074, -18.518541796836054, -23.91210860470369, 29.342364986469583, 43.02293543740613, -6.51211453769519, -30.49965770488215, -10.224789715799606, -21.78674694145824], "policy_adversary_policy_reward": [-16.40352819016705, -3.580970163127251, -19.421952133450347, 7.972261829138127, 13.15842377772685, -36.380567368054194, 28.1748861760208, 1.6751495422035463, 29.252775081728103, 5.586307652002137, 17.996150463176935, -41.50422624105894, -0.5782966350054295, -51.270837619469916, -35.75844294577169, 22.54220549687219, 30.80818790505173, 36.97013581787693, 17.154969996546473, 4.811197874835202, 9.090269129454114, 11.147366684584686, 8.402785796989253, 4.832587114994048, -4.151514745550067, -50.390855471031514, -24.974279684249268, -43.949666496630165, 23.176486080124146, -23.05889670044997, 25.90688866270908, 29.547319107210313, 14.435758063333745, -19.098542609972213, -14.75362387278134, -21.027084960064194, -0.8128857751543279, 13.19411655580195, -53.7919841582828, 10.830179239679296, -2.615385784451991, -57.177252117701705, -41.80564294656093, -55.20661199473898, -17.647151179437323, -0.6634603871600806, 10.65304100467911, 9.652122452403784, -30.198171472619617, 42.10257784174467, 12.237908410361747, 3.3927110697896374, -40.70909178720591, -21.638636393543187, 16.514098729160835, 4.004319717695429, 0.3632187567682976, -46.86096351120349, 33.564341814202294, -13.812232047639675, 23.03043805796758, 5.099005397334452, 13.876237009341219, 25.209547883285218, 3.235499013739955, 21.237698251723067, -35.08808829658183, -4.622380262262892, 4.8926165258563135, 11.055867783102604, 1.5005152704941143, 18.9224605038603, -37.68611964810349, 22.56256646887128, 12.771434436826524, 24.990363110696038, -18.10348585300218, 12.612544025242155, 27.976182991508757, 26.42639400490176, 29.391589999352394, 15.311527968306764, -7.474508429307857, 0.986212646924109, 15.400143852466499, -49.83065313052033, 15.718043131390644, 26.148963323486647, -25.972105984424154, -41.667456101978864, -23.166589783292785, -18.78313307543288, 21.789707585400187, 25.972127426460467, 10.616086155680946, 19.41332969326976, 14.550621778301004, 30.15983842229101, 30.522914053731473, 27.48948534170762, -49.25650696918875, 8.577432901848077, -50.802284435119844, 23.933122432292567, 18.484744961081113, 27.4537324183584, 26.152141921710744, 11.472922466687283, 30.853276030900034, 1.1561615146215054, -39.35733477293261, 11.885211734292529, 3.4574191170333153, 5.571278225104769, -42.42937385426278, -16.599986452182243, -30.339891714606566, -36.723544829809896, 24.38355797622904, 14.637432156149089, -37.42404536058945, -39.22301033708276, 22.11945132369667, 25.493513594764064, -16.33392911684261, -40.567858864460575, -12.028145039128276, 37.549344015357086, 52.166527685187084, 15.06401344701759, -4.588561599889408, 37.600118432182576, 20.078850694119673, 2.801593793592156, 10.955498096576697, 13.381552756129192, 9.269278668256092, 9.158558318696743, 13.845065298914044, 34.55260118164181, -17.475600808250633, -20.453659339500962, -41.88043159456177, -51.92111388054176, 4.452132496370773, 15.21357157048465, -13.331149119944165, -30.352472684091317, -2.9763464108323454, 25.490801990716978, -46.13709813232458, -52.94112073753635, -29.1100423452473, -20.55253457846642, -48.65262160468291, -36.64393295257956, 14.493859132194892, -1.8760136272865502, 34.39952150054997, 15.626608957047585, 4.5060963679853465, 13.574136174579866, 16.01104924450622, 3.8323444075568975, -33.629517426760685, 26.826078610178353, -7.656429752955333, 23.702488699885258, 38.46337853884191, 33.99612695664586, 7.650576697169701, -31.74827344368967, -50.83776515725999, -40.694183744149356, 7.844051719619668, 16.898951815855096, 44.530312179148076, 19.234116467777945, 28.32584051310147, 30.84872674309988, -40.78733358867024, -41.863477625094, -33.36658867657038, -21.47001685982177, 12.634260632273431, 24.402822961398684, 19.476997892524217, 28.347219316883148, -28.709741679573796, -29.97498829336537, -34.85024554638563, -51.19562532842663, 8.025844848494113, 4.998384226896265, 20.95900601429718, 40.04030939546712, 17.36587457305514, 3.0837048585440696, 17.501875184866122, 26.071618698050337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4524485121368453, "mean_inference_ms": 1.2155046193682604, "mean_action_processing_ms": 0.1952866563787524, "mean_env_wait_ms": 0.08183022634528568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035663843154907227, "StateBufferConnector_ms": 0.0029424428939819336, "ViewRequirementAgentConnector_ms": 0.06866884231567383}, "num_episodes": 9, "episode_return_max": 36.22975274774386, "episode_return_min": -49.53910943493046, "episode_return_mean": -0.6474813686760689}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.6263528172838, "num_env_steps_trained_throughput_per_sec": 493.6263528172838, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 8348.197, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8348.085, "sample_time_ms": 840.693, "learn_time_ms": 7492.78, "learn_throughput": 533.847, "synch_weights_time_ms": 13.91}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 80, "trial_id": "83a5c_00000", "date": "2024-08-10_12-25-37", "timestamp": 1723307137, "time_this_iter_s": 8.1094388961792, "time_total_s": 700.7406029701233, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f580d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 700.7406029701233, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 26.64545454545454, "ram_util_percent": 80.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.28590158482708, "cur_kl_coeff": 0.01779785156249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.234671244167147, "policy_loss": -0.01796802933322926, "vf_loss": 5.25214050863155, "vf_explained_var": -0.06112013790342543, "kl": 0.028023711334600156, "entropy": 0.4651246343813245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.016429019377877, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.281967043504119, "policy_loss": -0.0038102372753201054, "vf_loss": 3.285691447556019, "vf_explained_var": 0.4149673758074641, "kl": 0.009644846674122354, "entropy": 0.5790052420770129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "env_runners": {"episode_reward_max": 36.22975274774386, "episode_reward_min": -49.53910943493046, "episode_reward_mean": -3.149349812868912, "episode_len_mean": 370.23, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37023, "policy_reward_min": {"agent_policy": -36.229752747743895, "adversary_policy": -58.535771850361826}, "policy_reward_max": {"agent_policy": 49.53910943493045, "adversary_policy": 52.166527685187084}, "policy_reward_mean": {"agent_policy": 3.1493498128689117, "adversary_policy": -3.1493498128689112}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.6176864559916515, -27.27118510829079, -34.46197309043969, 0.05879468983709213, 27.7271038849597, -2.331392273319233, -17.890354416422767, 6.190615390323811, -21.48090245930175, -29.89631895107682, -48.50612747064995, -9.155305783298703, 10.152581728541447, 5.9522031845625225, 7.815309740075693, -31.173864090374543, 10.259209223428131, -23.24887237721759, 9.876054883281302, 14.06472172765102, 19.542892446313235, 12.236598632731509, -19.855234279422366, 7.974242154479457, 10.211487887177219, -7.561776589616111, 18.880898773761274, -2.745470913880012, 27.201288498205273, 22.351558983829577, -3.2441478911918633, -17.215254639026927, 20.93350322743865, -33.81978104320155, -20.974861429362832, 23.880917505930316, 15.014707924475358, 22.35523010029601, 29.006199697719545, -20.339537033670332, -13.434581001413637, 22.96923868971974, 18.812532194199, 16.00471877276077, -13.736061519320035, 4.514348671069042, -29.51468015322251, -33.53171827220823, 19.510495066189062, -38.323527848836115, 23.806482459230327, -28.450893990651593, 12.760599488114405, 33.61527056610231, 16.505778416146594, 11.44022224385591, 12.168525426352947, 9.213918493476415, 24.198833240277935, -18.9646300738758, -46.90077273755174, 9.832852033427711, -21.84181090201774, 11.25722778994232, -49.53910943493046, -24.83128846185686, -42.64827727863122, 6.308922752454167, 25.01306522879876, 9.040116271282608, 9.92169682603156, -3.4017194082911653, 8.023029473464963, 36.22975274774386, -12.04884837325999, -45.76597445070472, 12.371501767737382, 31.882214323463007, 29.587283628100653, -41.32540560688212, -27.418302768196074, 18.51854179683606, 23.912108604703686, -29.342364986469583, -43.02293543740614, 6.512114537695189, 30.499657704882154, 10.224789715799602, 21.786746941458226, -35.96941911649202, -47.3633608775481, -6.254396468077637, -45.669138390652684, -16.945408926619017, -44.245017816802466, 9.454100133945705, 3.927031176921955, 23.485912901380196, -40.999953473766006, -33.886460496017804], "episode_lengths": [11, 400, 400, 400, 31, 400, 400, 400, 400, 400, 400, 400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 273, 400, 400, 28, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 82, 387, 400, 400, 361, 400, 400, 400, 400, 396, 400, 400, 400, 400, 400, 400, 400, 400, 168, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-6.617686455991651, 27.27118510829078, 34.4619730904397, -0.05879468983709213, -27.7271038849597, 2.331392273319233, 17.890354416422767, -6.190615390323811, 21.480902459301756, 29.89631895107689, 48.50612747064996, 9.1553057832987, -10.152581728541453, -5.952203184562523, -7.815309740075693, 31.173864090374547, -10.25920922342813, 23.248872377217594, -9.876054883281304, -14.06472172765102, -19.54289244631321, -12.236598632731507, 19.855234279422362, -7.974242154479458, -10.211487887177213, 7.561776589616109, -18.880898773761277, 2.7454709138800117, -27.20128849820526, -22.351558983829587, 3.2441478911918615, 17.215254639026924, -20.933503227438653, 33.81978104320153, 20.974861429362832, -23.88091750593032, -15.01470792447535, -22.355230100296005, -29.006199697719584, 20.339537033670332, 13.434581001413632, -22.96923868971976, -18.812532194199015, -16.004718772760768, 13.736061519320037, -4.514348671069041, 29.51468015322251, 33.53171827220823, -19.51049506618907, 38.32352784883611, -23.806482459230352, 28.450893990651593, -12.760599488114405, -33.6152705661023, -16.505778416146594, -11.440222243855914, -12.168525426352941, -9.213918493476417, -24.19883324027792, 18.9646300738758, 46.90077273755175, -9.83285203342771, 21.84181090201774, -11.257227789942315, 49.53910943493045, 24.83128846185686, 42.64827727863123, -6.308922752454168, -25.013065228798773, -9.040116271282606, -9.921696826031559, 3.4017194082911626, -8.023029473464963, -36.229752747743895, 12.048848373259988, 45.76597445070471, -12.371501767737385, -31.882214323463007, -29.587283628100675, 41.32540560688213, 27.418302768196074, -18.518541796836054, -23.91210860470369, 29.342364986469583, 43.02293543740613, -6.51211453769519, -30.49965770488215, -10.224789715799606, -21.78674694145824, 35.96941911649201, 47.363360877548104, 6.254396468077639, 45.66913839065269, 16.945408926619017, 44.245017816802445, -9.45410013394571, -3.927031176921955, -23.485912901380182, 40.999953473766, 33.88646049601781], "policy_adversary_policy_reward": [8.402785796989253, 4.832587114994048, -4.151514745550067, -50.390855471031514, -24.974279684249268, -43.949666496630165, 23.176486080124146, -23.05889670044997, 25.90688866270908, 29.547319107210313, 14.435758063333745, -19.098542609972213, -14.75362387278134, -21.027084960064194, -0.8128857751543279, 13.19411655580195, -53.7919841582828, 10.830179239679296, -2.615385784451991, -57.177252117701705, -41.80564294656093, -55.20661199473898, -17.647151179437323, -0.6634603871600806, 10.65304100467911, 9.652122452403784, -30.198171472619617, 42.10257784174467, 12.237908410361747, 3.3927110697896374, -40.70909178720591, -21.638636393543187, 16.514098729160835, 4.004319717695429, 0.3632187567682976, -46.86096351120349, 33.564341814202294, -13.812232047639675, 23.03043805796758, 5.099005397334452, 13.876237009341219, 25.209547883285218, 3.235499013739955, 21.237698251723067, -35.08808829658183, -4.622380262262892, 4.8926165258563135, 11.055867783102604, 1.5005152704941143, 18.9224605038603, -37.68611964810349, 22.56256646887128, 12.771434436826524, 24.990363110696038, -18.10348585300218, 12.612544025242155, 27.976182991508757, 26.42639400490176, 29.391589999352394, 15.311527968306764, -7.474508429307857, 0.986212646924109, 15.400143852466499, -49.83065313052033, 15.718043131390644, 26.148963323486647, -25.972105984424154, -41.667456101978864, -23.166589783292785, -18.78313307543288, 21.789707585400187, 25.972127426460467, 10.616086155680946, 19.41332969326976, 14.550621778301004, 30.15983842229101, 30.522914053731473, 27.48948534170762, -49.25650696918875, 8.577432901848077, -50.802284435119844, 23.933122432292567, 18.484744961081113, 27.4537324183584, 26.152141921710744, 11.472922466687283, 30.853276030900034, 1.1561615146215054, -39.35733477293261, 11.885211734292529, 3.4574191170333153, 5.571278225104769, -42.42937385426278, -16.599986452182243, -30.339891714606566, -36.723544829809896, 24.38355797622904, 14.637432156149089, -37.42404536058945, -39.22301033708276, 22.11945132369667, 25.493513594764064, -16.33392911684261, -40.567858864460575, -12.028145039128276, 37.549344015357086, 52.166527685187084, 15.06401344701759, -4.588561599889408, 37.600118432182576, 20.078850694119673, 2.801593793592156, 10.955498096576697, 13.381552756129192, 9.269278668256092, 9.158558318696743, 13.845065298914044, 34.55260118164181, -17.475600808250633, -20.453659339500962, -41.88043159456177, -51.92111388054176, 4.452132496370773, 15.21357157048465, -13.331149119944165, -30.352472684091317, -2.9763464108323454, 25.490801990716978, -46.13709813232458, -52.94112073753635, -29.1100423452473, -20.55253457846642, -48.65262160468291, -36.64393295257956, 14.493859132194892, -1.8760136272865502, 34.39952150054997, 15.626608957047585, 4.5060963679853465, 13.574136174579866, 16.01104924450622, 3.8323444075568975, -33.629517426760685, 26.826078610178353, -7.656429752955333, 23.702488699885258, 38.46337853884191, 33.99612695664586, 7.650576697169701, -31.74827344368967, -50.83776515725999, -40.694183744149356, 7.844051719619668, 16.898951815855096, 44.530312179148076, 19.234116467777945, 28.32584051310147, 30.84872674309988, -40.78733358867024, -41.863477625094, -33.36658867657038, -21.47001685982177, 12.634260632273431, 24.402822961398684, 19.476997892524217, 28.347219316883148, -28.709741679573796, -29.97498829336537, -34.85024554638563, -51.19562532842663, 8.025844848494113, 4.998384226896265, 20.95900601429718, 40.04030939546712, 17.36587457305514, 3.0837048585440696, 17.501875184866122, 26.071618698050337, -50.45879145650801, -21.480046776476, -36.19094990473436, -58.535771850361826, -12.385490254745406, -0.12330268140986789, -46.993587916111785, -44.34468886519358, -18.724396949830094, -15.16642090340794, -35.30517367160434, -53.18486196200051, 20.890590944009702, -1.9823906761182837, 13.263988965050373, -5.4099266112064655, 15.692545334526335, 31.279280468234045, -52.60451540393278, -29.39539154359922, -43.93795420666329, -23.834966785372345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4516865404086431, "mean_inference_ms": 1.2129348937240392, "mean_action_processing_ms": 0.19488126951994553, "mean_env_wait_ms": 0.08164636023653912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032804012298583984, "StateBufferConnector_ms": 0.002474069595336914, "ViewRequirementAgentConnector_ms": 0.06537604331970215}, "num_episodes": 11, "episode_return_max": 36.22975274774386, "episode_return_min": -49.53910943493046, "episode_return_mean": -3.149349812868912}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.1455521976116, "num_env_steps_trained_throughput_per_sec": 500.1455521976116, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 972000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 8191.843, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8191.802, "sample_time_ms": 822.841, "learn_time_ms": 7355.668, "learn_throughput": 543.798, "synch_weights_time_ms": 12.73}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "training_iteration": 81, "trial_id": "83a5c_00000", "date": "2024-08-10_12-25-45", "timestamp": 1723307145, "time_this_iter_s": 8.002939939498901, "time_total_s": 708.7435429096222, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f580b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 708.7435429096222, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 25.124999999999996, "ram_util_percent": 80.80833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.444269930780249, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6863237330522485, "policy_loss": -0.0055233431303696266, "vf_loss": 3.691568828133679, "vf_explained_var": -0.18491002075255863, "kl": 0.010422069482712635, "entropy": 0.6815712055516622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1181000916287305, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.556098501384258, "policy_loss": -0.005429861982217214, "vf_loss": 2.5614579686895014, "vf_explained_var": 0.4484130442763368, "kl": 0.007910825986536392, "entropy": 0.6173559152831634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": 36.22975274774386, "episode_reward_min": -49.53910943493046, "episode_reward_mean": -3.417433723077071, "episode_len_mean": 372.28, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37228, "policy_reward_min": {"agent_policy": -36.229752747743895, "adversary_policy": -58.535771850361826}, "policy_reward_max": {"agent_policy": 49.53910943493045, "adversary_policy": 52.166527685187084}, "policy_reward_mean": {"agent_policy": 3.417433723077071, "adversary_policy": -3.4174337230770697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.155305783298703, 10.152581728541447, 5.9522031845625225, 7.815309740075693, -31.173864090374543, 10.259209223428131, -23.24887237721759, 9.876054883281302, 14.06472172765102, 19.542892446313235, 12.236598632731509, -19.855234279422366, 7.974242154479457, 10.211487887177219, -7.561776589616111, 18.880898773761274, -2.745470913880012, 27.201288498205273, 22.351558983829577, -3.2441478911918633, -17.215254639026927, 20.93350322743865, -33.81978104320155, -20.974861429362832, 23.880917505930316, 15.014707924475358, 22.35523010029601, 29.006199697719545, -20.339537033670332, -13.434581001413637, 22.96923868971974, 18.812532194199, 16.00471877276077, -13.736061519320035, 4.514348671069042, -29.51468015322251, -33.53171827220823, 19.510495066189062, -38.323527848836115, 23.806482459230327, -28.450893990651593, 12.760599488114405, 33.61527056610231, 16.505778416146594, 11.44022224385591, 12.168525426352947, 9.213918493476415, 24.198833240277935, -18.9646300738758, -46.90077273755174, 9.832852033427711, -21.84181090201774, 11.25722778994232, -49.53910943493046, -24.83128846185686, -42.64827727863122, 6.308922752454167, 25.01306522879876, 9.040116271282608, 9.92169682603156, -3.4017194082911653, 8.023029473464963, 36.22975274774386, -12.04884837325999, -45.76597445070472, 12.371501767737382, 31.882214323463007, 29.587283628100653, -41.32540560688212, -27.418302768196074, 18.51854179683606, 23.912108604703686, -29.342364986469583, -43.02293543740614, 6.512114537695189, 30.499657704882154, 10.224789715799602, 21.786746941458226, -35.96941911649202, -47.3633608775481, -6.254396468077637, -45.669138390652684, -16.945408926619017, -44.245017816802466, 9.454100133945705, 3.927031176921955, 23.485912901380196, -40.999953473766006, -33.886460496017804, -47.81835821865658, -23.22392382419682, -1.89824541425366, -30.896725449971548, -33.84569317070166, 25.342786923096515, -34.076775918272425, 8.333922792503145, 17.642253343899576, -41.088099356363685, -6.52358607628755], "episode_lengths": [400, 400, 41, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 273, 400, 400, 28, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 82, 387, 400, 400, 361, 400, 400, 400, 400, 396, 400, 400, 400, 400, 400, 400, 400, 400, 168, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 102, 400, 400, 400, 400, 400, 400, 400, 145], "policy_agent_policy_reward": [9.1553057832987, -10.152581728541453, -5.952203184562523, -7.815309740075693, 31.173864090374547, -10.25920922342813, 23.248872377217594, -9.876054883281304, -14.06472172765102, -19.54289244631321, -12.236598632731507, 19.855234279422362, -7.974242154479458, -10.211487887177213, 7.561776589616109, -18.880898773761277, 2.7454709138800117, -27.20128849820526, -22.351558983829587, 3.2441478911918615, 17.215254639026924, -20.933503227438653, 33.81978104320153, 20.974861429362832, -23.88091750593032, -15.01470792447535, -22.355230100296005, -29.006199697719584, 20.339537033670332, 13.434581001413632, -22.96923868971976, -18.812532194199015, -16.004718772760768, 13.736061519320037, -4.514348671069041, 29.51468015322251, 33.53171827220823, -19.51049506618907, 38.32352784883611, -23.806482459230352, 28.450893990651593, -12.760599488114405, -33.6152705661023, -16.505778416146594, -11.440222243855914, -12.168525426352941, -9.213918493476417, -24.19883324027792, 18.9646300738758, 46.90077273755175, -9.83285203342771, 21.84181090201774, -11.257227789942315, 49.53910943493045, 24.83128846185686, 42.64827727863123, -6.308922752454168, -25.013065228798773, -9.040116271282606, -9.921696826031559, 3.4017194082911626, -8.023029473464963, -36.229752747743895, 12.048848373259988, 45.76597445070471, -12.371501767737385, -31.882214323463007, -29.587283628100675, 41.32540560688213, 27.418302768196074, -18.518541796836054, -23.91210860470369, 29.342364986469583, 43.02293543740613, -6.51211453769519, -30.49965770488215, -10.224789715799606, -21.78674694145824, 35.96941911649201, 47.363360877548104, 6.254396468077639, 45.66913839065269, 16.945408926619017, 44.245017816802445, -9.45410013394571, -3.927031176921955, -23.485912901380182, 40.999953473766, 33.88646049601781, 47.818358218656584, 23.223923824196824, 1.8982454142536591, 30.89672544997155, 33.84569317070168, -25.34278692309648, 34.07677591827242, -8.333922792503135, -17.64225334389958, 41.08809935636368, 6.523586076287549], "policy_adversary_policy_reward": [-17.647151179437323, -0.6634603871600806, 10.65304100467911, 9.652122452403784, -30.198171472619617, 42.10257784174467, 12.237908410361747, 3.3927110697896374, -40.70909178720591, -21.638636393543187, 16.514098729160835, 4.004319717695429, 0.3632187567682976, -46.86096351120349, 33.564341814202294, -13.812232047639675, 23.03043805796758, 5.099005397334452, 13.876237009341219, 25.209547883285218, 3.235499013739955, 21.237698251723067, -35.08808829658183, -4.622380262262892, 4.8926165258563135, 11.055867783102604, 1.5005152704941143, 18.9224605038603, -37.68611964810349, 22.56256646887128, 12.771434436826524, 24.990363110696038, -18.10348585300218, 12.612544025242155, 27.976182991508757, 26.42639400490176, 29.391589999352394, 15.311527968306764, -7.474508429307857, 0.986212646924109, 15.400143852466499, -49.83065313052033, 15.718043131390644, 26.148963323486647, -25.972105984424154, -41.667456101978864, -23.166589783292785, -18.78313307543288, 21.789707585400187, 25.972127426460467, 10.616086155680946, 19.41332969326976, 14.550621778301004, 30.15983842229101, 30.522914053731473, 27.48948534170762, -49.25650696918875, 8.577432901848077, -50.802284435119844, 23.933122432292567, 18.484744961081113, 27.4537324183584, 26.152141921710744, 11.472922466687283, 30.853276030900034, 1.1561615146215054, -39.35733477293261, 11.885211734292529, 3.4574191170333153, 5.571278225104769, -42.42937385426278, -16.599986452182243, -30.339891714606566, -36.723544829809896, 24.38355797622904, 14.637432156149089, -37.42404536058945, -39.22301033708276, 22.11945132369667, 25.493513594764064, -16.33392911684261, -40.567858864460575, -12.028145039128276, 37.549344015357086, 52.166527685187084, 15.06401344701759, -4.588561599889408, 37.600118432182576, 20.078850694119673, 2.801593793592156, 10.955498096576697, 13.381552756129192, 9.269278668256092, 9.158558318696743, 13.845065298914044, 34.55260118164181, -17.475600808250633, -20.453659339500962, -41.88043159456177, -51.92111388054176, 4.452132496370773, 15.21357157048465, -13.331149119944165, -30.352472684091317, -2.9763464108323454, 25.490801990716978, -46.13709813232458, -52.94112073753635, -29.1100423452473, -20.55253457846642, -48.65262160468291, -36.64393295257956, 14.493859132194892, -1.8760136272865502, 34.39952150054997, 15.626608957047585, 4.5060963679853465, 13.574136174579866, 16.01104924450622, 3.8323444075568975, -33.629517426760685, 26.826078610178353, -7.656429752955333, 23.702488699885258, 38.46337853884191, 33.99612695664586, 7.650576697169701, -31.74827344368967, -50.83776515725999, -40.694183744149356, 7.844051719619668, 16.898951815855096, 44.530312179148076, 19.234116467777945, 28.32584051310147, 30.84872674309988, -40.78733358867024, -41.863477625094, -33.36658867657038, -21.47001685982177, 12.634260632273431, 24.402822961398684, 19.476997892524217, 28.347219316883148, -28.709741679573796, -29.97498829336537, -34.85024554638563, -51.19562532842663, 8.025844848494113, 4.998384226896265, 20.95900601429718, 40.04030939546712, 17.36587457305514, 3.0837048585440696, 17.501875184866122, 26.071618698050337, -50.45879145650801, -21.480046776476, -36.19094990473436, -58.535771850361826, -12.385490254745406, -0.12330268140986789, -46.993587916111785, -44.34468886519358, -18.724396949830094, -15.16642090340794, -35.30517367160434, -53.18486196200051, 20.890590944009702, -1.9823906761182837, 13.263988965050373, -5.4099266112064655, 15.692545334526335, 31.279280468234045, -52.60451540393278, -29.39539154359922, -43.93795420666329, -23.834966785372345, -51.654982954432, -43.981733482881175, -14.639700827072687, -31.808146821320953, -11.972041922661475, 8.175551094154152, -22.873039268907554, -38.920411631035556, -50.72505372538371, -16.96633261601962, 33.00144215675488, 17.684131689438104, -30.43043525066666, -37.72311658587818, 9.015899729775782, 7.6519458552304975, 6.360977651425893, 28.92352903637326, -40.26765153508483, -41.908547177642504, 11.083646449288544, -24.130818601863638]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.45074377729770754, "mean_inference_ms": 1.2102964107480538, "mean_action_processing_ms": 0.19445671699701325, "mean_env_wait_ms": 0.08145054185545478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032743215560913086, "StateBufferConnector_ms": 0.0024591684341430664, "ViewRequirementAgentConnector_ms": 0.0652916431427002}, "num_episodes": 11, "episode_return_max": 36.22975274774386, "episode_return_min": -49.53910943493046, "episode_return_mean": -3.417433723077071}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.2072055834523, "num_env_steps_trained_throughput_per_sec": 491.2072055834523, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 8136.316, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8136.282, "sample_time_ms": 784.815, "learn_time_ms": 7337.979, "learn_throughput": 545.109, "synch_weights_time_ms": 12.978}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 82, "trial_id": "83a5c_00000", "date": "2024-08-10_12-25-54", "timestamp": 1723307154, "time_this_iter_s": 8.148462295532227, "time_total_s": 716.8920052051544, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f580af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 716.8920052051544, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 27.881818181818186, "ram_util_percent": 80.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.158459182170333, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.538916443264674, "policy_loss": -0.005508243639475454, "vf_loss": 3.5441391533644744, "vf_explained_var": -0.2529511096300902, "kl": 0.01069550170466162, "entropy": 1.0350020769096555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7276968964065116, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7965333171188833, "policy_loss": -0.00814694880391471, "vf_loss": 3.804631295055151, "vf_explained_var": 0.31751733720302583, "kl": 0.0055032452581487, "entropy": 0.4978285553554694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "env_runners": {"episode_reward_max": 36.22975274774386, "episode_reward_min": -49.53910943493046, "episode_reward_mean": -4.896262437572463, "episode_len_mean": 353.81, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 35381, "policy_reward_min": {"agent_policy": -36.229752747743895, "adversary_policy": -58.535771850361826}, "policy_reward_max": {"agent_policy": 49.53910943493045, "adversary_policy": 52.166527685187084}, "policy_reward_mean": {"agent_policy": 4.896262437572463, "adversary_policy": -4.896262437572462}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.880898773761274, -2.745470913880012, 27.201288498205273, 22.351558983829577, -3.2441478911918633, -17.215254639026927, 20.93350322743865, -33.81978104320155, -20.974861429362832, 23.880917505930316, 15.014707924475358, 22.35523010029601, 29.006199697719545, -20.339537033670332, -13.434581001413637, 22.96923868971974, 18.812532194199, 16.00471877276077, -13.736061519320035, 4.514348671069042, -29.51468015322251, -33.53171827220823, 19.510495066189062, -38.323527848836115, 23.806482459230327, -28.450893990651593, 12.760599488114405, 33.61527056610231, 16.505778416146594, 11.44022224385591, 12.168525426352947, 9.213918493476415, 24.198833240277935, -18.9646300738758, -46.90077273755174, 9.832852033427711, -21.84181090201774, 11.25722778994232, -49.53910943493046, -24.83128846185686, -42.64827727863122, 6.308922752454167, 25.01306522879876, 9.040116271282608, 9.92169682603156, -3.4017194082911653, 8.023029473464963, 36.22975274774386, -12.04884837325999, -45.76597445070472, 12.371501767737382, 31.882214323463007, 29.587283628100653, -41.32540560688212, -27.418302768196074, 18.51854179683606, 23.912108604703686, -29.342364986469583, -43.02293543740614, 6.512114537695189, 30.499657704882154, 10.224789715799602, 21.786746941458226, -35.96941911649202, -47.3633608775481, -6.254396468077637, -45.669138390652684, -16.945408926619017, -44.245017816802466, 9.454100133945705, 3.927031176921955, 23.485912901380196, -40.999953473766006, -33.886460496017804, -47.81835821865658, -23.22392382419682, -1.89824541425366, -30.896725449971548, -33.84569317070166, 25.342786923096515, -34.076775918272425, 8.333922792503145, 17.642253343899576, -41.088099356363685, -6.52358607628755, -30.543494809238563, -2.157021866233024, -1.801506285671637, -3.288037919131786, -17.269248073159464, -8.350548761350677, 9.162515241177596, -0.9313717203174965, 5.726912764480681, -7.645730411541781, -18.639234606921715, -3.1746155175859503, -14.725722861405794, -3.7361187118951618, -33.41939942243211], "episode_lengths": [400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 273, 400, 400, 28, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 82, 387, 400, 400, 361, 400, 400, 400, 400, 396, 400, 400, 400, 400, 400, 400, 400, 400, 168, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 102, 400, 400, 400, 400, 400, 400, 400, 145, 400, 68, 211, 400, 400, 330, 400, 54, 34, 137, 400, 91, 400, 69, 400], "policy_agent_policy_reward": [-18.880898773761277, 2.7454709138800117, -27.20128849820526, -22.351558983829587, 3.2441478911918615, 17.215254639026924, -20.933503227438653, 33.81978104320153, 20.974861429362832, -23.88091750593032, -15.01470792447535, -22.355230100296005, -29.006199697719584, 20.339537033670332, 13.434581001413632, -22.96923868971976, -18.812532194199015, -16.004718772760768, 13.736061519320037, -4.514348671069041, 29.51468015322251, 33.53171827220823, -19.51049506618907, 38.32352784883611, -23.806482459230352, 28.450893990651593, -12.760599488114405, -33.6152705661023, -16.505778416146594, -11.440222243855914, -12.168525426352941, -9.213918493476417, -24.19883324027792, 18.9646300738758, 46.90077273755175, -9.83285203342771, 21.84181090201774, -11.257227789942315, 49.53910943493045, 24.83128846185686, 42.64827727863123, -6.308922752454168, -25.013065228798773, -9.040116271282606, -9.921696826031559, 3.4017194082911626, -8.023029473464963, -36.229752747743895, 12.048848373259988, 45.76597445070471, -12.371501767737385, -31.882214323463007, -29.587283628100675, 41.32540560688213, 27.418302768196074, -18.518541796836054, -23.91210860470369, 29.342364986469583, 43.02293543740613, -6.51211453769519, -30.49965770488215, -10.224789715799606, -21.78674694145824, 35.96941911649201, 47.363360877548104, 6.254396468077639, 45.66913839065269, 16.945408926619017, 44.245017816802445, -9.45410013394571, -3.927031176921955, -23.485912901380182, 40.999953473766, 33.88646049601781, 47.818358218656584, 23.223923824196824, 1.8982454142536591, 30.89672544997155, 33.84569317070168, -25.34278692309648, 34.07677591827242, -8.333922792503135, -17.64225334389958, 41.08809935636368, 6.523586076287549, 30.543494809238563, 2.1570218662330243, 1.8015062856716373, 3.288037919131786, 17.269248073159467, 8.350548761350703, -9.162515241177596, 0.9313717203174985, -5.726912764480679, 7.645730411541775, 18.63923460692171, 3.1746155175859507, 14.725722861405796, 3.736118711895161, 33.41939942243211], "policy_adversary_policy_reward": [12.771434436826524, 24.990363110696038, -18.10348585300218, 12.612544025242155, 27.976182991508757, 26.42639400490176, 29.391589999352394, 15.311527968306764, -7.474508429307857, 0.986212646924109, 15.400143852466499, -49.83065313052033, 15.718043131390644, 26.148963323486647, -25.972105984424154, -41.667456101978864, -23.166589783292785, -18.78313307543288, 21.789707585400187, 25.972127426460467, 10.616086155680946, 19.41332969326976, 14.550621778301004, 30.15983842229101, 30.522914053731473, 27.48948534170762, -49.25650696918875, 8.577432901848077, -50.802284435119844, 23.933122432292567, 18.484744961081113, 27.4537324183584, 26.152141921710744, 11.472922466687283, 30.853276030900034, 1.1561615146215054, -39.35733477293261, 11.885211734292529, 3.4574191170333153, 5.571278225104769, -42.42937385426278, -16.599986452182243, -30.339891714606566, -36.723544829809896, 24.38355797622904, 14.637432156149089, -37.42404536058945, -39.22301033708276, 22.11945132369667, 25.493513594764064, -16.33392911684261, -40.567858864460575, -12.028145039128276, 37.549344015357086, 52.166527685187084, 15.06401344701759, -4.588561599889408, 37.600118432182576, 20.078850694119673, 2.801593793592156, 10.955498096576697, 13.381552756129192, 9.269278668256092, 9.158558318696743, 13.845065298914044, 34.55260118164181, -17.475600808250633, -20.453659339500962, -41.88043159456177, -51.92111388054176, 4.452132496370773, 15.21357157048465, -13.331149119944165, -30.352472684091317, -2.9763464108323454, 25.490801990716978, -46.13709813232458, -52.94112073753635, -29.1100423452473, -20.55253457846642, -48.65262160468291, -36.64393295257956, 14.493859132194892, -1.8760136272865502, 34.39952150054997, 15.626608957047585, 4.5060963679853465, 13.574136174579866, 16.01104924450622, 3.8323444075568975, -33.629517426760685, 26.826078610178353, -7.656429752955333, 23.702488699885258, 38.46337853884191, 33.99612695664586, 7.650576697169701, -31.74827344368967, -50.83776515725999, -40.694183744149356, 7.844051719619668, 16.898951815855096, 44.530312179148076, 19.234116467777945, 28.32584051310147, 30.84872674309988, -40.78733358867024, -41.863477625094, -33.36658867657038, -21.47001685982177, 12.634260632273431, 24.402822961398684, 19.476997892524217, 28.347219316883148, -28.709741679573796, -29.97498829336537, -34.85024554638563, -51.19562532842663, 8.025844848494113, 4.998384226896265, 20.95900601429718, 40.04030939546712, 17.36587457305514, 3.0837048585440696, 17.501875184866122, 26.071618698050337, -50.45879145650801, -21.480046776476, -36.19094990473436, -58.535771850361826, -12.385490254745406, -0.12330268140986789, -46.993587916111785, -44.34468886519358, -18.724396949830094, -15.16642090340794, -35.30517367160434, -53.18486196200051, 20.890590944009702, -1.9823906761182837, 13.263988965050373, -5.4099266112064655, 15.692545334526335, 31.279280468234045, -52.60451540393278, -29.39539154359922, -43.93795420666329, -23.834966785372345, -51.654982954432, -43.981733482881175, -14.639700827072687, -31.808146821320953, -11.972041922661475, 8.175551094154152, -22.873039268907554, -38.920411631035556, -50.72505372538371, -16.96633261601962, 33.00144215675488, 17.684131689438104, -30.43043525066666, -37.72311658587818, 9.015899729775782, 7.6519458552304975, 6.360977651425893, 28.92352903637326, -40.26765153508483, -41.908547177642504, 11.083646449288544, -24.130818601863638, -27.442168026749115, -33.64482159172801, 24.175244089388418, -28.489287821854468, -24.295464613941085, 20.692452042597814, 1.753424659924212, -8.329500498187784, -21.056213142039688, -13.482283004279225, 28.25277807344975, -44.953875596151136, 2.1748190207714515, 16.150211461583737, -3.990206179770901, 2.127462739135906, 31.876819438484794, -20.422993909523434, 30.73682685882594, -46.02828768190949, 2.4735131186338215, -39.75198233247726, -22.243603526726456, 15.894372491554556, -44.15064421128421, 14.699198488472613, 15.768680174986862, -23.240917598777184, -33.12423249162393, -33.714566353240286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4495894549374301, "mean_inference_ms": 1.207188007105949, "mean_action_processing_ms": 0.19398356907552594, "mean_env_wait_ms": 0.08121524115226647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032628774642944336, "StateBufferConnector_ms": 0.0023615360260009766, "ViewRequirementAgentConnector_ms": 0.06541287899017334}, "num_episodes": 15, "episode_return_max": 36.22975274774386, "episode_return_min": -49.53910943493046, "episode_return_mean": -4.896262437572463}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.25592968383086, "num_env_steps_trained_throughput_per_sec": 479.25592968383086, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 996000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 8152.125, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8152.091, "sample_time_ms": 786.841, "learn_time_ms": 7351.876, "learn_throughput": 544.079, "synch_weights_time_ms": 12.859}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "training_iteration": 83, "trial_id": "83a5c_00000", "date": "2024-08-10_12-26-02", "timestamp": 1723307162, "time_this_iter_s": 8.352560043334961, "time_total_s": 725.2445652484894, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31facadc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 725.2445652484894, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 28.5, "ram_util_percent": 81.09166666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9013996352278997, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3117944873829996, "policy_loss": -0.008487751744022326, "vf_loss": 2.3199205029578436, "vf_explained_var": 0.26775678670595565, "kl": 0.013549857232640187, "entropy": 0.8804672319422323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2092987703780333, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7397408618281287, "policy_loss": -0.0037639499857808306, "vf_loss": 2.7434505368272464, "vf_explained_var": 0.37196210138499736, "kl": 0.006098101758533133, "entropy": 0.3815258774906397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 36.22975274774386, "episode_reward_min": -49.53910943493046, "episode_reward_mean": -6.2232245523954495, "episode_len_mean": 355.87, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35587, "policy_reward_min": {"agent_policy": -36.229752747743895, "adversary_policy": -58.535771850361826}, "policy_reward_max": {"agent_policy": 49.53910943493045, "adversary_policy": 52.166527685187084}, "policy_reward_mean": {"agent_policy": 6.223224552395449, "adversary_policy": -6.223224552395448}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.014707924475358, 22.35523010029601, 29.006199697719545, -20.339537033670332, -13.434581001413637, 22.96923868971974, 18.812532194199, 16.00471877276077, -13.736061519320035, 4.514348671069042, -29.51468015322251, -33.53171827220823, 19.510495066189062, -38.323527848836115, 23.806482459230327, -28.450893990651593, 12.760599488114405, 33.61527056610231, 16.505778416146594, 11.44022224385591, 12.168525426352947, 9.213918493476415, 24.198833240277935, -18.9646300738758, -46.90077273755174, 9.832852033427711, -21.84181090201774, 11.25722778994232, -49.53910943493046, -24.83128846185686, -42.64827727863122, 6.308922752454167, 25.01306522879876, 9.040116271282608, 9.92169682603156, -3.4017194082911653, 8.023029473464963, 36.22975274774386, -12.04884837325999, -45.76597445070472, 12.371501767737382, 31.882214323463007, 29.587283628100653, -41.32540560688212, -27.418302768196074, 18.51854179683606, 23.912108604703686, -29.342364986469583, -43.02293543740614, 6.512114537695189, 30.499657704882154, 10.224789715799602, 21.786746941458226, -35.96941911649202, -47.3633608775481, -6.254396468077637, -45.669138390652684, -16.945408926619017, -44.245017816802466, 9.454100133945705, 3.927031176921955, 23.485912901380196, -40.999953473766006, -33.886460496017804, -47.81835821865658, -23.22392382419682, -1.89824541425366, -30.896725449971548, -33.84569317070166, 25.342786923096515, -34.076775918272425, 8.333922792503145, 17.642253343899576, -41.088099356363685, -6.52358607628755, -30.543494809238563, -2.157021866233024, -1.801506285671637, -3.288037919131786, -17.269248073159464, -8.350548761350677, 9.162515241177596, -0.9313717203174965, 5.726912764480681, -7.645730411541781, -18.639234606921715, -3.1746155175859503, -14.725722861405794, -3.7361187118951618, -33.41939942243211, -31.729966423321237, -5.252233312934452, -17.32017727657101, 5.239649192633248, -24.19424547900056, 4.06030593704858, -6.609487499649337, -3.2013654285356505, -17.270634576756574, -1.169405542709708], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 273, 400, 400, 28, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 82, 387, 400, 400, 361, 400, 400, 400, 400, 396, 400, 400, 400, 400, 400, 400, 400, 400, 168, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 102, 400, 400, 400, 400, 400, 400, 400, 145, 400, 68, 211, 400, 400, 330, 400, 54, 34, 137, 400, 91, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 218], "policy_agent_policy_reward": [-15.01470792447535, -22.355230100296005, -29.006199697719584, 20.339537033670332, 13.434581001413632, -22.96923868971976, -18.812532194199015, -16.004718772760768, 13.736061519320037, -4.514348671069041, 29.51468015322251, 33.53171827220823, -19.51049506618907, 38.32352784883611, -23.806482459230352, 28.450893990651593, -12.760599488114405, -33.6152705661023, -16.505778416146594, -11.440222243855914, -12.168525426352941, -9.213918493476417, -24.19883324027792, 18.9646300738758, 46.90077273755175, -9.83285203342771, 21.84181090201774, -11.257227789942315, 49.53910943493045, 24.83128846185686, 42.64827727863123, -6.308922752454168, -25.013065228798773, -9.040116271282606, -9.921696826031559, 3.4017194082911626, -8.023029473464963, -36.229752747743895, 12.048848373259988, 45.76597445070471, -12.371501767737385, -31.882214323463007, -29.587283628100675, 41.32540560688213, 27.418302768196074, -18.518541796836054, -23.91210860470369, 29.342364986469583, 43.02293543740613, -6.51211453769519, -30.49965770488215, -10.224789715799606, -21.78674694145824, 35.96941911649201, 47.363360877548104, 6.254396468077639, 45.66913839065269, 16.945408926619017, 44.245017816802445, -9.45410013394571, -3.927031176921955, -23.485912901380182, 40.999953473766, 33.88646049601781, 47.818358218656584, 23.223923824196824, 1.8982454142536591, 30.89672544997155, 33.84569317070168, -25.34278692309648, 34.07677591827242, -8.333922792503135, -17.64225334389958, 41.08809935636368, 6.523586076287549, 30.543494809238563, 2.1570218662330243, 1.8015062856716373, 3.288037919131786, 17.269248073159467, 8.350548761350703, -9.162515241177596, 0.9313717203174985, -5.726912764480679, 7.645730411541775, 18.63923460692171, 3.1746155175859507, 14.725722861405796, 3.736118711895161, 33.41939942243211, 31.729966423321248, 5.252233312934452, 17.320177276571005, -5.239649192633252, 24.194245479000557, -4.06030593704858, 6.609487499649337, 3.2013654285356505, 17.27063457675657, 1.1694055427097068], "policy_adversary_policy_reward": [10.616086155680946, 19.41332969326976, 14.550621778301004, 30.15983842229101, 30.522914053731473, 27.48948534170762, -49.25650696918875, 8.577432901848077, -50.802284435119844, 23.933122432292567, 18.484744961081113, 27.4537324183584, 26.152141921710744, 11.472922466687283, 30.853276030900034, 1.1561615146215054, -39.35733477293261, 11.885211734292529, 3.4574191170333153, 5.571278225104769, -42.42937385426278, -16.599986452182243, -30.339891714606566, -36.723544829809896, 24.38355797622904, 14.637432156149089, -37.42404536058945, -39.22301033708276, 22.11945132369667, 25.493513594764064, -16.33392911684261, -40.567858864460575, -12.028145039128276, 37.549344015357086, 52.166527685187084, 15.06401344701759, -4.588561599889408, 37.600118432182576, 20.078850694119673, 2.801593793592156, 10.955498096576697, 13.381552756129192, 9.269278668256092, 9.158558318696743, 13.845065298914044, 34.55260118164181, -17.475600808250633, -20.453659339500962, -41.88043159456177, -51.92111388054176, 4.452132496370773, 15.21357157048465, -13.331149119944165, -30.352472684091317, -2.9763464108323454, 25.490801990716978, -46.13709813232458, -52.94112073753635, -29.1100423452473, -20.55253457846642, -48.65262160468291, -36.64393295257956, 14.493859132194892, -1.8760136272865502, 34.39952150054997, 15.626608957047585, 4.5060963679853465, 13.574136174579866, 16.01104924450622, 3.8323444075568975, -33.629517426760685, 26.826078610178353, -7.656429752955333, 23.702488699885258, 38.46337853884191, 33.99612695664586, 7.650576697169701, -31.74827344368967, -50.83776515725999, -40.694183744149356, 7.844051719619668, 16.898951815855096, 44.530312179148076, 19.234116467777945, 28.32584051310147, 30.84872674309988, -40.78733358867024, -41.863477625094, -33.36658867657038, -21.47001685982177, 12.634260632273431, 24.402822961398684, 19.476997892524217, 28.347219316883148, -28.709741679573796, -29.97498829336537, -34.85024554638563, -51.19562532842663, 8.025844848494113, 4.998384226896265, 20.95900601429718, 40.04030939546712, 17.36587457305514, 3.0837048585440696, 17.501875184866122, 26.071618698050337, -50.45879145650801, -21.480046776476, -36.19094990473436, -58.535771850361826, -12.385490254745406, -0.12330268140986789, -46.993587916111785, -44.34468886519358, -18.724396949830094, -15.16642090340794, -35.30517367160434, -53.18486196200051, 20.890590944009702, -1.9823906761182837, 13.263988965050373, -5.4099266112064655, 15.692545334526335, 31.279280468234045, -52.60451540393278, -29.39539154359922, -43.93795420666329, -23.834966785372345, -51.654982954432, -43.981733482881175, -14.639700827072687, -31.808146821320953, -11.972041922661475, 8.175551094154152, -22.873039268907554, -38.920411631035556, -50.72505372538371, -16.96633261601962, 33.00144215675488, 17.684131689438104, -30.43043525066666, -37.72311658587818, 9.015899729775782, 7.6519458552304975, 6.360977651425893, 28.92352903637326, -40.26765153508483, -41.908547177642504, 11.083646449288544, -24.130818601863638, -27.442168026749115, -33.64482159172801, 24.175244089388418, -28.489287821854468, -24.295464613941085, 20.692452042597814, 1.753424659924212, -8.329500498187784, -21.056213142039688, -13.482283004279225, 28.25277807344975, -44.953875596151136, 2.1748190207714515, 16.150211461583737, -3.990206179770901, 2.127462739135906, 31.876819438484794, -20.422993909523434, 30.73682685882594, -46.02828768190949, 2.4735131186338215, -39.75198233247726, -22.243603526726456, 15.894372491554556, -44.15064421128421, 14.699198488472613, 15.768680174986862, -23.240917598777184, -33.12423249162393, -33.714566353240286, -45.457666416894725, -18.002266429747763, -20.874870604564997, 10.370403978696096, -30.869049658717174, -3.771304894424828, 6.835931290603217, 3.643367094663283, -40.28893789302222, -8.099553064978878, 7.485379923053431, 0.6352319510437283, 25.63102517154785, -38.85000017084653, 10.60107719705282, -17.00380805412412, -0.4505354060182576, -34.090733747494895, 20.070291241531464, -22.409102326950876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4488155206467768, "mean_inference_ms": 1.2050841762638485, "mean_action_processing_ms": 0.19364482156395685, "mean_env_wait_ms": 0.08105621734885596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003223896026611328, "StateBufferConnector_ms": 0.002357959747314453, "ViewRequirementAgentConnector_ms": 0.06516969203948975}, "num_episodes": 10, "episode_return_max": 36.22975274774386, "episode_return_min": -49.53910943493046, "episode_return_mean": -6.2232245523954495}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.36990551486804, "num_env_steps_trained_throughput_per_sec": 497.36990551486804, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 8127.584, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8127.55, "sample_time_ms": 788.425, "learn_time_ms": 7325.8, "learn_throughput": 546.015, "synch_weights_time_ms": 12.82}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 84, "trial_id": "83a5c_00000", "date": "2024-08-10_12-26-10", "timestamp": 1723307170, "time_this_iter_s": 8.04704999923706, "time_total_s": 733.2916152477264, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faaee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 733.2916152477264, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 25.191666666666666, "ram_util_percent": 81.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.252024377969207, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.367572551429587, "policy_loss": -0.005163264741983127, "vf_loss": 3.372529778909431, "vf_explained_var": -0.4500863004298437, "kl": 0.0077177075434012, "entropy": 0.7972872352789319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.450509407309194, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.039221334581574, "policy_loss": -0.00899483241106888, "vf_loss": 3.0481702741235495, "vf_explained_var": 0.029484678308169046, "kl": 0.005156461768990361, "entropy": 0.38377495277673007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "env_runners": {"episode_reward_max": 36.22975274774386, "episode_reward_min": -49.53910943493046, "episode_reward_mean": -8.250221638376683, "episode_len_mean": 337.11, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 33711, "policy_reward_min": {"agent_policy": -36.229752747743895, "adversary_policy": -58.535771850361826}, "policy_reward_max": {"agent_policy": 49.53910943493045, "adversary_policy": 52.166527685187084}, "policy_reward_mean": {"agent_policy": 8.250221638376681, "adversary_policy": -8.250221638376681}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.760599488114405, 33.61527056610231, 16.505778416146594, 11.44022224385591, 12.168525426352947, 9.213918493476415, 24.198833240277935, -18.9646300738758, -46.90077273755174, 9.832852033427711, -21.84181090201774, 11.25722778994232, -49.53910943493046, -24.83128846185686, -42.64827727863122, 6.308922752454167, 25.01306522879876, 9.040116271282608, 9.92169682603156, -3.4017194082911653, 8.023029473464963, 36.22975274774386, -12.04884837325999, -45.76597445070472, 12.371501767737382, 31.882214323463007, 29.587283628100653, -41.32540560688212, -27.418302768196074, 18.51854179683606, 23.912108604703686, -29.342364986469583, -43.02293543740614, 6.512114537695189, 30.499657704882154, 10.224789715799602, 21.786746941458226, -35.96941911649202, -47.3633608775481, -6.254396468077637, -45.669138390652684, -16.945408926619017, -44.245017816802466, 9.454100133945705, 3.927031176921955, 23.485912901380196, -40.999953473766006, -33.886460496017804, -47.81835821865658, -23.22392382419682, -1.89824541425366, -30.896725449971548, -33.84569317070166, 25.342786923096515, -34.076775918272425, 8.333922792503145, 17.642253343899576, -41.088099356363685, -6.52358607628755, -30.543494809238563, -2.157021866233024, -1.801506285671637, -3.288037919131786, -17.269248073159464, -8.350548761350677, 9.162515241177596, -0.9313717203174965, 5.726912764480681, -7.645730411541781, -18.639234606921715, -3.1746155175859503, -14.725722861405794, -3.7361187118951618, -33.41939942243211, -31.729966423321237, -5.252233312934452, -17.32017727657101, 5.239649192633248, -24.19424547900056, 4.06030593704858, -6.609487499649337, -3.2013654285356505, -17.270634576756574, -1.169405542709708, -22.86373761737354, 3.2962940893919725, 0.3057964935580202, -9.734674889226431, -14.021304260919566, -13.580348176646146, -17.596539161065166, -15.67999029686612, -42.023932411376414, -13.16826830560838, 10.232141000827735, -38.385094238999315, -2.067644475810247, 4.101342074573717, -29.628124066895307, -7.222670599351645], "episode_lengths": [400, 400, 273, 400, 400, 28, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 82, 387, 400, 400, 361, 400, 400, 400, 400, 396, 400, 400, 400, 400, 400, 400, 400, 400, 168, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 102, 400, 400, 400, 400, 400, 400, 400, 145, 400, 68, 211, 400, 400, 330, 400, 54, 34, 137, 400, 91, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 218, 400, 94, 218, 94, 400, 400, 400, 400, 400, 54, 28, 400, 248, 400, 400, 188], "policy_agent_policy_reward": [-12.760599488114405, -33.6152705661023, -16.505778416146594, -11.440222243855914, -12.168525426352941, -9.213918493476417, -24.19883324027792, 18.9646300738758, 46.90077273755175, -9.83285203342771, 21.84181090201774, -11.257227789942315, 49.53910943493045, 24.83128846185686, 42.64827727863123, -6.308922752454168, -25.013065228798773, -9.040116271282606, -9.921696826031559, 3.4017194082911626, -8.023029473464963, -36.229752747743895, 12.048848373259988, 45.76597445070471, -12.371501767737385, -31.882214323463007, -29.587283628100675, 41.32540560688213, 27.418302768196074, -18.518541796836054, -23.91210860470369, 29.342364986469583, 43.02293543740613, -6.51211453769519, -30.49965770488215, -10.224789715799606, -21.78674694145824, 35.96941911649201, 47.363360877548104, 6.254396468077639, 45.66913839065269, 16.945408926619017, 44.245017816802445, -9.45410013394571, -3.927031176921955, -23.485912901380182, 40.999953473766, 33.88646049601781, 47.818358218656584, 23.223923824196824, 1.8982454142536591, 30.89672544997155, 33.84569317070168, -25.34278692309648, 34.07677591827242, -8.333922792503135, -17.64225334389958, 41.08809935636368, 6.523586076287549, 30.543494809238563, 2.1570218662330243, 1.8015062856716373, 3.288037919131786, 17.269248073159467, 8.350548761350703, -9.162515241177596, 0.9313717203174985, -5.726912764480679, 7.645730411541775, 18.63923460692171, 3.1746155175859507, 14.725722861405796, 3.736118711895161, 33.41939942243211, 31.729966423321248, 5.252233312934452, 17.320177276571005, -5.239649192633252, 24.194245479000557, -4.06030593704858, 6.609487499649337, 3.2013654285356505, 17.27063457675657, 1.1694055427097068, 22.86373761737354, -3.2962940893919725, -0.3057964935580202, 9.734674889226433, 14.021304260919553, 13.580348176646138, 17.596539161065177, 15.679990296866116, 42.02393241137639, 13.16826830560838, -10.232141000827733, 38.38509423899932, 2.0676444758102477, -4.101342074573717, 29.628124066895296, 7.222670599351648], "policy_adversary_policy_reward": [-12.028145039128276, 37.549344015357086, 52.166527685187084, 15.06401344701759, -4.588561599889408, 37.600118432182576, 20.078850694119673, 2.801593793592156, 10.955498096576697, 13.381552756129192, 9.269278668256092, 9.158558318696743, 13.845065298914044, 34.55260118164181, -17.475600808250633, -20.453659339500962, -41.88043159456177, -51.92111388054176, 4.452132496370773, 15.21357157048465, -13.331149119944165, -30.352472684091317, -2.9763464108323454, 25.490801990716978, -46.13709813232458, -52.94112073753635, -29.1100423452473, -20.55253457846642, -48.65262160468291, -36.64393295257956, 14.493859132194892, -1.8760136272865502, 34.39952150054997, 15.626608957047585, 4.5060963679853465, 13.574136174579866, 16.01104924450622, 3.8323444075568975, -33.629517426760685, 26.826078610178353, -7.656429752955333, 23.702488699885258, 38.46337853884191, 33.99612695664586, 7.650576697169701, -31.74827344368967, -50.83776515725999, -40.694183744149356, 7.844051719619668, 16.898951815855096, 44.530312179148076, 19.234116467777945, 28.32584051310147, 30.84872674309988, -40.78733358867024, -41.863477625094, -33.36658867657038, -21.47001685982177, 12.634260632273431, 24.402822961398684, 19.476997892524217, 28.347219316883148, -28.709741679573796, -29.97498829336537, -34.85024554638563, -51.19562532842663, 8.025844848494113, 4.998384226896265, 20.95900601429718, 40.04030939546712, 17.36587457305514, 3.0837048585440696, 17.501875184866122, 26.071618698050337, -50.45879145650801, -21.480046776476, -36.19094990473436, -58.535771850361826, -12.385490254745406, -0.12330268140986789, -46.993587916111785, -44.34468886519358, -18.724396949830094, -15.16642090340794, -35.30517367160434, -53.18486196200051, 20.890590944009702, -1.9823906761182837, 13.263988965050373, -5.4099266112064655, 15.692545334526335, 31.279280468234045, -52.60451540393278, -29.39539154359922, -43.93795420666329, -23.834966785372345, -51.654982954432, -43.981733482881175, -14.639700827072687, -31.808146821320953, -11.972041922661475, 8.175551094154152, -22.873039268907554, -38.920411631035556, -50.72505372538371, -16.96633261601962, 33.00144215675488, 17.684131689438104, -30.43043525066666, -37.72311658587818, 9.015899729775782, 7.6519458552304975, 6.360977651425893, 28.92352903637326, -40.26765153508483, -41.908547177642504, 11.083646449288544, -24.130818601863638, -27.442168026749115, -33.64482159172801, 24.175244089388418, -28.489287821854468, -24.295464613941085, 20.692452042597814, 1.753424659924212, -8.329500498187784, -21.056213142039688, -13.482283004279225, 28.25277807344975, -44.953875596151136, 2.1748190207714515, 16.150211461583737, -3.990206179770901, 2.127462739135906, 31.876819438484794, -20.422993909523434, 30.73682685882594, -46.02828768190949, 2.4735131186338215, -39.75198233247726, -22.243603526726456, 15.894372491554556, -44.15064421128421, 14.699198488472613, 15.768680174986862, -23.240917598777184, -33.12423249162393, -33.714566353240286, -45.457666416894725, -18.002266429747763, -20.874870604564997, 10.370403978696096, -30.869049658717174, -3.771304894424828, 6.835931290603217, 3.643367094663283, -40.28893789302222, -8.099553064978878, 7.485379923053431, 0.6352319510437283, 25.63102517154785, -38.85000017084653, 10.60107719705282, -17.00380805412412, -0.4505354060182576, -34.090733747494895, 20.070291241531464, -22.409102326950876, -30.22524651998218, -15.502228714764904, 43.506419170887035, -36.91383099210307, 19.87242706315552, -19.26083407603948, -24.230767808335738, 4.761418029882875, 10.786129442544247, -38.82873796438338, -31.21764186195093, 4.056945508658661, 11.030753193094913, -46.223831515225264, 2.988585671099372, -34.348566264831625, -44.16935706103171, -39.87850776172115, -35.94609206368138, 9.609555452464626, 9.097921717842109, 11.366360283813364, -40.576430663744176, -36.193757814254454, 11.518909961057064, -15.654198912677558, 3.165331389958828, 5.037352759188606, -13.404656427341664, -45.85159170644894, -47.879052725691025, 33.43371152698774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4477834234511068, "mean_inference_ms": 1.2022277126614507, "mean_action_processing_ms": 0.1932070834344295, "mean_env_wait_ms": 0.08083975001514171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003172755241394043, "StateBufferConnector_ms": 0.002378225326538086, "ViewRequirementAgentConnector_ms": 0.06668531894683838}, "num_episodes": 16, "episode_return_max": 36.22975274774386, "episode_return_min": -49.53910943493046, "episode_return_mean": -8.250221638376683}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.9779952275584, "num_env_steps_trained_throughput_per_sec": 489.9779952275584, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1020000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 8146.169, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8146.136, "sample_time_ms": 783.426, "learn_time_ms": 7349.377, "learn_throughput": 544.264, "synch_weights_time_ms": 12.826}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "training_iteration": 85, "trial_id": "83a5c_00000", "date": "2024-08-10_12-26-18", "timestamp": 1723307178, "time_this_iter_s": 8.169348239898682, "time_total_s": 741.4609634876251, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb6b9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 741.4609634876251, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 26.181818181818183, "ram_util_percent": 81.23636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1204392896758186, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5273891943472404, "policy_loss": -0.004480335081030649, "vf_loss": 3.531655877986282, "vf_explained_var": -0.4863932323518884, "kl": 0.008002849330992285, "entropy": 0.5956627197681912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.254651584321012, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2516821161533396, "policy_loss": -0.006470473493633714, "vf_loss": 2.258058919881781, "vf_explained_var": 0.5197044859329859, "kl": 0.010524206748320808, "entropy": 0.4485051452182233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": 36.22975274774386, "episode_reward_min": -49.53910943493046, "episode_reward_mean": -9.331444234930009, "episode_len_mean": 338.93, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33893, "policy_reward_min": {"agent_policy": -36.229752747743895, "adversary_policy": -58.535771850361826}, "policy_reward_max": {"agent_policy": 49.53910943493045, "adversary_policy": 44.530312179148076}, "policy_reward_mean": {"agent_policy": 9.331444234930009, "adversary_policy": -9.331444234930009}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.84181090201774, 11.25722778994232, -49.53910943493046, -24.83128846185686, -42.64827727863122, 6.308922752454167, 25.01306522879876, 9.040116271282608, 9.92169682603156, -3.4017194082911653, 8.023029473464963, 36.22975274774386, -12.04884837325999, -45.76597445070472, 12.371501767737382, 31.882214323463007, 29.587283628100653, -41.32540560688212, -27.418302768196074, 18.51854179683606, 23.912108604703686, -29.342364986469583, -43.02293543740614, 6.512114537695189, 30.499657704882154, 10.224789715799602, 21.786746941458226, -35.96941911649202, -47.3633608775481, -6.254396468077637, -45.669138390652684, -16.945408926619017, -44.245017816802466, 9.454100133945705, 3.927031176921955, 23.485912901380196, -40.999953473766006, -33.886460496017804, -47.81835821865658, -23.22392382419682, -1.89824541425366, -30.896725449971548, -33.84569317070166, 25.342786923096515, -34.076775918272425, 8.333922792503145, 17.642253343899576, -41.088099356363685, -6.52358607628755, -30.543494809238563, -2.157021866233024, -1.801506285671637, -3.288037919131786, -17.269248073159464, -8.350548761350677, 9.162515241177596, -0.9313717203174965, 5.726912764480681, -7.645730411541781, -18.639234606921715, -3.1746155175859503, -14.725722861405794, -3.7361187118951618, -33.41939942243211, -31.729966423321237, -5.252233312934452, -17.32017727657101, 5.239649192633248, -24.19424547900056, 4.06030593704858, -6.609487499649337, -3.2013654285356505, -17.270634576756574, -1.169405542709708, -22.86373761737354, 3.2962940893919725, 0.3057964935580202, -9.734674889226431, -14.021304260919566, -13.580348176646146, -17.596539161065166, -15.67999029686612, -42.023932411376414, -13.16826830560838, 10.232141000827735, -38.385094238999315, -2.067644475810247, 4.101342074573717, -29.628124066895307, -7.222670599351645, 12.268487574704618, -29.016723432674475, -7.133171203240877, -8.635995012100818, -12.122688001474616, 16.71286406444264, -21.161329448196515, 5.862079654743482, -10.113373770361308, 9.088187015151783], "episode_lengths": [400, 33, 400, 400, 400, 400, 400, 82, 387, 400, 400, 361, 400, 400, 400, 400, 396, 400, 400, 400, 400, 400, 400, 400, 400, 168, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 102, 400, 400, 400, 400, 400, 400, 400, 145, 400, 68, 211, 400, 400, 330, 400, 54, 34, 137, 400, 91, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 218, 400, 94, 218, 94, 400, 400, 400, 400, 400, 54, 28, 400, 248, 400, 400, 188, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [21.84181090201774, -11.257227789942315, 49.53910943493045, 24.83128846185686, 42.64827727863123, -6.308922752454168, -25.013065228798773, -9.040116271282606, -9.921696826031559, 3.4017194082911626, -8.023029473464963, -36.229752747743895, 12.048848373259988, 45.76597445070471, -12.371501767737385, -31.882214323463007, -29.587283628100675, 41.32540560688213, 27.418302768196074, -18.518541796836054, -23.91210860470369, 29.342364986469583, 43.02293543740613, -6.51211453769519, -30.49965770488215, -10.224789715799606, -21.78674694145824, 35.96941911649201, 47.363360877548104, 6.254396468077639, 45.66913839065269, 16.945408926619017, 44.245017816802445, -9.45410013394571, -3.927031176921955, -23.485912901380182, 40.999953473766, 33.88646049601781, 47.818358218656584, 23.223923824196824, 1.8982454142536591, 30.89672544997155, 33.84569317070168, -25.34278692309648, 34.07677591827242, -8.333922792503135, -17.64225334389958, 41.08809935636368, 6.523586076287549, 30.543494809238563, 2.1570218662330243, 1.8015062856716373, 3.288037919131786, 17.269248073159467, 8.350548761350703, -9.162515241177596, 0.9313717203174985, -5.726912764480679, 7.645730411541775, 18.63923460692171, 3.1746155175859507, 14.725722861405796, 3.736118711895161, 33.41939942243211, 31.729966423321248, 5.252233312934452, 17.320177276571005, -5.239649192633252, 24.194245479000557, -4.06030593704858, 6.609487499649337, 3.2013654285356505, 17.27063457675657, 1.1694055427097068, 22.86373761737354, -3.2962940893919725, -0.3057964935580202, 9.734674889226433, 14.021304260919553, 13.580348176646138, 17.596539161065177, 15.679990296866116, 42.02393241137639, 13.16826830560838, -10.232141000827733, 38.38509423899932, 2.0676444758102477, -4.101342074573717, 29.628124066895296, 7.222670599351648, -12.26848757470462, 29.01672343267447, 7.133171203240886, 8.635995012100821, 12.122688001474621, -16.712864064442638, 21.161329448196515, -5.862079654743482, 10.113373770361306, -9.088187015151785], "policy_adversary_policy_reward": [-13.331149119944165, -30.352472684091317, -2.9763464108323454, 25.490801990716978, -46.13709813232458, -52.94112073753635, -29.1100423452473, -20.55253457846642, -48.65262160468291, -36.64393295257956, 14.493859132194892, -1.8760136272865502, 34.39952150054997, 15.626608957047585, 4.5060963679853465, 13.574136174579866, 16.01104924450622, 3.8323444075568975, -33.629517426760685, 26.826078610178353, -7.656429752955333, 23.702488699885258, 38.46337853884191, 33.99612695664586, 7.650576697169701, -31.74827344368967, -50.83776515725999, -40.694183744149356, 7.844051719619668, 16.898951815855096, 44.530312179148076, 19.234116467777945, 28.32584051310147, 30.84872674309988, -40.78733358867024, -41.863477625094, -33.36658867657038, -21.47001685982177, 12.634260632273431, 24.402822961398684, 19.476997892524217, 28.347219316883148, -28.709741679573796, -29.97498829336537, -34.85024554638563, -51.19562532842663, 8.025844848494113, 4.998384226896265, 20.95900601429718, 40.04030939546712, 17.36587457305514, 3.0837048585440696, 17.501875184866122, 26.071618698050337, -50.45879145650801, -21.480046776476, -36.19094990473436, -58.535771850361826, -12.385490254745406, -0.12330268140986789, -46.993587916111785, -44.34468886519358, -18.724396949830094, -15.16642090340794, -35.30517367160434, -53.18486196200051, 20.890590944009702, -1.9823906761182837, 13.263988965050373, -5.4099266112064655, 15.692545334526335, 31.279280468234045, -52.60451540393278, -29.39539154359922, -43.93795420666329, -23.834966785372345, -51.654982954432, -43.981733482881175, -14.639700827072687, -31.808146821320953, -11.972041922661475, 8.175551094154152, -22.873039268907554, -38.920411631035556, -50.72505372538371, -16.96633261601962, 33.00144215675488, 17.684131689438104, -30.43043525066666, -37.72311658587818, 9.015899729775782, 7.6519458552304975, 6.360977651425893, 28.92352903637326, -40.26765153508483, -41.908547177642504, 11.083646449288544, -24.130818601863638, -27.442168026749115, -33.64482159172801, 24.175244089388418, -28.489287821854468, -24.295464613941085, 20.692452042597814, 1.753424659924212, -8.329500498187784, -21.056213142039688, -13.482283004279225, 28.25277807344975, -44.953875596151136, 2.1748190207714515, 16.150211461583737, -3.990206179770901, 2.127462739135906, 31.876819438484794, -20.422993909523434, 30.73682685882594, -46.02828768190949, 2.4735131186338215, -39.75198233247726, -22.243603526726456, 15.894372491554556, -44.15064421128421, 14.699198488472613, 15.768680174986862, -23.240917598777184, -33.12423249162393, -33.714566353240286, -45.457666416894725, -18.002266429747763, -20.874870604564997, 10.370403978696096, -30.869049658717174, -3.771304894424828, 6.835931290603217, 3.643367094663283, -40.28893789302222, -8.099553064978878, 7.485379923053431, 0.6352319510437283, 25.63102517154785, -38.85000017084653, 10.60107719705282, -17.00380805412412, -0.4505354060182576, -34.090733747494895, 20.070291241531464, -22.409102326950876, -30.22524651998218, -15.502228714764904, 43.506419170887035, -36.91383099210307, 19.87242706315552, -19.26083407603948, -24.230767808335738, 4.761418029882875, 10.786129442544247, -38.82873796438338, -31.21764186195093, 4.056945508658661, 11.030753193094913, -46.223831515225264, 2.988585671099372, -34.348566264831625, -44.16935706103171, -39.87850776172115, -35.94609206368138, 9.609555452464626, 9.097921717842109, 11.366360283813364, -40.576430663744176, -36.193757814254454, 11.518909961057064, -15.654198912677558, 3.165331389958828, 5.037352759188606, -13.404656427341664, -45.85159170644894, -47.879052725691025, 33.43371152698774, 26.04974416172887, -1.512769012319632, -19.392460466972054, -38.64098639837689, 6.7069520225384, -20.973294429020154, 12.293803430805612, -29.565793455007245, 10.25416897503227, -34.4995449779815, 20.702835772508735, 12.722892356376558, -27.062151539882166, -15.260507356510864, -13.34826003422748, 25.072419343714444, 11.990985299097504, -32.21773283982011, 3.1609419186356877, 15.01543211166788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44709265016142324, "mean_inference_ms": 1.200197623279689, "mean_action_processing_ms": 0.19286979369472476, "mean_env_wait_ms": 0.08071196947518328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003157377243041992, "StateBufferConnector_ms": 0.002356886863708496, "ViewRequirementAgentConnector_ms": 0.06633174419403076}, "num_episodes": 10, "episode_return_max": 36.22975274774386, "episode_return_min": -49.53910943493046, "episode_return_mean": -9.331444234930009}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.24384139458306, "num_env_steps_trained_throughput_per_sec": 479.24384139458306, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 8158.788, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8158.752, "sample_time_ms": 782.011, "learn_time_ms": 7362.965, "learn_throughput": 543.259, "synch_weights_time_ms": 13.206}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 86, "trial_id": "83a5c_00000", "date": "2024-08-10_12-26-27", "timestamp": 1723307187, "time_this_iter_s": 8.362366914749146, "time_total_s": 749.8233304023743, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f60eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 749.8233304023743, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 28.416666666666668, "ram_util_percent": 81.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.461275632040841, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9716216930636654, "policy_loss": -0.006283035600636765, "vf_loss": 2.9776605112212047, "vf_explained_var": -0.16707853138762177, "kl": 0.009148039289368571, "entropy": 0.7388431731670622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.827031868478904, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.598955155039827, "policy_loss": -0.006900878274003238, "vf_loss": 2.605790660530329, "vf_explained_var": 0.03636675359060367, "kl": 0.0073471288352995765, "entropy": 0.3788298266629378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "env_runners": {"episode_reward_max": 30.499657704882154, "episode_reward_min": -47.81835821865658, "episode_reward_mean": -9.754737743306144, "episode_len_mean": 325.61, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 32561, "policy_reward_min": {"agent_policy": -30.49965770488215, "adversary_policy": -58.535771850361826}, "policy_reward_max": {"agent_policy": 47.818358218656584, "adversary_policy": 43.506419170887035}, "policy_reward_mean": {"agent_policy": 9.754737743306144, "adversary_policy": -9.754737743306142}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.587283628100653, -41.32540560688212, -27.418302768196074, 18.51854179683606, 23.912108604703686, -29.342364986469583, -43.02293543740614, 6.512114537695189, 30.499657704882154, 10.224789715799602, 21.786746941458226, -35.96941911649202, -47.3633608775481, -6.254396468077637, -45.669138390652684, -16.945408926619017, -44.245017816802466, 9.454100133945705, 3.927031176921955, 23.485912901380196, -40.999953473766006, -33.886460496017804, -47.81835821865658, -23.22392382419682, -1.89824541425366, -30.896725449971548, -33.84569317070166, 25.342786923096515, -34.076775918272425, 8.333922792503145, 17.642253343899576, -41.088099356363685, -6.52358607628755, -30.543494809238563, -2.157021866233024, -1.801506285671637, -3.288037919131786, -17.269248073159464, -8.350548761350677, 9.162515241177596, -0.9313717203174965, 5.726912764480681, -7.645730411541781, -18.639234606921715, -3.1746155175859503, -14.725722861405794, -3.7361187118951618, -33.41939942243211, -31.729966423321237, -5.252233312934452, -17.32017727657101, 5.239649192633248, -24.19424547900056, 4.06030593704858, -6.609487499649337, -3.2013654285356505, -17.270634576756574, -1.169405542709708, -22.86373761737354, 3.2962940893919725, 0.3057964935580202, -9.734674889226431, -14.021304260919566, -13.580348176646146, -17.596539161065166, -15.67999029686612, -42.023932411376414, -13.16826830560838, 10.232141000827735, -38.385094238999315, -2.067644475810247, 4.101342074573717, -29.628124066895307, -7.222670599351645, 12.268487574704618, -29.016723432674475, -7.133171203240877, -8.635995012100818, -12.122688001474616, 16.71286406444264, -21.161329448196515, 5.862079654743482, -10.113373770361308, 9.088187015151783, -29.93584760318482, 2.077994602228829, -19.190624212201456, -13.644584085984887, 3.8093765149663246, -34.9421335271691, -10.735421626978393, -8.202283601724739, -5.282600676748622, -0.31519541988312927, -4.319037587332901, -0.3371479533558803, 19.824751270639716, -2.073401320712769, 5.227552668246005, 5.679750592808902], "episode_lengths": [396, 400, 400, 400, 400, 400, 400, 400, 400, 168, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 102, 400, 400, 400, 400, 400, 400, 400, 145, 400, 68, 211, 400, 400, 330, 400, 54, 34, 137, 400, 91, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 218, 400, 94, 218, 94, 400, 400, 400, 400, 400, 54, 28, 400, 248, 400, 400, 188, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 177, 400, 400, 100, 400, 400, 400, 52, 400, 160, 138, 77], "policy_agent_policy_reward": [-29.587283628100675, 41.32540560688213, 27.418302768196074, -18.518541796836054, -23.91210860470369, 29.342364986469583, 43.02293543740613, -6.51211453769519, -30.49965770488215, -10.224789715799606, -21.78674694145824, 35.96941911649201, 47.363360877548104, 6.254396468077639, 45.66913839065269, 16.945408926619017, 44.245017816802445, -9.45410013394571, -3.927031176921955, -23.485912901380182, 40.999953473766, 33.88646049601781, 47.818358218656584, 23.223923824196824, 1.8982454142536591, 30.89672544997155, 33.84569317070168, -25.34278692309648, 34.07677591827242, -8.333922792503135, -17.64225334389958, 41.08809935636368, 6.523586076287549, 30.543494809238563, 2.1570218662330243, 1.8015062856716373, 3.288037919131786, 17.269248073159467, 8.350548761350703, -9.162515241177596, 0.9313717203174985, -5.726912764480679, 7.645730411541775, 18.63923460692171, 3.1746155175859507, 14.725722861405796, 3.736118711895161, 33.41939942243211, 31.729966423321248, 5.252233312934452, 17.320177276571005, -5.239649192633252, 24.194245479000557, -4.06030593704858, 6.609487499649337, 3.2013654285356505, 17.27063457675657, 1.1694055427097068, 22.86373761737354, -3.2962940893919725, -0.3057964935580202, 9.734674889226433, 14.021304260919553, 13.580348176646138, 17.596539161065177, 15.679990296866116, 42.02393241137639, 13.16826830560838, -10.232141000827733, 38.38509423899932, 2.0676444758102477, -4.101342074573717, 29.628124066895296, 7.222670599351648, -12.26848757470462, 29.01672343267447, 7.133171203240886, 8.635995012100821, 12.122688001474621, -16.712864064442638, 21.161329448196515, -5.862079654743482, 10.113373770361306, -9.088187015151785, 29.93584760318482, -2.0779946022288294, 19.190624212201456, 13.644584085984885, -3.8093765149663232, 34.942133527169105, 10.735421626978393, 8.202283601724746, 5.282600676748622, 0.31519541988312927, 4.319037587332903, 0.3371479533558803, -19.8247512706397, 2.0734013207127675, -5.227552668246005, -5.679750592808903], "policy_adversary_policy_reward": [28.32584051310147, 30.84872674309988, -40.78733358867024, -41.863477625094, -33.36658867657038, -21.47001685982177, 12.634260632273431, 24.402822961398684, 19.476997892524217, 28.347219316883148, -28.709741679573796, -29.97498829336537, -34.85024554638563, -51.19562532842663, 8.025844848494113, 4.998384226896265, 20.95900601429718, 40.04030939546712, 17.36587457305514, 3.0837048585440696, 17.501875184866122, 26.071618698050337, -50.45879145650801, -21.480046776476, -36.19094990473436, -58.535771850361826, -12.385490254745406, -0.12330268140986789, -46.993587916111785, -44.34468886519358, -18.724396949830094, -15.16642090340794, -35.30517367160434, -53.18486196200051, 20.890590944009702, -1.9823906761182837, 13.263988965050373, -5.4099266112064655, 15.692545334526335, 31.279280468234045, -52.60451540393278, -29.39539154359922, -43.93795420666329, -23.834966785372345, -51.654982954432, -43.981733482881175, -14.639700827072687, -31.808146821320953, -11.972041922661475, 8.175551094154152, -22.873039268907554, -38.920411631035556, -50.72505372538371, -16.96633261601962, 33.00144215675488, 17.684131689438104, -30.43043525066666, -37.72311658587818, 9.015899729775782, 7.6519458552304975, 6.360977651425893, 28.92352903637326, -40.26765153508483, -41.908547177642504, 11.083646449288544, -24.130818601863638, -27.442168026749115, -33.64482159172801, 24.175244089388418, -28.489287821854468, -24.295464613941085, 20.692452042597814, 1.753424659924212, -8.329500498187784, -21.056213142039688, -13.482283004279225, 28.25277807344975, -44.953875596151136, 2.1748190207714515, 16.150211461583737, -3.990206179770901, 2.127462739135906, 31.876819438484794, -20.422993909523434, 30.73682685882594, -46.02828768190949, 2.4735131186338215, -39.75198233247726, -22.243603526726456, 15.894372491554556, -44.15064421128421, 14.699198488472613, 15.768680174986862, -23.240917598777184, -33.12423249162393, -33.714566353240286, -45.457666416894725, -18.002266429747763, -20.874870604564997, 10.370403978696096, -30.869049658717174, -3.771304894424828, 6.835931290603217, 3.643367094663283, -40.28893789302222, -8.099553064978878, 7.485379923053431, 0.6352319510437283, 25.63102517154785, -38.85000017084653, 10.60107719705282, -17.00380805412412, -0.4505354060182576, -34.090733747494895, 20.070291241531464, -22.409102326950876, -30.22524651998218, -15.502228714764904, 43.506419170887035, -36.91383099210307, 19.87242706315552, -19.26083407603948, -24.230767808335738, 4.761418029882875, 10.786129442544247, -38.82873796438338, -31.21764186195093, 4.056945508658661, 11.030753193094913, -46.223831515225264, 2.988585671099372, -34.348566264831625, -44.16935706103171, -39.87850776172115, -35.94609206368138, 9.609555452464626, 9.097921717842109, 11.366360283813364, -40.576430663744176, -36.193757814254454, 11.518909961057064, -15.654198912677558, 3.165331389958828, 5.037352759188606, -13.404656427341664, -45.85159170644894, -47.879052725691025, 33.43371152698774, 26.04974416172887, -1.512769012319632, -19.392460466972054, -38.64098639837689, 6.7069520225384, -20.973294429020154, 12.293803430805612, -29.565793455007245, 10.25416897503227, -34.4995449779815, 20.702835772508735, 12.722892356376558, -27.062151539882166, -15.260507356510864, -13.34826003422748, 25.072419343714444, 11.990985299097504, -32.21773283982011, 3.1609419186356877, 15.01543211166788, -50.78824130416166, -9.083453902207985, 6.996027032868423, -2.8400378284107646, -19.42046037147513, -18.960788052927782, -0.8923493079836788, -26.39681886398609, 39.57394341956547, -31.95519038963281, -47.07898165262327, -22.805285401714933, 5.765665217238563, -27.23650847119535, 27.507330914331806, -43.91189811778129, -5.300185685109195, -5.2650156683880525, -4.374978467409456, 3.744587627643199, -28.953899584805626, 20.31582441013981, 36.7660923953076, -37.440388302019365, 15.95821937776938, 23.691283163510022, 19.972238571463365, -24.119041212888902, -15.862422798846922, 26.317528135338936, 15.90662591188951, -4.547124726271704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4461620991996218, "mean_inference_ms": 1.196515945673959, "mean_action_processing_ms": 0.19242057287160652, "mean_env_wait_ms": 0.08043535641392992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031644105911254883, "StateBufferConnector_ms": 0.0023287534713745117, "ViewRequirementAgentConnector_ms": 0.06494343280792236}, "num_episodes": 16, "episode_return_max": 30.499657704882154, "episode_return_min": -47.81835821865658, "episode_return_mean": -9.754737743306144}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.6119048665349, "num_env_steps_trained_throughput_per_sec": 487.6119048665349, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1044000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 8179.45, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8179.408, "sample_time_ms": 787.78, "learn_time_ms": 7377.604, "learn_throughput": 542.181, "synch_weights_time_ms": 13.503}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "training_iteration": 87, "trial_id": "83a5c_00000", "date": "2024-08-10_12-26-35", "timestamp": 1723307195, "time_this_iter_s": 8.211583852767944, "time_total_s": 758.0349142551422, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31facadc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 758.0349142551422, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 26.724999999999998, "ram_util_percent": 81.00833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9229380303905126, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5764261754732285, "policy_loss": -0.004468004115507322, "vf_loss": 2.580601599481371, "vf_explained_var": -0.5306481204335651, "kl": 0.010959511709674147, "entropy": 0.8671168573318966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.644956308385978, "cur_kl_coeff": 0.008898925781249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.021931501974662, "policy_loss": -0.004039740433775781, "vf_loss": 3.025952348361413, "vf_explained_var": -0.06860530513028304, "kl": 0.002123145101211795, "entropy": 0.34346084846183655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 25.342786923096515, "episode_reward_min": -47.81835821865658, "episode_reward_mean": -10.837853821285103, "episode_len_mean": 322.32, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 32232, "policy_reward_min": {"agent_policy": -25.34278692309648, "adversary_policy": -61.49311110889107}, "policy_reward_max": {"agent_policy": 47.818358218656584, "adversary_policy": 43.506419170887035}, "policy_reward_mean": {"agent_policy": 10.837853821285105, "adversary_policy": -10.837853821285103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.96941911649202, -47.3633608775481, -6.254396468077637, -45.669138390652684, -16.945408926619017, -44.245017816802466, 9.454100133945705, 3.927031176921955, 23.485912901380196, -40.999953473766006, -33.886460496017804, -47.81835821865658, -23.22392382419682, -1.89824541425366, -30.896725449971548, -33.84569317070166, 25.342786923096515, -34.076775918272425, 8.333922792503145, 17.642253343899576, -41.088099356363685, -6.52358607628755, -30.543494809238563, -2.157021866233024, -1.801506285671637, -3.288037919131786, -17.269248073159464, -8.350548761350677, 9.162515241177596, -0.9313717203174965, 5.726912764480681, -7.645730411541781, -18.639234606921715, -3.1746155175859503, -14.725722861405794, -3.7361187118951618, -33.41939942243211, -31.729966423321237, -5.252233312934452, -17.32017727657101, 5.239649192633248, -24.19424547900056, 4.06030593704858, -6.609487499649337, -3.2013654285356505, -17.270634576756574, -1.169405542709708, -22.86373761737354, 3.2962940893919725, 0.3057964935580202, -9.734674889226431, -14.021304260919566, -13.580348176646146, -17.596539161065166, -15.67999029686612, -42.023932411376414, -13.16826830560838, 10.232141000827735, -38.385094238999315, -2.067644475810247, 4.101342074573717, -29.628124066895307, -7.222670599351645, 12.268487574704618, -29.016723432674475, -7.133171203240877, -8.635995012100818, -12.122688001474616, 16.71286406444264, -21.161329448196515, 5.862079654743482, -10.113373770361308, 9.088187015151783, -29.93584760318482, 2.077994602228829, -19.190624212201456, -13.644584085984887, 3.8093765149663246, -34.9421335271691, -10.735421626978393, -8.202283601724739, -5.282600676748622, -0.31519541988312927, -4.319037587332901, -0.3371479533558803, 19.824751270639716, -2.073401320712769, 5.227552668246005, 5.679750592808902, 15.91614458726725, -18.269365855130324, 13.698601761904284, -23.70428202238815, -9.339606938732665, -36.542921594126646, -6.150740005883446, -32.257842984038454, 23.693514346875187, -27.73166318199897, -7.69121178112224], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 102, 400, 400, 400, 400, 400, 400, 400, 145, 400, 68, 211, 400, 400, 330, 400, 54, 34, 137, 400, 91, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 218, 400, 94, 218, 94, 400, 400, 400, 400, 400, 54, 28, 400, 248, 400, 400, 188, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 177, 400, 400, 100, 400, 400, 400, 52, 400, 160, 138, 77, 400, 400, 400, 400, 400, 400, 400, 400, 116, 400, 119], "policy_agent_policy_reward": [35.96941911649201, 47.363360877548104, 6.254396468077639, 45.66913839065269, 16.945408926619017, 44.245017816802445, -9.45410013394571, -3.927031176921955, -23.485912901380182, 40.999953473766, 33.88646049601781, 47.818358218656584, 23.223923824196824, 1.8982454142536591, 30.89672544997155, 33.84569317070168, -25.34278692309648, 34.07677591827242, -8.333922792503135, -17.64225334389958, 41.08809935636368, 6.523586076287549, 30.543494809238563, 2.1570218662330243, 1.8015062856716373, 3.288037919131786, 17.269248073159467, 8.350548761350703, -9.162515241177596, 0.9313717203174985, -5.726912764480679, 7.645730411541775, 18.63923460692171, 3.1746155175859507, 14.725722861405796, 3.736118711895161, 33.41939942243211, 31.729966423321248, 5.252233312934452, 17.320177276571005, -5.239649192633252, 24.194245479000557, -4.06030593704858, 6.609487499649337, 3.2013654285356505, 17.27063457675657, 1.1694055427097068, 22.86373761737354, -3.2962940893919725, -0.3057964935580202, 9.734674889226433, 14.021304260919553, 13.580348176646138, 17.596539161065177, 15.679990296866116, 42.02393241137639, 13.16826830560838, -10.232141000827733, 38.38509423899932, 2.0676444758102477, -4.101342074573717, 29.628124066895296, 7.222670599351648, -12.26848757470462, 29.01672343267447, 7.133171203240886, 8.635995012100821, 12.122688001474621, -16.712864064442638, 21.161329448196515, -5.862079654743482, 10.113373770361306, -9.088187015151785, 29.93584760318482, -2.0779946022288294, 19.190624212201456, 13.644584085984885, -3.8093765149663232, 34.942133527169105, 10.735421626978393, 8.202283601724746, 5.282600676748622, 0.31519541988312927, 4.319037587332903, 0.3371479533558803, -19.8247512706397, 2.0734013207127675, -5.227552668246005, -5.679750592808903, -15.916144587267251, 18.269365855130328, -13.698601761904285, 23.704282022388153, 9.339606938732663, 36.54292159412665, 6.150740005883447, 32.257842984038454, -23.693514346875194, 27.731663181999018, 7.691211781122238], "policy_adversary_policy_reward": [-50.45879145650801, -21.480046776476, -36.19094990473436, -58.535771850361826, -12.385490254745406, -0.12330268140986789, -46.993587916111785, -44.34468886519358, -18.724396949830094, -15.16642090340794, -35.30517367160434, -53.18486196200051, 20.890590944009702, -1.9823906761182837, 13.263988965050373, -5.4099266112064655, 15.692545334526335, 31.279280468234045, -52.60451540393278, -29.39539154359922, -43.93795420666329, -23.834966785372345, -51.654982954432, -43.981733482881175, -14.639700827072687, -31.808146821320953, -11.972041922661475, 8.175551094154152, -22.873039268907554, -38.920411631035556, -50.72505372538371, -16.96633261601962, 33.00144215675488, 17.684131689438104, -30.43043525066666, -37.72311658587818, 9.015899729775782, 7.6519458552304975, 6.360977651425893, 28.92352903637326, -40.26765153508483, -41.908547177642504, 11.083646449288544, -24.130818601863638, -27.442168026749115, -33.64482159172801, 24.175244089388418, -28.489287821854468, -24.295464613941085, 20.692452042597814, 1.753424659924212, -8.329500498187784, -21.056213142039688, -13.482283004279225, 28.25277807344975, -44.953875596151136, 2.1748190207714515, 16.150211461583737, -3.990206179770901, 2.127462739135906, 31.876819438484794, -20.422993909523434, 30.73682685882594, -46.02828768190949, 2.4735131186338215, -39.75198233247726, -22.243603526726456, 15.894372491554556, -44.15064421128421, 14.699198488472613, 15.768680174986862, -23.240917598777184, -33.12423249162393, -33.714566353240286, -45.457666416894725, -18.002266429747763, -20.874870604564997, 10.370403978696096, -30.869049658717174, -3.771304894424828, 6.835931290603217, 3.643367094663283, -40.28893789302222, -8.099553064978878, 7.485379923053431, 0.6352319510437283, 25.63102517154785, -38.85000017084653, 10.60107719705282, -17.00380805412412, -0.4505354060182576, -34.090733747494895, 20.070291241531464, -22.409102326950876, -30.22524651998218, -15.502228714764904, 43.506419170887035, -36.91383099210307, 19.87242706315552, -19.26083407603948, -24.230767808335738, 4.761418029882875, 10.786129442544247, -38.82873796438338, -31.21764186195093, 4.056945508658661, 11.030753193094913, -46.223831515225264, 2.988585671099372, -34.348566264831625, -44.16935706103171, -39.87850776172115, -35.94609206368138, 9.609555452464626, 9.097921717842109, 11.366360283813364, -40.576430663744176, -36.193757814254454, 11.518909961057064, -15.654198912677558, 3.165331389958828, 5.037352759188606, -13.404656427341664, -45.85159170644894, -47.879052725691025, 33.43371152698774, 26.04974416172887, -1.512769012319632, -19.392460466972054, -38.64098639837689, 6.7069520225384, -20.973294429020154, 12.293803430805612, -29.565793455007245, 10.25416897503227, -34.4995449779815, 20.702835772508735, 12.722892356376558, -27.062151539882166, -15.260507356510864, -13.34826003422748, 25.072419343714444, 11.990985299097504, -32.21773283982011, 3.1609419186356877, 15.01543211166788, -50.78824130416166, -9.083453902207985, 6.996027032868423, -2.8400378284107646, -19.42046037147513, -18.960788052927782, -0.8923493079836788, -26.39681886398609, 39.57394341956547, -31.95519038963281, -47.07898165262327, -22.805285401714933, 5.765665217238563, -27.23650847119535, 27.507330914331806, -43.91189811778129, -5.300185685109195, -5.2650156683880525, -4.374978467409456, 3.744587627643199, -28.953899584805626, 20.31582441013981, 36.7660923953076, -37.440388302019365, 15.95821937776938, 23.691283163510022, 19.972238571463365, -24.119041212888902, -15.862422798846922, 26.317528135338936, 15.90662591188951, -4.547124726271704, 17.371463665825075, 14.460825508709423, -40.46271867648903, 3.9239869662284086, 6.827880130273108, 20.569323393535466, -61.49311110889107, 14.08454706411477, -29.249072649821606, 10.569858772356275, -30.828289997782257, -42.257553190471036, 3.270200120525578, -15.571680132292471, -34.30420966446916, -30.211476303607753, 27.837941590406132, 19.549087103344256, -47.51054523001884, -7.952781133979137, 17.521421762007076, -32.903845324251556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.445464894506856, "mean_inference_ms": 1.1940472920085967, "mean_action_processing_ms": 0.1920870559567014, "mean_env_wait_ms": 0.08024528232811198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003249645233154297, "StateBufferConnector_ms": 0.0026911497116088867, "ViewRequirementAgentConnector_ms": 0.06622254848480225}, "num_episodes": 11, "episode_return_max": 25.342786923096515, "episode_return_min": -47.81835821865658, "episode_return_mean": -10.837853821285103}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.00488315640825, "num_env_steps_trained_throughput_per_sec": 494.00488315640825, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 8176.408, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8176.365, "sample_time_ms": 790.707, "learn_time_ms": 7371.681, "learn_throughput": 542.617, "synch_weights_time_ms": 13.43}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 88, "trial_id": "83a5c_00000", "date": "2024-08-10_12-26-43", "timestamp": 1723307203, "time_this_iter_s": 8.102639198303223, "time_total_s": 766.1375534534454, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faaee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 766.1375534534454, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 26.483333333333334, "ram_util_percent": 80.98333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7556112946972013, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2191573305104777, "policy_loss": -0.0037263066250407114, "vf_loss": 3.222575006157002, "vf_explained_var": -0.35150039628069235, "kl": 0.011560540834137819, "entropy": 0.7284568697056443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.075788143618653, "cur_kl_coeff": 0.0044494628906249995, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4562389058371386, "policy_loss": -0.004170157786575146, "vf_loss": 3.4603831437726815, "vf_explained_var": 0.2882715445632736, "kl": 0.00582862090954522, "entropy": 0.35983894964059193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "env_runners": {"episode_reward_max": 25.342786923096515, "episode_reward_min": -42.023932411376414, "episode_reward_mean": -9.008583523419777, "episode_len_mean": 310.97, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 31097, "policy_reward_min": {"agent_policy": -25.34278692309648, "adversary_policy": -61.49311110889107}, "policy_reward_max": {"agent_policy": 42.02393241137639, "adversary_policy": 43.506419170887035}, "policy_reward_mean": {"agent_policy": 9.008583523419777, "adversary_policy": -9.008583523419777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.896725449971548, -33.84569317070166, 25.342786923096515, -34.076775918272425, 8.333922792503145, 17.642253343899576, -41.088099356363685, -6.52358607628755, -30.543494809238563, -2.157021866233024, -1.801506285671637, -3.288037919131786, -17.269248073159464, -8.350548761350677, 9.162515241177596, -0.9313717203174965, 5.726912764480681, -7.645730411541781, -18.639234606921715, -3.1746155175859503, -14.725722861405794, -3.7361187118951618, -33.41939942243211, -31.729966423321237, -5.252233312934452, -17.32017727657101, 5.239649192633248, -24.19424547900056, 4.06030593704858, -6.609487499649337, -3.2013654285356505, -17.270634576756574, -1.169405542709708, -22.86373761737354, 3.2962940893919725, 0.3057964935580202, -9.734674889226431, -14.021304260919566, -13.580348176646146, -17.596539161065166, -15.67999029686612, -42.023932411376414, -13.16826830560838, 10.232141000827735, -38.385094238999315, -2.067644475810247, 4.101342074573717, -29.628124066895307, -7.222670599351645, 12.268487574704618, -29.016723432674475, -7.133171203240877, -8.635995012100818, -12.122688001474616, 16.71286406444264, -21.161329448196515, 5.862079654743482, -10.113373770361308, 9.088187015151783, -29.93584760318482, 2.077994602228829, -19.190624212201456, -13.644584085984887, 3.8093765149663246, -34.9421335271691, -10.735421626978393, -8.202283601724739, -5.282600676748622, -0.31519541988312927, -4.319037587332901, -0.3371479533558803, 19.824751270639716, -2.073401320712769, 5.227552668246005, 5.679750592808902, 15.91614458726725, -18.269365855130324, 13.698601761904284, -23.70428202238815, -9.339606938732665, -36.542921594126646, -6.150740005883446, -32.257842984038454, 23.693514346875187, -27.73166318199897, -7.69121178112224, -16.73157871489769, -19.06270982201415, -15.27189996491045, -3.3957168597107428, 17.23150593926828, 4.187693978480288, 12.972934212158908, -5.250775525180449, -1.9407790379398664, -29.12824743300956, -14.084623158954415, 3.360150195639599, -41.28944373862139, -16.076119094610696], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 145, 400, 68, 211, 400, 400, 330, 400, 54, 34, 137, 400, 91, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 218, 400, 94, 218, 94, 400, 400, 400, 400, 400, 54, 28, 400, 248, 400, 400, 188, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 177, 400, 400, 100, 400, 400, 400, 52, 400, 160, 138, 77, 400, 400, 400, 400, 400, 400, 400, 400, 116, 400, 119, 400, 400, 400, 85, 172, 400, 120, 108, 82, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [30.89672544997155, 33.84569317070168, -25.34278692309648, 34.07677591827242, -8.333922792503135, -17.64225334389958, 41.08809935636368, 6.523586076287549, 30.543494809238563, 2.1570218662330243, 1.8015062856716373, 3.288037919131786, 17.269248073159467, 8.350548761350703, -9.162515241177596, 0.9313717203174985, -5.726912764480679, 7.645730411541775, 18.63923460692171, 3.1746155175859507, 14.725722861405796, 3.736118711895161, 33.41939942243211, 31.729966423321248, 5.252233312934452, 17.320177276571005, -5.239649192633252, 24.194245479000557, -4.06030593704858, 6.609487499649337, 3.2013654285356505, 17.27063457675657, 1.1694055427097068, 22.86373761737354, -3.2962940893919725, -0.3057964935580202, 9.734674889226433, 14.021304260919553, 13.580348176646138, 17.596539161065177, 15.679990296866116, 42.02393241137639, 13.16826830560838, -10.232141000827733, 38.38509423899932, 2.0676444758102477, -4.101342074573717, 29.628124066895296, 7.222670599351648, -12.26848757470462, 29.01672343267447, 7.133171203240886, 8.635995012100821, 12.122688001474621, -16.712864064442638, 21.161329448196515, -5.862079654743482, 10.113373770361306, -9.088187015151785, 29.93584760318482, -2.0779946022288294, 19.190624212201456, 13.644584085984885, -3.8093765149663232, 34.942133527169105, 10.735421626978393, 8.202283601724746, 5.282600676748622, 0.31519541988312927, 4.319037587332903, 0.3371479533558803, -19.8247512706397, 2.0734013207127675, -5.227552668246005, -5.679750592808903, -15.916144587267251, 18.269365855130328, -13.698601761904285, 23.704282022388153, 9.339606938732663, 36.54292159412665, 6.150740005883447, 32.257842984038454, -23.693514346875194, 27.731663181999018, 7.691211781122238, 16.731578714897704, 19.062709822014153, 15.271899964910437, 3.3957168597107463, -17.23150593926827, -4.187693978480287, -12.972934212158911, 5.2507755251804555, 1.9407790379398655, 29.12824743300956, 14.084623158954413, -3.360150195639599, 41.28944373862138, 16.076119094610686], "policy_adversary_policy_reward": [-22.873039268907554, -38.920411631035556, -50.72505372538371, -16.96633261601962, 33.00144215675488, 17.684131689438104, -30.43043525066666, -37.72311658587818, 9.015899729775782, 7.6519458552304975, 6.360977651425893, 28.92352903637326, -40.26765153508483, -41.908547177642504, 11.083646449288544, -24.130818601863638, -27.442168026749115, -33.64482159172801, 24.175244089388418, -28.489287821854468, -24.295464613941085, 20.692452042597814, 1.753424659924212, -8.329500498187784, -21.056213142039688, -13.482283004279225, 28.25277807344975, -44.953875596151136, 2.1748190207714515, 16.150211461583737, -3.990206179770901, 2.127462739135906, 31.876819438484794, -20.422993909523434, 30.73682685882594, -46.02828768190949, 2.4735131186338215, -39.75198233247726, -22.243603526726456, 15.894372491554556, -44.15064421128421, 14.699198488472613, 15.768680174986862, -23.240917598777184, -33.12423249162393, -33.714566353240286, -45.457666416894725, -18.002266429747763, -20.874870604564997, 10.370403978696096, -30.869049658717174, -3.771304894424828, 6.835931290603217, 3.643367094663283, -40.28893789302222, -8.099553064978878, 7.485379923053431, 0.6352319510437283, 25.63102517154785, -38.85000017084653, 10.60107719705282, -17.00380805412412, -0.4505354060182576, -34.090733747494895, 20.070291241531464, -22.409102326950876, -30.22524651998218, -15.502228714764904, 43.506419170887035, -36.91383099210307, 19.87242706315552, -19.26083407603948, -24.230767808335738, 4.761418029882875, 10.786129442544247, -38.82873796438338, -31.21764186195093, 4.056945508658661, 11.030753193094913, -46.223831515225264, 2.988585671099372, -34.348566264831625, -44.16935706103171, -39.87850776172115, -35.94609206368138, 9.609555452464626, 9.097921717842109, 11.366360283813364, -40.576430663744176, -36.193757814254454, 11.518909961057064, -15.654198912677558, 3.165331389958828, 5.037352759188606, -13.404656427341664, -45.85159170644894, -47.879052725691025, 33.43371152698774, 26.04974416172887, -1.512769012319632, -19.392460466972054, -38.64098639837689, 6.7069520225384, -20.973294429020154, 12.293803430805612, -29.565793455007245, 10.25416897503227, -34.4995449779815, 20.702835772508735, 12.722892356376558, -27.062151539882166, -15.260507356510864, -13.34826003422748, 25.072419343714444, 11.990985299097504, -32.21773283982011, 3.1609419186356877, 15.01543211166788, -50.78824130416166, -9.083453902207985, 6.996027032868423, -2.8400378284107646, -19.42046037147513, -18.960788052927782, -0.8923493079836788, -26.39681886398609, 39.57394341956547, -31.95519038963281, -47.07898165262327, -22.805285401714933, 5.765665217238563, -27.23650847119535, 27.507330914331806, -43.91189811778129, -5.300185685109195, -5.2650156683880525, -4.374978467409456, 3.744587627643199, -28.953899584805626, 20.31582441013981, 36.7660923953076, -37.440388302019365, 15.95821937776938, 23.691283163510022, 19.972238571463365, -24.119041212888902, -15.862422798846922, 26.317528135338936, 15.90662591188951, -4.547124726271704, 17.371463665825075, 14.460825508709423, -40.46271867648903, 3.9239869662284086, 6.827880130273108, 20.569323393535466, -61.49311110889107, 14.08454706411477, -29.249072649821606, 10.569858772356275, -30.828289997782257, -42.257553190471036, 3.270200120525578, -15.571680132292471, -34.30420966446916, -30.211476303607753, 27.837941590406132, 19.549087103344256, -47.51054523001884, -7.952781133979137, 17.521421762007076, -32.903845324251556, -1.1338475918278323, -32.32930983796757, 14.551795575083666, -52.67721521911194, -45.83932583575296, 15.29552590593207, 12.45938338130113, -19.250817100722628, 16.16273439365644, 18.300277484880116, 3.427792737408631, 4.947595219551939, 10.07021976843014, 15.875648655887673, 10.657121845859058, -21.15867289621997, -31.391564834534304, 27.510006758654573, -31.447717331570853, -26.808777534448268, 1.7809228443367502, -29.95016916224558, 6.087570780262043, 0.6327296110171554, -33.614611329244354, -48.96427614799846, 2.1974742316432474, -34.34971242086464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44453240459701254, "mean_inference_ms": 1.191162136126332, "mean_action_processing_ms": 0.19163551883206226, "mean_env_wait_ms": 0.080037383010597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003221273422241211, "StateBufferConnector_ms": 0.0026780366897583008, "ViewRequirementAgentConnector_ms": 0.06558108329772949}, "num_episodes": 14, "episode_return_max": 25.342786923096515, "episode_return_min": -42.023932411376414, "episode_return_mean": -9.008583523419777}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.2482812948044, "num_env_steps_trained_throughput_per_sec": 495.2482812948044, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1068000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 8152.004, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8151.961, "sample_time_ms": 762.611, "learn_time_ms": 7375.478, "learn_throughput": 542.338, "synch_weights_time_ms": 13.287}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "training_iteration": 89, "trial_id": "83a5c_00000", "date": "2024-08-10_12-26-51", "timestamp": 1723307211, "time_this_iter_s": 8.082059144973755, "time_total_s": 774.2196125984192, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5adaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 774.2196125984192, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 26.3, "ram_util_percent": 81.02727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8632142781580567, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.454682064434839, "policy_loss": -0.00997147211095407, "vf_loss": 3.4642350059337716, "vf_explained_var": -0.2447957207601537, "kl": 0.015677063103652245, "entropy": 0.7768270757778611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0625257798781, "cur_kl_coeff": 0.0044494628906249995, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.496693919847409, "policy_loss": -0.0052001241921971085, "vf_loss": 3.5018768844505153, "vf_explained_var": 0.10148920665184656, "kl": 0.0038562050872841627, "entropy": 0.3993781341550251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 25.365963639622215, "episode_reward_min": -42.023932411376414, "episode_reward_mean": -8.141196320476073, "episode_len_mean": 306.09, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 30609, "policy_reward_min": {"agent_policy": -25.365963639622212, "adversary_policy": -61.49311110889107}, "policy_reward_max": {"agent_policy": 42.02393241137639, "adversary_policy": 43.506419170887035}, "policy_reward_mean": {"agent_policy": 8.141196320476075, "adversary_policy": -8.141196320476075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.269248073159464, -8.350548761350677, 9.162515241177596, -0.9313717203174965, 5.726912764480681, -7.645730411541781, -18.639234606921715, -3.1746155175859503, -14.725722861405794, -3.7361187118951618, -33.41939942243211, -31.729966423321237, -5.252233312934452, -17.32017727657101, 5.239649192633248, -24.19424547900056, 4.06030593704858, -6.609487499649337, -3.2013654285356505, -17.270634576756574, -1.169405542709708, -22.86373761737354, 3.2962940893919725, 0.3057964935580202, -9.734674889226431, -14.021304260919566, -13.580348176646146, -17.596539161065166, -15.67999029686612, -42.023932411376414, -13.16826830560838, 10.232141000827735, -38.385094238999315, -2.067644475810247, 4.101342074573717, -29.628124066895307, -7.222670599351645, 12.268487574704618, -29.016723432674475, -7.133171203240877, -8.635995012100818, -12.122688001474616, 16.71286406444264, -21.161329448196515, 5.862079654743482, -10.113373770361308, 9.088187015151783, -29.93584760318482, 2.077994602228829, -19.190624212201456, -13.644584085984887, 3.8093765149663246, -34.9421335271691, -10.735421626978393, -8.202283601724739, -5.282600676748622, -0.31519541988312927, -4.319037587332901, -0.3371479533558803, 19.824751270639716, -2.073401320712769, 5.227552668246005, 5.679750592808902, 15.91614458726725, -18.269365855130324, 13.698601761904284, -23.70428202238815, -9.339606938732665, -36.542921594126646, -6.150740005883446, -32.257842984038454, 23.693514346875187, -27.73166318199897, -7.69121178112224, -16.73157871489769, -19.06270982201415, -15.27189996491045, -3.3957168597107428, 17.23150593926828, 4.187693978480288, 12.972934212158908, -5.250775525180449, -1.9407790379398664, -29.12824743300956, -14.084623158954415, 3.360150195639599, -41.28944373862139, -16.076119094610696, -27.62916052281434, 3.8758970031561386, 25.365963639622215, -26.89456499270738, -15.756057599030573, -36.9530900528198, 23.238357052511603, -4.458190207146042, 1.8385945957313243, -5.180581546197488, 16.74707950834559, -0.3575043766537538], "episode_lengths": [400, 330, 400, 54, 34, 137, 400, 91, 400, 69, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 218, 400, 94, 218, 94, 400, 400, 400, 400, 400, 54, 28, 400, 248, 400, 400, 188, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 177, 400, 400, 100, 400, 400, 400, 52, 400, 160, 138, 77, 400, 400, 400, 400, 400, 400, 400, 400, 116, 400, 119, 400, 400, 400, 85, 172, 400, 120, 108, 82, 400, 400, 400, 400, 400, 400, 400, 140, 400, 394, 400, 142, 96, 128, 400, 400, 236], "policy_agent_policy_reward": [17.269248073159467, 8.350548761350703, -9.162515241177596, 0.9313717203174985, -5.726912764480679, 7.645730411541775, 18.63923460692171, 3.1746155175859507, 14.725722861405796, 3.736118711895161, 33.41939942243211, 31.729966423321248, 5.252233312934452, 17.320177276571005, -5.239649192633252, 24.194245479000557, -4.06030593704858, 6.609487499649337, 3.2013654285356505, 17.27063457675657, 1.1694055427097068, 22.86373761737354, -3.2962940893919725, -0.3057964935580202, 9.734674889226433, 14.021304260919553, 13.580348176646138, 17.596539161065177, 15.679990296866116, 42.02393241137639, 13.16826830560838, -10.232141000827733, 38.38509423899932, 2.0676444758102477, -4.101342074573717, 29.628124066895296, 7.222670599351648, -12.26848757470462, 29.01672343267447, 7.133171203240886, 8.635995012100821, 12.122688001474621, -16.712864064442638, 21.161329448196515, -5.862079654743482, 10.113373770361306, -9.088187015151785, 29.93584760318482, -2.0779946022288294, 19.190624212201456, 13.644584085984885, -3.8093765149663232, 34.942133527169105, 10.735421626978393, 8.202283601724746, 5.282600676748622, 0.31519541988312927, 4.319037587332903, 0.3371479533558803, -19.8247512706397, 2.0734013207127675, -5.227552668246005, -5.679750592808903, -15.916144587267251, 18.269365855130328, -13.698601761904285, 23.704282022388153, 9.339606938732663, 36.54292159412665, 6.150740005883447, 32.257842984038454, -23.693514346875194, 27.731663181999018, 7.691211781122238, 16.731578714897704, 19.062709822014153, 15.271899964910437, 3.3957168597107463, -17.23150593926827, -4.187693978480287, -12.972934212158911, 5.2507755251804555, 1.9407790379398655, 29.12824743300956, 14.084623158954413, -3.360150195639599, 41.28944373862138, 16.076119094610686, 27.629160522814345, -3.8758970031561386, -25.365963639622212, 26.89456499270738, 15.756057599030584, 36.953090052819825, -23.238357052511606, 4.458190207146042, -1.8385945957313243, 5.180581546197489, -16.747079508345585, 0.357504376653754], "policy_adversary_policy_reward": [-21.056213142039688, -13.482283004279225, 28.25277807344975, -44.953875596151136, 2.1748190207714515, 16.150211461583737, -3.990206179770901, 2.127462739135906, 31.876819438484794, -20.422993909523434, 30.73682685882594, -46.02828768190949, 2.4735131186338215, -39.75198233247726, -22.243603526726456, 15.894372491554556, -44.15064421128421, 14.699198488472613, 15.768680174986862, -23.240917598777184, -33.12423249162393, -33.714566353240286, -45.457666416894725, -18.002266429747763, -20.874870604564997, 10.370403978696096, -30.869049658717174, -3.771304894424828, 6.835931290603217, 3.643367094663283, -40.28893789302222, -8.099553064978878, 7.485379923053431, 0.6352319510437283, 25.63102517154785, -38.85000017084653, 10.60107719705282, -17.00380805412412, -0.4505354060182576, -34.090733747494895, 20.070291241531464, -22.409102326950876, -30.22524651998218, -15.502228714764904, 43.506419170887035, -36.91383099210307, 19.87242706315552, -19.26083407603948, -24.230767808335738, 4.761418029882875, 10.786129442544247, -38.82873796438338, -31.21764186195093, 4.056945508658661, 11.030753193094913, -46.223831515225264, 2.988585671099372, -34.348566264831625, -44.16935706103171, -39.87850776172115, -35.94609206368138, 9.609555452464626, 9.097921717842109, 11.366360283813364, -40.576430663744176, -36.193757814254454, 11.518909961057064, -15.654198912677558, 3.165331389958828, 5.037352759188606, -13.404656427341664, -45.85159170644894, -47.879052725691025, 33.43371152698774, 26.04974416172887, -1.512769012319632, -19.392460466972054, -38.64098639837689, 6.7069520225384, -20.973294429020154, 12.293803430805612, -29.565793455007245, 10.25416897503227, -34.4995449779815, 20.702835772508735, 12.722892356376558, -27.062151539882166, -15.260507356510864, -13.34826003422748, 25.072419343714444, 11.990985299097504, -32.21773283982011, 3.1609419186356877, 15.01543211166788, -50.78824130416166, -9.083453902207985, 6.996027032868423, -2.8400378284107646, -19.42046037147513, -18.960788052927782, -0.8923493079836788, -26.39681886398609, 39.57394341956547, -31.95519038963281, -47.07898165262327, -22.805285401714933, 5.765665217238563, -27.23650847119535, 27.507330914331806, -43.91189811778129, -5.300185685109195, -5.2650156683880525, -4.374978467409456, 3.744587627643199, -28.953899584805626, 20.31582441013981, 36.7660923953076, -37.440388302019365, 15.95821937776938, 23.691283163510022, 19.972238571463365, -24.119041212888902, -15.862422798846922, 26.317528135338936, 15.90662591188951, -4.547124726271704, 17.371463665825075, 14.460825508709423, -40.46271867648903, 3.9239869662284086, 6.827880130273108, 20.569323393535466, -61.49311110889107, 14.08454706411477, -29.249072649821606, 10.569858772356275, -30.828289997782257, -42.257553190471036, 3.270200120525578, -15.571680132292471, -34.30420966446916, -30.211476303607753, 27.837941590406132, 19.549087103344256, -47.51054523001884, -7.952781133979137, 17.521421762007076, -32.903845324251556, -1.1338475918278323, -32.32930983796757, 14.551795575083666, -52.67721521911194, -45.83932583575296, 15.29552590593207, 12.45938338130113, -19.250817100722628, 16.16273439365644, 18.300277484880116, 3.427792737408631, 4.947595219551939, 10.07021976843014, 15.875648655887673, 10.657121845859058, -21.15867289621997, -31.391564834534304, 27.510006758654573, -31.447717331570853, -26.808777534448268, 1.7809228443367502, -29.95016916224558, 6.087570780262043, 0.6327296110171554, -33.614611329244354, -48.96427614799846, 2.1974742316432474, -34.34971242086464, -0.5788836268428259, -54.679437418785874, 2.1324251147634854, 5.619368891548792, 32.212095455254754, 18.519831823989662, -25.326305994566532, -28.46282399084823, 22.98103178812633, -54.49314698618748, -46.99308490208077, -26.913095203558854, 24.574133055244268, 21.90258104977893, -29.22342441195749, 20.307043997665406, -11.508302153623355, 15.185491345086003, 17.635397630725635, -27.996560723120602, 6.534476452181188, 26.959682564510004, -17.34061175003916, 16.62560299673165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44380290133488537, "mean_inference_ms": 1.1891561535509367, "mean_action_processing_ms": 0.19132881283375916, "mean_env_wait_ms": 0.07991380563994738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003288745880126953, "StateBufferConnector_ms": 0.0026826858520507812, "ViewRequirementAgentConnector_ms": 0.06538712978363037}, "num_episodes": 12, "episode_return_max": 25.365963639622215, "episode_return_min": -42.023932411376414, "episode_return_mean": -8.141196320476073}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.14027256559547, "num_env_steps_trained_throughput_per_sec": 481.14027256559547, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 8173.033, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8172.99, "sample_time_ms": 758.169, "learn_time_ms": 7400.833, "learn_throughput": 540.48, "synch_weights_time_ms": 13.409}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 90, "trial_id": "83a5c_00000", "date": "2024-08-10_12-26-59", "timestamp": 1723307219, "time_this_iter_s": 8.318115949630737, "time_total_s": 782.5377285480499, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb6bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 782.5377285480499, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 27.000000000000004, "ram_util_percent": 81.05833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.597757887430292, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.425355399727191, "policy_loss": -0.0054125439099691535, "vf_loss": 4.430402123108112, "vf_explained_var": -0.5030971146449841, "kl": 0.013702440703123165, "entropy": 0.9620059480427434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4599917899817227, "cur_kl_coeff": 0.0022247314453124997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.4966364406049255, "policy_loss": -0.004553471828451923, "vf_loss": 4.501181038469076, "vf_explained_var": 0.18125717900693417, "kl": 0.003987665522585798, "entropy": 0.4407901600003242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "env_runners": {"episode_reward_max": 28.973463032473415, "episode_reward_min": -44.69284011991687, "episode_reward_mean": -5.850085292706755, "episode_len_mean": 281.9, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 28190, "policy_reward_min": {"agent_policy": -28.973463032473433, "adversary_policy": -61.49311110889107}, "policy_reward_max": {"agent_policy": 44.69284011991688, "adversary_policy": 52.45219526709257}, "policy_reward_mean": {"agent_policy": 5.850085292706756, "adversary_policy": -5.850085292706755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3057964935580202, -9.734674889226431, -14.021304260919566, -13.580348176646146, -17.596539161065166, -15.67999029686612, -42.023932411376414, -13.16826830560838, 10.232141000827735, -38.385094238999315, -2.067644475810247, 4.101342074573717, -29.628124066895307, -7.222670599351645, 12.268487574704618, -29.016723432674475, -7.133171203240877, -8.635995012100818, -12.122688001474616, 16.71286406444264, -21.161329448196515, 5.862079654743482, -10.113373770361308, 9.088187015151783, -29.93584760318482, 2.077994602228829, -19.190624212201456, -13.644584085984887, 3.8093765149663246, -34.9421335271691, -10.735421626978393, -8.202283601724739, -5.282600676748622, -0.31519541988312927, -4.319037587332901, -0.3371479533558803, 19.824751270639716, -2.073401320712769, 5.227552668246005, 5.679750592808902, 15.91614458726725, -18.269365855130324, 13.698601761904284, -23.70428202238815, -9.339606938732665, -36.542921594126646, -6.150740005883446, -32.257842984038454, 23.693514346875187, -27.73166318199897, -7.69121178112224, -16.73157871489769, -19.06270982201415, -15.27189996491045, -3.3957168597107428, 17.23150593926828, 4.187693978480288, 12.972934212158908, -5.250775525180449, -1.9407790379398664, -29.12824743300956, -14.084623158954415, 3.360150195639599, -41.28944373862139, -16.076119094610696, -27.62916052281434, 3.8758970031561386, 25.365963639622215, -26.89456499270738, -15.756057599030573, -36.9530900528198, 23.238357052511603, -4.458190207146042, 1.8385945957313243, -5.180581546197488, 16.74707950834559, -0.3575043766537538, 15.352428134281519, 7.542663103098025, 21.438530479244296, 15.794796411912337, 1.0551260058461231, 6.1136760229083595, 17.26943762866161, 16.684145594798625, -44.69284011991687, -5.361624657170311, 4.004935956919164, -0.07727118865419325, -11.882766879587615, -38.94272814493013, 28.973463032473415, -5.037208732965644, 8.195431090704577, 13.857072844590217, -37.454224947439265, -6.0972809350274, 4.687197113031322, 23.524245207725, -15.853666262301342], "episode_lengths": [218, 94, 400, 400, 400, 400, 400, 54, 28, 400, 248, 400, 400, 188, 400, 400, 83, 400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 177, 400, 400, 100, 400, 400, 400, 52, 400, 160, 138, 77, 400, 400, 400, 400, 400, 400, 400, 400, 116, 400, 119, 400, 400, 400, 85, 172, 400, 120, 108, 82, 400, 400, 400, 400, 400, 400, 400, 140, 400, 394, 400, 142, 96, 128, 400, 400, 236, 159, 57, 136, 54, 107, 81, 27, 129, 400, 400, 136, 80, 400, 400, 237, 110, 74, 76, 400, 229, 116, 400, 400], "policy_agent_policy_reward": [-0.3057964935580202, 9.734674889226433, 14.021304260919553, 13.580348176646138, 17.596539161065177, 15.679990296866116, 42.02393241137639, 13.16826830560838, -10.232141000827733, 38.38509423899932, 2.0676444758102477, -4.101342074573717, 29.628124066895296, 7.222670599351648, -12.26848757470462, 29.01672343267447, 7.133171203240886, 8.635995012100821, 12.122688001474621, -16.712864064442638, 21.161329448196515, -5.862079654743482, 10.113373770361306, -9.088187015151785, 29.93584760318482, -2.0779946022288294, 19.190624212201456, 13.644584085984885, -3.8093765149663232, 34.942133527169105, 10.735421626978393, 8.202283601724746, 5.282600676748622, 0.31519541988312927, 4.319037587332903, 0.3371479533558803, -19.8247512706397, 2.0734013207127675, -5.227552668246005, -5.679750592808903, -15.916144587267251, 18.269365855130328, -13.698601761904285, 23.704282022388153, 9.339606938732663, 36.54292159412665, 6.150740005883447, 32.257842984038454, -23.693514346875194, 27.731663181999018, 7.691211781122238, 16.731578714897704, 19.062709822014153, 15.271899964910437, 3.3957168597107463, -17.23150593926827, -4.187693978480287, -12.972934212158911, 5.2507755251804555, 1.9407790379398655, 29.12824743300956, 14.084623158954413, -3.360150195639599, 41.28944373862138, 16.076119094610686, 27.629160522814345, -3.8758970031561386, -25.365963639622212, 26.89456499270738, 15.756057599030584, 36.953090052819825, -23.238357052511606, 4.458190207146042, -1.8385945957313243, 5.180581546197489, -16.747079508345585, 0.357504376653754, -15.352428134281517, -7.542663103098027, -21.438530479244307, -15.794796411912337, -1.0551260058461231, -6.113676022908361, -17.269437628661617, -16.684145594798622, 44.69284011991688, 5.36162465717031, -4.004935956919164, 0.07727118865419413, 11.882766879587614, 38.94272814493012, -28.973463032473433, 5.037208732965645, -8.195431090704577, -13.857072844590217, 37.45422494743926, 6.097280935027394, -4.687197113031322, -23.524245207725, 15.853666262301338], "policy_adversary_policy_reward": [19.87242706315552, -19.26083407603948, -24.230767808335738, 4.761418029882875, 10.786129442544247, -38.82873796438338, -31.21764186195093, 4.056945508658661, 11.030753193094913, -46.223831515225264, 2.988585671099372, -34.348566264831625, -44.16935706103171, -39.87850776172115, -35.94609206368138, 9.609555452464626, 9.097921717842109, 11.366360283813364, -40.576430663744176, -36.193757814254454, 11.518909961057064, -15.654198912677558, 3.165331389958828, 5.037352759188606, -13.404656427341664, -45.85159170644894, -47.879052725691025, 33.43371152698774, 26.04974416172887, -1.512769012319632, -19.392460466972054, -38.64098639837689, 6.7069520225384, -20.973294429020154, 12.293803430805612, -29.565793455007245, 10.25416897503227, -34.4995449779815, 20.702835772508735, 12.722892356376558, -27.062151539882166, -15.260507356510864, -13.34826003422748, 25.072419343714444, 11.990985299097504, -32.21773283982011, 3.1609419186356877, 15.01543211166788, -50.78824130416166, -9.083453902207985, 6.996027032868423, -2.8400378284107646, -19.42046037147513, -18.960788052927782, -0.8923493079836788, -26.39681886398609, 39.57394341956547, -31.95519038963281, -47.07898165262327, -22.805285401714933, 5.765665217238563, -27.23650847119535, 27.507330914331806, -43.91189811778129, -5.300185685109195, -5.2650156683880525, -4.374978467409456, 3.744587627643199, -28.953899584805626, 20.31582441013981, 36.7660923953076, -37.440388302019365, 15.95821937776938, 23.691283163510022, 19.972238571463365, -24.119041212888902, -15.862422798846922, 26.317528135338936, 15.90662591188951, -4.547124726271704, 17.371463665825075, 14.460825508709423, -40.46271867648903, 3.9239869662284086, 6.827880130273108, 20.569323393535466, -61.49311110889107, 14.08454706411477, -29.249072649821606, 10.569858772356275, -30.828289997782257, -42.257553190471036, 3.270200120525578, -15.571680132292471, -34.30420966446916, -30.211476303607753, 27.837941590406132, 19.549087103344256, -47.51054523001884, -7.952781133979137, 17.521421762007076, -32.903845324251556, -1.1338475918278323, -32.32930983796757, 14.551795575083666, -52.67721521911194, -45.83932583575296, 15.29552590593207, 12.45938338130113, -19.250817100722628, 16.16273439365644, 18.300277484880116, 3.427792737408631, 4.947595219551939, 10.07021976843014, 15.875648655887673, 10.657121845859058, -21.15867289621997, -31.391564834534304, 27.510006758654573, -31.447717331570853, -26.808777534448268, 1.7809228443367502, -29.95016916224558, 6.087570780262043, 0.6327296110171554, -33.614611329244354, -48.96427614799846, 2.1974742316432474, -34.34971242086464, -0.5788836268428259, -54.679437418785874, 2.1324251147634854, 5.619368891548792, 32.212095455254754, 18.519831823989662, -25.326305994566532, -28.46282399084823, 22.98103178812633, -54.49314698618748, -46.99308490208077, -26.913095203558854, 24.574133055244268, 21.90258104977893, -29.22342441195749, 20.307043997665406, -11.508302153623355, 15.185491345086003, 17.635397630725635, -27.996560723120602, 6.534476452181188, 26.959682564510004, -17.34061175003916, 16.62560299673165, 9.306063748428402, 21.398792520134627, -29.417777665665255, 44.50310387186131, 16.94425842274551, 25.932802535743097, 14.439974369748175, 17.149618454076492, -16.061922268478362, 18.17217428017061, -5.529186747456567, 17.756538793273293, 21.995201721964182, 12.543673535359044, 52.45219526709257, -19.083904077495298, -40.26476555327094, -49.12091468656284, -16.021879474581688, 5.298630160241068, -23.698772331147037, 31.70864424498537, 10.584612386206132, -10.739154763514517, 20.924859259301797, -44.69039301847703, -49.536567444960305, -28.348888844899932, 27.64570971379276, 30.3012163511541, 21.266803997959588, -31.34122146389089, 8.42082064755461, 7.970041533854545, 12.060205297089697, 15.653940392090744, -35.02806286173782, -39.88038703314069, 22.438977733774657, -34.633539603829455, 31.045909720284875, -21.671515494222227, 21.635306837125633, 25.413183578324364, -1.388602487623853, -30.318730036978806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44261024630534357, "mean_inference_ms": 1.1844814005905633, "mean_action_processing_ms": 0.19073882430912525, "mean_env_wait_ms": 0.07949096203745457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003365755081176758, "StateBufferConnector_ms": 0.0027033090591430664, "ViewRequirementAgentConnector_ms": 0.06640219688415527}, "num_episodes": 23, "episode_return_max": 28.973463032473415, "episode_return_min": -44.69284011991687, "episode_return_mean": -5.850085292706755}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.4021326825395, "num_env_steps_trained_throughput_per_sec": 494.4021326825395, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1092000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 8182.324, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8182.282, "sample_time_ms": 752.894, "learn_time_ms": 7415.401, "learn_throughput": 539.418, "synch_weights_time_ms": 13.402}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "training_iteration": 91, "trial_id": "83a5c_00000", "date": "2024-08-10_12-27-08", "timestamp": 1723307228, "time_this_iter_s": 8.095925092697144, "time_total_s": 790.6336536407471, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb63ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 790.6336536407471, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 26.236363636363635, "ram_util_percent": 81.1909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.655497272683199, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.232806494942418, "policy_loss": -0.0060450020192003755, "vf_loss": 3.2386441520912936, "vf_explained_var": -0.41933624293438343, "kl": 0.007766618299372058, "entropy": 0.9903643245104129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9891782737957935, "cur_kl_coeff": 0.0011123657226562499, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1569534218559663, "policy_loss": -0.006949679844061999, "vf_loss": 3.163886891802152, "vf_explained_var": 0.2703227882583936, "kl": 0.014585704559919059, "entropy": 0.32519218356659013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 39.032160495537404, "episode_reward_min": -48.65951890527176, "episode_reward_mean": -5.349634109729103, "episode_len_mean": 274.04, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 27404, "policy_reward_min": {"agent_policy": -39.03216049553749, "adversary_policy": -61.49311110889107}, "policy_reward_max": {"agent_policy": 48.65951890527177, "adversary_policy": 52.45219526709257}, "policy_reward_mean": {"agent_policy": 5.349634109729103, "adversary_policy": -5.349634109729102}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.635995012100818, -12.122688001474616, 16.71286406444264, -21.161329448196515, 5.862079654743482, -10.113373770361308, 9.088187015151783, -29.93584760318482, 2.077994602228829, -19.190624212201456, -13.644584085984887, 3.8093765149663246, -34.9421335271691, -10.735421626978393, -8.202283601724739, -5.282600676748622, -0.31519541988312927, -4.319037587332901, -0.3371479533558803, 19.824751270639716, -2.073401320712769, 5.227552668246005, 5.679750592808902, 15.91614458726725, -18.269365855130324, 13.698601761904284, -23.70428202238815, -9.339606938732665, -36.542921594126646, -6.150740005883446, -32.257842984038454, 23.693514346875187, -27.73166318199897, -7.69121178112224, -16.73157871489769, -19.06270982201415, -15.27189996491045, -3.3957168597107428, 17.23150593926828, 4.187693978480288, 12.972934212158908, -5.250775525180449, -1.9407790379398664, -29.12824743300956, -14.084623158954415, 3.360150195639599, -41.28944373862139, -16.076119094610696, -27.62916052281434, 3.8758970031561386, 25.365963639622215, -26.89456499270738, -15.756057599030573, -36.9530900528198, 23.238357052511603, -4.458190207146042, 1.8385945957313243, -5.180581546197488, 16.74707950834559, -0.3575043766537538, 15.352428134281519, 7.542663103098025, 21.438530479244296, 15.794796411912337, 1.0551260058461231, 6.1136760229083595, 17.26943762866161, 16.684145594798625, -44.69284011991687, -5.361624657170311, 4.004935956919164, -0.07727118865419325, -11.882766879587615, -38.94272814493013, 28.973463032473415, -5.037208732965644, 8.195431090704577, 13.857072844590217, -37.454224947439265, -6.0972809350274, 4.687197113031322, 23.524245207725, -15.853666262301342, -15.103778928061079, 5.812972223041979, -48.65951890527176, -20.547739329545834, -43.711367444366424, 20.61067244595356, -4.934328976663669, -16.15258432025542, -1.7155253824512222, -44.18997907401153, 0.558764124826242, 39.032160495537404, -6.575459165548786, 16.68097570446102, 3.5530295926609936, 0.6965379840768537, -47.6604311216331], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 27, 400, 400, 177, 400, 400, 100, 400, 400, 400, 52, 400, 160, 138, 77, 400, 400, 400, 400, 400, 400, 400, 400, 116, 400, 119, 400, 400, 400, 85, 172, 400, 120, 108, 82, 400, 400, 400, 400, 400, 400, 400, 140, 400, 394, 400, 142, 96, 128, 400, 400, 236, 159, 57, 136, 54, 107, 81, 27, 129, 400, 400, 136, 80, 400, 400, 237, 110, 74, 76, 400, 229, 116, 400, 400, 400, 264, 400, 400, 400, 68, 400, 150, 400, 400, 82, 202, 95, 36, 29, 1, 400], "policy_agent_policy_reward": [8.635995012100821, 12.122688001474621, -16.712864064442638, 21.161329448196515, -5.862079654743482, 10.113373770361306, -9.088187015151785, 29.93584760318482, -2.0779946022288294, 19.190624212201456, 13.644584085984885, -3.8093765149663232, 34.942133527169105, 10.735421626978393, 8.202283601724746, 5.282600676748622, 0.31519541988312927, 4.319037587332903, 0.3371479533558803, -19.8247512706397, 2.0734013207127675, -5.227552668246005, -5.679750592808903, -15.916144587267251, 18.269365855130328, -13.698601761904285, 23.704282022388153, 9.339606938732663, 36.54292159412665, 6.150740005883447, 32.257842984038454, -23.693514346875194, 27.731663181999018, 7.691211781122238, 16.731578714897704, 19.062709822014153, 15.271899964910437, 3.3957168597107463, -17.23150593926827, -4.187693978480287, -12.972934212158911, 5.2507755251804555, 1.9407790379398655, 29.12824743300956, 14.084623158954413, -3.360150195639599, 41.28944373862138, 16.076119094610686, 27.629160522814345, -3.8758970031561386, -25.365963639622212, 26.89456499270738, 15.756057599030584, 36.953090052819825, -23.238357052511606, 4.458190207146042, -1.8385945957313243, 5.180581546197489, -16.747079508345585, 0.357504376653754, -15.352428134281517, -7.542663103098027, -21.438530479244307, -15.794796411912337, -1.0551260058461231, -6.113676022908361, -17.269437628661617, -16.684145594798622, 44.69284011991688, 5.36162465717031, -4.004935956919164, 0.07727118865419413, 11.882766879587614, 38.94272814493012, -28.973463032473433, 5.037208732965645, -8.195431090704577, -13.857072844590217, 37.45422494743926, 6.097280935027394, -4.687197113031322, -23.524245207725, 15.853666262301338, 15.103778928061082, -5.812972223041981, 48.65951890527177, 20.54773932954582, 43.71136744436643, -20.610672445953554, 4.934328976663669, 16.15258432025544, 1.7155253824512222, 44.189979074011525, -0.558764124826242, -39.03216049553749, 6.575459165548783, -16.680975704461016, -3.553029592660994, -0.6965379840768537, 47.66043112163311], "policy_adversary_policy_reward": [12.293803430805612, -29.565793455007245, 10.25416897503227, -34.4995449779815, 20.702835772508735, 12.722892356376558, -27.062151539882166, -15.260507356510864, -13.34826003422748, 25.072419343714444, 11.990985299097504, -32.21773283982011, 3.1609419186356877, 15.01543211166788, -50.78824130416166, -9.083453902207985, 6.996027032868423, -2.8400378284107646, -19.42046037147513, -18.960788052927782, -0.8923493079836788, -26.39681886398609, 39.57394341956547, -31.95519038963281, -47.07898165262327, -22.805285401714933, 5.765665217238563, -27.23650847119535, 27.507330914331806, -43.91189811778129, -5.300185685109195, -5.2650156683880525, -4.374978467409456, 3.744587627643199, -28.953899584805626, 20.31582441013981, 36.7660923953076, -37.440388302019365, 15.95821937776938, 23.691283163510022, 19.972238571463365, -24.119041212888902, -15.862422798846922, 26.317528135338936, 15.90662591188951, -4.547124726271704, 17.371463665825075, 14.460825508709423, -40.46271867648903, 3.9239869662284086, 6.827880130273108, 20.569323393535466, -61.49311110889107, 14.08454706411477, -29.249072649821606, 10.569858772356275, -30.828289997782257, -42.257553190471036, 3.270200120525578, -15.571680132292471, -34.30420966446916, -30.211476303607753, 27.837941590406132, 19.549087103344256, -47.51054523001884, -7.952781133979137, 17.521421762007076, -32.903845324251556, -1.1338475918278323, -32.32930983796757, 14.551795575083666, -52.67721521911194, -45.83932583575296, 15.29552590593207, 12.45938338130113, -19.250817100722628, 16.16273439365644, 18.300277484880116, 3.427792737408631, 4.947595219551939, 10.07021976843014, 15.875648655887673, 10.657121845859058, -21.15867289621997, -31.391564834534304, 27.510006758654573, -31.447717331570853, -26.808777534448268, 1.7809228443367502, -29.95016916224558, 6.087570780262043, 0.6327296110171554, -33.614611329244354, -48.96427614799846, 2.1974742316432474, -34.34971242086464, -0.5788836268428259, -54.679437418785874, 2.1324251147634854, 5.619368891548792, 32.212095455254754, 18.519831823989662, -25.326305994566532, -28.46282399084823, 22.98103178812633, -54.49314698618748, -46.99308490208077, -26.913095203558854, 24.574133055244268, 21.90258104977893, -29.22342441195749, 20.307043997665406, -11.508302153623355, 15.185491345086003, 17.635397630725635, -27.996560723120602, 6.534476452181188, 26.959682564510004, -17.34061175003916, 16.62560299673165, 9.306063748428402, 21.398792520134627, -29.417777665665255, 44.50310387186131, 16.94425842274551, 25.932802535743097, 14.439974369748175, 17.149618454076492, -16.061922268478362, 18.17217428017061, -5.529186747456567, 17.756538793273293, 21.995201721964182, 12.543673535359044, 52.45219526709257, -19.083904077495298, -40.26476555327094, -49.12091468656284, -16.021879474581688, 5.298630160241068, -23.698772331147037, 31.70864424498537, 10.584612386206132, -10.739154763514517, 20.924859259301797, -44.69039301847703, -49.536567444960305, -28.348888844899932, 27.64570971379276, 30.3012163511541, 21.266803997959588, -31.34122146389089, 8.42082064755461, 7.970041533854545, 12.060205297089697, 15.653940392090744, -35.02806286173782, -39.88038703314069, 22.438977733774657, -34.633539603829455, 31.045909720284875, -21.671515494222227, 21.635306837125633, 25.413183578324364, -1.388602487623853, -30.318730036978806, -54.818935910559134, 24.611378054436962, 45.542654487875296, -33.91671004179133, -55.17502850849493, -42.144009302048595, -49.661246346089236, 8.56576768699758, -28.956601160529374, -58.466133728203474, 17.559724084970902, 23.661620806936224, 22.193821535416276, -32.06247948874362, 3.134144743426166, -35.43931338393704, -25.103534297537685, 21.67248353263524, -48.36080908716613, -40.019149060856904, 14.872223993810096, -13.754695744157615, 52.08990801826424, 25.97441297281067, -31.773493632934585, 18.622575301837017, 10.637561314985843, 22.724390093936186, -16.520250450734256, 23.62630963605624, 0.0, 1.3930759681537075, -51.8969183920781, -43.42394385118809]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4420014810304182, "mean_inference_ms": 1.1808856308244713, "mean_action_processing_ms": 0.19055766546674183, "mean_env_wait_ms": 0.07925301691365984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034248828887939453, "StateBufferConnector_ms": 0.002697467803955078, "ViewRequirementAgentConnector_ms": 0.06465888023376465}, "num_episodes": 17, "episode_return_max": 39.032160495537404, "episode_return_min": -48.65951890527176, "episode_return_mean": -5.349634109729103}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 508.1190484858114, "num_env_steps_trained_throughput_per_sec": 508.1190484858114, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 8155.22, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8155.179, "sample_time_ms": 750.047, "learn_time_ms": 7391.507, "learn_throughput": 541.162, "synch_weights_time_ms": 13.043}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 92, "trial_id": "83a5c_00000", "date": "2024-08-10_12-27-15", "timestamp": 1723307235, "time_this_iter_s": 7.877583980560303, "time_total_s": 798.5112376213074, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb6b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 798.5112376213074, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 25.25, "ram_util_percent": 81.20833333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.574709872026292, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.913735159301253, "policy_loss": -0.005737777952986853, "vf_loss": 2.9192960015680423, "vf_explained_var": -0.5167618716204608, "kl": 0.006627428084385145, "entropy": 1.117149946235475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.320189209282398, "cur_kl_coeff": 0.0011123657226562499, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.688913551469644, "policy_loss": -0.006655811765328205, "vf_loss": 3.6955467936893305, "vf_explained_var": 0.32683482244610784, "kl": 0.020290531499755692, "entropy": 0.31583825952063005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "env_runners": {"episode_reward_max": 39.032160495537404, "episode_reward_min": -51.38833633334873, "episode_reward_mean": -5.677071514346356, "episode_len_mean": 259.5, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 25950, "policy_reward_min": {"agent_policy": -39.03216049553749, "adversary_policy": -61.49311110889107}, "policy_reward_max": {"agent_policy": 51.38833633334874, "adversary_policy": 52.45219526709257}, "policy_reward_mean": {"agent_policy": 5.677071514346356, "adversary_policy": -5.6770715143463555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.202283601724739, -5.282600676748622, -0.31519541988312927, -4.319037587332901, -0.3371479533558803, 19.824751270639716, -2.073401320712769, 5.227552668246005, 5.679750592808902, 15.91614458726725, -18.269365855130324, 13.698601761904284, -23.70428202238815, -9.339606938732665, -36.542921594126646, -6.150740005883446, -32.257842984038454, 23.693514346875187, -27.73166318199897, -7.69121178112224, -16.73157871489769, -19.06270982201415, -15.27189996491045, -3.3957168597107428, 17.23150593926828, 4.187693978480288, 12.972934212158908, -5.250775525180449, -1.9407790379398664, -29.12824743300956, -14.084623158954415, 3.360150195639599, -41.28944373862139, -16.076119094610696, -27.62916052281434, 3.8758970031561386, 25.365963639622215, -26.89456499270738, -15.756057599030573, -36.9530900528198, 23.238357052511603, -4.458190207146042, 1.8385945957313243, -5.180581546197488, 16.74707950834559, -0.3575043766537538, 15.352428134281519, 7.542663103098025, 21.438530479244296, 15.794796411912337, 1.0551260058461231, 6.1136760229083595, 17.26943762866161, 16.684145594798625, -44.69284011991687, -5.361624657170311, 4.004935956919164, -0.07727118865419325, -11.882766879587615, -38.94272814493013, 28.973463032473415, -5.037208732965644, 8.195431090704577, 13.857072844590217, -37.454224947439265, -6.0972809350274, 4.687197113031322, 23.524245207725, -15.853666262301342, -15.103778928061079, 5.812972223041979, -48.65951890527176, -20.547739329545834, -43.711367444366424, 20.61067244595356, -4.934328976663669, -16.15258432025542, -1.7155253824512222, -44.18997907401153, 0.558764124826242, 39.032160495537404, -6.575459165548786, 16.68097570446102, 3.5530295926609936, 0.6965379840768537, -47.6604311216331, -46.311910556359955, -38.58686483109314, 4.000608259054162, -15.580350794032086, -18.96985456031636, 14.72926969932267, -38.683096868494836, 9.035170670915683, -28.383600316204213, 16.624075639565454, -51.38833633334873, 21.238643544159032, -9.2987430072168, 25.89975355620498], "episode_lengths": [100, 400, 400, 400, 52, 400, 160, 138, 77, 400, 400, 400, 400, 400, 400, 400, 400, 116, 400, 119, 400, 400, 400, 85, 172, 400, 120, 108, 82, 400, 400, 400, 400, 400, 400, 400, 140, 400, 394, 400, 142, 96, 128, 400, 400, 236, 159, 57, 136, 54, 107, 81, 27, 129, 400, 400, 136, 80, 400, 400, 237, 110, 74, 76, 400, 229, 116, 400, 400, 400, 264, 400, 400, 400, 68, 400, 150, 400, 400, 82, 202, 95, 36, 29, 1, 400, 400, 400, 106, 400, 203, 106, 400, 141, 400, 172, 400, 117, 124, 181], "policy_agent_policy_reward": [8.202283601724746, 5.282600676748622, 0.31519541988312927, 4.319037587332903, 0.3371479533558803, -19.8247512706397, 2.0734013207127675, -5.227552668246005, -5.679750592808903, -15.916144587267251, 18.269365855130328, -13.698601761904285, 23.704282022388153, 9.339606938732663, 36.54292159412665, 6.150740005883447, 32.257842984038454, -23.693514346875194, 27.731663181999018, 7.691211781122238, 16.731578714897704, 19.062709822014153, 15.271899964910437, 3.3957168597107463, -17.23150593926827, -4.187693978480287, -12.972934212158911, 5.2507755251804555, 1.9407790379398655, 29.12824743300956, 14.084623158954413, -3.360150195639599, 41.28944373862138, 16.076119094610686, 27.629160522814345, -3.8758970031561386, -25.365963639622212, 26.89456499270738, 15.756057599030584, 36.953090052819825, -23.238357052511606, 4.458190207146042, -1.8385945957313243, 5.180581546197489, -16.747079508345585, 0.357504376653754, -15.352428134281517, -7.542663103098027, -21.438530479244307, -15.794796411912337, -1.0551260058461231, -6.113676022908361, -17.269437628661617, -16.684145594798622, 44.69284011991688, 5.36162465717031, -4.004935956919164, 0.07727118865419413, 11.882766879587614, 38.94272814493012, -28.973463032473433, 5.037208732965645, -8.195431090704577, -13.857072844590217, 37.45422494743926, 6.097280935027394, -4.687197113031322, -23.524245207725, 15.853666262301338, 15.103778928061082, -5.812972223041981, 48.65951890527177, 20.54773932954582, 43.71136744436643, -20.610672445953554, 4.934328976663669, 16.15258432025544, 1.7155253824512222, 44.189979074011525, -0.558764124826242, -39.03216049553749, 6.575459165548783, -16.680975704461016, -3.553029592660994, -0.6965379840768537, 47.66043112163311, 46.31191055635996, 38.586864831093145, -4.000608259054163, 15.580350794032078, 18.969854560316378, -14.729269699322675, 38.68309686849484, -9.035170670915683, 28.383600316204213, -16.62407563956545, 51.38833633334874, -21.238643544159032, 9.298743007216805, -25.899753556204992], "policy_adversary_policy_reward": [27.507330914331806, -43.91189811778129, -5.300185685109195, -5.2650156683880525, -4.374978467409456, 3.744587627643199, -28.953899584805626, 20.31582441013981, 36.7660923953076, -37.440388302019365, 15.95821937776938, 23.691283163510022, 19.972238571463365, -24.119041212888902, -15.862422798846922, 26.317528135338936, 15.90662591188951, -4.547124726271704, 17.371463665825075, 14.460825508709423, -40.46271867648903, 3.9239869662284086, 6.827880130273108, 20.569323393535466, -61.49311110889107, 14.08454706411477, -29.249072649821606, 10.569858772356275, -30.828289997782257, -42.257553190471036, 3.270200120525578, -15.571680132292471, -34.30420966446916, -30.211476303607753, 27.837941590406132, 19.549087103344256, -47.51054523001884, -7.952781133979137, 17.521421762007076, -32.903845324251556, -1.1338475918278323, -32.32930983796757, 14.551795575083666, -52.67721521911194, -45.83932583575296, 15.29552590593207, 12.45938338130113, -19.250817100722628, 16.16273439365644, 18.300277484880116, 3.427792737408631, 4.947595219551939, 10.07021976843014, 15.875648655887673, 10.657121845859058, -21.15867289621997, -31.391564834534304, 27.510006758654573, -31.447717331570853, -26.808777534448268, 1.7809228443367502, -29.95016916224558, 6.087570780262043, 0.6327296110171554, -33.614611329244354, -48.96427614799846, 2.1974742316432474, -34.34971242086464, -0.5788836268428259, -54.679437418785874, 2.1324251147634854, 5.619368891548792, 32.212095455254754, 18.519831823989662, -25.326305994566532, -28.46282399084823, 22.98103178812633, -54.49314698618748, -46.99308490208077, -26.913095203558854, 24.574133055244268, 21.90258104977893, -29.22342441195749, 20.307043997665406, -11.508302153623355, 15.185491345086003, 17.635397630725635, -27.996560723120602, 6.534476452181188, 26.959682564510004, -17.34061175003916, 16.62560299673165, 9.306063748428402, 21.398792520134627, -29.417777665665255, 44.50310387186131, 16.94425842274551, 25.932802535743097, 14.439974369748175, 17.149618454076492, -16.061922268478362, 18.17217428017061, -5.529186747456567, 17.756538793273293, 21.995201721964182, 12.543673535359044, 52.45219526709257, -19.083904077495298, -40.26476555327094, -49.12091468656284, -16.021879474581688, 5.298630160241068, -23.698772331147037, 31.70864424498537, 10.584612386206132, -10.739154763514517, 20.924859259301797, -44.69039301847703, -49.536567444960305, -28.348888844899932, 27.64570971379276, 30.3012163511541, 21.266803997959588, -31.34122146389089, 8.42082064755461, 7.970041533854545, 12.060205297089697, 15.653940392090744, -35.02806286173782, -39.88038703314069, 22.438977733774657, -34.633539603829455, 31.045909720284875, -21.671515494222227, 21.635306837125633, 25.413183578324364, -1.388602487623853, -30.318730036978806, -54.818935910559134, 24.611378054436962, 45.542654487875296, -33.91671004179133, -55.17502850849493, -42.144009302048595, -49.661246346089236, 8.56576768699758, -28.956601160529374, -58.466133728203474, 17.559724084970902, 23.661620806936224, 22.193821535416276, -32.06247948874362, 3.134144743426166, -35.43931338393704, -25.103534297537685, 21.67248353263524, -48.36080908716613, -40.019149060856904, 14.872223993810096, -13.754695744157615, 52.08990801826424, 25.97441297281067, -31.773493632934585, 18.622575301837017, 10.637561314985843, 22.724390093936186, -16.520250450734256, 23.62630963605624, 0.0, 1.3930759681537075, -51.8969183920781, -43.42394385118809, -45.79919832163965, -46.82462279108025, -27.481874095629934, -49.691855566556356, -14.40691002192127, 22.408126540029603, -3.0736725779575966, -28.08702901010657, 4.637623756706503, -42.57733287733926, 14.370208824929156, 15.088330573716194, -40.881859126270236, -36.48433461071946, 34.260707608842495, -16.19036626701113, -26.685452400144477, -30.081748232263948, 23.083734909563674, 10.164416369567228, -45.9860381548565, -56.79063451184097, 15.648432796959247, 26.828854291358795, -29.17341783882486, 10.575931824391258, 18.351857947679857, 33.44764916473014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44131590861279657, "mean_inference_ms": 1.1789994642396207, "mean_action_processing_ms": 0.19030711526698815, "mean_env_wait_ms": 0.07911110820315846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033913850784301758, "StateBufferConnector_ms": 0.0027344226837158203, "ViewRequirementAgentConnector_ms": 0.06506013870239258}, "num_episodes": 14, "episode_return_max": 39.032160495537404, "episode_return_min": -51.38833633334873, "episode_return_mean": -5.677071514346356}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.78955877413506, "num_env_steps_trained_throughput_per_sec": 494.78955877413506, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 8129.017, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8128.976, "sample_time_ms": 747.634, "learn_time_ms": 7367.791, "learn_throughput": 542.904, "synch_weights_time_ms": 12.928}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "training_iteration": 93, "trial_id": "83a5c_00000", "date": "2024-08-10_12-27-24", "timestamp": 1723307244, "time_this_iter_s": 8.089153051376343, "time_total_s": 806.6003906726837, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5adaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 806.6003906726837, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 27.318181818181817, "ram_util_percent": 81.18181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.179588749768242, "cur_kl_coeff": 0.02669677734374999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.013165721060738, "policy_loss": -0.009056858627726792, "vf_loss": 4.021540600912911, "vf_explained_var": -0.39911401013217906, "kl": 0.025545579421824723, "entropy": 1.1159927838063113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1657242107515535, "cur_kl_coeff": 0.0016685485839843745, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.502842232584953, "policy_loss": -0.005225760463751309, "vf_loss": 4.508053333808978, "vf_explained_var": 0.32735707275569437, "kl": 0.008784616045669786, "entropy": 0.47222996472070616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": 47.86182034726343, "episode_reward_min": -60.71213453850932, "episode_reward_mean": -6.207259544692067, "episode_len_mean": 255.74, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 25574, "policy_reward_min": {"agent_policy": -47.86182034726339, "adversary_policy": -67.51604527199166}, "policy_reward_max": {"agent_policy": 60.71213453850931, "adversary_policy": 52.45219526709257}, "policy_reward_mean": {"agent_policy": 6.207259544692068, "adversary_policy": -6.207259544692067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.542921594126646, -6.150740005883446, -32.257842984038454, 23.693514346875187, -27.73166318199897, -7.69121178112224, -16.73157871489769, -19.06270982201415, -15.27189996491045, -3.3957168597107428, 17.23150593926828, 4.187693978480288, 12.972934212158908, -5.250775525180449, -1.9407790379398664, -29.12824743300956, -14.084623158954415, 3.360150195639599, -41.28944373862139, -16.076119094610696, -27.62916052281434, 3.8758970031561386, 25.365963639622215, -26.89456499270738, -15.756057599030573, -36.9530900528198, 23.238357052511603, -4.458190207146042, 1.8385945957313243, -5.180581546197488, 16.74707950834559, -0.3575043766537538, 15.352428134281519, 7.542663103098025, 21.438530479244296, 15.794796411912337, 1.0551260058461231, 6.1136760229083595, 17.26943762866161, 16.684145594798625, -44.69284011991687, -5.361624657170311, 4.004935956919164, -0.07727118865419325, -11.882766879587615, -38.94272814493013, 28.973463032473415, -5.037208732965644, 8.195431090704577, 13.857072844590217, -37.454224947439265, -6.0972809350274, 4.687197113031322, 23.524245207725, -15.853666262301342, -15.103778928061079, 5.812972223041979, -48.65951890527176, -20.547739329545834, -43.711367444366424, 20.61067244595356, -4.934328976663669, -16.15258432025542, -1.7155253824512222, -44.18997907401153, 0.558764124826242, 39.032160495537404, -6.575459165548786, 16.68097570446102, 3.5530295926609936, 0.6965379840768537, -47.6604311216331, -46.311910556359955, -38.58686483109314, 4.000608259054162, -15.580350794032086, -18.96985456031636, 14.72926969932267, -38.683096868494836, 9.035170670915683, -28.383600316204213, 16.624075639565454, -51.38833633334873, 21.238643544159032, -9.2987430072168, 25.89975355620498, -21.85019691446195, 26.857700306742906, 13.677057536265323, -5.8558365578084945, 47.86182034726343, 8.57842158479617, -37.41398624076219, 27.589819792953534, -4.655536197156526, -60.71213453850932, 18.006699732013107, -0.546426545783552, -40.49457437476466, -35.55775146050198], "episode_lengths": [400, 400, 400, 116, 400, 119, 400, 400, 400, 85, 172, 400, 120, 108, 82, 400, 400, 400, 400, 400, 400, 400, 140, 400, 394, 400, 142, 96, 128, 400, 400, 236, 159, 57, 136, 54, 107, 81, 27, 129, 400, 400, 136, 80, 400, 400, 237, 110, 74, 76, 400, 229, 116, 400, 400, 400, 264, 400, 400, 400, 68, 400, 150, 400, 400, 82, 202, 95, 36, 29, 1, 400, 400, 400, 106, 400, 203, 106, 400, 141, 400, 172, 400, 117, 124, 181, 400, 222, 125, 209, 195, 90, 400, 241, 191, 400, 280, 198, 400, 400], "policy_agent_policy_reward": [36.54292159412665, 6.150740005883447, 32.257842984038454, -23.693514346875194, 27.731663181999018, 7.691211781122238, 16.731578714897704, 19.062709822014153, 15.271899964910437, 3.3957168597107463, -17.23150593926827, -4.187693978480287, -12.972934212158911, 5.2507755251804555, 1.9407790379398655, 29.12824743300956, 14.084623158954413, -3.360150195639599, 41.28944373862138, 16.076119094610686, 27.629160522814345, -3.8758970031561386, -25.365963639622212, 26.89456499270738, 15.756057599030584, 36.953090052819825, -23.238357052511606, 4.458190207146042, -1.8385945957313243, 5.180581546197489, -16.747079508345585, 0.357504376653754, -15.352428134281517, -7.542663103098027, -21.438530479244307, -15.794796411912337, -1.0551260058461231, -6.113676022908361, -17.269437628661617, -16.684145594798622, 44.69284011991688, 5.36162465717031, -4.004935956919164, 0.07727118865419413, 11.882766879587614, 38.94272814493012, -28.973463032473433, 5.037208732965645, -8.195431090704577, -13.857072844590217, 37.45422494743926, 6.097280935027394, -4.687197113031322, -23.524245207725, 15.853666262301338, 15.103778928061082, -5.812972223041981, 48.65951890527177, 20.54773932954582, 43.71136744436643, -20.610672445953554, 4.934328976663669, 16.15258432025544, 1.7155253824512222, 44.189979074011525, -0.558764124826242, -39.03216049553749, 6.575459165548783, -16.680975704461016, -3.553029592660994, -0.6965379840768537, 47.66043112163311, 46.31191055635996, 38.586864831093145, -4.000608259054163, 15.580350794032078, 18.969854560316378, -14.729269699322675, 38.68309686849484, -9.035170670915683, 28.383600316204213, -16.62407563956545, 51.38833633334874, -21.238643544159032, 9.298743007216805, -25.899753556204992, 21.85019691446195, -26.85770030674291, -13.677057536265325, 5.855836557808487, -47.86182034726339, -8.57842158479617, 37.4139862407622, -27.58981979295356, 4.655536197156524, 60.71213453850931, -18.00669973201311, 0.5464265457835564, 40.49457437476467, 35.55775146050198], "policy_adversary_policy_reward": [-30.828289997782257, -42.257553190471036, 3.270200120525578, -15.571680132292471, -34.30420966446916, -30.211476303607753, 27.837941590406132, 19.549087103344256, -47.51054523001884, -7.952781133979137, 17.521421762007076, -32.903845324251556, -1.1338475918278323, -32.32930983796757, 14.551795575083666, -52.67721521911194, -45.83932583575296, 15.29552590593207, 12.45938338130113, -19.250817100722628, 16.16273439365644, 18.300277484880116, 3.427792737408631, 4.947595219551939, 10.07021976843014, 15.875648655887673, 10.657121845859058, -21.15867289621997, -31.391564834534304, 27.510006758654573, -31.447717331570853, -26.808777534448268, 1.7809228443367502, -29.95016916224558, 6.087570780262043, 0.6327296110171554, -33.614611329244354, -48.96427614799846, 2.1974742316432474, -34.34971242086464, -0.5788836268428259, -54.679437418785874, 2.1324251147634854, 5.619368891548792, 32.212095455254754, 18.519831823989662, -25.326305994566532, -28.46282399084823, 22.98103178812633, -54.49314698618748, -46.99308490208077, -26.913095203558854, 24.574133055244268, 21.90258104977893, -29.22342441195749, 20.307043997665406, -11.508302153623355, 15.185491345086003, 17.635397630725635, -27.996560723120602, 6.534476452181188, 26.959682564510004, -17.34061175003916, 16.62560299673165, 9.306063748428402, 21.398792520134627, -29.417777665665255, 44.50310387186131, 16.94425842274551, 25.932802535743097, 14.439974369748175, 17.149618454076492, -16.061922268478362, 18.17217428017061, -5.529186747456567, 17.756538793273293, 21.995201721964182, 12.543673535359044, 52.45219526709257, -19.083904077495298, -40.26476555327094, -49.12091468656284, -16.021879474581688, 5.298630160241068, -23.698772331147037, 31.70864424498537, 10.584612386206132, -10.739154763514517, 20.924859259301797, -44.69039301847703, -49.536567444960305, -28.348888844899932, 27.64570971379276, 30.3012163511541, 21.266803997959588, -31.34122146389089, 8.42082064755461, 7.970041533854545, 12.060205297089697, 15.653940392090744, -35.02806286173782, -39.88038703314069, 22.438977733774657, -34.633539603829455, 31.045909720284875, -21.671515494222227, 21.635306837125633, 25.413183578324364, -1.388602487623853, -30.318730036978806, -54.818935910559134, 24.611378054436962, 45.542654487875296, -33.91671004179133, -55.17502850849493, -42.144009302048595, -49.661246346089236, 8.56576768699758, -28.956601160529374, -58.466133728203474, 17.559724084970902, 23.661620806936224, 22.193821535416276, -32.06247948874362, 3.134144743426166, -35.43931338393704, -25.103534297537685, 21.67248353263524, -48.36080908716613, -40.019149060856904, 14.872223993810096, -13.754695744157615, 52.08990801826424, 25.97441297281067, -31.773493632934585, 18.622575301837017, 10.637561314985843, 22.724390093936186, -16.520250450734256, 23.62630963605624, 0.0, 1.3930759681537075, -51.8969183920781, -43.42394385118809, -45.79919832163965, -46.82462279108025, -27.481874095629934, -49.691855566556356, -14.40691002192127, 22.408126540029603, -3.0736725779575966, -28.08702901010657, 4.637623756706503, -42.57733287733926, 14.370208824929156, 15.088330573716194, -40.881859126270236, -36.48433461071946, 34.260707608842495, -16.19036626701113, -26.685452400144477, -30.081748232263948, 23.083734909563674, 10.164416369567228, -45.9860381548565, -56.79063451184097, 15.648432796959247, 26.828854291358795, -29.17341783882486, 10.575931824391258, 18.351857947679857, 33.44764916473014, -27.41312819187896, -16.28726563704494, 38.886120341908494, 14.829280271577327, 14.90035123593494, 12.453763836595714, -27.415383066173707, 15.703709950556725, 46.45933730937263, 49.26430338515414, 11.075884545229153, 6.080958624363182, -52.91101340830214, -21.91695907322228, 31.15949618953965, 24.020143396367438, 14.068144667836147, -23.3792170621492, -53.90822380502694, -67.51604527199166, 30.370286143467524, 5.643113320558683, 26.927462115767682, -28.020315207334786, -48.40659327652136, -32.58255547300797, -32.956922180489194, -38.158580740514765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4408151857857166, "mean_inference_ms": 1.1769259031509687, "mean_action_processing_ms": 0.19009632543089863, "mean_env_wait_ms": 0.07893838465349295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034111738204956055, "StateBufferConnector_ms": 0.002843618392944336, "ViewRequirementAgentConnector_ms": 0.07249855995178223}, "num_episodes": 14, "episode_return_max": 47.86182034726343, "episode_return_min": -60.71213453850932, "episode_return_mean": -6.207259544692067}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.3583520766975, "num_env_steps_trained_throughput_per_sec": 482.3583520766975, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 8154.046, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8154.005, "sample_time_ms": 767.885, "learn_time_ms": 7372.54, "learn_throughput": 542.554, "synch_weights_time_ms": 12.958}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 94, "trial_id": "83a5c_00000", "date": "2024-08-10_12-27-32", "timestamp": 1723307252, "time_this_iter_s": 8.29776406288147, "time_total_s": 814.8981547355652, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faca310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 814.8981547355652, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 27.40833333333333, "ram_util_percent": 81.05833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.584082757669782, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9746423986223007, "policy_loss": -0.012869814373232502, "vf_loss": 3.9866472003321167, "vf_explained_var": -0.4863295851245759, "kl": 0.021600789087317624, "entropy": 1.0137129431679135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.459951032822331, "cur_kl_coeff": 0.0016685485839843745, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4053578192989034, "policy_loss": -0.004934069856729669, "vf_loss": 3.410275848582387, "vf_explained_var": 0.5618309311568737, "kl": 0.00960258898981431, "entropy": 0.4947421182257434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "env_runners": {"episode_reward_max": 47.86182034726343, "episode_reward_min": -60.72530206765155, "episode_reward_mean": -6.455421210891343, "episode_len_mean": 255.9, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 25590, "policy_reward_min": {"agent_policy": -47.86182034726339, "adversary_policy": -67.51604527199166}, "policy_reward_max": {"agent_policy": 60.72530206765154, "adversary_policy": 55.2028554104092}, "policy_reward_mean": {"agent_policy": 6.455421210891343, "adversary_policy": -6.455421210891343}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.12824743300956, -14.084623158954415, 3.360150195639599, -41.28944373862139, -16.076119094610696, -27.62916052281434, 3.8758970031561386, 25.365963639622215, -26.89456499270738, -15.756057599030573, -36.9530900528198, 23.238357052511603, -4.458190207146042, 1.8385945957313243, -5.180581546197488, 16.74707950834559, -0.3575043766537538, 15.352428134281519, 7.542663103098025, 21.438530479244296, 15.794796411912337, 1.0551260058461231, 6.1136760229083595, 17.26943762866161, 16.684145594798625, -44.69284011991687, -5.361624657170311, 4.004935956919164, -0.07727118865419325, -11.882766879587615, -38.94272814493013, 28.973463032473415, -5.037208732965644, 8.195431090704577, 13.857072844590217, -37.454224947439265, -6.0972809350274, 4.687197113031322, 23.524245207725, -15.853666262301342, -15.103778928061079, 5.812972223041979, -48.65951890527176, -20.547739329545834, -43.711367444366424, 20.61067244595356, -4.934328976663669, -16.15258432025542, -1.7155253824512222, -44.18997907401153, 0.558764124826242, 39.032160495537404, -6.575459165548786, 16.68097570446102, 3.5530295926609936, 0.6965379840768537, -47.6604311216331, -46.311910556359955, -38.58686483109314, 4.000608259054162, -15.580350794032086, -18.96985456031636, 14.72926969932267, -38.683096868494836, 9.035170670915683, -28.383600316204213, 16.624075639565454, -51.38833633334873, 21.238643544159032, -9.2987430072168, 25.89975355620498, -21.85019691446195, 26.857700306742906, 13.677057536265323, -5.8558365578084945, 47.86182034726343, 8.57842158479617, -37.41398624076219, 27.589819792953534, -4.655536197156526, -60.71213453850932, 18.006699732013107, -0.546426545783552, -40.49457437476466, -35.55775146050198, 9.489628879571224, -28.77566259861952, 28.534789204837253, -60.72530206765155, 1.4308319634368765, -57.08746692410263, 38.24608064774645, -0.09353750613657752, 13.278127155215985, 9.150247022738608, -43.654033483400646, 15.086366347759103, -44.4826694237354, 1.9066397462596663, -21.062396578886773], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 140, 400, 394, 400, 142, 96, 128, 400, 400, 236, 159, 57, 136, 54, 107, 81, 27, 129, 400, 400, 136, 80, 400, 400, 237, 110, 74, 76, 400, 229, 116, 400, 400, 400, 264, 400, 400, 400, 68, 400, 150, 400, 400, 82, 202, 95, 36, 29, 1, 400, 400, 400, 106, 400, 203, 106, 400, 141, 400, 172, 400, 117, 124, 181, 400, 222, 125, 209, 195, 90, 400, 241, 191, 400, 280, 198, 400, 400, 180, 400, 287, 400, 197, 400, 286, 1, 208, 199, 400, 237, 400, 23, 400], "policy_agent_policy_reward": [29.12824743300956, 14.084623158954413, -3.360150195639599, 41.28944373862138, 16.076119094610686, 27.629160522814345, -3.8758970031561386, -25.365963639622212, 26.89456499270738, 15.756057599030584, 36.953090052819825, -23.238357052511606, 4.458190207146042, -1.8385945957313243, 5.180581546197489, -16.747079508345585, 0.357504376653754, -15.352428134281517, -7.542663103098027, -21.438530479244307, -15.794796411912337, -1.0551260058461231, -6.113676022908361, -17.269437628661617, -16.684145594798622, 44.69284011991688, 5.36162465717031, -4.004935956919164, 0.07727118865419413, 11.882766879587614, 38.94272814493012, -28.973463032473433, 5.037208732965645, -8.195431090704577, -13.857072844590217, 37.45422494743926, 6.097280935027394, -4.687197113031322, -23.524245207725, 15.853666262301338, 15.103778928061082, -5.812972223041981, 48.65951890527177, 20.54773932954582, 43.71136744436643, -20.610672445953554, 4.934328976663669, 16.15258432025544, 1.7155253824512222, 44.189979074011525, -0.558764124826242, -39.03216049553749, 6.575459165548783, -16.680975704461016, -3.553029592660994, -0.6965379840768537, 47.66043112163311, 46.31191055635996, 38.586864831093145, -4.000608259054163, 15.580350794032078, 18.969854560316378, -14.729269699322675, 38.68309686849484, -9.035170670915683, 28.383600316204213, -16.62407563956545, 51.38833633334874, -21.238643544159032, 9.298743007216805, -25.899753556204992, 21.85019691446195, -26.85770030674291, -13.677057536265325, 5.855836557808487, -47.86182034726339, -8.57842158479617, 37.4139862407622, -27.58981979295356, 4.655536197156524, 60.71213453850931, -18.00669973201311, 0.5464265457835564, 40.49457437476467, 35.55775146050198, -9.489628879571224, 28.77566259861952, -28.534789204837224, 60.72530206765154, -1.430831963436876, 57.08746692410262, -38.24608064774639, 0.09353750613657752, -13.278127155215978, -9.150247022738602, 43.65403348340065, -15.086366347759103, 44.48266942373541, -1.9066397462596654, 21.062396578886773], "policy_adversary_policy_reward": [-31.447717331570853, -26.808777534448268, 1.7809228443367502, -29.95016916224558, 6.087570780262043, 0.6327296110171554, -33.614611329244354, -48.96427614799846, 2.1974742316432474, -34.34971242086464, -0.5788836268428259, -54.679437418785874, 2.1324251147634854, 5.619368891548792, 32.212095455254754, 18.519831823989662, -25.326305994566532, -28.46282399084823, 22.98103178812633, -54.49314698618748, -46.99308490208077, -26.913095203558854, 24.574133055244268, 21.90258104977893, -29.22342441195749, 20.307043997665406, -11.508302153623355, 15.185491345086003, 17.635397630725635, -27.996560723120602, 6.534476452181188, 26.959682564510004, -17.34061175003916, 16.62560299673165, 9.306063748428402, 21.398792520134627, -29.417777665665255, 44.50310387186131, 16.94425842274551, 25.932802535743097, 14.439974369748175, 17.149618454076492, -16.061922268478362, 18.17217428017061, -5.529186747456567, 17.756538793273293, 21.995201721964182, 12.543673535359044, 52.45219526709257, -19.083904077495298, -40.26476555327094, -49.12091468656284, -16.021879474581688, 5.298630160241068, -23.698772331147037, 31.70864424498537, 10.584612386206132, -10.739154763514517, 20.924859259301797, -44.69039301847703, -49.536567444960305, -28.348888844899932, 27.64570971379276, 30.3012163511541, 21.266803997959588, -31.34122146389089, 8.42082064755461, 7.970041533854545, 12.060205297089697, 15.653940392090744, -35.02806286173782, -39.88038703314069, 22.438977733774657, -34.633539603829455, 31.045909720284875, -21.671515494222227, 21.635306837125633, 25.413183578324364, -1.388602487623853, -30.318730036978806, -54.818935910559134, 24.611378054436962, 45.542654487875296, -33.91671004179133, -55.17502850849493, -42.144009302048595, -49.661246346089236, 8.56576768699758, -28.956601160529374, -58.466133728203474, 17.559724084970902, 23.661620806936224, 22.193821535416276, -32.06247948874362, 3.134144743426166, -35.43931338393704, -25.103534297537685, 21.67248353263524, -48.36080908716613, -40.019149060856904, 14.872223993810096, -13.754695744157615, 52.08990801826424, 25.97441297281067, -31.773493632934585, 18.622575301837017, 10.637561314985843, 22.724390093936186, -16.520250450734256, 23.62630963605624, 0.0, 1.3930759681537075, -51.8969183920781, -43.42394385118809, -45.79919832163965, -46.82462279108025, -27.481874095629934, -49.691855566556356, -14.40691002192127, 22.408126540029603, -3.0736725779575966, -28.08702901010657, 4.637623756706503, -42.57733287733926, 14.370208824929156, 15.088330573716194, -40.881859126270236, -36.48433461071946, 34.260707608842495, -16.19036626701113, -26.685452400144477, -30.081748232263948, 23.083734909563674, 10.164416369567228, -45.9860381548565, -56.79063451184097, 15.648432796959247, 26.828854291358795, -29.17341783882486, 10.575931824391258, 18.351857947679857, 33.44764916473014, -27.41312819187896, -16.28726563704494, 38.886120341908494, 14.829280271577327, 14.90035123593494, 12.453763836595714, -27.415383066173707, 15.703709950556725, 46.45933730937263, 49.26430338515414, 11.075884545229153, 6.080958624363182, -52.91101340830214, -21.91695907322228, 31.15949618953965, 24.020143396367438, 14.068144667836147, -23.3792170621492, -53.90822380502694, -67.51604527199166, 30.370286143467524, 5.643113320558683, 26.927462115767682, -28.020315207334786, -48.40659327652136, -32.58255547300797, -32.956922180489194, -38.158580740514765, 7.494518498622014, 11.484739260520433, -35.838454556120126, -21.71287064111891, 55.2028554104092, 1.8667229992652778, -57.66322934631553, -63.78737478898754, 22.55867109583823, -19.697007168964475, -47.58363165075635, -66.59130219744884, 24.818428729322093, 51.67373256617073, 0.0, -0.18707501227315504, -19.595568302452527, 46.15182261288448, 8.37426701818986, 9.926227027287352, -38.306849674416796, -49.00121729238454, 9.66038791352454, 20.512344781993658, -51.6061717928495, -37.35916705462134, 10.210064838103206, -6.396785345583875, -2.3489729398201433, -39.77582021795341]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44028900532035087, "mean_inference_ms": 1.1748878957072117, "mean_action_processing_ms": 0.18984246173798336, "mean_env_wait_ms": 0.07882578186802895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003428339958190918, "StateBufferConnector_ms": 0.0025304555892944336, "ViewRequirementAgentConnector_ms": 0.07186686992645264}, "num_episodes": 15, "episode_return_max": 47.86182034726343, "episode_return_min": -60.72530206765155, "episode_return_mean": -6.455421210891343}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.7187246215449, "num_env_steps_trained_throughput_per_sec": 489.7187246215449, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 8154.478, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8154.437, "sample_time_ms": 778.19, "learn_time_ms": 7362.727, "learn_throughput": 543.277, "synch_weights_time_ms": 12.877}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "training_iteration": 95, "trial_id": "83a5c_00000", "date": "2024-08-10_12-27-40", "timestamp": 1723307260, "time_this_iter_s": 8.173280000686646, "time_total_s": 823.0714347362518, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 823.0714347362518, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 25.974999999999998, "ram_util_percent": 81.00833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8238234839742145, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3934849289359237, "policy_loss": -0.005717855059694518, "vf_loss": 2.3986949317039006, "vf_explained_var": -0.3697409641490412, "kl": 0.008454675314296122, "entropy": 0.9525572240983368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.68765788829575, "cur_kl_coeff": 0.0016685485839843745, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9215805920461815, "policy_loss": -0.0023141697000634547, "vf_loss": 2.923887481043736, "vf_explained_var": 0.5508668373649319, "kl": 0.004364750153137995, "entropy": 0.31948483013547957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 47.86182034726343, "episode_reward_min": -60.72530206765155, "episode_reward_mean": -7.425315043400807, "episode_len_mean": 254.46, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 25446, "policy_reward_min": {"agent_policy": -47.86182034726339, "adversary_policy": -67.51604527199166}, "policy_reward_max": {"agent_policy": 60.72530206765154, "adversary_policy": 55.2028554104092}, "policy_reward_mean": {"agent_policy": 7.425315043400807, "adversary_policy": -7.425315043400807}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.458190207146042, 1.8385945957313243, -5.180581546197488, 16.74707950834559, -0.3575043766537538, 15.352428134281519, 7.542663103098025, 21.438530479244296, 15.794796411912337, 1.0551260058461231, 6.1136760229083595, 17.26943762866161, 16.684145594798625, -44.69284011991687, -5.361624657170311, 4.004935956919164, -0.07727118865419325, -11.882766879587615, -38.94272814493013, 28.973463032473415, -5.037208732965644, 8.195431090704577, 13.857072844590217, -37.454224947439265, -6.0972809350274, 4.687197113031322, 23.524245207725, -15.853666262301342, -15.103778928061079, 5.812972223041979, -48.65951890527176, -20.547739329545834, -43.711367444366424, 20.61067244595356, -4.934328976663669, -16.15258432025542, -1.7155253824512222, -44.18997907401153, 0.558764124826242, 39.032160495537404, -6.575459165548786, 16.68097570446102, 3.5530295926609936, 0.6965379840768537, -47.6604311216331, -46.311910556359955, -38.58686483109314, 4.000608259054162, -15.580350794032086, -18.96985456031636, 14.72926969932267, -38.683096868494836, 9.035170670915683, -28.383600316204213, 16.624075639565454, -51.38833633334873, 21.238643544159032, -9.2987430072168, 25.89975355620498, -21.85019691446195, 26.857700306742906, 13.677057536265323, -5.8558365578084945, 47.86182034726343, 8.57842158479617, -37.41398624076219, 27.589819792953534, -4.655536197156526, -60.71213453850932, 18.006699732013107, -0.546426545783552, -40.49457437476466, -35.55775146050198, 9.489628879571224, -28.77566259861952, 28.534789204837253, -60.72530206765155, 1.4308319634368765, -57.08746692410263, 38.24608064774645, -0.09353750613657752, 13.278127155215985, 9.150247022738608, -43.654033483400646, 15.086366347759103, -44.4826694237354, 1.9066397462596663, -21.062396578886773, -39.12964345599524, -32.45087754463258, -28.24504783734648, 20.28927615980555, -14.563828329392898, -4.356761460681032, -3.945435304962606, -49.11890299211851, -6.658526450970726, -54.07377717741395, -23.37180374265888, -13.334993816217638], "episode_lengths": [96, 128, 400, 400, 236, 159, 57, 136, 54, 107, 81, 27, 129, 400, 400, 136, 80, 400, 400, 237, 110, 74, 76, 400, 229, 116, 400, 400, 400, 264, 400, 400, 400, 68, 400, 150, 400, 400, 82, 202, 95, 36, 29, 1, 400, 400, 400, 106, 400, 203, 106, 400, 141, 400, 172, 400, 117, 124, 181, 400, 222, 125, 209, 195, 90, 400, 241, 191, 400, 280, 198, 400, 400, 180, 400, 287, 400, 197, 400, 286, 1, 208, 199, 400, 237, 400, 23, 400, 400, 400, 400, 49, 400, 400, 313, 400, 170, 400, 400, 400], "policy_agent_policy_reward": [4.458190207146042, -1.8385945957313243, 5.180581546197489, -16.747079508345585, 0.357504376653754, -15.352428134281517, -7.542663103098027, -21.438530479244307, -15.794796411912337, -1.0551260058461231, -6.113676022908361, -17.269437628661617, -16.684145594798622, 44.69284011991688, 5.36162465717031, -4.004935956919164, 0.07727118865419413, 11.882766879587614, 38.94272814493012, -28.973463032473433, 5.037208732965645, -8.195431090704577, -13.857072844590217, 37.45422494743926, 6.097280935027394, -4.687197113031322, -23.524245207725, 15.853666262301338, 15.103778928061082, -5.812972223041981, 48.65951890527177, 20.54773932954582, 43.71136744436643, -20.610672445953554, 4.934328976663669, 16.15258432025544, 1.7155253824512222, 44.189979074011525, -0.558764124826242, -39.03216049553749, 6.575459165548783, -16.680975704461016, -3.553029592660994, -0.6965379840768537, 47.66043112163311, 46.31191055635996, 38.586864831093145, -4.000608259054163, 15.580350794032078, 18.969854560316378, -14.729269699322675, 38.68309686849484, -9.035170670915683, 28.383600316204213, -16.62407563956545, 51.38833633334874, -21.238643544159032, 9.298743007216805, -25.899753556204992, 21.85019691446195, -26.85770030674291, -13.677057536265325, 5.855836557808487, -47.86182034726339, -8.57842158479617, 37.4139862407622, -27.58981979295356, 4.655536197156524, 60.71213453850931, -18.00669973201311, 0.5464265457835564, 40.49457437476467, 35.55775146050198, -9.489628879571224, 28.77566259861952, -28.534789204837224, 60.72530206765154, -1.430831963436876, 57.08746692410262, -38.24608064774639, 0.09353750613657752, -13.278127155215978, -9.150247022738602, 43.65403348340065, -15.086366347759103, 44.48266942373541, -1.9066397462596654, 21.062396578886773, 39.129643455995236, 32.45087754463258, 28.24504783734648, -20.28927615980556, 14.5638283293929, 4.356761460681032, 3.945435304962608, 49.118902992118514, 6.658526450970727, 54.07377717741396, 23.37180374265887, 13.334993816217636], "policy_adversary_policy_reward": [-29.22342441195749, 20.307043997665406, -11.508302153623355, 15.185491345086003, 17.635397630725635, -27.996560723120602, 6.534476452181188, 26.959682564510004, -17.34061175003916, 16.62560299673165, 9.306063748428402, 21.398792520134627, -29.417777665665255, 44.50310387186131, 16.94425842274551, 25.932802535743097, 14.439974369748175, 17.149618454076492, -16.061922268478362, 18.17217428017061, -5.529186747456567, 17.756538793273293, 21.995201721964182, 12.543673535359044, 52.45219526709257, -19.083904077495298, -40.26476555327094, -49.12091468656284, -16.021879474581688, 5.298630160241068, -23.698772331147037, 31.70864424498537, 10.584612386206132, -10.739154763514517, 20.924859259301797, -44.69039301847703, -49.536567444960305, -28.348888844899932, 27.64570971379276, 30.3012163511541, 21.266803997959588, -31.34122146389089, 8.42082064755461, 7.970041533854545, 12.060205297089697, 15.653940392090744, -35.02806286173782, -39.88038703314069, 22.438977733774657, -34.633539603829455, 31.045909720284875, -21.671515494222227, 21.635306837125633, 25.413183578324364, -1.388602487623853, -30.318730036978806, -54.818935910559134, 24.611378054436962, 45.542654487875296, -33.91671004179133, -55.17502850849493, -42.144009302048595, -49.661246346089236, 8.56576768699758, -28.956601160529374, -58.466133728203474, 17.559724084970902, 23.661620806936224, 22.193821535416276, -32.06247948874362, 3.134144743426166, -35.43931338393704, -25.103534297537685, 21.67248353263524, -48.36080908716613, -40.019149060856904, 14.872223993810096, -13.754695744157615, 52.08990801826424, 25.97441297281067, -31.773493632934585, 18.622575301837017, 10.637561314985843, 22.724390093936186, -16.520250450734256, 23.62630963605624, 0.0, 1.3930759681537075, -51.8969183920781, -43.42394385118809, -45.79919832163965, -46.82462279108025, -27.481874095629934, -49.691855566556356, -14.40691002192127, 22.408126540029603, -3.0736725779575966, -28.08702901010657, 4.637623756706503, -42.57733287733926, 14.370208824929156, 15.088330573716194, -40.881859126270236, -36.48433461071946, 34.260707608842495, -16.19036626701113, -26.685452400144477, -30.081748232263948, 23.083734909563674, 10.164416369567228, -45.9860381548565, -56.79063451184097, 15.648432796959247, 26.828854291358795, -29.17341783882486, 10.575931824391258, 18.351857947679857, 33.44764916473014, -27.41312819187896, -16.28726563704494, 38.886120341908494, 14.829280271577327, 14.90035123593494, 12.453763836595714, -27.415383066173707, 15.703709950556725, 46.45933730937263, 49.26430338515414, 11.075884545229153, 6.080958624363182, -52.91101340830214, -21.91695907322228, 31.15949618953965, 24.020143396367438, 14.068144667836147, -23.3792170621492, -53.90822380502694, -67.51604527199166, 30.370286143467524, 5.643113320558683, 26.927462115767682, -28.020315207334786, -48.40659327652136, -32.58255547300797, -32.956922180489194, -38.158580740514765, 7.494518498622014, 11.484739260520433, -35.838454556120126, -21.71287064111891, 55.2028554104092, 1.8667229992652778, -57.66322934631553, -63.78737478898754, 22.55867109583823, -19.697007168964475, -47.58363165075635, -66.59130219744884, 24.818428729322093, 51.67373256617073, 0.0, -0.18707501227315504, -19.595568302452527, 46.15182261288448, 8.37426701818986, 9.926227027287352, -38.306849674416796, -49.00121729238454, 9.66038791352454, 20.512344781993658, -51.6061717928495, -37.35916705462134, 10.210064838103206, -6.396785345583875, -2.3489729398201433, -39.77582021795341, -22.066446786114142, -56.19284012587631, -36.983470664194456, -27.91828442507071, -33.75245480661539, -22.737640868077555, 17.231990043978595, 23.3465622756325, 10.25971376507508, -39.38737042386088, -4.165269701828817, -4.548253219533246, 10.136829738709807, -18.027700348635022, -51.966066813143385, -46.27173917109371, 12.42846430181889, -25.74551720376035, -61.73874943631411, -46.408804918513745, -51.95805997459872, 5.214452489280973, -22.092056898743692, -4.577930733691575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43984974712882774, "mean_inference_ms": 1.1732465758282684, "mean_action_processing_ms": 0.18962711325701473, "mean_env_wait_ms": 0.07867546671465422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003422260284423828, "StateBufferConnector_ms": 0.002582550048828125, "ViewRequirementAgentConnector_ms": 0.07221436500549316}, "num_episodes": 12, "episode_return_max": 47.86182034726343, "episode_return_min": -60.72530206765155, "episode_return_mean": -7.425315043400807}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 497.697219588294, "num_env_steps_trained_throughput_per_sec": 497.697219588294, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 8123.531, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8123.494, "sample_time_ms": 782.308, "learn_time_ms": 7327.824, "learn_throughput": 545.865, "synch_weights_time_ms": 12.772}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 96, "trial_id": "83a5c_00000", "date": "2024-08-10_12-27-48", "timestamp": 1723307268, "time_this_iter_s": 8.041996955871582, "time_total_s": 831.1134316921234, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5803a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 831.1134316921234, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 25.927272727272733, "ram_util_percent": 81.03636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.77255479560958, "cur_kl_coeff": 0.060067749023437485, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7228693407048623, "policy_loss": -0.015728316467166655, "vf_loss": 2.7372466825934314, "vf_explained_var": -0.27449313137266373, "kl": 0.02249086124751986, "entropy": 1.026466029472452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.184857435400287, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.702410113811493, "policy_loss": -0.0050790057529714735, "vf_loss": 3.7074794014294943, "vf_explained_var": 0.3821045722191532, "kl": 0.01163085592278564, "entropy": 0.38796532278259593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "env_runners": {"episode_reward_max": 47.86182034726343, "episode_reward_min": -60.72530206765155, "episode_reward_mean": -11.193523011213554, "episode_len_mean": 271.21, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 27121, "policy_reward_min": {"agent_policy": -47.86182034726339, "adversary_policy": -67.51604527199166}, "policy_reward_max": {"agent_policy": 60.72530206765154, "adversary_policy": 55.2028554104092}, "policy_reward_mean": {"agent_policy": 11.193523011213554, "adversary_policy": -11.193523011213555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.004935956919164, -0.07727118865419325, -11.882766879587615, -38.94272814493013, 28.973463032473415, -5.037208732965644, 8.195431090704577, 13.857072844590217, -37.454224947439265, -6.0972809350274, 4.687197113031322, 23.524245207725, -15.853666262301342, -15.103778928061079, 5.812972223041979, -48.65951890527176, -20.547739329545834, -43.711367444366424, 20.61067244595356, -4.934328976663669, -16.15258432025542, -1.7155253824512222, -44.18997907401153, 0.558764124826242, 39.032160495537404, -6.575459165548786, 16.68097570446102, 3.5530295926609936, 0.6965379840768537, -47.6604311216331, -46.311910556359955, -38.58686483109314, 4.000608259054162, -15.580350794032086, -18.96985456031636, 14.72926969932267, -38.683096868494836, 9.035170670915683, -28.383600316204213, 16.624075639565454, -51.38833633334873, 21.238643544159032, -9.2987430072168, 25.89975355620498, -21.85019691446195, 26.857700306742906, 13.677057536265323, -5.8558365578084945, 47.86182034726343, 8.57842158479617, -37.41398624076219, 27.589819792953534, -4.655536197156526, -60.71213453850932, 18.006699732013107, -0.546426545783552, -40.49457437476466, -35.55775146050198, 9.489628879571224, -28.77566259861952, 28.534789204837253, -60.72530206765155, 1.4308319634368765, -57.08746692410263, 38.24608064774645, -0.09353750613657752, 13.278127155215985, 9.150247022738608, -43.654033483400646, 15.086366347759103, -44.4826694237354, 1.9066397462596663, -21.062396578886773, -39.12964345599524, -32.45087754463258, -28.24504783734648, 20.28927615980555, -14.563828329392898, -4.356761460681032, -3.945435304962606, -49.11890299211851, -6.658526450970726, -54.07377717741395, -23.37180374265888, -13.334993816217638, -42.05333978358591, -59.78931189777774, -25.91152938660474, -47.43877042765042, 9.915087300056173, -26.78759850750917, -47.797146449500076, -32.918833986682756, 38.36965896613787, 6.605360554602395, -24.138992177983514, -20.728592708601177, -50.21996742395164, 2.8591681453349658, 2.999747580184261], "episode_lengths": [136, 80, 400, 400, 237, 110, 74, 76, 400, 229, 116, 400, 400, 400, 264, 400, 400, 400, 68, 400, 150, 400, 400, 82, 202, 95, 36, 29, 1, 400, 400, 400, 106, 400, 203, 106, 400, 141, 400, 172, 400, 117, 124, 181, 400, 222, 125, 209, 195, 90, 400, 241, 191, 400, 280, 198, 400, 400, 180, 400, 287, 400, 197, 400, 286, 1, 208, 199, 400, 237, 400, 23, 400, 400, 400, 400, 49, 400, 400, 313, 400, 170, 400, 400, 400, 400, 400, 400, 400, 298, 400, 400, 400, 86, 24, 400, 400, 400, 5, 72], "policy_agent_policy_reward": [-4.004935956919164, 0.07727118865419413, 11.882766879587614, 38.94272814493012, -28.973463032473433, 5.037208732965645, -8.195431090704577, -13.857072844590217, 37.45422494743926, 6.097280935027394, -4.687197113031322, -23.524245207725, 15.853666262301338, 15.103778928061082, -5.812972223041981, 48.65951890527177, 20.54773932954582, 43.71136744436643, -20.610672445953554, 4.934328976663669, 16.15258432025544, 1.7155253824512222, 44.189979074011525, -0.558764124826242, -39.03216049553749, 6.575459165548783, -16.680975704461016, -3.553029592660994, -0.6965379840768537, 47.66043112163311, 46.31191055635996, 38.586864831093145, -4.000608259054163, 15.580350794032078, 18.969854560316378, -14.729269699322675, 38.68309686849484, -9.035170670915683, 28.383600316204213, -16.62407563956545, 51.38833633334874, -21.238643544159032, 9.298743007216805, -25.899753556204992, 21.85019691446195, -26.85770030674291, -13.677057536265325, 5.855836557808487, -47.86182034726339, -8.57842158479617, 37.4139862407622, -27.58981979295356, 4.655536197156524, 60.71213453850931, -18.00669973201311, 0.5464265457835564, 40.49457437476467, 35.55775146050198, -9.489628879571224, 28.77566259861952, -28.534789204837224, 60.72530206765154, -1.430831963436876, 57.08746692410262, -38.24608064774639, 0.09353750613657752, -13.278127155215978, -9.150247022738602, 43.65403348340065, -15.086366347759103, 44.48266942373541, -1.9066397462596654, 21.062396578886773, 39.129643455995236, 32.45087754463258, 28.24504783734648, -20.28927615980556, 14.5638283293929, 4.356761460681032, 3.945435304962608, 49.118902992118514, 6.658526450970727, 54.07377717741396, 23.37180374265887, 13.334993816217636, 42.053339783585905, 59.789311897777736, 25.91152938660474, 47.43877042765041, -9.915087300056175, 26.78759850750917, 47.7971464495001, 32.918833986682756, -38.36965896613786, -6.605360554602394, 24.138992177983514, 20.728592708601187, 50.21996742395163, -2.8591681453349658, -2.999747580184261], "policy_adversary_policy_reward": [-23.698772331147037, 31.70864424498537, 10.584612386206132, -10.739154763514517, 20.924859259301797, -44.69039301847703, -49.536567444960305, -28.348888844899932, 27.64570971379276, 30.3012163511541, 21.266803997959588, -31.34122146389089, 8.42082064755461, 7.970041533854545, 12.060205297089697, 15.653940392090744, -35.02806286173782, -39.88038703314069, 22.438977733774657, -34.633539603829455, 31.045909720284875, -21.671515494222227, 21.635306837125633, 25.413183578324364, -1.388602487623853, -30.318730036978806, -54.818935910559134, 24.611378054436962, 45.542654487875296, -33.91671004179133, -55.17502850849493, -42.144009302048595, -49.661246346089236, 8.56576768699758, -28.956601160529374, -58.466133728203474, 17.559724084970902, 23.661620806936224, 22.193821535416276, -32.06247948874362, 3.134144743426166, -35.43931338393704, -25.103534297537685, 21.67248353263524, -48.36080908716613, -40.019149060856904, 14.872223993810096, -13.754695744157615, 52.08990801826424, 25.97441297281067, -31.773493632934585, 18.622575301837017, 10.637561314985843, 22.724390093936186, -16.520250450734256, 23.62630963605624, 0.0, 1.3930759681537075, -51.8969183920781, -43.42394385118809, -45.79919832163965, -46.82462279108025, -27.481874095629934, -49.691855566556356, -14.40691002192127, 22.408126540029603, -3.0736725779575966, -28.08702901010657, 4.637623756706503, -42.57733287733926, 14.370208824929156, 15.088330573716194, -40.881859126270236, -36.48433461071946, 34.260707608842495, -16.19036626701113, -26.685452400144477, -30.081748232263948, 23.083734909563674, 10.164416369567228, -45.9860381548565, -56.79063451184097, 15.648432796959247, 26.828854291358795, -29.17341783882486, 10.575931824391258, 18.351857947679857, 33.44764916473014, -27.41312819187896, -16.28726563704494, 38.886120341908494, 14.829280271577327, 14.90035123593494, 12.453763836595714, -27.415383066173707, 15.703709950556725, 46.45933730937263, 49.26430338515414, 11.075884545229153, 6.080958624363182, -52.91101340830214, -21.91695907322228, 31.15949618953965, 24.020143396367438, 14.068144667836147, -23.3792170621492, -53.90822380502694, -67.51604527199166, 30.370286143467524, 5.643113320558683, 26.927462115767682, -28.020315207334786, -48.40659327652136, -32.58255547300797, -32.956922180489194, -38.158580740514765, 7.494518498622014, 11.484739260520433, -35.838454556120126, -21.71287064111891, 55.2028554104092, 1.8667229992652778, -57.66322934631553, -63.78737478898754, 22.55867109583823, -19.697007168964475, -47.58363165075635, -66.59130219744884, 24.818428729322093, 51.67373256617073, 0.0, -0.18707501227315504, -19.595568302452527, 46.15182261288448, 8.37426701818986, 9.926227027287352, -38.306849674416796, -49.00121729238454, 9.66038791352454, 20.512344781993658, -51.6061717928495, -37.35916705462134, 10.210064838103206, -6.396785345583875, -2.3489729398201433, -39.77582021795341, -22.066446786114142, -56.19284012587631, -36.983470664194456, -27.91828442507071, -33.75245480661539, -22.737640868077555, 17.231990043978595, 23.3465622756325, 10.25971376507508, -39.38737042386088, -4.165269701828817, -4.548253219533246, 10.136829738709807, -18.027700348635022, -51.966066813143385, -46.27173917109371, 12.42846430181889, -25.74551720376035, -61.73874943631411, -46.408804918513745, -51.95805997459872, 5.214452489280973, -22.092056898743692, -4.577930733691575, -55.50892599127789, -28.597753575893968, -56.37598805854962, -63.202635737005885, -40.09549378503393, -11.727564988175551, -30.066543337912606, -64.8109975173882, -13.218132464339092, 33.048307064451436, -34.11667087066122, -19.458526144357123, -28.60015234299781, -66.99414055600232, -28.512340817119906, -37.325327156245606, 45.26983766449261, 31.4694802677831, -2.768380365475757, 15.979101474680546, -12.620959122838151, -35.65702523312888, -46.393017033920415, 4.935831616718033, -52.97993226635664, -47.460002581546625, 3.079923804260334, 2.6384124864095986, 27.000381484770614, -21.000886324402092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4393481578438256, "mean_inference_ms": 1.171270398226479, "mean_action_processing_ms": 0.18937005484101646, "mean_env_wait_ms": 0.07860047689745633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003440260887145996, "StateBufferConnector_ms": 0.0029282569885253906, "ViewRequirementAgentConnector_ms": 0.07272398471832275}, "num_episodes": 15, "episode_return_max": 47.86182034726343, "episode_return_min": -60.72530206765155, "episode_return_mean": -11.193523011213554}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.3528424929365, "num_env_steps_trained_throughput_per_sec": 480.3528424929365, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 8135.926, "restore_workers_time_ms": 0.011, "training_step_time_ms": 8135.894, "sample_time_ms": 777.177, "learn_time_ms": 7345.577, "learn_throughput": 544.545, "synch_weights_time_ms": 12.553}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "training_iteration": 97, "trial_id": "83a5c_00000", "date": "2024-08-10_12-27-56", "timestamp": 1723307276, "time_this_iter_s": 8.331729888916016, "time_total_s": 839.4451615810394, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 839.4451615810394, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 27.108333333333338, "ram_util_percent": 81.35833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8232898841459284, "cur_kl_coeff": 0.09010162353515624, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2896035296576365, "policy_loss": -0.005209834630374437, "vf_loss": 3.2940895325292354, "vf_explained_var": -0.17660805390625403, "kl": 0.008033660530515234, "entropy": 0.8919703573461563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.67284024314334, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5412557014574606, "policy_loss": -0.003655448027711827, "vf_loss": 3.5449029276768367, "vf_explained_var": -0.1089974395930767, "kl": 0.009869963330880888, "entropy": 0.42560403131258984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": 47.86182034726343, "episode_reward_min": -60.72530206765155, "episode_reward_mean": -13.436537974880626, "episode_len_mean": 275.85, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 27585, "policy_reward_min": {"agent_policy": -47.86182034726339, "adversary_policy": -67.51604527199166}, "policy_reward_max": {"agent_policy": 60.72530206765154, "adversary_policy": 55.2028554104092}, "policy_reward_mean": {"agent_policy": 13.436537974880627, "adversary_policy": -13.436537974880627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.812972223041979, -48.65951890527176, -20.547739329545834, -43.711367444366424, 20.61067244595356, -4.934328976663669, -16.15258432025542, -1.7155253824512222, -44.18997907401153, 0.558764124826242, 39.032160495537404, -6.575459165548786, 16.68097570446102, 3.5530295926609936, 0.6965379840768537, -47.6604311216331, -46.311910556359955, -38.58686483109314, 4.000608259054162, -15.580350794032086, -18.96985456031636, 14.72926969932267, -38.683096868494836, 9.035170670915683, -28.383600316204213, 16.624075639565454, -51.38833633334873, 21.238643544159032, -9.2987430072168, 25.89975355620498, -21.85019691446195, 26.857700306742906, 13.677057536265323, -5.8558365578084945, 47.86182034726343, 8.57842158479617, -37.41398624076219, 27.589819792953534, -4.655536197156526, -60.71213453850932, 18.006699732013107, -0.546426545783552, -40.49457437476466, -35.55775146050198, 9.489628879571224, -28.77566259861952, 28.534789204837253, -60.72530206765155, 1.4308319634368765, -57.08746692410263, 38.24608064774645, -0.09353750613657752, 13.278127155215985, 9.150247022738608, -43.654033483400646, 15.086366347759103, -44.4826694237354, 1.9066397462596663, -21.062396578886773, -39.12964345599524, -32.45087754463258, -28.24504783734648, 20.28927615980555, -14.563828329392898, -4.356761460681032, -3.945435304962606, -49.11890299211851, -6.658526450970726, -54.07377717741395, -23.37180374265888, -13.334993816217638, -42.05333978358591, -59.78931189777774, -25.91152938660474, -47.43877042765042, 9.915087300056173, -26.78759850750917, -47.797146449500076, -32.918833986682756, 38.36965896613787, 6.605360554602395, -24.138992177983514, -20.728592708601177, -50.21996742395164, 2.8591681453349658, 2.999747580184261, -38.073967429534186, 7.816926644191792, -1.0381380630486463, -42.18781915762754, -11.580330207928883, -28.780490254174158, 17.406575159365435, -1.578287731086566, -4.866070687597847, -32.64907400268627, -55.44159986329836, -29.337674487139083, -9.581908967101683, -41.61621809256423], "episode_lengths": [264, 400, 400, 400, 68, 400, 150, 400, 400, 82, 202, 95, 36, 29, 1, 400, 400, 400, 106, 400, 203, 106, 400, 141, 400, 172, 400, 117, 124, 181, 400, 222, 125, 209, 195, 90, 400, 241, 191, 400, 280, 198, 400, 400, 180, 400, 287, 400, 197, 400, 286, 1, 208, 199, 400, 237, 400, 23, 400, 400, 400, 400, 49, 400, 400, 313, 400, 170, 400, 400, 400, 400, 400, 400, 400, 298, 400, 400, 400, 86, 24, 400, 400, 400, 5, 72, 400, 400, 62, 400, 170, 400, 195, 79, 84, 400, 400, 400, 132, 400], "policy_agent_policy_reward": [-5.812972223041981, 48.65951890527177, 20.54773932954582, 43.71136744436643, -20.610672445953554, 4.934328976663669, 16.15258432025544, 1.7155253824512222, 44.189979074011525, -0.558764124826242, -39.03216049553749, 6.575459165548783, -16.680975704461016, -3.553029592660994, -0.6965379840768537, 47.66043112163311, 46.31191055635996, 38.586864831093145, -4.000608259054163, 15.580350794032078, 18.969854560316378, -14.729269699322675, 38.68309686849484, -9.035170670915683, 28.383600316204213, -16.62407563956545, 51.38833633334874, -21.238643544159032, 9.298743007216805, -25.899753556204992, 21.85019691446195, -26.85770030674291, -13.677057536265325, 5.855836557808487, -47.86182034726339, -8.57842158479617, 37.4139862407622, -27.58981979295356, 4.655536197156524, 60.71213453850931, -18.00669973201311, 0.5464265457835564, 40.49457437476467, 35.55775146050198, -9.489628879571224, 28.77566259861952, -28.534789204837224, 60.72530206765154, -1.430831963436876, 57.08746692410262, -38.24608064774639, 0.09353750613657752, -13.278127155215978, -9.150247022738602, 43.65403348340065, -15.086366347759103, 44.48266942373541, -1.9066397462596654, 21.062396578886773, 39.129643455995236, 32.45087754463258, 28.24504783734648, -20.28927615980556, 14.5638283293929, 4.356761460681032, 3.945435304962608, 49.118902992118514, 6.658526450970727, 54.07377717741396, 23.37180374265887, 13.334993816217636, 42.053339783585905, 59.789311897777736, 25.91152938660474, 47.43877042765041, -9.915087300056175, 26.78759850750917, 47.7971464495001, 32.918833986682756, -38.36965896613786, -6.605360554602394, 24.138992177983514, 20.728592708601187, 50.21996742395163, -2.8591681453349658, -2.999747580184261, 38.07396742953418, -7.8169266441917955, 1.0381380630486463, 42.18781915762753, 11.580330207928892, 28.780490254174158, -17.40657515936544, 1.578287731086565, 4.866070687597848, 32.64907400268627, 55.44159986329835, 29.337674487139083, 9.581908967101677, 41.61621809256424], "policy_adversary_policy_reward": [45.542654487875296, -33.91671004179133, -55.17502850849493, -42.144009302048595, -49.661246346089236, 8.56576768699758, -28.956601160529374, -58.466133728203474, 17.559724084970902, 23.661620806936224, 22.193821535416276, -32.06247948874362, 3.134144743426166, -35.43931338393704, -25.103534297537685, 21.67248353263524, -48.36080908716613, -40.019149060856904, 14.872223993810096, -13.754695744157615, 52.08990801826424, 25.97441297281067, -31.773493632934585, 18.622575301837017, 10.637561314985843, 22.724390093936186, -16.520250450734256, 23.62630963605624, 0.0, 1.3930759681537075, -51.8969183920781, -43.42394385118809, -45.79919832163965, -46.82462279108025, -27.481874095629934, -49.691855566556356, -14.40691002192127, 22.408126540029603, -3.0736725779575966, -28.08702901010657, 4.637623756706503, -42.57733287733926, 14.370208824929156, 15.088330573716194, -40.881859126270236, -36.48433461071946, 34.260707608842495, -16.19036626701113, -26.685452400144477, -30.081748232263948, 23.083734909563674, 10.164416369567228, -45.9860381548565, -56.79063451184097, 15.648432796959247, 26.828854291358795, -29.17341783882486, 10.575931824391258, 18.351857947679857, 33.44764916473014, -27.41312819187896, -16.28726563704494, 38.886120341908494, 14.829280271577327, 14.90035123593494, 12.453763836595714, -27.415383066173707, 15.703709950556725, 46.45933730937263, 49.26430338515414, 11.075884545229153, 6.080958624363182, -52.91101340830214, -21.91695907322228, 31.15949618953965, 24.020143396367438, 14.068144667836147, -23.3792170621492, -53.90822380502694, -67.51604527199166, 30.370286143467524, 5.643113320558683, 26.927462115767682, -28.020315207334786, -48.40659327652136, -32.58255547300797, -32.956922180489194, -38.158580740514765, 7.494518498622014, 11.484739260520433, -35.838454556120126, -21.71287064111891, 55.2028554104092, 1.8667229992652778, -57.66322934631553, -63.78737478898754, 22.55867109583823, -19.697007168964475, -47.58363165075635, -66.59130219744884, 24.818428729322093, 51.67373256617073, 0.0, -0.18707501227315504, -19.595568302452527, 46.15182261288448, 8.37426701818986, 9.926227027287352, -38.306849674416796, -49.00121729238454, 9.66038791352454, 20.512344781993658, -51.6061717928495, -37.35916705462134, 10.210064838103206, -6.396785345583875, -2.3489729398201433, -39.77582021795341, -22.066446786114142, -56.19284012587631, -36.983470664194456, -27.91828442507071, -33.75245480661539, -22.737640868077555, 17.231990043978595, 23.3465622756325, 10.25971376507508, -39.38737042386088, -4.165269701828817, -4.548253219533246, 10.136829738709807, -18.027700348635022, -51.966066813143385, -46.27173917109371, 12.42846430181889, -25.74551720376035, -61.73874943631411, -46.408804918513745, -51.95805997459872, 5.214452489280973, -22.092056898743692, -4.577930733691575, -55.50892599127789, -28.597753575893968, -56.37598805854962, -63.202635737005885, -40.09549378503393, -11.727564988175551, -30.066543337912606, -64.8109975173882, -13.218132464339092, 33.048307064451436, -34.11667087066122, -19.458526144357123, -28.60015234299781, -66.99414055600232, -28.512340817119906, -37.325327156245606, 45.26983766449261, 31.4694802677831, -2.768380365475757, 15.979101474680546, -12.620959122838151, -35.65702523312888, -46.393017033920415, 4.935831616718033, -52.97993226635664, -47.460002581546625, 3.079923804260334, 2.6384124864095986, 27.000381484770614, -21.000886324402092, -38.19169681807647, -37.95623804099191, 8.981149705115065, 6.652703583268526, -16.161549297607117, 14.085273171509826, -53.31152217319551, -31.06411614205956, -32.15209859183258, 8.991438175974796, -32.4800076956376, -25.080972812710712, 16.648648582801997, 18.16450173592888, -13.091594172983875, 9.935018710810745, 16.009752945067927, -25.741894320263622, -39.603245169257015, -25.69490283611553, -56.09748337435617, -54.78571635224049, -36.566387689086746, -22.10896128519142, -35.657835024368445, 16.494017090165084, -45.658660086062525, -37.573776099065945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43883906489079694, "mean_inference_ms": 1.1690560862250137, "mean_action_processing_ms": 0.1890307626305905, "mean_env_wait_ms": 0.07850488571363262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00340425968170166, "StateBufferConnector_ms": 0.0029065608978271484, "ViewRequirementAgentConnector_ms": 0.07510089874267578}, "num_episodes": 14, "episode_return_max": 47.86182034726343, "episode_return_min": -60.72530206765155, "episode_return_mean": -13.436537974880626}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.19422654324904, "num_env_steps_trained_throughput_per_sec": 486.19422654324904, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 8148.934, "restore_workers_time_ms": 0.011, "training_step_time_ms": 8148.902, "sample_time_ms": 780.227, "learn_time_ms": 7355.508, "learn_throughput": 543.81, "synch_weights_time_ms": 12.631}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 98, "trial_id": "83a5c_00000", "date": "2024-08-10_12-28-05", "timestamp": 1723307285, "time_this_iter_s": 8.231979846954346, "time_total_s": 847.6771414279938, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0c9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 847.6771414279938, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 26.36666666666667, "ram_util_percent": 81.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.172510103794633, "cur_kl_coeff": 0.09010162353515624, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3394332575419594, "policy_loss": -0.005443836692055421, "vf_loss": 3.3442290390610063, "vf_explained_var": -0.18470321578323526, "kl": 0.0071925068546814, "entropy": 0.6388449793139462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.914318590797484, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.404594520976146, "policy_loss": -0.004662340844515711, "vf_loss": 3.40924931888779, "vf_explained_var": 0.10360032338649035, "kl": 0.009024867515806877, "entropy": 0.4122881856902192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "env_runners": {"episode_reward_max": 47.86182034726343, "episode_reward_min": -60.72530206765155, "episode_reward_mean": -12.178969014367965, "episode_len_mean": 280.25, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 28025, "policy_reward_min": {"agent_policy": -47.86182034726339, "adversary_policy": -68.38316008781057}, "policy_reward_max": {"agent_policy": 60.72530206765154, "adversary_policy": 55.2028554104092}, "policy_reward_mean": {"agent_policy": 12.178969014367965, "adversary_policy": -12.17896901436797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.68097570446102, 3.5530295926609936, 0.6965379840768537, -47.6604311216331, -46.311910556359955, -38.58686483109314, 4.000608259054162, -15.580350794032086, -18.96985456031636, 14.72926969932267, -38.683096868494836, 9.035170670915683, -28.383600316204213, 16.624075639565454, -51.38833633334873, 21.238643544159032, -9.2987430072168, 25.89975355620498, -21.85019691446195, 26.857700306742906, 13.677057536265323, -5.8558365578084945, 47.86182034726343, 8.57842158479617, -37.41398624076219, 27.589819792953534, -4.655536197156526, -60.71213453850932, 18.006699732013107, -0.546426545783552, -40.49457437476466, -35.55775146050198, 9.489628879571224, -28.77566259861952, 28.534789204837253, -60.72530206765155, 1.4308319634368765, -57.08746692410263, 38.24608064774645, -0.09353750613657752, 13.278127155215985, 9.150247022738608, -43.654033483400646, 15.086366347759103, -44.4826694237354, 1.9066397462596663, -21.062396578886773, -39.12964345599524, -32.45087754463258, -28.24504783734648, 20.28927615980555, -14.563828329392898, -4.356761460681032, -3.945435304962606, -49.11890299211851, -6.658526450970726, -54.07377717741395, -23.37180374265888, -13.334993816217638, -42.05333978358591, -59.78931189777774, -25.91152938660474, -47.43877042765042, 9.915087300056173, -26.78759850750917, -47.797146449500076, -32.918833986682756, 38.36965896613787, 6.605360554602395, -24.138992177983514, -20.728592708601177, -50.21996742395164, 2.8591681453349658, 2.999747580184261, -38.073967429534186, 7.816926644191792, -1.0381380630486463, -42.18781915762754, -11.580330207928883, -28.780490254174158, 17.406575159365435, -1.578287731086566, -4.866070687597847, -32.64907400268627, -55.44159986329836, -29.337674487139083, -9.581908967101683, -41.61621809256423, 22.10600100398241, 6.6810608446322854, 1.4174951047035584, 13.838503788280317, -35.120282820352806, -11.924948108925545, 26.596601406424167, -32.92941416405243, 19.78406595948415, 2.4875347729334076, -16.632315775342583, 8.980660730743487], "episode_lengths": [36, 29, 1, 400, 400, 400, 106, 400, 203, 106, 400, 141, 400, 172, 400, 117, 124, 181, 400, 222, 125, 209, 195, 90, 400, 241, 191, 400, 280, 198, 400, 400, 180, 400, 287, 400, 197, 400, 286, 1, 208, 199, 400, 237, 400, 23, 400, 400, 400, 400, 49, 400, 400, 313, 400, 170, 400, 400, 400, 400, 400, 400, 400, 298, 400, 400, 400, 86, 24, 400, 400, 400, 5, 72, 400, 400, 62, 400, 170, 400, 195, 79, 84, 400, 400, 400, 132, 400, 328, 400, 47, 400, 400, 359, 400, 400, 83, 84, 400, 400], "policy_agent_policy_reward": [-16.680975704461016, -3.553029592660994, -0.6965379840768537, 47.66043112163311, 46.31191055635996, 38.586864831093145, -4.000608259054163, 15.580350794032078, 18.969854560316378, -14.729269699322675, 38.68309686849484, -9.035170670915683, 28.383600316204213, -16.62407563956545, 51.38833633334874, -21.238643544159032, 9.298743007216805, -25.899753556204992, 21.85019691446195, -26.85770030674291, -13.677057536265325, 5.855836557808487, -47.86182034726339, -8.57842158479617, 37.4139862407622, -27.58981979295356, 4.655536197156524, 60.71213453850931, -18.00669973201311, 0.5464265457835564, 40.49457437476467, 35.55775146050198, -9.489628879571224, 28.77566259861952, -28.534789204837224, 60.72530206765154, -1.430831963436876, 57.08746692410262, -38.24608064774639, 0.09353750613657752, -13.278127155215978, -9.150247022738602, 43.65403348340065, -15.086366347759103, 44.48266942373541, -1.9066397462596654, 21.062396578886773, 39.129643455995236, 32.45087754463258, 28.24504783734648, -20.28927615980556, 14.5638283293929, 4.356761460681032, 3.945435304962608, 49.118902992118514, 6.658526450970727, 54.07377717741396, 23.37180374265887, 13.334993816217636, 42.053339783585905, 59.789311897777736, 25.91152938660474, 47.43877042765041, -9.915087300056175, 26.78759850750917, 47.7971464495001, 32.918833986682756, -38.36965896613786, -6.605360554602394, 24.138992177983514, 20.728592708601187, 50.21996742395163, -2.8591681453349658, -2.999747580184261, 38.07396742953418, -7.8169266441917955, 1.0381380630486463, 42.18781915762753, 11.580330207928892, 28.780490254174158, -17.40657515936544, 1.578287731086565, 4.866070687597848, 32.64907400268627, 55.44159986329835, 29.337674487139083, 9.581908967101677, 41.61621809256424, -22.10600100398242, -6.6810608446322854, -1.4174951047035584, -13.838503788280315, 35.1202828203528, 11.924948108925548, -26.596601406424142, 32.929414164052396, -19.784065959484156, -2.4875347729334063, 16.632315775342587, -8.980660730743487], "policy_adversary_policy_reward": [10.637561314985843, 22.724390093936186, -16.520250450734256, 23.62630963605624, 0.0, 1.3930759681537075, -51.8969183920781, -43.42394385118809, -45.79919832163965, -46.82462279108025, -27.481874095629934, -49.691855566556356, -14.40691002192127, 22.408126540029603, -3.0736725779575966, -28.08702901010657, 4.637623756706503, -42.57733287733926, 14.370208824929156, 15.088330573716194, -40.881859126270236, -36.48433461071946, 34.260707608842495, -16.19036626701113, -26.685452400144477, -30.081748232263948, 23.083734909563674, 10.164416369567228, -45.9860381548565, -56.79063451184097, 15.648432796959247, 26.828854291358795, -29.17341783882486, 10.575931824391258, 18.351857947679857, 33.44764916473014, -27.41312819187896, -16.28726563704494, 38.886120341908494, 14.829280271577327, 14.90035123593494, 12.453763836595714, -27.415383066173707, 15.703709950556725, 46.45933730937263, 49.26430338515414, 11.075884545229153, 6.080958624363182, -52.91101340830214, -21.91695907322228, 31.15949618953965, 24.020143396367438, 14.068144667836147, -23.3792170621492, -53.90822380502694, -67.51604527199166, 30.370286143467524, 5.643113320558683, 26.927462115767682, -28.020315207334786, -48.40659327652136, -32.58255547300797, -32.956922180489194, -38.158580740514765, 7.494518498622014, 11.484739260520433, -35.838454556120126, -21.71287064111891, 55.2028554104092, 1.8667229992652778, -57.66322934631553, -63.78737478898754, 22.55867109583823, -19.697007168964475, -47.58363165075635, -66.59130219744884, 24.818428729322093, 51.67373256617073, 0.0, -0.18707501227315504, -19.595568302452527, 46.15182261288448, 8.37426701818986, 9.926227027287352, -38.306849674416796, -49.00121729238454, 9.66038791352454, 20.512344781993658, -51.6061717928495, -37.35916705462134, 10.210064838103206, -6.396785345583875, -2.3489729398201433, -39.77582021795341, -22.066446786114142, -56.19284012587631, -36.983470664194456, -27.91828442507071, -33.75245480661539, -22.737640868077555, 17.231990043978595, 23.3465622756325, 10.25971376507508, -39.38737042386088, -4.165269701828817, -4.548253219533246, 10.136829738709807, -18.027700348635022, -51.966066813143385, -46.27173917109371, 12.42846430181889, -25.74551720376035, -61.73874943631411, -46.408804918513745, -51.95805997459872, 5.214452489280973, -22.092056898743692, -4.577930733691575, -55.50892599127789, -28.597753575893968, -56.37598805854962, -63.202635737005885, -40.09549378503393, -11.727564988175551, -30.066543337912606, -64.8109975173882, -13.218132464339092, 33.048307064451436, -34.11667087066122, -19.458526144357123, -28.60015234299781, -66.99414055600232, -28.512340817119906, -37.325327156245606, 45.26983766449261, 31.4694802677831, -2.768380365475757, 15.979101474680546, -12.620959122838151, -35.65702523312888, -46.393017033920415, 4.935831616718033, -52.97993226635664, -47.460002581546625, 3.079923804260334, 2.6384124864095986, 27.000381484770614, -21.000886324402092, -38.19169681807647, -37.95623804099191, 8.981149705115065, 6.652703583268526, -16.161549297607117, 14.085273171509826, -53.31152217319551, -31.06411614205956, -32.15209859183258, 8.991438175974796, -32.4800076956376, -25.080972812710712, 16.648648582801997, 18.16450173592888, -13.091594172983875, 9.935018710810745, 16.009752945067927, -25.741894320263622, -39.603245169257015, -25.69490283611553, -56.09748337435617, -54.78571635224049, -36.566387689086746, -22.10896128519142, -35.657835024368445, 16.494017090165084, -45.658660086062525, -37.573776099065945, 27.845564269426806, 16.36643773853803, 5.1654285920098495, 8.19669309725472, -23.78086602302815, 26.615856232435267, 10.191057910749347, 17.485949665811276, -36.08879092090502, -34.15177471980062, 3.854841325093478, -27.704737542944585, 15.476087959984582, 37.717114852863716, 2.5243317597058024, -68.38316008781057, 21.445718103971426, 18.122413814996875, -6.486592201615139, 11.461661747481951, 1.9788677060235091, -35.24349925670869, 17.39114868012962, 0.5701727813573543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43837011748242977, "mean_inference_ms": 1.1682103374142339, "mean_action_processing_ms": 0.18881831802884705, "mean_env_wait_ms": 0.07837390817628256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033904314041137695, "StateBufferConnector_ms": 0.0029376745223999023, "ViewRequirementAgentConnector_ms": 0.07610738277435303}, "num_episodes": 12, "episode_return_max": 47.86182034726343, "episode_return_min": -60.72530206765155, "episode_return_mean": -12.178969014367965}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.130123888145, "num_env_steps_trained_throughput_per_sec": 507.130123888145, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 8130.01, "restore_workers_time_ms": 0.011, "training_step_time_ms": 8129.979, "sample_time_ms": 793.636, "learn_time_ms": 7323.067, "learn_throughput": 546.219, "synch_weights_time_ms": 12.738}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "training_iteration": 99, "trial_id": "83a5c_00000", "date": "2024-08-10_12-28-13", "timestamp": 1723307293, "time_this_iter_s": 7.892496109008789, "time_total_s": 855.5696375370026, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f580700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 855.5696375370026, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 27.300000000000008, "ram_util_percent": 81.92727272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8113151365171665, "cur_kl_coeff": 0.09010162353515624, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6472128827105124, "policy_loss": -0.0059542922300616745, "vf_loss": 2.6525361395386793, "vf_explained_var": -0.3453049437394218, "kl": 0.0070035918423460445, "entropy": 0.58018834959893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.707270523160696, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2717699967324734, "policy_loss": -0.001665105320959507, "vf_loss": 2.273429006959001, "vf_explained_var": -0.26680722820262115, "kl": 0.007316431396447511, "entropy": 0.3464421142823994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 47.86182034726343, "episode_reward_min": -60.72530206765155, "episode_reward_mean": -10.40142723290159, "episode_len_mean": 288.95, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 28895, "policy_reward_min": {"agent_policy": -47.86182034726339, "adversary_policy": -68.38316008781057}, "policy_reward_max": {"agent_policy": 60.72530206765154, "adversary_policy": 55.2028554104092}, "policy_reward_mean": {"agent_policy": 10.40142723290159, "adversary_policy": -10.40142723290159}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.624075639565454, -51.38833633334873, 21.238643544159032, -9.2987430072168, 25.89975355620498, -21.85019691446195, 26.857700306742906, 13.677057536265323, -5.8558365578084945, 47.86182034726343, 8.57842158479617, -37.41398624076219, 27.589819792953534, -4.655536197156526, -60.71213453850932, 18.006699732013107, -0.546426545783552, -40.49457437476466, -35.55775146050198, 9.489628879571224, -28.77566259861952, 28.534789204837253, -60.72530206765155, 1.4308319634368765, -57.08746692410263, 38.24608064774645, -0.09353750613657752, 13.278127155215985, 9.150247022738608, -43.654033483400646, 15.086366347759103, -44.4826694237354, 1.9066397462596663, -21.062396578886773, -39.12964345599524, -32.45087754463258, -28.24504783734648, 20.28927615980555, -14.563828329392898, -4.356761460681032, -3.945435304962606, -49.11890299211851, -6.658526450970726, -54.07377717741395, -23.37180374265888, -13.334993816217638, -42.05333978358591, -59.78931189777774, -25.91152938660474, -47.43877042765042, 9.915087300056173, -26.78759850750917, -47.797146449500076, -32.918833986682756, 38.36965896613787, 6.605360554602395, -24.138992177983514, -20.728592708601177, -50.21996742395164, 2.8591681453349658, 2.999747580184261, -38.073967429534186, 7.816926644191792, -1.0381380630486463, -42.18781915762754, -11.580330207928883, -28.780490254174158, 17.406575159365435, -1.578287731086566, -4.866070687597847, -32.64907400268627, -55.44159986329836, -29.337674487139083, -9.581908967101683, -41.61621809256423, 22.10600100398241, 6.6810608446322854, 1.4174951047035584, 13.838503788280317, -35.120282820352806, -11.924948108925545, 26.596601406424167, -32.92941416405243, 19.78406595948415, 2.4875347729334076, -16.632315775342583, 8.980660730743487, 12.29778967618841, -12.210313037504012, 0.6877917563306881, -21.09692842975239, -18.78191317379825, -40.88893672815309, -0.71174571144737, 4.338192269081537, 3.686750546000919, 26.856307632755026, 4.428481631095753, 28.43822968998834, 5.229954888210036], "episode_lengths": [172, 400, 117, 124, 181, 400, 222, 125, 209, 195, 90, 400, 241, 191, 400, 280, 198, 400, 400, 180, 400, 287, 400, 197, 400, 286, 1, 208, 199, 400, 237, 400, 23, 400, 400, 400, 400, 49, 400, 400, 313, 400, 170, 400, 400, 400, 400, 400, 400, 400, 298, 400, 400, 400, 86, 24, 400, 400, 400, 5, 72, 400, 400, 62, 400, 170, 400, 195, 79, 84, 400, 400, 400, 132, 400, 328, 400, 47, 400, 400, 359, 400, 400, 83, 84, 400, 400, 400, 400, 400, 400, 400, 400, 66, 147, 31, 400, 400, 400, 48], "policy_agent_policy_reward": [-16.62407563956545, 51.38833633334874, -21.238643544159032, 9.298743007216805, -25.899753556204992, 21.85019691446195, -26.85770030674291, -13.677057536265325, 5.855836557808487, -47.86182034726339, -8.57842158479617, 37.4139862407622, -27.58981979295356, 4.655536197156524, 60.71213453850931, -18.00669973201311, 0.5464265457835564, 40.49457437476467, 35.55775146050198, -9.489628879571224, 28.77566259861952, -28.534789204837224, 60.72530206765154, -1.430831963436876, 57.08746692410262, -38.24608064774639, 0.09353750613657752, -13.278127155215978, -9.150247022738602, 43.65403348340065, -15.086366347759103, 44.48266942373541, -1.9066397462596654, 21.062396578886773, 39.129643455995236, 32.45087754463258, 28.24504783734648, -20.28927615980556, 14.5638283293929, 4.356761460681032, 3.945435304962608, 49.118902992118514, 6.658526450970727, 54.07377717741396, 23.37180374265887, 13.334993816217636, 42.053339783585905, 59.789311897777736, 25.91152938660474, 47.43877042765041, -9.915087300056175, 26.78759850750917, 47.7971464495001, 32.918833986682756, -38.36965896613786, -6.605360554602394, 24.138992177983514, 20.728592708601187, 50.21996742395163, -2.8591681453349658, -2.999747580184261, 38.07396742953418, -7.8169266441917955, 1.0381380630486463, 42.18781915762753, 11.580330207928892, 28.780490254174158, -17.40657515936544, 1.578287731086565, 4.866070687597848, 32.64907400268627, 55.44159986329835, 29.337674487139083, 9.581908967101677, 41.61621809256424, -22.10600100398242, -6.6810608446322854, -1.4174951047035584, -13.838503788280315, 35.1202828203528, 11.924948108925548, -26.596601406424142, 32.929414164052396, -19.784065959484156, -2.4875347729334063, 16.632315775342587, -8.980660730743487, -12.297789676188412, 12.210313037504012, -0.6877917563306872, 21.096928429752385, 18.78191317379825, 40.8889367281531, 0.71174571144737, -4.338192269081537, -3.6867505460009182, -26.85630763275504, -4.428481631095755, -28.438229689988326, -5.229954888210036], "policy_adversary_policy_reward": [23.083734909563674, 10.164416369567228, -45.9860381548565, -56.79063451184097, 15.648432796959247, 26.828854291358795, -29.17341783882486, 10.575931824391258, 18.351857947679857, 33.44764916473014, -27.41312819187896, -16.28726563704494, 38.886120341908494, 14.829280271577327, 14.90035123593494, 12.453763836595714, -27.415383066173707, 15.703709950556725, 46.45933730937263, 49.26430338515414, 11.075884545229153, 6.080958624363182, -52.91101340830214, -21.91695907322228, 31.15949618953965, 24.020143396367438, 14.068144667836147, -23.3792170621492, -53.90822380502694, -67.51604527199166, 30.370286143467524, 5.643113320558683, 26.927462115767682, -28.020315207334786, -48.40659327652136, -32.58255547300797, -32.956922180489194, -38.158580740514765, 7.494518498622014, 11.484739260520433, -35.838454556120126, -21.71287064111891, 55.2028554104092, 1.8667229992652778, -57.66322934631553, -63.78737478898754, 22.55867109583823, -19.697007168964475, -47.58363165075635, -66.59130219744884, 24.818428729322093, 51.67373256617073, 0.0, -0.18707501227315504, -19.595568302452527, 46.15182261288448, 8.37426701818986, 9.926227027287352, -38.306849674416796, -49.00121729238454, 9.66038791352454, 20.512344781993658, -51.6061717928495, -37.35916705462134, 10.210064838103206, -6.396785345583875, -2.3489729398201433, -39.77582021795341, -22.066446786114142, -56.19284012587631, -36.983470664194456, -27.91828442507071, -33.75245480661539, -22.737640868077555, 17.231990043978595, 23.3465622756325, 10.25971376507508, -39.38737042386088, -4.165269701828817, -4.548253219533246, 10.136829738709807, -18.027700348635022, -51.966066813143385, -46.27173917109371, 12.42846430181889, -25.74551720376035, -61.73874943631411, -46.408804918513745, -51.95805997459872, 5.214452489280973, -22.092056898743692, -4.577930733691575, -55.50892599127789, -28.597753575893968, -56.37598805854962, -63.202635737005885, -40.09549378503393, -11.727564988175551, -30.066543337912606, -64.8109975173882, -13.218132464339092, 33.048307064451436, -34.11667087066122, -19.458526144357123, -28.60015234299781, -66.99414055600232, -28.512340817119906, -37.325327156245606, 45.26983766449261, 31.4694802677831, -2.768380365475757, 15.979101474680546, -12.620959122838151, -35.65702523312888, -46.393017033920415, 4.935831616718033, -52.97993226635664, -47.460002581546625, 3.079923804260334, 2.6384124864095986, 27.000381484770614, -21.000886324402092, -38.19169681807647, -37.95623804099191, 8.981149705115065, 6.652703583268526, -16.161549297607117, 14.085273171509826, -53.31152217319551, -31.06411614205956, -32.15209859183258, 8.991438175974796, -32.4800076956376, -25.080972812710712, 16.648648582801997, 18.16450173592888, -13.091594172983875, 9.935018710810745, 16.009752945067927, -25.741894320263622, -39.603245169257015, -25.69490283611553, -56.09748337435617, -54.78571635224049, -36.566387689086746, -22.10896128519142, -35.657835024368445, 16.494017090165084, -45.658660086062525, -37.573776099065945, 27.845564269426806, 16.36643773853803, 5.1654285920098495, 8.19669309725472, -23.78086602302815, 26.615856232435267, 10.191057910749347, 17.485949665811276, -36.08879092090502, -34.15177471980062, 3.854841325093478, -27.704737542944585, 15.476087959984582, 37.717114852863716, 2.5243317597058024, -68.38316008781057, 21.445718103971426, 18.122413814996875, -6.486592201615139, 11.461661747481951, 1.9788677060235091, -35.24349925670869, 17.39114868012962, 0.5701727813573543, -3.8553583803539215, 28.450937732730743, -22.26017379608067, -2.1604522789273517, 2.3509800901922766, -0.9753965775309021, -50.12704022479239, 7.93318336528762, -21.554298633914186, -16.009527713682317, -31.42575010631562, -50.35212334999061, -14.402052710131038, 12.9785612872363, 23.478533174967346, -14.802148636804269, -14.212477926744956, 21.585979018746794, 28.64665701860428, 25.065958246905836, 13.267774637009513, -4.410811374818003, 25.790080344654235, 31.086379035322423, -13.032743213226702, 23.49265298964677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.437975224868044, "mean_inference_ms": 1.1670509746188358, "mean_action_processing_ms": 0.1885925053236366, "mean_env_wait_ms": 0.07827492492879448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003345012664794922, "StateBufferConnector_ms": 0.0029333829879760742, "ViewRequirementAgentConnector_ms": 0.07528376579284668}, "num_episodes": 13, "episode_return_max": 47.86182034726343, "episode_return_min": -60.72530206765155, "episode_return_mean": -10.40142723290159}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.73820453407467, "num_env_steps_trained_throughput_per_sec": 499.73820453407467, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 8099.071, "restore_workers_time_ms": 0.011, "training_step_time_ms": 8099.04, "sample_time_ms": 793.896, "learn_time_ms": 7291.889, "learn_throughput": 548.555, "synch_weights_time_ms": 12.71}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 100, "trial_id": "83a5c_00000", "date": "2024-08-10_12-28-21", "timestamp": 1723307301, "time_this_iter_s": 8.008556127548218, "time_total_s": 863.5781936645508, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb6bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 863.5781936645508, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 26.718181818181815, "ram_util_percent": 81.86363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0577296572702903, "cur_kl_coeff": 0.09010162353515624, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6368866292257156, "policy_loss": -0.008729402804081993, "vf_loss": 2.6451168394593334, "vf_explained_var": -0.046025708144303984, "kl": 0.0055404406427865625, "entropy": 0.5961571859619604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9732999271402756, "cur_kl_coeff": 0.0008342742919921872, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7293842577685914, "policy_loss": -0.0033329233561138, "vf_loss": 2.7327137624224025, "vf_explained_var": 0.27812301895270747, "kl": 0.0041059094389759, "entropy": 0.29462706193638344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "env_runners": {"episode_reward_max": 47.86182034726343, "episode_reward_min": -60.72530206765155, "episode_reward_mean": -10.96298975619022, "episode_len_mean": 303.39, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 30339, "policy_reward_min": {"agent_policy": -47.86182034726339, "adversary_policy": -68.38316008781057}, "policy_reward_max": {"agent_policy": 60.72530206765154, "adversary_policy": 55.2028554104092}, "policy_reward_mean": {"agent_policy": 10.962989756190222, "adversary_policy": -10.96298975619022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.86182034726343, 8.57842158479617, -37.41398624076219, 27.589819792953534, -4.655536197156526, -60.71213453850932, 18.006699732013107, -0.546426545783552, -40.49457437476466, -35.55775146050198, 9.489628879571224, -28.77566259861952, 28.534789204837253, -60.72530206765155, 1.4308319634368765, -57.08746692410263, 38.24608064774645, -0.09353750613657752, 13.278127155215985, 9.150247022738608, -43.654033483400646, 15.086366347759103, -44.4826694237354, 1.9066397462596663, -21.062396578886773, -39.12964345599524, -32.45087754463258, -28.24504783734648, 20.28927615980555, -14.563828329392898, -4.356761460681032, -3.945435304962606, -49.11890299211851, -6.658526450970726, -54.07377717741395, -23.37180374265888, -13.334993816217638, -42.05333978358591, -59.78931189777774, -25.91152938660474, -47.43877042765042, 9.915087300056173, -26.78759850750917, -47.797146449500076, -32.918833986682756, 38.36965896613787, 6.605360554602395, -24.138992177983514, -20.728592708601177, -50.21996742395164, 2.8591681453349658, 2.999747580184261, -38.073967429534186, 7.816926644191792, -1.0381380630486463, -42.18781915762754, -11.580330207928883, -28.780490254174158, 17.406575159365435, -1.578287731086566, -4.866070687597847, -32.64907400268627, -55.44159986329836, -29.337674487139083, -9.581908967101683, -41.61621809256423, 22.10600100398241, 6.6810608446322854, 1.4174951047035584, 13.838503788280317, -35.120282820352806, -11.924948108925545, 26.596601406424167, -32.92941416405243, 19.78406595948415, 2.4875347729334076, -16.632315775342583, 8.980660730743487, 12.29778967618841, -12.210313037504012, 0.6877917563306881, -21.09692842975239, -18.78191317379825, -40.88893672815309, -0.71174571144737, 4.338192269081537, 3.686750546000919, 26.856307632755026, 4.428481631095753, 28.43822968998834, 5.229954888210036, 13.77078607625509, -2.828159283933604, -34.409794700723914, -14.544362585781377, 4.783826388381174, 15.283242166644627, 6.256074725604411, 0.620304700396682, -29.18405204560443], "episode_lengths": [195, 90, 400, 241, 191, 400, 280, 198, 400, 400, 180, 400, 287, 400, 197, 400, 286, 1, 208, 199, 400, 237, 400, 23, 400, 400, 400, 400, 49, 400, 400, 313, 400, 170, 400, 400, 400, 400, 400, 400, 400, 298, 400, 400, 400, 86, 24, 400, 400, 400, 5, 72, 400, 400, 62, 400, 170, 400, 195, 79, 84, 400, 400, 400, 132, 400, 328, 400, 47, 400, 400, 359, 400, 400, 83, 84, 400, 400, 400, 400, 400, 400, 400, 400, 66, 147, 31, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 194, 400], "policy_agent_policy_reward": [-47.86182034726339, -8.57842158479617, 37.4139862407622, -27.58981979295356, 4.655536197156524, 60.71213453850931, -18.00669973201311, 0.5464265457835564, 40.49457437476467, 35.55775146050198, -9.489628879571224, 28.77566259861952, -28.534789204837224, 60.72530206765154, -1.430831963436876, 57.08746692410262, -38.24608064774639, 0.09353750613657752, -13.278127155215978, -9.150247022738602, 43.65403348340065, -15.086366347759103, 44.48266942373541, -1.9066397462596654, 21.062396578886773, 39.129643455995236, 32.45087754463258, 28.24504783734648, -20.28927615980556, 14.5638283293929, 4.356761460681032, 3.945435304962608, 49.118902992118514, 6.658526450970727, 54.07377717741396, 23.37180374265887, 13.334993816217636, 42.053339783585905, 59.789311897777736, 25.91152938660474, 47.43877042765041, -9.915087300056175, 26.78759850750917, 47.7971464495001, 32.918833986682756, -38.36965896613786, -6.605360554602394, 24.138992177983514, 20.728592708601187, 50.21996742395163, -2.8591681453349658, -2.999747580184261, 38.07396742953418, -7.8169266441917955, 1.0381380630486463, 42.18781915762753, 11.580330207928892, 28.780490254174158, -17.40657515936544, 1.578287731086565, 4.866070687597848, 32.64907400268627, 55.44159986329835, 29.337674487139083, 9.581908967101677, 41.61621809256424, -22.10600100398242, -6.6810608446322854, -1.4174951047035584, -13.838503788280315, 35.1202828203528, 11.924948108925548, -26.596601406424142, 32.929414164052396, -19.784065959484156, -2.4875347729334063, 16.632315775342587, -8.980660730743487, -12.297789676188412, 12.210313037504012, -0.6877917563306872, 21.096928429752385, 18.78191317379825, 40.8889367281531, 0.71174571144737, -4.338192269081537, -3.6867505460009182, -26.85630763275504, -4.428481631095755, -28.438229689988326, -5.229954888210036, -13.770786076255092, 2.8281592839336014, 34.40979470072391, 14.544362585781379, -4.783826388381174, -15.283242166644643, -6.256074725604411, -0.620304700396682, 29.184052045604435], "policy_adversary_policy_reward": [46.45933730937263, 49.26430338515414, 11.075884545229153, 6.080958624363182, -52.91101340830214, -21.91695907322228, 31.15949618953965, 24.020143396367438, 14.068144667836147, -23.3792170621492, -53.90822380502694, -67.51604527199166, 30.370286143467524, 5.643113320558683, 26.927462115767682, -28.020315207334786, -48.40659327652136, -32.58255547300797, -32.956922180489194, -38.158580740514765, 7.494518498622014, 11.484739260520433, -35.838454556120126, -21.71287064111891, 55.2028554104092, 1.8667229992652778, -57.66322934631553, -63.78737478898754, 22.55867109583823, -19.697007168964475, -47.58363165075635, -66.59130219744884, 24.818428729322093, 51.67373256617073, 0.0, -0.18707501227315504, -19.595568302452527, 46.15182261288448, 8.37426701818986, 9.926227027287352, -38.306849674416796, -49.00121729238454, 9.66038791352454, 20.512344781993658, -51.6061717928495, -37.35916705462134, 10.210064838103206, -6.396785345583875, -2.3489729398201433, -39.77582021795341, -22.066446786114142, -56.19284012587631, -36.983470664194456, -27.91828442507071, -33.75245480661539, -22.737640868077555, 17.231990043978595, 23.3465622756325, 10.25971376507508, -39.38737042386088, -4.165269701828817, -4.548253219533246, 10.136829738709807, -18.027700348635022, -51.966066813143385, -46.27173917109371, 12.42846430181889, -25.74551720376035, -61.73874943631411, -46.408804918513745, -51.95805997459872, 5.214452489280973, -22.092056898743692, -4.577930733691575, -55.50892599127789, -28.597753575893968, -56.37598805854962, -63.202635737005885, -40.09549378503393, -11.727564988175551, -30.066543337912606, -64.8109975173882, -13.218132464339092, 33.048307064451436, -34.11667087066122, -19.458526144357123, -28.60015234299781, -66.99414055600232, -28.512340817119906, -37.325327156245606, 45.26983766449261, 31.4694802677831, -2.768380365475757, 15.979101474680546, -12.620959122838151, -35.65702523312888, -46.393017033920415, 4.935831616718033, -52.97993226635664, -47.460002581546625, 3.079923804260334, 2.6384124864095986, 27.000381484770614, -21.000886324402092, -38.19169681807647, -37.95623804099191, 8.981149705115065, 6.652703583268526, -16.161549297607117, 14.085273171509826, -53.31152217319551, -31.06411614205956, -32.15209859183258, 8.991438175974796, -32.4800076956376, -25.080972812710712, 16.648648582801997, 18.16450173592888, -13.091594172983875, 9.935018710810745, 16.009752945067927, -25.741894320263622, -39.603245169257015, -25.69490283611553, -56.09748337435617, -54.78571635224049, -36.566387689086746, -22.10896128519142, -35.657835024368445, 16.494017090165084, -45.658660086062525, -37.573776099065945, 27.845564269426806, 16.36643773853803, 5.1654285920098495, 8.19669309725472, -23.78086602302815, 26.615856232435267, 10.191057910749347, 17.485949665811276, -36.08879092090502, -34.15177471980062, 3.854841325093478, -27.704737542944585, 15.476087959984582, 37.717114852863716, 2.5243317597058024, -68.38316008781057, 21.445718103971426, 18.122413814996875, -6.486592201615139, 11.461661747481951, 1.9788677060235091, -35.24349925670869, 17.39114868012962, 0.5701727813573543, -3.8553583803539215, 28.450937732730743, -22.26017379608067, -2.1604522789273517, 2.3509800901922766, -0.9753965775309021, -50.12704022479239, 7.93318336528762, -21.554298633914186, -16.009527713682317, -31.42575010631562, -50.35212334999061, -14.402052710131038, 12.9785612872363, 23.478533174967346, -14.802148636804269, -14.212477926744956, 21.585979018746794, 28.64665701860428, 25.065958246905836, 13.267774637009513, -4.410811374818003, 25.790080344654235, 31.086379035322423, -13.032743213226702, 23.49265298964677, 15.607151259066852, 11.934420893443331, 26.350012820550372, -32.00633138841758, -38.16346200975816, -30.656127391689658, 22.32112437714764, -51.4098495487104, 30.31125770930198, -20.743604932539633, 20.73714834858276, 9.829335984706526, 6.656749172765371, 5.855400278443448, -20.453229031334182, 21.69383843212755, -30.005833394526665, -28.362270696682202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43786882036648195, "mean_inference_ms": 1.166282673422781, "mean_action_processing_ms": 0.18841535960817168, "mean_env_wait_ms": 0.07825064524540917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033301115036010742, "StateBufferConnector_ms": 0.002835988998413086, "ViewRequirementAgentConnector_ms": 0.07632911205291748}, "num_episodes": 9, "episode_return_max": 47.86182034726343, "episode_return_min": -60.72530206765155, "episode_return_mean": -10.96298975619022}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.05047958717506, "num_env_steps_trained_throughput_per_sec": 458.05047958717506, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 8163.279, "restore_workers_time_ms": 0.011, "training_step_time_ms": 8163.247, "sample_time_ms": 831.057, "learn_time_ms": 7318.957, "learn_throughput": 546.526, "synch_weights_time_ms": 12.691}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "training_iteration": 101, "trial_id": "83a5c_00000", "date": "2024-08-10_12-28-29", "timestamp": 1723307309, "time_this_iter_s": 8.738898754119873, "time_total_s": 872.3170924186707, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5adca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 872.3170924186707, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 30.83846153846154, "ram_util_percent": 81.54615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6146615252292977, "cur_kl_coeff": 0.09010162353515624, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.1413762140526345, "policy_loss": -0.0065679394297558005, "vf_loss": 4.147198067518769, "vf_explained_var": -0.4244239997611475, "kl": 0.008280410279309411, "entropy": 0.6305697515843407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3888467031531038, "cur_kl_coeff": 0.0004171371459960936, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.091071205586195, "policy_loss": -0.023472275492410214, "vf_loss": 3.1145100673039754, "vf_explained_var": 0.28492256787916026, "kl": 0.08008755425309613, "entropy": 0.693583278482159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": 38.36965896613787, "episode_reward_min": -60.72530206765155, "episode_reward_mean": -10.898175591653425, "episode_len_mean": 314.22, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 31422, "policy_reward_min": {"agent_policy": -38.36965896613786, "adversary_policy": -68.38316008781057}, "policy_reward_max": {"agent_policy": 60.72530206765154, "adversary_policy": 55.2028554104092}, "policy_reward_mean": {"agent_policy": 10.898175591653429, "adversary_policy": -10.89817559165343}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.77566259861952, 28.534789204837253, -60.72530206765155, 1.4308319634368765, -57.08746692410263, 38.24608064774645, -0.09353750613657752, 13.278127155215985, 9.150247022738608, -43.654033483400646, 15.086366347759103, -44.4826694237354, 1.9066397462596663, -21.062396578886773, -39.12964345599524, -32.45087754463258, -28.24504783734648, 20.28927615980555, -14.563828329392898, -4.356761460681032, -3.945435304962606, -49.11890299211851, -6.658526450970726, -54.07377717741395, -23.37180374265888, -13.334993816217638, -42.05333978358591, -59.78931189777774, -25.91152938660474, -47.43877042765042, 9.915087300056173, -26.78759850750917, -47.797146449500076, -32.918833986682756, 38.36965896613787, 6.605360554602395, -24.138992177983514, -20.728592708601177, -50.21996742395164, 2.8591681453349658, 2.999747580184261, -38.073967429534186, 7.816926644191792, -1.0381380630486463, -42.18781915762754, -11.580330207928883, -28.780490254174158, 17.406575159365435, -1.578287731086566, -4.866070687597847, -32.64907400268627, -55.44159986329836, -29.337674487139083, -9.581908967101683, -41.61621809256423, 22.10600100398241, 6.6810608446322854, 1.4174951047035584, 13.838503788280317, -35.120282820352806, -11.924948108925545, 26.596601406424167, -32.92941416405243, 19.78406595948415, 2.4875347729334076, -16.632315775342583, 8.980660730743487, 12.29778967618841, -12.210313037504012, 0.6877917563306881, -21.09692842975239, -18.78191317379825, -40.88893672815309, -0.71174571144737, 4.338192269081537, 3.686750546000919, 26.856307632755026, 4.428481631095753, 28.43822968998834, 5.229954888210036, 13.77078607625509, -2.828159283933604, -34.409794700723914, -14.544362585781377, 4.783826388381174, 15.283242166644627, 6.256074725604411, 0.620304700396682, -29.18405204560443, 26.65040449884597, 33.5493417394957, -2.7184789929968316, -0.8401456727044563, -9.433602944128097, -26.726934719837864, -29.928413536567646, -11.707340734125275, -6.7926087969929565, -21.973340260446154, -11.45148314774412], "episode_lengths": [400, 287, 400, 197, 400, 286, 1, 208, 199, 400, 237, 400, 23, 400, 400, 400, 400, 49, 400, 400, 313, 400, 170, 400, 400, 400, 400, 400, 400, 400, 298, 400, 400, 400, 86, 24, 400, 400, 400, 5, 72, 400, 400, 62, 400, 170, 400, 195, 79, 84, 400, 400, 400, 132, 400, 328, 400, 47, 400, 400, 359, 400, 400, 83, 84, 400, 400, 400, 400, 400, 400, 400, 400, 66, 147, 31, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 194, 400, 400, 58, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [28.77566259861952, -28.534789204837224, 60.72530206765154, -1.430831963436876, 57.08746692410262, -38.24608064774639, 0.09353750613657752, -13.278127155215978, -9.150247022738602, 43.65403348340065, -15.086366347759103, 44.48266942373541, -1.9066397462596654, 21.062396578886773, 39.129643455995236, 32.45087754463258, 28.24504783734648, -20.28927615980556, 14.5638283293929, 4.356761460681032, 3.945435304962608, 49.118902992118514, 6.658526450970727, 54.07377717741396, 23.37180374265887, 13.334993816217636, 42.053339783585905, 59.789311897777736, 25.91152938660474, 47.43877042765041, -9.915087300056175, 26.78759850750917, 47.7971464495001, 32.918833986682756, -38.36965896613786, -6.605360554602394, 24.138992177983514, 20.728592708601187, 50.21996742395163, -2.8591681453349658, -2.999747580184261, 38.07396742953418, -7.8169266441917955, 1.0381380630486463, 42.18781915762753, 11.580330207928892, 28.780490254174158, -17.40657515936544, 1.578287731086565, 4.866070687597848, 32.64907400268627, 55.44159986329835, 29.337674487139083, 9.581908967101677, 41.61621809256424, -22.10600100398242, -6.6810608446322854, -1.4174951047035584, -13.838503788280315, 35.1202828203528, 11.924948108925548, -26.596601406424142, 32.929414164052396, -19.784065959484156, -2.4875347729334063, 16.632315775342587, -8.980660730743487, -12.297789676188412, 12.210313037504012, -0.6877917563306872, 21.096928429752385, 18.78191317379825, 40.8889367281531, 0.71174571144737, -4.338192269081537, -3.6867505460009182, -26.85630763275504, -4.428481631095755, -28.438229689988326, -5.229954888210036, -13.770786076255092, 2.8281592839336014, 34.40979470072391, 14.544362585781379, -4.783826388381174, -15.283242166644643, -6.256074725604411, -0.620304700396682, 29.184052045604435, -26.65040449884596, -33.5493417394957, 2.7184789929968316, 0.8401456727044607, 9.433602944128088, 26.726934719837864, 29.928413536567646, 11.707340734125273, 6.7926087969929565, 21.973340260446154, 11.451483147744124], "policy_adversary_policy_reward": [-35.838454556120126, -21.71287064111891, 55.2028554104092, 1.8667229992652778, -57.66322934631553, -63.78737478898754, 22.55867109583823, -19.697007168964475, -47.58363165075635, -66.59130219744884, 24.818428729322093, 51.67373256617073, 0.0, -0.18707501227315504, -19.595568302452527, 46.15182261288448, 8.37426701818986, 9.926227027287352, -38.306849674416796, -49.00121729238454, 9.66038791352454, 20.512344781993658, -51.6061717928495, -37.35916705462134, 10.210064838103206, -6.396785345583875, -2.3489729398201433, -39.77582021795341, -22.066446786114142, -56.19284012587631, -36.983470664194456, -27.91828442507071, -33.75245480661539, -22.737640868077555, 17.231990043978595, 23.3465622756325, 10.25971376507508, -39.38737042386088, -4.165269701828817, -4.548253219533246, 10.136829738709807, -18.027700348635022, -51.966066813143385, -46.27173917109371, 12.42846430181889, -25.74551720376035, -61.73874943631411, -46.408804918513745, -51.95805997459872, 5.214452489280973, -22.092056898743692, -4.577930733691575, -55.50892599127789, -28.597753575893968, -56.37598805854962, -63.202635737005885, -40.09549378503393, -11.727564988175551, -30.066543337912606, -64.8109975173882, -13.218132464339092, 33.048307064451436, -34.11667087066122, -19.458526144357123, -28.60015234299781, -66.99414055600232, -28.512340817119906, -37.325327156245606, 45.26983766449261, 31.4694802677831, -2.768380365475757, 15.979101474680546, -12.620959122838151, -35.65702523312888, -46.393017033920415, 4.935831616718033, -52.97993226635664, -47.460002581546625, 3.079923804260334, 2.6384124864095986, 27.000381484770614, -21.000886324402092, -38.19169681807647, -37.95623804099191, 8.981149705115065, 6.652703583268526, -16.161549297607117, 14.085273171509826, -53.31152217319551, -31.06411614205956, -32.15209859183258, 8.991438175974796, -32.4800076956376, -25.080972812710712, 16.648648582801997, 18.16450173592888, -13.091594172983875, 9.935018710810745, 16.009752945067927, -25.741894320263622, -39.603245169257015, -25.69490283611553, -56.09748337435617, -54.78571635224049, -36.566387689086746, -22.10896128519142, -35.657835024368445, 16.494017090165084, -45.658660086062525, -37.573776099065945, 27.845564269426806, 16.36643773853803, 5.1654285920098495, 8.19669309725472, -23.78086602302815, 26.615856232435267, 10.191057910749347, 17.485949665811276, -36.08879092090502, -34.15177471980062, 3.854841325093478, -27.704737542944585, 15.476087959984582, 37.717114852863716, 2.5243317597058024, -68.38316008781057, 21.445718103971426, 18.122413814996875, -6.486592201615139, 11.461661747481951, 1.9788677060235091, -35.24349925670869, 17.39114868012962, 0.5701727813573543, -3.8553583803539215, 28.450937732730743, -22.26017379608067, -2.1604522789273517, 2.3509800901922766, -0.9753965775309021, -50.12704022479239, 7.93318336528762, -21.554298633914186, -16.009527713682317, -31.42575010631562, -50.35212334999061, -14.402052710131038, 12.9785612872363, 23.478533174967346, -14.802148636804269, -14.212477926744956, 21.585979018746794, 28.64665701860428, 25.065958246905836, 13.267774637009513, -4.410811374818003, 25.790080344654235, 31.086379035322423, -13.032743213226702, 23.49265298964677, 15.607151259066852, 11.934420893443331, 26.350012820550372, -32.00633138841758, -38.16346200975816, -30.656127391689658, 22.32112437714764, -51.4098495487104, 30.31125770930198, -20.743604932539633, 20.73714834858276, 9.829335984706526, 6.656749172765371, 5.855400278443448, -20.453229031334182, 21.69383843212755, -30.005833394526665, -28.362270696682202, 32.033501129678854, 21.267307868013077, 35.876630147696716, 31.22205333129468, -27.02836832084263, 21.591410334848977, 1.6412733262994248, -3.32156467170835, -26.841209463256654, 7.974003575000486, -25.51512524578029, -27.938744193895438, -23.483809904528712, -36.37301716860658, 12.364639907573768, -35.77932137582431, 21.196872858395672, -34.782090452381595, -23.60336063182296, -20.34331988906935, -33.985447683208164, 11.082481387719913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4375629647650491, "mean_inference_ms": 1.1653142142567812, "mean_action_processing_ms": 0.18830448116708853, "mean_env_wait_ms": 0.07814202900587788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032689571380615234, "StateBufferConnector_ms": 0.002803325653076172, "ViewRequirementAgentConnector_ms": 0.06925415992736816}, "num_episodes": 11, "episode_return_max": 38.36965896613787, "episode_return_min": -60.72530206765155, "episode_return_mean": -10.898175591653425}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.0940599023278, "num_env_steps_trained_throughput_per_sec": 496.0940599023278, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 8182.361, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8182.329, "sample_time_ms": 836.369, "learn_time_ms": 7332.773, "learn_throughput": 545.496, "synch_weights_time_ms": 12.651}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 102, "trial_id": "83a5c_00000", "date": "2024-08-10_12-28-38", "timestamp": 1723307318, "time_this_iter_s": 8.068472146987915, "time_total_s": 880.3855645656586, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faad670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 880.3855645656586, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 25.74545454545455, "ram_util_percent": 81.48181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.103708690404892, "cur_kl_coeff": 0.09010162353515624, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.904090596002246, "policy_loss": -0.003860160980186371, "vf_loss": 3.9074747759198387, "vf_explained_var": -0.06444847303092795, "kl": 0.005282738372098786, "entropy": 0.5709321754161643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0097396625826756, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.386835777759552, "policy_loss": -0.00759835433588402, "vf_loss": 3.3944263932605585, "vf_explained_var": 0.607572274034222, "kl": 0.012373596855144697, "entropy": 0.881186947474877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "env_runners": {"episode_reward_max": 38.36965896613787, "episode_reward_min": -59.78931189777774, "episode_reward_mean": -11.767711177059326, "episode_len_mean": 324.37, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 32437, "policy_reward_min": {"agent_policy": -38.36965896613786, "adversary_policy": -68.38316008781057}, "policy_reward_max": {"agent_policy": 59.789311897777736, "adversary_policy": 45.26983766449261}, "policy_reward_mean": {"agent_policy": 11.767711177059326, "adversary_policy": -11.767711177059326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.9066397462596663, -21.062396578886773, -39.12964345599524, -32.45087754463258, -28.24504783734648, 20.28927615980555, -14.563828329392898, -4.356761460681032, -3.945435304962606, -49.11890299211851, -6.658526450970726, -54.07377717741395, -23.37180374265888, -13.334993816217638, -42.05333978358591, -59.78931189777774, -25.91152938660474, -47.43877042765042, 9.915087300056173, -26.78759850750917, -47.797146449500076, -32.918833986682756, 38.36965896613787, 6.605360554602395, -24.138992177983514, -20.728592708601177, -50.21996742395164, 2.8591681453349658, 2.999747580184261, -38.073967429534186, 7.816926644191792, -1.0381380630486463, -42.18781915762754, -11.580330207928883, -28.780490254174158, 17.406575159365435, -1.578287731086566, -4.866070687597847, -32.64907400268627, -55.44159986329836, -29.337674487139083, -9.581908967101683, -41.61621809256423, 22.10600100398241, 6.6810608446322854, 1.4174951047035584, 13.838503788280317, -35.120282820352806, -11.924948108925545, 26.596601406424167, -32.92941416405243, 19.78406595948415, 2.4875347729334076, -16.632315775342583, 8.980660730743487, 12.29778967618841, -12.210313037504012, 0.6877917563306881, -21.09692842975239, -18.78191317379825, -40.88893672815309, -0.71174571144737, 4.338192269081537, 3.686750546000919, 26.856307632755026, 4.428481631095753, 28.43822968998834, 5.229954888210036, 13.77078607625509, -2.828159283933604, -34.409794700723914, -14.544362585781377, 4.783826388381174, 15.283242166644627, 6.256074725604411, 0.620304700396682, -29.18405204560443, 26.65040449884597, 33.5493417394957, -2.7184789929968316, -0.8401456727044563, -9.433602944128097, -26.726934719837864, -29.928413536567646, -11.707340734125275, -6.7926087969929565, -21.973340260446154, -11.45148314774412, -34.541620551808, 9.448305401112524, -6.0457405259154084, -38.232055548749194, 6.725776711651283, -25.13208953411172, 1.4388356954651904, -43.2787190259871, 10.890874415310353, -31.473000746725667, -28.539303676032333, -37.30705081671155], "episode_lengths": [23, 400, 400, 400, 400, 49, 400, 400, 313, 400, 170, 400, 400, 400, 400, 400, 400, 400, 298, 400, 400, 400, 86, 24, 400, 400, 400, 5, 72, 400, 400, 62, 400, 170, 400, 195, 79, 84, 400, 400, 400, 132, 400, 328, 400, 47, 400, 400, 359, 400, 400, 83, 84, 400, 400, 400, 400, 400, 400, 400, 400, 66, 147, 31, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 194, 400, 400, 58, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-1.9066397462596654, 21.062396578886773, 39.129643455995236, 32.45087754463258, 28.24504783734648, -20.28927615980556, 14.5638283293929, 4.356761460681032, 3.945435304962608, 49.118902992118514, 6.658526450970727, 54.07377717741396, 23.37180374265887, 13.334993816217636, 42.053339783585905, 59.789311897777736, 25.91152938660474, 47.43877042765041, -9.915087300056175, 26.78759850750917, 47.7971464495001, 32.918833986682756, -38.36965896613786, -6.605360554602394, 24.138992177983514, 20.728592708601187, 50.21996742395163, -2.8591681453349658, -2.999747580184261, 38.07396742953418, -7.8169266441917955, 1.0381380630486463, 42.18781915762753, 11.580330207928892, 28.780490254174158, -17.40657515936544, 1.578287731086565, 4.866070687597848, 32.64907400268627, 55.44159986329835, 29.337674487139083, 9.581908967101677, 41.61621809256424, -22.10600100398242, -6.6810608446322854, -1.4174951047035584, -13.838503788280315, 35.1202828203528, 11.924948108925548, -26.596601406424142, 32.929414164052396, -19.784065959484156, -2.4875347729334063, 16.632315775342587, -8.980660730743487, -12.297789676188412, 12.210313037504012, -0.6877917563306872, 21.096928429752385, 18.78191317379825, 40.8889367281531, 0.71174571144737, -4.338192269081537, -3.6867505460009182, -26.85630763275504, -4.428481631095755, -28.438229689988326, -5.229954888210036, -13.770786076255092, 2.8281592839336014, 34.40979470072391, 14.544362585781379, -4.783826388381174, -15.283242166644643, -6.256074725604411, -0.620304700396682, 29.184052045604435, -26.65040449884596, -33.5493417394957, 2.7184789929968316, 0.8401456727044607, 9.433602944128088, 26.726934719837864, 29.928413536567646, 11.707340734125273, 6.7926087969929565, 21.973340260446154, 11.451483147744124, 34.54162055180801, -9.448305401112522, 6.0457405259154084, 38.23205554874919, -6.72577671165128, 25.13208953411172, -1.4388356954651904, 43.27871902598711, -10.890874415310348, 31.473000746725663, 28.53930367603235, 37.30705081671153], "policy_adversary_policy_reward": [10.210064838103206, -6.396785345583875, -2.3489729398201433, -39.77582021795341, -22.066446786114142, -56.19284012587631, -36.983470664194456, -27.91828442507071, -33.75245480661539, -22.737640868077555, 17.231990043978595, 23.3465622756325, 10.25971376507508, -39.38737042386088, -4.165269701828817, -4.548253219533246, 10.136829738709807, -18.027700348635022, -51.966066813143385, -46.27173917109371, 12.42846430181889, -25.74551720376035, -61.73874943631411, -46.408804918513745, -51.95805997459872, 5.214452489280973, -22.092056898743692, -4.577930733691575, -55.50892599127789, -28.597753575893968, -56.37598805854962, -63.202635737005885, -40.09549378503393, -11.727564988175551, -30.066543337912606, -64.8109975173882, -13.218132464339092, 33.048307064451436, -34.11667087066122, -19.458526144357123, -28.60015234299781, -66.99414055600232, -28.512340817119906, -37.325327156245606, 45.26983766449261, 31.4694802677831, -2.768380365475757, 15.979101474680546, -12.620959122838151, -35.65702523312888, -46.393017033920415, 4.935831616718033, -52.97993226635664, -47.460002581546625, 3.079923804260334, 2.6384124864095986, 27.000381484770614, -21.000886324402092, -38.19169681807647, -37.95623804099191, 8.981149705115065, 6.652703583268526, -16.161549297607117, 14.085273171509826, -53.31152217319551, -31.06411614205956, -32.15209859183258, 8.991438175974796, -32.4800076956376, -25.080972812710712, 16.648648582801997, 18.16450173592888, -13.091594172983875, 9.935018710810745, 16.009752945067927, -25.741894320263622, -39.603245169257015, -25.69490283611553, -56.09748337435617, -54.78571635224049, -36.566387689086746, -22.10896128519142, -35.657835024368445, 16.494017090165084, -45.658660086062525, -37.573776099065945, 27.845564269426806, 16.36643773853803, 5.1654285920098495, 8.19669309725472, -23.78086602302815, 26.615856232435267, 10.191057910749347, 17.485949665811276, -36.08879092090502, -34.15177471980062, 3.854841325093478, -27.704737542944585, 15.476087959984582, 37.717114852863716, 2.5243317597058024, -68.38316008781057, 21.445718103971426, 18.122413814996875, -6.486592201615139, 11.461661747481951, 1.9788677060235091, -35.24349925670869, 17.39114868012962, 0.5701727813573543, -3.8553583803539215, 28.450937732730743, -22.26017379608067, -2.1604522789273517, 2.3509800901922766, -0.9753965775309021, -50.12704022479239, 7.93318336528762, -21.554298633914186, -16.009527713682317, -31.42575010631562, -50.35212334999061, -14.402052710131038, 12.9785612872363, 23.478533174967346, -14.802148636804269, -14.212477926744956, 21.585979018746794, 28.64665701860428, 25.065958246905836, 13.267774637009513, -4.410811374818003, 25.790080344654235, 31.086379035322423, -13.032743213226702, 23.49265298964677, 15.607151259066852, 11.934420893443331, 26.350012820550372, -32.00633138841758, -38.16346200975816, -30.656127391689658, 22.32112437714764, -51.4098495487104, 30.31125770930198, -20.743604932539633, 20.73714834858276, 9.829335984706526, 6.656749172765371, 5.855400278443448, -20.453229031334182, 21.69383843212755, -30.005833394526665, -28.362270696682202, 32.033501129678854, 21.267307868013077, 35.876630147696716, 31.22205333129468, -27.02836832084263, 21.591410334848977, 1.6412733262994248, -3.32156467170835, -26.841209463256654, 7.974003575000486, -25.51512524578029, -27.938744193895438, -23.483809904528712, -36.37301716860658, 12.364639907573768, -35.77932137582431, 21.196872858395672, -34.782090452381595, -23.60336063182296, -20.34331988906935, -33.985447683208164, 11.082481387719913, -33.67929396136048, -35.4039471422555, 9.68652757401684, 9.210083228208218, 8.130855249225819, -20.222336301056636, -45.09129123993724, -31.372819857561126, 11.45025274816651, 2.0013006751360543, -34.83153087167886, -15.432648196544584, 21.09703834685923, -18.219366955928848, -54.1429724694067, -32.41446558256754, 10.899099423184097, 10.882649407436602, -39.88933912775235, -23.056662365698983, -1.5294809609002105, -55.5491263911645, -29.56948883668916, -45.04461279673395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43723845364484776, "mean_inference_ms": 1.1643679909522158, "mean_action_processing_ms": 0.1881482210862336, "mean_env_wait_ms": 0.07803873331921637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003205537796020508, "StateBufferConnector_ms": 0.0027805566787719727, "ViewRequirementAgentConnector_ms": 0.06908941268920898}, "num_episodes": 12, "episode_return_max": 38.36965896613787, "episode_return_min": -59.78931189777774, "episode_return_mean": -11.767711177059326}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 499.84467385964587, "num_env_steps_trained_throughput_per_sec": 499.84467385964587, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 8174.185, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8174.153, "sample_time_ms": 840.122, "learn_time_ms": 7320.666, "learn_throughput": 546.398, "synch_weights_time_ms": 12.874}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "training_iteration": 103, "trial_id": "83a5c_00000", "date": "2024-08-10_12-28-46", "timestamp": 1723307326, "time_this_iter_s": 8.007748126983643, "time_total_s": 888.3933126926422, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faad8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 888.3933126926422, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 26.124999999999996, "ram_util_percent": 81.69166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9526201778934116, "cur_kl_coeff": 0.09010162353515624, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0158856031125185, "policy_loss": -0.009501788611449893, "vf_loss": 3.0244545758716646, "vf_explained_var": 0.0018004243020658139, "kl": 0.010352984990035343, "entropy": 0.715245932750601, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5830885600919524, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.84473777487874, "policy_loss": -0.005231018490788605, "vf_loss": 2.8499590190748374, "vf_explained_var": 0.3441742638126016, "kl": 0.015621182097337776, "entropy": 0.966832219188412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 38.36965896613787, "episode_reward_min": -59.78931189777774, "episode_reward_mean": -12.719124279024095, "episode_len_mean": 329.77, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 32977, "policy_reward_min": {"agent_policy": -38.36965896613786, "adversary_policy": -68.38316008781057}, "policy_reward_max": {"agent_policy": 59.789311897777736, "adversary_policy": 45.26983766449261}, "policy_reward_mean": {"agent_policy": 12.719124279024095, "adversary_policy": -12.719124279024097}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.658526450970726, -54.07377717741395, -23.37180374265888, -13.334993816217638, -42.05333978358591, -59.78931189777774, -25.91152938660474, -47.43877042765042, 9.915087300056173, -26.78759850750917, -47.797146449500076, -32.918833986682756, 38.36965896613787, 6.605360554602395, -24.138992177983514, -20.728592708601177, -50.21996742395164, 2.8591681453349658, 2.999747580184261, -38.073967429534186, 7.816926644191792, -1.0381380630486463, -42.18781915762754, -11.580330207928883, -28.780490254174158, 17.406575159365435, -1.578287731086566, -4.866070687597847, -32.64907400268627, -55.44159986329836, -29.337674487139083, -9.581908967101683, -41.61621809256423, 22.10600100398241, 6.6810608446322854, 1.4174951047035584, 13.838503788280317, -35.120282820352806, -11.924948108925545, 26.596601406424167, -32.92941416405243, 19.78406595948415, 2.4875347729334076, -16.632315775342583, 8.980660730743487, 12.29778967618841, -12.210313037504012, 0.6877917563306881, -21.09692842975239, -18.78191317379825, -40.88893672815309, -0.71174571144737, 4.338192269081537, 3.686750546000919, 26.856307632755026, 4.428481631095753, 28.43822968998834, 5.229954888210036, 13.77078607625509, -2.828159283933604, -34.409794700723914, -14.544362585781377, 4.783826388381174, 15.283242166644627, 6.256074725604411, 0.620304700396682, -29.18405204560443, 26.65040449884597, 33.5493417394957, -2.7184789929968316, -0.8401456727044563, -9.433602944128097, -26.726934719837864, -29.928413536567646, -11.707340734125275, -6.7926087969929565, -21.973340260446154, -11.45148314774412, -34.541620551808, 9.448305401112524, -6.0457405259154084, -38.232055548749194, 6.725776711651283, -25.13208953411172, 1.4388356954651904, -43.2787190259871, 10.890874415310353, -31.473000746725667, -28.539303676032333, -37.30705081671155, -53.459035394421065, -29.939053663689485, -15.881832904417852, -55.235988990422875, -3.1967571976273916, -22.70611543716226, -22.776172806228118, -24.568165797002152, -13.343764289093308, -24.711401314363687], "episode_lengths": [170, 400, 400, 400, 400, 400, 400, 400, 298, 400, 400, 400, 86, 24, 400, 400, 400, 5, 72, 400, 400, 62, 400, 170, 400, 195, 79, 84, 400, 400, 400, 132, 400, 328, 400, 47, 400, 400, 359, 400, 400, 83, 84, 400, 400, 400, 400, 400, 400, 400, 400, 66, 147, 31, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 194, 400, 400, 58, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [6.658526450970727, 54.07377717741396, 23.37180374265887, 13.334993816217636, 42.053339783585905, 59.789311897777736, 25.91152938660474, 47.43877042765041, -9.915087300056175, 26.78759850750917, 47.7971464495001, 32.918833986682756, -38.36965896613786, -6.605360554602394, 24.138992177983514, 20.728592708601187, 50.21996742395163, -2.8591681453349658, -2.999747580184261, 38.07396742953418, -7.8169266441917955, 1.0381380630486463, 42.18781915762753, 11.580330207928892, 28.780490254174158, -17.40657515936544, 1.578287731086565, 4.866070687597848, 32.64907400268627, 55.44159986329835, 29.337674487139083, 9.581908967101677, 41.61621809256424, -22.10600100398242, -6.6810608446322854, -1.4174951047035584, -13.838503788280315, 35.1202828203528, 11.924948108925548, -26.596601406424142, 32.929414164052396, -19.784065959484156, -2.4875347729334063, 16.632315775342587, -8.980660730743487, -12.297789676188412, 12.210313037504012, -0.6877917563306872, 21.096928429752385, 18.78191317379825, 40.8889367281531, 0.71174571144737, -4.338192269081537, -3.6867505460009182, -26.85630763275504, -4.428481631095755, -28.438229689988326, -5.229954888210036, -13.770786076255092, 2.8281592839336014, 34.40979470072391, 14.544362585781379, -4.783826388381174, -15.283242166644643, -6.256074725604411, -0.620304700396682, 29.184052045604435, -26.65040449884596, -33.5493417394957, 2.7184789929968316, 0.8401456727044607, 9.433602944128088, 26.726934719837864, 29.928413536567646, 11.707340734125273, 6.7926087969929565, 21.973340260446154, 11.451483147744124, 34.54162055180801, -9.448305401112522, 6.0457405259154084, 38.23205554874919, -6.72577671165128, 25.13208953411172, -1.4388356954651904, 43.27871902598711, -10.890874415310348, 31.473000746725663, 28.53930367603235, 37.30705081671153, 53.45903539442106, 29.939053663689492, 15.881832904417857, 55.23598899042287, 3.196757197627398, 22.70611543716226, 22.776172806228118, 24.568165797002152, 13.343764289093308, 24.711401314363698], "policy_adversary_policy_reward": [12.42846430181889, -25.74551720376035, -61.73874943631411, -46.408804918513745, -51.95805997459872, 5.214452489280973, -22.092056898743692, -4.577930733691575, -55.50892599127789, -28.597753575893968, -56.37598805854962, -63.202635737005885, -40.09549378503393, -11.727564988175551, -30.066543337912606, -64.8109975173882, -13.218132464339092, 33.048307064451436, -34.11667087066122, -19.458526144357123, -28.60015234299781, -66.99414055600232, -28.512340817119906, -37.325327156245606, 45.26983766449261, 31.4694802677831, -2.768380365475757, 15.979101474680546, -12.620959122838151, -35.65702523312888, -46.393017033920415, 4.935831616718033, -52.97993226635664, -47.460002581546625, 3.079923804260334, 2.6384124864095986, 27.000381484770614, -21.000886324402092, -38.19169681807647, -37.95623804099191, 8.981149705115065, 6.652703583268526, -16.161549297607117, 14.085273171509826, -53.31152217319551, -31.06411614205956, -32.15209859183258, 8.991438175974796, -32.4800076956376, -25.080972812710712, 16.648648582801997, 18.16450173592888, -13.091594172983875, 9.935018710810745, 16.009752945067927, -25.741894320263622, -39.603245169257015, -25.69490283611553, -56.09748337435617, -54.78571635224049, -36.566387689086746, -22.10896128519142, -35.657835024368445, 16.494017090165084, -45.658660086062525, -37.573776099065945, 27.845564269426806, 16.36643773853803, 5.1654285920098495, 8.19669309725472, -23.78086602302815, 26.615856232435267, 10.191057910749347, 17.485949665811276, -36.08879092090502, -34.15177471980062, 3.854841325093478, -27.704737542944585, 15.476087959984582, 37.717114852863716, 2.5243317597058024, -68.38316008781057, 21.445718103971426, 18.122413814996875, -6.486592201615139, 11.461661747481951, 1.9788677060235091, -35.24349925670869, 17.39114868012962, 0.5701727813573543, -3.8553583803539215, 28.450937732730743, -22.26017379608067, -2.1604522789273517, 2.3509800901922766, -0.9753965775309021, -50.12704022479239, 7.93318336528762, -21.554298633914186, -16.009527713682317, -31.42575010631562, -50.35212334999061, -14.402052710131038, 12.9785612872363, 23.478533174967346, -14.802148636804269, -14.212477926744956, 21.585979018746794, 28.64665701860428, 25.065958246905836, 13.267774637009513, -4.410811374818003, 25.790080344654235, 31.086379035322423, -13.032743213226702, 23.49265298964677, 15.607151259066852, 11.934420893443331, 26.350012820550372, -32.00633138841758, -38.16346200975816, -30.656127391689658, 22.32112437714764, -51.4098495487104, 30.31125770930198, -20.743604932539633, 20.73714834858276, 9.829335984706526, 6.656749172765371, 5.855400278443448, -20.453229031334182, 21.69383843212755, -30.005833394526665, -28.362270696682202, 32.033501129678854, 21.267307868013077, 35.876630147696716, 31.22205333129468, -27.02836832084263, 21.591410334848977, 1.6412733262994248, -3.32156467170835, -26.841209463256654, 7.974003575000486, -25.51512524578029, -27.938744193895438, -23.483809904528712, -36.37301716860658, 12.364639907573768, -35.77932137582431, 21.196872858395672, -34.782090452381595, -23.60336063182296, -20.34331988906935, -33.985447683208164, 11.082481387719913, -33.67929396136048, -35.4039471422555, 9.68652757401684, 9.210083228208218, 8.130855249225819, -20.222336301056636, -45.09129123993724, -31.372819857561126, 11.45025274816651, 2.0013006751360543, -34.83153087167886, -15.432648196544584, 21.09703834685923, -18.219366955928848, -54.1429724694067, -32.41446558256754, 10.899099423184097, 10.882649407436602, -39.88933912775235, -23.056662365698983, -1.5294809609002105, -55.5491263911645, -29.56948883668916, -45.04461279673395, -56.89991733548583, -50.018153453356334, -39.24522552628297, -20.632881801096005, 17.404614191038675, -49.168279999874386, -55.87418614505637, -54.59779183578936, -44.74375306606641, 38.35023867081161, -27.558677187247035, -17.853553687077486, -27.420362295495416, -18.13198331696082, -28.21385462399378, -20.92247697001053, -7.565415558431646, -19.12211301975497, -14.42284000091983, -34.99996262780759]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43702202208707297, "mean_inference_ms": 1.1634459033267681, "mean_action_processing_ms": 0.18806562836524607, "mean_env_wait_ms": 0.0779559014646054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031986236572265625, "StateBufferConnector_ms": 0.0027703046798706055, "ViewRequirementAgentConnector_ms": 0.06889510154724121}, "num_episodes": 10, "episode_return_max": 38.36965896613787, "episode_return_min": -59.78931189777774, "episode_return_mean": -12.719124279024095}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.9116493698797, "num_env_steps_trained_throughput_per_sec": 501.9116493698797, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 8141.879, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8141.847, "sample_time_ms": 817.923, "learn_time_ms": 7310.469, "learn_throughput": 547.16, "synch_weights_time_ms": 12.965}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 104, "trial_id": "83a5c_00000", "date": "2024-08-10_12-28-54", "timestamp": 1723307334, "time_this_iter_s": 7.974681854248047, "time_total_s": 896.3679945468903, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faad940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 896.3679945468903, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 25.89090909090909, "ram_util_percent": 81.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1045903314358343, "cur_kl_coeff": 0.09010162353515624, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.01387481210093, "policy_loss": -0.007283156897956456, "vf_loss": 4.0200670444145405, "vf_explained_var": -0.03154871277708225, "kl": 0.012107670480547842, "entropy": 0.8076943984107365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.594163279794157, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6280657554666202, "policy_loss": -0.007812081982168214, "vf_loss": 3.6358597139517466, "vf_explained_var": -0.4023158725971977, "kl": 0.028975639196222383, "entropy": 1.0115445705751578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "env_runners": {"episode_reward_max": 44.514339445217594, "episode_reward_min": -55.44159986329836, "episode_reward_mean": -10.846290895944668, "episode_len_mean": 322.0, "episode_media": {}, "episodes_this_iter": 19, "episodes_timesteps_total": 32200, "policy_reward_min": {"agent_policy": -44.51433944521759, "adversary_policy": -68.38316008781057}, "policy_reward_max": {"agent_policy": 55.44159986329835, "adversary_policy": 46.05981132609115}, "policy_reward_mean": {"agent_policy": 10.84629089594467, "adversary_policy": -10.84629089594467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.073967429534186, 7.816926644191792, -1.0381380630486463, -42.18781915762754, -11.580330207928883, -28.780490254174158, 17.406575159365435, -1.578287731086566, -4.866070687597847, -32.64907400268627, -55.44159986329836, -29.337674487139083, -9.581908967101683, -41.61621809256423, 22.10600100398241, 6.6810608446322854, 1.4174951047035584, 13.838503788280317, -35.120282820352806, -11.924948108925545, 26.596601406424167, -32.92941416405243, 19.78406595948415, 2.4875347729334076, -16.632315775342583, 8.980660730743487, 12.29778967618841, -12.210313037504012, 0.6877917563306881, -21.09692842975239, -18.78191317379825, -40.88893672815309, -0.71174571144737, 4.338192269081537, 3.686750546000919, 26.856307632755026, 4.428481631095753, 28.43822968998834, 5.229954888210036, 13.77078607625509, -2.828159283933604, -34.409794700723914, -14.544362585781377, 4.783826388381174, 15.283242166644627, 6.256074725604411, 0.620304700396682, -29.18405204560443, 26.65040449884597, 33.5493417394957, -2.7184789929968316, -0.8401456727044563, -9.433602944128097, -26.726934719837864, -29.928413536567646, -11.707340734125275, -6.7926087969929565, -21.973340260446154, -11.45148314774412, -34.541620551808, 9.448305401112524, -6.0457405259154084, -38.232055548749194, 6.725776711651283, -25.13208953411172, 1.4388356954651904, -43.2787190259871, 10.890874415310353, -31.473000746725667, -28.539303676032333, -37.30705081671155, -53.459035394421065, -29.939053663689485, -15.881832904417852, -55.235988990422875, -3.1967571976273916, -22.70611543716226, -22.776172806228118, -24.568165797002152, -13.343764289093308, -24.711401314363687, -45.54499319593982, 17.154167995743475, -31.187684381866816, -6.997794286877548, -3.1072677229667525, -0.08798412514430076, 4.6388226673115405, -39.040564339070336, -20.179234441980853, -2.4820162114414366, 2.2233852049086007, 44.514339445217594, -44.70353781606621, -2.6250067497817455, -13.712406852550064, 0.006129040726727375, -43.58558513978465, -19.35271717668534, -23.120874996601817], "episode_lengths": [400, 400, 62, 400, 170, 400, 195, 79, 84, 400, 400, 400, 132, 400, 328, 400, 47, 400, 400, 359, 400, 400, 83, 84, 400, 400, 400, 400, 400, 400, 400, 400, 66, 147, 31, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 194, 400, 400, 58, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 26, 400, 400, 45, 197, 130, 400, 85, 61, 50, 400, 400, 400], "policy_agent_policy_reward": [38.07396742953418, -7.8169266441917955, 1.0381380630486463, 42.18781915762753, 11.580330207928892, 28.780490254174158, -17.40657515936544, 1.578287731086565, 4.866070687597848, 32.64907400268627, 55.44159986329835, 29.337674487139083, 9.581908967101677, 41.61621809256424, -22.10600100398242, -6.6810608446322854, -1.4174951047035584, -13.838503788280315, 35.1202828203528, 11.924948108925548, -26.596601406424142, 32.929414164052396, -19.784065959484156, -2.4875347729334063, 16.632315775342587, -8.980660730743487, -12.297789676188412, 12.210313037504012, -0.6877917563306872, 21.096928429752385, 18.78191317379825, 40.8889367281531, 0.71174571144737, -4.338192269081537, -3.6867505460009182, -26.85630763275504, -4.428481631095755, -28.438229689988326, -5.229954888210036, -13.770786076255092, 2.8281592839336014, 34.40979470072391, 14.544362585781379, -4.783826388381174, -15.283242166644643, -6.256074725604411, -0.620304700396682, 29.184052045604435, -26.65040449884596, -33.5493417394957, 2.7184789929968316, 0.8401456727044607, 9.433602944128088, 26.726934719837864, 29.928413536567646, 11.707340734125273, 6.7926087969929565, 21.973340260446154, 11.451483147744124, 34.54162055180801, -9.448305401112522, 6.0457405259154084, 38.23205554874919, -6.72577671165128, 25.13208953411172, -1.4388356954651904, 43.27871902598711, -10.890874415310348, 31.473000746725663, 28.53930367603235, 37.30705081671153, 53.45903539442106, 29.939053663689492, 15.881832904417857, 55.23598899042287, 3.196757197627398, 22.70611543716226, 22.776172806228118, 24.568165797002152, 13.343764289093308, 24.711401314363698, 45.54499319593981, -17.15416799574345, 31.187684381866813, 6.997794286877548, 3.1072677229667525, 0.08798412514430076, -4.6388226673115405, 39.04056433907037, 20.179234441980835, 2.4820162114414366, -2.2233852049086007, -44.51433944521759, 44.70353781606623, 2.6250067497817504, 13.712406852550064, -0.006129040726726487, 43.585585139784655, 19.35271717668534, 23.120874996601817], "policy_adversary_policy_reward": [-38.19169681807647, -37.95623804099191, 8.981149705115065, 6.652703583268526, -16.161549297607117, 14.085273171509826, -53.31152217319551, -31.06411614205956, -32.15209859183258, 8.991438175974796, -32.4800076956376, -25.080972812710712, 16.648648582801997, 18.16450173592888, -13.091594172983875, 9.935018710810745, 16.009752945067927, -25.741894320263622, -39.603245169257015, -25.69490283611553, -56.09748337435617, -54.78571635224049, -36.566387689086746, -22.10896128519142, -35.657835024368445, 16.494017090165084, -45.658660086062525, -37.573776099065945, 27.845564269426806, 16.36643773853803, 5.1654285920098495, 8.19669309725472, -23.78086602302815, 26.615856232435267, 10.191057910749347, 17.485949665811276, -36.08879092090502, -34.15177471980062, 3.854841325093478, -27.704737542944585, 15.476087959984582, 37.717114852863716, 2.5243317597058024, -68.38316008781057, 21.445718103971426, 18.122413814996875, -6.486592201615139, 11.461661747481951, 1.9788677060235091, -35.24349925670869, 17.39114868012962, 0.5701727813573543, -3.8553583803539215, 28.450937732730743, -22.26017379608067, -2.1604522789273517, 2.3509800901922766, -0.9753965775309021, -50.12704022479239, 7.93318336528762, -21.554298633914186, -16.009527713682317, -31.42575010631562, -50.35212334999061, -14.402052710131038, 12.9785612872363, 23.478533174967346, -14.802148636804269, -14.212477926744956, 21.585979018746794, 28.64665701860428, 25.065958246905836, 13.267774637009513, -4.410811374818003, 25.790080344654235, 31.086379035322423, -13.032743213226702, 23.49265298964677, 15.607151259066852, 11.934420893443331, 26.350012820550372, -32.00633138841758, -38.16346200975816, -30.656127391689658, 22.32112437714764, -51.4098495487104, 30.31125770930198, -20.743604932539633, 20.73714834858276, 9.829335984706526, 6.656749172765371, 5.855400278443448, -20.453229031334182, 21.69383843212755, -30.005833394526665, -28.362270696682202, 32.033501129678854, 21.267307868013077, 35.876630147696716, 31.22205333129468, -27.02836832084263, 21.591410334848977, 1.6412733262994248, -3.32156467170835, -26.841209463256654, 7.974003575000486, -25.51512524578029, -27.938744193895438, -23.483809904528712, -36.37301716860658, 12.364639907573768, -35.77932137582431, 21.196872858395672, -34.782090452381595, -23.60336063182296, -20.34331988906935, -33.985447683208164, 11.082481387719913, -33.67929396136048, -35.4039471422555, 9.68652757401684, 9.210083228208218, 8.130855249225819, -20.222336301056636, -45.09129123993724, -31.372819857561126, 11.45025274816651, 2.0013006751360543, -34.83153087167886, -15.432648196544584, 21.09703834685923, -18.219366955928848, -54.1429724694067, -32.41446558256754, 10.899099423184097, 10.882649407436602, -39.88933912775235, -23.056662365698983, -1.5294809609002105, -55.5491263911645, -29.56948883668916, -45.04461279673395, -56.89991733548583, -50.018153453356334, -39.24522552628297, -20.632881801096005, 17.404614191038675, -49.168279999874386, -55.87418614505637, -54.59779183578936, -44.74375306606641, 38.35023867081161, -27.558677187247035, -17.853553687077486, -27.420362295495416, -18.13198331696082, -28.21385462399378, -20.92247697001053, -7.565415558431646, -19.12211301975497, -14.42284000091983, -34.99996262780759, -39.34760778033857, -51.74237861154104, 23.742149118704297, 10.566186872782595, -31.1170188102086, -31.25834995352504, 13.14890405422705, -27.144492627982146, 10.285208327325778, -16.499743773259283, 2.614486405857553, -2.7904546561461547, 12.016428240436532, -2.7387829058134514, -35.58266089557814, -42.49846778256253, -37.56234775054245, -2.796121133419252, -19.15778230978714, 14.193749886904268, 31.007038866097783, -26.560268456280586, 42.96886756434402, 46.05981132609115, -40.0575340637678, -49.34954156836462, 10.149508467241713, -15.39952196680521, 2.256897202574052, -29.68171090767418, -16.501978016258263, 16.514236097711716, -49.079200480632295, -38.091969798937, -41.054080624054095, 2.3486462706833944, -22.90992050806951, -23.331829485134122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43677216368740546, "mean_inference_ms": 1.162027392346516, "mean_action_processing_ms": 0.18792560705098896, "mean_env_wait_ms": 0.07786077936006372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031480789184570312, "StateBufferConnector_ms": 0.002447843551635742, "ViewRequirementAgentConnector_ms": 0.06903541088104248}, "num_episodes": 19, "episode_return_max": 44.514339445217594, "episode_return_min": -55.44159986329836, "episode_return_mean": -10.846290895944668}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 476.6577101893657, "num_env_steps_trained_throughput_per_sec": 476.6577101893657, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 8164.26, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8164.228, "sample_time_ms": 819.656, "learn_time_ms": 7331.096, "learn_throughput": 545.621, "synch_weights_time_ms": 13.01}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "training_iteration": 105, "trial_id": "83a5c_00000", "date": "2024-08-10_12-29-02", "timestamp": 1723307342, "time_this_iter_s": 8.39664101600647, "time_total_s": 904.7646355628967, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faadf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 904.7646355628967, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 28.13333333333333, "ram_util_percent": 81.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7492575660584464, "cur_kl_coeff": 0.09010162353515624, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.711678790289258, "policy_loss": -0.00900967667500178, "vf_loss": 6.719570223742692, "vf_explained_var": -0.034891341413770406, "kl": 0.01241081821994101, "entropy": 0.994534993770892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.391933024302125, "cur_kl_coeff": 0.0009385585784912107, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.176529381175836, "policy_loss": -0.010077290294672518, "vf_loss": 7.186584915220737, "vf_explained_var": -0.8436954494565725, "kl": 0.023147669842212816, "entropy": 0.906296813301742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": 44.514339445217594, "episode_reward_min": -55.235988990422875, "episode_reward_mean": -5.665989614264137, "episode_len_mean": 289.98, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 28998, "policy_reward_min": {"agent_policy": -44.51433944521759, "adversary_policy": -56.89991733548583}, "policy_reward_max": {"agent_policy": 55.23598899042287, "adversary_policy": 46.05981132609115}, "policy_reward_mean": {"agent_policy": 5.665989614264138, "adversary_policy": -5.665989614264138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.4875347729334076, -16.632315775342583, 8.980660730743487, 12.29778967618841, -12.210313037504012, 0.6877917563306881, -21.09692842975239, -18.78191317379825, -40.88893672815309, -0.71174571144737, 4.338192269081537, 3.686750546000919, 26.856307632755026, 4.428481631095753, 28.43822968998834, 5.229954888210036, 13.77078607625509, -2.828159283933604, -34.409794700723914, -14.544362585781377, 4.783826388381174, 15.283242166644627, 6.256074725604411, 0.620304700396682, -29.18405204560443, 26.65040449884597, 33.5493417394957, -2.7184789929968316, -0.8401456727044563, -9.433602944128097, -26.726934719837864, -29.928413536567646, -11.707340734125275, -6.7926087969929565, -21.973340260446154, -11.45148314774412, -34.541620551808, 9.448305401112524, -6.0457405259154084, -38.232055548749194, 6.725776711651283, -25.13208953411172, 1.4388356954651904, -43.2787190259871, 10.890874415310353, -31.473000746725667, -28.539303676032333, -37.30705081671155, -53.459035394421065, -29.939053663689485, -15.881832904417852, -55.235988990422875, -3.1967571976273916, -22.70611543716226, -22.776172806228118, -24.568165797002152, -13.343764289093308, -24.711401314363687, -45.54499319593982, 17.154167995743475, -31.187684381866816, -6.997794286877548, -3.1072677229667525, -0.08798412514430076, 4.6388226673115405, -39.040564339070336, -20.179234441980853, -2.4820162114414366, 2.2233852049086007, 44.514339445217594, -44.70353781606621, -2.6250067497817455, -13.712406852550064, 0.006129040726727375, -43.58558513978465, -19.35271717668534, -23.120874996601817, 12.410435305264485, 6.701080975830046, 27.558065453869315, 3.342406259718203, 27.746068978565635, 33.59833925934699, -48.39535675969122, 23.627821520368958, -2.286204884271992, 7.443248894638431, 15.91576432948658, 21.857415568310536, 7.634636797146169, 23.527901690706674, 9.404851329066988, 38.629909746777614, 10.714430211647228, 9.19713321379965, -3.6208601875694733, -3.4428832535535188, 6.635406380198127, 26.060434588383607, 2.711088623960025], "episode_lengths": [84, 400, 400, 400, 400, 400, 400, 400, 400, 66, 147, 31, 400, 400, 400, 48, 400, 400, 400, 400, 400, 400, 400, 194, 400, 400, 58, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 26, 400, 400, 45, 197, 130, 400, 85, 61, 50, 400, 400, 400, 98, 49, 124, 122, 94, 201, 400, 148, 400, 87, 54, 71, 129, 84, 91, 159, 400, 28, 66, 400, 48, 172, 112], "policy_agent_policy_reward": [-2.4875347729334063, 16.632315775342587, -8.980660730743487, -12.297789676188412, 12.210313037504012, -0.6877917563306872, 21.096928429752385, 18.78191317379825, 40.8889367281531, 0.71174571144737, -4.338192269081537, -3.6867505460009182, -26.85630763275504, -4.428481631095755, -28.438229689988326, -5.229954888210036, -13.770786076255092, 2.8281592839336014, 34.40979470072391, 14.544362585781379, -4.783826388381174, -15.283242166644643, -6.256074725604411, -0.620304700396682, 29.184052045604435, -26.65040449884596, -33.5493417394957, 2.7184789929968316, 0.8401456727044607, 9.433602944128088, 26.726934719837864, 29.928413536567646, 11.707340734125273, 6.7926087969929565, 21.973340260446154, 11.451483147744124, 34.54162055180801, -9.448305401112522, 6.0457405259154084, 38.23205554874919, -6.72577671165128, 25.13208953411172, -1.4388356954651904, 43.27871902598711, -10.890874415310348, 31.473000746725663, 28.53930367603235, 37.30705081671153, 53.45903539442106, 29.939053663689492, 15.881832904417857, 55.23598899042287, 3.196757197627398, 22.70611543716226, 22.776172806228118, 24.568165797002152, 13.343764289093308, 24.711401314363698, 45.54499319593981, -17.15416799574345, 31.187684381866813, 6.997794286877548, 3.1072677229667525, 0.08798412514430076, -4.6388226673115405, 39.04056433907037, 20.179234441980835, 2.4820162114414366, -2.2233852049086007, -44.51433944521759, 44.70353781606623, 2.6250067497817504, 13.712406852550064, -0.006129040726726487, 43.585585139784655, 19.35271717668534, 23.120874996601817, -12.410435305264487, -6.7010809758300445, -27.558065453869304, -3.342406259718203, -27.746068978565624, -33.59833925934701, 48.39535675969121, -23.627821520368958, 2.2862048842719886, -7.443248894638431, -15.915764329486578, -21.857415568310532, -7.634636797146168, -23.52790169070667, -9.40485132906699, -38.629909746777614, -10.71443021164723, -9.197133213799653, 3.6208601875694706, 3.442883253553518, -6.635406380198127, -26.06043458838361, -2.7110886239600234], "policy_adversary_policy_reward": [-6.486592201615139, 11.461661747481951, 1.9788677060235091, -35.24349925670869, 17.39114868012962, 0.5701727813573543, -3.8553583803539215, 28.450937732730743, -22.26017379608067, -2.1604522789273517, 2.3509800901922766, -0.9753965775309021, -50.12704022479239, 7.93318336528762, -21.554298633914186, -16.009527713682317, -31.42575010631562, -50.35212334999061, -14.402052710131038, 12.9785612872363, 23.478533174967346, -14.802148636804269, -14.212477926744956, 21.585979018746794, 28.64665701860428, 25.065958246905836, 13.267774637009513, -4.410811374818003, 25.790080344654235, 31.086379035322423, -13.032743213226702, 23.49265298964677, 15.607151259066852, 11.934420893443331, 26.350012820550372, -32.00633138841758, -38.16346200975816, -30.656127391689658, 22.32112437714764, -51.4098495487104, 30.31125770930198, -20.743604932539633, 20.73714834858276, 9.829335984706526, 6.656749172765371, 5.855400278443448, -20.453229031334182, 21.69383843212755, -30.005833394526665, -28.362270696682202, 32.033501129678854, 21.267307868013077, 35.876630147696716, 31.22205333129468, -27.02836832084263, 21.591410334848977, 1.6412733262994248, -3.32156467170835, -26.841209463256654, 7.974003575000486, -25.51512524578029, -27.938744193895438, -23.483809904528712, -36.37301716860658, 12.364639907573768, -35.77932137582431, 21.196872858395672, -34.782090452381595, -23.60336063182296, -20.34331988906935, -33.985447683208164, 11.082481387719913, -33.67929396136048, -35.4039471422555, 9.68652757401684, 9.210083228208218, 8.130855249225819, -20.222336301056636, -45.09129123993724, -31.372819857561126, 11.45025274816651, 2.0013006751360543, -34.83153087167886, -15.432648196544584, 21.09703834685923, -18.219366955928848, -54.1429724694067, -32.41446558256754, 10.899099423184097, 10.882649407436602, -39.88933912775235, -23.056662365698983, -1.5294809609002105, -55.5491263911645, -29.56948883668916, -45.04461279673395, -56.89991733548583, -50.018153453356334, -39.24522552628297, -20.632881801096005, 17.404614191038675, -49.168279999874386, -55.87418614505637, -54.59779183578936, -44.74375306606641, 38.35023867081161, -27.558677187247035, -17.853553687077486, -27.420362295495416, -18.13198331696082, -28.21385462399378, -20.92247697001053, -7.565415558431646, -19.12211301975497, -14.42284000091983, -34.99996262780759, -39.34760778033857, -51.74237861154104, 23.742149118704297, 10.566186872782595, -31.1170188102086, -31.25834995352504, 13.14890405422705, -27.144492627982146, 10.285208327325778, -16.499743773259283, 2.614486405857553, -2.7904546561461547, 12.016428240436532, -2.7387829058134514, -35.58266089557814, -42.49846778256253, -37.56234775054245, -2.796121133419252, -19.15778230978714, 14.193749886904268, 31.007038866097783, -26.560268456280586, 42.96886756434402, 46.05981132609115, -40.0575340637678, -49.34954156836462, 10.149508467241713, -15.39952196680521, 2.256897202574052, -29.68171090767418, -16.501978016258263, 16.514236097711716, -49.079200480632295, -38.091969798937, -41.054080624054095, 2.3486462706833944, -22.90992050806951, -23.331829485134122, -13.214355095578444, 38.03522570610742, 4.400609688712656, 9.001552262947435, 39.265345436337455, 15.85078547140117, 33.35239693434589, -26.667584414909484, 17.1347217014684, 38.35741625566284, 34.70970256990143, 32.48697594879258, -54.461592710669514, -42.32912080871293, 8.154714476032474, 39.10092856470544, -33.65178576313818, 29.0793759945942, -18.337374370510314, 33.22387215978718, 11.906465351182941, 19.92506330779021, 4.892808906250444, 38.822022230370635, 29.220611829459664, -13.951338235167327, 26.89333461090527, 20.162468770508074, -9.889590762615793, 28.69929342074977, 42.33554739541826, 34.92427209813696, -18.410566337380395, 39.839426760674826, 9.464210598881884, 8.930055828717418, 20.113588166371056, -27.355308541510006, -23.04481292740745, 16.159046420300413, -6.028505474076045, 19.2993182344723, 35.9355927731606, 16.18527640360661, -14.2040955589489, 19.626272806868947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43642149871779784, "mean_inference_ms": 1.1605034991131862, "mean_action_processing_ms": 0.1878043094637217, "mean_env_wait_ms": 0.07765615293900006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003139495849609375, "StateBufferConnector_ms": 0.0024602413177490234, "ViewRequirementAgentConnector_ms": 0.06652951240539551}, "num_episodes": 23, "episode_return_max": 44.514339445217594, "episode_return_min": -55.235988990422875, "episode_return_mean": -5.665989614264137}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 483.91380128505915, "num_env_steps_trained_throughput_per_sec": 483.91380128505915, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 8187.152, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8187.12, "sample_time_ms": 817.972, "learn_time_ms": 7355.118, "learn_throughput": 543.839, "synch_weights_time_ms": 13.564}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 106, "trial_id": "83a5c_00000", "date": "2024-08-10_12-29-10", "timestamp": 1723307350, "time_this_iter_s": 8.27347707748413, "time_total_s": 913.0381126403809, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a6430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 913.0381126403809, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 26.766666666666666, "ram_util_percent": 81.64166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.183832667239759, "cur_kl_coeff": 0.09010162353515624, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.886833130619514, "policy_loss": -0.009475286944557435, "vf_loss": 5.895202453805025, "vf_explained_var": -0.11458283870939225, "kl": 0.012274557420934676, "entropy": 0.8904226736416893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.971037041799476, "cur_kl_coeff": 0.001407837867736816, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.068534283836683, "policy_loss": -0.011010290147775473, "vf_loss": 6.07950657059749, "vf_explained_var": -0.39183696986486516, "kl": 0.026987253108009947, "entropy": 0.9063991224393249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "env_runners": {"episode_reward_max": 44.514339445217594, "episode_reward_min": -55.235988990422875, "episode_reward_mean": -2.521196554629161, "episode_len_mean": 259.74, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 25974, "policy_reward_min": {"agent_policy": -44.51433944521759, "adversary_policy": -56.89991733548583}, "policy_reward_max": {"agent_policy": 55.23598899042287, "adversary_policy": 48.0232861629035}, "policy_reward_mean": {"agent_policy": 2.521196554629161, "adversary_policy": -2.521196554629164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.256074725604411, 0.620304700396682, -29.18405204560443, 26.65040449884597, 33.5493417394957, -2.7184789929968316, -0.8401456727044563, -9.433602944128097, -26.726934719837864, -29.928413536567646, -11.707340734125275, -6.7926087969929565, -21.973340260446154, -11.45148314774412, -34.541620551808, 9.448305401112524, -6.0457405259154084, -38.232055548749194, 6.725776711651283, -25.13208953411172, 1.4388356954651904, -43.2787190259871, 10.890874415310353, -31.473000746725667, -28.539303676032333, -37.30705081671155, -53.459035394421065, -29.939053663689485, -15.881832904417852, -55.235988990422875, -3.1967571976273916, -22.70611543716226, -22.776172806228118, -24.568165797002152, -13.343764289093308, -24.711401314363687, -45.54499319593982, 17.154167995743475, -31.187684381866816, -6.997794286877548, -3.1072677229667525, -0.08798412514430076, 4.6388226673115405, -39.040564339070336, -20.179234441980853, -2.4820162114414366, 2.2233852049086007, 44.514339445217594, -44.70353781606621, -2.6250067497817455, -13.712406852550064, 0.006129040726727375, -43.58558513978465, -19.35271717668534, -23.120874996601817, 12.410435305264485, 6.701080975830046, 27.558065453869315, 3.342406259718203, 27.746068978565635, 33.59833925934699, -48.39535675969122, 23.627821520368958, -2.286204884271992, 7.443248894638431, 15.91576432948658, 21.857415568310536, 7.634636797146169, 23.527901690706674, 9.404851329066988, 38.629909746777614, 10.714430211647228, 9.19713321379965, -3.6208601875694733, -3.4428832535535188, 6.635406380198127, 26.060434588383607, 2.711088623960025, 38.59316903590662, -3.718910557363701, -9.775632337105183, 29.75856327309629, 17.074235234109977, 33.36692202157957, 10.206176729946945, 30.451266930432304, 6.379985815232791, -3.5066663036027474, 21.350553673152156, -0.9197388726466105, -7.042655628915275, 1.5743014940778188, 1.3704068029520045, 18.471052372808124, 16.54802639837701, 37.19837438101741, 16.25406065330716, 14.00438707885324, 13.540271047289867, 2.466235519163692], "episode_lengths": [400, 194, 400, 400, 58, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 26, 400, 400, 45, 197, 130, 400, 85, 61, 50, 400, 400, 400, 98, 49, 124, 122, 94, 201, 400, 148, 400, 87, 54, 71, 129, 84, 91, 159, 400, 28, 66, 400, 48, 172, 112, 313, 400, 115, 366, 52, 89, 133, 117, 216, 400, 400, 7, 77, 53, 72, 140, 24, 379, 347, 338, 93, 21], "policy_agent_policy_reward": [-6.256074725604411, -0.620304700396682, 29.184052045604435, -26.65040449884596, -33.5493417394957, 2.7184789929968316, 0.8401456727044607, 9.433602944128088, 26.726934719837864, 29.928413536567646, 11.707340734125273, 6.7926087969929565, 21.973340260446154, 11.451483147744124, 34.54162055180801, -9.448305401112522, 6.0457405259154084, 38.23205554874919, -6.72577671165128, 25.13208953411172, -1.4388356954651904, 43.27871902598711, -10.890874415310348, 31.473000746725663, 28.53930367603235, 37.30705081671153, 53.45903539442106, 29.939053663689492, 15.881832904417857, 55.23598899042287, 3.196757197627398, 22.70611543716226, 22.776172806228118, 24.568165797002152, 13.343764289093308, 24.711401314363698, 45.54499319593981, -17.15416799574345, 31.187684381866813, 6.997794286877548, 3.1072677229667525, 0.08798412514430076, -4.6388226673115405, 39.04056433907037, 20.179234441980835, 2.4820162114414366, -2.2233852049086007, -44.51433944521759, 44.70353781606623, 2.6250067497817504, 13.712406852550064, -0.006129040726726487, 43.585585139784655, 19.35271717668534, 23.120874996601817, -12.410435305264487, -6.7010809758300445, -27.558065453869304, -3.342406259718203, -27.746068978565624, -33.59833925934701, 48.39535675969121, -23.627821520368958, 2.2862048842719886, -7.443248894638431, -15.915764329486578, -21.857415568310532, -7.634636797146168, -23.52790169070667, -9.40485132906699, -38.629909746777614, -10.71443021164723, -9.197133213799653, 3.6208601875694706, 3.442883253553518, -6.635406380198127, -26.06043458838361, -2.7110886239600234, -38.593169035906655, 3.718910557363696, 9.775632337105165, -29.75856327309628, -17.074235234109974, -33.36692202157957, -10.206176729946945, -30.451266930432304, -6.379985815232786, 3.5066663036027457, -21.350553673152156, 0.9197388726466105, 7.042655628915272, -1.5743014940778188, -1.3704068029520027, -18.471052372808128, -16.548026398377015, -37.198374381017416, -16.254060653307167, -14.004387078853242, -13.540271047289867, -2.4662355191636927], "policy_adversary_policy_reward": [6.656749172765371, 5.855400278443448, -20.453229031334182, 21.69383843212755, -30.005833394526665, -28.362270696682202, 32.033501129678854, 21.267307868013077, 35.876630147696716, 31.22205333129468, -27.02836832084263, 21.591410334848977, 1.6412733262994248, -3.32156467170835, -26.841209463256654, 7.974003575000486, -25.51512524578029, -27.938744193895438, -23.483809904528712, -36.37301716860658, 12.364639907573768, -35.77932137582431, 21.196872858395672, -34.782090452381595, -23.60336063182296, -20.34331988906935, -33.985447683208164, 11.082481387719913, -33.67929396136048, -35.4039471422555, 9.68652757401684, 9.210083228208218, 8.130855249225819, -20.222336301056636, -45.09129123993724, -31.372819857561126, 11.45025274816651, 2.0013006751360543, -34.83153087167886, -15.432648196544584, 21.09703834685923, -18.219366955928848, -54.1429724694067, -32.41446558256754, 10.899099423184097, 10.882649407436602, -39.88933912775235, -23.056662365698983, -1.5294809609002105, -55.5491263911645, -29.56948883668916, -45.04461279673395, -56.89991733548583, -50.018153453356334, -39.24522552628297, -20.632881801096005, 17.404614191038675, -49.168279999874386, -55.87418614505637, -54.59779183578936, -44.74375306606641, 38.35023867081161, -27.558677187247035, -17.853553687077486, -27.420362295495416, -18.13198331696082, -28.21385462399378, -20.92247697001053, -7.565415558431646, -19.12211301975497, -14.42284000091983, -34.99996262780759, -39.34760778033857, -51.74237861154104, 23.742149118704297, 10.566186872782595, -31.1170188102086, -31.25834995352504, 13.14890405422705, -27.144492627982146, 10.285208327325778, -16.499743773259283, 2.614486405857553, -2.7904546561461547, 12.016428240436532, -2.7387829058134514, -35.58266089557814, -42.49846778256253, -37.56234775054245, -2.796121133419252, -19.15778230978714, 14.193749886904268, 31.007038866097783, -26.560268456280586, 42.96886756434402, 46.05981132609115, -40.0575340637678, -49.34954156836462, 10.149508467241713, -15.39952196680521, 2.256897202574052, -29.68171090767418, -16.501978016258263, 16.514236097711716, -49.079200480632295, -38.091969798937, -41.054080624054095, 2.3486462706833944, -22.90992050806951, -23.331829485134122, -13.214355095578444, 38.03522570610742, 4.400609688712656, 9.001552262947435, 39.265345436337455, 15.85078547140117, 33.35239693434589, -26.667584414909484, 17.1347217014684, 38.35741625566284, 34.70970256990143, 32.48697594879258, -54.461592710669514, -42.32912080871293, 8.154714476032474, 39.10092856470544, -33.65178576313818, 29.0793759945942, -18.337374370510314, 33.22387215978718, 11.906465351182941, 19.92506330779021, 4.892808906250444, 38.822022230370635, 29.220611829459664, -13.951338235167327, 26.89333461090527, 20.162468770508074, -9.889590762615793, 28.69929342074977, 42.33554739541826, 34.92427209813696, -18.410566337380395, 39.839426760674826, 9.464210598881884, 8.930055828717418, 20.113588166371056, -27.355308541510006, -23.04481292740745, 16.159046420300413, -6.028505474076045, 19.2993182344723, 35.9355927731606, 16.18527640360661, -14.2040955589489, 19.626272806868947, 29.163051908909786, 48.0232861629035, 22.467537104028963, -29.905358218756348, 31.60693066337413, -51.15819533758447, 44.80505639145359, 14.712070154738946, 19.90731344971871, 14.241157018501248, 38.75211191983514, 27.981732123324026, -2.7100403809845286, 23.122393840878416, 33.672994818189196, 27.229539042675405, 3.7632754379127924, 8.996696192552744, -3.704472515276528, -3.30886009192902, 33.994440788006145, 8.706666558298167, 4.090192597604679, -5.9296703428979, -23.12235032630209, 9.037039068471536, -22.065471547530635, 25.214074535686272, 24.337312570526446, -21.596498964622445, -10.494019839929543, 47.4361245855458, 17.148708121253524, 15.947344675500506, 36.742546830672275, 37.65420193136256, 6.603397085324204, 25.90472422129013, 8.060597537789516, 19.94817661991696, 11.31015506702039, 15.770387027559337, 13.644735694768997, -8.712264656441612]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4362411719822001, "mean_inference_ms": 1.1588412808024497, "mean_action_processing_ms": 0.1875415078620505, "mean_env_wait_ms": 0.077499226042262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032205581665039062, "StateBufferConnector_ms": 0.0024698972702026367, "ViewRequirementAgentConnector_ms": 0.06660974025726318}, "num_episodes": 22, "episode_return_max": 44.514339445217594, "episode_return_min": -55.235988990422875, "episode_return_mean": -2.521196554629161}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.20788125123636, "num_env_steps_trained_throughput_per_sec": 489.20788125123636, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 8172.08, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8172.047, "sample_time_ms": 818.208, "learn_time_ms": 7340.121, "learn_throughput": 544.95, "synch_weights_time_ms": 13.25}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "training_iteration": 107, "trial_id": "83a5c_00000", "date": "2024-08-10_12-29-18", "timestamp": 1723307358, "time_this_iter_s": 8.182573080062866, "time_total_s": 921.2206857204437, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f580a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 921.2206857204437, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 27.63333333333333, "ram_util_percent": 81.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.019911572920582, "cur_kl_coeff": 0.09010162353515624, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.288614907340398, "policy_loss": -0.002268041340417411, "vf_loss": 6.290556360174109, "vf_explained_var": -0.03925590001086079, "kl": 0.0036245676622739236, "entropy": 0.8012917662739123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.298641764683028, "cur_kl_coeff": 0.002111756801605225, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.77642568051815, "policy_loss": -0.01016742290109202, "vf_loss": 5.786534907420476, "vf_explained_var": 0.02343827343235413, "kl": 0.027556314322655803, "entropy": 0.8175140878185629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 44.514339445217594, "episode_reward_min": -55.559802442727936, "episode_reward_mean": 0.3573520327049399, "episode_len_mean": 233.69, "episode_media": {}, "episodes_this_iter": 17, "episodes_timesteps_total": 23369, "policy_reward_min": {"agent_policy": -44.51433944521759, "adversary_policy": -59.43264988532879}, "policy_reward_max": {"agent_policy": 55.55980244272793, "adversary_policy": 48.0232861629035}, "policy_reward_mean": {"agent_policy": -0.35735203270494026, "adversary_policy": 0.357352032704938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.232055548749194, 6.725776711651283, -25.13208953411172, 1.4388356954651904, -43.2787190259871, 10.890874415310353, -31.473000746725667, -28.539303676032333, -37.30705081671155, -53.459035394421065, -29.939053663689485, -15.881832904417852, -55.235988990422875, -3.1967571976273916, -22.70611543716226, -22.776172806228118, -24.568165797002152, -13.343764289093308, -24.711401314363687, -45.54499319593982, 17.154167995743475, -31.187684381866816, -6.997794286877548, -3.1072677229667525, -0.08798412514430076, 4.6388226673115405, -39.040564339070336, -20.179234441980853, -2.4820162114414366, 2.2233852049086007, 44.514339445217594, -44.70353781606621, -2.6250067497817455, -13.712406852550064, 0.006129040726727375, -43.58558513978465, -19.35271717668534, -23.120874996601817, 12.410435305264485, 6.701080975830046, 27.558065453869315, 3.342406259718203, 27.746068978565635, 33.59833925934699, -48.39535675969122, 23.627821520368958, -2.286204884271992, 7.443248894638431, 15.91576432948658, 21.857415568310536, 7.634636797146169, 23.527901690706674, 9.404851329066988, 38.629909746777614, 10.714430211647228, 9.19713321379965, -3.6208601875694733, -3.4428832535535188, 6.635406380198127, 26.060434588383607, 2.711088623960025, 38.59316903590662, -3.718910557363701, -9.775632337105183, 29.75856327309629, 17.074235234109977, 33.36692202157957, 10.206176729946945, 30.451266930432304, 6.379985815232791, -3.5066663036027474, 21.350553673152156, -0.9197388726466105, -7.042655628915275, 1.5743014940778188, 1.3704068029520045, 18.471052372808124, 16.54802639837701, 37.19837438101741, 16.25406065330716, 14.00438707885324, 13.540271047289867, 2.466235519163692, 15.252047142182239, -17.175204687312664, 15.431147728705346, 37.655841454273926, 21.278648783078978, 16.717755683937995, 20.015741827488398, 16.144360933165967, 2.5379694624817986, 7.327699811323807, 5.891078516335346, 12.833716673810377, 20.387375242352615, 12.75037132766871, 23.93227875867951, 17.61450165454976, -55.559802442727936], "episode_lengths": [400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 125, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 26, 400, 400, 45, 197, 130, 400, 85, 61, 50, 400, 400, 400, 98, 49, 124, 122, 94, 201, 400, 148, 400, 87, 54, 71, 129, 84, 91, 159, 400, 28, 66, 400, 48, 172, 112, 313, 400, 115, 366, 52, 89, 133, 117, 216, 400, 400, 7, 77, 53, 72, 140, 24, 379, 347, 338, 93, 21, 400, 400, 103, 365, 298, 400, 235, 57, 36, 64, 70, 31, 163, 400, 142, 83, 400], "policy_agent_policy_reward": [38.23205554874919, -6.72577671165128, 25.13208953411172, -1.4388356954651904, 43.27871902598711, -10.890874415310348, 31.473000746725663, 28.53930367603235, 37.30705081671153, 53.45903539442106, 29.939053663689492, 15.881832904417857, 55.23598899042287, 3.196757197627398, 22.70611543716226, 22.776172806228118, 24.568165797002152, 13.343764289093308, 24.711401314363698, 45.54499319593981, -17.15416799574345, 31.187684381866813, 6.997794286877548, 3.1072677229667525, 0.08798412514430076, -4.6388226673115405, 39.04056433907037, 20.179234441980835, 2.4820162114414366, -2.2233852049086007, -44.51433944521759, 44.70353781606623, 2.6250067497817504, 13.712406852550064, -0.006129040726726487, 43.585585139784655, 19.35271717668534, 23.120874996601817, -12.410435305264487, -6.7010809758300445, -27.558065453869304, -3.342406259718203, -27.746068978565624, -33.59833925934701, 48.39535675969121, -23.627821520368958, 2.2862048842719886, -7.443248894638431, -15.915764329486578, -21.857415568310532, -7.634636797146168, -23.52790169070667, -9.40485132906699, -38.629909746777614, -10.71443021164723, -9.197133213799653, 3.6208601875694706, 3.442883253553518, -6.635406380198127, -26.06043458838361, -2.7110886239600234, -38.593169035906655, 3.718910557363696, 9.775632337105165, -29.75856327309628, -17.074235234109974, -33.36692202157957, -10.206176729946945, -30.451266930432304, -6.379985815232786, 3.5066663036027457, -21.350553673152156, 0.9197388726466105, 7.042655628915272, -1.5743014940778188, -1.3704068029520027, -18.471052372808128, -16.548026398377015, -37.198374381017416, -16.254060653307167, -14.004387078853242, -13.540271047289867, -2.4662355191636927, -15.252047142182235, 17.175204687312654, -15.431147728705351, -37.65584145427393, -21.278648783078978, -16.717755683937995, -20.015741827488398, -16.14436093316597, -2.5379694624817986, -7.327699811323807, -5.891078516335346, -12.833716673810377, -20.38737524235262, -12.750371327668722, -23.932278758679505, -17.61450165454976, 55.55980244272793], "policy_adversary_policy_reward": [-45.09129123993724, -31.372819857561126, 11.45025274816651, 2.0013006751360543, -34.83153087167886, -15.432648196544584, 21.09703834685923, -18.219366955928848, -54.1429724694067, -32.41446558256754, 10.899099423184097, 10.882649407436602, -39.88933912775235, -23.056662365698983, -1.5294809609002105, -55.5491263911645, -29.56948883668916, -45.04461279673395, -56.89991733548583, -50.018153453356334, -39.24522552628297, -20.632881801096005, 17.404614191038675, -49.168279999874386, -55.87418614505637, -54.59779183578936, -44.74375306606641, 38.35023867081161, -27.558677187247035, -17.853553687077486, -27.420362295495416, -18.13198331696082, -28.21385462399378, -20.92247697001053, -7.565415558431646, -19.12211301975497, -14.42284000091983, -34.99996262780759, -39.34760778033857, -51.74237861154104, 23.742149118704297, 10.566186872782595, -31.1170188102086, -31.25834995352504, 13.14890405422705, -27.144492627982146, 10.285208327325778, -16.499743773259283, 2.614486405857553, -2.7904546561461547, 12.016428240436532, -2.7387829058134514, -35.58266089557814, -42.49846778256253, -37.56234775054245, -2.796121133419252, -19.15778230978714, 14.193749886904268, 31.007038866097783, -26.560268456280586, 42.96886756434402, 46.05981132609115, -40.0575340637678, -49.34954156836462, 10.149508467241713, -15.39952196680521, 2.256897202574052, -29.68171090767418, -16.501978016258263, 16.514236097711716, -49.079200480632295, -38.091969798937, -41.054080624054095, 2.3486462706833944, -22.90992050806951, -23.331829485134122, -13.214355095578444, 38.03522570610742, 4.400609688712656, 9.001552262947435, 39.265345436337455, 15.85078547140117, 33.35239693434589, -26.667584414909484, 17.1347217014684, 38.35741625566284, 34.70970256990143, 32.48697594879258, -54.461592710669514, -42.32912080871293, 8.154714476032474, 39.10092856470544, -33.65178576313818, 29.0793759945942, -18.337374370510314, 33.22387215978718, 11.906465351182941, 19.92506330779021, 4.892808906250444, 38.822022230370635, 29.220611829459664, -13.951338235167327, 26.89333461090527, 20.162468770508074, -9.889590762615793, 28.69929342074977, 42.33554739541826, 34.92427209813696, -18.410566337380395, 39.839426760674826, 9.464210598881884, 8.930055828717418, 20.113588166371056, -27.355308541510006, -23.04481292740745, 16.159046420300413, -6.028505474076045, 19.2993182344723, 35.9355927731606, 16.18527640360661, -14.2040955589489, 19.626272806868947, 29.163051908909786, 48.0232861629035, 22.467537104028963, -29.905358218756348, 31.60693066337413, -51.15819533758447, 44.80505639145359, 14.712070154738946, 19.90731344971871, 14.241157018501248, 38.75211191983514, 27.981732123324026, -2.7100403809845286, 23.122393840878416, 33.672994818189196, 27.229539042675405, 3.7632754379127924, 8.996696192552744, -3.704472515276528, -3.30886009192902, 33.994440788006145, 8.706666558298167, 4.090192597604679, -5.9296703428979, -23.12235032630209, 9.037039068471536, -22.065471547530635, 25.214074535686272, 24.337312570526446, -21.596498964622445, -10.494019839929543, 47.4361245855458, 17.148708121253524, 15.947344675500506, 36.742546830672275, 37.65420193136256, 6.603397085324204, 25.90472422129013, 8.060597537789516, 19.94817661991696, 11.31015506702039, 15.770387027559337, 13.644735694768997, -8.712264656441612, 12.71024244529831, 17.793851839066157, 0.3722744047420008, -34.72268377936728, 7.5604207415148075, 23.30187471589589, 30.605179939924994, 44.70650296862284, 35.1819888361913, 7.375308729966656, 5.673317252333479, 27.7621941155425, 20.16621137409404, 19.865272280882753, 29.638698318923325, 2.6500235474086047, 17.968816700410848, -12.892877775447246, 24.283708171941548, -9.628308549293934, -13.296770832878416, 25.078927865549108, 19.133053582213833, 6.534379765406927, 25.32833451082064, 15.446415973884605, 12.283024901160044, 13.21771775417739, 20.20085592148672, 27.66370159587229, 12.02453479331403, 23.20446851578548, -51.68695500012707, -59.43264988532879]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4358274318229822, "mean_inference_ms": 1.1577000640931763, "mean_action_processing_ms": 0.187326239253627, "mean_env_wait_ms": 0.07742508408245263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033150911331176758, "StateBufferConnector_ms": 0.002491474151611328, "ViewRequirementAgentConnector_ms": 0.0669022798538208}, "num_episodes": 17, "episode_return_max": 44.514339445217594, "episode_return_min": -55.559802442727936, "episode_return_mean": 0.3573520327049399}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.43115021715334, "num_env_steps_trained_throughput_per_sec": 467.43115021715334, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 8205.105, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8205.071, "sample_time_ms": 813.986, "learn_time_ms": 7377.356, "learn_throughput": 542.2, "synch_weights_time_ms": 13.223}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 108, "trial_id": "83a5c_00000", "date": "2024-08-10_12-29-27", "timestamp": 1723307367, "time_this_iter_s": 8.581793069839478, "time_total_s": 929.8024787902832, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f61ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 929.8024787902832, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 30.291666666666668, "ram_util_percent": 81.74999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2910274944292803, "cur_kl_coeff": 0.04505081176757812, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.387849842429792, "policy_loss": -0.002750888643490653, "vf_loss": 5.390434755723943, "vf_explained_var": -0.07305022260499379, "kl": 0.0036838445946806987, "entropy": 0.8263973653631866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.148204857607682, "cur_kl_coeff": 0.003167635202407836, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1946015601356823, "policy_loss": -0.033438018974993614, "vf_loss": 3.227806760619084, "vf_explained_var": 0.7643427850057681, "kl": 0.07349659324812213, "entropy": 0.7825760811567306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "env_runners": {"episode_reward_max": 44.514339445217594, "episode_reward_min": -56.40570895774816, "episode_reward_mean": 1.32285398577387, "episode_len_mean": 229.82, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 22982, "policy_reward_min": {"agent_policy": -44.51433944521759, "adversary_policy": -62.771780636471696}, "policy_reward_max": {"agent_policy": 56.40570895774815, "adversary_policy": 48.0232861629035}, "policy_reward_mean": {"agent_policy": -1.3228539857738708, "adversary_policy": 1.3228539857738695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.235988990422875, -3.1967571976273916, -22.70611543716226, -22.776172806228118, -24.568165797002152, -13.343764289093308, -24.711401314363687, -45.54499319593982, 17.154167995743475, -31.187684381866816, -6.997794286877548, -3.1072677229667525, -0.08798412514430076, 4.6388226673115405, -39.040564339070336, -20.179234441980853, -2.4820162114414366, 2.2233852049086007, 44.514339445217594, -44.70353781606621, -2.6250067497817455, -13.712406852550064, 0.006129040726727375, -43.58558513978465, -19.35271717668534, -23.120874996601817, 12.410435305264485, 6.701080975830046, 27.558065453869315, 3.342406259718203, 27.746068978565635, 33.59833925934699, -48.39535675969122, 23.627821520368958, -2.286204884271992, 7.443248894638431, 15.91576432948658, 21.857415568310536, 7.634636797146169, 23.527901690706674, 9.404851329066988, 38.629909746777614, 10.714430211647228, 9.19713321379965, -3.6208601875694733, -3.4428832535535188, 6.635406380198127, 26.060434588383607, 2.711088623960025, 38.59316903590662, -3.718910557363701, -9.775632337105183, 29.75856327309629, 17.074235234109977, 33.36692202157957, 10.206176729946945, 30.451266930432304, 6.379985815232791, -3.5066663036027474, 21.350553673152156, -0.9197388726466105, -7.042655628915275, 1.5743014940778188, 1.3704068029520045, 18.471052372808124, 16.54802639837701, 37.19837438101741, 16.25406065330716, 14.00438707885324, 13.540271047289867, 2.466235519163692, 15.252047142182239, -17.175204687312664, 15.431147728705346, 37.655841454273926, 21.278648783078978, 16.717755683937995, 20.015741827488398, 16.144360933165967, 2.5379694624817986, 7.327699811323807, 5.891078516335346, 12.833716673810377, 20.387375242352615, 12.75037132766871, 23.93227875867951, 17.61450165454976, -55.559802442727936, 17.27763602479181, 23.147630336964315, -34.79945717472102, -48.31331960697813, -49.06687252142007, -56.40570895774816, 13.681986331479765, 20.625905640400354, -52.88148270725169, -55.24318366658544, 15.993340445788881, 18.347066673753222], "episode_lengths": [400, 125, 400, 400, 400, 400, 400, 400, 400, 400, 400, 84, 400, 26, 400, 400, 45, 197, 130, 400, 85, 61, 50, 400, 400, 400, 98, 49, 124, 122, 94, 201, 400, 148, 400, 87, 54, 71, 129, 84, 91, 159, 400, 28, 66, 400, 48, 172, 112, 313, 400, 115, 366, 52, 89, 133, 117, 216, 400, 400, 7, 77, 53, 72, 140, 24, 379, 347, 338, 93, 21, 400, 400, 103, 365, 298, 400, 235, 57, 36, 64, 70, 31, 163, 400, 142, 83, 400, 400, 255, 400, 400, 400, 400, 249, 352, 400, 400, 128, 259], "policy_agent_policy_reward": [55.23598899042287, 3.196757197627398, 22.70611543716226, 22.776172806228118, 24.568165797002152, 13.343764289093308, 24.711401314363698, 45.54499319593981, -17.15416799574345, 31.187684381866813, 6.997794286877548, 3.1072677229667525, 0.08798412514430076, -4.6388226673115405, 39.04056433907037, 20.179234441980835, 2.4820162114414366, -2.2233852049086007, -44.51433944521759, 44.70353781606623, 2.6250067497817504, 13.712406852550064, -0.006129040726726487, 43.585585139784655, 19.35271717668534, 23.120874996601817, -12.410435305264487, -6.7010809758300445, -27.558065453869304, -3.342406259718203, -27.746068978565624, -33.59833925934701, 48.39535675969121, -23.627821520368958, 2.2862048842719886, -7.443248894638431, -15.915764329486578, -21.857415568310532, -7.634636797146168, -23.52790169070667, -9.40485132906699, -38.629909746777614, -10.71443021164723, -9.197133213799653, 3.6208601875694706, 3.442883253553518, -6.635406380198127, -26.06043458838361, -2.7110886239600234, -38.593169035906655, 3.718910557363696, 9.775632337105165, -29.75856327309628, -17.074235234109974, -33.36692202157957, -10.206176729946945, -30.451266930432304, -6.379985815232786, 3.5066663036027457, -21.350553673152156, 0.9197388726466105, 7.042655628915272, -1.5743014940778188, -1.3704068029520027, -18.471052372808128, -16.548026398377015, -37.198374381017416, -16.254060653307167, -14.004387078853242, -13.540271047289867, -2.4662355191636927, -15.252047142182235, 17.175204687312654, -15.431147728705351, -37.65584145427393, -21.278648783078978, -16.717755683937995, -20.015741827488398, -16.14436093316597, -2.5379694624817986, -7.327699811323807, -5.891078516335346, -12.833716673810377, -20.38737524235262, -12.750371327668722, -23.932278758679505, -17.61450165454976, 55.55980244272793, -17.277636024791814, -23.14763033696431, 34.79945717472102, 48.31331960697811, 49.06687252142005, 56.40570895774815, -13.681986331479774, -20.62590564040035, 52.881482707251685, 55.24318366658543, -15.993340445788881, -18.347066673753215], "policy_adversary_policy_reward": [-55.87418614505637, -54.59779183578936, -44.74375306606641, 38.35023867081161, -27.558677187247035, -17.853553687077486, -27.420362295495416, -18.13198331696082, -28.21385462399378, -20.92247697001053, -7.565415558431646, -19.12211301975497, -14.42284000091983, -34.99996262780759, -39.34760778033857, -51.74237861154104, 23.742149118704297, 10.566186872782595, -31.1170188102086, -31.25834995352504, 13.14890405422705, -27.144492627982146, 10.285208327325778, -16.499743773259283, 2.614486405857553, -2.7904546561461547, 12.016428240436532, -2.7387829058134514, -35.58266089557814, -42.49846778256253, -37.56234775054245, -2.796121133419252, -19.15778230978714, 14.193749886904268, 31.007038866097783, -26.560268456280586, 42.96886756434402, 46.05981132609115, -40.0575340637678, -49.34954156836462, 10.149508467241713, -15.39952196680521, 2.256897202574052, -29.68171090767418, -16.501978016258263, 16.514236097711716, -49.079200480632295, -38.091969798937, -41.054080624054095, 2.3486462706833944, -22.90992050806951, -23.331829485134122, -13.214355095578444, 38.03522570610742, 4.400609688712656, 9.001552262947435, 39.265345436337455, 15.85078547140117, 33.35239693434589, -26.667584414909484, 17.1347217014684, 38.35741625566284, 34.70970256990143, 32.48697594879258, -54.461592710669514, -42.32912080871293, 8.154714476032474, 39.10092856470544, -33.65178576313818, 29.0793759945942, -18.337374370510314, 33.22387215978718, 11.906465351182941, 19.92506330779021, 4.892808906250444, 38.822022230370635, 29.220611829459664, -13.951338235167327, 26.89333461090527, 20.162468770508074, -9.889590762615793, 28.69929342074977, 42.33554739541826, 34.92427209813696, -18.410566337380395, 39.839426760674826, 9.464210598881884, 8.930055828717418, 20.113588166371056, -27.355308541510006, -23.04481292740745, 16.159046420300413, -6.028505474076045, 19.2993182344723, 35.9355927731606, 16.18527640360661, -14.2040955589489, 19.626272806868947, 29.163051908909786, 48.0232861629035, 22.467537104028963, -29.905358218756348, 31.60693066337413, -51.15819533758447, 44.80505639145359, 14.712070154738946, 19.90731344971871, 14.241157018501248, 38.75211191983514, 27.981732123324026, -2.7100403809845286, 23.122393840878416, 33.672994818189196, 27.229539042675405, 3.7632754379127924, 8.996696192552744, -3.704472515276528, -3.30886009192902, 33.994440788006145, 8.706666558298167, 4.090192597604679, -5.9296703428979, -23.12235032630209, 9.037039068471536, -22.065471547530635, 25.214074535686272, 24.337312570526446, -21.596498964622445, -10.494019839929543, 47.4361245855458, 17.148708121253524, 15.947344675500506, 36.742546830672275, 37.65420193136256, 6.603397085324204, 25.90472422129013, 8.060597537789516, 19.94817661991696, 11.31015506702039, 15.770387027559337, 13.644735694768997, -8.712264656441612, 12.71024244529831, 17.793851839066157, 0.3722744047420008, -34.72268377936728, 7.5604207415148075, 23.30187471589589, 30.605179939924994, 44.70650296862284, 35.1819888361913, 7.375308729966656, 5.673317252333479, 27.7621941155425, 20.16621137409404, 19.865272280882753, 29.638698318923325, 2.6500235474086047, 17.968816700410848, -12.892877775447246, 24.283708171941548, -9.628308549293934, -13.296770832878416, 25.078927865549108, 19.133053582213833, 6.534379765406927, 25.32833451082064, 15.446415973884605, 12.283024901160044, 13.21771775417739, 20.20085592148672, 27.66370159587229, 12.02453479331403, 23.20446851578548, -51.68695500012707, -59.43264988532879, 33.4962731519976, 1.0589988975860294, 23.64783928277004, 22.647421391158566, -36.487785671088204, -33.111128678353836, -54.10082821332126, -42.525811000634995, -60.50432445459778, -37.62942058824228, -50.039637279024525, -62.771780636471696, 17.99463173440472, 9.369340928554825, 29.902679101410882, 11.349132179389821, -56.869245505293804, -48.89371990920957, -58.77687381899243, -51.709493514178476, 14.88805915043389, 17.098621741143866, 29.364909972560014, 7.329223374946416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4355341027665082, "mean_inference_ms": 1.1566884047077943, "mean_action_processing_ms": 0.1871270918456572, "mean_env_wait_ms": 0.07734213181752733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003355741500854492, "StateBufferConnector_ms": 0.002522110939025879, "ViewRequirementAgentConnector_ms": 0.06925654411315918}, "num_episodes": 12, "episode_return_max": 44.514339445217594, "episode_return_min": -56.40570895774816, "episode_return_mean": 1.32285398577387}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.1783569451714, "num_env_steps_trained_throughput_per_sec": 490.1783569451714, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 8232.382, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8232.349, "sample_time_ms": 810.711, "learn_time_ms": 7407.948, "learn_throughput": 539.961, "synch_weights_time_ms": 13.23}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "training_iteration": 109, "trial_id": "83a5c_00000", "date": "2024-08-10_12-29-35", "timestamp": 1723307375, "time_this_iter_s": 8.166758298873901, "time_total_s": 937.9692370891571, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faadf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 937.9692370891571, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 28.563636363636363, "ram_util_percent": 81.74545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.900716893666636, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.459368789006794, "policy_loss": -0.005672967344246529, "vf_loss": 5.464874702786642, "vf_explained_var": -0.06873815573712505, "kl": 0.007415409528443544, "entropy": 0.9382034133035669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8248606892923513, "cur_kl_coeff": 0.004751452803611755, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.477886998405059, "policy_loss": -0.0030672831586950147, "vf_loss": 4.480877377341191, "vf_explained_var": 0.4416221581399441, "kl": 0.016186946226753936, "entropy": 0.8028696719557047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 44.514339445217594, "episode_reward_min": -56.40570895774816, "episode_reward_mean": 2.5376746204939473, "episode_len_mean": 223.57, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 22357, "policy_reward_min": {"agent_policy": -44.51433944521759, "adversary_policy": -62.771780636471696}, "policy_reward_max": {"agent_policy": 56.40570895774815, "adversary_policy": 48.83978038633606}, "policy_reward_mean": {"agent_policy": -2.5376746204939487, "adversary_policy": 2.537674620493947}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.179234441980853, -2.4820162114414366, 2.2233852049086007, 44.514339445217594, -44.70353781606621, -2.6250067497817455, -13.712406852550064, 0.006129040726727375, -43.58558513978465, -19.35271717668534, -23.120874996601817, 12.410435305264485, 6.701080975830046, 27.558065453869315, 3.342406259718203, 27.746068978565635, 33.59833925934699, -48.39535675969122, 23.627821520368958, -2.286204884271992, 7.443248894638431, 15.91576432948658, 21.857415568310536, 7.634636797146169, 23.527901690706674, 9.404851329066988, 38.629909746777614, 10.714430211647228, 9.19713321379965, -3.6208601875694733, -3.4428832535535188, 6.635406380198127, 26.060434588383607, 2.711088623960025, 38.59316903590662, -3.718910557363701, -9.775632337105183, 29.75856327309629, 17.074235234109977, 33.36692202157957, 10.206176729946945, 30.451266930432304, 6.379985815232791, -3.5066663036027474, 21.350553673152156, -0.9197388726466105, -7.042655628915275, 1.5743014940778188, 1.3704068029520045, 18.471052372808124, 16.54802639837701, 37.19837438101741, 16.25406065330716, 14.00438707885324, 13.540271047289867, 2.466235519163692, 15.252047142182239, -17.175204687312664, 15.431147728705346, 37.655841454273926, 21.278648783078978, 16.717755683937995, 20.015741827488398, 16.144360933165967, 2.5379694624817986, 7.327699811323807, 5.891078516335346, 12.833716673810377, 20.387375242352615, 12.75037132766871, 23.93227875867951, 17.61450165454976, -55.559802442727936, 17.27763602479181, 23.147630336964315, -34.79945717472102, -48.31331960697813, -49.06687252142007, -56.40570895774816, 13.681986331479765, 20.625905640400354, -52.88148270725169, -55.24318366658544, 15.993340445788881, 18.347066673753222, -41.18213318719615, 32.436410786318596, 32.207415325000234, -52.01141138873243, 28.581186620382443, -49.85444184788636, -52.65798224061452, 0.8331831527096831, 22.739627785616428, 29.281241894199304, 23.068901978348613, -45.426754265003474, -47.04062270511802, -46.2443697156669, 16.04014805893995], "episode_lengths": [400, 45, 197, 130, 400, 85, 61, 50, 400, 400, 400, 98, 49, 124, 122, 94, 201, 400, 148, 400, 87, 54, 71, 129, 84, 91, 159, 400, 28, 66, 400, 48, 172, 112, 313, 400, 115, 366, 52, 89, 133, 117, 216, 400, 400, 7, 77, 53, 72, 140, 24, 379, 347, 338, 93, 21, 400, 400, 103, 365, 298, 400, 235, 57, 36, 64, 70, 31, 163, 400, 142, 83, 400, 400, 255, 400, 400, 400, 400, 249, 352, 400, 400, 128, 259, 400, 242, 318, 400, 384, 400, 400, 6, 118, 306, 101, 400, 400, 400, 135], "policy_agent_policy_reward": [20.179234441980835, 2.4820162114414366, -2.2233852049086007, -44.51433944521759, 44.70353781606623, 2.6250067497817504, 13.712406852550064, -0.006129040726726487, 43.585585139784655, 19.35271717668534, 23.120874996601817, -12.410435305264487, -6.7010809758300445, -27.558065453869304, -3.342406259718203, -27.746068978565624, -33.59833925934701, 48.39535675969121, -23.627821520368958, 2.2862048842719886, -7.443248894638431, -15.915764329486578, -21.857415568310532, -7.634636797146168, -23.52790169070667, -9.40485132906699, -38.629909746777614, -10.71443021164723, -9.197133213799653, 3.6208601875694706, 3.442883253553518, -6.635406380198127, -26.06043458838361, -2.7110886239600234, -38.593169035906655, 3.718910557363696, 9.775632337105165, -29.75856327309628, -17.074235234109974, -33.36692202157957, -10.206176729946945, -30.451266930432304, -6.379985815232786, 3.5066663036027457, -21.350553673152156, 0.9197388726466105, 7.042655628915272, -1.5743014940778188, -1.3704068029520027, -18.471052372808128, -16.548026398377015, -37.198374381017416, -16.254060653307167, -14.004387078853242, -13.540271047289867, -2.4662355191636927, -15.252047142182235, 17.175204687312654, -15.431147728705351, -37.65584145427393, -21.278648783078978, -16.717755683937995, -20.015741827488398, -16.14436093316597, -2.5379694624817986, -7.327699811323807, -5.891078516335346, -12.833716673810377, -20.38737524235262, -12.750371327668722, -23.932278758679505, -17.61450165454976, 55.55980244272793, -17.277636024791814, -23.14763033696431, 34.79945717472102, 48.31331960697811, 49.06687252142005, 56.40570895774815, -13.681986331479774, -20.62590564040035, 52.881482707251685, 55.24318366658543, -15.993340445788881, -18.347066673753215, 41.18213318719614, -32.43641078631858, -32.20741532500025, 52.01141138873245, -28.581186620382418, 49.85444184788637, 52.657982240614515, -0.8331831527096831, -22.739627785616413, -29.281241894199297, -23.06890197834861, 45.42675426500347, 47.040622705118025, 46.244369715666906, -16.04014805893995], "policy_adversary_policy_reward": [-37.56234775054245, -2.796121133419252, -19.15778230978714, 14.193749886904268, 31.007038866097783, -26.560268456280586, 42.96886756434402, 46.05981132609115, -40.0575340637678, -49.34954156836462, 10.149508467241713, -15.39952196680521, 2.256897202574052, -29.68171090767418, -16.501978016258263, 16.514236097711716, -49.079200480632295, -38.091969798937, -41.054080624054095, 2.3486462706833944, -22.90992050806951, -23.331829485134122, -13.214355095578444, 38.03522570610742, 4.400609688712656, 9.001552262947435, 39.265345436337455, 15.85078547140117, 33.35239693434589, -26.667584414909484, 17.1347217014684, 38.35741625566284, 34.70970256990143, 32.48697594879258, -54.461592710669514, -42.32912080871293, 8.154714476032474, 39.10092856470544, -33.65178576313818, 29.0793759945942, -18.337374370510314, 33.22387215978718, 11.906465351182941, 19.92506330779021, 4.892808906250444, 38.822022230370635, 29.220611829459664, -13.951338235167327, 26.89333461090527, 20.162468770508074, -9.889590762615793, 28.69929342074977, 42.33554739541826, 34.92427209813696, -18.410566337380395, 39.839426760674826, 9.464210598881884, 8.930055828717418, 20.113588166371056, -27.355308541510006, -23.04481292740745, 16.159046420300413, -6.028505474076045, 19.2993182344723, 35.9355927731606, 16.18527640360661, -14.2040955589489, 19.626272806868947, 29.163051908909786, 48.0232861629035, 22.467537104028963, -29.905358218756348, 31.60693066337413, -51.15819533758447, 44.80505639145359, 14.712070154738946, 19.90731344971871, 14.241157018501248, 38.75211191983514, 27.981732123324026, -2.7100403809845286, 23.122393840878416, 33.672994818189196, 27.229539042675405, 3.7632754379127924, 8.996696192552744, -3.704472515276528, -3.30886009192902, 33.994440788006145, 8.706666558298167, 4.090192597604679, -5.9296703428979, -23.12235032630209, 9.037039068471536, -22.065471547530635, 25.214074535686272, 24.337312570526446, -21.596498964622445, -10.494019839929543, 47.4361245855458, 17.148708121253524, 15.947344675500506, 36.742546830672275, 37.65420193136256, 6.603397085324204, 25.90472422129013, 8.060597537789516, 19.94817661991696, 11.31015506702039, 15.770387027559337, 13.644735694768997, -8.712264656441612, 12.71024244529831, 17.793851839066157, 0.3722744047420008, -34.72268377936728, 7.5604207415148075, 23.30187471589589, 30.605179939924994, 44.70650296862284, 35.1819888361913, 7.375308729966656, 5.673317252333479, 27.7621941155425, 20.16621137409404, 19.865272280882753, 29.638698318923325, 2.6500235474086047, 17.968816700410848, -12.892877775447246, 24.283708171941548, -9.628308549293934, -13.296770832878416, 25.078927865549108, 19.133053582213833, 6.534379765406927, 25.32833451082064, 15.446415973884605, 12.283024901160044, 13.21771775417739, 20.20085592148672, 27.66370159587229, 12.02453479331403, 23.20446851578548, -51.68695500012707, -59.43264988532879, 33.4962731519976, 1.0589988975860294, 23.64783928277004, 22.647421391158566, -36.487785671088204, -33.111128678353836, -54.10082821332126, -42.525811000634995, -60.50432445459778, -37.62942058824228, -50.039637279024525, -62.771780636471696, 17.99463173440472, 9.369340928554825, 29.902679101410882, 11.349132179389821, -56.869245505293804, -48.89371990920957, -58.77687381899243, -51.709493514178476, 14.88805915043389, 17.098621741143866, 29.364909972560014, 7.329223374946416, -55.84065345304633, -26.523612921345936, 48.83978038633606, 16.033041186301112, 48.23337607103252, 16.181454578968, -43.44329072811844, -60.5795320493464, 25.946071056747364, 31.21630218401748, -58.18312680994167, -41.52575688583103, -54.18441083550683, -51.131553645722214, -6.280393052808001, 7.946759358227366, 14.238369296913174, 31.240886274319653, 22.221058083065202, 36.34142570533341, 19.682672921803714, 26.455131034893505, -29.93821362951526, -60.915294900491716, -37.049766719815274, -57.03147869042078, -45.06386997831534, -47.42486945301851, 3.836388446297697, 28.2439076715822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.435231591402304, "mean_inference_ms": 1.1559576708975765, "mean_action_processing_ms": 0.18706233280444937, "mean_env_wait_ms": 0.07728577270451031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034183263778686523, "StateBufferConnector_ms": 0.002573370933532715, "ViewRequirementAgentConnector_ms": 0.07037055492401123}, "num_episodes": 15, "episode_return_max": 44.514339445217594, "episode_return_min": -56.40570895774816, "episode_return_mean": 2.5376746204939473}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.0945210293641, "num_env_steps_trained_throughput_per_sec": 500.0945210293641, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 8231.812, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8231.778, "sample_time_ms": 814.941, "learn_time_ms": 7403.106, "learn_throughput": 540.314, "synch_weights_time_ms": 13.245}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 110, "trial_id": "83a5c_00000", "date": "2024-08-10_12-29-43", "timestamp": 1723307383, "time_this_iter_s": 8.003494024276733, "time_total_s": 945.9727311134338, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 945.9727311134338, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 24.66666666666666, "ram_util_percent": 81.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.431019663621509, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.58162213544997, "policy_loss": -0.003615703491405362, "vf_loss": 4.585100232482588, "vf_explained_var": 0.024088271080501496, "kl": 0.00610917358378826, "entropy": 0.877532021929978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.125789505864183, "cur_kl_coeff": 0.004751452803611755, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3074105535944303, "policy_loss": -0.013807795890897978, "vf_loss": 3.3211391220490136, "vf_explained_var": 0.7517738106970986, "kl": 0.0166753512157315, "entropy": 0.6963075416783492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "env_runners": {"episode_reward_max": 38.629909746777614, "episode_reward_min": -56.40570895774816, "episode_reward_mean": 2.9354286106479193, "episode_len_mean": 230.95, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 23095, "policy_reward_min": {"agent_policy": -38.629909746777614, "adversary_policy": -63.19852021860618}, "policy_reward_max": {"agent_policy": 56.40570895774815, "adversary_policy": 49.7218317790514}, "policy_reward_mean": {"agent_policy": -2.9354286106479206, "adversary_policy": 2.9354286106479193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.342406259718203, 27.746068978565635, 33.59833925934699, -48.39535675969122, 23.627821520368958, -2.286204884271992, 7.443248894638431, 15.91576432948658, 21.857415568310536, 7.634636797146169, 23.527901690706674, 9.404851329066988, 38.629909746777614, 10.714430211647228, 9.19713321379965, -3.6208601875694733, -3.4428832535535188, 6.635406380198127, 26.060434588383607, 2.711088623960025, 38.59316903590662, -3.718910557363701, -9.775632337105183, 29.75856327309629, 17.074235234109977, 33.36692202157957, 10.206176729946945, 30.451266930432304, 6.379985815232791, -3.5066663036027474, 21.350553673152156, -0.9197388726466105, -7.042655628915275, 1.5743014940778188, 1.3704068029520045, 18.471052372808124, 16.54802639837701, 37.19837438101741, 16.25406065330716, 14.00438707885324, 13.540271047289867, 2.466235519163692, 15.252047142182239, -17.175204687312664, 15.431147728705346, 37.655841454273926, 21.278648783078978, 16.717755683937995, 20.015741827488398, 16.144360933165967, 2.5379694624817986, 7.327699811323807, 5.891078516335346, 12.833716673810377, 20.387375242352615, 12.75037132766871, 23.93227875867951, 17.61450165454976, -55.559802442727936, 17.27763602479181, 23.147630336964315, -34.79945717472102, -48.31331960697813, -49.06687252142007, -56.40570895774816, 13.681986331479765, 20.625905640400354, -52.88148270725169, -55.24318366658544, 15.993340445788881, 18.347066673753222, -41.18213318719615, 32.436410786318596, 32.207415325000234, -52.01141138873243, 28.581186620382443, -49.85444184788636, -52.65798224061452, 0.8331831527096831, 22.739627785616428, 29.281241894199304, 23.068901978348613, -45.426754265003474, -47.04062270511802, -46.2443697156669, 16.04014805893995, 30.9475009242623, 19.203485802122366, 31.997452270396906, 9.027966107368602, -44.888088467003136, 11.89081565341989, 5.7371589723769585, -19.906716735468663, -50.84430259891567, -49.688181257975764, 18.267733994986436, 27.029346699630413, -48.91392429879908, 23.567207989920316], "episode_lengths": [122, 94, 201, 400, 148, 400, 87, 54, 71, 129, 84, 91, 159, 400, 28, 66, 400, 48, 172, 112, 313, 400, 115, 366, 52, 89, 133, 117, 216, 400, 400, 7, 77, 53, 72, 140, 24, 379, 347, 338, 93, 21, 400, 400, 103, 365, 298, 400, 235, 57, 36, 64, 70, 31, 163, 400, 142, 83, 400, 400, 255, 400, 400, 400, 400, 249, 352, 400, 400, 128, 259, 400, 242, 318, 400, 384, 400, 400, 6, 118, 306, 101, 400, 400, 400, 135, 357, 112, 329, 16, 400, 82, 54, 400, 400, 400, 85, 292, 400, 250], "policy_agent_policy_reward": [-3.342406259718203, -27.746068978565624, -33.59833925934701, 48.39535675969121, -23.627821520368958, 2.2862048842719886, -7.443248894638431, -15.915764329486578, -21.857415568310532, -7.634636797146168, -23.52790169070667, -9.40485132906699, -38.629909746777614, -10.71443021164723, -9.197133213799653, 3.6208601875694706, 3.442883253553518, -6.635406380198127, -26.06043458838361, -2.7110886239600234, -38.593169035906655, 3.718910557363696, 9.775632337105165, -29.75856327309628, -17.074235234109974, -33.36692202157957, -10.206176729946945, -30.451266930432304, -6.379985815232786, 3.5066663036027457, -21.350553673152156, 0.9197388726466105, 7.042655628915272, -1.5743014940778188, -1.3704068029520027, -18.471052372808128, -16.548026398377015, -37.198374381017416, -16.254060653307167, -14.004387078853242, -13.540271047289867, -2.4662355191636927, -15.252047142182235, 17.175204687312654, -15.431147728705351, -37.65584145427393, -21.278648783078978, -16.717755683937995, -20.015741827488398, -16.14436093316597, -2.5379694624817986, -7.327699811323807, -5.891078516335346, -12.833716673810377, -20.38737524235262, -12.750371327668722, -23.932278758679505, -17.61450165454976, 55.55980244272793, -17.277636024791814, -23.14763033696431, 34.79945717472102, 48.31331960697811, 49.06687252142005, 56.40570895774815, -13.681986331479774, -20.62590564040035, 52.881482707251685, 55.24318366658543, -15.993340445788881, -18.347066673753215, 41.18213318719614, -32.43641078631858, -32.20741532500025, 52.01141138873245, -28.581186620382418, 49.85444184788637, 52.657982240614515, -0.8331831527096831, -22.739627785616413, -29.281241894199297, -23.06890197834861, 45.42675426500347, 47.040622705118025, 46.244369715666906, -16.04014805893995, -30.947500924262307, -19.20348580212237, -31.997452270396916, -9.027966107368602, 44.88808846700314, -11.890815653419885, -5.7371589723769585, 19.906716735468663, 50.844302598915675, 49.68818125797577, -18.26773399498643, -27.029346699630402, 48.913924298799074, -23.567207989920323], "policy_adversary_policy_reward": [33.35239693434589, -26.667584414909484, 17.1347217014684, 38.35741625566284, 34.70970256990143, 32.48697594879258, -54.461592710669514, -42.32912080871293, 8.154714476032474, 39.10092856470544, -33.65178576313818, 29.0793759945942, -18.337374370510314, 33.22387215978718, 11.906465351182941, 19.92506330779021, 4.892808906250444, 38.822022230370635, 29.220611829459664, -13.951338235167327, 26.89333461090527, 20.162468770508074, -9.889590762615793, 28.69929342074977, 42.33554739541826, 34.92427209813696, -18.410566337380395, 39.839426760674826, 9.464210598881884, 8.930055828717418, 20.113588166371056, -27.355308541510006, -23.04481292740745, 16.159046420300413, -6.028505474076045, 19.2993182344723, 35.9355927731606, 16.18527640360661, -14.2040955589489, 19.626272806868947, 29.163051908909786, 48.0232861629035, 22.467537104028963, -29.905358218756348, 31.60693066337413, -51.15819533758447, 44.80505639145359, 14.712070154738946, 19.90731344971871, 14.241157018501248, 38.75211191983514, 27.981732123324026, -2.7100403809845286, 23.122393840878416, 33.672994818189196, 27.229539042675405, 3.7632754379127924, 8.996696192552744, -3.704472515276528, -3.30886009192902, 33.994440788006145, 8.706666558298167, 4.090192597604679, -5.9296703428979, -23.12235032630209, 9.037039068471536, -22.065471547530635, 25.214074535686272, 24.337312570526446, -21.596498964622445, -10.494019839929543, 47.4361245855458, 17.148708121253524, 15.947344675500506, 36.742546830672275, 37.65420193136256, 6.603397085324204, 25.90472422129013, 8.060597537789516, 19.94817661991696, 11.31015506702039, 15.770387027559337, 13.644735694768997, -8.712264656441612, 12.71024244529831, 17.793851839066157, 0.3722744047420008, -34.72268377936728, 7.5604207415148075, 23.30187471589589, 30.605179939924994, 44.70650296862284, 35.1819888361913, 7.375308729966656, 5.673317252333479, 27.7621941155425, 20.16621137409404, 19.865272280882753, 29.638698318923325, 2.6500235474086047, 17.968816700410848, -12.892877775447246, 24.283708171941548, -9.628308549293934, -13.296770832878416, 25.078927865549108, 19.133053582213833, 6.534379765406927, 25.32833451082064, 15.446415973884605, 12.283024901160044, 13.21771775417739, 20.20085592148672, 27.66370159587229, 12.02453479331403, 23.20446851578548, -51.68695500012707, -59.43264988532879, 33.4962731519976, 1.0589988975860294, 23.64783928277004, 22.647421391158566, -36.487785671088204, -33.111128678353836, -54.10082821332126, -42.525811000634995, -60.50432445459778, -37.62942058824228, -50.039637279024525, -62.771780636471696, 17.99463173440472, 9.369340928554825, 29.902679101410882, 11.349132179389821, -56.869245505293804, -48.89371990920957, -58.77687381899243, -51.709493514178476, 14.88805915043389, 17.098621741143866, 29.364909972560014, 7.329223374946416, -55.84065345304633, -26.523612921345936, 48.83978038633606, 16.033041186301112, 48.23337607103252, 16.181454578968, -43.44329072811844, -60.5795320493464, 25.946071056747364, 31.21630218401748, -58.18312680994167, -41.52575688583103, -54.18441083550683, -51.131553645722214, -6.280393052808001, 7.946759358227366, 14.238369296913174, 31.240886274319653, 22.221058083065202, 36.34142570533341, 19.682672921803714, 26.455131034893505, -29.93821362951526, -60.915294900491716, -37.049766719815274, -57.03147869042078, -45.06386997831534, -47.42486945301851, 3.836388446297697, 28.2439076715822, 23.47191519092231, 38.423086657602326, 8.933350723676444, 29.473620880568298, 49.7218317790514, 14.273072761742435, 5.213436717740029, 12.842495496997179, -61.609456888110046, -28.166720045896312, 6.448979293081873, 17.332652013757894, 0.4644073165790985, 11.009910628174818, -30.196912144758493, -9.616521326178844, -49.54978456370789, -52.138820634123455, -36.17784229734542, -63.19852021860618, 20.904623623275903, 15.630844366696959, 24.20190605265512, 29.856787346605692, -58.280990298074585, -39.54685829952358, 32.17868936227572, 14.955726617564952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43507721764690965, "mean_inference_ms": 1.154385238601755, "mean_action_processing_ms": 0.18686688337980273, "mean_env_wait_ms": 0.07709695625835095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00342404842376709, "StateBufferConnector_ms": 0.0025353431701660156, "ViewRequirementAgentConnector_ms": 0.06865561008453369}, "num_episodes": 14, "episode_return_max": 38.629909746777614, "episode_return_min": -56.40570895774816, "episode_return_mean": 2.9354286106479193}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.7484647295792, "num_env_steps_trained_throughput_per_sec": 502.7484647295792, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 8154.172, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8154.139, "sample_time_ms": 777.069, "learn_time_ms": 7363.674, "learn_throughput": 543.207, "synch_weights_time_ms": 12.914}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "training_iteration": 111, "trial_id": "83a5c_00000", "date": "2024-08-10_12-29-51", "timestamp": 1723307391, "time_this_iter_s": 7.960621118545532, "time_total_s": 953.9333522319794, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 953.9333522319794, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 26.20909090909091, "ram_util_percent": 82.02727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7040579303862557, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.965418663226738, "policy_loss": -0.005261572662041222, "vf_loss": 3.970497578414029, "vf_explained_var": -0.09026043134391623, "kl": 0.008109166359313892, "entropy": 0.9629378748003137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.29371878542006, "cur_kl_coeff": 0.004751452803611755, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7129665950934094, "policy_loss": -0.005016864791105036, "vf_loss": 3.717940239608288, "vf_explained_var": 0.779426808655262, "kl": 0.00909516534579969, "entropy": 0.6160026169692476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 40.5991641203243, "episode_reward_min": -57.91929289960149, "episode_reward_mean": -1.4899924491324377, "episode_len_mean": 245.18, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 24518, "policy_reward_min": {"agent_policy": -40.59916412032431, "adversary_policy": -65.70315290391832}, "policy_reward_max": {"agent_policy": 57.919292899601494, "adversary_policy": 49.7218317790514}, "policy_reward_mean": {"agent_policy": 1.4899924491324363, "adversary_policy": -1.4899924491324383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.19713321379965, -3.6208601875694733, -3.4428832535535188, 6.635406380198127, 26.060434588383607, 2.711088623960025, 38.59316903590662, -3.718910557363701, -9.775632337105183, 29.75856327309629, 17.074235234109977, 33.36692202157957, 10.206176729946945, 30.451266930432304, 6.379985815232791, -3.5066663036027474, 21.350553673152156, -0.9197388726466105, -7.042655628915275, 1.5743014940778188, 1.3704068029520045, 18.471052372808124, 16.54802639837701, 37.19837438101741, 16.25406065330716, 14.00438707885324, 13.540271047289867, 2.466235519163692, 15.252047142182239, -17.175204687312664, 15.431147728705346, 37.655841454273926, 21.278648783078978, 16.717755683937995, 20.015741827488398, 16.144360933165967, 2.5379694624817986, 7.327699811323807, 5.891078516335346, 12.833716673810377, 20.387375242352615, 12.75037132766871, 23.93227875867951, 17.61450165454976, -55.559802442727936, 17.27763602479181, 23.147630336964315, -34.79945717472102, -48.31331960697813, -49.06687252142007, -56.40570895774816, 13.681986331479765, 20.625905640400354, -52.88148270725169, -55.24318366658544, 15.993340445788881, 18.347066673753222, -41.18213318719615, 32.436410786318596, 32.207415325000234, -52.01141138873243, 28.581186620382443, -49.85444184788636, -52.65798224061452, 0.8331831527096831, 22.739627785616428, 29.281241894199304, 23.068901978348613, -45.426754265003474, -47.04062270511802, -46.2443697156669, 16.04014805893995, 30.9475009242623, 19.203485802122366, 31.997452270396906, 9.027966107368602, -44.888088467003136, 11.89081565341989, 5.7371589723769585, -19.906716735468663, -50.84430259891567, -49.688181257975764, 18.267733994986436, 27.029346699630413, -48.91392429879908, 23.567207989920316, -44.18642088231346, -44.8787371137318, -44.37671366146802, 18.520364999712108, -29.528604537362583, 1.7786840531463928, 19.24133431669123, -51.45689300108304, -53.75374696332008, 19.70647751061769, 6.592692405602623, 40.5991641203243, -57.91929289960149, -50.119181383432746], "episode_lengths": [28, 66, 400, 48, 172, 112, 313, 400, 115, 366, 52, 89, 133, 117, 216, 400, 400, 7, 77, 53, 72, 140, 24, 379, 347, 338, 93, 21, 400, 400, 103, 365, 298, 400, 235, 57, 36, 64, 70, 31, 163, 400, 142, 83, 400, 400, 255, 400, 400, 400, 400, 249, 352, 400, 400, 128, 259, 400, 242, 318, 400, 384, 400, 400, 6, 118, 306, 101, 400, 400, 400, 135, 357, 112, 329, 16, 400, 82, 54, 400, 400, 400, 85, 292, 400, 250, 400, 400, 400, 128, 400, 17, 162, 400, 400, 62, 18, 276, 400, 400], "policy_agent_policy_reward": [-9.197133213799653, 3.6208601875694706, 3.442883253553518, -6.635406380198127, -26.06043458838361, -2.7110886239600234, -38.593169035906655, 3.718910557363696, 9.775632337105165, -29.75856327309628, -17.074235234109974, -33.36692202157957, -10.206176729946945, -30.451266930432304, -6.379985815232786, 3.5066663036027457, -21.350553673152156, 0.9197388726466105, 7.042655628915272, -1.5743014940778188, -1.3704068029520027, -18.471052372808128, -16.548026398377015, -37.198374381017416, -16.254060653307167, -14.004387078853242, -13.540271047289867, -2.4662355191636927, -15.252047142182235, 17.175204687312654, -15.431147728705351, -37.65584145427393, -21.278648783078978, -16.717755683937995, -20.015741827488398, -16.14436093316597, -2.5379694624817986, -7.327699811323807, -5.891078516335346, -12.833716673810377, -20.38737524235262, -12.750371327668722, -23.932278758679505, -17.61450165454976, 55.55980244272793, -17.277636024791814, -23.14763033696431, 34.79945717472102, 48.31331960697811, 49.06687252142005, 56.40570895774815, -13.681986331479774, -20.62590564040035, 52.881482707251685, 55.24318366658543, -15.993340445788881, -18.347066673753215, 41.18213318719614, -32.43641078631858, -32.20741532500025, 52.01141138873245, -28.581186620382418, 49.85444184788637, 52.657982240614515, -0.8331831527096831, -22.739627785616413, -29.281241894199297, -23.06890197834861, 45.42675426500347, 47.040622705118025, 46.244369715666906, -16.04014805893995, -30.947500924262307, -19.20348580212237, -31.997452270396916, -9.027966107368602, 44.88808846700314, -11.890815653419885, -5.7371589723769585, 19.906716735468663, 50.844302598915675, 49.68818125797577, -18.26773399498643, -27.029346699630402, 48.913924298799074, -23.567207989920323, 44.18642088231347, 44.87873711373181, 44.37671366146804, -18.52036499971211, 29.528604537362583, -1.7786840531463923, -19.241334316691233, 51.45689300108303, 53.75374696332009, -19.706477510617688, -6.592692405602625, -40.59916412032431, 57.919292899601494, 50.11918138343274], "policy_adversary_policy_reward": [9.464210598881884, 8.930055828717418, 20.113588166371056, -27.355308541510006, -23.04481292740745, 16.159046420300413, -6.028505474076045, 19.2993182344723, 35.9355927731606, 16.18527640360661, -14.2040955589489, 19.626272806868947, 29.163051908909786, 48.0232861629035, 22.467537104028963, -29.905358218756348, 31.60693066337413, -51.15819533758447, 44.80505639145359, 14.712070154738946, 19.90731344971871, 14.241157018501248, 38.75211191983514, 27.981732123324026, -2.7100403809845286, 23.122393840878416, 33.672994818189196, 27.229539042675405, 3.7632754379127924, 8.996696192552744, -3.704472515276528, -3.30886009192902, 33.994440788006145, 8.706666558298167, 4.090192597604679, -5.9296703428979, -23.12235032630209, 9.037039068471536, -22.065471547530635, 25.214074535686272, 24.337312570526446, -21.596498964622445, -10.494019839929543, 47.4361245855458, 17.148708121253524, 15.947344675500506, 36.742546830672275, 37.65420193136256, 6.603397085324204, 25.90472422129013, 8.060597537789516, 19.94817661991696, 11.31015506702039, 15.770387027559337, 13.644735694768997, -8.712264656441612, 12.71024244529831, 17.793851839066157, 0.3722744047420008, -34.72268377936728, 7.5604207415148075, 23.30187471589589, 30.605179939924994, 44.70650296862284, 35.1819888361913, 7.375308729966656, 5.673317252333479, 27.7621941155425, 20.16621137409404, 19.865272280882753, 29.638698318923325, 2.6500235474086047, 17.968816700410848, -12.892877775447246, 24.283708171941548, -9.628308549293934, -13.296770832878416, 25.078927865549108, 19.133053582213833, 6.534379765406927, 25.32833451082064, 15.446415973884605, 12.283024901160044, 13.21771775417739, 20.20085592148672, 27.66370159587229, 12.02453479331403, 23.20446851578548, -51.68695500012707, -59.43264988532879, 33.4962731519976, 1.0589988975860294, 23.64783928277004, 22.647421391158566, -36.487785671088204, -33.111128678353836, -54.10082821332126, -42.525811000634995, -60.50432445459778, -37.62942058824228, -50.039637279024525, -62.771780636471696, 17.99463173440472, 9.369340928554825, 29.902679101410882, 11.349132179389821, -56.869245505293804, -48.89371990920957, -58.77687381899243, -51.709493514178476, 14.88805915043389, 17.098621741143866, 29.364909972560014, 7.329223374946416, -55.84065345304633, -26.523612921345936, 48.83978038633606, 16.033041186301112, 48.23337607103252, 16.181454578968, -43.44329072811844, -60.5795320493464, 25.946071056747364, 31.21630218401748, -58.18312680994167, -41.52575688583103, -54.18441083550683, -51.131553645722214, -6.280393052808001, 7.946759358227366, 14.238369296913174, 31.240886274319653, 22.221058083065202, 36.34142570533341, 19.682672921803714, 26.455131034893505, -29.93821362951526, -60.915294900491716, -37.049766719815274, -57.03147869042078, -45.06386997831534, -47.42486945301851, 3.836388446297697, 28.2439076715822, 23.47191519092231, 38.423086657602326, 8.933350723676444, 29.473620880568298, 49.7218317790514, 14.273072761742435, 5.213436717740029, 12.842495496997179, -61.609456888110046, -28.166720045896312, 6.448979293081873, 17.332652013757894, 0.4644073165790985, 11.009910628174818, -30.196912144758493, -9.616521326178844, -49.54978456370789, -52.138820634123455, -36.17784229734542, -63.19852021860618, 20.904623623275903, 15.630844366696959, 24.20190605265512, 29.856787346605692, -58.280990298074585, -39.54685829952358, 32.17868936227572, 14.955726617564952, -22.669688860708533, -65.70315290391832, -55.99804615479494, -33.75942807266869, -38.92458776131578, -49.82883956162024, 9.621153855410915, 27.419576144013313, -33.56294351416849, -25.494265560556677, -19.627099100217396, 23.18446720651018, 8.188291578483756, 30.294377054898717, -49.9095610217864, -53.004224980379654, -51.03783055390479, -56.46966337273537, 10.192259912395699, 29.220695108839685, 11.762991502047235, 1.4223933091580143, 43.056627498723174, 38.14170074192545, -57.0094393142256, -58.829146484977436, -39.02707947627267, -61.21128329059288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4347759785775114, "mean_inference_ms": 1.15246417749748, "mean_action_processing_ms": 0.18667719081382203, "mean_env_wait_ms": 0.07694765472255687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003396749496459961, "StateBufferConnector_ms": 0.0025110244750976562, "ViewRequirementAgentConnector_ms": 0.06841146945953369}, "num_episodes": 14, "episode_return_max": 40.5991641203243, "episode_return_min": -57.91929289960149, "episode_return_mean": -1.4899924491324377}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.10429419096164, "num_env_steps_trained_throughput_per_sec": 504.10429419096164, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 8141.36, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8141.327, "sample_time_ms": 773.346, "learn_time_ms": 7354.566, "learn_throughput": 543.88, "synch_weights_time_ms": 12.925}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 112, "trial_id": "83a5c_00000", "date": "2024-08-10_12-29-59", "timestamp": 1723307399, "time_this_iter_s": 7.940147876739502, "time_total_s": 961.8735001087189, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb63d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 961.8735001087189, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 27.490909090909096, "ram_util_percent": 82.22727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9826464508891735, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.813562224277113, "policy_loss": -0.005853505030757299, "vf_loss": 3.819208638630216, "vf_explained_var": 0.010882337415029131, "kl": 0.00919344579792422, "entropy": 0.969147643178859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6609822248419124, "cur_kl_coeff": 0.004751452803611755, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1305043262739978, "policy_loss": -0.00759455343989733, "vf_loss": 3.138040213038524, "vf_explained_var": 0.712139462120831, "kl": 0.0123493359305055, "entropy": 0.5426059387934704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "env_runners": {"episode_reward_max": 40.5991641203243, "episode_reward_min": -57.91929289960149, "episode_reward_mean": -6.2964283755490165, "episode_len_mean": 266.77, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 26677, "policy_reward_min": {"agent_policy": -40.59916412032431, "adversary_policy": -66.09546257113921}, "policy_reward_max": {"agent_policy": 57.919292899601494, "adversary_policy": 49.7218317790514}, "policy_reward_mean": {"agent_policy": 6.296428375549019, "adversary_policy": -6.2964283755490165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.36692202157957, 10.206176729946945, 30.451266930432304, 6.379985815232791, -3.5066663036027474, 21.350553673152156, -0.9197388726466105, -7.042655628915275, 1.5743014940778188, 1.3704068029520045, 18.471052372808124, 16.54802639837701, 37.19837438101741, 16.25406065330716, 14.00438707885324, 13.540271047289867, 2.466235519163692, 15.252047142182239, -17.175204687312664, 15.431147728705346, 37.655841454273926, 21.278648783078978, 16.717755683937995, 20.015741827488398, 16.144360933165967, 2.5379694624817986, 7.327699811323807, 5.891078516335346, 12.833716673810377, 20.387375242352615, 12.75037132766871, 23.93227875867951, 17.61450165454976, -55.559802442727936, 17.27763602479181, 23.147630336964315, -34.79945717472102, -48.31331960697813, -49.06687252142007, -56.40570895774816, 13.681986331479765, 20.625905640400354, -52.88148270725169, -55.24318366658544, 15.993340445788881, 18.347066673753222, -41.18213318719615, 32.436410786318596, 32.207415325000234, -52.01141138873243, 28.581186620382443, -49.85444184788636, -52.65798224061452, 0.8331831527096831, 22.739627785616428, 29.281241894199304, 23.068901978348613, -45.426754265003474, -47.04062270511802, -46.2443697156669, 16.04014805893995, 30.9475009242623, 19.203485802122366, 31.997452270396906, 9.027966107368602, -44.888088467003136, 11.89081565341989, 5.7371589723769585, -19.906716735468663, -50.84430259891567, -49.688181257975764, 18.267733994986436, 27.029346699630413, -48.91392429879908, 23.567207989920316, -44.18642088231346, -44.8787371137318, -44.37671366146802, 18.520364999712108, -29.528604537362583, 1.7786840531463928, 19.24133431669123, -51.45689300108304, -53.75374696332008, 19.70647751061769, 6.592692405602623, 40.5991641203243, -57.91929289960149, -50.119181383432746, -47.25836815625156, -29.810657850702746, -44.27923067788415, -34.76809981729916, -49.08953345620874, -36.71034642746236, -27.579552813104588, -54.0994612016843, -47.77567219900373, 22.54476779225903, -22.345693820453217], "episode_lengths": [89, 133, 117, 216, 400, 400, 7, 77, 53, 72, 140, 24, 379, 347, 338, 93, 21, 400, 400, 103, 365, 298, 400, 235, 57, 36, 64, 70, 31, 163, 400, 142, 83, 400, 400, 255, 400, 400, 400, 400, 249, 352, 400, 400, 128, 259, 400, 242, 318, 400, 384, 400, 400, 6, 118, 306, 101, 400, 400, 400, 135, 357, 112, 329, 16, 400, 82, 54, 400, 400, 400, 85, 292, 400, 250, 400, 400, 400, 128, 400, 17, 162, 400, 400, 62, 18, 276, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 231, 400], "policy_agent_policy_reward": [-33.36692202157957, -10.206176729946945, -30.451266930432304, -6.379985815232786, 3.5066663036027457, -21.350553673152156, 0.9197388726466105, 7.042655628915272, -1.5743014940778188, -1.3704068029520027, -18.471052372808128, -16.548026398377015, -37.198374381017416, -16.254060653307167, -14.004387078853242, -13.540271047289867, -2.4662355191636927, -15.252047142182235, 17.175204687312654, -15.431147728705351, -37.65584145427393, -21.278648783078978, -16.717755683937995, -20.015741827488398, -16.14436093316597, -2.5379694624817986, -7.327699811323807, -5.891078516335346, -12.833716673810377, -20.38737524235262, -12.750371327668722, -23.932278758679505, -17.61450165454976, 55.55980244272793, -17.277636024791814, -23.14763033696431, 34.79945717472102, 48.31331960697811, 49.06687252142005, 56.40570895774815, -13.681986331479774, -20.62590564040035, 52.881482707251685, 55.24318366658543, -15.993340445788881, -18.347066673753215, 41.18213318719614, -32.43641078631858, -32.20741532500025, 52.01141138873245, -28.581186620382418, 49.85444184788637, 52.657982240614515, -0.8331831527096831, -22.739627785616413, -29.281241894199297, -23.06890197834861, 45.42675426500347, 47.040622705118025, 46.244369715666906, -16.04014805893995, -30.947500924262307, -19.20348580212237, -31.997452270396916, -9.027966107368602, 44.88808846700314, -11.890815653419885, -5.7371589723769585, 19.906716735468663, 50.844302598915675, 49.68818125797577, -18.26773399498643, -27.029346699630402, 48.913924298799074, -23.567207989920323, 44.18642088231347, 44.87873711373181, 44.37671366146804, -18.52036499971211, 29.528604537362583, -1.7786840531463923, -19.241334316691233, 51.45689300108303, 53.75374696332009, -19.706477510617688, -6.592692405602625, -40.59916412032431, 57.919292899601494, 50.11918138343274, 47.25836815625155, 29.81065785070275, 44.27923067788416, 34.76809981729916, 49.089533456208734, 36.71034642746237, 27.579552813104595, 54.09946120168428, 47.775672199003736, -22.544767792259027, 22.345693820453217], "policy_adversary_policy_reward": [38.75211191983514, 27.981732123324026, -2.7100403809845286, 23.122393840878416, 33.672994818189196, 27.229539042675405, 3.7632754379127924, 8.996696192552744, -3.704472515276528, -3.30886009192902, 33.994440788006145, 8.706666558298167, 4.090192597604679, -5.9296703428979, -23.12235032630209, 9.037039068471536, -22.065471547530635, 25.214074535686272, 24.337312570526446, -21.596498964622445, -10.494019839929543, 47.4361245855458, 17.148708121253524, 15.947344675500506, 36.742546830672275, 37.65420193136256, 6.603397085324204, 25.90472422129013, 8.060597537789516, 19.94817661991696, 11.31015506702039, 15.770387027559337, 13.644735694768997, -8.712264656441612, 12.71024244529831, 17.793851839066157, 0.3722744047420008, -34.72268377936728, 7.5604207415148075, 23.30187471589589, 30.605179939924994, 44.70650296862284, 35.1819888361913, 7.375308729966656, 5.673317252333479, 27.7621941155425, 20.16621137409404, 19.865272280882753, 29.638698318923325, 2.6500235474086047, 17.968816700410848, -12.892877775447246, 24.283708171941548, -9.628308549293934, -13.296770832878416, 25.078927865549108, 19.133053582213833, 6.534379765406927, 25.32833451082064, 15.446415973884605, 12.283024901160044, 13.21771775417739, 20.20085592148672, 27.66370159587229, 12.02453479331403, 23.20446851578548, -51.68695500012707, -59.43264988532879, 33.4962731519976, 1.0589988975860294, 23.64783928277004, 22.647421391158566, -36.487785671088204, -33.111128678353836, -54.10082821332126, -42.525811000634995, -60.50432445459778, -37.62942058824228, -50.039637279024525, -62.771780636471696, 17.99463173440472, 9.369340928554825, 29.902679101410882, 11.349132179389821, -56.869245505293804, -48.89371990920957, -58.77687381899243, -51.709493514178476, 14.88805915043389, 17.098621741143866, 29.364909972560014, 7.329223374946416, -55.84065345304633, -26.523612921345936, 48.83978038633606, 16.033041186301112, 48.23337607103252, 16.181454578968, -43.44329072811844, -60.5795320493464, 25.946071056747364, 31.21630218401748, -58.18312680994167, -41.52575688583103, -54.18441083550683, -51.131553645722214, -6.280393052808001, 7.946759358227366, 14.238369296913174, 31.240886274319653, 22.221058083065202, 36.34142570533341, 19.682672921803714, 26.455131034893505, -29.93821362951526, -60.915294900491716, -37.049766719815274, -57.03147869042078, -45.06386997831534, -47.42486945301851, 3.836388446297697, 28.2439076715822, 23.47191519092231, 38.423086657602326, 8.933350723676444, 29.473620880568298, 49.7218317790514, 14.273072761742435, 5.213436717740029, 12.842495496997179, -61.609456888110046, -28.166720045896312, 6.448979293081873, 17.332652013757894, 0.4644073165790985, 11.009910628174818, -30.196912144758493, -9.616521326178844, -49.54978456370789, -52.138820634123455, -36.17784229734542, -63.19852021860618, 20.904623623275903, 15.630844366696959, 24.20190605265512, 29.856787346605692, -58.280990298074585, -39.54685829952358, 32.17868936227572, 14.955726617564952, -22.669688860708533, -65.70315290391832, -55.99804615479494, -33.75942807266869, -38.92458776131578, -49.82883956162024, 9.621153855410915, 27.419576144013313, -33.56294351416849, -25.494265560556677, -19.627099100217396, 23.18446720651018, 8.188291578483756, 30.294377054898717, -49.9095610217864, -53.004224980379654, -51.03783055390479, -56.46966337273537, 10.192259912395699, 29.220695108839685, 11.762991502047235, 1.4223933091580143, 43.056627498723174, 38.14170074192545, -57.0094393142256, -58.829146484977436, -39.02707947627267, -61.21128329059288, -50.31287215454951, -44.203864157953674, -50.39791188657264, -9.223403814832857, -22.75560348064772, -65.80285787512048, -51.30690945003027, -18.229290184568043, -34.81021799710691, -63.368848915310565, -30.14477693853491, -43.275915916389756, -19.870132190022524, -35.28897343618668, -42.10345983222933, -66.09546257113921, -41.80712885994733, -53.744215538060054, 28.283425158214012, 16.80611042630403, -21.519447788787048, -23.171939852119387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43428108167561236, "mean_inference_ms": 1.1515769388043866, "mean_action_processing_ms": 0.18651907116874827, "mean_env_wait_ms": 0.07689466361639641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003406524658203125, "StateBufferConnector_ms": 0.002542734146118164, "ViewRequirementAgentConnector_ms": 0.06861734390258789}, "num_episodes": 11, "episode_return_max": 40.5991641203243, "episode_return_min": -57.91929289960149, "episode_return_mean": -6.2964283755490165}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.09138371063295, "num_env_steps_trained_throughput_per_sec": 501.09138371063295, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 8139.369, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8139.336, "sample_time_ms": 767.85, "learn_time_ms": 7358.209, "learn_throughput": 543.611, "synch_weights_time_ms": 12.79}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "training_iteration": 113, "trial_id": "83a5c_00000", "date": "2024-08-10_12-30-07", "timestamp": 1723307407, "time_this_iter_s": 7.987936019897461, "time_total_s": 969.8614361286163, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 969.8614361286163, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 28.018181818181816, "ram_util_percent": 82.56363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.907361746370477, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.204479945399774, "policy_loss": -0.004088716023778987, "vf_loss": 4.20844512023623, "vf_explained_var": 0.05517744803554797, "kl": 0.005484196159024662, "entropy": 1.0509840000243413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7057459840551017, "cur_kl_coeff": 0.004751452803611755, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6379197301963964, "policy_loss": -0.006469544439460151, "vf_loss": 3.64432448570927, "vf_explained_var": 0.6059394848843416, "kl": 0.01363713334953253, "entropy": 0.5188695151669284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": 40.5991641203243, "episode_reward_min": -57.91929289960149, "episode_reward_mean": -8.740620657489593, "episode_len_mean": 287.85, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 28785, "policy_reward_min": {"agent_policy": -40.59916412032431, "adversary_policy": -66.09546257113921}, "policy_reward_max": {"agent_policy": 57.919292899601494, "adversary_policy": 49.7218317790514}, "policy_reward_mean": {"agent_policy": 8.740620657489591, "adversary_policy": -8.740620657489591}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.3704068029520045, 18.471052372808124, 16.54802639837701, 37.19837438101741, 16.25406065330716, 14.00438707885324, 13.540271047289867, 2.466235519163692, 15.252047142182239, -17.175204687312664, 15.431147728705346, 37.655841454273926, 21.278648783078978, 16.717755683937995, 20.015741827488398, 16.144360933165967, 2.5379694624817986, 7.327699811323807, 5.891078516335346, 12.833716673810377, 20.387375242352615, 12.75037132766871, 23.93227875867951, 17.61450165454976, -55.559802442727936, 17.27763602479181, 23.147630336964315, -34.79945717472102, -48.31331960697813, -49.06687252142007, -56.40570895774816, 13.681986331479765, 20.625905640400354, -52.88148270725169, -55.24318366658544, 15.993340445788881, 18.347066673753222, -41.18213318719615, 32.436410786318596, 32.207415325000234, -52.01141138873243, 28.581186620382443, -49.85444184788636, -52.65798224061452, 0.8331831527096831, 22.739627785616428, 29.281241894199304, 23.068901978348613, -45.426754265003474, -47.04062270511802, -46.2443697156669, 16.04014805893995, 30.9475009242623, 19.203485802122366, 31.997452270396906, 9.027966107368602, -44.888088467003136, 11.89081565341989, 5.7371589723769585, -19.906716735468663, -50.84430259891567, -49.688181257975764, 18.267733994986436, 27.029346699630413, -48.91392429879908, 23.567207989920316, -44.18642088231346, -44.8787371137318, -44.37671366146802, 18.520364999712108, -29.528604537362583, 1.7786840531463928, 19.24133431669123, -51.45689300108304, -53.75374696332008, 19.70647751061769, 6.592692405602623, 40.5991641203243, -57.91929289960149, -50.119181383432746, -47.25836815625156, -29.810657850702746, -44.27923067788415, -34.76809981729916, -49.08953345620874, -36.71034642746236, -27.579552813104588, -54.0994612016843, -47.77567219900373, 22.54476779225903, -22.345693820453217, 27.600856296466567, -47.91146808555122, -52.765482724414206, 30.511861024120854, -48.81164593056568, -20.535931209908377, -36.262434483243254, 13.391611843537216, -17.776449065242492], "episode_lengths": [72, 140, 24, 379, 347, 338, 93, 21, 400, 400, 103, 365, 298, 400, 235, 57, 36, 64, 70, 31, 163, 400, 142, 83, 400, 400, 255, 400, 400, 400, 400, 249, 352, 400, 400, 128, 259, 400, 242, 318, 400, 384, 400, 400, 6, 118, 306, 101, 400, 400, 400, 135, 357, 112, 329, 16, 400, 82, 54, 400, 400, 400, 85, 292, 400, 250, 400, 400, 400, 128, 400, 17, 162, 400, 400, 62, 18, 276, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 231, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-1.3704068029520027, -18.471052372808128, -16.548026398377015, -37.198374381017416, -16.254060653307167, -14.004387078853242, -13.540271047289867, -2.4662355191636927, -15.252047142182235, 17.175204687312654, -15.431147728705351, -37.65584145427393, -21.278648783078978, -16.717755683937995, -20.015741827488398, -16.14436093316597, -2.5379694624817986, -7.327699811323807, -5.891078516335346, -12.833716673810377, -20.38737524235262, -12.750371327668722, -23.932278758679505, -17.61450165454976, 55.55980244272793, -17.277636024791814, -23.14763033696431, 34.79945717472102, 48.31331960697811, 49.06687252142005, 56.40570895774815, -13.681986331479774, -20.62590564040035, 52.881482707251685, 55.24318366658543, -15.993340445788881, -18.347066673753215, 41.18213318719614, -32.43641078631858, -32.20741532500025, 52.01141138873245, -28.581186620382418, 49.85444184788637, 52.657982240614515, -0.8331831527096831, -22.739627785616413, -29.281241894199297, -23.06890197834861, 45.42675426500347, 47.040622705118025, 46.244369715666906, -16.04014805893995, -30.947500924262307, -19.20348580212237, -31.997452270396916, -9.027966107368602, 44.88808846700314, -11.890815653419885, -5.7371589723769585, 19.906716735468663, 50.844302598915675, 49.68818125797577, -18.26773399498643, -27.029346699630402, 48.913924298799074, -23.567207989920323, 44.18642088231347, 44.87873711373181, 44.37671366146804, -18.52036499971211, 29.528604537362583, -1.7786840531463923, -19.241334316691233, 51.45689300108303, 53.75374696332009, -19.706477510617688, -6.592692405602625, -40.59916412032431, 57.919292899601494, 50.11918138343274, 47.25836815625155, 29.81065785070275, 44.27923067788416, 34.76809981729916, 49.089533456208734, 36.71034642746237, 27.579552813104595, 54.09946120168428, 47.775672199003736, -22.544767792259027, 22.345693820453217, -27.600856296466553, 47.9114680855512, 52.7654827244142, -30.511861024120844, 48.81164593056569, 20.535931209908377, 36.26243448324327, -13.391611843537216, 17.776449065242492], "policy_adversary_policy_reward": [24.337312570526446, -21.596498964622445, -10.494019839929543, 47.4361245855458, 17.148708121253524, 15.947344675500506, 36.742546830672275, 37.65420193136256, 6.603397085324204, 25.90472422129013, 8.060597537789516, 19.94817661991696, 11.31015506702039, 15.770387027559337, 13.644735694768997, -8.712264656441612, 12.71024244529831, 17.793851839066157, 0.3722744047420008, -34.72268377936728, 7.5604207415148075, 23.30187471589589, 30.605179939924994, 44.70650296862284, 35.1819888361913, 7.375308729966656, 5.673317252333479, 27.7621941155425, 20.16621137409404, 19.865272280882753, 29.638698318923325, 2.6500235474086047, 17.968816700410848, -12.892877775447246, 24.283708171941548, -9.628308549293934, -13.296770832878416, 25.078927865549108, 19.133053582213833, 6.534379765406927, 25.32833451082064, 15.446415973884605, 12.283024901160044, 13.21771775417739, 20.20085592148672, 27.66370159587229, 12.02453479331403, 23.20446851578548, -51.68695500012707, -59.43264988532879, 33.4962731519976, 1.0589988975860294, 23.64783928277004, 22.647421391158566, -36.487785671088204, -33.111128678353836, -54.10082821332126, -42.525811000634995, -60.50432445459778, -37.62942058824228, -50.039637279024525, -62.771780636471696, 17.99463173440472, 9.369340928554825, 29.902679101410882, 11.349132179389821, -56.869245505293804, -48.89371990920957, -58.77687381899243, -51.709493514178476, 14.88805915043389, 17.098621741143866, 29.364909972560014, 7.329223374946416, -55.84065345304633, -26.523612921345936, 48.83978038633606, 16.033041186301112, 48.23337607103252, 16.181454578968, -43.44329072811844, -60.5795320493464, 25.946071056747364, 31.21630218401748, -58.18312680994167, -41.52575688583103, -54.18441083550683, -51.131553645722214, -6.280393052808001, 7.946759358227366, 14.238369296913174, 31.240886274319653, 22.221058083065202, 36.34142570533341, 19.682672921803714, 26.455131034893505, -29.93821362951526, -60.915294900491716, -37.049766719815274, -57.03147869042078, -45.06386997831534, -47.42486945301851, 3.836388446297697, 28.2439076715822, 23.47191519092231, 38.423086657602326, 8.933350723676444, 29.473620880568298, 49.7218317790514, 14.273072761742435, 5.213436717740029, 12.842495496997179, -61.609456888110046, -28.166720045896312, 6.448979293081873, 17.332652013757894, 0.4644073165790985, 11.009910628174818, -30.196912144758493, -9.616521326178844, -49.54978456370789, -52.138820634123455, -36.17784229734542, -63.19852021860618, 20.904623623275903, 15.630844366696959, 24.20190605265512, 29.856787346605692, -58.280990298074585, -39.54685829952358, 32.17868936227572, 14.955726617564952, -22.669688860708533, -65.70315290391832, -55.99804615479494, -33.75942807266869, -38.92458776131578, -49.82883956162024, 9.621153855410915, 27.419576144013313, -33.56294351416849, -25.494265560556677, -19.627099100217396, 23.18446720651018, 8.188291578483756, 30.294377054898717, -49.9095610217864, -53.004224980379654, -51.03783055390479, -56.46966337273537, 10.192259912395699, 29.220695108839685, 11.762991502047235, 1.4223933091580143, 43.056627498723174, 38.14170074192545, -57.0094393142256, -58.829146484977436, -39.02707947627267, -61.21128329059288, -50.31287215454951, -44.203864157953674, -50.39791188657264, -9.223403814832857, -22.75560348064772, -65.80285787512048, -51.30690945003027, -18.229290184568043, -34.81021799710691, -63.368848915310565, -30.14477693853491, -43.275915916389756, -19.870132190022524, -35.28897343618668, -42.10345983222933, -66.09546257113921, -41.80712885994733, -53.744215538060054, 28.283425158214012, 16.80611042630403, -21.519447788787048, -23.171939852119387, 21.93620147471742, 33.26551111821571, -38.70248834709684, -57.120447824005666, -53.04213046686585, -52.48883498196259, 18.67240887540556, 42.351313172836136, -54.623709056001736, -42.99958280512951, -12.011447647508426, -29.060414772308327, -51.33055661413418, -21.194312352352327, 13.500810275124365, 13.282413411950063, -19.91853479685725, -15.634363333627757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4338682508817681, "mean_inference_ms": 1.1505505930024391, "mean_action_processing_ms": 0.1864656170366532, "mean_env_wait_ms": 0.07677899356847917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003382444381713867, "StateBufferConnector_ms": 0.0025321245193481445, "ViewRequirementAgentConnector_ms": 0.06992411613464355}, "num_episodes": 9, "episode_return_max": 40.5991641203243, "episode_return_min": -57.91929289960149, "episode_return_mean": -8.740620657489593}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.2412698648393, "num_env_steps_trained_throughput_per_sec": 498.2412698648393, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 8145.24, "restore_workers_time_ms": 0.011, "training_step_time_ms": 8145.207, "sample_time_ms": 770.884, "learn_time_ms": 7361.138, "learn_throughput": 543.394, "synch_weights_time_ms": 12.7}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 114, "trial_id": "83a5c_00000", "date": "2024-08-10_12-30-15", "timestamp": 1723307415, "time_this_iter_s": 8.03339409828186, "time_total_s": 977.8948302268982, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 977.8948302268982, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 26.266666666666666, "ram_util_percent": 82.44166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.059211352767137, "cur_kl_coeff": 0.02252540588378906, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7570981587051713, "policy_loss": -0.01265159471172386, "vf_loss": 3.7692316469061313, "vf_explained_var": 0.42680096336142725, "kl": 0.023000873719457, "entropy": 1.0098168203124294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.028460898064077, "cur_kl_coeff": 0.004751452803611755, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2244196796168882, "policy_loss": -0.005516682329471223, "vf_loss": 3.2298985781768956, "vf_explained_var": 0.6874190305670103, "kl": 0.00795134751222027, "entropy": 0.4617394915781915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "env_runners": {"episode_reward_max": 40.5991641203243, "episode_reward_min": -57.91929289960149, "episode_reward_mean": -13.673093761791813, "episode_len_mean": 302.82, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 30282, "policy_reward_min": {"agent_policy": -40.59916412032431, "adversary_policy": -66.09546257113921}, "policy_reward_max": {"agent_policy": 57.919292899601494, "adversary_policy": 49.7218317790514}, "policy_reward_mean": {"agent_policy": 13.673093761791813, "adversary_policy": -13.673093761791815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.717755683937995, 20.015741827488398, 16.144360933165967, 2.5379694624817986, 7.327699811323807, 5.891078516335346, 12.833716673810377, 20.387375242352615, 12.75037132766871, 23.93227875867951, 17.61450165454976, -55.559802442727936, 17.27763602479181, 23.147630336964315, -34.79945717472102, -48.31331960697813, -49.06687252142007, -56.40570895774816, 13.681986331479765, 20.625905640400354, -52.88148270725169, -55.24318366658544, 15.993340445788881, 18.347066673753222, -41.18213318719615, 32.436410786318596, 32.207415325000234, -52.01141138873243, 28.581186620382443, -49.85444184788636, -52.65798224061452, 0.8331831527096831, 22.739627785616428, 29.281241894199304, 23.068901978348613, -45.426754265003474, -47.04062270511802, -46.2443697156669, 16.04014805893995, 30.9475009242623, 19.203485802122366, 31.997452270396906, 9.027966107368602, -44.888088467003136, 11.89081565341989, 5.7371589723769585, -19.906716735468663, -50.84430259891567, -49.688181257975764, 18.267733994986436, 27.029346699630413, -48.91392429879908, 23.567207989920316, -44.18642088231346, -44.8787371137318, -44.37671366146802, 18.520364999712108, -29.528604537362583, 1.7786840531463928, 19.24133431669123, -51.45689300108304, -53.75374696332008, 19.70647751061769, 6.592692405602623, 40.5991641203243, -57.91929289960149, -50.119181383432746, -47.25836815625156, -29.810657850702746, -44.27923067788415, -34.76809981729916, -49.08953345620874, -36.71034642746236, -27.579552813104588, -54.0994612016843, -47.77567219900373, 22.54476779225903, -22.345693820453217, 27.600856296466567, -47.91146808555122, -52.765482724414206, 30.511861024120854, -48.81164593056568, -20.535931209908377, -36.262434483243254, 13.391611843537216, -17.776449065242492, 14.342304796981866, -46.358771662894036, -49.78206581188582, 28.24645308175692, 31.036705252246, -46.8724614986586, 16.461233099059896, -39.574105685656804, -27.553338549543863, -40.63793437138825, -46.44400213596836, -47.16050232562273, -46.655529943952196], "episode_lengths": [400, 235, 57, 36, 64, 70, 31, 163, 400, 142, 83, 400, 400, 255, 400, 400, 400, 400, 249, 352, 400, 400, 128, 259, 400, 242, 318, 400, 384, 400, 400, 6, 118, 306, 101, 400, 400, 400, 135, 357, 112, 329, 16, 400, 82, 54, 400, 400, 400, 85, 292, 400, 250, 400, 400, 400, 128, 400, 17, 162, 400, 400, 62, 18, 276, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 231, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 43, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-16.717755683937995, -20.015741827488398, -16.14436093316597, -2.5379694624817986, -7.327699811323807, -5.891078516335346, -12.833716673810377, -20.38737524235262, -12.750371327668722, -23.932278758679505, -17.61450165454976, 55.55980244272793, -17.277636024791814, -23.14763033696431, 34.79945717472102, 48.31331960697811, 49.06687252142005, 56.40570895774815, -13.681986331479774, -20.62590564040035, 52.881482707251685, 55.24318366658543, -15.993340445788881, -18.347066673753215, 41.18213318719614, -32.43641078631858, -32.20741532500025, 52.01141138873245, -28.581186620382418, 49.85444184788637, 52.657982240614515, -0.8331831527096831, -22.739627785616413, -29.281241894199297, -23.06890197834861, 45.42675426500347, 47.040622705118025, 46.244369715666906, -16.04014805893995, -30.947500924262307, -19.20348580212237, -31.997452270396916, -9.027966107368602, 44.88808846700314, -11.890815653419885, -5.7371589723769585, 19.906716735468663, 50.844302598915675, 49.68818125797577, -18.26773399498643, -27.029346699630402, 48.913924298799074, -23.567207989920323, 44.18642088231347, 44.87873711373181, 44.37671366146804, -18.52036499971211, 29.528604537362583, -1.7786840531463923, -19.241334316691233, 51.45689300108303, 53.75374696332009, -19.706477510617688, -6.592692405602625, -40.59916412032431, 57.919292899601494, 50.11918138343274, 47.25836815625155, 29.81065785070275, 44.27923067788416, 34.76809981729916, 49.089533456208734, 36.71034642746237, 27.579552813104595, 54.09946120168428, 47.775672199003736, -22.544767792259027, 22.345693820453217, -27.600856296466553, 47.9114680855512, 52.7654827244142, -30.511861024120844, 48.81164593056569, 20.535931209908377, 36.26243448324327, -13.391611843537216, 17.776449065242492, -14.342304796981868, 46.35877166289403, 49.78206581188583, -28.246453081756904, -31.036705252245994, 46.872461498658595, -16.461233099059896, 39.5741056856568, 27.55333854954387, 40.637934371388255, 46.444002135968354, 47.16050232562274, 46.65552994395219], "policy_adversary_policy_reward": [5.673317252333479, 27.7621941155425, 20.16621137409404, 19.865272280882753, 29.638698318923325, 2.6500235474086047, 17.968816700410848, -12.892877775447246, 24.283708171941548, -9.628308549293934, -13.296770832878416, 25.078927865549108, 19.133053582213833, 6.534379765406927, 25.32833451082064, 15.446415973884605, 12.283024901160044, 13.21771775417739, 20.20085592148672, 27.66370159587229, 12.02453479331403, 23.20446851578548, -51.68695500012707, -59.43264988532879, 33.4962731519976, 1.0589988975860294, 23.64783928277004, 22.647421391158566, -36.487785671088204, -33.111128678353836, -54.10082821332126, -42.525811000634995, -60.50432445459778, -37.62942058824228, -50.039637279024525, -62.771780636471696, 17.99463173440472, 9.369340928554825, 29.902679101410882, 11.349132179389821, -56.869245505293804, -48.89371990920957, -58.77687381899243, -51.709493514178476, 14.88805915043389, 17.098621741143866, 29.364909972560014, 7.329223374946416, -55.84065345304633, -26.523612921345936, 48.83978038633606, 16.033041186301112, 48.23337607103252, 16.181454578968, -43.44329072811844, -60.5795320493464, 25.946071056747364, 31.21630218401748, -58.18312680994167, -41.52575688583103, -54.18441083550683, -51.131553645722214, -6.280393052808001, 7.946759358227366, 14.238369296913174, 31.240886274319653, 22.221058083065202, 36.34142570533341, 19.682672921803714, 26.455131034893505, -29.93821362951526, -60.915294900491716, -37.049766719815274, -57.03147869042078, -45.06386997831534, -47.42486945301851, 3.836388446297697, 28.2439076715822, 23.47191519092231, 38.423086657602326, 8.933350723676444, 29.473620880568298, 49.7218317790514, 14.273072761742435, 5.213436717740029, 12.842495496997179, -61.609456888110046, -28.166720045896312, 6.448979293081873, 17.332652013757894, 0.4644073165790985, 11.009910628174818, -30.196912144758493, -9.616521326178844, -49.54978456370789, -52.138820634123455, -36.17784229734542, -63.19852021860618, 20.904623623275903, 15.630844366696959, 24.20190605265512, 29.856787346605692, -58.280990298074585, -39.54685829952358, 32.17868936227572, 14.955726617564952, -22.669688860708533, -65.70315290391832, -55.99804615479494, -33.75942807266869, -38.92458776131578, -49.82883956162024, 9.621153855410915, 27.419576144013313, -33.56294351416849, -25.494265560556677, -19.627099100217396, 23.18446720651018, 8.188291578483756, 30.294377054898717, -49.9095610217864, -53.004224980379654, -51.03783055390479, -56.46966337273537, 10.192259912395699, 29.220695108839685, 11.762991502047235, 1.4223933091580143, 43.056627498723174, 38.14170074192545, -57.0094393142256, -58.829146484977436, -39.02707947627267, -61.21128329059288, -50.31287215454951, -44.203864157953674, -50.39791188657264, -9.223403814832857, -22.75560348064772, -65.80285787512048, -51.30690945003027, -18.229290184568043, -34.81021799710691, -63.368848915310565, -30.14477693853491, -43.275915916389756, -19.870132190022524, -35.28897343618668, -42.10345983222933, -66.09546257113921, -41.80712885994733, -53.744215538060054, 28.283425158214012, 16.80611042630403, -21.519447788787048, -23.171939852119387, 21.93620147471742, 33.26551111821571, -38.70248834709684, -57.120447824005666, -53.04213046686585, -52.48883498196259, 18.67240887540556, 42.351313172836136, -54.623709056001736, -42.99958280512951, -12.011447647508426, -29.060414772308327, -51.33055661413418, -21.194312352352327, 13.500810275124365, 13.282413411950063, -19.91853479685725, -15.634363333627757, 18.648842655195914, 10.035766938767809, -41.48081757242053, -51.236725753367566, -50.875631012394834, -48.68850061137687, 32.055661855933785, 24.43724430758004, 34.06962097021727, 28.00378953427473, -36.29499656304759, -57.44992643426962, 26.219825074913615, 6.7026411232061776, -45.13108615567033, -34.017125215643226, -29.374632837291372, -25.732044261796368, -46.35106067089018, -34.92480807188626, -45.858949540957795, -47.02905473097905, -40.94442362224805, -53.376581028997315, -60.02023030454916, -33.29082958335518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4333807317026257, "mean_inference_ms": 1.1488185978631031, "mean_action_processing_ms": 0.18627161447200982, "mean_env_wait_ms": 0.07666708664784565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033458471298217773, "StateBufferConnector_ms": 0.0025196075439453125, "ViewRequirementAgentConnector_ms": 0.06780540943145752}, "num_episodes": 13, "episode_return_max": 40.5991641203243, "episode_return_min": -57.91929289960149, "episode_return_mean": -13.673093761791813}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.69851998405824, "num_env_steps_trained_throughput_per_sec": 481.69851998405824, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 8136.458, "restore_workers_time_ms": 0.011, "training_step_time_ms": 8136.426, "sample_time_ms": 755.982, "learn_time_ms": 7366.978, "learn_throughput": 542.963, "synch_weights_time_ms": 12.977}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "training_iteration": 115, "trial_id": "83a5c_00000", "date": "2024-08-10_12-30-24", "timestamp": 1723307424, "time_this_iter_s": 8.309699296951294, "time_total_s": 986.2045295238495, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f5a6430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 986.2045295238495, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 27.750000000000004, "ram_util_percent": 82.31666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.601977232618937, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.377848725848728, "policy_loss": -0.008715856222623082, "vf_loss": 3.3859173804994613, "vf_explained_var": 0.16384029028907654, "kl": 0.01915480628908111, "entropy": 1.1077470185895446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.039103899803012, "cur_kl_coeff": 0.004751452803611755, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.819497123360634, "policy_loss": -0.0031215247125752892, "vf_loss": 3.822599974771341, "vf_explained_var": -0.682541462033987, "kl": 0.003929310849928758, "entropy": 0.39899422901993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 40.5991641203243, "episode_reward_min": -57.91929289960149, "episode_reward_mean": -17.04496994847132, "episode_len_mean": 324.26, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 32426, "policy_reward_min": {"agent_policy": -40.59916412032431, "adversary_policy": -66.09546257113921}, "policy_reward_max": {"agent_policy": 57.919292899601494, "adversary_policy": 49.7218317790514}, "policy_reward_mean": {"agent_policy": 17.04496994847132, "adversary_policy": -17.044969948471316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.93227875867951, 17.61450165454976, -55.559802442727936, 17.27763602479181, 23.147630336964315, -34.79945717472102, -48.31331960697813, -49.06687252142007, -56.40570895774816, 13.681986331479765, 20.625905640400354, -52.88148270725169, -55.24318366658544, 15.993340445788881, 18.347066673753222, -41.18213318719615, 32.436410786318596, 32.207415325000234, -52.01141138873243, 28.581186620382443, -49.85444184788636, -52.65798224061452, 0.8331831527096831, 22.739627785616428, 29.281241894199304, 23.068901978348613, -45.426754265003474, -47.04062270511802, -46.2443697156669, 16.04014805893995, 30.9475009242623, 19.203485802122366, 31.997452270396906, 9.027966107368602, -44.888088467003136, 11.89081565341989, 5.7371589723769585, -19.906716735468663, -50.84430259891567, -49.688181257975764, 18.267733994986436, 27.029346699630413, -48.91392429879908, 23.567207989920316, -44.18642088231346, -44.8787371137318, -44.37671366146802, 18.520364999712108, -29.528604537362583, 1.7786840531463928, 19.24133431669123, -51.45689300108304, -53.75374696332008, 19.70647751061769, 6.592692405602623, 40.5991641203243, -57.91929289960149, -50.119181383432746, -47.25836815625156, -29.810657850702746, -44.27923067788415, -34.76809981729916, -49.08953345620874, -36.71034642746236, -27.579552813104588, -54.0994612016843, -47.77567219900373, 22.54476779225903, -22.345693820453217, 27.600856296466567, -47.91146808555122, -52.765482724414206, 30.511861024120854, -48.81164593056568, -20.535931209908377, -36.262434483243254, 13.391611843537216, -17.776449065242492, 14.342304796981866, -46.358771662894036, -49.78206581188582, 28.24645308175692, 31.036705252246, -46.8724614986586, 16.461233099059896, -39.574105685656804, -27.553338549543863, -40.63793437138825, -46.44400213596836, -47.16050232562273, -46.655529943952196, -34.23233946334428, 6.795694777232408, -19.806000089610514, -34.01537083021924, -36.29639802641762, -32.76031771153851, -40.6665515384288, 4.552079645149849, -36.15234595220864], "episode_lengths": [142, 83, 400, 400, 255, 400, 400, 400, 400, 249, 352, 400, 400, 128, 259, 400, 242, 318, 400, 384, 400, 400, 6, 118, 306, 101, 400, 400, 400, 135, 357, 112, 329, 16, 400, 82, 54, 400, 400, 400, 85, 292, 400, 250, 400, 400, 400, 128, 400, 17, 162, 400, 400, 62, 18, 276, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 231, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-23.932278758679505, -17.61450165454976, 55.55980244272793, -17.277636024791814, -23.14763033696431, 34.79945717472102, 48.31331960697811, 49.06687252142005, 56.40570895774815, -13.681986331479774, -20.62590564040035, 52.881482707251685, 55.24318366658543, -15.993340445788881, -18.347066673753215, 41.18213318719614, -32.43641078631858, -32.20741532500025, 52.01141138873245, -28.581186620382418, 49.85444184788637, 52.657982240614515, -0.8331831527096831, -22.739627785616413, -29.281241894199297, -23.06890197834861, 45.42675426500347, 47.040622705118025, 46.244369715666906, -16.04014805893995, -30.947500924262307, -19.20348580212237, -31.997452270396916, -9.027966107368602, 44.88808846700314, -11.890815653419885, -5.7371589723769585, 19.906716735468663, 50.844302598915675, 49.68818125797577, -18.26773399498643, -27.029346699630402, 48.913924298799074, -23.567207989920323, 44.18642088231347, 44.87873711373181, 44.37671366146804, -18.52036499971211, 29.528604537362583, -1.7786840531463923, -19.241334316691233, 51.45689300108303, 53.75374696332009, -19.706477510617688, -6.592692405602625, -40.59916412032431, 57.919292899601494, 50.11918138343274, 47.25836815625155, 29.81065785070275, 44.27923067788416, 34.76809981729916, 49.089533456208734, 36.71034642746237, 27.579552813104595, 54.09946120168428, 47.775672199003736, -22.544767792259027, 22.345693820453217, -27.600856296466553, 47.9114680855512, 52.7654827244142, -30.511861024120844, 48.81164593056569, 20.535931209908377, 36.26243448324327, -13.391611843537216, 17.776449065242492, -14.342304796981868, 46.35877166289403, 49.78206581188583, -28.246453081756904, -31.036705252245994, 46.872461498658595, -16.461233099059896, 39.5741056856568, 27.55333854954387, 40.637934371388255, 46.444002135968354, 47.16050232562274, 46.65552994395219, 34.23233946334426, -6.795694777232413, 19.80600008961051, 34.01537083021922, 36.29639802641761, 32.76031771153852, 40.666551538428806, -4.552079645149847, 36.15234595220865], "policy_adversary_policy_reward": [20.20085592148672, 27.66370159587229, 12.02453479331403, 23.20446851578548, -51.68695500012707, -59.43264988532879, 33.4962731519976, 1.0589988975860294, 23.64783928277004, 22.647421391158566, -36.487785671088204, -33.111128678353836, -54.10082821332126, -42.525811000634995, -60.50432445459778, -37.62942058824228, -50.039637279024525, -62.771780636471696, 17.99463173440472, 9.369340928554825, 29.902679101410882, 11.349132179389821, -56.869245505293804, -48.89371990920957, -58.77687381899243, -51.709493514178476, 14.88805915043389, 17.098621741143866, 29.364909972560014, 7.329223374946416, -55.84065345304633, -26.523612921345936, 48.83978038633606, 16.033041186301112, 48.23337607103252, 16.181454578968, -43.44329072811844, -60.5795320493464, 25.946071056747364, 31.21630218401748, -58.18312680994167, -41.52575688583103, -54.18441083550683, -51.131553645722214, -6.280393052808001, 7.946759358227366, 14.238369296913174, 31.240886274319653, 22.221058083065202, 36.34142570533341, 19.682672921803714, 26.455131034893505, -29.93821362951526, -60.915294900491716, -37.049766719815274, -57.03147869042078, -45.06386997831534, -47.42486945301851, 3.836388446297697, 28.2439076715822, 23.47191519092231, 38.423086657602326, 8.933350723676444, 29.473620880568298, 49.7218317790514, 14.273072761742435, 5.213436717740029, 12.842495496997179, -61.609456888110046, -28.166720045896312, 6.448979293081873, 17.332652013757894, 0.4644073165790985, 11.009910628174818, -30.196912144758493, -9.616521326178844, -49.54978456370789, -52.138820634123455, -36.17784229734542, -63.19852021860618, 20.904623623275903, 15.630844366696959, 24.20190605265512, 29.856787346605692, -58.280990298074585, -39.54685829952358, 32.17868936227572, 14.955726617564952, -22.669688860708533, -65.70315290391832, -55.99804615479494, -33.75942807266869, -38.92458776131578, -49.82883956162024, 9.621153855410915, 27.419576144013313, -33.56294351416849, -25.494265560556677, -19.627099100217396, 23.18446720651018, 8.188291578483756, 30.294377054898717, -49.9095610217864, -53.004224980379654, -51.03783055390479, -56.46966337273537, 10.192259912395699, 29.220695108839685, 11.762991502047235, 1.4223933091580143, 43.056627498723174, 38.14170074192545, -57.0094393142256, -58.829146484977436, -39.02707947627267, -61.21128329059288, -50.31287215454951, -44.203864157953674, -50.39791188657264, -9.223403814832857, -22.75560348064772, -65.80285787512048, -51.30690945003027, -18.229290184568043, -34.81021799710691, -63.368848915310565, -30.14477693853491, -43.275915916389756, -19.870132190022524, -35.28897343618668, -42.10345983222933, -66.09546257113921, -41.80712885994733, -53.744215538060054, 28.283425158214012, 16.80611042630403, -21.519447788787048, -23.171939852119387, 21.93620147471742, 33.26551111821571, -38.70248834709684, -57.120447824005666, -53.04213046686585, -52.48883498196259, 18.67240887540556, 42.351313172836136, -54.623709056001736, -42.99958280512951, -12.011447647508426, -29.060414772308327, -51.33055661413418, -21.194312352352327, 13.500810275124365, 13.282413411950063, -19.91853479685725, -15.634363333627757, 18.648842655195914, 10.035766938767809, -41.48081757242053, -51.236725753367566, -50.875631012394834, -48.68850061137687, 32.055661855933785, 24.43724430758004, 34.06962097021727, 28.00378953427473, -36.29499656304759, -57.44992643426962, 26.219825074913615, 6.7026411232061776, -45.13108615567033, -34.017125215643226, -29.374632837291372, -25.732044261796368, -46.35106067089018, -34.92480807188626, -45.858949540957795, -47.02905473097905, -40.94442362224805, -53.376581028997315, -60.02023030454916, -33.29082958335518, -52.82790025509881, -15.636778671589617, 13.747446823842948, -0.15605726937813102, -20.355027668456962, -19.256972510764058, -31.976078941702923, -36.05466271873542, -39.47894422113987, -33.113851831695314, -34.335852498675365, -31.184782924401524, -40.09674390907604, -41.236359167781515, 7.94651353187276, 1.1576457584269377, -32.12735171235052, -40.17734019206678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43311735374241794, "mean_inference_ms": 1.1472632558792024, "mean_action_processing_ms": 0.18608091073988217, "mean_env_wait_ms": 0.0765336214216759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003354310989379883, "StateBufferConnector_ms": 0.0025072097778320312, "ViewRequirementAgentConnector_ms": 0.06860506534576416}, "num_episodes": 9, "episode_return_max": 40.5991641203243, "episode_return_min": -57.91929289960149, "episode_return_mean": -17.04496994847132}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.07259175406415, "num_env_steps_trained_throughput_per_sec": 492.07259175406415, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 8122.753, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8122.72, "sample_time_ms": 764.926, "learn_time_ms": 7344.691, "learn_throughput": 544.611, "synch_weights_time_ms": 12.619}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 116, "trial_id": "83a5c_00000", "date": "2024-08-10_12-30-32", "timestamp": 1723307432, "time_this_iter_s": 8.134813070297241, "time_total_s": 994.3393425941467, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcacc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 994.3393425941467, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 27.88181818181818, "ram_util_percent": 82.00909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7506543325999426, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5098702828089396, "policy_loss": -0.008408958732061798, "vf_loss": 3.5177012206385374, "vf_explained_var": -0.3195931695125721, "kl": 0.01710714232584054, "entropy": 1.0837972316477034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.707889145457496, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7097745618472495, "policy_loss": -0.006773267630099629, "vf_loss": 3.7165186354269584, "vf_explained_var": -0.7901244339222709, "kl": 0.012288298139367737, "entropy": 0.362400012028714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "env_runners": {"episode_reward_max": 40.5991641203243, "episode_reward_min": -57.91929289960149, "episode_reward_mean": -15.990493995832066, "episode_len_mean": 325.98, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 32598, "policy_reward_min": {"agent_policy": -40.59916412032431, "adversary_policy": -66.09546257113921}, "policy_reward_max": {"agent_policy": 57.919292899601494, "adversary_policy": 49.7218317790514}, "policy_reward_mean": {"agent_policy": 15.990493995832066, "adversary_policy": -15.990493995832065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.24318366658544, 15.993340445788881, 18.347066673753222, -41.18213318719615, 32.436410786318596, 32.207415325000234, -52.01141138873243, 28.581186620382443, -49.85444184788636, -52.65798224061452, 0.8331831527096831, 22.739627785616428, 29.281241894199304, 23.068901978348613, -45.426754265003474, -47.04062270511802, -46.2443697156669, 16.04014805893995, 30.9475009242623, 19.203485802122366, 31.997452270396906, 9.027966107368602, -44.888088467003136, 11.89081565341989, 5.7371589723769585, -19.906716735468663, -50.84430259891567, -49.688181257975764, 18.267733994986436, 27.029346699630413, -48.91392429879908, 23.567207989920316, -44.18642088231346, -44.8787371137318, -44.37671366146802, 18.520364999712108, -29.528604537362583, 1.7786840531463928, 19.24133431669123, -51.45689300108304, -53.75374696332008, 19.70647751061769, 6.592692405602623, 40.5991641203243, -57.91929289960149, -50.119181383432746, -47.25836815625156, -29.810657850702746, -44.27923067788415, -34.76809981729916, -49.08953345620874, -36.71034642746236, -27.579552813104588, -54.0994612016843, -47.77567219900373, 22.54476779225903, -22.345693820453217, 27.600856296466567, -47.91146808555122, -52.765482724414206, 30.511861024120854, -48.81164593056568, -20.535931209908377, -36.262434483243254, 13.391611843537216, -17.776449065242492, 14.342304796981866, -46.358771662894036, -49.78206581188582, 28.24645308175692, 31.036705252246, -46.8724614986586, 16.461233099059896, -39.574105685656804, -27.553338549543863, -40.63793437138825, -46.44400213596836, -47.16050232562273, -46.655529943952196, -34.23233946334428, 6.795694777232408, -19.806000089610514, -34.01537083021924, -36.29639802641762, -32.76031771153851, -40.6665515384288, 4.552079645149849, -36.15234595220864, 0.8828742756535508, 3.115094715375122, -5.567908162978778, 9.67754291593569, 24.804287693174754, -4.109460395745344, -15.824896545175434, -1.2920788094301798, -36.27311382897966, -50.25760395967698, -0.04200178623328732, -0.41184551197587105], "episode_lengths": [400, 128, 259, 400, 242, 318, 400, 384, 400, 400, 6, 118, 306, 101, 400, 400, 400, 135, 357, 112, 329, 16, 400, 82, 54, 400, 400, 400, 85, 292, 400, 250, 400, 400, 400, 128, 400, 17, 162, 400, 400, 62, 18, 276, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 231, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 12, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [55.24318366658543, -15.993340445788881, -18.347066673753215, 41.18213318719614, -32.43641078631858, -32.20741532500025, 52.01141138873245, -28.581186620382418, 49.85444184788637, 52.657982240614515, -0.8331831527096831, -22.739627785616413, -29.281241894199297, -23.06890197834861, 45.42675426500347, 47.040622705118025, 46.244369715666906, -16.04014805893995, -30.947500924262307, -19.20348580212237, -31.997452270396916, -9.027966107368602, 44.88808846700314, -11.890815653419885, -5.7371589723769585, 19.906716735468663, 50.844302598915675, 49.68818125797577, -18.26773399498643, -27.029346699630402, 48.913924298799074, -23.567207989920323, 44.18642088231347, 44.87873711373181, 44.37671366146804, -18.52036499971211, 29.528604537362583, -1.7786840531463923, -19.241334316691233, 51.45689300108303, 53.75374696332009, -19.706477510617688, -6.592692405602625, -40.59916412032431, 57.919292899601494, 50.11918138343274, 47.25836815625155, 29.81065785070275, 44.27923067788416, 34.76809981729916, 49.089533456208734, 36.71034642746237, 27.579552813104595, 54.09946120168428, 47.775672199003736, -22.544767792259027, 22.345693820453217, -27.600856296466553, 47.9114680855512, 52.7654827244142, -30.511861024120844, 48.81164593056569, 20.535931209908377, 36.26243448324327, -13.391611843537216, 17.776449065242492, -14.342304796981868, 46.35877166289403, 49.78206581188583, -28.246453081756904, -31.036705252245994, 46.872461498658595, -16.461233099059896, 39.5741056856568, 27.55333854954387, 40.637934371388255, 46.444002135968354, 47.16050232562274, 46.65552994395219, 34.23233946334426, -6.795694777232413, 19.80600008961051, 34.01537083021922, 36.29639802641761, 32.76031771153852, 40.666551538428806, -4.552079645149847, 36.15234595220865, -0.8828742756535508, -3.115094715375122, 5.567908162978777, -9.67754291593569, -24.80428769317477, 4.109460395745353, 15.82489654517543, 1.2920788094301798, 36.27311382897965, 50.257603959676985, 0.04200178623328732, 0.41184551197586217], "policy_adversary_policy_reward": [-58.77687381899243, -51.709493514178476, 14.88805915043389, 17.098621741143866, 29.364909972560014, 7.329223374946416, -55.84065345304633, -26.523612921345936, 48.83978038633606, 16.033041186301112, 48.23337607103252, 16.181454578968, -43.44329072811844, -60.5795320493464, 25.946071056747364, 31.21630218401748, -58.18312680994167, -41.52575688583103, -54.18441083550683, -51.131553645722214, -6.280393052808001, 7.946759358227366, 14.238369296913174, 31.240886274319653, 22.221058083065202, 36.34142570533341, 19.682672921803714, 26.455131034893505, -29.93821362951526, -60.915294900491716, -37.049766719815274, -57.03147869042078, -45.06386997831534, -47.42486945301851, 3.836388446297697, 28.2439076715822, 23.47191519092231, 38.423086657602326, 8.933350723676444, 29.473620880568298, 49.7218317790514, 14.273072761742435, 5.213436717740029, 12.842495496997179, -61.609456888110046, -28.166720045896312, 6.448979293081873, 17.332652013757894, 0.4644073165790985, 11.009910628174818, -30.196912144758493, -9.616521326178844, -49.54978456370789, -52.138820634123455, -36.17784229734542, -63.19852021860618, 20.904623623275903, 15.630844366696959, 24.20190605265512, 29.856787346605692, -58.280990298074585, -39.54685829952358, 32.17868936227572, 14.955726617564952, -22.669688860708533, -65.70315290391832, -55.99804615479494, -33.75942807266869, -38.92458776131578, -49.82883956162024, 9.621153855410915, 27.419576144013313, -33.56294351416849, -25.494265560556677, -19.627099100217396, 23.18446720651018, 8.188291578483756, 30.294377054898717, -49.9095610217864, -53.004224980379654, -51.03783055390479, -56.46966337273537, 10.192259912395699, 29.220695108839685, 11.762991502047235, 1.4223933091580143, 43.056627498723174, 38.14170074192545, -57.0094393142256, -58.829146484977436, -39.02707947627267, -61.21128329059288, -50.31287215454951, -44.203864157953674, -50.39791188657264, -9.223403814832857, -22.75560348064772, -65.80285787512048, -51.30690945003027, -18.229290184568043, -34.81021799710691, -63.368848915310565, -30.14477693853491, -43.275915916389756, -19.870132190022524, -35.28897343618668, -42.10345983222933, -66.09546257113921, -41.80712885994733, -53.744215538060054, 28.283425158214012, 16.80611042630403, -21.519447788787048, -23.171939852119387, 21.93620147471742, 33.26551111821571, -38.70248834709684, -57.120447824005666, -53.04213046686585, -52.48883498196259, 18.67240887540556, 42.351313172836136, -54.623709056001736, -42.99958280512951, -12.011447647508426, -29.060414772308327, -51.33055661413418, -21.194312352352327, 13.500810275124365, 13.282413411950063, -19.91853479685725, -15.634363333627757, 18.648842655195914, 10.035766938767809, -41.48081757242053, -51.236725753367566, -50.875631012394834, -48.68850061137687, 32.055661855933785, 24.43724430758004, 34.06962097021727, 28.00378953427473, -36.29499656304759, -57.44992643426962, 26.219825074913615, 6.7026411232061776, -45.13108615567033, -34.017125215643226, -29.374632837291372, -25.732044261796368, -46.35106067089018, -34.92480807188626, -45.858949540957795, -47.02905473097905, -40.94442362224805, -53.376581028997315, -60.02023030454916, -33.29082958335518, -52.82790025509881, -15.636778671589617, 13.747446823842948, -0.15605726937813102, -20.355027668456962, -19.256972510764058, -31.976078941702923, -36.05466271873542, -39.47894422113987, -33.113851831695314, -34.335852498675365, -31.184782924401524, -40.09674390907604, -41.236359167781515, 7.94651353187276, 1.1576457584269377, -32.12735171235052, -40.17734019206678, -12.15371041853875, 13.919458969845852, 28.045911427801165, -21.81572199705092, -14.765465434951892, 3.6296491089943372, 9.375718216537187, 9.979367615334192, 33.352581823576855, 16.255993562772723, -3.4967377521751537, -4.72218303931556, 15.987533227079734, -47.63732631743058, -10.385223196182253, 7.801065577321893, -43.01541489829993, -29.53081275965944, -52.95435913943776, -47.56084877991616, -18.06343962054015, 17.979436048073577, -17.52475102692518, 16.70106000297345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4327248467326541, "mean_inference_ms": 1.1458906008292893, "mean_action_processing_ms": 0.185903522257683, "mean_env_wait_ms": 0.07639151033326881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003331780433654785, "StateBufferConnector_ms": 0.002497434616088867, "ViewRequirementAgentConnector_ms": 0.06715476512908936}, "num_episodes": 12, "episode_return_max": 40.5991641203243, "episode_return_min": -57.91929289960149, "episode_return_mean": -15.990493995832066}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.8720055108188, "num_env_steps_trained_throughput_per_sec": 491.8720055108188, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 8118.324, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8118.291, "sample_time_ms": 757.682, "learn_time_ms": 7347.336, "learn_throughput": 544.415, "synch_weights_time_ms": 12.789}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "training_iteration": 117, "trial_id": "83a5c_00000", "date": "2024-08-10_12-30-40", "timestamp": 1723307440, "time_this_iter_s": 8.137901782989502, "time_total_s": 1002.4772443771362, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcacca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1002.4772443771362, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 26.150000000000002, "ram_util_percent": 82.09166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.75472435620096, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.605067061242603, "policy_loss": -0.013981500886769955, "vf_loss": 3.6185857351494843, "vf_explained_var": -0.2272059477195538, "kl": 0.01369797188181651, "entropy": 0.9288636288945638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.856880932797988, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.695089168349901, "policy_loss": -0.00517448897662689, "vf_loss": 4.7002450215319795, "vf_explained_var": -0.9858020416771373, "kl": 0.007853056519283953, "entropy": 0.43993279871841273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": 40.5991641203243, "episode_reward_min": -57.91929289960149, "episode_reward_mean": -14.630192019723257, "episode_len_mean": 332.67, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33267, "policy_reward_min": {"agent_policy": -40.59916412032431, "adversary_policy": -66.09546257113921}, "policy_reward_max": {"agent_policy": 57.919292899601494, "adversary_policy": 49.7218317790514}, "policy_reward_mean": {"agent_policy": 14.630192019723257, "adversary_policy": -14.630192019723253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8331831527096831, 22.739627785616428, 29.281241894199304, 23.068901978348613, -45.426754265003474, -47.04062270511802, -46.2443697156669, 16.04014805893995, 30.9475009242623, 19.203485802122366, 31.997452270396906, 9.027966107368602, -44.888088467003136, 11.89081565341989, 5.7371589723769585, -19.906716735468663, -50.84430259891567, -49.688181257975764, 18.267733994986436, 27.029346699630413, -48.91392429879908, 23.567207989920316, -44.18642088231346, -44.8787371137318, -44.37671366146802, 18.520364999712108, -29.528604537362583, 1.7786840531463928, 19.24133431669123, -51.45689300108304, -53.75374696332008, 19.70647751061769, 6.592692405602623, 40.5991641203243, -57.91929289960149, -50.119181383432746, -47.25836815625156, -29.810657850702746, -44.27923067788415, -34.76809981729916, -49.08953345620874, -36.71034642746236, -27.579552813104588, -54.0994612016843, -47.77567219900373, 22.54476779225903, -22.345693820453217, 27.600856296466567, -47.91146808555122, -52.765482724414206, 30.511861024120854, -48.81164593056568, -20.535931209908377, -36.262434483243254, 13.391611843537216, -17.776449065242492, 14.342304796981866, -46.358771662894036, -49.78206581188582, 28.24645308175692, 31.036705252246, -46.8724614986586, 16.461233099059896, -39.574105685656804, -27.553338549543863, -40.63793437138825, -46.44400213596836, -47.16050232562273, -46.655529943952196, -34.23233946334428, 6.795694777232408, -19.806000089610514, -34.01537083021924, -36.29639802641762, -32.76031771153851, -40.6665515384288, 4.552079645149849, -36.15234595220864, 0.8828742756535508, 3.115094715375122, -5.567908162978778, 9.67754291593569, 24.804287693174754, -4.109460395745344, -15.824896545175434, -1.2920788094301798, -36.27311382897966, -50.25760395967698, -0.04200178623328732, -0.41184551197587105, -9.376007835123946, -3.4259725027062755, 3.884401701176957, -15.110702756943084, 12.418839222929016, 11.66865840006369, -7.782792397565581, 30.65611307060889, 21.16481649005056, -31.450888261380683], "episode_lengths": [6, 118, 306, 101, 400, 400, 400, 135, 357, 112, 329, 16, 400, 82, 54, 400, 400, 400, 85, 292, 400, 250, 400, 400, 400, 128, 400, 17, 162, 400, 400, 62, 18, 276, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 231, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-0.8331831527096831, -22.739627785616413, -29.281241894199297, -23.06890197834861, 45.42675426500347, 47.040622705118025, 46.244369715666906, -16.04014805893995, -30.947500924262307, -19.20348580212237, -31.997452270396916, -9.027966107368602, 44.88808846700314, -11.890815653419885, -5.7371589723769585, 19.906716735468663, 50.844302598915675, 49.68818125797577, -18.26773399498643, -27.029346699630402, 48.913924298799074, -23.567207989920323, 44.18642088231347, 44.87873711373181, 44.37671366146804, -18.52036499971211, 29.528604537362583, -1.7786840531463923, -19.241334316691233, 51.45689300108303, 53.75374696332009, -19.706477510617688, -6.592692405602625, -40.59916412032431, 57.919292899601494, 50.11918138343274, 47.25836815625155, 29.81065785070275, 44.27923067788416, 34.76809981729916, 49.089533456208734, 36.71034642746237, 27.579552813104595, 54.09946120168428, 47.775672199003736, -22.544767792259027, 22.345693820453217, -27.600856296466553, 47.9114680855512, 52.7654827244142, -30.511861024120844, 48.81164593056569, 20.535931209908377, 36.26243448324327, -13.391611843537216, 17.776449065242492, -14.342304796981868, 46.35877166289403, 49.78206581188583, -28.246453081756904, -31.036705252245994, 46.872461498658595, -16.461233099059896, 39.5741056856568, 27.55333854954387, 40.637934371388255, 46.444002135968354, 47.16050232562274, 46.65552994395219, 34.23233946334426, -6.795694777232413, 19.80600008961051, 34.01537083021922, 36.29639802641761, 32.76031771153852, 40.666551538428806, -4.552079645149847, 36.15234595220865, -0.8828742756535508, -3.115094715375122, 5.567908162978777, -9.67754291593569, -24.80428769317477, 4.109460395745353, 15.82489654517543, 1.2920788094301798, 36.27311382897965, 50.257603959676985, 0.04200178623328732, 0.41184551197586217, 9.376007835123938, 3.425972502706296, -3.884401701176956, 15.110702756943084, -12.418839222929016, -11.668658400063688, 7.782792397565586, -30.656113070608857, -21.164816490050548, 31.450888261380683], "policy_adversary_policy_reward": [-6.280393052808001, 7.946759358227366, 14.238369296913174, 31.240886274319653, 22.221058083065202, 36.34142570533341, 19.682672921803714, 26.455131034893505, -29.93821362951526, -60.915294900491716, -37.049766719815274, -57.03147869042078, -45.06386997831534, -47.42486945301851, 3.836388446297697, 28.2439076715822, 23.47191519092231, 38.423086657602326, 8.933350723676444, 29.473620880568298, 49.7218317790514, 14.273072761742435, 5.213436717740029, 12.842495496997179, -61.609456888110046, -28.166720045896312, 6.448979293081873, 17.332652013757894, 0.4644073165790985, 11.009910628174818, -30.196912144758493, -9.616521326178844, -49.54978456370789, -52.138820634123455, -36.17784229734542, -63.19852021860618, 20.904623623275903, 15.630844366696959, 24.20190605265512, 29.856787346605692, -58.280990298074585, -39.54685829952358, 32.17868936227572, 14.955726617564952, -22.669688860708533, -65.70315290391832, -55.99804615479494, -33.75942807266869, -38.92458776131578, -49.82883956162024, 9.621153855410915, 27.419576144013313, -33.56294351416849, -25.494265560556677, -19.627099100217396, 23.18446720651018, 8.188291578483756, 30.294377054898717, -49.9095610217864, -53.004224980379654, -51.03783055390479, -56.46966337273537, 10.192259912395699, 29.220695108839685, 11.762991502047235, 1.4223933091580143, 43.056627498723174, 38.14170074192545, -57.0094393142256, -58.829146484977436, -39.02707947627267, -61.21128329059288, -50.31287215454951, -44.203864157953674, -50.39791188657264, -9.223403814832857, -22.75560348064772, -65.80285787512048, -51.30690945003027, -18.229290184568043, -34.81021799710691, -63.368848915310565, -30.14477693853491, -43.275915916389756, -19.870132190022524, -35.28897343618668, -42.10345983222933, -66.09546257113921, -41.80712885994733, -53.744215538060054, 28.283425158214012, 16.80611042630403, -21.519447788787048, -23.171939852119387, 21.93620147471742, 33.26551111821571, -38.70248834709684, -57.120447824005666, -53.04213046686585, -52.48883498196259, 18.67240887540556, 42.351313172836136, -54.623709056001736, -42.99958280512951, -12.011447647508426, -29.060414772308327, -51.33055661413418, -21.194312352352327, 13.500810275124365, 13.282413411950063, -19.91853479685725, -15.634363333627757, 18.648842655195914, 10.035766938767809, -41.48081757242053, -51.236725753367566, -50.875631012394834, -48.68850061137687, 32.055661855933785, 24.43724430758004, 34.06962097021727, 28.00378953427473, -36.29499656304759, -57.44992643426962, 26.219825074913615, 6.7026411232061776, -45.13108615567033, -34.017125215643226, -29.374632837291372, -25.732044261796368, -46.35106067089018, -34.92480807188626, -45.858949540957795, -47.02905473097905, -40.94442362224805, -53.376581028997315, -60.02023030454916, -33.29082958335518, -52.82790025509881, -15.636778671589617, 13.747446823842948, -0.15605726937813102, -20.355027668456962, -19.256972510764058, -31.976078941702923, -36.05466271873542, -39.47894422113987, -33.113851831695314, -34.335852498675365, -31.184782924401524, -40.09674390907604, -41.236359167781515, 7.94651353187276, 1.1576457584269377, -32.12735171235052, -40.17734019206678, -12.15371041853875, 13.919458969845852, 28.045911427801165, -21.81572199705092, -14.765465434951892, 3.6296491089943372, 9.375718216537187, 9.979367615334192, 33.352581823576855, 16.255993562772723, -3.4967377521751537, -4.72218303931556, 15.987533227079734, -47.63732631743058, -10.385223196182253, 7.801065577321893, -43.01541489829993, -29.53081275965944, -52.95435913943776, -47.56084877991616, -18.06343962054015, 17.979436048073577, -17.52475102692518, 16.70106000297345, -23.3390832221162, 4.58706755186831, -3.6026507889256116, -3.249294216486959, 9.804496867787456, -2.035693465433541, 20.653480529643424, -50.874886043529585, -8.794512486252394, 33.63219093211042, 8.625918208530969, 14.71139859159641, -21.392778375941315, 5.827193580810155, 37.1957929832011, 24.116433158016633, 20.64370832459986, 21.685924655501225, -32.51744233321555, -30.384334189545818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4323967551075644, "mean_inference_ms": 1.1446366372641334, "mean_action_processing_ms": 0.18570844376662132, "mean_env_wait_ms": 0.0763008064757729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033097267150878906, "StateBufferConnector_ms": 0.0024416446685791016, "ViewRequirementAgentConnector_ms": 0.06609165668487549}, "num_episodes": 10, "episode_return_max": 40.5991641203243, "episode_return_min": -57.91929289960149, "episode_return_mean": -14.630192019723257}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.18942432363167, "num_env_steps_trained_throughput_per_sec": 505.18942432363167, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 8054.366, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8054.333, "sample_time_ms": 754.013, "learn_time_ms": 7286.728, "learn_throughput": 548.943, "synch_weights_time_ms": 13.145}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 118, "trial_id": "83a5c_00000", "date": "2024-08-10_12-30-48", "timestamp": 1723307448, "time_this_iter_s": 7.922001838684082, "time_total_s": 1010.3992462158203, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcaca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1010.3992462158203, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 24.927272727272722, "ram_util_percent": 82.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6547946245266645, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.947121198845919, "policy_loss": -0.011641435078887279, "vf_loss": 3.9583960333829205, "vf_explained_var": -0.14334729250776704, "kl": 0.010849966425433065, "entropy": 0.884338526246409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8744235374499114, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.9412587963044645, "policy_loss": -0.005040148659706271, "vf_loss": 4.946284729490677, "vf_explained_var": -0.9931402660906314, "kl": 0.005984402819024432, "entropy": 0.3875887258288761, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "env_runners": {"episode_reward_max": 40.5991641203243, "episode_reward_min": -57.91929289960149, "episode_reward_mean": -12.62980858639627, "episode_len_mean": 346.48, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 34648, "policy_reward_min": {"agent_policy": -40.59916412032431, "adversary_policy": -66.09546257113921}, "policy_reward_max": {"agent_policy": 57.919292899601494, "adversary_policy": 45.83148638405474}, "policy_reward_mean": {"agent_policy": 12.62980858639627, "adversary_policy": -12.629808586396269}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.027966107368602, -44.888088467003136, 11.89081565341989, 5.7371589723769585, -19.906716735468663, -50.84430259891567, -49.688181257975764, 18.267733994986436, 27.029346699630413, -48.91392429879908, 23.567207989920316, -44.18642088231346, -44.8787371137318, -44.37671366146802, 18.520364999712108, -29.528604537362583, 1.7786840531463928, 19.24133431669123, -51.45689300108304, -53.75374696332008, 19.70647751061769, 6.592692405602623, 40.5991641203243, -57.91929289960149, -50.119181383432746, -47.25836815625156, -29.810657850702746, -44.27923067788415, -34.76809981729916, -49.08953345620874, -36.71034642746236, -27.579552813104588, -54.0994612016843, -47.77567219900373, 22.54476779225903, -22.345693820453217, 27.600856296466567, -47.91146808555122, -52.765482724414206, 30.511861024120854, -48.81164593056568, -20.535931209908377, -36.262434483243254, 13.391611843537216, -17.776449065242492, 14.342304796981866, -46.358771662894036, -49.78206581188582, 28.24645308175692, 31.036705252246, -46.8724614986586, 16.461233099059896, -39.574105685656804, -27.553338549543863, -40.63793437138825, -46.44400213596836, -47.16050232562273, -46.655529943952196, -34.23233946334428, 6.795694777232408, -19.806000089610514, -34.01537083021924, -36.29639802641762, -32.76031771153851, -40.6665515384288, 4.552079645149849, -36.15234595220864, 0.8828742756535508, 3.115094715375122, -5.567908162978778, 9.67754291593569, 24.804287693174754, -4.109460395745344, -15.824896545175434, -1.2920788094301798, -36.27311382897966, -50.25760395967698, -0.04200178623328732, -0.41184551197587105, -9.376007835123946, -3.4259725027062755, 3.884401701176957, -15.110702756943084, 12.418839222929016, 11.66865840006369, -7.782792397565581, 30.65611307060889, 21.16481649005056, -31.450888261380683, 13.645634819311484, 27.235720105638446, 22.232174021909596, 11.250632429421552, 22.084650152008415, 24.714908045276147, 36.34201369628608, 18.25573928019908, 27.189962117624056, 13.325019439599965, 19.1616844062309], "episode_lengths": [16, 400, 82, 54, 400, 400, 400, 85, 292, 400, 250, 400, 400, 400, 128, 400, 17, 162, 400, 400, 62, 18, 276, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 231, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 356, 400, 400, 400, 347, 142, 400], "policy_agent_policy_reward": [-9.027966107368602, 44.88808846700314, -11.890815653419885, -5.7371589723769585, 19.906716735468663, 50.844302598915675, 49.68818125797577, -18.26773399498643, -27.029346699630402, 48.913924298799074, -23.567207989920323, 44.18642088231347, 44.87873711373181, 44.37671366146804, -18.52036499971211, 29.528604537362583, -1.7786840531463923, -19.241334316691233, 51.45689300108303, 53.75374696332009, -19.706477510617688, -6.592692405602625, -40.59916412032431, 57.919292899601494, 50.11918138343274, 47.25836815625155, 29.81065785070275, 44.27923067788416, 34.76809981729916, 49.089533456208734, 36.71034642746237, 27.579552813104595, 54.09946120168428, 47.775672199003736, -22.544767792259027, 22.345693820453217, -27.600856296466553, 47.9114680855512, 52.7654827244142, -30.511861024120844, 48.81164593056569, 20.535931209908377, 36.26243448324327, -13.391611843537216, 17.776449065242492, -14.342304796981868, 46.35877166289403, 49.78206581188583, -28.246453081756904, -31.036705252245994, 46.872461498658595, -16.461233099059896, 39.5741056856568, 27.55333854954387, 40.637934371388255, 46.444002135968354, 47.16050232562274, 46.65552994395219, 34.23233946334426, -6.795694777232413, 19.80600008961051, 34.01537083021922, 36.29639802641761, 32.76031771153852, 40.666551538428806, -4.552079645149847, 36.15234595220865, -0.8828742756535508, -3.115094715375122, 5.567908162978777, -9.67754291593569, -24.80428769317477, 4.109460395745353, 15.82489654517543, 1.2920788094301798, 36.27311382897965, 50.257603959676985, 0.04200178623328732, 0.41184551197586217, 9.376007835123938, 3.425972502706296, -3.884401701176956, 15.110702756943084, -12.418839222929016, -11.668658400063688, 7.782792397565586, -30.656113070608857, -21.164816490050548, 31.450888261380683, -13.64563481931148, -27.235720105638464, -22.232174021909607, -11.250632429421561, -22.08465015200843, -24.714908045276136, -36.34201369628604, -18.255739280199087, -27.18996211762406, -13.325019439599966, -19.161684406230894], "policy_adversary_policy_reward": [5.213436717740029, 12.842495496997179, -61.609456888110046, -28.166720045896312, 6.448979293081873, 17.332652013757894, 0.4644073165790985, 11.009910628174818, -30.196912144758493, -9.616521326178844, -49.54978456370789, -52.138820634123455, -36.17784229734542, -63.19852021860618, 20.904623623275903, 15.630844366696959, 24.20190605265512, 29.856787346605692, -58.280990298074585, -39.54685829952358, 32.17868936227572, 14.955726617564952, -22.669688860708533, -65.70315290391832, -55.99804615479494, -33.75942807266869, -38.92458776131578, -49.82883956162024, 9.621153855410915, 27.419576144013313, -33.56294351416849, -25.494265560556677, -19.627099100217396, 23.18446720651018, 8.188291578483756, 30.294377054898717, -49.9095610217864, -53.004224980379654, -51.03783055390479, -56.46966337273537, 10.192259912395699, 29.220695108839685, 11.762991502047235, 1.4223933091580143, 43.056627498723174, 38.14170074192545, -57.0094393142256, -58.829146484977436, -39.02707947627267, -61.21128329059288, -50.31287215454951, -44.203864157953674, -50.39791188657264, -9.223403814832857, -22.75560348064772, -65.80285787512048, -51.30690945003027, -18.229290184568043, -34.81021799710691, -63.368848915310565, -30.14477693853491, -43.275915916389756, -19.870132190022524, -35.28897343618668, -42.10345983222933, -66.09546257113921, -41.80712885994733, -53.744215538060054, 28.283425158214012, 16.80611042630403, -21.519447788787048, -23.171939852119387, 21.93620147471742, 33.26551111821571, -38.70248834709684, -57.120447824005666, -53.04213046686585, -52.48883498196259, 18.67240887540556, 42.351313172836136, -54.623709056001736, -42.99958280512951, -12.011447647508426, -29.060414772308327, -51.33055661413418, -21.194312352352327, 13.500810275124365, 13.282413411950063, -19.91853479685725, -15.634363333627757, 18.648842655195914, 10.035766938767809, -41.48081757242053, -51.236725753367566, -50.875631012394834, -48.68850061137687, 32.055661855933785, 24.43724430758004, 34.06962097021727, 28.00378953427473, -36.29499656304759, -57.44992643426962, 26.219825074913615, 6.7026411232061776, -45.13108615567033, -34.017125215643226, -29.374632837291372, -25.732044261796368, -46.35106067089018, -34.92480807188626, -45.858949540957795, -47.02905473097905, -40.94442362224805, -53.376581028997315, -60.02023030454916, -33.29082958335518, -52.82790025509881, -15.636778671589617, 13.747446823842948, -0.15605726937813102, -20.355027668456962, -19.256972510764058, -31.976078941702923, -36.05466271873542, -39.47894422113987, -33.113851831695314, -34.335852498675365, -31.184782924401524, -40.09674390907604, -41.236359167781515, 7.94651353187276, 1.1576457584269377, -32.12735171235052, -40.17734019206678, -12.15371041853875, 13.919458969845852, 28.045911427801165, -21.81572199705092, -14.765465434951892, 3.6296491089943372, 9.375718216537187, 9.979367615334192, 33.352581823576855, 16.255993562772723, -3.4967377521751537, -4.72218303931556, 15.987533227079734, -47.63732631743058, -10.385223196182253, 7.801065577321893, -43.01541489829993, -29.53081275965944, -52.95435913943776, -47.56084877991616, -18.06343962054015, 17.979436048073577, -17.52475102692518, 16.70106000297345, -23.3390832221162, 4.58706755186831, -3.6026507889256116, -3.249294216486959, 9.804496867787456, -2.035693465433541, 20.653480529643424, -50.874886043529585, -8.794512486252394, 33.63219093211042, 8.625918208530969, 14.71139859159641, -21.392778375941315, 5.827193580810155, 37.1957929832011, 24.116433158016633, 20.64370832459986, 21.685924655501225, -32.51744233321555, -30.384334189545818, 25.944063173040025, 1.3472064655829534, 36.95331606015099, 17.518124151125956, 43.79043864814437, 0.6739093956748494, 18.712353478123816, 3.7889113807192984, 23.35672578064053, 20.812574523376306, 31.081187056751205, 18.34862903380108, 26.852541008517363, 45.83148638405474, 28.167561284105155, 8.343917276293013, 13.229547363845931, 41.15037687140216, 10.011861302340682, 16.638177576859242, 8.459535820609542, 29.863832991852263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4319392310665818, "mean_inference_ms": 1.1428322724482602, "mean_action_processing_ms": 0.18549831225201788, "mean_env_wait_ms": 0.07617260730911095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033153295516967773, "StateBufferConnector_ms": 0.0023963451385498047, "ViewRequirementAgentConnector_ms": 0.06607997417449951}, "num_episodes": 11, "episode_return_max": 40.5991641203243, "episode_return_min": -57.91929289960149, "episode_return_mean": -12.62980858639627}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.6559402465146, "num_env_steps_trained_throughput_per_sec": 458.6559402465146, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 8110.449, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8110.417, "sample_time_ms": 745.68, "learn_time_ms": 7351.068, "learn_throughput": 544.139, "synch_weights_time_ms": 13.213}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "training_iteration": 119, "trial_id": "83a5c_00000", "date": "2024-08-10_12-30-57", "timestamp": 1723307457, "time_this_iter_s": 8.732190370559692, "time_total_s": 1019.13143658638, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcacee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1019.13143658638, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 30.7, "ram_util_percent": 82.28333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2932804175154873, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.435975407040308, "policy_loss": -0.005630002389834435, "vf_loss": 4.441354621150507, "vf_explained_var": -0.21972553774162576, "kl": 0.007422554079464612, "entropy": 0.839514482620532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.95561448202158, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.314643160750468, "policy_loss": -0.00782312178441013, "vf_loss": 5.322440016269684, "vf_explained_var": -0.8543617818504572, "kl": 0.011055042094607927, "entropy": 0.5665327734003465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 40.5991641203243, "episode_reward_min": -57.91929289960149, "episode_reward_mean": -7.4267404046744385, "episode_len_mean": 343.72, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 34372, "policy_reward_min": {"agent_policy": -40.59916412032431, "adversary_policy": -66.09546257113921}, "policy_reward_max": {"agent_policy": 57.919292899601494, "adversary_policy": 45.83148638405474}, "policy_reward_mean": {"agent_policy": 7.4267404046744385, "adversary_policy": -7.426740404674436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.528604537362583, 1.7786840531463928, 19.24133431669123, -51.45689300108304, -53.75374696332008, 19.70647751061769, 6.592692405602623, 40.5991641203243, -57.91929289960149, -50.119181383432746, -47.25836815625156, -29.810657850702746, -44.27923067788415, -34.76809981729916, -49.08953345620874, -36.71034642746236, -27.579552813104588, -54.0994612016843, -47.77567219900373, 22.54476779225903, -22.345693820453217, 27.600856296466567, -47.91146808555122, -52.765482724414206, 30.511861024120854, -48.81164593056568, -20.535931209908377, -36.262434483243254, 13.391611843537216, -17.776449065242492, 14.342304796981866, -46.358771662894036, -49.78206581188582, 28.24645308175692, 31.036705252246, -46.8724614986586, 16.461233099059896, -39.574105685656804, -27.553338549543863, -40.63793437138825, -46.44400213596836, -47.16050232562273, -46.655529943952196, -34.23233946334428, 6.795694777232408, -19.806000089610514, -34.01537083021924, -36.29639802641762, -32.76031771153851, -40.6665515384288, 4.552079645149849, -36.15234595220864, 0.8828742756535508, 3.115094715375122, -5.567908162978778, 9.67754291593569, 24.804287693174754, -4.109460395745344, -15.824896545175434, -1.2920788094301798, -36.27311382897966, -50.25760395967698, -0.04200178623328732, -0.41184551197587105, -9.376007835123946, -3.4259725027062755, 3.884401701176957, -15.110702756943084, 12.418839222929016, 11.66865840006369, -7.782792397565581, 30.65611307060889, 21.16481649005056, -31.450888261380683, 13.645634819311484, 27.235720105638446, 22.232174021909596, 11.250632429421552, 22.084650152008415, 24.714908045276147, 36.34201369628608, 18.25573928019908, 27.189962117624056, 13.325019439599965, 19.1616844062309, 30.533146276594003, 23.85248885550261, 12.530046313289949, 29.566095656636627, 7.085328372979533, 20.079369897730764, 16.200989627758332, 28.718053577355654, 20.205245017183046, 10.509272794655123, 25.021252674586545, 21.041553441586863, 4.4696967985489, 23.543380652913516, 13.308407616600935], "episode_lengths": [400, 17, 162, 400, 400, 62, 18, 276, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 231, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 356, 400, 400, 400, 347, 142, 400, 256, 236, 46, 172, 391, 350, 219, 126, 400, 400, 386, 230, 116, 400, 103], "policy_agent_policy_reward": [29.528604537362583, -1.7786840531463923, -19.241334316691233, 51.45689300108303, 53.75374696332009, -19.706477510617688, -6.592692405602625, -40.59916412032431, 57.919292899601494, 50.11918138343274, 47.25836815625155, 29.81065785070275, 44.27923067788416, 34.76809981729916, 49.089533456208734, 36.71034642746237, 27.579552813104595, 54.09946120168428, 47.775672199003736, -22.544767792259027, 22.345693820453217, -27.600856296466553, 47.9114680855512, 52.7654827244142, -30.511861024120844, 48.81164593056569, 20.535931209908377, 36.26243448324327, -13.391611843537216, 17.776449065242492, -14.342304796981868, 46.35877166289403, 49.78206581188583, -28.246453081756904, -31.036705252245994, 46.872461498658595, -16.461233099059896, 39.5741056856568, 27.55333854954387, 40.637934371388255, 46.444002135968354, 47.16050232562274, 46.65552994395219, 34.23233946334426, -6.795694777232413, 19.80600008961051, 34.01537083021922, 36.29639802641761, 32.76031771153852, 40.666551538428806, -4.552079645149847, 36.15234595220865, -0.8828742756535508, -3.115094715375122, 5.567908162978777, -9.67754291593569, -24.80428769317477, 4.109460395745353, 15.82489654517543, 1.2920788094301798, 36.27311382897965, 50.257603959676985, 0.04200178623328732, 0.41184551197586217, 9.376007835123938, 3.425972502706296, -3.884401701176956, 15.110702756943084, -12.418839222929016, -11.668658400063688, 7.782792397565586, -30.656113070608857, -21.164816490050548, 31.450888261380683, -13.64563481931148, -27.235720105638464, -22.232174021909607, -11.250632429421561, -22.08465015200843, -24.714908045276136, -36.34201369628604, -18.255739280199087, -27.18996211762406, -13.325019439599966, -19.161684406230894, -30.533146276593975, -23.8524888555026, -12.530046313289953, -29.566095656636637, -7.085328372979539, -20.079369897730775, -16.20098962775834, -28.718053577355654, -20.20524501718305, -10.509272794655127, -25.021252674586542, -21.041553441586863, -4.4696967985489, -23.54338065291354, -13.308407616600933], "policy_adversary_policy_reward": [-33.56294351416849, -25.494265560556677, -19.627099100217396, 23.18446720651018, 8.188291578483756, 30.294377054898717, -49.9095610217864, -53.004224980379654, -51.03783055390479, -56.46966337273537, 10.192259912395699, 29.220695108839685, 11.762991502047235, 1.4223933091580143, 43.056627498723174, 38.14170074192545, -57.0094393142256, -58.829146484977436, -39.02707947627267, -61.21128329059288, -50.31287215454951, -44.203864157953674, -50.39791188657264, -9.223403814832857, -22.75560348064772, -65.80285787512048, -51.30690945003027, -18.229290184568043, -34.81021799710691, -63.368848915310565, -30.14477693853491, -43.275915916389756, -19.870132190022524, -35.28897343618668, -42.10345983222933, -66.09546257113921, -41.80712885994733, -53.744215538060054, 28.283425158214012, 16.80611042630403, -21.519447788787048, -23.171939852119387, 21.93620147471742, 33.26551111821571, -38.70248834709684, -57.120447824005666, -53.04213046686585, -52.48883498196259, 18.67240887540556, 42.351313172836136, -54.623709056001736, -42.99958280512951, -12.011447647508426, -29.060414772308327, -51.33055661413418, -21.194312352352327, 13.500810275124365, 13.282413411950063, -19.91853479685725, -15.634363333627757, 18.648842655195914, 10.035766938767809, -41.48081757242053, -51.236725753367566, -50.875631012394834, -48.68850061137687, 32.055661855933785, 24.43724430758004, 34.06962097021727, 28.00378953427473, -36.29499656304759, -57.44992643426962, 26.219825074913615, 6.7026411232061776, -45.13108615567033, -34.017125215643226, -29.374632837291372, -25.732044261796368, -46.35106067089018, -34.92480807188626, -45.858949540957795, -47.02905473097905, -40.94442362224805, -53.376581028997315, -60.02023030454916, -33.29082958335518, -52.82790025509881, -15.636778671589617, 13.747446823842948, -0.15605726937813102, -20.355027668456962, -19.256972510764058, -31.976078941702923, -36.05466271873542, -39.47894422113987, -33.113851831695314, -34.335852498675365, -31.184782924401524, -40.09674390907604, -41.236359167781515, 7.94651353187276, 1.1576457584269377, -32.12735171235052, -40.17734019206678, -12.15371041853875, 13.919458969845852, 28.045911427801165, -21.81572199705092, -14.765465434951892, 3.6296491089943372, 9.375718216537187, 9.979367615334192, 33.352581823576855, 16.255993562772723, -3.4967377521751537, -4.72218303931556, 15.987533227079734, -47.63732631743058, -10.385223196182253, 7.801065577321893, -43.01541489829993, -29.53081275965944, -52.95435913943776, -47.56084877991616, -18.06343962054015, 17.979436048073577, -17.52475102692518, 16.70106000297345, -23.3390832221162, 4.58706755186831, -3.6026507889256116, -3.249294216486959, 9.804496867787456, -2.035693465433541, 20.653480529643424, -50.874886043529585, -8.794512486252394, 33.63219093211042, 8.625918208530969, 14.71139859159641, -21.392778375941315, 5.827193580810155, 37.1957929832011, 24.116433158016633, 20.64370832459986, 21.685924655501225, -32.51744233321555, -30.384334189545818, 25.944063173040025, 1.3472064655829534, 36.95331606015099, 17.518124151125956, 43.79043864814437, 0.6739093956748494, 18.712353478123816, 3.7889113807192984, 23.35672578064053, 20.812574523376306, 31.081187056751205, 18.34862903380108, 26.852541008517363, 45.83148638405474, 28.167561284105155, 8.343917276293013, 13.229547363845931, 41.15037687140216, 10.011861302340682, 16.638177576859242, 8.459535820609542, 29.863832991852263, 19.34577319934295, 41.72051935384502, 5.299909916519102, 42.40506779448611, 9.28626938544205, 15.77382324113785, 23.204944378239432, 35.92724693503385, 3.7289461211083044, 10.441710624850778, 19.65408421179363, 20.50465558366792, 17.716780449619257, 14.685198805897425, 37.58082471105023, 19.855282443661075, 24.892889732942727, 15.517600301423379, 5.463724142587923, 15.554821446722343, 43.7439860352102, 6.298519313962825, 30.268846065102213, 11.814260818071528, 22.637486036772962, -13.698092439675165, 32.29779611140646, 14.788965194420584, 18.493105370960098, 8.12370986224177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43119850938009835, "mean_inference_ms": 1.1409679828069261, "mean_action_processing_ms": 0.18521663698147742, "mean_env_wait_ms": 0.07600985471813765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003309488296508789, "StateBufferConnector_ms": 0.002401113510131836, "ViewRequirementAgentConnector_ms": 0.0659860372543335}, "num_episodes": 15, "episode_return_max": 40.5991641203243, "episode_return_min": -57.91929289960149, "episode_return_mean": -7.4267404046744385}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 473.23698363301475, "num_env_steps_trained_throughput_per_sec": 473.23698363301475, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 8155.844, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8155.809, "sample_time_ms": 748.115, "learn_time_ms": 7394.169, "learn_throughput": 540.967, "synch_weights_time_ms": 13.097}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 120, "trial_id": "83a5c_00000", "date": "2024-08-10_12-31-05", "timestamp": 1723307465, "time_this_iter_s": 8.45736813545227, "time_total_s": 1027.5888047218323, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb63d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1027.5888047218323, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 28.933333333333337, "ram_util_percent": 82.50000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1791016789971205, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.2613034952254525, "policy_loss": -0.0057800136920478605, "vf_loss": 4.266854972814126, "vf_explained_var": 0.056477097544089826, "kl": 0.0067637633239405436, "entropy": 0.7731101765834465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.174947019511213, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.925482335935036, "policy_loss": -0.006058784039487364, "vf_loss": 4.9315193682909015, "vf_explained_var": -0.9988253772258758, "kl": 0.009158424410642466, "entropy": 0.5719993277142446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "env_runners": {"episode_reward_max": 42.351357290774814, "episode_reward_min": -54.0994612016843, "episode_reward_mean": -0.0781998789481969, "episode_len_mean": 337.82, "episode_media": {}, "episodes_this_iter": 16, "episodes_timesteps_total": 33782, "policy_reward_min": {"agent_policy": -42.35135729077482, "adversary_policy": -66.09546257113921}, "policy_reward_max": {"agent_policy": 54.09946120168428, "adversary_policy": 45.83148638405474}, "policy_reward_mean": {"agent_policy": 0.07819987894819683, "adversary_policy": -0.07819987894819519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.579552813104588, -54.0994612016843, -47.77567219900373, 22.54476779225903, -22.345693820453217, 27.600856296466567, -47.91146808555122, -52.765482724414206, 30.511861024120854, -48.81164593056568, -20.535931209908377, -36.262434483243254, 13.391611843537216, -17.776449065242492, 14.342304796981866, -46.358771662894036, -49.78206581188582, 28.24645308175692, 31.036705252246, -46.8724614986586, 16.461233099059896, -39.574105685656804, -27.553338549543863, -40.63793437138825, -46.44400213596836, -47.16050232562273, -46.655529943952196, -34.23233946334428, 6.795694777232408, -19.806000089610514, -34.01537083021924, -36.29639802641762, -32.76031771153851, -40.6665515384288, 4.552079645149849, -36.15234595220864, 0.8828742756535508, 3.115094715375122, -5.567908162978778, 9.67754291593569, 24.804287693174754, -4.109460395745344, -15.824896545175434, -1.2920788094301798, -36.27311382897966, -50.25760395967698, -0.04200178623328732, -0.41184551197587105, -9.376007835123946, -3.4259725027062755, 3.884401701176957, -15.110702756943084, 12.418839222929016, 11.66865840006369, -7.782792397565581, 30.65611307060889, 21.16481649005056, -31.450888261380683, 13.645634819311484, 27.235720105638446, 22.232174021909596, 11.250632429421552, 22.084650152008415, 24.714908045276147, 36.34201369628608, 18.25573928019908, 27.189962117624056, 13.325019439599965, 19.1616844062309, 30.533146276594003, 23.85248885550261, 12.530046313289949, 29.566095656636627, 7.085328372979533, 20.079369897730764, 16.200989627758332, 28.718053577355654, 20.205245017183046, 10.509272794655123, 25.021252674586545, 21.041553441586863, 4.4696967985489, 23.543380652913516, 13.308407616600935, -20.472036916677165, 29.825211760655577, 24.417331779199326, 22.55890989194578, 8.49870511823913, 19.749165228915004, 29.962647730965543, 17.037214112701385, 19.785034873937267, 24.962221423012146, 10.409166342682294, 22.7797886745257, 19.20622976122322, 35.062122596831365, 31.945380139466376, 42.351357290774814], "episode_lengths": [400, 400, 400, 231, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 34, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 356, 400, 400, 400, 347, 142, 400, 256, 236, 46, 172, 391, 350, 219, 126, 400, 400, 386, 230, 116, 400, 103, 400, 205, 346, 323, 30, 253, 400, 148, 122, 221, 183, 365, 382, 400, 167, 400], "policy_agent_policy_reward": [27.579552813104595, 54.09946120168428, 47.775672199003736, -22.544767792259027, 22.345693820453217, -27.600856296466553, 47.9114680855512, 52.7654827244142, -30.511861024120844, 48.81164593056569, 20.535931209908377, 36.26243448324327, -13.391611843537216, 17.776449065242492, -14.342304796981868, 46.35877166289403, 49.78206581188583, -28.246453081756904, -31.036705252245994, 46.872461498658595, -16.461233099059896, 39.5741056856568, 27.55333854954387, 40.637934371388255, 46.444002135968354, 47.16050232562274, 46.65552994395219, 34.23233946334426, -6.795694777232413, 19.80600008961051, 34.01537083021922, 36.29639802641761, 32.76031771153852, 40.666551538428806, -4.552079645149847, 36.15234595220865, -0.8828742756535508, -3.115094715375122, 5.567908162978777, -9.67754291593569, -24.80428769317477, 4.109460395745353, 15.82489654517543, 1.2920788094301798, 36.27311382897965, 50.257603959676985, 0.04200178623328732, 0.41184551197586217, 9.376007835123938, 3.425972502706296, -3.884401701176956, 15.110702756943084, -12.418839222929016, -11.668658400063688, 7.782792397565586, -30.656113070608857, -21.164816490050548, 31.450888261380683, -13.64563481931148, -27.235720105638464, -22.232174021909607, -11.250632429421561, -22.08465015200843, -24.714908045276136, -36.34201369628604, -18.255739280199087, -27.18996211762406, -13.325019439599966, -19.161684406230894, -30.533146276593975, -23.8524888555026, -12.530046313289953, -29.566095656636637, -7.085328372979539, -20.079369897730775, -16.20098962775834, -28.718053577355654, -20.20524501718305, -10.509272794655127, -25.021252674586542, -21.041553441586863, -4.4696967985489, -23.54338065291354, -13.308407616600933, 20.472036916677173, -29.825211760655545, -24.417331779199337, -22.55890989194578, -8.498705118239128, -19.749165228915018, -29.962647730965532, -17.037214112701385, -19.785034873937263, -24.962221423012146, -10.40916634268229, -22.779788674525708, -19.20622976122325, -35.062122596831365, -31.945380139466355, -42.35135729077482], "policy_adversary_policy_reward": [-19.870132190022524, -35.28897343618668, -42.10345983222933, -66.09546257113921, -41.80712885994733, -53.744215538060054, 28.283425158214012, 16.80611042630403, -21.519447788787048, -23.171939852119387, 21.93620147471742, 33.26551111821571, -38.70248834709684, -57.120447824005666, -53.04213046686585, -52.48883498196259, 18.67240887540556, 42.351313172836136, -54.623709056001736, -42.99958280512951, -12.011447647508426, -29.060414772308327, -51.33055661413418, -21.194312352352327, 13.500810275124365, 13.282413411950063, -19.91853479685725, -15.634363333627757, 18.648842655195914, 10.035766938767809, -41.48081757242053, -51.236725753367566, -50.875631012394834, -48.68850061137687, 32.055661855933785, 24.43724430758004, 34.06962097021727, 28.00378953427473, -36.29499656304759, -57.44992643426962, 26.219825074913615, 6.7026411232061776, -45.13108615567033, -34.017125215643226, -29.374632837291372, -25.732044261796368, -46.35106067089018, -34.92480807188626, -45.858949540957795, -47.02905473097905, -40.94442362224805, -53.376581028997315, -60.02023030454916, -33.29082958335518, -52.82790025509881, -15.636778671589617, 13.747446823842948, -0.15605726937813102, -20.355027668456962, -19.256972510764058, -31.976078941702923, -36.05466271873542, -39.47894422113987, -33.113851831695314, -34.335852498675365, -31.184782924401524, -40.09674390907604, -41.236359167781515, 7.94651353187276, 1.1576457584269377, -32.12735171235052, -40.17734019206678, -12.15371041853875, 13.919458969845852, 28.045911427801165, -21.81572199705092, -14.765465434951892, 3.6296491089943372, 9.375718216537187, 9.979367615334192, 33.352581823576855, 16.255993562772723, -3.4967377521751537, -4.72218303931556, 15.987533227079734, -47.63732631743058, -10.385223196182253, 7.801065577321893, -43.01541489829993, -29.53081275965944, -52.95435913943776, -47.56084877991616, -18.06343962054015, 17.979436048073577, -17.52475102692518, 16.70106000297345, -23.3390832221162, 4.58706755186831, -3.6026507889256116, -3.249294216486959, 9.804496867787456, -2.035693465433541, 20.653480529643424, -50.874886043529585, -8.794512486252394, 33.63219093211042, 8.625918208530969, 14.71139859159641, -21.392778375941315, 5.827193580810155, 37.1957929832011, 24.116433158016633, 20.64370832459986, 21.685924655501225, -32.51744233321555, -30.384334189545818, 25.944063173040025, 1.3472064655829534, 36.95331606015099, 17.518124151125956, 43.79043864814437, 0.6739093956748494, 18.712353478123816, 3.7889113807192984, 23.35672578064053, 20.812574523376306, 31.081187056751205, 18.34862903380108, 26.852541008517363, 45.83148638405474, 28.167561284105155, 8.343917276293013, 13.229547363845931, 41.15037687140216, 10.011861302340682, 16.638177576859242, 8.459535820609542, 29.863832991852263, 19.34577319934295, 41.72051935384502, 5.299909916519102, 42.40506779448611, 9.28626938544205, 15.77382324113785, 23.204944378239432, 35.92724693503385, 3.7289461211083044, 10.441710624850778, 19.65408421179363, 20.50465558366792, 17.716780449619257, 14.685198805897425, 37.58082471105023, 19.855282443661075, 24.892889732942727, 15.517600301423379, 5.463724142587923, 15.554821446722343, 43.7439860352102, 6.298519313962825, 30.268846065102213, 11.814260818071528, 22.637486036772962, -13.698092439675165, 32.29779611140646, 14.788965194420584, 18.493105370960098, 8.12370986224177, -9.385222092415972, -31.558851740938366, 28.054299772027825, 31.59612374928332, 22.217678474587416, 26.61698508381125, 16.846352070530557, 28.271467713360984, -18.53372469683075, 35.531134933309005, 14.407099324304905, 25.091231133525113, 21.67889805845838, 38.24639740347265, 11.363175062462076, 22.71125316294069, 18.511506509788664, 21.058563238085878, 15.096407064347556, 34.82803578167673, 17.76443354863798, 3.053899136726603, 17.80205348707806, 27.75752386197335, 13.695833974742985, 24.71662554770349, 27.765076552460926, 42.359168641201784, 31.047332141903563, 32.84342813702918, 42.37859640271751, 42.32411817883209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4306311079308084, "mean_inference_ms": 1.1392950082763833, "mean_action_processing_ms": 0.18500310230580072, "mean_env_wait_ms": 0.07588027033568351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034552812576293945, "StateBufferConnector_ms": 0.0024138689041137695, "ViewRequirementAgentConnector_ms": 0.06617593765258789}, "num_episodes": 16, "episode_return_max": 42.351357290774814, "episode_return_min": -54.0994612016843, "episode_return_mean": -0.0781998789481969}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.0326179896122, "num_env_steps_trained_throughput_per_sec": 496.0326179896122, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 8166.616, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8166.581, "sample_time_ms": 747.113, "learn_time_ms": 7405.577, "learn_throughput": 540.134, "synch_weights_time_ms": 13.46}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "training_iteration": 121, "trial_id": "83a5c_00000", "date": "2024-08-10_12-31-13", "timestamp": 1723307473, "time_this_iter_s": 8.06859278678894, "time_total_s": 1035.6573975086212, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faad940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1035.6573975086212, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 25.775000000000002, "ram_util_percent": 82.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0397254836307, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.13714844915602, "policy_loss": -0.0025821024855037056, "vf_loss": 5.1395052648725965, "vf_explained_var": -0.15331307778913508, "kl": 0.006667787310179689, "entropy": 0.7318741398829001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.706903946834306, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.859018495430549, "policy_loss": -0.005265023270718909, "vf_loss": 4.864250456045071, "vf_explained_var": 0.019851117891569934, "kl": 0.013926474772868383, "entropy": 0.506525195731471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": 47.640480621280716, "episode_reward_min": -50.25760395967698, "episode_reward_mean": 5.513305027239502, "episode_len_mean": 318.18, "episode_media": {}, "episodes_this_iter": 15, "episodes_timesteps_total": 31818, "policy_reward_min": {"agent_policy": -47.640480621280716, "adversary_policy": -60.02023030454916}, "policy_reward_max": {"agent_policy": 50.257603959676985, "adversary_policy": 56.7260622988629}, "policy_reward_mean": {"agent_policy": -5.513305027239503, "adversary_policy": 5.513305027239506}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.358771662894036, -49.78206581188582, 28.24645308175692, 31.036705252246, -46.8724614986586, 16.461233099059896, -39.574105685656804, -27.553338549543863, -40.63793437138825, -46.44400213596836, -47.16050232562273, -46.655529943952196, -34.23233946334428, 6.795694777232408, -19.806000089610514, -34.01537083021924, -36.29639802641762, -32.76031771153851, -40.6665515384288, 4.552079645149849, -36.15234595220864, 0.8828742756535508, 3.115094715375122, -5.567908162978778, 9.67754291593569, 24.804287693174754, -4.109460395745344, -15.824896545175434, -1.2920788094301798, -36.27311382897966, -50.25760395967698, -0.04200178623328732, -0.41184551197587105, -9.376007835123946, -3.4259725027062755, 3.884401701176957, -15.110702756943084, 12.418839222929016, 11.66865840006369, -7.782792397565581, 30.65611307060889, 21.16481649005056, -31.450888261380683, 13.645634819311484, 27.235720105638446, 22.232174021909596, 11.250632429421552, 22.084650152008415, 24.714908045276147, 36.34201369628608, 18.25573928019908, 27.189962117624056, 13.325019439599965, 19.1616844062309, 30.533146276594003, 23.85248885550261, 12.530046313289949, 29.566095656636627, 7.085328372979533, 20.079369897730764, 16.200989627758332, 28.718053577355654, 20.205245017183046, 10.509272794655123, 25.021252674586545, 21.041553441586863, 4.4696967985489, 23.543380652913516, 13.308407616600935, -20.472036916677165, 29.825211760655577, 24.417331779199326, 22.55890989194578, 8.49870511823913, 19.749165228915004, 29.962647730965543, 17.037214112701385, 19.785034873937267, 24.962221423012146, 10.409166342682294, 22.7797886745257, 19.20622976122322, 35.062122596831365, 31.945380139466376, 42.351357290774814, 28.56579245420209, 24.943453132504864, -22.520506441025265, 41.001295329336166, 38.81557013664509, 47.640480621280716, 33.7044480846748, 26.724579571805446, -49.786299885687974, 18.44085907782548, 19.878019254155827, 9.55568627937105, 25.053339285806913, 41.8837924724705, 7.777591465598629], "episode_lengths": [400, 400, 34, 400, 400, 43, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 356, 400, 400, 400, 347, 142, 400, 256, 236, 46, 172, 391, 350, 219, 126, 400, 400, 386, 230, 116, 400, 103, 400, 205, 346, 323, 30, 253, 400, 148, 122, 221, 183, 365, 382, 400, 167, 400, 300, 191, 400, 324, 400, 222, 281, 196, 400, 156, 217, 166, 223, 367, 24], "policy_agent_policy_reward": [46.35877166289403, 49.78206581188583, -28.246453081756904, -31.036705252245994, 46.872461498658595, -16.461233099059896, 39.5741056856568, 27.55333854954387, 40.637934371388255, 46.444002135968354, 47.16050232562274, 46.65552994395219, 34.23233946334426, -6.795694777232413, 19.80600008961051, 34.01537083021922, 36.29639802641761, 32.76031771153852, 40.666551538428806, -4.552079645149847, 36.15234595220865, -0.8828742756535508, -3.115094715375122, 5.567908162978777, -9.67754291593569, -24.80428769317477, 4.109460395745353, 15.82489654517543, 1.2920788094301798, 36.27311382897965, 50.257603959676985, 0.04200178623328732, 0.41184551197586217, 9.376007835123938, 3.425972502706296, -3.884401701176956, 15.110702756943084, -12.418839222929016, -11.668658400063688, 7.782792397565586, -30.656113070608857, -21.164816490050548, 31.450888261380683, -13.64563481931148, -27.235720105638464, -22.232174021909607, -11.250632429421561, -22.08465015200843, -24.714908045276136, -36.34201369628604, -18.255739280199087, -27.18996211762406, -13.325019439599966, -19.161684406230894, -30.533146276593975, -23.8524888555026, -12.530046313289953, -29.566095656636637, -7.085328372979539, -20.079369897730775, -16.20098962775834, -28.718053577355654, -20.20524501718305, -10.509272794655127, -25.021252674586542, -21.041553441586863, -4.4696967985489, -23.54338065291354, -13.308407616600933, 20.472036916677173, -29.825211760655545, -24.417331779199337, -22.55890989194578, -8.498705118239128, -19.749165228915018, -29.962647730965532, -17.037214112701385, -19.785034873937263, -24.962221423012146, -10.40916634268229, -22.779788674525708, -19.20622976122325, -35.062122596831365, -31.945380139466355, -42.35135729077482, -28.56579245420205, -24.943453132504885, 22.520506441025265, -41.00129532933615, -38.81557013664515, -47.640480621280716, -33.70444808467479, -26.724579571805442, 49.78629988568798, -18.440859077825486, -19.878019254155824, -9.555686279371054, -25.053339285806913, -41.88379247247049, -7.777591465598632], "policy_adversary_policy_reward": [-41.48081757242053, -51.236725753367566, -50.875631012394834, -48.68850061137687, 32.055661855933785, 24.43724430758004, 34.06962097021727, 28.00378953427473, -36.29499656304759, -57.44992643426962, 26.219825074913615, 6.7026411232061776, -45.13108615567033, -34.017125215643226, -29.374632837291372, -25.732044261796368, -46.35106067089018, -34.92480807188626, -45.858949540957795, -47.02905473097905, -40.94442362224805, -53.376581028997315, -60.02023030454916, -33.29082958335518, -52.82790025509881, -15.636778671589617, 13.747446823842948, -0.15605726937813102, -20.355027668456962, -19.256972510764058, -31.976078941702923, -36.05466271873542, -39.47894422113987, -33.113851831695314, -34.335852498675365, -31.184782924401524, -40.09674390907604, -41.236359167781515, 7.94651353187276, 1.1576457584269377, -32.12735171235052, -40.17734019206678, -12.15371041853875, 13.919458969845852, 28.045911427801165, -21.81572199705092, -14.765465434951892, 3.6296491089943372, 9.375718216537187, 9.979367615334192, 33.352581823576855, 16.255993562772723, -3.4967377521751537, -4.72218303931556, 15.987533227079734, -47.63732631743058, -10.385223196182253, 7.801065577321893, -43.01541489829993, -29.53081275965944, -52.95435913943776, -47.56084877991616, -18.06343962054015, 17.979436048073577, -17.52475102692518, 16.70106000297345, -23.3390832221162, 4.58706755186831, -3.6026507889256116, -3.249294216486959, 9.804496867787456, -2.035693465433541, 20.653480529643424, -50.874886043529585, -8.794512486252394, 33.63219093211042, 8.625918208530969, 14.71139859159641, -21.392778375941315, 5.827193580810155, 37.1957929832011, 24.116433158016633, 20.64370832459986, 21.685924655501225, -32.51744233321555, -30.384334189545818, 25.944063173040025, 1.3472064655829534, 36.95331606015099, 17.518124151125956, 43.79043864814437, 0.6739093956748494, 18.712353478123816, 3.7889113807192984, 23.35672578064053, 20.812574523376306, 31.081187056751205, 18.34862903380108, 26.852541008517363, 45.83148638405474, 28.167561284105155, 8.343917276293013, 13.229547363845931, 41.15037687140216, 10.011861302340682, 16.638177576859242, 8.459535820609542, 29.863832991852263, 19.34577319934295, 41.72051935384502, 5.299909916519102, 42.40506779448611, 9.28626938544205, 15.77382324113785, 23.204944378239432, 35.92724693503385, 3.7289461211083044, 10.441710624850778, 19.65408421179363, 20.50465558366792, 17.716780449619257, 14.685198805897425, 37.58082471105023, 19.855282443661075, 24.892889732942727, 15.517600301423379, 5.463724142587923, 15.554821446722343, 43.7439860352102, 6.298519313962825, 30.268846065102213, 11.814260818071528, 22.637486036772962, -13.698092439675165, 32.29779611140646, 14.788965194420584, 18.493105370960098, 8.12370986224177, -9.385222092415972, -31.558851740938366, 28.054299772027825, 31.59612374928332, 22.217678474587416, 26.61698508381125, 16.846352070530557, 28.271467713360984, -18.53372469683075, 35.531134933309005, 14.407099324304905, 25.091231133525113, 21.67889805845838, 38.24639740347265, 11.363175062462076, 22.71125316294069, 18.511506509788664, 21.058563238085878, 15.096407064347556, 34.82803578167673, 17.76443354863798, 3.053899136726603, 17.80205348707806, 27.75752386197335, 13.695833974742985, 24.71662554770349, 27.765076552460926, 42.359168641201784, 31.047332141903563, 32.84342813702918, 42.37859640271751, 42.32411817883209, 34.15793512627306, 22.973649782131062, 27.332540697479224, 22.554365567530525, -17.78942919042816, -27.251583691622372, 36.6534442315594, 45.34914642711294, 38.01762128834756, 39.61351898494276, 45.70656431637569, 49.574396926185756, 26.54974011929611, 40.8591560500535, 56.7260622988629, -3.2769031552520147, -48.91325776425705, -50.65934200711888, 18.364940672276546, 18.516777483374423, 16.861941487598667, 22.894097020712987, -1.456794446315394, 20.568167005057504, 29.576041704186707, 20.53063686742712, 44.032217733941316, 39.735367210999634, 32.83147208829039, -17.27628915709312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43006559670570466, "mean_inference_ms": 1.1372813277483635, "mean_action_processing_ms": 0.18473051165358548, "mean_env_wait_ms": 0.07574009351327153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003428220748901367, "StateBufferConnector_ms": 0.0023965835571289062, "ViewRequirementAgentConnector_ms": 0.06456494331359863}, "num_episodes": 15, "episode_return_max": 47.640480621280716, "episode_return_min": -50.25760395967698, "episode_return_mean": 5.513305027239502}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.5034708339797, "num_env_steps_trained_throughput_per_sec": 482.5034708339797, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 8202.139, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8202.104, "sample_time_ms": 745.065, "learn_time_ms": 7443.29, "learn_throughput": 537.397, "synch_weights_time_ms": 13.316}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 122, "trial_id": "83a5c_00000", "date": "2024-08-10_12-31-22", "timestamp": 1723307482, "time_this_iter_s": 8.295912027359009, "time_total_s": 1043.9533095359802, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1043.9533095359802, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 27.00909090909091, "ram_util_percent": 82.57272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4891693839478113, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.095727355644185, "policy_loss": -0.002922731760652765, "vf_loss": 5.0984638050119715, "vf_explained_var": -0.521280534242196, "kl": 0.005513143681808543, "entropy": 0.658994320713023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6514975120003026, "cur_kl_coeff": 0.0023757264018058775, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.102614473054806, "policy_loss": -0.004982337677211035, "vf_loss": 4.107586800555388, "vf_explained_var": 0.5610102531810601, "kl": 0.0042142844901049276, "entropy": 0.33961159399089713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "env_runners": {"episode_reward_max": 47.640480621280716, "episode_reward_min": -60.6371923279589, "episode_reward_mean": 7.796902144750288, "episode_len_mean": 310.95, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 31095, "policy_reward_min": {"agent_policy": -47.640480621280716, "adversary_policy": -61.441724377063764}, "policy_reward_max": {"agent_policy": 60.63719232795891, "adversary_policy": 56.7260622988629}, "policy_reward_mean": {"agent_policy": -7.796902144750286, "adversary_policy": 7.796902144750288}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.795694777232408, -19.806000089610514, -34.01537083021924, -36.29639802641762, -32.76031771153851, -40.6665515384288, 4.552079645149849, -36.15234595220864, 0.8828742756535508, 3.115094715375122, -5.567908162978778, 9.67754291593569, 24.804287693174754, -4.109460395745344, -15.824896545175434, -1.2920788094301798, -36.27311382897966, -50.25760395967698, -0.04200178623328732, -0.41184551197587105, -9.376007835123946, -3.4259725027062755, 3.884401701176957, -15.110702756943084, 12.418839222929016, 11.66865840006369, -7.782792397565581, 30.65611307060889, 21.16481649005056, -31.450888261380683, 13.645634819311484, 27.235720105638446, 22.232174021909596, 11.250632429421552, 22.084650152008415, 24.714908045276147, 36.34201369628608, 18.25573928019908, 27.189962117624056, 13.325019439599965, 19.1616844062309, 30.533146276594003, 23.85248885550261, 12.530046313289949, 29.566095656636627, 7.085328372979533, 20.079369897730764, 16.200989627758332, 28.718053577355654, 20.205245017183046, 10.509272794655123, 25.021252674586545, 21.041553441586863, 4.4696967985489, 23.543380652913516, 13.308407616600935, -20.472036916677165, 29.825211760655577, 24.417331779199326, 22.55890989194578, 8.49870511823913, 19.749165228915004, 29.962647730965543, 17.037214112701385, 19.785034873937267, 24.962221423012146, 10.409166342682294, 22.7797886745257, 19.20622976122322, 35.062122596831365, 31.945380139466376, 42.351357290774814, 28.56579245420209, 24.943453132504864, -22.520506441025265, 41.001295329336166, 38.81557013664509, 47.640480621280716, 33.7044480846748, 26.724579571805446, -49.786299885687974, 18.44085907782548, 19.878019254155827, 9.55568627937105, 25.053339285806913, 41.8837924724705, 7.777591465598629, -45.40567593584839, -56.448790432199566, -50.918090214833455, -34.251194390561864, 30.552673889453985, -60.6371923279589, 18.073074760209284, 27.81826748174155, 28.597960597751467, 20.828925297548565, 22.49530492629892, -45.83556319022346, 23.96335127384833], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 41, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 356, 400, 400, 400, 347, 142, 400, 256, 236, 46, 172, 391, 350, 219, 126, 400, 400, 386, 230, 116, 400, 103, 400, 205, 346, 323, 30, 253, 400, 148, 122, 221, 183, 365, 382, 400, 167, 400, 300, 191, 400, 324, 400, 222, 281, 196, 400, 156, 217, 166, 223, 367, 24, 400, 400, 400, 400, 148, 400, 261, 202, 44, 228, 251, 400, 220], "policy_agent_policy_reward": [-6.795694777232413, 19.80600008961051, 34.01537083021922, 36.29639802641761, 32.76031771153852, 40.666551538428806, -4.552079645149847, 36.15234595220865, -0.8828742756535508, -3.115094715375122, 5.567908162978777, -9.67754291593569, -24.80428769317477, 4.109460395745353, 15.82489654517543, 1.2920788094301798, 36.27311382897965, 50.257603959676985, 0.04200178623328732, 0.41184551197586217, 9.376007835123938, 3.425972502706296, -3.884401701176956, 15.110702756943084, -12.418839222929016, -11.668658400063688, 7.782792397565586, -30.656113070608857, -21.164816490050548, 31.450888261380683, -13.64563481931148, -27.235720105638464, -22.232174021909607, -11.250632429421561, -22.08465015200843, -24.714908045276136, -36.34201369628604, -18.255739280199087, -27.18996211762406, -13.325019439599966, -19.161684406230894, -30.533146276593975, -23.8524888555026, -12.530046313289953, -29.566095656636637, -7.085328372979539, -20.079369897730775, -16.20098962775834, -28.718053577355654, -20.20524501718305, -10.509272794655127, -25.021252674586542, -21.041553441586863, -4.4696967985489, -23.54338065291354, -13.308407616600933, 20.472036916677173, -29.825211760655545, -24.417331779199337, -22.55890989194578, -8.498705118239128, -19.749165228915018, -29.962647730965532, -17.037214112701385, -19.785034873937263, -24.962221423012146, -10.40916634268229, -22.779788674525708, -19.20622976122325, -35.062122596831365, -31.945380139466355, -42.35135729077482, -28.56579245420205, -24.943453132504885, 22.520506441025265, -41.00129532933615, -38.81557013664515, -47.640480621280716, -33.70444808467479, -26.724579571805442, 49.78629988568798, -18.440859077825486, -19.878019254155824, -9.555686279371054, -25.053339285806913, -41.88379247247049, -7.777591465598632, 45.405675935848414, 56.44879043219956, 50.91809021483345, 34.251194390561864, -30.552673889453974, 60.63719232795891, -18.073074760209277, -27.818267481741533, -28.597960597751474, -20.828925297548565, -22.495304926298918, 45.83556319022347, -23.963351273848314], "policy_adversary_policy_reward": [13.747446823842948, -0.15605726937813102, -20.355027668456962, -19.256972510764058, -31.976078941702923, -36.05466271873542, -39.47894422113987, -33.113851831695314, -34.335852498675365, -31.184782924401524, -40.09674390907604, -41.236359167781515, 7.94651353187276, 1.1576457584269377, -32.12735171235052, -40.17734019206678, -12.15371041853875, 13.919458969845852, 28.045911427801165, -21.81572199705092, -14.765465434951892, 3.6296491089943372, 9.375718216537187, 9.979367615334192, 33.352581823576855, 16.255993562772723, -3.4967377521751537, -4.72218303931556, 15.987533227079734, -47.63732631743058, -10.385223196182253, 7.801065577321893, -43.01541489829993, -29.53081275965944, -52.95435913943776, -47.56084877991616, -18.06343962054015, 17.979436048073577, -17.52475102692518, 16.70106000297345, -23.3390832221162, 4.58706755186831, -3.6026507889256116, -3.249294216486959, 9.804496867787456, -2.035693465433541, 20.653480529643424, -50.874886043529585, -8.794512486252394, 33.63219093211042, 8.625918208530969, 14.71139859159641, -21.392778375941315, 5.827193580810155, 37.1957929832011, 24.116433158016633, 20.64370832459986, 21.685924655501225, -32.51744233321555, -30.384334189545818, 25.944063173040025, 1.3472064655829534, 36.95331606015099, 17.518124151125956, 43.79043864814437, 0.6739093956748494, 18.712353478123816, 3.7889113807192984, 23.35672578064053, 20.812574523376306, 31.081187056751205, 18.34862903380108, 26.852541008517363, 45.83148638405474, 28.167561284105155, 8.343917276293013, 13.229547363845931, 41.15037687140216, 10.011861302340682, 16.638177576859242, 8.459535820609542, 29.863832991852263, 19.34577319934295, 41.72051935384502, 5.299909916519102, 42.40506779448611, 9.28626938544205, 15.77382324113785, 23.204944378239432, 35.92724693503385, 3.7289461211083044, 10.441710624850778, 19.65408421179363, 20.50465558366792, 17.716780449619257, 14.685198805897425, 37.58082471105023, 19.855282443661075, 24.892889732942727, 15.517600301423379, 5.463724142587923, 15.554821446722343, 43.7439860352102, 6.298519313962825, 30.268846065102213, 11.814260818071528, 22.637486036772962, -13.698092439675165, 32.29779611140646, 14.788965194420584, 18.493105370960098, 8.12370986224177, -9.385222092415972, -31.558851740938366, 28.054299772027825, 31.59612374928332, 22.217678474587416, 26.61698508381125, 16.846352070530557, 28.271467713360984, -18.53372469683075, 35.531134933309005, 14.407099324304905, 25.091231133525113, 21.67889805845838, 38.24639740347265, 11.363175062462076, 22.71125316294069, 18.511506509788664, 21.058563238085878, 15.096407064347556, 34.82803578167673, 17.76443354863798, 3.053899136726603, 17.80205348707806, 27.75752386197335, 13.695833974742985, 24.71662554770349, 27.765076552460926, 42.359168641201784, 31.047332141903563, 32.84342813702918, 42.37859640271751, 42.32411817883209, 34.15793512627306, 22.973649782131062, 27.332540697479224, 22.554365567530525, -17.78942919042816, -27.251583691622372, 36.6534442315594, 45.34914642711294, 38.01762128834756, 39.61351898494276, 45.70656431637569, 49.574396926185756, 26.54974011929611, 40.8591560500535, 56.7260622988629, -3.2769031552520147, -48.91325776425705, -50.65934200711888, 18.364940672276546, 18.516777483374423, 16.861941487598667, 22.894097020712987, -1.456794446315394, 20.568167005057504, 29.576041704186707, 20.53063686742712, 44.032217733941316, 39.735367210999634, 32.83147208829039, -17.27628915709312, -45.267303079919266, -45.54404879177755, -51.53768170553276, -61.35989915886637, -51.35301014375938, -50.483170285907505, -33.483225493423916, -35.01916328769982, 53.41969470139653, 7.685653077511407, -61.441724377063764, -59.83266027885401, 11.922260841512257, 24.22388867890629, 38.91474671468562, 16.72178824879744, 18.623729451160486, 38.57219174434244, 12.777478505209235, 28.880372089887906, 15.93847181602683, 29.052138036571012, -54.80803138170042, -36.86309499874652, 27.32548123680482, 20.601221310891795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42974221365363413, "mean_inference_ms": 1.1360166371140388, "mean_action_processing_ms": 0.1845841183361412, "mean_env_wait_ms": 0.07563355246433164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034332275390625, "StateBufferConnector_ms": 0.002614617347717285, "ViewRequirementAgentConnector_ms": 0.06588959693908691}, "num_episodes": 13, "episode_return_max": 47.640480621280716, "episode_return_min": -60.6371923279589, "episode_return_mean": 7.796902144750288}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 489.02649972414093, "num_env_steps_trained_throughput_per_sec": 489.02649972414093, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 8221.833, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8221.798, "sample_time_ms": 759.842, "learn_time_ms": 7448.094, "learn_throughput": 537.05, "synch_weights_time_ms": 13.426}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "training_iteration": 123, "trial_id": "83a5c_00000", "date": "2024-08-10_12-31-30", "timestamp": 1723307490, "time_this_iter_s": 8.185504913330078, "time_total_s": 1052.1388144493103, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc4e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1052.1388144493103, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 28.299999999999997, "ram_util_percent": 82.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7287376295321835, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.145338787603631, "policy_loss": -0.004154586129841547, "vf_loss": 4.149270420982724, "vf_explained_var": -0.6098174037126006, "kl": 0.006598878802032316, "entropy": 0.6696544143573316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4094646592314044, "cur_kl_coeff": 0.0011878632009029388, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2923513126869994, "policy_loss": -0.008340488490163504, "vf_loss": 3.30068514769276, "vf_explained_var": 0.8096372888733944, "kl": 0.005596233331957901, "entropy": 0.2476629812968895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 47.640480621280716, "episode_reward_min": -61.58275485551502, "episode_reward_mean": 5.03345324628009, "episode_len_mean": 317.85, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 31785, "policy_reward_min": {"agent_policy": -47.640480621280716, "adversary_policy": -69.59987670489706}, "policy_reward_max": {"agent_policy": 61.58275485551501, "adversary_policy": 56.7260622988629}, "policy_reward_mean": {"agent_policy": -5.033453246280086, "adversary_policy": 5.033453246280088}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.804287693174754, -4.109460395745344, -15.824896545175434, -1.2920788094301798, -36.27311382897966, -50.25760395967698, -0.04200178623328732, -0.41184551197587105, -9.376007835123946, -3.4259725027062755, 3.884401701176957, -15.110702756943084, 12.418839222929016, 11.66865840006369, -7.782792397565581, 30.65611307060889, 21.16481649005056, -31.450888261380683, 13.645634819311484, 27.235720105638446, 22.232174021909596, 11.250632429421552, 22.084650152008415, 24.714908045276147, 36.34201369628608, 18.25573928019908, 27.189962117624056, 13.325019439599965, 19.1616844062309, 30.533146276594003, 23.85248885550261, 12.530046313289949, 29.566095656636627, 7.085328372979533, 20.079369897730764, 16.200989627758332, 28.718053577355654, 20.205245017183046, 10.509272794655123, 25.021252674586545, 21.041553441586863, 4.4696967985489, 23.543380652913516, 13.308407616600935, -20.472036916677165, 29.825211760655577, 24.417331779199326, 22.55890989194578, 8.49870511823913, 19.749165228915004, 29.962647730965543, 17.037214112701385, 19.785034873937267, 24.962221423012146, 10.409166342682294, 22.7797886745257, 19.20622976122322, 35.062122596831365, 31.945380139466376, 42.351357290774814, 28.56579245420209, 24.943453132504864, -22.520506441025265, 41.001295329336166, 38.81557013664509, 47.640480621280716, 33.7044480846748, 26.724579571805446, -49.786299885687974, 18.44085907782548, 19.878019254155827, 9.55568627937105, 25.053339285806913, 41.8837924724705, 7.777591465598629, -45.40567593584839, -56.448790432199566, -50.918090214833455, -34.251194390561864, 30.552673889453985, -60.6371923279589, 18.073074760209284, 27.81826748174155, 28.597960597751467, 20.828925297548565, 22.49530492629892, -45.83556319022346, 23.96335127384833, -61.58275485551502, -30.4104138505242, -56.90996301449339, -28.28522788022685, -45.170804165403, -56.477278001608575, -25.630935332066784, -48.621993418324905, -53.49892436503591, -34.952426357634124, 46.022469571437746, -61.06824415968045], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 356, 400, 400, 400, 347, 142, 400, 256, 236, 46, 172, 391, 350, 219, 126, 400, 400, 386, 230, 116, 400, 103, 400, 205, 346, 323, 30, 253, 400, 148, 122, 221, 183, 365, 382, 400, 167, 400, 300, 191, 400, 324, 400, 222, 281, 196, 400, 156, 217, 166, 223, 367, 24, 400, 400, 400, 400, 148, 400, 261, 202, 44, 228, 251, 400, 220, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 343, 400], "policy_agent_policy_reward": [-24.80428769317477, 4.109460395745353, 15.82489654517543, 1.2920788094301798, 36.27311382897965, 50.257603959676985, 0.04200178623328732, 0.41184551197586217, 9.376007835123938, 3.425972502706296, -3.884401701176956, 15.110702756943084, -12.418839222929016, -11.668658400063688, 7.782792397565586, -30.656113070608857, -21.164816490050548, 31.450888261380683, -13.64563481931148, -27.235720105638464, -22.232174021909607, -11.250632429421561, -22.08465015200843, -24.714908045276136, -36.34201369628604, -18.255739280199087, -27.18996211762406, -13.325019439599966, -19.161684406230894, -30.533146276593975, -23.8524888555026, -12.530046313289953, -29.566095656636637, -7.085328372979539, -20.079369897730775, -16.20098962775834, -28.718053577355654, -20.20524501718305, -10.509272794655127, -25.021252674586542, -21.041553441586863, -4.4696967985489, -23.54338065291354, -13.308407616600933, 20.472036916677173, -29.825211760655545, -24.417331779199337, -22.55890989194578, -8.498705118239128, -19.749165228915018, -29.962647730965532, -17.037214112701385, -19.785034873937263, -24.962221423012146, -10.40916634268229, -22.779788674525708, -19.20622976122325, -35.062122596831365, -31.945380139466355, -42.35135729077482, -28.56579245420205, -24.943453132504885, 22.520506441025265, -41.00129532933615, -38.81557013664515, -47.640480621280716, -33.70444808467479, -26.724579571805442, 49.78629988568798, -18.440859077825486, -19.878019254155824, -9.555686279371054, -25.053339285806913, -41.88379247247049, -7.777591465598632, 45.405675935848414, 56.44879043219956, 50.91809021483345, 34.251194390561864, -30.552673889453974, 60.63719232795891, -18.073074760209277, -27.818267481741533, -28.597960597751474, -20.828925297548565, -22.495304926298918, 45.83556319022347, -23.963351273848314, 61.58275485551501, 30.4104138505242, 56.909963014493385, 28.285227880226856, 45.17080416540299, 56.47727800160857, 25.630935332066784, 48.6219934183249, 53.49892436503592, 34.952426357634124, -46.02246957143775, 61.06824415968044], "policy_adversary_policy_reward": [33.352581823576855, 16.255993562772723, -3.4967377521751537, -4.72218303931556, 15.987533227079734, -47.63732631743058, -10.385223196182253, 7.801065577321893, -43.01541489829993, -29.53081275965944, -52.95435913943776, -47.56084877991616, -18.06343962054015, 17.979436048073577, -17.52475102692518, 16.70106000297345, -23.3390832221162, 4.58706755186831, -3.6026507889256116, -3.249294216486959, 9.804496867787456, -2.035693465433541, 20.653480529643424, -50.874886043529585, -8.794512486252394, 33.63219093211042, 8.625918208530969, 14.71139859159641, -21.392778375941315, 5.827193580810155, 37.1957929832011, 24.116433158016633, 20.64370832459986, 21.685924655501225, -32.51744233321555, -30.384334189545818, 25.944063173040025, 1.3472064655829534, 36.95331606015099, 17.518124151125956, 43.79043864814437, 0.6739093956748494, 18.712353478123816, 3.7889113807192984, 23.35672578064053, 20.812574523376306, 31.081187056751205, 18.34862903380108, 26.852541008517363, 45.83148638405474, 28.167561284105155, 8.343917276293013, 13.229547363845931, 41.15037687140216, 10.011861302340682, 16.638177576859242, 8.459535820609542, 29.863832991852263, 19.34577319934295, 41.72051935384502, 5.299909916519102, 42.40506779448611, 9.28626938544205, 15.77382324113785, 23.204944378239432, 35.92724693503385, 3.7289461211083044, 10.441710624850778, 19.65408421179363, 20.50465558366792, 17.716780449619257, 14.685198805897425, 37.58082471105023, 19.855282443661075, 24.892889732942727, 15.517600301423379, 5.463724142587923, 15.554821446722343, 43.7439860352102, 6.298519313962825, 30.268846065102213, 11.814260818071528, 22.637486036772962, -13.698092439675165, 32.29779611140646, 14.788965194420584, 18.493105370960098, 8.12370986224177, -9.385222092415972, -31.558851740938366, 28.054299772027825, 31.59612374928332, 22.217678474587416, 26.61698508381125, 16.846352070530557, 28.271467713360984, -18.53372469683075, 35.531134933309005, 14.407099324304905, 25.091231133525113, 21.67889805845838, 38.24639740347265, 11.363175062462076, 22.71125316294069, 18.511506509788664, 21.058563238085878, 15.096407064347556, 34.82803578167673, 17.76443354863798, 3.053899136726603, 17.80205348707806, 27.75752386197335, 13.695833974742985, 24.71662554770349, 27.765076552460926, 42.359168641201784, 31.047332141903563, 32.84342813702918, 42.37859640271751, 42.32411817883209, 34.15793512627306, 22.973649782131062, 27.332540697479224, 22.554365567530525, -17.78942919042816, -27.251583691622372, 36.6534442315594, 45.34914642711294, 38.01762128834756, 39.61351898494276, 45.70656431637569, 49.574396926185756, 26.54974011929611, 40.8591560500535, 56.7260622988629, -3.2769031552520147, -48.91325776425705, -50.65934200711888, 18.364940672276546, 18.516777483374423, 16.861941487598667, 22.894097020712987, -1.456794446315394, 20.568167005057504, 29.576041704186707, 20.53063686742712, 44.032217733941316, 39.735367210999634, 32.83147208829039, -17.27628915709312, -45.267303079919266, -45.54404879177755, -51.53768170553276, -61.35989915886637, -51.35301014375938, -50.483170285907505, -33.483225493423916, -35.01916328769982, 53.41969470139653, 7.685653077511407, -61.441724377063764, -59.83266027885401, 11.922260841512257, 24.22388867890629, 38.91474671468562, 16.72178824879744, 18.623729451160486, 38.57219174434244, 12.777478505209235, 28.880372089887906, 15.93847181602683, 29.052138036571012, -54.80803138170042, -36.86309499874652, 27.32548123680482, 20.601221310891795, -63.92167460423049, -59.24383510679951, -26.758276065345683, -34.06255163570272, -51.38279125507659, -62.43713477391019, -28.28983096207336, -28.28062479838038, -47.971573870935245, -42.37003445987075, -53.56085794368842, -59.39369805952877, -18.593995611147683, -32.667875052985885, -47.466895293020876, -49.77709154362894, -54.82969508943593, -52.16815364063589, -36.75923756230936, -33.14561515295888, 50.501568723817215, 41.54337041905825, -69.59987670489706, -52.53661161446383]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.429530376058737, "mean_inference_ms": 1.1349574346252718, "mean_action_processing_ms": 0.18448989371407726, "mean_env_wait_ms": 0.07555754154979195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033812522888183594, "StateBufferConnector_ms": 0.003374338150024414, "ViewRequirementAgentConnector_ms": 0.06789064407348633}, "num_episodes": 12, "episode_return_max": 47.640480621280716, "episode_return_min": -61.58275485551502, "episode_return_mean": 5.03345324628009}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.14970847724226, "num_env_steps_trained_throughput_per_sec": 495.14970847724226, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 8226.845, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8226.81, "sample_time_ms": 780.895, "learn_time_ms": 7432.137, "learn_throughput": 538.203, "synch_weights_time_ms": 13.329}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 124, "trial_id": "83a5c_00000", "date": "2024-08-10_12-31-38", "timestamp": 1723307498, "time_this_iter_s": 8.0833899974823, "time_total_s": 1060.2222044467926, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb63d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1060.2222044467926, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 27.063636363636363, "ram_util_percent": 82.30909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.375939993883567, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6877495724057394, "policy_loss": -0.006011081998921418, "vf_loss": 3.693318697510573, "vf_explained_var": -0.5657102869931983, "kl": 0.013080053547286304, "entropy": 0.6333661844806066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4279255157957476, "cur_kl_coeff": 0.0011878632009029388, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7237961453696093, "policy_loss": -0.0022810098930979923, "vf_loss": 3.7260737640162307, "vf_explained_var": 0.6136682019258539, "kl": 0.0028594944416690748, "entropy": 0.2056772018317133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "env_runners": {"episode_reward_max": 47.640480621280716, "episode_reward_min": -61.58275485551502, "episode_reward_mean": 1.9626787456518702, "episode_len_mean": 314.15, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 31415, "policy_reward_min": {"agent_policy": -47.640480621280716, "adversary_policy": -69.59987670489706}, "policy_reward_max": {"agent_policy": 61.58275485551501, "adversary_policy": 56.7260622988629}, "policy_reward_mean": {"agent_policy": -1.9626787456518693, "adversary_policy": 1.9626787456518695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.884401701176957, -15.110702756943084, 12.418839222929016, 11.66865840006369, -7.782792397565581, 30.65611307060889, 21.16481649005056, -31.450888261380683, 13.645634819311484, 27.235720105638446, 22.232174021909596, 11.250632429421552, 22.084650152008415, 24.714908045276147, 36.34201369628608, 18.25573928019908, 27.189962117624056, 13.325019439599965, 19.1616844062309, 30.533146276594003, 23.85248885550261, 12.530046313289949, 29.566095656636627, 7.085328372979533, 20.079369897730764, 16.200989627758332, 28.718053577355654, 20.205245017183046, 10.509272794655123, 25.021252674586545, 21.041553441586863, 4.4696967985489, 23.543380652913516, 13.308407616600935, -20.472036916677165, 29.825211760655577, 24.417331779199326, 22.55890989194578, 8.49870511823913, 19.749165228915004, 29.962647730965543, 17.037214112701385, 19.785034873937267, 24.962221423012146, 10.409166342682294, 22.7797886745257, 19.20622976122322, 35.062122596831365, 31.945380139466376, 42.351357290774814, 28.56579245420209, 24.943453132504864, -22.520506441025265, 41.001295329336166, 38.81557013664509, 47.640480621280716, 33.7044480846748, 26.724579571805446, -49.786299885687974, 18.44085907782548, 19.878019254155827, 9.55568627937105, 25.053339285806913, 41.8837924724705, 7.777591465598629, -45.40567593584839, -56.448790432199566, -50.918090214833455, -34.251194390561864, 30.552673889453985, -60.6371923279589, 18.073074760209284, 27.81826748174155, 28.597960597751467, 20.828925297548565, 22.49530492629892, -45.83556319022346, 23.96335127384833, -61.58275485551502, -30.4104138505242, -56.90996301449339, -28.28522788022685, -45.170804165403, -56.477278001608575, -25.630935332066784, -48.621993418324905, -53.49892436503591, -34.952426357634124, 46.022469571437746, -61.06824415968045, -37.07602836139507, -51.14693394650708, -45.68938623936316, -47.09288586318225, -46.620419435851396, -54.180801794265655, 34.31815060631714, -55.33904389966638, -53.8833575506971, -46.57543706008299], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 356, 400, 400, 400, 347, 142, 400, 256, 236, 46, 172, 391, 350, 219, 126, 400, 400, 386, 230, 116, 400, 103, 400, 205, 346, 323, 30, 253, 400, 148, 122, 221, 183, 365, 382, 400, 167, 400, 300, 191, 400, 324, 400, 222, 281, 196, 400, 156, 217, 166, 223, 367, 24, 400, 400, 400, 400, 148, 400, 261, 202, 44, 228, 251, 400, 220, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 343, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400], "policy_agent_policy_reward": [-3.884401701176956, 15.110702756943084, -12.418839222929016, -11.668658400063688, 7.782792397565586, -30.656113070608857, -21.164816490050548, 31.450888261380683, -13.64563481931148, -27.235720105638464, -22.232174021909607, -11.250632429421561, -22.08465015200843, -24.714908045276136, -36.34201369628604, -18.255739280199087, -27.18996211762406, -13.325019439599966, -19.161684406230894, -30.533146276593975, -23.8524888555026, -12.530046313289953, -29.566095656636637, -7.085328372979539, -20.079369897730775, -16.20098962775834, -28.718053577355654, -20.20524501718305, -10.509272794655127, -25.021252674586542, -21.041553441586863, -4.4696967985489, -23.54338065291354, -13.308407616600933, 20.472036916677173, -29.825211760655545, -24.417331779199337, -22.55890989194578, -8.498705118239128, -19.749165228915018, -29.962647730965532, -17.037214112701385, -19.785034873937263, -24.962221423012146, -10.40916634268229, -22.779788674525708, -19.20622976122325, -35.062122596831365, -31.945380139466355, -42.35135729077482, -28.56579245420205, -24.943453132504885, 22.520506441025265, -41.00129532933615, -38.81557013664515, -47.640480621280716, -33.70444808467479, -26.724579571805442, 49.78629988568798, -18.440859077825486, -19.878019254155824, -9.555686279371054, -25.053339285806913, -41.88379247247049, -7.777591465598632, 45.405675935848414, 56.44879043219956, 50.91809021483345, 34.251194390561864, -30.552673889453974, 60.63719232795891, -18.073074760209277, -27.818267481741533, -28.597960597751474, -20.828925297548565, -22.495304926298918, 45.83556319022347, -23.963351273848314, 61.58275485551501, 30.4104138505242, 56.909963014493385, 28.285227880226856, 45.17080416540299, 56.47727800160857, 25.630935332066784, 48.6219934183249, 53.49892436503592, 34.952426357634124, -46.02246957143775, 61.06824415968044, 37.076028361395075, 51.146933946507076, 45.68938623936317, 47.092885863182225, 46.62041943585139, 54.18080179426565, -34.318150606317154, 55.33904389966637, 53.883357550697106, 46.57543706008298], "policy_adversary_policy_reward": [9.804496867787456, -2.035693465433541, 20.653480529643424, -50.874886043529585, -8.794512486252394, 33.63219093211042, 8.625918208530969, 14.71139859159641, -21.392778375941315, 5.827193580810155, 37.1957929832011, 24.116433158016633, 20.64370832459986, 21.685924655501225, -32.51744233321555, -30.384334189545818, 25.944063173040025, 1.3472064655829534, 36.95331606015099, 17.518124151125956, 43.79043864814437, 0.6739093956748494, 18.712353478123816, 3.7889113807192984, 23.35672578064053, 20.812574523376306, 31.081187056751205, 18.34862903380108, 26.852541008517363, 45.83148638405474, 28.167561284105155, 8.343917276293013, 13.229547363845931, 41.15037687140216, 10.011861302340682, 16.638177576859242, 8.459535820609542, 29.863832991852263, 19.34577319934295, 41.72051935384502, 5.299909916519102, 42.40506779448611, 9.28626938544205, 15.77382324113785, 23.204944378239432, 35.92724693503385, 3.7289461211083044, 10.441710624850778, 19.65408421179363, 20.50465558366792, 17.716780449619257, 14.685198805897425, 37.58082471105023, 19.855282443661075, 24.892889732942727, 15.517600301423379, 5.463724142587923, 15.554821446722343, 43.7439860352102, 6.298519313962825, 30.268846065102213, 11.814260818071528, 22.637486036772962, -13.698092439675165, 32.29779611140646, 14.788965194420584, 18.493105370960098, 8.12370986224177, -9.385222092415972, -31.558851740938366, 28.054299772027825, 31.59612374928332, 22.217678474587416, 26.61698508381125, 16.846352070530557, 28.271467713360984, -18.53372469683075, 35.531134933309005, 14.407099324304905, 25.091231133525113, 21.67889805845838, 38.24639740347265, 11.363175062462076, 22.71125316294069, 18.511506509788664, 21.058563238085878, 15.096407064347556, 34.82803578167673, 17.76443354863798, 3.053899136726603, 17.80205348707806, 27.75752386197335, 13.695833974742985, 24.71662554770349, 27.765076552460926, 42.359168641201784, 31.047332141903563, 32.84342813702918, 42.37859640271751, 42.32411817883209, 34.15793512627306, 22.973649782131062, 27.332540697479224, 22.554365567530525, -17.78942919042816, -27.251583691622372, 36.6534442315594, 45.34914642711294, 38.01762128834756, 39.61351898494276, 45.70656431637569, 49.574396926185756, 26.54974011929611, 40.8591560500535, 56.7260622988629, -3.2769031552520147, -48.91325776425705, -50.65934200711888, 18.364940672276546, 18.516777483374423, 16.861941487598667, 22.894097020712987, -1.456794446315394, 20.568167005057504, 29.576041704186707, 20.53063686742712, 44.032217733941316, 39.735367210999634, 32.83147208829039, -17.27628915709312, -45.267303079919266, -45.54404879177755, -51.53768170553276, -61.35989915886637, -51.35301014375938, -50.483170285907505, -33.483225493423916, -35.01916328769982, 53.41969470139653, 7.685653077511407, -61.441724377063764, -59.83266027885401, 11.922260841512257, 24.22388867890629, 38.91474671468562, 16.72178824879744, 18.623729451160486, 38.57219174434244, 12.777478505209235, 28.880372089887906, 15.93847181602683, 29.052138036571012, -54.80803138170042, -36.86309499874652, 27.32548123680482, 20.601221310891795, -63.92167460423049, -59.24383510679951, -26.758276065345683, -34.06255163570272, -51.38279125507659, -62.43713477391019, -28.28983096207336, -28.28062479838038, -47.971573870935245, -42.37003445987075, -53.56085794368842, -59.39369805952877, -18.593995611147683, -32.667875052985885, -47.466895293020876, -49.77709154362894, -54.82969508943593, -52.16815364063589, -36.75923756230936, -33.14561515295888, 50.501568723817215, 41.54337041905825, -69.59987670489706, -52.53661161446383, -32.453674342751135, -41.69838238003899, -54.202608939205106, -48.091258953809, -53.19249487529262, -38.186277603433716, -55.59888359380955, -38.58688813255491, -51.54685131469163, -41.693987557011155, -43.529182283205785, -64.83242130532557, 38.902048945179274, 29.734252267455012, -48.397743301743745, -62.28034449758906, -58.31259367391923, -49.45412142747498, -49.13762332208225, -44.013250798083746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42930231469708297, "mean_inference_ms": 1.1343360698855338, "mean_action_processing_ms": 0.1843746916668258, "mean_env_wait_ms": 0.07551577699423057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00336611270904541, "StateBufferConnector_ms": 0.003380894660949707, "ViewRequirementAgentConnector_ms": 0.0677422285079956}, "num_episodes": 10, "episode_return_max": 47.640480621280716, "episode_return_min": -61.58275485551502, "episode_return_mean": 1.9626787456518702}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.5148827915277, "num_env_steps_trained_throughput_per_sec": 510.5148827915277, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 1500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 8179.973, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8179.938, "sample_time_ms": 781.665, "learn_time_ms": 7384.793, "learn_throughput": 541.654, "synch_weights_time_ms": 13.034}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": false, "training_iteration": 125, "trial_id": "83a5c_00000", "date": "2024-08-10_12-31-46", "timestamp": 1723307506, "time_this_iter_s": 7.840719223022461, "time_total_s": 1068.062923669815, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faad940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1068.062923669815, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 25.40909090909091, "ram_util_percent": 82.34545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6700553226092505, "cur_kl_coeff": 0.0337881088256836, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8325768918587415, "policy_loss": -0.009882492518357973, "vf_loss": 3.8415356878250364, "vf_explained_var": -0.007938659064984196, "kl": 0.027337828639042435, "entropy": 0.7550678558450528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6141612889866033, "cur_kl_coeff": 0.0005939316004514694, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.80264328122139, "policy_loss": -0.0030800925887888297, "vf_loss": 2.8057211498419443, "vf_explained_var": 0.7139349600921074, "kl": 0.00374657033856091, "entropy": 0.26960894870571794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": 47.640480621280716, "episode_reward_min": -61.58275485551502, "episode_reward_mean": -2.173334728236444, "episode_len_mean": 310.35, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 31035, "policy_reward_min": {"agent_policy": -47.640480621280716, "adversary_policy": -69.59987670489706}, "policy_reward_max": {"agent_policy": 61.58275485551501, "adversary_policy": 56.7260622988629}, "policy_reward_mean": {"agent_policy": 2.1733347282364437, "adversary_policy": -2.173334728236446}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.250632429421552, 22.084650152008415, 24.714908045276147, 36.34201369628608, 18.25573928019908, 27.189962117624056, 13.325019439599965, 19.1616844062309, 30.533146276594003, 23.85248885550261, 12.530046313289949, 29.566095656636627, 7.085328372979533, 20.079369897730764, 16.200989627758332, 28.718053577355654, 20.205245017183046, 10.509272794655123, 25.021252674586545, 21.041553441586863, 4.4696967985489, 23.543380652913516, 13.308407616600935, -20.472036916677165, 29.825211760655577, 24.417331779199326, 22.55890989194578, 8.49870511823913, 19.749165228915004, 29.962647730965543, 17.037214112701385, 19.785034873937267, 24.962221423012146, 10.409166342682294, 22.7797886745257, 19.20622976122322, 35.062122596831365, 31.945380139466376, 42.351357290774814, 28.56579245420209, 24.943453132504864, -22.520506441025265, 41.001295329336166, 38.81557013664509, 47.640480621280716, 33.7044480846748, 26.724579571805446, -49.786299885687974, 18.44085907782548, 19.878019254155827, 9.55568627937105, 25.053339285806913, 41.8837924724705, 7.777591465598629, -45.40567593584839, -56.448790432199566, -50.918090214833455, -34.251194390561864, 30.552673889453985, -60.6371923279589, 18.073074760209284, 27.81826748174155, 28.597960597751467, 20.828925297548565, 22.49530492629892, -45.83556319022346, 23.96335127384833, -61.58275485551502, -30.4104138505242, -56.90996301449339, -28.28522788022685, -45.170804165403, -56.477278001608575, -25.630935332066784, -48.621993418324905, -53.49892436503591, -34.952426357634124, 46.022469571437746, -61.06824415968045, -37.07602836139507, -51.14693394650708, -45.68938623936316, -47.09288586318225, -46.620419435851396, -54.180801794265655, 34.31815060631714, -55.33904389966638, -53.8833575506971, -46.57543706008299, -34.20533733726228, -27.483866645012842, -19.880024351955566, -32.00435181717661, -31.90132799085631, -38.73406241774966, -33.434726061487986, 14.430156291327542, -50.35557430333122, -31.009781255124302, -40.4604770844029], "episode_lengths": [400, 356, 400, 400, 400, 347, 142, 400, 256, 236, 46, 172, 391, 350, 219, 126, 400, 400, 386, 230, 116, 400, 103, 400, 205, 346, 323, 30, 253, 400, 148, 122, 221, 183, 365, 382, 400, 167, 400, 300, 191, 400, 324, 400, 222, 281, 196, 400, 156, 217, 166, 223, 367, 24, 400, 400, 400, 400, 148, 400, 261, 202, 44, 228, 251, 400, 220, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 343, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400], "policy_agent_policy_reward": [-11.250632429421561, -22.08465015200843, -24.714908045276136, -36.34201369628604, -18.255739280199087, -27.18996211762406, -13.325019439599966, -19.161684406230894, -30.533146276593975, -23.8524888555026, -12.530046313289953, -29.566095656636637, -7.085328372979539, -20.079369897730775, -16.20098962775834, -28.718053577355654, -20.20524501718305, -10.509272794655127, -25.021252674586542, -21.041553441586863, -4.4696967985489, -23.54338065291354, -13.308407616600933, 20.472036916677173, -29.825211760655545, -24.417331779199337, -22.55890989194578, -8.498705118239128, -19.749165228915018, -29.962647730965532, -17.037214112701385, -19.785034873937263, -24.962221423012146, -10.40916634268229, -22.779788674525708, -19.20622976122325, -35.062122596831365, -31.945380139466355, -42.35135729077482, -28.56579245420205, -24.943453132504885, 22.520506441025265, -41.00129532933615, -38.81557013664515, -47.640480621280716, -33.70444808467479, -26.724579571805442, 49.78629988568798, -18.440859077825486, -19.878019254155824, -9.555686279371054, -25.053339285806913, -41.88379247247049, -7.777591465598632, 45.405675935848414, 56.44879043219956, 50.91809021483345, 34.251194390561864, -30.552673889453974, 60.63719232795891, -18.073074760209277, -27.818267481741533, -28.597960597751474, -20.828925297548565, -22.495304926298918, 45.83556319022347, -23.963351273848314, 61.58275485551501, 30.4104138505242, 56.909963014493385, 28.285227880226856, 45.17080416540299, 56.47727800160857, 25.630935332066784, 48.6219934183249, 53.49892436503592, 34.952426357634124, -46.02246957143775, 61.06824415968044, 37.076028361395075, 51.146933946507076, 45.68938623936317, 47.092885863182225, 46.62041943585139, 54.18080179426565, -34.318150606317154, 55.33904389966637, 53.883357550697106, 46.57543706008298, 34.20533733726228, 27.483866645012842, 19.880024351955566, 32.00435181717661, 31.90132799085631, 38.73406241774967, 33.43472606148801, -14.430156291327542, 50.35557430333121, 31.009781255124302, 40.460477084402896], "policy_adversary_policy_reward": [18.712353478123816, 3.7889113807192984, 23.35672578064053, 20.812574523376306, 31.081187056751205, 18.34862903380108, 26.852541008517363, 45.83148638405474, 28.167561284105155, 8.343917276293013, 13.229547363845931, 41.15037687140216, 10.011861302340682, 16.638177576859242, 8.459535820609542, 29.863832991852263, 19.34577319934295, 41.72051935384502, 5.299909916519102, 42.40506779448611, 9.28626938544205, 15.77382324113785, 23.204944378239432, 35.92724693503385, 3.7289461211083044, 10.441710624850778, 19.65408421179363, 20.50465558366792, 17.716780449619257, 14.685198805897425, 37.58082471105023, 19.855282443661075, 24.892889732942727, 15.517600301423379, 5.463724142587923, 15.554821446722343, 43.7439860352102, 6.298519313962825, 30.268846065102213, 11.814260818071528, 22.637486036772962, -13.698092439675165, 32.29779611140646, 14.788965194420584, 18.493105370960098, 8.12370986224177, -9.385222092415972, -31.558851740938366, 28.054299772027825, 31.59612374928332, 22.217678474587416, 26.61698508381125, 16.846352070530557, 28.271467713360984, -18.53372469683075, 35.531134933309005, 14.407099324304905, 25.091231133525113, 21.67889805845838, 38.24639740347265, 11.363175062462076, 22.71125316294069, 18.511506509788664, 21.058563238085878, 15.096407064347556, 34.82803578167673, 17.76443354863798, 3.053899136726603, 17.80205348707806, 27.75752386197335, 13.695833974742985, 24.71662554770349, 27.765076552460926, 42.359168641201784, 31.047332141903563, 32.84342813702918, 42.37859640271751, 42.32411817883209, 34.15793512627306, 22.973649782131062, 27.332540697479224, 22.554365567530525, -17.78942919042816, -27.251583691622372, 36.6534442315594, 45.34914642711294, 38.01762128834756, 39.61351898494276, 45.70656431637569, 49.574396926185756, 26.54974011929611, 40.8591560500535, 56.7260622988629, -3.2769031552520147, -48.91325776425705, -50.65934200711888, 18.364940672276546, 18.516777483374423, 16.861941487598667, 22.894097020712987, -1.456794446315394, 20.568167005057504, 29.576041704186707, 20.53063686742712, 44.032217733941316, 39.735367210999634, 32.83147208829039, -17.27628915709312, -45.267303079919266, -45.54404879177755, -51.53768170553276, -61.35989915886637, -51.35301014375938, -50.483170285907505, -33.483225493423916, -35.01916328769982, 53.41969470139653, 7.685653077511407, -61.441724377063764, -59.83266027885401, 11.922260841512257, 24.22388867890629, 38.91474671468562, 16.72178824879744, 18.623729451160486, 38.57219174434244, 12.777478505209235, 28.880372089887906, 15.93847181602683, 29.052138036571012, -54.80803138170042, -36.86309499874652, 27.32548123680482, 20.601221310891795, -63.92167460423049, -59.24383510679951, -26.758276065345683, -34.06255163570272, -51.38279125507659, -62.43713477391019, -28.28983096207336, -28.28062479838038, -47.971573870935245, -42.37003445987075, -53.56085794368842, -59.39369805952877, -18.593995611147683, -32.667875052985885, -47.466895293020876, -49.77709154362894, -54.82969508943593, -52.16815364063589, -36.75923756230936, -33.14561515295888, 50.501568723817215, 41.54337041905825, -69.59987670489706, -52.53661161446383, -32.453674342751135, -41.69838238003899, -54.202608939205106, -48.091258953809, -53.19249487529262, -38.186277603433716, -55.59888359380955, -38.58688813255491, -51.54685131469163, -41.693987557011155, -43.529182283205785, -64.83242130532557, 38.902048945179274, 29.734252267455012, -48.397743301743745, -62.28034449758906, -58.31259367391923, -49.45412142747498, -49.13762332208225, -44.013250798083746, -42.164682008596586, -26.245992665927982, -1.277583913931192, -53.69014937609448, -23.581917606792736, -16.17813109711839, -33.101048881935, -30.90765475241823, -34.12574040144407, -29.67691558026855, -56.99533015752533, -20.472794677974022, -28.08335585631014, -38.78609626666588, 9.46197449377759, 19.398338088877498, -54.640613489660986, -46.0705351170015, -48.440664489829956, -13.578898020418656, -38.61125226307618, -42.30970190572962]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42908842205445624, "mean_inference_ms": 1.1335265917997492, "mean_action_processing_ms": 0.1842660057146432, "mean_env_wait_ms": 0.07546076507257843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003384828567504883, "StateBufferConnector_ms": 0.00339353084564209, "ViewRequirementAgentConnector_ms": 0.06786656379699707}, "num_episodes": 11, "episode_return_max": 47.640480621280716, "episode_return_min": -61.58275485551502, "episode_return_mean": -2.173334728236444}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 492.7268005302714, "num_env_steps_trained_throughput_per_sec": 492.7268005302714, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 8178.894, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8178.859, "sample_time_ms": 770.858, "learn_time_ms": 7394.648, "learn_throughput": 540.932, "synch_weights_time_ms": 12.906}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 126, "trial_id": "83a5c_00000", "date": "2024-08-10_12-31-54", "timestamp": 1723307514, "time_this_iter_s": 8.122879981994629, "time_total_s": 1076.1858036518097, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1076.1858036518097, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 25.566666666666666, "ram_util_percent": 82.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6066815976427975, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.148518439070888, "policy_loss": -0.004099015065927117, "vf_loss": 5.151918947885907, "vf_explained_var": -0.11148031984687483, "kl": 0.013781808140058025, "entropy": 1.2496882555976747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.090325310950478, "cur_kl_coeff": 0.0002969658002257347, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5421197077880304, "policy_loss": -0.006907543430861552, "vf_loss": 3.5490253239870073, "vf_explained_var": 0.4590115899220109, "kl": 0.006496934263199853, "entropy": 0.4119497666445871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "env_runners": {"episode_reward_max": 47.640480621280716, "episode_reward_min": -61.58275485551502, "episode_reward_mean": -6.010722008485385, "episode_len_mean": 313.75, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 31375, "policy_reward_min": {"agent_policy": -47.640480621280716, "adversary_policy": -69.59987670489706}, "policy_reward_max": {"agent_policy": 61.58275485551501, "adversary_policy": 56.7260622988629}, "policy_reward_mean": {"agent_policy": 6.010722008485387, "adversary_policy": -6.010722008485386}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.85248885550261, 12.530046313289949, 29.566095656636627, 7.085328372979533, 20.079369897730764, 16.200989627758332, 28.718053577355654, 20.205245017183046, 10.509272794655123, 25.021252674586545, 21.041553441586863, 4.4696967985489, 23.543380652913516, 13.308407616600935, -20.472036916677165, 29.825211760655577, 24.417331779199326, 22.55890989194578, 8.49870511823913, 19.749165228915004, 29.962647730965543, 17.037214112701385, 19.785034873937267, 24.962221423012146, 10.409166342682294, 22.7797886745257, 19.20622976122322, 35.062122596831365, 31.945380139466376, 42.351357290774814, 28.56579245420209, 24.943453132504864, -22.520506441025265, 41.001295329336166, 38.81557013664509, 47.640480621280716, 33.7044480846748, 26.724579571805446, -49.786299885687974, 18.44085907782548, 19.878019254155827, 9.55568627937105, 25.053339285806913, 41.8837924724705, 7.777591465598629, -45.40567593584839, -56.448790432199566, -50.918090214833455, -34.251194390561864, 30.552673889453985, -60.6371923279589, 18.073074760209284, 27.81826748174155, 28.597960597751467, 20.828925297548565, 22.49530492629892, -45.83556319022346, 23.96335127384833, -61.58275485551502, -30.4104138505242, -56.90996301449339, -28.28522788022685, -45.170804165403, -56.477278001608575, -25.630935332066784, -48.621993418324905, -53.49892436503591, -34.952426357634124, 46.022469571437746, -61.06824415968045, -37.07602836139507, -51.14693394650708, -45.68938623936316, -47.09288586318225, -46.620419435851396, -54.180801794265655, 34.31815060631714, -55.33904389966638, -53.8833575506971, -46.57543706008299, -34.20533733726228, -27.483866645012842, -19.880024351955566, -32.00435181717661, -31.90132799085631, -38.73406241774966, -33.434726061487986, 14.430156291327542, -50.35557430333122, -31.009781255124302, -40.4604770844029, -22.40866250444837, -19.37655699676516, -14.524672969585882, 0.6309172535026686, -36.36726934785906, -28.786327133495586, -25.65333330961357, -4.374941890103511, -30.020125283285598], "episode_lengths": [236, 46, 172, 391, 350, 219, 126, 400, 400, 386, 230, 116, 400, 103, 400, 205, 346, 323, 30, 253, 400, 148, 122, 221, 183, 365, 382, 400, 167, 400, 300, 191, 400, 324, 400, 222, 281, 196, 400, 156, 217, 166, 223, 367, 24, 400, 400, 400, 400, 148, 400, 261, 202, 44, 228, 251, 400, 220, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 343, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 241, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-23.8524888555026, -12.530046313289953, -29.566095656636637, -7.085328372979539, -20.079369897730775, -16.20098962775834, -28.718053577355654, -20.20524501718305, -10.509272794655127, -25.021252674586542, -21.041553441586863, -4.4696967985489, -23.54338065291354, -13.308407616600933, 20.472036916677173, -29.825211760655545, -24.417331779199337, -22.55890989194578, -8.498705118239128, -19.749165228915018, -29.962647730965532, -17.037214112701385, -19.785034873937263, -24.962221423012146, -10.40916634268229, -22.779788674525708, -19.20622976122325, -35.062122596831365, -31.945380139466355, -42.35135729077482, -28.56579245420205, -24.943453132504885, 22.520506441025265, -41.00129532933615, -38.81557013664515, -47.640480621280716, -33.70444808467479, -26.724579571805442, 49.78629988568798, -18.440859077825486, -19.878019254155824, -9.555686279371054, -25.053339285806913, -41.88379247247049, -7.777591465598632, 45.405675935848414, 56.44879043219956, 50.91809021483345, 34.251194390561864, -30.552673889453974, 60.63719232795891, -18.073074760209277, -27.818267481741533, -28.597960597751474, -20.828925297548565, -22.495304926298918, 45.83556319022347, -23.963351273848314, 61.58275485551501, 30.4104138505242, 56.909963014493385, 28.285227880226856, 45.17080416540299, 56.47727800160857, 25.630935332066784, 48.6219934183249, 53.49892436503592, 34.952426357634124, -46.02246957143775, 61.06824415968044, 37.076028361395075, 51.146933946507076, 45.68938623936317, 47.092885863182225, 46.62041943585139, 54.18080179426565, -34.318150606317154, 55.33904389966637, 53.883357550697106, 46.57543706008298, 34.20533733726228, 27.483866645012842, 19.880024351955566, 32.00435181717661, 31.90132799085631, 38.73406241774967, 33.43472606148801, -14.430156291327542, 50.35557430333121, 31.009781255124302, 40.460477084402896, 22.408662504448365, 19.376556996765164, 14.524672969585877, -0.6309172535026684, 36.367269347859065, 28.78632713349561, 25.653333309613565, 4.374941890103512, 30.020125283285594], "policy_adversary_policy_reward": [5.299909916519102, 42.40506779448611, 9.28626938544205, 15.77382324113785, 23.204944378239432, 35.92724693503385, 3.7289461211083044, 10.441710624850778, 19.65408421179363, 20.50465558366792, 17.716780449619257, 14.685198805897425, 37.58082471105023, 19.855282443661075, 24.892889732942727, 15.517600301423379, 5.463724142587923, 15.554821446722343, 43.7439860352102, 6.298519313962825, 30.268846065102213, 11.814260818071528, 22.637486036772962, -13.698092439675165, 32.29779611140646, 14.788965194420584, 18.493105370960098, 8.12370986224177, -9.385222092415972, -31.558851740938366, 28.054299772027825, 31.59612374928332, 22.217678474587416, 26.61698508381125, 16.846352070530557, 28.271467713360984, -18.53372469683075, 35.531134933309005, 14.407099324304905, 25.091231133525113, 21.67889805845838, 38.24639740347265, 11.363175062462076, 22.71125316294069, 18.511506509788664, 21.058563238085878, 15.096407064347556, 34.82803578167673, 17.76443354863798, 3.053899136726603, 17.80205348707806, 27.75752386197335, 13.695833974742985, 24.71662554770349, 27.765076552460926, 42.359168641201784, 31.047332141903563, 32.84342813702918, 42.37859640271751, 42.32411817883209, 34.15793512627306, 22.973649782131062, 27.332540697479224, 22.554365567530525, -17.78942919042816, -27.251583691622372, 36.6534442315594, 45.34914642711294, 38.01762128834756, 39.61351898494276, 45.70656431637569, 49.574396926185756, 26.54974011929611, 40.8591560500535, 56.7260622988629, -3.2769031552520147, -48.91325776425705, -50.65934200711888, 18.364940672276546, 18.516777483374423, 16.861941487598667, 22.894097020712987, -1.456794446315394, 20.568167005057504, 29.576041704186707, 20.53063686742712, 44.032217733941316, 39.735367210999634, 32.83147208829039, -17.27628915709312, -45.267303079919266, -45.54404879177755, -51.53768170553276, -61.35989915886637, -51.35301014375938, -50.483170285907505, -33.483225493423916, -35.01916328769982, 53.41969470139653, 7.685653077511407, -61.441724377063764, -59.83266027885401, 11.922260841512257, 24.22388867890629, 38.91474671468562, 16.72178824879744, 18.623729451160486, 38.57219174434244, 12.777478505209235, 28.880372089887906, 15.93847181602683, 29.052138036571012, -54.80803138170042, -36.86309499874652, 27.32548123680482, 20.601221310891795, -63.92167460423049, -59.24383510679951, -26.758276065345683, -34.06255163570272, -51.38279125507659, -62.43713477391019, -28.28983096207336, -28.28062479838038, -47.971573870935245, -42.37003445987075, -53.56085794368842, -59.39369805952877, -18.593995611147683, -32.667875052985885, -47.466895293020876, -49.77709154362894, -54.82969508943593, -52.16815364063589, -36.75923756230936, -33.14561515295888, 50.501568723817215, 41.54337041905825, -69.59987670489706, -52.53661161446383, -32.453674342751135, -41.69838238003899, -54.202608939205106, -48.091258953809, -53.19249487529262, -38.186277603433716, -55.59888359380955, -38.58688813255491, -51.54685131469163, -41.693987557011155, -43.529182283205785, -64.83242130532557, 38.902048945179274, 29.734252267455012, -48.397743301743745, -62.28034449758906, -58.31259367391923, -49.45412142747498, -49.13762332208225, -44.013250798083746, -42.164682008596586, -26.245992665927982, -1.277583913931192, -53.69014937609448, -23.581917606792736, -16.17813109711839, -33.101048881935, -30.90765475241823, -34.12574040144407, -29.67691558026855, -56.99533015752533, -20.472794677974022, -28.08335585631014, -38.78609626666588, 9.46197449377759, 19.398338088877498, -54.640613489660986, -46.0705351170015, -48.440664489829956, -13.578898020418656, -38.61125226307618, -42.30970190572962, -19.336653227273732, -25.480671781622988, -16.31302917206915, -22.44008482146117, -34.21847620614963, 5.169130266977874, 6.771844522718025, -5.5100100157126874, -31.174536914583555, -41.56000178113454, -0.3742094851050801, -57.19844478188612, -43.291012188461366, -8.015654430765764, 1.262183741680282, -10.01206752188731, 1.6603521810847823, -61.700602747655985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4288896093056186, "mean_inference_ms": 1.1329137112337897, "mean_action_processing_ms": 0.18413045964193345, "mean_env_wait_ms": 0.07541523176468319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033092498779296875, "StateBufferConnector_ms": 0.0034041404724121094, "ViewRequirementAgentConnector_ms": 0.07051420211791992}, "num_episodes": 9, "episode_return_max": 47.640480621280716, "episode_return_min": -61.58275485551502, "episode_return_mean": -6.010722008485385}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.67040074617387, "num_env_steps_trained_throughput_per_sec": 486.67040074617387, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 1524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1524000, "timers": {"training_iteration_time_ms": 8187.585, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8187.551, "sample_time_ms": 783.112, "learn_time_ms": 7391.244, "learn_throughput": 541.181, "synch_weights_time_ms": 12.751}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 1524000, "num_agent_steps_trained": 1524000}, "done": false, "training_iteration": 127, "trial_id": "83a5c_00000", "date": "2024-08-10_12-32-02", "timestamp": 1723307522, "time_this_iter_s": 8.22434401512146, "time_total_s": 1084.4101476669312, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1084.4101476669312, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 26.924999999999997, "ram_util_percent": 82.88333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.321655176461689, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.042645409245971, "policy_loss": -0.005541690288693028, "vf_loss": 5.047412301749779, "vf_explained_var": -0.016536574735843315, "kl": 0.015287189614255016, "entropy": 1.2878408478681374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.396345353809496, "cur_kl_coeff": 0.0002969658002257347, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.174227512876192, "policy_loss": -0.007268721562286373, "vf_loss": 4.181491025537253, "vf_explained_var": 0.27679169178009033, "kl": 0.017549507076472393, "entropy": 0.4448387047586342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 47.640480621280716, "episode_reward_min": -61.58275485551502, "episode_reward_mean": -9.396636210655954, "episode_len_mean": 323.5, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 32350, "policy_reward_min": {"agent_policy": -47.640480621280716, "adversary_policy": -69.59987670489706}, "policy_reward_max": {"agent_policy": 61.58275485551501, "adversary_policy": 56.7260622988629}, "policy_reward_mean": {"agent_policy": 9.396636210655952, "adversary_policy": -9.396636210655954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.543380652913516, 13.308407616600935, -20.472036916677165, 29.825211760655577, 24.417331779199326, 22.55890989194578, 8.49870511823913, 19.749165228915004, 29.962647730965543, 17.037214112701385, 19.785034873937267, 24.962221423012146, 10.409166342682294, 22.7797886745257, 19.20622976122322, 35.062122596831365, 31.945380139466376, 42.351357290774814, 28.56579245420209, 24.943453132504864, -22.520506441025265, 41.001295329336166, 38.81557013664509, 47.640480621280716, 33.7044480846748, 26.724579571805446, -49.786299885687974, 18.44085907782548, 19.878019254155827, 9.55568627937105, 25.053339285806913, 41.8837924724705, 7.777591465598629, -45.40567593584839, -56.448790432199566, -50.918090214833455, -34.251194390561864, 30.552673889453985, -60.6371923279589, 18.073074760209284, 27.81826748174155, 28.597960597751467, 20.828925297548565, 22.49530492629892, -45.83556319022346, 23.96335127384833, -61.58275485551502, -30.4104138505242, -56.90996301449339, -28.28522788022685, -45.170804165403, -56.477278001608575, -25.630935332066784, -48.621993418324905, -53.49892436503591, -34.952426357634124, 46.022469571437746, -61.06824415968045, -37.07602836139507, -51.14693394650708, -45.68938623936316, -47.09288586318225, -46.620419435851396, -54.180801794265655, 34.31815060631714, -55.33904389966638, -53.8833575506971, -46.57543706008299, -34.20533733726228, -27.483866645012842, -19.880024351955566, -32.00435181717661, -31.90132799085631, -38.73406241774966, -33.434726061487986, 14.430156291327542, -50.35557430333122, -31.009781255124302, -40.4604770844029, -22.40866250444837, -19.37655699676516, -14.524672969585882, 0.6309172535026686, -36.36726934785906, -28.786327133495586, -25.65333330961357, -4.374941890103511, -30.020125283285598, -13.545783529833095, -23.102413212885146, 3.8250041354040136, 7.83242766537667, -7.553221647161919, -24.773849875084114, -19.33626001445556, -18.77476464534791, -18.547804430579745, -11.21267678446568, 11.56342205661286, -5.686106906823069], "episode_lengths": [400, 103, 400, 205, 346, 323, 30, 253, 400, 148, 122, 221, 183, 365, 382, 400, 167, 400, 300, 191, 400, 324, 400, 222, 281, 196, 400, 156, 217, 166, 223, 367, 24, 400, 400, 400, 400, 148, 400, 261, 202, 44, 228, 251, 400, 220, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 343, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 241, 400, 400, 400, 400, 400, 400, 400, 26, 21, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-23.54338065291354, -13.308407616600933, 20.472036916677173, -29.825211760655545, -24.417331779199337, -22.55890989194578, -8.498705118239128, -19.749165228915018, -29.962647730965532, -17.037214112701385, -19.785034873937263, -24.962221423012146, -10.40916634268229, -22.779788674525708, -19.20622976122325, -35.062122596831365, -31.945380139466355, -42.35135729077482, -28.56579245420205, -24.943453132504885, 22.520506441025265, -41.00129532933615, -38.81557013664515, -47.640480621280716, -33.70444808467479, -26.724579571805442, 49.78629988568798, -18.440859077825486, -19.878019254155824, -9.555686279371054, -25.053339285806913, -41.88379247247049, -7.777591465598632, 45.405675935848414, 56.44879043219956, 50.91809021483345, 34.251194390561864, -30.552673889453974, 60.63719232795891, -18.073074760209277, -27.818267481741533, -28.597960597751474, -20.828925297548565, -22.495304926298918, 45.83556319022347, -23.963351273848314, 61.58275485551501, 30.4104138505242, 56.909963014493385, 28.285227880226856, 45.17080416540299, 56.47727800160857, 25.630935332066784, 48.6219934183249, 53.49892436503592, 34.952426357634124, -46.02246957143775, 61.06824415968044, 37.076028361395075, 51.146933946507076, 45.68938623936317, 47.092885863182225, 46.62041943585139, 54.18080179426565, -34.318150606317154, 55.33904389966637, 53.883357550697106, 46.57543706008298, 34.20533733726228, 27.483866645012842, 19.880024351955566, 32.00435181717661, 31.90132799085631, 38.73406241774967, 33.43472606148801, -14.430156291327542, 50.35557430333121, 31.009781255124302, 40.460477084402896, 22.408662504448365, 19.376556996765164, 14.524672969585877, -0.6309172535026684, 36.367269347859065, 28.78632713349561, 25.653333309613565, 4.374941890103512, 30.020125283285594, 13.545783529833095, 23.102413212885143, -3.825004135404014, -7.832427665376672, 7.553221647161925, 24.77384987508411, 19.336260014455558, 18.77476464534792, 18.547804430579756, 11.21267678446568, -11.563422056612849, 5.6861069068231025], "policy_adversary_policy_reward": [32.29779611140646, 14.788965194420584, 18.493105370960098, 8.12370986224177, -9.385222092415972, -31.558851740938366, 28.054299772027825, 31.59612374928332, 22.217678474587416, 26.61698508381125, 16.846352070530557, 28.271467713360984, -18.53372469683075, 35.531134933309005, 14.407099324304905, 25.091231133525113, 21.67889805845838, 38.24639740347265, 11.363175062462076, 22.71125316294069, 18.511506509788664, 21.058563238085878, 15.096407064347556, 34.82803578167673, 17.76443354863798, 3.053899136726603, 17.80205348707806, 27.75752386197335, 13.695833974742985, 24.71662554770349, 27.765076552460926, 42.359168641201784, 31.047332141903563, 32.84342813702918, 42.37859640271751, 42.32411817883209, 34.15793512627306, 22.973649782131062, 27.332540697479224, 22.554365567530525, -17.78942919042816, -27.251583691622372, 36.6534442315594, 45.34914642711294, 38.01762128834756, 39.61351898494276, 45.70656431637569, 49.574396926185756, 26.54974011929611, 40.8591560500535, 56.7260622988629, -3.2769031552520147, -48.91325776425705, -50.65934200711888, 18.364940672276546, 18.516777483374423, 16.861941487598667, 22.894097020712987, -1.456794446315394, 20.568167005057504, 29.576041704186707, 20.53063686742712, 44.032217733941316, 39.735367210999634, 32.83147208829039, -17.27628915709312, -45.267303079919266, -45.54404879177755, -51.53768170553276, -61.35989915886637, -51.35301014375938, -50.483170285907505, -33.483225493423916, -35.01916328769982, 53.41969470139653, 7.685653077511407, -61.441724377063764, -59.83266027885401, 11.922260841512257, 24.22388867890629, 38.91474671468562, 16.72178824879744, 18.623729451160486, 38.57219174434244, 12.777478505209235, 28.880372089887906, 15.93847181602683, 29.052138036571012, -54.80803138170042, -36.86309499874652, 27.32548123680482, 20.601221310891795, -63.92167460423049, -59.24383510679951, -26.758276065345683, -34.06255163570272, -51.38279125507659, -62.43713477391019, -28.28983096207336, -28.28062479838038, -47.971573870935245, -42.37003445987075, -53.56085794368842, -59.39369805952877, -18.593995611147683, -32.667875052985885, -47.466895293020876, -49.77709154362894, -54.82969508943593, -52.16815364063589, -36.75923756230936, -33.14561515295888, 50.501568723817215, 41.54337041905825, -69.59987670489706, -52.53661161446383, -32.453674342751135, -41.69838238003899, -54.202608939205106, -48.091258953809, -53.19249487529262, -38.186277603433716, -55.59888359380955, -38.58688813255491, -51.54685131469163, -41.693987557011155, -43.529182283205785, -64.83242130532557, 38.902048945179274, 29.734252267455012, -48.397743301743745, -62.28034449758906, -58.31259367391923, -49.45412142747498, -49.13762332208225, -44.013250798083746, -42.164682008596586, -26.245992665927982, -1.277583913931192, -53.69014937609448, -23.581917606792736, -16.17813109711839, -33.101048881935, -30.90765475241823, -34.12574040144407, -29.67691558026855, -56.99533015752533, -20.472794677974022, -28.08335585631014, -38.78609626666588, 9.46197449377759, 19.398338088877498, -54.640613489660986, -46.0705351170015, -48.440664489829956, -13.578898020418656, -38.61125226307618, -42.30970190572962, -19.336653227273732, -25.480671781622988, -16.31302917206915, -22.44008482146117, -34.21847620614963, 5.169130266977874, 6.771844522718025, -5.5100100157126874, -31.174536914583555, -41.56000178113454, -0.3742094851050801, -57.19844478188612, -43.291012188461366, -8.015654430765764, 1.262183741680282, -10.01206752188731, 1.6603521810847823, -61.700602747655985, 9.092521993470193, -36.18408905313638, -12.016623984127698, -34.18820244164255, 3.978766118642131, 3.6712421521658967, 11.346241216606948, 4.318614114146392, -9.185544896714365, -5.920898397609481, -21.43993238684234, -28.107767363325912, -21.16301413639513, -17.50950589251599, -42.51093027364058, 4.9614009829447525, -29.634760455397526, -7.4608484057619755, -4.75456845318913, -17.67078511574223, 10.321297331737341, 12.805546781488296, 4.577192275407818, -15.949406089054001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4286805422997198, "mean_inference_ms": 1.132248284067708, "mean_action_processing_ms": 0.18403420307834017, "mean_env_wait_ms": 0.07535565515266751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034024715423583984, "StateBufferConnector_ms": 0.0034323930740356445, "ViewRequirementAgentConnector_ms": 0.07195794582366943}, "num_episodes": 12, "episode_return_max": 47.640480621280716, "episode_return_min": -61.58275485551502, "episode_return_mean": -9.396636210655954}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.8287618354941, "num_env_steps_trained_throughput_per_sec": 491.8287618354941, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 8209.094, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8209.059, "sample_time_ms": 793.836, "learn_time_ms": 7402.217, "learn_throughput": 540.379, "synch_weights_time_ms": 12.553}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 128, "trial_id": "83a5c_00000", "date": "2024-08-10_12-32-10", "timestamp": 1723307530, "time_this_iter_s": 8.138637065887451, "time_total_s": 1092.5487847328186, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31faad940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1092.5487847328186, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 26.44545454545455, "ram_util_percent": 82.94545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.639313028161488, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.963293932354639, "policy_loss": -0.007482462703427744, "vf_loss": 4.970044328926733, "vf_explained_var": -0.010196641260984714, "kl": 0.014444459038082386, "entropy": 1.130576140918429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.287718389804165, "cur_kl_coeff": 0.0002969658002257347, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.548635131617387, "policy_loss": -0.006037291125297392, "vf_loss": 3.5546708956360815, "vf_explained_var": 0.3783380569890141, "kl": 0.005139202068431926, "entropy": 0.36103823794983325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "env_runners": {"episode_reward_max": 47.640480621280716, "episode_reward_min": -61.58275485551502, "episode_reward_mean": -12.41830690729122, "episode_len_mean": 337.32, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 33732, "policy_reward_min": {"agent_policy": -47.640480621280716, "adversary_policy": -69.59987670489706}, "policy_reward_max": {"agent_policy": 61.58275485551501, "adversary_policy": 56.7260622988629}, "policy_reward_mean": {"agent_policy": 12.41830690729122, "adversary_policy": -12.41830690729122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.785034873937267, 24.962221423012146, 10.409166342682294, 22.7797886745257, 19.20622976122322, 35.062122596831365, 31.945380139466376, 42.351357290774814, 28.56579245420209, 24.943453132504864, -22.520506441025265, 41.001295329336166, 38.81557013664509, 47.640480621280716, 33.7044480846748, 26.724579571805446, -49.786299885687974, 18.44085907782548, 19.878019254155827, 9.55568627937105, 25.053339285806913, 41.8837924724705, 7.777591465598629, -45.40567593584839, -56.448790432199566, -50.918090214833455, -34.251194390561864, 30.552673889453985, -60.6371923279589, 18.073074760209284, 27.81826748174155, 28.597960597751467, 20.828925297548565, 22.49530492629892, -45.83556319022346, 23.96335127384833, -61.58275485551502, -30.4104138505242, -56.90996301449339, -28.28522788022685, -45.170804165403, -56.477278001608575, -25.630935332066784, -48.621993418324905, -53.49892436503591, -34.952426357634124, 46.022469571437746, -61.06824415968045, -37.07602836139507, -51.14693394650708, -45.68938623936316, -47.09288586318225, -46.620419435851396, -54.180801794265655, 34.31815060631714, -55.33904389966638, -53.8833575506971, -46.57543706008299, -34.20533733726228, -27.483866645012842, -19.880024351955566, -32.00435181717661, -31.90132799085631, -38.73406241774966, -33.434726061487986, 14.430156291327542, -50.35557430333122, -31.009781255124302, -40.4604770844029, -22.40866250444837, -19.37655699676516, -14.524672969585882, 0.6309172535026686, -36.36726934785906, -28.786327133495586, -25.65333330961357, -4.374941890103511, -30.020125283285598, -13.545783529833095, -23.102413212885146, 3.8250041354040136, 7.83242766537667, -7.553221647161919, -24.773849875084114, -19.33626001445556, -18.77476464534791, -18.547804430579745, -11.21267678446568, 11.56342205661286, -5.686106906823069, -27.560923459110455, -19.154706556620464, -13.526086600971134, -10.409853268861244, -30.469157816933784, -0.5892189043577734, 18.80116605462246, 8.04923582052077, -33.48591734320984, -25.392670613146], "episode_lengths": [122, 221, 183, 365, 382, 400, 167, 400, 300, 191, 400, 324, 400, 222, 281, 196, 400, 156, 217, 166, 223, 367, 24, 400, 400, 400, 400, 148, 400, 261, 202, 44, 228, 251, 400, 220, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 343, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 241, 400, 400, 400, 400, 400, 400, 400, 26, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 400], "policy_agent_policy_reward": [-19.785034873937263, -24.962221423012146, -10.40916634268229, -22.779788674525708, -19.20622976122325, -35.062122596831365, -31.945380139466355, -42.35135729077482, -28.56579245420205, -24.943453132504885, 22.520506441025265, -41.00129532933615, -38.81557013664515, -47.640480621280716, -33.70444808467479, -26.724579571805442, 49.78629988568798, -18.440859077825486, -19.878019254155824, -9.555686279371054, -25.053339285806913, -41.88379247247049, -7.777591465598632, 45.405675935848414, 56.44879043219956, 50.91809021483345, 34.251194390561864, -30.552673889453974, 60.63719232795891, -18.073074760209277, -27.818267481741533, -28.597960597751474, -20.828925297548565, -22.495304926298918, 45.83556319022347, -23.963351273848314, 61.58275485551501, 30.4104138505242, 56.909963014493385, 28.285227880226856, 45.17080416540299, 56.47727800160857, 25.630935332066784, 48.6219934183249, 53.49892436503592, 34.952426357634124, -46.02246957143775, 61.06824415968044, 37.076028361395075, 51.146933946507076, 45.68938623936317, 47.092885863182225, 46.62041943585139, 54.18080179426565, -34.318150606317154, 55.33904389966637, 53.883357550697106, 46.57543706008298, 34.20533733726228, 27.483866645012842, 19.880024351955566, 32.00435181717661, 31.90132799085631, 38.73406241774967, 33.43472606148801, -14.430156291327542, 50.35557430333121, 31.009781255124302, 40.460477084402896, 22.408662504448365, 19.376556996765164, 14.524672969585877, -0.6309172535026684, 36.367269347859065, 28.78632713349561, 25.653333309613565, 4.374941890103512, 30.020125283285594, 13.545783529833095, 23.102413212885143, -3.825004135404014, -7.832427665376672, 7.553221647161925, 24.77384987508411, 19.336260014455558, 18.77476464534792, 18.547804430579756, 11.21267678446568, -11.563422056612849, 5.6861069068231025, 27.56092345911045, 19.15470655662046, 13.526086600971135, 10.409853268861244, 30.469157816933794, 0.5892189043577734, -18.801166054622456, -8.049235820520765, 33.48591734320986, 25.392670613145995], "policy_adversary_policy_reward": [18.511506509788664, 21.058563238085878, 15.096407064347556, 34.82803578167673, 17.76443354863798, 3.053899136726603, 17.80205348707806, 27.75752386197335, 13.695833974742985, 24.71662554770349, 27.765076552460926, 42.359168641201784, 31.047332141903563, 32.84342813702918, 42.37859640271751, 42.32411817883209, 34.15793512627306, 22.973649782131062, 27.332540697479224, 22.554365567530525, -17.78942919042816, -27.251583691622372, 36.6534442315594, 45.34914642711294, 38.01762128834756, 39.61351898494276, 45.70656431637569, 49.574396926185756, 26.54974011929611, 40.8591560500535, 56.7260622988629, -3.2769031552520147, -48.91325776425705, -50.65934200711888, 18.364940672276546, 18.516777483374423, 16.861941487598667, 22.894097020712987, -1.456794446315394, 20.568167005057504, 29.576041704186707, 20.53063686742712, 44.032217733941316, 39.735367210999634, 32.83147208829039, -17.27628915709312, -45.267303079919266, -45.54404879177755, -51.53768170553276, -61.35989915886637, -51.35301014375938, -50.483170285907505, -33.483225493423916, -35.01916328769982, 53.41969470139653, 7.685653077511407, -61.441724377063764, -59.83266027885401, 11.922260841512257, 24.22388867890629, 38.91474671468562, 16.72178824879744, 18.623729451160486, 38.57219174434244, 12.777478505209235, 28.880372089887906, 15.93847181602683, 29.052138036571012, -54.80803138170042, -36.86309499874652, 27.32548123680482, 20.601221310891795, -63.92167460423049, -59.24383510679951, -26.758276065345683, -34.06255163570272, -51.38279125507659, -62.43713477391019, -28.28983096207336, -28.28062479838038, -47.971573870935245, -42.37003445987075, -53.56085794368842, -59.39369805952877, -18.593995611147683, -32.667875052985885, -47.466895293020876, -49.77709154362894, -54.82969508943593, -52.16815364063589, -36.75923756230936, -33.14561515295888, 50.501568723817215, 41.54337041905825, -69.59987670489706, -52.53661161446383, -32.453674342751135, -41.69838238003899, -54.202608939205106, -48.091258953809, -53.19249487529262, -38.186277603433716, -55.59888359380955, -38.58688813255491, -51.54685131469163, -41.693987557011155, -43.529182283205785, -64.83242130532557, 38.902048945179274, 29.734252267455012, -48.397743301743745, -62.28034449758906, -58.31259367391923, -49.45412142747498, -49.13762332208225, -44.013250798083746, -42.164682008596586, -26.245992665927982, -1.277583913931192, -53.69014937609448, -23.581917606792736, -16.17813109711839, -33.101048881935, -30.90765475241823, -34.12574040144407, -29.67691558026855, -56.99533015752533, -20.472794677974022, -28.08335585631014, -38.78609626666588, 9.46197449377759, 19.398338088877498, -54.640613489660986, -46.0705351170015, -48.440664489829956, -13.578898020418656, -38.61125226307618, -42.30970190572962, -19.336653227273732, -25.480671781622988, -16.31302917206915, -22.44008482146117, -34.21847620614963, 5.169130266977874, 6.771844522718025, -5.5100100157126874, -31.174536914583555, -41.56000178113454, -0.3742094851050801, -57.19844478188612, -43.291012188461366, -8.015654430765764, 1.262183741680282, -10.01206752188731, 1.6603521810847823, -61.700602747655985, 9.092521993470193, -36.18408905313638, -12.016623984127698, -34.18820244164255, 3.978766118642131, 3.6712421521658967, 11.346241216606948, 4.318614114146392, -9.185544896714365, -5.920898397609481, -21.43993238684234, -28.107767363325912, -21.16301413639513, -17.50950589251599, -42.51093027364058, 4.9614009829447525, -29.634760455397526, -7.4608484057619755, -4.75456845318913, -17.67078511574223, 10.321297331737341, 12.805546781488296, 4.577192275407818, -15.949406089054001, -23.021692217354662, -32.10015470086624, -15.860310326013796, -22.449102787227126, -2.872717806776553, -24.179455395165718, -9.44752467013296, -11.372181867589529, -28.700823403431407, -32.237492230436175, -16.741299292937004, 15.562861484221457, 21.437818988150205, 16.164513121094707, -3.743636418275594, 19.842108059317127, -22.197786534492757, -44.77404815192696, -36.183803985042815, -14.601537241249186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4284719078134183, "mean_inference_ms": 1.1317975631635853, "mean_action_processing_ms": 0.18399408518928959, "mean_env_wait_ms": 0.07529858090050003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034455060958862305, "StateBufferConnector_ms": 0.00345766544342041, "ViewRequirementAgentConnector_ms": 0.07388675212860107}, "num_episodes": 10, "episode_return_max": 47.640480621280716, "episode_return_min": -61.58275485551502, "episode_return_mean": -12.41830690729122}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 478.2079424422569, "num_env_steps_trained_throughput_per_sec": 478.2079424422569, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 1548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1548000, "timers": {"training_iteration_time_ms": 8173.437, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8173.401, "sample_time_ms": 793.497, "learn_time_ms": 7367.099, "learn_throughput": 542.955, "synch_weights_time_ms": 12.237}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 1548000, "num_agent_steps_trained": 1548000}, "done": false, "training_iteration": 129, "trial_id": "83a5c_00000", "date": "2024-08-10_12-32-19", "timestamp": 1723307539, "time_this_iter_s": 8.377279996871948, "time_total_s": 1100.9260647296906, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb6be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1100.9260647296906, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 28.825, "ram_util_percent": 83.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.607860324433241, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.565531675399296, "policy_loss": -0.005221416119476238, "vf_loss": 4.570200371868396, "vf_explained_var": 0.025610552546839235, "kl": 0.010905849101272989, "entropy": 1.1460095237487207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.174105038307607, "cur_kl_coeff": 0.0002969658002257347, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1963436029851438, "policy_loss": -0.004947744967648759, "vf_loss": 3.201289621119698, "vf_explained_var": 0.31103106352190174, "kl": 0.005819940063874303, "entropy": 0.3637045817604909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 47.640480621280716, "episode_reward_min": -61.58275485551502, "episode_reward_mean": -16.5131170766949, "episode_len_mean": 346.64, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 34664, "policy_reward_min": {"agent_policy": -47.640480621280716, "adversary_policy": -69.59987670489706}, "policy_reward_max": {"agent_policy": 61.58275485551501, "adversary_policy": 56.7260622988629}, "policy_reward_mean": {"agent_policy": 16.5131170766949, "adversary_policy": -16.513117076694904}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.81557013664509, 47.640480621280716, 33.7044480846748, 26.724579571805446, -49.786299885687974, 18.44085907782548, 19.878019254155827, 9.55568627937105, 25.053339285806913, 41.8837924724705, 7.777591465598629, -45.40567593584839, -56.448790432199566, -50.918090214833455, -34.251194390561864, 30.552673889453985, -60.6371923279589, 18.073074760209284, 27.81826748174155, 28.597960597751467, 20.828925297548565, 22.49530492629892, -45.83556319022346, 23.96335127384833, -61.58275485551502, -30.4104138505242, -56.90996301449339, -28.28522788022685, -45.170804165403, -56.477278001608575, -25.630935332066784, -48.621993418324905, -53.49892436503591, -34.952426357634124, 46.022469571437746, -61.06824415968045, -37.07602836139507, -51.14693394650708, -45.68938623936316, -47.09288586318225, -46.620419435851396, -54.180801794265655, 34.31815060631714, -55.33904389966638, -53.8833575506971, -46.57543706008299, -34.20533733726228, -27.483866645012842, -19.880024351955566, -32.00435181717661, -31.90132799085631, -38.73406241774966, -33.434726061487986, 14.430156291327542, -50.35557430333122, -31.009781255124302, -40.4604770844029, -22.40866250444837, -19.37655699676516, -14.524672969585882, 0.6309172535026686, -36.36726934785906, -28.786327133495586, -25.65333330961357, -4.374941890103511, -30.020125283285598, -13.545783529833095, -23.102413212885146, 3.8250041354040136, 7.83242766537667, -7.553221647161919, -24.773849875084114, -19.33626001445556, -18.77476464534791, -18.547804430579745, -11.21267678446568, 11.56342205661286, -5.686106906823069, -27.560923459110455, -19.154706556620464, -13.526086600971134, -10.409853268861244, -30.469157816933784, -0.5892189043577734, 18.80116605462246, 8.04923582052077, -33.48591734320984, -25.392670613146, -18.9584417918904, 10.643484820177713, 1.073651492314143, 24.10870015725556, -5.386670713176256, -39.378106008779795, -27.410412695778554, 15.530371544362753, -33.39439941755412, -4.344110487581123, -25.464162569636365, -28.009585692610862], "episode_lengths": [400, 222, 281, 196, 400, 156, 217, 166, 223, 367, 24, 400, 400, 400, 400, 148, 400, 261, 202, 44, 228, 251, 400, 220, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 343, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 241, 400, 400, 400, 400, 400, 400, 400, 26, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 358, 400, 400, 400, 400], "policy_agent_policy_reward": [-38.81557013664515, -47.640480621280716, -33.70444808467479, -26.724579571805442, 49.78629988568798, -18.440859077825486, -19.878019254155824, -9.555686279371054, -25.053339285806913, -41.88379247247049, -7.777591465598632, 45.405675935848414, 56.44879043219956, 50.91809021483345, 34.251194390561864, -30.552673889453974, 60.63719232795891, -18.073074760209277, -27.818267481741533, -28.597960597751474, -20.828925297548565, -22.495304926298918, 45.83556319022347, -23.963351273848314, 61.58275485551501, 30.4104138505242, 56.909963014493385, 28.285227880226856, 45.17080416540299, 56.47727800160857, 25.630935332066784, 48.6219934183249, 53.49892436503592, 34.952426357634124, -46.02246957143775, 61.06824415968044, 37.076028361395075, 51.146933946507076, 45.68938623936317, 47.092885863182225, 46.62041943585139, 54.18080179426565, -34.318150606317154, 55.33904389966637, 53.883357550697106, 46.57543706008298, 34.20533733726228, 27.483866645012842, 19.880024351955566, 32.00435181717661, 31.90132799085631, 38.73406241774967, 33.43472606148801, -14.430156291327542, 50.35557430333121, 31.009781255124302, 40.460477084402896, 22.408662504448365, 19.376556996765164, 14.524672969585877, -0.6309172535026684, 36.367269347859065, 28.78632713349561, 25.653333309613565, 4.374941890103512, 30.020125283285594, 13.545783529833095, 23.102413212885143, -3.825004135404014, -7.832427665376672, 7.553221647161925, 24.77384987508411, 19.336260014455558, 18.77476464534792, 18.547804430579756, 11.21267678446568, -11.563422056612849, 5.6861069068231025, 27.56092345911045, 19.15470655662046, 13.526086600971135, 10.409853268861244, 30.469157816933794, 0.5892189043577734, -18.801166054622456, -8.049235820520765, 33.48591734320986, 25.392670613145995, 18.9584417918904, -10.643484820177733, -1.0736514923141427, -24.108700157255576, 5.386670713176256, 39.37810600877979, 27.410412695778554, -15.530371544362751, 33.39439941755411, 4.344110487581123, 25.46416256963637, 28.00958569261086], "policy_adversary_policy_reward": [38.01762128834756, 39.61351898494276, 45.70656431637569, 49.574396926185756, 26.54974011929611, 40.8591560500535, 56.7260622988629, -3.2769031552520147, -48.91325776425705, -50.65934200711888, 18.364940672276546, 18.516777483374423, 16.861941487598667, 22.894097020712987, -1.456794446315394, 20.568167005057504, 29.576041704186707, 20.53063686742712, 44.032217733941316, 39.735367210999634, 32.83147208829039, -17.27628915709312, -45.267303079919266, -45.54404879177755, -51.53768170553276, -61.35989915886637, -51.35301014375938, -50.483170285907505, -33.483225493423916, -35.01916328769982, 53.41969470139653, 7.685653077511407, -61.441724377063764, -59.83266027885401, 11.922260841512257, 24.22388867890629, 38.91474671468562, 16.72178824879744, 18.623729451160486, 38.57219174434244, 12.777478505209235, 28.880372089887906, 15.93847181602683, 29.052138036571012, -54.80803138170042, -36.86309499874652, 27.32548123680482, 20.601221310891795, -63.92167460423049, -59.24383510679951, -26.758276065345683, -34.06255163570272, -51.38279125507659, -62.43713477391019, -28.28983096207336, -28.28062479838038, -47.971573870935245, -42.37003445987075, -53.56085794368842, -59.39369805952877, -18.593995611147683, -32.667875052985885, -47.466895293020876, -49.77709154362894, -54.82969508943593, -52.16815364063589, -36.75923756230936, -33.14561515295888, 50.501568723817215, 41.54337041905825, -69.59987670489706, -52.53661161446383, -32.453674342751135, -41.69838238003899, -54.202608939205106, -48.091258953809, -53.19249487529262, -38.186277603433716, -55.59888359380955, -38.58688813255491, -51.54685131469163, -41.693987557011155, -43.529182283205785, -64.83242130532557, 38.902048945179274, 29.734252267455012, -48.397743301743745, -62.28034449758906, -58.31259367391923, -49.45412142747498, -49.13762332208225, -44.013250798083746, -42.164682008596586, -26.245992665927982, -1.277583913931192, -53.69014937609448, -23.581917606792736, -16.17813109711839, -33.101048881935, -30.90765475241823, -34.12574040144407, -29.67691558026855, -56.99533015752533, -20.472794677974022, -28.08335585631014, -38.78609626666588, 9.46197449377759, 19.398338088877498, -54.640613489660986, -46.0705351170015, -48.440664489829956, -13.578898020418656, -38.61125226307618, -42.30970190572962, -19.336653227273732, -25.480671781622988, -16.31302917206915, -22.44008482146117, -34.21847620614963, 5.169130266977874, 6.771844522718025, -5.5100100157126874, -31.174536914583555, -41.56000178113454, -0.3742094851050801, -57.19844478188612, -43.291012188461366, -8.015654430765764, 1.262183741680282, -10.01206752188731, 1.6603521810847823, -61.700602747655985, 9.092521993470193, -36.18408905313638, -12.016623984127698, -34.18820244164255, 3.978766118642131, 3.6712421521658967, 11.346241216606948, 4.318614114146392, -9.185544896714365, -5.920898397609481, -21.43993238684234, -28.107767363325912, -21.16301413639513, -17.50950589251599, -42.51093027364058, 4.9614009829447525, -29.634760455397526, -7.4608484057619755, -4.75456845318913, -17.67078511574223, 10.321297331737341, 12.805546781488296, 4.577192275407818, -15.949406089054001, -23.021692217354662, -32.10015470086624, -15.860310326013796, -22.449102787227126, -2.872717806776553, -24.179455395165718, -9.44752467013296, -11.372181867589529, -28.700823403431407, -32.237492230436175, -16.741299292937004, 15.562861484221457, 21.437818988150205, 16.164513121094707, -3.743636418275594, 19.842108059317127, -22.197786534492757, -44.77404815192696, -36.183803985042815, -14.601537241249186, -11.945582220649491, -25.97130136313131, 5.043988907008572, 16.242980733346954, -0.03252889930083214, 2.1798318839291175, 31.864870863042253, 16.352529451468854, 8.851029867199152, -19.624371293551665, -26.567917779086933, -52.18829423847265, -29.045716973713866, -25.775108417843242, 10.726580314894765, 20.334162773830737, -33.4468605561327, -33.34193827897552, -6.644521488803143, -2.0436994863591025, -20.4442851497892, -30.48403998948354, -26.205391788308525, -29.813779596913193]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4281838922318042, "mean_inference_ms": 1.1309091398629412, "mean_action_processing_ms": 0.18379548783351787, "mean_env_wait_ms": 0.07524125416701742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032949447631835938, "StateBufferConnector_ms": 0.003427267074584961, "ViewRequirementAgentConnector_ms": 0.07321393489837646}, "num_episodes": 12, "episode_return_max": 47.640480621280716, "episode_return_min": -61.58275485551502, "episode_return_mean": -16.5131170766949}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 474.05064576948797, "num_env_steps_trained_throughput_per_sec": 474.05064576948797, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 8171.985, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8171.951, "sample_time_ms": 788.147, "learn_time_ms": 7370.778, "learn_throughput": 542.684, "synch_weights_time_ms": 12.46}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 130, "trial_id": "83a5c_00000", "date": "2024-08-10_12-32-27", "timestamp": 1723307547, "time_this_iter_s": 8.443192720413208, "time_total_s": 1109.3692574501038, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1109.3692574501038, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 28.85833333333333, "ram_util_percent": 82.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.810322792946346, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.896063922574281, "policy_loss": -0.00602658805289557, "vf_loss": 4.901275140015536, "vf_explained_var": -0.10689107034572218, "kl": 0.01608807153103323, "entropy": 1.3779902660026753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.692647535912693, "cur_kl_coeff": 0.0002969658002257347, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8555017227927846, "policy_loss": -0.02021184064433328, "vf_loss": 3.875706840803226, "vf_explained_var": 0.24670711134870846, "kl": 0.022673606700721532, "entropy": 0.4353471222023169, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "env_runners": {"episode_reward_max": 46.022469571437746, "episode_reward_min": -61.58275485551502, "episode_reward_mean": -18.23872035904206, "episode_len_mean": 357.32, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35732, "policy_reward_min": {"agent_policy": -46.02246957143775, "adversary_policy": -69.59987670489706}, "policy_reward_max": {"agent_policy": 61.58275485551501, "adversary_policy": 53.41969470139653}, "policy_reward_mean": {"agent_policy": 18.238720359042055, "adversary_policy": -18.238720359042063}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.40567593584839, -56.448790432199566, -50.918090214833455, -34.251194390561864, 30.552673889453985, -60.6371923279589, 18.073074760209284, 27.81826748174155, 28.597960597751467, 20.828925297548565, 22.49530492629892, -45.83556319022346, 23.96335127384833, -61.58275485551502, -30.4104138505242, -56.90996301449339, -28.28522788022685, -45.170804165403, -56.477278001608575, -25.630935332066784, -48.621993418324905, -53.49892436503591, -34.952426357634124, 46.022469571437746, -61.06824415968045, -37.07602836139507, -51.14693394650708, -45.68938623936316, -47.09288586318225, -46.620419435851396, -54.180801794265655, 34.31815060631714, -55.33904389966638, -53.8833575506971, -46.57543706008299, -34.20533733726228, -27.483866645012842, -19.880024351955566, -32.00435181717661, -31.90132799085631, -38.73406241774966, -33.434726061487986, 14.430156291327542, -50.35557430333122, -31.009781255124302, -40.4604770844029, -22.40866250444837, -19.37655699676516, -14.524672969585882, 0.6309172535026686, -36.36726934785906, -28.786327133495586, -25.65333330961357, -4.374941890103511, -30.020125283285598, -13.545783529833095, -23.102413212885146, 3.8250041354040136, 7.83242766537667, -7.553221647161919, -24.773849875084114, -19.33626001445556, -18.77476464534791, -18.547804430579745, -11.21267678446568, 11.56342205661286, -5.686106906823069, -27.560923459110455, -19.154706556620464, -13.526086600971134, -10.409853268861244, -30.469157816933784, -0.5892189043577734, 18.80116605462246, 8.04923582052077, -33.48591734320984, -25.392670613146, -18.9584417918904, 10.643484820177713, 1.073651492314143, 24.10870015725556, -5.386670713176256, -39.378106008779795, -27.410412695778554, 15.530371544362753, -33.39439941755412, -4.344110487581123, -25.464162569636365, -28.009585692610862, -17.516986057467584, 19.513728420961918, -18.78286869242898, 24.37098652314939, 7.913184528571032, 7.809297812086458, 10.462303182718818, 22.788328503522084, 2.7521303609814716, -2.7895479174120315, -9.392818535451969], "episode_lengths": [400, 400, 400, 400, 148, 400, 261, 202, 44, 228, 251, 400, 220, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 343, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 241, 400, 400, 400, 400, 400, 400, 400, 26, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 358, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 54, 400, 400, 400], "policy_agent_policy_reward": [45.405675935848414, 56.44879043219956, 50.91809021483345, 34.251194390561864, -30.552673889453974, 60.63719232795891, -18.073074760209277, -27.818267481741533, -28.597960597751474, -20.828925297548565, -22.495304926298918, 45.83556319022347, -23.963351273848314, 61.58275485551501, 30.4104138505242, 56.909963014493385, 28.285227880226856, 45.17080416540299, 56.47727800160857, 25.630935332066784, 48.6219934183249, 53.49892436503592, 34.952426357634124, -46.02246957143775, 61.06824415968044, 37.076028361395075, 51.146933946507076, 45.68938623936317, 47.092885863182225, 46.62041943585139, 54.18080179426565, -34.318150606317154, 55.33904389966637, 53.883357550697106, 46.57543706008298, 34.20533733726228, 27.483866645012842, 19.880024351955566, 32.00435181717661, 31.90132799085631, 38.73406241774967, 33.43472606148801, -14.430156291327542, 50.35557430333121, 31.009781255124302, 40.460477084402896, 22.408662504448365, 19.376556996765164, 14.524672969585877, -0.6309172535026684, 36.367269347859065, 28.78632713349561, 25.653333309613565, 4.374941890103512, 30.020125283285594, 13.545783529833095, 23.102413212885143, -3.825004135404014, -7.832427665376672, 7.553221647161925, 24.77384987508411, 19.336260014455558, 18.77476464534792, 18.547804430579756, 11.21267678446568, -11.563422056612849, 5.6861069068231025, 27.56092345911045, 19.15470655662046, 13.526086600971135, 10.409853268861244, 30.469157816933794, 0.5892189043577734, -18.801166054622456, -8.049235820520765, 33.48591734320986, 25.392670613145995, 18.9584417918904, -10.643484820177733, -1.0736514923141427, -24.108700157255576, 5.386670713176256, 39.37810600877979, 27.410412695778554, -15.530371544362751, 33.39439941755411, 4.344110487581123, 25.46416256963637, 28.00958569261086, 17.516986057467584, -19.51372842096191, 18.782868692428977, -24.370986523149387, -7.913184528571076, -7.809297812086452, -10.462303182718822, -22.78832850352209, -2.7521303609814716, 2.7895479174120332, 9.392818535451962], "policy_adversary_policy_reward": [-45.267303079919266, -45.54404879177755, -51.53768170553276, -61.35989915886637, -51.35301014375938, -50.483170285907505, -33.483225493423916, -35.01916328769982, 53.41969470139653, 7.685653077511407, -61.441724377063764, -59.83266027885401, 11.922260841512257, 24.22388867890629, 38.91474671468562, 16.72178824879744, 18.623729451160486, 38.57219174434244, 12.777478505209235, 28.880372089887906, 15.93847181602683, 29.052138036571012, -54.80803138170042, -36.86309499874652, 27.32548123680482, 20.601221310891795, -63.92167460423049, -59.24383510679951, -26.758276065345683, -34.06255163570272, -51.38279125507659, -62.43713477391019, -28.28983096207336, -28.28062479838038, -47.971573870935245, -42.37003445987075, -53.56085794368842, -59.39369805952877, -18.593995611147683, -32.667875052985885, -47.466895293020876, -49.77709154362894, -54.82969508943593, -52.16815364063589, -36.75923756230936, -33.14561515295888, 50.501568723817215, 41.54337041905825, -69.59987670489706, -52.53661161446383, -32.453674342751135, -41.69838238003899, -54.202608939205106, -48.091258953809, -53.19249487529262, -38.186277603433716, -55.59888359380955, -38.58688813255491, -51.54685131469163, -41.693987557011155, -43.529182283205785, -64.83242130532557, 38.902048945179274, 29.734252267455012, -48.397743301743745, -62.28034449758906, -58.31259367391923, -49.45412142747498, -49.13762332208225, -44.013250798083746, -42.164682008596586, -26.245992665927982, -1.277583913931192, -53.69014937609448, -23.581917606792736, -16.17813109711839, -33.101048881935, -30.90765475241823, -34.12574040144407, -29.67691558026855, -56.99533015752533, -20.472794677974022, -28.08335585631014, -38.78609626666588, 9.46197449377759, 19.398338088877498, -54.640613489660986, -46.0705351170015, -48.440664489829956, -13.578898020418656, -38.61125226307618, -42.30970190572962, -19.336653227273732, -25.480671781622988, -16.31302917206915, -22.44008482146117, -34.21847620614963, 5.169130266977874, 6.771844522718025, -5.5100100157126874, -31.174536914583555, -41.56000178113454, -0.3742094851050801, -57.19844478188612, -43.291012188461366, -8.015654430765764, 1.262183741680282, -10.01206752188731, 1.6603521810847823, -61.700602747655985, 9.092521993470193, -36.18408905313638, -12.016623984127698, -34.18820244164255, 3.978766118642131, 3.6712421521658967, 11.346241216606948, 4.318614114146392, -9.185544896714365, -5.920898397609481, -21.43993238684234, -28.107767363325912, -21.16301413639513, -17.50950589251599, -42.51093027364058, 4.9614009829447525, -29.634760455397526, -7.4608484057619755, -4.75456845318913, -17.67078511574223, 10.321297331737341, 12.805546781488296, 4.577192275407818, -15.949406089054001, -23.021692217354662, -32.10015470086624, -15.860310326013796, -22.449102787227126, -2.872717806776553, -24.179455395165718, -9.44752467013296, -11.372181867589529, -28.700823403431407, -32.237492230436175, -16.741299292937004, 15.562861484221457, 21.437818988150205, 16.164513121094707, -3.743636418275594, 19.842108059317127, -22.197786534492757, -44.77404815192696, -36.183803985042815, -14.601537241249186, -11.945582220649491, -25.97130136313131, 5.043988907008572, 16.242980733346954, -0.03252889930083214, 2.1798318839291175, 31.864870863042253, 16.352529451468854, 8.851029867199152, -19.624371293551665, -26.567917779086933, -52.18829423847265, -29.045716973713866, -25.775108417843242, 10.726580314894765, 20.334162773830737, -33.4468605561327, -33.34193827897552, -6.644521488803143, -2.0436994863591025, -20.4442851497892, -30.48403998948354, -26.205391788308525, -29.813779596913193, -16.754922961408287, -18.27904915352688, 28.34260771046421, 10.684849131459606, -13.77671849701824, -23.78901888783973, 34.19627131462453, 14.545701731674242, 8.181759168325538, 7.644609888816564, 0.29310952129566203, 15.325486102877242, 7.617580685594248, 13.307025679843395, 24.472283127672025, 21.104373879372144, 5.572906718633483, -0.06864599667053994, -15.845015566347712, 10.265919731523649, -25.307988895470796, 6.522351824566879]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4280348002040806, "mean_inference_ms": 1.1301458551862367, "mean_action_processing_ms": 0.18371593626703597, "mean_env_wait_ms": 0.0751689586663176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033005475997924805, "StateBufferConnector_ms": 0.0034148693084716797, "ViewRequirementAgentConnector_ms": 0.0732961893081665}, "num_episodes": 11, "episode_return_max": 46.022469571437746, "episode_return_min": -61.58275485551502, "episode_return_mean": -18.23872035904206}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 493.1538562903438, "num_env_steps_trained_throughput_per_sec": 493.1538562903438, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 1572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1572000, "timers": {"training_iteration_time_ms": 8176.693, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8176.658, "sample_time_ms": 787.563, "learn_time_ms": 7376.11, "learn_throughput": 542.291, "synch_weights_time_ms": 12.358}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 1572000, "num_agent_steps_trained": 1572000}, "done": false, "training_iteration": 131, "trial_id": "83a5c_00000", "date": "2024-08-10_12-32-35", "timestamp": 1723307555, "time_this_iter_s": 8.116578817367554, "time_total_s": 1117.4858362674713, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcacb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1117.4858362674713, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 27.049999999999997, "ram_util_percent": 82.65833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.77633484286606, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.700838189024143, "policy_loss": -0.004442232603172737, "vf_loss": 4.704743796429306, "vf_explained_var": -0.057695055827892645, "kl": 0.010587770203314912, "entropy": 1.1617136711796756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.467275812166433, "cur_kl_coeff": 0.0004454487003386022, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.392922748873631, "policy_loss": -0.008184223160302888, "vf_loss": 3.4011019336680572, "vf_explained_var": 0.04752886661638816, "kl": 0.011323937127438628, "entropy": 0.44938983929653964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 46.022469571437746, "episode_reward_min": -61.58275485551502, "episode_reward_mean": -16.535959380855726, "episode_len_mean": 359.99, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35999, "policy_reward_min": {"agent_policy": -46.02246957143775, "adversary_policy": -69.59987670489706}, "policy_reward_max": {"agent_policy": 61.58275485551501, "adversary_policy": 50.501568723817215}, "policy_reward_mean": {"agent_policy": 16.535959380855726, "adversary_policy": -16.53595938085573}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.96335127384833, -61.58275485551502, -30.4104138505242, -56.90996301449339, -28.28522788022685, -45.170804165403, -56.477278001608575, -25.630935332066784, -48.621993418324905, -53.49892436503591, -34.952426357634124, 46.022469571437746, -61.06824415968045, -37.07602836139507, -51.14693394650708, -45.68938623936316, -47.09288586318225, -46.620419435851396, -54.180801794265655, 34.31815060631714, -55.33904389966638, -53.8833575506971, -46.57543706008299, -34.20533733726228, -27.483866645012842, -19.880024351955566, -32.00435181717661, -31.90132799085631, -38.73406241774966, -33.434726061487986, 14.430156291327542, -50.35557430333122, -31.009781255124302, -40.4604770844029, -22.40866250444837, -19.37655699676516, -14.524672969585882, 0.6309172535026686, -36.36726934785906, -28.786327133495586, -25.65333330961357, -4.374941890103511, -30.020125283285598, -13.545783529833095, -23.102413212885146, 3.8250041354040136, 7.83242766537667, -7.553221647161919, -24.773849875084114, -19.33626001445556, -18.77476464534791, -18.547804430579745, -11.21267678446568, 11.56342205661286, -5.686106906823069, -27.560923459110455, -19.154706556620464, -13.526086600971134, -10.409853268861244, -30.469157816933784, -0.5892189043577734, 18.80116605462246, 8.04923582052077, -33.48591734320984, -25.392670613146, -18.9584417918904, 10.643484820177713, 1.073651492314143, 24.10870015725556, -5.386670713176256, -39.378106008779795, -27.410412695778554, 15.530371544362753, -33.39439941755412, -4.344110487581123, -25.464162569636365, -28.009585692610862, -17.516986057467584, 19.513728420961918, -18.78286869242898, 24.37098652314939, 7.913184528571032, 7.809297812086458, 10.462303182718818, 22.788328503522084, 2.7521303609814716, -2.7895479174120315, -9.392818535451969, -6.340226959039477, -5.9590983490754095, 41.44157327325259, 6.5882760556788975, -8.397964595148835, 3.46871304402233, -19.20778468318684, -10.174726678179304, 13.601926678073399, -0.9737294461312906, 13.06763780735009, -1.968797867604831], "episode_lengths": [220, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 343, 400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 241, 400, 400, 400, 400, 400, 400, 400, 26, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 358, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 54, 400, 400, 400, 400, 400, 122, 17, 400, 400, 400, 400, 400, 400, 62, 400], "policy_agent_policy_reward": [-23.963351273848314, 61.58275485551501, 30.4104138505242, 56.909963014493385, 28.285227880226856, 45.17080416540299, 56.47727800160857, 25.630935332066784, 48.6219934183249, 53.49892436503592, 34.952426357634124, -46.02246957143775, 61.06824415968044, 37.076028361395075, 51.146933946507076, 45.68938623936317, 47.092885863182225, 46.62041943585139, 54.18080179426565, -34.318150606317154, 55.33904389966637, 53.883357550697106, 46.57543706008298, 34.20533733726228, 27.483866645012842, 19.880024351955566, 32.00435181717661, 31.90132799085631, 38.73406241774967, 33.43472606148801, -14.430156291327542, 50.35557430333121, 31.009781255124302, 40.460477084402896, 22.408662504448365, 19.376556996765164, 14.524672969585877, -0.6309172535026684, 36.367269347859065, 28.78632713349561, 25.653333309613565, 4.374941890103512, 30.020125283285594, 13.545783529833095, 23.102413212885143, -3.825004135404014, -7.832427665376672, 7.553221647161925, 24.77384987508411, 19.336260014455558, 18.77476464534792, 18.547804430579756, 11.21267678446568, -11.563422056612849, 5.6861069068231025, 27.56092345911045, 19.15470655662046, 13.526086600971135, 10.409853268861244, 30.469157816933794, 0.5892189043577734, -18.801166054622456, -8.049235820520765, 33.48591734320986, 25.392670613145995, 18.9584417918904, -10.643484820177733, -1.0736514923141427, -24.108700157255576, 5.386670713176256, 39.37810600877979, 27.410412695778554, -15.530371544362751, 33.39439941755411, 4.344110487581123, 25.46416256963637, 28.00958569261086, 17.516986057467584, -19.51372842096191, 18.782868692428977, -24.370986523149387, -7.913184528571076, -7.809297812086452, -10.462303182718822, -22.78832850352209, -2.7521303609814716, 2.7895479174120332, 9.392818535451962, 6.340226959039477, 5.959098349075418, -41.44157327325262, -6.5882760556788975, 8.397964595148862, -3.46871304402233, 19.207784683186844, 10.174726678179281, -13.6019266780734, 0.97372944613128, -13.067637807350089, 1.968797867604831], "policy_adversary_policy_reward": [27.32548123680482, 20.601221310891795, -63.92167460423049, -59.24383510679951, -26.758276065345683, -34.06255163570272, -51.38279125507659, -62.43713477391019, -28.28983096207336, -28.28062479838038, -47.971573870935245, -42.37003445987075, -53.56085794368842, -59.39369805952877, -18.593995611147683, -32.667875052985885, -47.466895293020876, -49.77709154362894, -54.82969508943593, -52.16815364063589, -36.75923756230936, -33.14561515295888, 50.501568723817215, 41.54337041905825, -69.59987670489706, -52.53661161446383, -32.453674342751135, -41.69838238003899, -54.202608939205106, -48.091258953809, -53.19249487529262, -38.186277603433716, -55.59888359380955, -38.58688813255491, -51.54685131469163, -41.693987557011155, -43.529182283205785, -64.83242130532557, 38.902048945179274, 29.734252267455012, -48.397743301743745, -62.28034449758906, -58.31259367391923, -49.45412142747498, -49.13762332208225, -44.013250798083746, -42.164682008596586, -26.245992665927982, -1.277583913931192, -53.69014937609448, -23.581917606792736, -16.17813109711839, -33.101048881935, -30.90765475241823, -34.12574040144407, -29.67691558026855, -56.99533015752533, -20.472794677974022, -28.08335585631014, -38.78609626666588, 9.46197449377759, 19.398338088877498, -54.640613489660986, -46.0705351170015, -48.440664489829956, -13.578898020418656, -38.61125226307618, -42.30970190572962, -19.336653227273732, -25.480671781622988, -16.31302917206915, -22.44008482146117, -34.21847620614963, 5.169130266977874, 6.771844522718025, -5.5100100157126874, -31.174536914583555, -41.56000178113454, -0.3742094851050801, -57.19844478188612, -43.291012188461366, -8.015654430765764, 1.262183741680282, -10.01206752188731, 1.6603521810847823, -61.700602747655985, 9.092521993470193, -36.18408905313638, -12.016623984127698, -34.18820244164255, 3.978766118642131, 3.6712421521658967, 11.346241216606948, 4.318614114146392, -9.185544896714365, -5.920898397609481, -21.43993238684234, -28.107767363325912, -21.16301413639513, -17.50950589251599, -42.51093027364058, 4.9614009829447525, -29.634760455397526, -7.4608484057619755, -4.75456845318913, -17.67078511574223, 10.321297331737341, 12.805546781488296, 4.577192275407818, -15.949406089054001, -23.021692217354662, -32.10015470086624, -15.860310326013796, -22.449102787227126, -2.872717806776553, -24.179455395165718, -9.44752467013296, -11.372181867589529, -28.700823403431407, -32.237492230436175, -16.741299292937004, 15.562861484221457, 21.437818988150205, 16.164513121094707, -3.743636418275594, 19.842108059317127, -22.197786534492757, -44.77404815192696, -36.183803985042815, -14.601537241249186, -11.945582220649491, -25.97130136313131, 5.043988907008572, 16.242980733346954, -0.03252889930083214, 2.1798318839291175, 31.864870863042253, 16.352529451468854, 8.851029867199152, -19.624371293551665, -26.567917779086933, -52.18829423847265, -29.045716973713866, -25.775108417843242, 10.726580314894765, 20.334162773830737, -33.4468605561327, -33.34193827897552, -6.644521488803143, -2.0436994863591025, -20.4442851497892, -30.48403998948354, -26.205391788308525, -29.813779596913193, -16.754922961408287, -18.27904915352688, 28.34260771046421, 10.684849131459606, -13.77671849701824, -23.78901888783973, 34.19627131462453, 14.545701731674242, 8.181759168325538, 7.644609888816564, 0.29310952129566203, 15.325486102877242, 7.617580685594248, 13.307025679843395, 24.472283127672025, 21.104373879372144, 5.572906718633483, -0.06864599667053994, -15.845015566347712, 10.265919731523649, -25.307988895470796, 6.522351824566879, -11.139626575558584, -1.5408273425203696, -7.2708126510881605, -4.647384047062669, 45.24718444174892, 37.6359621047563, 17.984736565196783, -4.808184453838983, -13.492266397762478, -3.3036627925352313, -2.4887265965457175, 9.426152684590377, -23.522994989735388, -14.8925743766383, -13.88665288522629, -6.4628004711322795, 5.719881207501867, 21.483972148644916, 11.040081664241967, -12.987540556504534, 20.708118241937385, 5.427157372762794, -11.041694952288736, 7.104099217079074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42769773397311334, "mean_inference_ms": 1.1291595759185393, "mean_action_processing_ms": 0.18357353348967045, "mean_env_wait_ms": 0.0751069056389776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033342838287353516, "StateBufferConnector_ms": 0.0032118558883666992, "ViewRequirementAgentConnector_ms": 0.0725247859954834}, "num_episodes": 12, "episode_return_max": 46.022469571437746, "episode_return_min": -61.58275485551502, "episode_return_mean": -16.535959380855726}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.163555345938, "num_env_steps_trained_throughput_per_sec": 486.163555345938, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 8170.452, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8170.417, "sample_time_ms": 790.575, "learn_time_ms": 7366.784, "learn_throughput": 542.978, "synch_weights_time_ms": 12.434}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 132, "trial_id": "83a5c_00000", "date": "2024-08-10_12-32-44", "timestamp": 1723307564, "time_this_iter_s": 8.233563899993896, "time_total_s": 1125.7194001674652, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc313a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1125.7194001674652, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 26.299999999999997, "ram_util_percent": 82.78181818181817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.571713002838155, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.641227038322933, "policy_loss": -0.0060598174447597805, "vf_loss": 4.646913861471509, "vf_explained_var": -0.06582556307000458, "kl": 0.007359382655993195, "entropy": 0.9266336854803499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.192970052361488, "cur_kl_coeff": 0.0004454487003386022, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.34739178220431, "policy_loss": -0.0102711413569826, "vf_loss": 3.357658991465966, "vf_explained_var": 0.6117787310853601, "kl": 0.008798822710778845, "entropy": 0.445773768859605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "env_runners": {"episode_reward_max": 41.44157327325259, "episode_reward_min": -61.06824415968045, "episode_reward_mean": -13.214738025451345, "episode_len_mean": 352.75, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35275, "policy_reward_min": {"agent_policy": -41.44157327325262, "adversary_policy": -69.59987670489706}, "policy_reward_max": {"agent_policy": 61.06824415968044, "adversary_policy": 45.24718444174892}, "policy_reward_mean": {"agent_policy": 13.214738025451343, "adversary_policy": -13.214738025451341}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.06824415968045, -37.07602836139507, -51.14693394650708, -45.68938623936316, -47.09288586318225, -46.620419435851396, -54.180801794265655, 34.31815060631714, -55.33904389966638, -53.8833575506971, -46.57543706008299, -34.20533733726228, -27.483866645012842, -19.880024351955566, -32.00435181717661, -31.90132799085631, -38.73406241774966, -33.434726061487986, 14.430156291327542, -50.35557430333122, -31.009781255124302, -40.4604770844029, -22.40866250444837, -19.37655699676516, -14.524672969585882, 0.6309172535026686, -36.36726934785906, -28.786327133495586, -25.65333330961357, -4.374941890103511, -30.020125283285598, -13.545783529833095, -23.102413212885146, 3.8250041354040136, 7.83242766537667, -7.553221647161919, -24.773849875084114, -19.33626001445556, -18.77476464534791, -18.547804430579745, -11.21267678446568, 11.56342205661286, -5.686106906823069, -27.560923459110455, -19.154706556620464, -13.526086600971134, -10.409853268861244, -30.469157816933784, -0.5892189043577734, 18.80116605462246, 8.04923582052077, -33.48591734320984, -25.392670613146, -18.9584417918904, 10.643484820177713, 1.073651492314143, 24.10870015725556, -5.386670713176256, -39.378106008779795, -27.410412695778554, 15.530371544362753, -33.39439941755412, -4.344110487581123, -25.464162569636365, -28.009585692610862, -17.516986057467584, 19.513728420961918, -18.78286869242898, 24.37098652314939, 7.913184528571032, 7.809297812086458, 10.462303182718818, 22.788328503522084, 2.7521303609814716, -2.7895479174120315, -9.392818535451969, -6.340226959039477, -5.9590983490754095, 41.44157327325259, 6.5882760556788975, -8.397964595148835, 3.46871304402233, -19.20778468318684, -10.174726678179304, 13.601926678073399, -0.9737294461312906, 13.06763780735009, -1.968797867604831, -5.52992713254894, 6.454477578790509, -19.001446900375953, 7.521867208138313, 14.399523527636953, -44.61902868728722, -19.833388624463996, -14.775456068770525, 0.014366928534430112, 33.42023751562142, 0.6399662069791994, 1.8760435926376395], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 30, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 241, 400, 400, 400, 400, 400, 400, 400, 26, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 358, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 54, 400, 400, 400, 400, 400, 122, 17, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 26, 114, 400, 400, 400, 400, 99, 400, 400], "policy_agent_policy_reward": [61.06824415968044, 37.076028361395075, 51.146933946507076, 45.68938623936317, 47.092885863182225, 46.62041943585139, 54.18080179426565, -34.318150606317154, 55.33904389966637, 53.883357550697106, 46.57543706008298, 34.20533733726228, 27.483866645012842, 19.880024351955566, 32.00435181717661, 31.90132799085631, 38.73406241774967, 33.43472606148801, -14.430156291327542, 50.35557430333121, 31.009781255124302, 40.460477084402896, 22.408662504448365, 19.376556996765164, 14.524672969585877, -0.6309172535026684, 36.367269347859065, 28.78632713349561, 25.653333309613565, 4.374941890103512, 30.020125283285594, 13.545783529833095, 23.102413212885143, -3.825004135404014, -7.832427665376672, 7.553221647161925, 24.77384987508411, 19.336260014455558, 18.77476464534792, 18.547804430579756, 11.21267678446568, -11.563422056612849, 5.6861069068231025, 27.56092345911045, 19.15470655662046, 13.526086600971135, 10.409853268861244, 30.469157816933794, 0.5892189043577734, -18.801166054622456, -8.049235820520765, 33.48591734320986, 25.392670613145995, 18.9584417918904, -10.643484820177733, -1.0736514923141427, -24.108700157255576, 5.386670713176256, 39.37810600877979, 27.410412695778554, -15.530371544362751, 33.39439941755411, 4.344110487581123, 25.46416256963637, 28.00958569261086, 17.516986057467584, -19.51372842096191, 18.782868692428977, -24.370986523149387, -7.913184528571076, -7.809297812086452, -10.462303182718822, -22.78832850352209, -2.7521303609814716, 2.7895479174120332, 9.392818535451962, 6.340226959039477, 5.959098349075418, -41.44157327325262, -6.5882760556788975, 8.397964595148862, -3.46871304402233, 19.207784683186844, 10.174726678179281, -13.6019266780734, 0.97372944613128, -13.067637807350089, 1.968797867604831, 5.52992713254894, -6.454477578790505, 19.001446900375957, -7.5218672081383104, -14.399523527636958, 44.619028687287226, 19.833388624463993, 14.7754560687705, -0.014366928534431889, -33.42023751562141, -0.6399662069792025, -1.8760435926376395], "policy_adversary_policy_reward": [-69.59987670489706, -52.53661161446383, -32.453674342751135, -41.69838238003899, -54.202608939205106, -48.091258953809, -53.19249487529262, -38.186277603433716, -55.59888359380955, -38.58688813255491, -51.54685131469163, -41.693987557011155, -43.529182283205785, -64.83242130532557, 38.902048945179274, 29.734252267455012, -48.397743301743745, -62.28034449758906, -58.31259367391923, -49.45412142747498, -49.13762332208225, -44.013250798083746, -42.164682008596586, -26.245992665927982, -1.277583913931192, -53.69014937609448, -23.581917606792736, -16.17813109711839, -33.101048881935, -30.90765475241823, -34.12574040144407, -29.67691558026855, -56.99533015752533, -20.472794677974022, -28.08335585631014, -38.78609626666588, 9.46197449377759, 19.398338088877498, -54.640613489660986, -46.0705351170015, -48.440664489829956, -13.578898020418656, -38.61125226307618, -42.30970190572962, -19.336653227273732, -25.480671781622988, -16.31302917206915, -22.44008482146117, -34.21847620614963, 5.169130266977874, 6.771844522718025, -5.5100100157126874, -31.174536914583555, -41.56000178113454, -0.3742094851050801, -57.19844478188612, -43.291012188461366, -8.015654430765764, 1.262183741680282, -10.01206752188731, 1.6603521810847823, -61.700602747655985, 9.092521993470193, -36.18408905313638, -12.016623984127698, -34.18820244164255, 3.978766118642131, 3.6712421521658967, 11.346241216606948, 4.318614114146392, -9.185544896714365, -5.920898397609481, -21.43993238684234, -28.107767363325912, -21.16301413639513, -17.50950589251599, -42.51093027364058, 4.9614009829447525, -29.634760455397526, -7.4608484057619755, -4.75456845318913, -17.67078511574223, 10.321297331737341, 12.805546781488296, 4.577192275407818, -15.949406089054001, -23.021692217354662, -32.10015470086624, -15.860310326013796, -22.449102787227126, -2.872717806776553, -24.179455395165718, -9.44752467013296, -11.372181867589529, -28.700823403431407, -32.237492230436175, -16.741299292937004, 15.562861484221457, 21.437818988150205, 16.164513121094707, -3.743636418275594, 19.842108059317127, -22.197786534492757, -44.77404815192696, -36.183803985042815, -14.601537241249186, -11.945582220649491, -25.97130136313131, 5.043988907008572, 16.242980733346954, -0.03252889930083214, 2.1798318839291175, 31.864870863042253, 16.352529451468854, 8.851029867199152, -19.624371293551665, -26.567917779086933, -52.18829423847265, -29.045716973713866, -25.775108417843242, 10.726580314894765, 20.334162773830737, -33.4468605561327, -33.34193827897552, -6.644521488803143, -2.0436994863591025, -20.4442851497892, -30.48403998948354, -26.205391788308525, -29.813779596913193, -16.754922961408287, -18.27904915352688, 28.34260771046421, 10.684849131459606, -13.77671849701824, -23.78901888783973, 34.19627131462453, 14.545701731674242, 8.181759168325538, 7.644609888816564, 0.29310952129566203, 15.325486102877242, 7.617580685594248, 13.307025679843395, 24.472283127672025, 21.104373879372144, 5.572906718633483, -0.06864599667053994, -15.845015566347712, 10.265919731523649, -25.307988895470796, 6.522351824566879, -11.139626575558584, -1.5408273425203696, -7.2708126510881605, -4.647384047062669, 45.24718444174892, 37.6359621047563, 17.984736565196783, -4.808184453838983, -13.492266397762478, -3.3036627925352313, -2.4887265965457175, 9.426152684590377, -23.522994989735388, -14.8925743766383, -13.88665288522629, -6.4628004711322795, 5.719881207501867, 21.483972148644916, 11.040081664241967, -12.987540556504534, 20.708118241937385, 5.427157372762794, -11.041694952288736, 7.104099217079074, 0.43680979630788386, -11.496664061405763, -4.571821817846388, 17.48077697542739, -11.680551101153014, -26.32234269959888, -10.343903801350145, 25.38763821762677, -2.836775372609196, 31.635822427883106, -38.546123292650094, -50.69193408192433, -24.712712499302814, -14.954064749625143, -13.71306515570867, -15.837846981832335, 3.2242058567772816, -3.1954719997084196, 28.22557833994373, 38.614896691299116, -3.289104560955505, 4.569036974913885, -0.8738296418164779, 4.625916827091757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4273257909959397, "mean_inference_ms": 1.1277796427820113, "mean_action_processing_ms": 0.18342283150760325, "mean_env_wait_ms": 0.07500155978423591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033533573150634766, "StateBufferConnector_ms": 0.0031937360763549805, "ViewRequirementAgentConnector_ms": 0.07212865352630615}, "num_episodes": 12, "episode_return_max": 41.44157327325259, "episode_return_min": -61.06824415968045, "episode_return_mean": -13.214738025451345}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.4073522424944, "num_env_steps_trained_throughput_per_sec": 480.4073522424944, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 1596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1596000, "timers": {"training_iteration_time_ms": 8185.127, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8185.092, "sample_time_ms": 775.115, "learn_time_ms": 7397.091, "learn_throughput": 540.753, "synch_weights_time_ms": 12.256}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 1596000, "num_agent_steps_trained": 1596000}, "done": false, "training_iteration": 133, "trial_id": "83a5c_00000", "date": "2024-08-10_12-32-52", "timestamp": 1723307572, "time_this_iter_s": 8.331392049789429, "time_total_s": 1134.0507922172546, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc31280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1134.0507922172546, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 25.066666666666663, "ram_util_percent": 82.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.778570444211758, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1453622351247796, "policy_loss": -0.005079948215094942, "vf_loss": 2.149803335641427, "vf_explained_var": 0.05620660655712955, "kl": 0.012605077780179668, "entropy": 1.0341402193225882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7618253493060667, "cur_kl_coeff": 0.0004454487003386022, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8278019707649946, "policy_loss": -0.0073926172272573846, "vf_loss": 1.8351933574924866, "vf_explained_var": 0.17810914448151985, "kl": 0.0027492760425404292, "entropy": 0.20543871796689928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "env_runners": {"episode_reward_max": 41.99356752185655, "episode_reward_min": -50.35557430333122, "episode_reward_mean": -9.805171858971898, "episode_len_mean": 350.19, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 35019, "policy_reward_min": {"agent_policy": -41.99356752185652, "adversary_policy": -61.700602747655985}, "policy_reward_max": {"agent_policy": 50.35557430333121, "adversary_policy": 45.24718444174892}, "policy_reward_mean": {"agent_policy": 9.805171858971898, "adversary_policy": -9.8051718589719}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.880024351955566, -32.00435181717661, -31.90132799085631, -38.73406241774966, -33.434726061487986, 14.430156291327542, -50.35557430333122, -31.009781255124302, -40.4604770844029, -22.40866250444837, -19.37655699676516, -14.524672969585882, 0.6309172535026686, -36.36726934785906, -28.786327133495586, -25.65333330961357, -4.374941890103511, -30.020125283285598, -13.545783529833095, -23.102413212885146, 3.8250041354040136, 7.83242766537667, -7.553221647161919, -24.773849875084114, -19.33626001445556, -18.77476464534791, -18.547804430579745, -11.21267678446568, 11.56342205661286, -5.686106906823069, -27.560923459110455, -19.154706556620464, -13.526086600971134, -10.409853268861244, -30.469157816933784, -0.5892189043577734, 18.80116605462246, 8.04923582052077, -33.48591734320984, -25.392670613146, -18.9584417918904, 10.643484820177713, 1.073651492314143, 24.10870015725556, -5.386670713176256, -39.378106008779795, -27.410412695778554, 15.530371544362753, -33.39439941755412, -4.344110487581123, -25.464162569636365, -28.009585692610862, -17.516986057467584, 19.513728420961918, -18.78286869242898, 24.37098652314939, 7.913184528571032, 7.809297812086458, 10.462303182718818, 22.788328503522084, 2.7521303609814716, -2.7895479174120315, -9.392818535451969, -6.340226959039477, -5.9590983490754095, 41.44157327325259, 6.5882760556788975, -8.397964595148835, 3.46871304402233, -19.20778468318684, -10.174726678179304, 13.601926678073399, -0.9737294461312906, 13.06763780735009, -1.968797867604831, -5.52992713254894, 6.454477578790509, -19.001446900375953, 7.521867208138313, 14.399523527636953, -44.61902868728722, -19.833388624463996, -14.775456068770525, 0.014366928534430112, 33.42023751562142, 0.6399662069791994, 1.8760435926376395, -31.380950870501646, -17.21253430077997, -37.18984139390708, -25.145096223391636, -19.92225780844612, -17.545418303177456, -10.208997887428321, 15.282834152313612, -7.825488900470914, -33.38862858924244, -8.866779984197045, -33.677382451332655, 41.99356752185655], "episode_lengths": [400, 400, 400, 400, 400, 20, 400, 400, 400, 400, 400, 400, 241, 400, 400, 400, 400, 400, 400, 400, 26, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 358, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 54, 400, 400, 400, 400, 400, 122, 17, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 26, 114, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 112], "policy_agent_policy_reward": [19.880024351955566, 32.00435181717661, 31.90132799085631, 38.73406241774967, 33.43472606148801, -14.430156291327542, 50.35557430333121, 31.009781255124302, 40.460477084402896, 22.408662504448365, 19.376556996765164, 14.524672969585877, -0.6309172535026684, 36.367269347859065, 28.78632713349561, 25.653333309613565, 4.374941890103512, 30.020125283285594, 13.545783529833095, 23.102413212885143, -3.825004135404014, -7.832427665376672, 7.553221647161925, 24.77384987508411, 19.336260014455558, 18.77476464534792, 18.547804430579756, 11.21267678446568, -11.563422056612849, 5.6861069068231025, 27.56092345911045, 19.15470655662046, 13.526086600971135, 10.409853268861244, 30.469157816933794, 0.5892189043577734, -18.801166054622456, -8.049235820520765, 33.48591734320986, 25.392670613145995, 18.9584417918904, -10.643484820177733, -1.0736514923141427, -24.108700157255576, 5.386670713176256, 39.37810600877979, 27.410412695778554, -15.530371544362751, 33.39439941755411, 4.344110487581123, 25.46416256963637, 28.00958569261086, 17.516986057467584, -19.51372842096191, 18.782868692428977, -24.370986523149387, -7.913184528571076, -7.809297812086452, -10.462303182718822, -22.78832850352209, -2.7521303609814716, 2.7895479174120332, 9.392818535451962, 6.340226959039477, 5.959098349075418, -41.44157327325262, -6.5882760556788975, 8.397964595148862, -3.46871304402233, 19.207784683186844, 10.174726678179281, -13.6019266780734, 0.97372944613128, -13.067637807350089, 1.968797867604831, 5.52992713254894, -6.454477578790505, 19.001446900375957, -7.5218672081383104, -14.399523527636958, 44.619028687287226, 19.833388624463993, 14.7754560687705, -0.014366928534431889, -33.42023751562141, -0.6399662069792025, -1.8760435926376395, 31.380950870501636, 17.212534300779947, 37.18984139390709, 25.145096223391633, 19.922257808446115, 17.545418303177467, 10.208997887428321, -15.282834152313617, 7.825488900470916, 33.388628589242444, 8.866779984197045, 33.67738245133265, -41.99356752185652], "policy_adversary_policy_reward": [-23.581917606792736, -16.17813109711839, -33.101048881935, -30.90765475241823, -34.12574040144407, -29.67691558026855, -56.99533015752533, -20.472794677974022, -28.08335585631014, -38.78609626666588, 9.46197449377759, 19.398338088877498, -54.640613489660986, -46.0705351170015, -48.440664489829956, -13.578898020418656, -38.61125226307618, -42.30970190572962, -19.336653227273732, -25.480671781622988, -16.31302917206915, -22.44008482146117, -34.21847620614963, 5.169130266977874, 6.771844522718025, -5.5100100157126874, -31.174536914583555, -41.56000178113454, -0.3742094851050801, -57.19844478188612, -43.291012188461366, -8.015654430765764, 1.262183741680282, -10.01206752188731, 1.6603521810847823, -61.700602747655985, 9.092521993470193, -36.18408905313638, -12.016623984127698, -34.18820244164255, 3.978766118642131, 3.6712421521658967, 11.346241216606948, 4.318614114146392, -9.185544896714365, -5.920898397609481, -21.43993238684234, -28.107767363325912, -21.16301413639513, -17.50950589251599, -42.51093027364058, 4.9614009829447525, -29.634760455397526, -7.4608484057619755, -4.75456845318913, -17.67078511574223, 10.321297331737341, 12.805546781488296, 4.577192275407818, -15.949406089054001, -23.021692217354662, -32.10015470086624, -15.860310326013796, -22.449102787227126, -2.872717806776553, -24.179455395165718, -9.44752467013296, -11.372181867589529, -28.700823403431407, -32.237492230436175, -16.741299292937004, 15.562861484221457, 21.437818988150205, 16.164513121094707, -3.743636418275594, 19.842108059317127, -22.197786534492757, -44.77404815192696, -36.183803985042815, -14.601537241249186, -11.945582220649491, -25.97130136313131, 5.043988907008572, 16.242980733346954, -0.03252889930083214, 2.1798318839291175, 31.864870863042253, 16.352529451468854, 8.851029867199152, -19.624371293551665, -26.567917779086933, -52.18829423847265, -29.045716973713866, -25.775108417843242, 10.726580314894765, 20.334162773830737, -33.4468605561327, -33.34193827897552, -6.644521488803143, -2.0436994863591025, -20.4442851497892, -30.48403998948354, -26.205391788308525, -29.813779596913193, -16.754922961408287, -18.27904915352688, 28.34260771046421, 10.684849131459606, -13.77671849701824, -23.78901888783973, 34.19627131462453, 14.545701731674242, 8.181759168325538, 7.644609888816564, 0.29310952129566203, 15.325486102877242, 7.617580685594248, 13.307025679843395, 24.472283127672025, 21.104373879372144, 5.572906718633483, -0.06864599667053994, -15.845015566347712, 10.265919731523649, -25.307988895470796, 6.522351824566879, -11.139626575558584, -1.5408273425203696, -7.2708126510881605, -4.647384047062669, 45.24718444174892, 37.6359621047563, 17.984736565196783, -4.808184453838983, -13.492266397762478, -3.3036627925352313, -2.4887265965457175, 9.426152684590377, -23.522994989735388, -14.8925743766383, -13.88665288522629, -6.4628004711322795, 5.719881207501867, 21.483972148644916, 11.040081664241967, -12.987540556504534, 20.708118241937385, 5.427157372762794, -11.041694952288736, 7.104099217079074, 0.43680979630788386, -11.496664061405763, -4.571821817846388, 17.48077697542739, -11.680551101153014, -26.32234269959888, -10.343903801350145, 25.38763821762677, -2.836775372609196, 31.635822427883106, -38.546123292650094, -50.69193408192433, -24.712712499302814, -14.954064749625143, -13.71306515570867, -15.837846981832335, 3.2242058567772816, -3.1954719997084196, 28.22557833994373, 38.614896691299116, -3.289104560955505, 4.569036974913885, -0.8738296418164779, 4.625916827091757, -17.596449812146, -45.16545192885727, -37.02244877301607, 2.5973801714561624, -31.07951472374205, -43.30016806407217, -18.27250567030159, -32.017686776481696, -19.09047926454072, -20.754036352351545, -20.926496246261316, -14.164340360093597, -12.12759378498042, -8.290401989876223, 18.58372217006197, 11.981946134565254, 0.5408897797356111, -16.191867580677442, -22.048218678500632, -44.72903849998431, 3.6692966663939472, -21.402856634788034, -11.131409484480802, -56.2233554181845, 42.310286717799464, 41.67684832591362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42701173037375006, "mean_inference_ms": 1.1266854106765676, "mean_action_processing_ms": 0.18327453335858493, "mean_env_wait_ms": 0.07492982078499935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504633903503418, "StateBufferConnector_ms": 0.0024524927139282227, "ViewRequirementAgentConnector_ms": 0.07024753093719482}, "num_episodes": 13, "episode_return_max": 41.99356752185655, "episode_return_min": -50.35557430333122, "episode_return_mean": -9.805171858971898}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.9651804435002, "num_env_steps_trained_throughput_per_sec": 479.9651804435002, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 1608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1608000, "timers": {"training_iteration_time_ms": 8210.684, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8210.65, "sample_time_ms": 768.619, "learn_time_ms": 7428.979, "learn_throughput": 538.432, "synch_weights_time_ms": 12.413}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "done": false, "training_iteration": 134, "trial_id": "83a5c_00000", "date": "2024-08-10_12-33-00", "timestamp": 1723307580, "time_this_iter_s": 8.34000301361084, "time_total_s": 1142.3907952308655, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc31550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1142.3907952308655, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 27.125, "ram_util_percent": 83.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.884158344369717, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9800537658116175, "policy_loss": -0.004884171502408449, "vf_loss": 2.9845849577081265, "vf_explained_var": 0.04671079664634018, "kl": 0.006964763243401016, "entropy": 1.1035775355876438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.570375933125615, "cur_kl_coeff": 0.0002227243501693011, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7216939429442086, "policy_loss": -0.005406775746572142, "vf_loss": 2.7270998826871318, "vf_explained_var": 0.6352305874228478, "kl": 0.003713417525597078, "entropy": 0.289666644235452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "env_runners": {"episode_reward_max": 41.99356752185655, "episode_reward_min": -44.61902868728722, "episode_reward_mean": -7.492122364166066, "episode_len_mean": 350.84, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35084, "policy_reward_min": {"agent_policy": -41.99356752185652, "adversary_policy": -61.700602747655985}, "policy_reward_max": {"agent_policy": 44.619028687287226, "adversary_policy": 45.24718444174892}, "policy_reward_mean": {"agent_policy": 7.492122364166067, "adversary_policy": -7.492122364166068}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6309172535026686, -36.36726934785906, -28.786327133495586, -25.65333330961357, -4.374941890103511, -30.020125283285598, -13.545783529833095, -23.102413212885146, 3.8250041354040136, 7.83242766537667, -7.553221647161919, -24.773849875084114, -19.33626001445556, -18.77476464534791, -18.547804430579745, -11.21267678446568, 11.56342205661286, -5.686106906823069, -27.560923459110455, -19.154706556620464, -13.526086600971134, -10.409853268861244, -30.469157816933784, -0.5892189043577734, 18.80116605462246, 8.04923582052077, -33.48591734320984, -25.392670613146, -18.9584417918904, 10.643484820177713, 1.073651492314143, 24.10870015725556, -5.386670713176256, -39.378106008779795, -27.410412695778554, 15.530371544362753, -33.39439941755412, -4.344110487581123, -25.464162569636365, -28.009585692610862, -17.516986057467584, 19.513728420961918, -18.78286869242898, 24.37098652314939, 7.913184528571032, 7.809297812086458, 10.462303182718818, 22.788328503522084, 2.7521303609814716, -2.7895479174120315, -9.392818535451969, -6.340226959039477, -5.9590983490754095, 41.44157327325259, 6.5882760556788975, -8.397964595148835, 3.46871304402233, -19.20778468318684, -10.174726678179304, 13.601926678073399, -0.9737294461312906, 13.06763780735009, -1.968797867604831, -5.52992713254894, 6.454477578790509, -19.001446900375953, 7.521867208138313, 14.399523527636953, -44.61902868728722, -19.833388624463996, -14.775456068770525, 0.014366928534430112, 33.42023751562142, 0.6399662069791994, 1.8760435926376395, -31.380950870501646, -17.21253430077997, -37.18984139390708, -25.145096223391636, -19.92225780844612, -17.545418303177456, -10.208997887428321, 15.282834152313612, -7.825488900470914, -33.38862858924244, -8.866779984197045, -33.677382451332655, 41.99356752185655, 6.762777983005135, -12.671529275319603, -5.023189103953216, -3.8743512892951237, 9.457993211900742, -11.39197420841938, -2.016733508856433, -24.14683441815132, -27.12341149893063, -21.413710955844525, -8.323248061080845, 11.409099143971918], "episode_lengths": [241, 400, 400, 400, 400, 400, 400, 400, 26, 21, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 358, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 54, 400, 400, 400, 400, 400, 122, 17, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 26, 114, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85], "policy_agent_policy_reward": [-0.6309172535026684, 36.367269347859065, 28.78632713349561, 25.653333309613565, 4.374941890103512, 30.020125283285594, 13.545783529833095, 23.102413212885143, -3.825004135404014, -7.832427665376672, 7.553221647161925, 24.77384987508411, 19.336260014455558, 18.77476464534792, 18.547804430579756, 11.21267678446568, -11.563422056612849, 5.6861069068231025, 27.56092345911045, 19.15470655662046, 13.526086600971135, 10.409853268861244, 30.469157816933794, 0.5892189043577734, -18.801166054622456, -8.049235820520765, 33.48591734320986, 25.392670613145995, 18.9584417918904, -10.643484820177733, -1.0736514923141427, -24.108700157255576, 5.386670713176256, 39.37810600877979, 27.410412695778554, -15.530371544362751, 33.39439941755411, 4.344110487581123, 25.46416256963637, 28.00958569261086, 17.516986057467584, -19.51372842096191, 18.782868692428977, -24.370986523149387, -7.913184528571076, -7.809297812086452, -10.462303182718822, -22.78832850352209, -2.7521303609814716, 2.7895479174120332, 9.392818535451962, 6.340226959039477, 5.959098349075418, -41.44157327325262, -6.5882760556788975, 8.397964595148862, -3.46871304402233, 19.207784683186844, 10.174726678179281, -13.6019266780734, 0.97372944613128, -13.067637807350089, 1.968797867604831, 5.52992713254894, -6.454477578790505, 19.001446900375957, -7.5218672081383104, -14.399523527636958, 44.619028687287226, 19.833388624463993, 14.7754560687705, -0.014366928534431889, -33.42023751562141, -0.6399662069792025, -1.8760435926376395, 31.380950870501636, 17.212534300779947, 37.18984139390709, 25.145096223391633, 19.922257808446115, 17.545418303177467, 10.208997887428321, -15.282834152313617, 7.825488900470916, 33.388628589242444, 8.866779984197045, 33.67738245133265, -41.99356752185652, -6.76277798300514, 12.671529275319593, 5.023189103953216, 3.8743512892951237, -9.457993211900744, 11.39197420841938, 2.0167335088564418, 24.146834418151325, 27.123411498930626, 21.41371095584453, 8.323248061080845, -11.409099143971922], "policy_adversary_policy_reward": [6.771844522718025, -5.5100100157126874, -31.174536914583555, -41.56000178113454, -0.3742094851050801, -57.19844478188612, -43.291012188461366, -8.015654430765764, 1.262183741680282, -10.01206752188731, 1.6603521810847823, -61.700602747655985, 9.092521993470193, -36.18408905313638, -12.016623984127698, -34.18820244164255, 3.978766118642131, 3.6712421521658967, 11.346241216606948, 4.318614114146392, -9.185544896714365, -5.920898397609481, -21.43993238684234, -28.107767363325912, -21.16301413639513, -17.50950589251599, -42.51093027364058, 4.9614009829447525, -29.634760455397526, -7.4608484057619755, -4.75456845318913, -17.67078511574223, 10.321297331737341, 12.805546781488296, 4.577192275407818, -15.949406089054001, -23.021692217354662, -32.10015470086624, -15.860310326013796, -22.449102787227126, -2.872717806776553, -24.179455395165718, -9.44752467013296, -11.372181867589529, -28.700823403431407, -32.237492230436175, -16.741299292937004, 15.562861484221457, 21.437818988150205, 16.164513121094707, -3.743636418275594, 19.842108059317127, -22.197786534492757, -44.77404815192696, -36.183803985042815, -14.601537241249186, -11.945582220649491, -25.97130136313131, 5.043988907008572, 16.242980733346954, -0.03252889930083214, 2.1798318839291175, 31.864870863042253, 16.352529451468854, 8.851029867199152, -19.624371293551665, -26.567917779086933, -52.18829423847265, -29.045716973713866, -25.775108417843242, 10.726580314894765, 20.334162773830737, -33.4468605561327, -33.34193827897552, -6.644521488803143, -2.0436994863591025, -20.4442851497892, -30.48403998948354, -26.205391788308525, -29.813779596913193, -16.754922961408287, -18.27904915352688, 28.34260771046421, 10.684849131459606, -13.77671849701824, -23.78901888783973, 34.19627131462453, 14.545701731674242, 8.181759168325538, 7.644609888816564, 0.29310952129566203, 15.325486102877242, 7.617580685594248, 13.307025679843395, 24.472283127672025, 21.104373879372144, 5.572906718633483, -0.06864599667053994, -15.845015566347712, 10.265919731523649, -25.307988895470796, 6.522351824566879, -11.139626575558584, -1.5408273425203696, -7.2708126510881605, -4.647384047062669, 45.24718444174892, 37.6359621047563, 17.984736565196783, -4.808184453838983, -13.492266397762478, -3.3036627925352313, -2.4887265965457175, 9.426152684590377, -23.522994989735388, -14.8925743766383, -13.88665288522629, -6.4628004711322795, 5.719881207501867, 21.483972148644916, 11.040081664241967, -12.987540556504534, 20.708118241937385, 5.427157372762794, -11.041694952288736, 7.104099217079074, 0.43680979630788386, -11.496664061405763, -4.571821817846388, 17.48077697542739, -11.680551101153014, -26.32234269959888, -10.343903801350145, 25.38763821762677, -2.836775372609196, 31.635822427883106, -38.546123292650094, -50.69193408192433, -24.712712499302814, -14.954064749625143, -13.71306515570867, -15.837846981832335, 3.2242058567772816, -3.1954719997084196, 28.22557833994373, 38.614896691299116, -3.289104560955505, 4.569036974913885, -0.8738296418164779, 4.625916827091757, -17.596449812146, -45.16545192885727, -37.02244877301607, 2.5973801714561624, -31.07951472374205, -43.30016806407217, -18.27250567030159, -32.017686776481696, -19.09047926454072, -20.754036352351545, -20.926496246261316, -14.164340360093597, -12.12759378498042, -8.290401989876223, 18.58372217006197, 11.981946134565254, 0.5408897797356111, -16.191867580677442, -22.048218678500632, -44.72903849998431, 3.6692966663939472, -21.402856634788034, -11.131409484480802, -56.2233554181845, 42.310286717799464, 41.67684832591362, 15.982698106229552, -2.4571421402192613, -10.470108103314718, -14.872950447324481, 13.92945667207551, -23.975834879981942, -7.942413809965132, 0.1937112313748841, 7.535377466295948, 11.38060895750555, -10.123572381080841, -12.66037603575792, -13.782103210185298, 9.748636192472414, -4.639430769060059, -43.654238067242616, -14.874052983708495, -39.37277001415274, -25.03777658431414, -17.78964532737494, -22.181408516442858, 5.534912394281168, 12.12557540880874, 10.692622879135097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4266209198635398, "mean_inference_ms": 1.1257701481676141, "mean_action_processing_ms": 0.18317499344189264, "mean_env_wait_ms": 0.07485015330893027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035518407821655273, "StateBufferConnector_ms": 0.0029081106185913086, "ViewRequirementAgentConnector_ms": 0.07135581970214844}, "num_episodes": 12, "episode_return_max": 41.99356752185655, "episode_return_min": -44.61902868728722, "episode_return_mean": -7.492122364166066}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.02632194411024, "num_env_steps_trained_throughput_per_sec": 491.02632194411024, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 1620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1620000, "timers": {"training_iteration_time_ms": 8241.782, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8241.747, "sample_time_ms": 773.089, "learn_time_ms": 7455.581, "learn_throughput": 536.511, "synch_weights_time_ms": 12.441}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 1620000, "num_agent_steps_trained": 1620000}, "done": false, "training_iteration": 135, "trial_id": "83a5c_00000", "date": "2024-08-10_12-33-08", "timestamp": 1723307588, "time_this_iter_s": 8.150922060012817, "time_total_s": 1150.5417172908783, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcfd670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1150.5417172908783, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 26.19090909090909, "ram_util_percent": 83.04545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.413129596861582, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.605244722946611, "policy_loss": -0.005501216612559147, "vf_loss": 3.6100969595883887, "vf_explained_var": -0.0929705903959022, "kl": 0.012805280233936043, "entropy": 1.3374585651846789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.313471384843191, "cur_kl_coeff": 0.00011136217508465055, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.238371752202511, "policy_loss": -0.004570753313115953, "vf_loss": 3.2429419805606208, "vf_explained_var": 0.23620484254012505, "kl": 0.004778868926392316, "entropy": 0.3464044278798004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 41.99356752185655, "episode_reward_min": -44.61902868728722, "episode_reward_mean": -5.611077534384743, "episode_len_mean": 349.45, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 34945, "policy_reward_min": {"agent_policy": -41.99356752185652, "adversary_policy": -56.2233554181845}, "policy_reward_max": {"agent_policy": 44.619028687287226, "adversary_policy": 46.878875332424776}, "policy_reward_mean": {"agent_policy": 5.611077534384743, "adversary_policy": -5.611077534384743}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.33626001445556, -18.77476464534791, -18.547804430579745, -11.21267678446568, 11.56342205661286, -5.686106906823069, -27.560923459110455, -19.154706556620464, -13.526086600971134, -10.409853268861244, -30.469157816933784, -0.5892189043577734, 18.80116605462246, 8.04923582052077, -33.48591734320984, -25.392670613146, -18.9584417918904, 10.643484820177713, 1.073651492314143, 24.10870015725556, -5.386670713176256, -39.378106008779795, -27.410412695778554, 15.530371544362753, -33.39439941755412, -4.344110487581123, -25.464162569636365, -28.009585692610862, -17.516986057467584, 19.513728420961918, -18.78286869242898, 24.37098652314939, 7.913184528571032, 7.809297812086458, 10.462303182718818, 22.788328503522084, 2.7521303609814716, -2.7895479174120315, -9.392818535451969, -6.340226959039477, -5.9590983490754095, 41.44157327325259, 6.5882760556788975, -8.397964595148835, 3.46871304402233, -19.20778468318684, -10.174726678179304, 13.601926678073399, -0.9737294461312906, 13.06763780735009, -1.968797867604831, -5.52992713254894, 6.454477578790509, -19.001446900375953, 7.521867208138313, 14.399523527636953, -44.61902868728722, -19.833388624463996, -14.775456068770525, 0.014366928534430112, 33.42023751562142, 0.6399662069791994, 1.8760435926376395, -31.380950870501646, -17.21253430077997, -37.18984139390708, -25.145096223391636, -19.92225780844612, -17.545418303177456, -10.208997887428321, 15.282834152313612, -7.825488900470914, -33.38862858924244, -8.866779984197045, -33.677382451332655, 41.99356752185655, 6.762777983005135, -12.671529275319603, -5.023189103953216, -3.8743512892951237, 9.457993211900742, -11.39197420841938, -2.016733508856433, -24.14683441815132, -27.12341149893063, -21.413710955844525, -8.323248061080845, 11.409099143971918, 0.7308862912922542, -11.618883685995312, -15.489227135516838, -12.813571362501472, 13.043434124556509, -6.489616471261341, -12.663135362946681, -3.1740645055569523, 23.756689567099826, 32.897193237538644, 8.005796557325976, -9.969934450940356], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 390, 400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 358, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 54, 400, 400, 400, 400, 400, 122, 17, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 26, 114, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 400, 400, 400, 400, 20, 400, 400, 400, 36, 93, 400, 400], "policy_agent_policy_reward": [19.336260014455558, 18.77476464534792, 18.547804430579756, 11.21267678446568, -11.563422056612849, 5.6861069068231025, 27.56092345911045, 19.15470655662046, 13.526086600971135, 10.409853268861244, 30.469157816933794, 0.5892189043577734, -18.801166054622456, -8.049235820520765, 33.48591734320986, 25.392670613145995, 18.9584417918904, -10.643484820177733, -1.0736514923141427, -24.108700157255576, 5.386670713176256, 39.37810600877979, 27.410412695778554, -15.530371544362751, 33.39439941755411, 4.344110487581123, 25.46416256963637, 28.00958569261086, 17.516986057467584, -19.51372842096191, 18.782868692428977, -24.370986523149387, -7.913184528571076, -7.809297812086452, -10.462303182718822, -22.78832850352209, -2.7521303609814716, 2.7895479174120332, 9.392818535451962, 6.340226959039477, 5.959098349075418, -41.44157327325262, -6.5882760556788975, 8.397964595148862, -3.46871304402233, 19.207784683186844, 10.174726678179281, -13.6019266780734, 0.97372944613128, -13.067637807350089, 1.968797867604831, 5.52992713254894, -6.454477578790505, 19.001446900375957, -7.5218672081383104, -14.399523527636958, 44.619028687287226, 19.833388624463993, 14.7754560687705, -0.014366928534431889, -33.42023751562141, -0.6399662069792025, -1.8760435926376395, 31.380950870501636, 17.212534300779947, 37.18984139390709, 25.145096223391633, 19.922257808446115, 17.545418303177467, 10.208997887428321, -15.282834152313617, 7.825488900470916, 33.388628589242444, 8.866779984197045, 33.67738245133265, -41.99356752185652, -6.76277798300514, 12.671529275319593, 5.023189103953216, 3.8743512892951237, -9.457993211900744, 11.39197420841938, 2.0167335088564418, 24.146834418151325, 27.123411498930626, 21.41371095584453, 8.323248061080845, -11.409099143971922, -0.7308862912922542, 11.618883685995312, 15.489227135516835, 12.813571362501472, -13.043434124556507, 6.489616471261341, 12.663135362946681, 3.1740645055569523, -23.756689567099826, -32.897193237538666, -8.005796557325958, 9.969934450940356], "policy_adversary_policy_reward": [-21.16301413639513, -17.50950589251599, -42.51093027364058, 4.9614009829447525, -29.634760455397526, -7.4608484057619755, -4.75456845318913, -17.67078511574223, 10.321297331737341, 12.805546781488296, 4.577192275407818, -15.949406089054001, -23.021692217354662, -32.10015470086624, -15.860310326013796, -22.449102787227126, -2.872717806776553, -24.179455395165718, -9.44752467013296, -11.372181867589529, -28.700823403431407, -32.237492230436175, -16.741299292937004, 15.562861484221457, 21.437818988150205, 16.164513121094707, -3.743636418275594, 19.842108059317127, -22.197786534492757, -44.77404815192696, -36.183803985042815, -14.601537241249186, -11.945582220649491, -25.97130136313131, 5.043988907008572, 16.242980733346954, -0.03252889930083214, 2.1798318839291175, 31.864870863042253, 16.352529451468854, 8.851029867199152, -19.624371293551665, -26.567917779086933, -52.18829423847265, -29.045716973713866, -25.775108417843242, 10.726580314894765, 20.334162773830737, -33.4468605561327, -33.34193827897552, -6.644521488803143, -2.0436994863591025, -20.4442851497892, -30.48403998948354, -26.205391788308525, -29.813779596913193, -16.754922961408287, -18.27904915352688, 28.34260771046421, 10.684849131459606, -13.77671849701824, -23.78901888783973, 34.19627131462453, 14.545701731674242, 8.181759168325538, 7.644609888816564, 0.29310952129566203, 15.325486102877242, 7.617580685594248, 13.307025679843395, 24.472283127672025, 21.104373879372144, 5.572906718633483, -0.06864599667053994, -15.845015566347712, 10.265919731523649, -25.307988895470796, 6.522351824566879, -11.139626575558584, -1.5408273425203696, -7.2708126510881605, -4.647384047062669, 45.24718444174892, 37.6359621047563, 17.984736565196783, -4.808184453838983, -13.492266397762478, -3.3036627925352313, -2.4887265965457175, 9.426152684590377, -23.522994989735388, -14.8925743766383, -13.88665288522629, -6.4628004711322795, 5.719881207501867, 21.483972148644916, 11.040081664241967, -12.987540556504534, 20.708118241937385, 5.427157372762794, -11.041694952288736, 7.104099217079074, 0.43680979630788386, -11.496664061405763, -4.571821817846388, 17.48077697542739, -11.680551101153014, -26.32234269959888, -10.343903801350145, 25.38763821762677, -2.836775372609196, 31.635822427883106, -38.546123292650094, -50.69193408192433, -24.712712499302814, -14.954064749625143, -13.71306515570867, -15.837846981832335, 3.2242058567772816, -3.1954719997084196, 28.22557833994373, 38.614896691299116, -3.289104560955505, 4.569036974913885, -0.8738296418164779, 4.625916827091757, -17.596449812146, -45.16545192885727, -37.02244877301607, 2.5973801714561624, -31.07951472374205, -43.30016806407217, -18.27250567030159, -32.017686776481696, -19.09047926454072, -20.754036352351545, -20.926496246261316, -14.164340360093597, -12.12759378498042, -8.290401989876223, 18.58372217006197, 11.981946134565254, 0.5408897797356111, -16.191867580677442, -22.048218678500632, -44.72903849998431, 3.6692966663939472, -21.402856634788034, -11.131409484480802, -56.2233554181845, 42.310286717799464, 41.67684832591362, 15.982698106229552, -2.4571421402192613, -10.470108103314718, -14.872950447324481, 13.92945667207551, -23.975834879981942, -7.942413809965132, 0.1937112313748841, 7.535377466295948, 11.38060895750555, -10.123572381080841, -12.66037603575792, -13.782103210185298, 9.748636192472414, -4.639430769060059, -43.654238067242616, -14.874052983708495, -39.37277001415274, -25.03777658431414, -17.78964532737494, -22.181408516442858, 5.534912394281168, 12.12557540880874, 10.692622879135097, 5.734606548308392, -4.272833965723883, -21.454429410071945, -1.7833379619186793, -14.643940148070769, -16.3345141229629, -19.4879316734757, -6.139211051527244, 2.7795469253567493, 23.307321323756266, 3.196866542997256, -16.176099485519938, -12.838382041724977, -12.487888684168386, -11.78003289623408, 5.431903885120175, 23.593416395950413, 23.919962738249232, 18.915511142652534, 46.878875332424776, 8.177403120738028, 7.83418999391391, -2.177097093695785, -17.762771808184926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4263564752680456, "mean_inference_ms": 1.1247399671720644, "mean_action_processing_ms": 0.18310952737192307, "mean_env_wait_ms": 0.07477565577782115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517627716064453, "StateBufferConnector_ms": 0.0028580427169799805, "ViewRequirementAgentConnector_ms": 0.06692349910736084}, "num_episodes": 12, "episode_return_max": 41.99356752185655, "episode_return_min": -44.61902868728722, "episode_return_mean": -5.611077534384743}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.84608267768687, "num_env_steps_trained_throughput_per_sec": 486.84608267768687, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 8251.588, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8251.553, "sample_time_ms": 782.014, "learn_time_ms": 7456.539, "learn_throughput": 536.442, "synch_weights_time_ms": 12.315}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 136, "trial_id": "83a5c_00000", "date": "2024-08-10_12-33-17", "timestamp": 1723307597, "time_this_iter_s": 8.222236156463623, "time_total_s": 1158.763953447342, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc31c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1158.763953447342, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 26.500000000000004, "ram_util_percent": 83.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.224676679555701, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.158332427721175, "policy_loss": -0.004694861354227498, "vf_loss": 3.162712683942583, "vf_explained_var": -0.037307029552560635, "kl": 0.006207320445873606, "entropy": 1.295290359996614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.564449377916754, "cur_kl_coeff": 5.5681087542325275e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.437695947041114, "policy_loss": -0.005297620254471743, "vf_loss": 3.442993352562189, "vf_explained_var": 0.44679914731532333, "kl": 0.0038810046291525607, "entropy": 0.25226865618800126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "env_runners": {"episode_reward_max": 41.99356752185655, "episode_reward_min": -44.61902868728722, "episode_reward_mean": -4.023581850350841, "episode_len_mean": 339.21, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 33921, "policy_reward_min": {"agent_policy": -41.99356752185652, "adversary_policy": -56.2233554181845}, "policy_reward_max": {"agent_policy": 44.619028687287226, "adversary_policy": 46.878875332424776}, "policy_reward_mean": {"agent_policy": 4.023581850350841, "adversary_policy": -4.023581850350841}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.04923582052077, -33.48591734320984, -25.392670613146, -18.9584417918904, 10.643484820177713, 1.073651492314143, 24.10870015725556, -5.386670713176256, -39.378106008779795, -27.410412695778554, 15.530371544362753, -33.39439941755412, -4.344110487581123, -25.464162569636365, -28.009585692610862, -17.516986057467584, 19.513728420961918, -18.78286869242898, 24.37098652314939, 7.913184528571032, 7.809297812086458, 10.462303182718818, 22.788328503522084, 2.7521303609814716, -2.7895479174120315, -9.392818535451969, -6.340226959039477, -5.9590983490754095, 41.44157327325259, 6.5882760556788975, -8.397964595148835, 3.46871304402233, -19.20778468318684, -10.174726678179304, 13.601926678073399, -0.9737294461312906, 13.06763780735009, -1.968797867604831, -5.52992713254894, 6.454477578790509, -19.001446900375953, 7.521867208138313, 14.399523527636953, -44.61902868728722, -19.833388624463996, -14.775456068770525, 0.014366928534430112, 33.42023751562142, 0.6399662069791994, 1.8760435926376395, -31.380950870501646, -17.21253430077997, -37.18984139390708, -25.145096223391636, -19.92225780844612, -17.545418303177456, -10.208997887428321, 15.282834152313612, -7.825488900470914, -33.38862858924244, -8.866779984197045, -33.677382451332655, 41.99356752185655, 6.762777983005135, -12.671529275319603, -5.023189103953216, -3.8743512892951237, 9.457993211900742, -11.39197420841938, -2.016733508856433, -24.14683441815132, -27.12341149893063, -21.413710955844525, -8.323248061080845, 11.409099143971918, 0.7308862912922542, -11.618883685995312, -15.489227135516838, -12.813571362501472, 13.043434124556509, -6.489616471261341, -12.663135362946681, -3.1740645055569523, 23.756689567099826, 32.897193237538644, 8.005796557325976, -9.969934450940356, 9.585739321067253, 35.736442541617755, -12.015090889592258, -0.9421397241807519, -10.63505627562495, -27.26603872512626, 28.438904253123642, 13.057951802352122, 0.2306769108154345, -15.960479507766394, -19.93743922245473, 0.9407419272735673, 12.612384714594151], "episode_lengths": [400, 400, 400, 400, 400, 29, 400, 400, 400, 400, 358, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 54, 400, 400, 400, 400, 400, 122, 17, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 26, 114, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 400, 400, 400, 400, 20, 400, 400, 400, 36, 93, 400, 400, 400, 88, 400, 400, 400, 400, 45, 400, 400, 400, 400, 400, 33], "policy_agent_policy_reward": [-8.049235820520765, 33.48591734320986, 25.392670613145995, 18.9584417918904, -10.643484820177733, -1.0736514923141427, -24.108700157255576, 5.386670713176256, 39.37810600877979, 27.410412695778554, -15.530371544362751, 33.39439941755411, 4.344110487581123, 25.46416256963637, 28.00958569261086, 17.516986057467584, -19.51372842096191, 18.782868692428977, -24.370986523149387, -7.913184528571076, -7.809297812086452, -10.462303182718822, -22.78832850352209, -2.7521303609814716, 2.7895479174120332, 9.392818535451962, 6.340226959039477, 5.959098349075418, -41.44157327325262, -6.5882760556788975, 8.397964595148862, -3.46871304402233, 19.207784683186844, 10.174726678179281, -13.6019266780734, 0.97372944613128, -13.067637807350089, 1.968797867604831, 5.52992713254894, -6.454477578790505, 19.001446900375957, -7.5218672081383104, -14.399523527636958, 44.619028687287226, 19.833388624463993, 14.7754560687705, -0.014366928534431889, -33.42023751562141, -0.6399662069792025, -1.8760435926376395, 31.380950870501636, 17.212534300779947, 37.18984139390709, 25.145096223391633, 19.922257808446115, 17.545418303177467, 10.208997887428321, -15.282834152313617, 7.825488900470916, 33.388628589242444, 8.866779984197045, 33.67738245133265, -41.99356752185652, -6.76277798300514, 12.671529275319593, 5.023189103953216, 3.8743512892951237, -9.457993211900744, 11.39197420841938, 2.0167335088564418, 24.146834418151325, 27.123411498930626, 21.41371095584453, 8.323248061080845, -11.409099143971922, -0.7308862912922542, 11.618883685995312, 15.489227135516835, 12.813571362501472, -13.043434124556507, 6.489616471261341, 12.663135362946681, 3.1740645055569523, -23.756689567099826, -32.897193237538666, -8.005796557325958, 9.969934450940356, -9.585739321067253, -35.73644254161771, 12.015090889592258, 0.9421397241807519, 10.63505627562495, 27.266038725126272, -28.43890425312365, -13.057951802352122, -0.23067691081541852, 15.960479507766397, 19.937439222454728, -0.9407419272735655, -12.612384714594148], "policy_adversary_policy_reward": [-3.743636418275594, 19.842108059317127, -22.197786534492757, -44.77404815192696, -36.183803985042815, -14.601537241249186, -11.945582220649491, -25.97130136313131, 5.043988907008572, 16.242980733346954, -0.03252889930083214, 2.1798318839291175, 31.864870863042253, 16.352529451468854, 8.851029867199152, -19.624371293551665, -26.567917779086933, -52.18829423847265, -29.045716973713866, -25.775108417843242, 10.726580314894765, 20.334162773830737, -33.4468605561327, -33.34193827897552, -6.644521488803143, -2.0436994863591025, -20.4442851497892, -30.48403998948354, -26.205391788308525, -29.813779596913193, -16.754922961408287, -18.27904915352688, 28.34260771046421, 10.684849131459606, -13.77671849701824, -23.78901888783973, 34.19627131462453, 14.545701731674242, 8.181759168325538, 7.644609888816564, 0.29310952129566203, 15.325486102877242, 7.617580685594248, 13.307025679843395, 24.472283127672025, 21.104373879372144, 5.572906718633483, -0.06864599667053994, -15.845015566347712, 10.265919731523649, -25.307988895470796, 6.522351824566879, -11.139626575558584, -1.5408273425203696, -7.2708126510881605, -4.647384047062669, 45.24718444174892, 37.6359621047563, 17.984736565196783, -4.808184453838983, -13.492266397762478, -3.3036627925352313, -2.4887265965457175, 9.426152684590377, -23.522994989735388, -14.8925743766383, -13.88665288522629, -6.4628004711322795, 5.719881207501867, 21.483972148644916, 11.040081664241967, -12.987540556504534, 20.708118241937385, 5.427157372762794, -11.041694952288736, 7.104099217079074, 0.43680979630788386, -11.496664061405763, -4.571821817846388, 17.48077697542739, -11.680551101153014, -26.32234269959888, -10.343903801350145, 25.38763821762677, -2.836775372609196, 31.635822427883106, -38.546123292650094, -50.69193408192433, -24.712712499302814, -14.954064749625143, -13.71306515570867, -15.837846981832335, 3.2242058567772816, -3.1954719997084196, 28.22557833994373, 38.614896691299116, -3.289104560955505, 4.569036974913885, -0.8738296418164779, 4.625916827091757, -17.596449812146, -45.16545192885727, -37.02244877301607, 2.5973801714561624, -31.07951472374205, -43.30016806407217, -18.27250567030159, -32.017686776481696, -19.09047926454072, -20.754036352351545, -20.926496246261316, -14.164340360093597, -12.12759378498042, -8.290401989876223, 18.58372217006197, 11.981946134565254, 0.5408897797356111, -16.191867580677442, -22.048218678500632, -44.72903849998431, 3.6692966663939472, -21.402856634788034, -11.131409484480802, -56.2233554181845, 42.310286717799464, 41.67684832591362, 15.982698106229552, -2.4571421402192613, -10.470108103314718, -14.872950447324481, 13.92945667207551, -23.975834879981942, -7.942413809965132, 0.1937112313748841, 7.535377466295948, 11.38060895750555, -10.123572381080841, -12.66037603575792, -13.782103210185298, 9.748636192472414, -4.639430769060059, -43.654238067242616, -14.874052983708495, -39.37277001415274, -25.03777658431414, -17.78964532737494, -22.181408516442858, 5.534912394281168, 12.12557540880874, 10.692622879135097, 5.734606548308392, -4.272833965723883, -21.454429410071945, -1.7833379619186793, -14.643940148070769, -16.3345141229629, -19.4879316734757, -6.139211051527244, 2.7795469253567493, 23.307321323756266, 3.196866542997256, -16.176099485519938, -12.838382041724977, -12.487888684168386, -11.78003289623408, 5.431903885120175, 23.593416395950413, 23.919962738249232, 18.915511142652534, 46.878875332424776, 8.177403120738028, 7.83418999391391, -2.177097093695785, -17.762771808184926, -5.28011740811284, 24.451596050247346, 28.269355637389904, 43.20352944584555, -8.999127193348137, -15.031054585836376, 9.44311745552028, -11.327396903881784, -21.009978354879923, -0.26013419636997526, -38.40511431615722, -16.126963134095284, 27.431363120716846, 29.446445385530453, 17.22622746846598, 8.889676136238265, -10.120322672451728, 10.581676494082537, -23.503131971434186, -8.417827044098605, -27.116003828602622, -12.758874616306827, 1.0207907369702198, 0.8606931175769184, 29.18908666856573, -3.9643172393774186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4260752886591071, "mean_inference_ms": 1.1234988384879743, "mean_action_processing_ms": 0.18298050208008873, "mean_env_wait_ms": 0.07467141518485612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034711360931396484, "StateBufferConnector_ms": 0.002855658531188965, "ViewRequirementAgentConnector_ms": 0.06554388999938965}, "num_episodes": 13, "episode_return_max": 41.99356752185655, "episode_return_min": -44.61902868728722, "episode_return_mean": -4.023581850350841}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 452.6942977793225, "num_env_steps_trained_throughput_per_sec": 452.6942977793225, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 1644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1644000, "timers": {"training_iteration_time_ms": 8313.276, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8313.24, "sample_time_ms": 779.543, "learn_time_ms": 7520.276, "learn_throughput": 531.895, "synch_weights_time_ms": 12.641}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 1644000, "num_agent_steps_trained": 1644000}, "done": false, "training_iteration": 137, "trial_id": "83a5c_00000", "date": "2024-08-10_12-33-26", "timestamp": 1723307606, "time_this_iter_s": 8.893795013427734, "time_total_s": 1167.6577484607697, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb63ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1167.6577484607697, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 29.366666666666664, "ram_util_percent": 83.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6832314233300547, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.645779516015734, "policy_loss": -0.00541994602458857, "vf_loss": 2.650446689065802, "vf_explained_var": -0.06743795285149226, "kl": 0.014852929493709803, "entropy": 1.4035162098193295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.033983075432479, "cur_kl_coeff": 2.7840543771162637e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.126922244330247, "policy_loss": -0.010301644613112634, "vf_loss": 2.1372237499803304, "vf_explained_var": 0.7220448238775135, "kl": 0.004395675289750901, "entropy": 0.27491839369758964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "env_runners": {"episode_reward_max": 41.99356752185655, "episode_reward_min": -44.61902868728722, "episode_reward_mean": -4.3085674377938235, "episode_len_mean": 342.92, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 34292, "policy_reward_min": {"agent_policy": -41.99356752185652, "adversary_policy": -56.2233554181845}, "policy_reward_max": {"agent_policy": 44.619028687287226, "adversary_policy": 46.878875332424776}, "policy_reward_mean": {"agent_policy": 4.308567437793823, "adversary_policy": -4.3085674377938235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.410412695778554, 15.530371544362753, -33.39439941755412, -4.344110487581123, -25.464162569636365, -28.009585692610862, -17.516986057467584, 19.513728420961918, -18.78286869242898, 24.37098652314939, 7.913184528571032, 7.809297812086458, 10.462303182718818, 22.788328503522084, 2.7521303609814716, -2.7895479174120315, -9.392818535451969, -6.340226959039477, -5.9590983490754095, 41.44157327325259, 6.5882760556788975, -8.397964595148835, 3.46871304402233, -19.20778468318684, -10.174726678179304, 13.601926678073399, -0.9737294461312906, 13.06763780735009, -1.968797867604831, -5.52992713254894, 6.454477578790509, -19.001446900375953, 7.521867208138313, 14.399523527636953, -44.61902868728722, -19.833388624463996, -14.775456068770525, 0.014366928534430112, 33.42023751562142, 0.6399662069791994, 1.8760435926376395, -31.380950870501646, -17.21253430077997, -37.18984139390708, -25.145096223391636, -19.92225780844612, -17.545418303177456, -10.208997887428321, 15.282834152313612, -7.825488900470914, -33.38862858924244, -8.866779984197045, -33.677382451332655, 41.99356752185655, 6.762777983005135, -12.671529275319603, -5.023189103953216, -3.8743512892951237, 9.457993211900742, -11.39197420841938, -2.016733508856433, -24.14683441815132, -27.12341149893063, -21.413710955844525, -8.323248061080845, 11.409099143971918, 0.7308862912922542, -11.618883685995312, -15.489227135516838, -12.813571362501472, 13.043434124556509, -6.489616471261341, -12.663135362946681, -3.1740645055569523, 23.756689567099826, 32.897193237538644, 8.005796557325976, -9.969934450940356, 9.585739321067253, 35.736442541617755, -12.015090889592258, -0.9421397241807519, -10.63505627562495, -27.26603872512626, 28.438904253123642, 13.057951802352122, 0.2306769108154345, -15.960479507766394, -19.93743922245473, 0.9407419272735673, 12.612384714594151, -11.738402466271776, -14.284639673869268, -4.8355326083514445, -14.4450639139821, -4.517315790773864, -24.057073785838515, -14.630528762117306, -5.41028158742418, -13.306454335603789], "episode_lengths": [400, 358, 400, 400, 400, 400, 400, 400, 400, 66, 400, 400, 400, 54, 400, 400, 400, 400, 400, 122, 17, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 26, 114, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 400, 400, 400, 400, 20, 400, 400, 400, 36, 93, 400, 400, 400, 88, 400, 400, 400, 400, 45, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [27.410412695778554, -15.530371544362751, 33.39439941755411, 4.344110487581123, 25.46416256963637, 28.00958569261086, 17.516986057467584, -19.51372842096191, 18.782868692428977, -24.370986523149387, -7.913184528571076, -7.809297812086452, -10.462303182718822, -22.78832850352209, -2.7521303609814716, 2.7895479174120332, 9.392818535451962, 6.340226959039477, 5.959098349075418, -41.44157327325262, -6.5882760556788975, 8.397964595148862, -3.46871304402233, 19.207784683186844, 10.174726678179281, -13.6019266780734, 0.97372944613128, -13.067637807350089, 1.968797867604831, 5.52992713254894, -6.454477578790505, 19.001446900375957, -7.5218672081383104, -14.399523527636958, 44.619028687287226, 19.833388624463993, 14.7754560687705, -0.014366928534431889, -33.42023751562141, -0.6399662069792025, -1.8760435926376395, 31.380950870501636, 17.212534300779947, 37.18984139390709, 25.145096223391633, 19.922257808446115, 17.545418303177467, 10.208997887428321, -15.282834152313617, 7.825488900470916, 33.388628589242444, 8.866779984197045, 33.67738245133265, -41.99356752185652, -6.76277798300514, 12.671529275319593, 5.023189103953216, 3.8743512892951237, -9.457993211900744, 11.39197420841938, 2.0167335088564418, 24.146834418151325, 27.123411498930626, 21.41371095584453, 8.323248061080845, -11.409099143971922, -0.7308862912922542, 11.618883685995312, 15.489227135516835, 12.813571362501472, -13.043434124556507, 6.489616471261341, 12.663135362946681, 3.1740645055569523, -23.756689567099826, -32.897193237538666, -8.005796557325958, 9.969934450940356, -9.585739321067253, -35.73644254161771, 12.015090889592258, 0.9421397241807519, 10.63505627562495, 27.266038725126272, -28.43890425312365, -13.057951802352122, -0.23067691081541852, 15.960479507766397, 19.937439222454728, -0.9407419272735655, -12.612384714594148, 11.738402466271776, 14.284639673869265, 4.8355326083514445, 14.445063913982098, 4.517315790773864, 24.05707378583851, 14.630528762117306, 5.410281587424169, 13.306454335603785], "policy_adversary_policy_reward": [-29.045716973713866, -25.775108417843242, 10.726580314894765, 20.334162773830737, -33.4468605561327, -33.34193827897552, -6.644521488803143, -2.0436994863591025, -20.4442851497892, -30.48403998948354, -26.205391788308525, -29.813779596913193, -16.754922961408287, -18.27904915352688, 28.34260771046421, 10.684849131459606, -13.77671849701824, -23.78901888783973, 34.19627131462453, 14.545701731674242, 8.181759168325538, 7.644609888816564, 0.29310952129566203, 15.325486102877242, 7.617580685594248, 13.307025679843395, 24.472283127672025, 21.104373879372144, 5.572906718633483, -0.06864599667053994, -15.845015566347712, 10.265919731523649, -25.307988895470796, 6.522351824566879, -11.139626575558584, -1.5408273425203696, -7.2708126510881605, -4.647384047062669, 45.24718444174892, 37.6359621047563, 17.984736565196783, -4.808184453838983, -13.492266397762478, -3.3036627925352313, -2.4887265965457175, 9.426152684590377, -23.522994989735388, -14.8925743766383, -13.88665288522629, -6.4628004711322795, 5.719881207501867, 21.483972148644916, 11.040081664241967, -12.987540556504534, 20.708118241937385, 5.427157372762794, -11.041694952288736, 7.104099217079074, 0.43680979630788386, -11.496664061405763, -4.571821817846388, 17.48077697542739, -11.680551101153014, -26.32234269959888, -10.343903801350145, 25.38763821762677, -2.836775372609196, 31.635822427883106, -38.546123292650094, -50.69193408192433, -24.712712499302814, -14.954064749625143, -13.71306515570867, -15.837846981832335, 3.2242058567772816, -3.1954719997084196, 28.22557833994373, 38.614896691299116, -3.289104560955505, 4.569036974913885, -0.8738296418164779, 4.625916827091757, -17.596449812146, -45.16545192885727, -37.02244877301607, 2.5973801714561624, -31.07951472374205, -43.30016806407217, -18.27250567030159, -32.017686776481696, -19.09047926454072, -20.754036352351545, -20.926496246261316, -14.164340360093597, -12.12759378498042, -8.290401989876223, 18.58372217006197, 11.981946134565254, 0.5408897797356111, -16.191867580677442, -22.048218678500632, -44.72903849998431, 3.6692966663939472, -21.402856634788034, -11.131409484480802, -56.2233554181845, 42.310286717799464, 41.67684832591362, 15.982698106229552, -2.4571421402192613, -10.470108103314718, -14.872950447324481, 13.92945667207551, -23.975834879981942, -7.942413809965132, 0.1937112313748841, 7.535377466295948, 11.38060895750555, -10.123572381080841, -12.66037603575792, -13.782103210185298, 9.748636192472414, -4.639430769060059, -43.654238067242616, -14.874052983708495, -39.37277001415274, -25.03777658431414, -17.78964532737494, -22.181408516442858, 5.534912394281168, 12.12557540880874, 10.692622879135097, 5.734606548308392, -4.272833965723883, -21.454429410071945, -1.7833379619186793, -14.643940148070769, -16.3345141229629, -19.4879316734757, -6.139211051527244, 2.7795469253567493, 23.307321323756266, 3.196866542997256, -16.176099485519938, -12.838382041724977, -12.487888684168386, -11.78003289623408, 5.431903885120175, 23.593416395950413, 23.919962738249232, 18.915511142652534, 46.878875332424776, 8.177403120738028, 7.83418999391391, -2.177097093695785, -17.762771808184926, -5.28011740811284, 24.451596050247346, 28.269355637389904, 43.20352944584555, -8.999127193348137, -15.031054585836376, 9.44311745552028, -11.327396903881784, -21.009978354879923, -0.26013419636997526, -38.40511431615722, -16.126963134095284, 27.431363120716846, 29.446445385530453, 17.22622746846598, 8.889676136238265, -10.120322672451728, 10.581676494082537, -23.503131971434186, -8.417827044098605, -27.116003828602622, -12.758874616306827, 1.0207907369702198, 0.8606931175769184, 29.18908666856573, -3.9643172393774186, -19.04176319008885, -4.4350417424547, -11.944896743137392, -16.62438260460115, 7.063985195516096, -16.735050412218985, -24.323931173002745, -4.566196654961452, -8.227754801481279, -0.8068767800664212, -20.61418434970355, -27.499963221973474, -5.27579550127215, -23.985262022962463, -4.635537040984744, -6.185026133863602, -7.134045622481736, -19.478863048725838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42593915086480494, "mean_inference_ms": 1.1228177110553939, "mean_action_processing_ms": 0.18289640601149768, "mean_env_wait_ms": 0.07463224342019112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003479599952697754, "StateBufferConnector_ms": 0.002835869789123535, "ViewRequirementAgentConnector_ms": 0.06543076038360596}, "num_episodes": 9, "episode_return_max": 41.99356752185655, "episode_return_min": -44.61902868728722, "episode_return_mean": -4.3085674377938235}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.03421654788696, "num_env_steps_trained_throughput_per_sec": 496.03421654788696, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 1656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1656000, "timers": {"training_iteration_time_ms": 8306.38, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8306.345, "sample_time_ms": 780.822, "learn_time_ms": 7512.345, "learn_throughput": 532.457, "synch_weights_time_ms": 12.411}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "done": false, "training_iteration": 138, "trial_id": "83a5c_00000", "date": "2024-08-10_12-33-34", "timestamp": 1723307614, "time_this_iter_s": 8.069134712219238, "time_total_s": 1175.726883172989, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc199d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1175.726883172989, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 26.40833333333333, "ram_util_percent": 82.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.788298509266011, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.267377526671798, "policy_loss": -0.0032152071634613017, "vf_loss": 2.2701526758532045, "vf_explained_var": -0.08091987708888987, "kl": 0.008682612713700166, "entropy": 1.3890853204424418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.210002809266249, "cur_kl_coeff": 1.3920271885581319e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9670483677337567, "policy_loss": -0.005575962392322253, "vf_loss": 1.9726242794344822, "vf_explained_var": 0.641756987820069, "kl": 0.004592774071437446, "entropy": 0.24378642571779588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "env_runners": {"episode_reward_max": 41.99356752185655, "episode_reward_min": -44.61902868728722, "episode_reward_mean": -3.866544726094485, "episode_len_mean": 342.87, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 34287, "policy_reward_min": {"agent_policy": -41.99356752185652, "adversary_policy": -56.2233554181845}, "policy_reward_max": {"agent_policy": 44.619028687287226, "adversary_policy": 46.878875332424776}, "policy_reward_mean": {"agent_policy": 3.866544726094485, "adversary_policy": -3.8665447260944865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.462303182718818, 22.788328503522084, 2.7521303609814716, -2.7895479174120315, -9.392818535451969, -6.340226959039477, -5.9590983490754095, 41.44157327325259, 6.5882760556788975, -8.397964595148835, 3.46871304402233, -19.20778468318684, -10.174726678179304, 13.601926678073399, -0.9737294461312906, 13.06763780735009, -1.968797867604831, -5.52992713254894, 6.454477578790509, -19.001446900375953, 7.521867208138313, 14.399523527636953, -44.61902868728722, -19.833388624463996, -14.775456068770525, 0.014366928534430112, 33.42023751562142, 0.6399662069791994, 1.8760435926376395, -31.380950870501646, -17.21253430077997, -37.18984139390708, -25.145096223391636, -19.92225780844612, -17.545418303177456, -10.208997887428321, 15.282834152313612, -7.825488900470914, -33.38862858924244, -8.866779984197045, -33.677382451332655, 41.99356752185655, 6.762777983005135, -12.671529275319603, -5.023189103953216, -3.8743512892951237, 9.457993211900742, -11.39197420841938, -2.016733508856433, -24.14683441815132, -27.12341149893063, -21.413710955844525, -8.323248061080845, 11.409099143971918, 0.7308862912922542, -11.618883685995312, -15.489227135516838, -12.813571362501472, 13.043434124556509, -6.489616471261341, -12.663135362946681, -3.1740645055569523, 23.756689567099826, 32.897193237538644, 8.005796557325976, -9.969934450940356, 9.585739321067253, 35.736442541617755, -12.015090889592258, -0.9421397241807519, -10.63505627562495, -27.26603872512626, 28.438904253123642, 13.057951802352122, 0.2306769108154345, -15.960479507766394, -19.93743922245473, 0.9407419272735673, 12.612384714594151, -11.738402466271776, -14.284639673869268, -4.8355326083514445, -14.4450639139821, -4.517315790773864, -24.057073785838515, -14.630528762117306, -5.41028158742418, -13.306454335603789, -1.7811316048743482, -3.5702472473444455, -4.527535170500631, -15.310587187590158, 8.67591870538351, -4.668237492979593, -17.784504163501392, 1.4489162326490739, 5.700077642431621, -18.02578861151422, 12.134178017754842, 2.1262552660934197], "episode_lengths": [400, 54, 400, 400, 400, 400, 400, 122, 17, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 26, 114, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 400, 400, 400, 400, 20, 400, 400, 400, 36, 93, 400, 400, 400, 88, 400, 400, 400, 400, 45, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400], "policy_agent_policy_reward": [-10.462303182718822, -22.78832850352209, -2.7521303609814716, 2.7895479174120332, 9.392818535451962, 6.340226959039477, 5.959098349075418, -41.44157327325262, -6.5882760556788975, 8.397964595148862, -3.46871304402233, 19.207784683186844, 10.174726678179281, -13.6019266780734, 0.97372944613128, -13.067637807350089, 1.968797867604831, 5.52992713254894, -6.454477578790505, 19.001446900375957, -7.5218672081383104, -14.399523527636958, 44.619028687287226, 19.833388624463993, 14.7754560687705, -0.014366928534431889, -33.42023751562141, -0.6399662069792025, -1.8760435926376395, 31.380950870501636, 17.212534300779947, 37.18984139390709, 25.145096223391633, 19.922257808446115, 17.545418303177467, 10.208997887428321, -15.282834152313617, 7.825488900470916, 33.388628589242444, 8.866779984197045, 33.67738245133265, -41.99356752185652, -6.76277798300514, 12.671529275319593, 5.023189103953216, 3.8743512892951237, -9.457993211900744, 11.39197420841938, 2.0167335088564418, 24.146834418151325, 27.123411498930626, 21.41371095584453, 8.323248061080845, -11.409099143971922, -0.7308862912922542, 11.618883685995312, 15.489227135516835, 12.813571362501472, -13.043434124556507, 6.489616471261341, 12.663135362946681, 3.1740645055569523, -23.756689567099826, -32.897193237538666, -8.005796557325958, 9.969934450940356, -9.585739321067253, -35.73644254161771, 12.015090889592258, 0.9421397241807519, 10.63505627562495, 27.266038725126272, -28.43890425312365, -13.057951802352122, -0.23067691081541852, 15.960479507766397, 19.937439222454728, -0.9407419272735655, -12.612384714594148, 11.738402466271776, 14.284639673869265, 4.8355326083514445, 14.445063913982098, 4.517315790773864, 24.05707378583851, 14.630528762117306, 5.410281587424169, 13.306454335603785, 1.7811316048743535, 3.5702472473444455, 4.527535170500636, 15.310587187590162, -8.675918705383545, 4.668237492979626, 17.78450416350139, -1.4489162326490739, -5.700077642431639, 18.02578861151423, -12.134178017754842, -2.1262552660934197], "policy_adversary_policy_reward": [7.617580685594248, 13.307025679843395, 24.472283127672025, 21.104373879372144, 5.572906718633483, -0.06864599667053994, -15.845015566347712, 10.265919731523649, -25.307988895470796, 6.522351824566879, -11.139626575558584, -1.5408273425203696, -7.2708126510881605, -4.647384047062669, 45.24718444174892, 37.6359621047563, 17.984736565196783, -4.808184453838983, -13.492266397762478, -3.3036627925352313, -2.4887265965457175, 9.426152684590377, -23.522994989735388, -14.8925743766383, -13.88665288522629, -6.4628004711322795, 5.719881207501867, 21.483972148644916, 11.040081664241967, -12.987540556504534, 20.708118241937385, 5.427157372762794, -11.041694952288736, 7.104099217079074, 0.43680979630788386, -11.496664061405763, -4.571821817846388, 17.48077697542739, -11.680551101153014, -26.32234269959888, -10.343903801350145, 25.38763821762677, -2.836775372609196, 31.635822427883106, -38.546123292650094, -50.69193408192433, -24.712712499302814, -14.954064749625143, -13.71306515570867, -15.837846981832335, 3.2242058567772816, -3.1954719997084196, 28.22557833994373, 38.614896691299116, -3.289104560955505, 4.569036974913885, -0.8738296418164779, 4.625916827091757, -17.596449812146, -45.16545192885727, -37.02244877301607, 2.5973801714561624, -31.07951472374205, -43.30016806407217, -18.27250567030159, -32.017686776481696, -19.09047926454072, -20.754036352351545, -20.926496246261316, -14.164340360093597, -12.12759378498042, -8.290401989876223, 18.58372217006197, 11.981946134565254, 0.5408897797356111, -16.191867580677442, -22.048218678500632, -44.72903849998431, 3.6692966663939472, -21.402856634788034, -11.131409484480802, -56.2233554181845, 42.310286717799464, 41.67684832591362, 15.982698106229552, -2.4571421402192613, -10.470108103314718, -14.872950447324481, 13.92945667207551, -23.975834879981942, -7.942413809965132, 0.1937112313748841, 7.535377466295948, 11.38060895750555, -10.123572381080841, -12.66037603575792, -13.782103210185298, 9.748636192472414, -4.639430769060059, -43.654238067242616, -14.874052983708495, -39.37277001415274, -25.03777658431414, -17.78964532737494, -22.181408516442858, 5.534912394281168, 12.12557540880874, 10.692622879135097, 5.734606548308392, -4.272833965723883, -21.454429410071945, -1.7833379619186793, -14.643940148070769, -16.3345141229629, -19.4879316734757, -6.139211051527244, 2.7795469253567493, 23.307321323756266, 3.196866542997256, -16.176099485519938, -12.838382041724977, -12.487888684168386, -11.78003289623408, 5.431903885120175, 23.593416395950413, 23.919962738249232, 18.915511142652534, 46.878875332424776, 8.177403120738028, 7.83418999391391, -2.177097093695785, -17.762771808184926, -5.28011740811284, 24.451596050247346, 28.269355637389904, 43.20352944584555, -8.999127193348137, -15.031054585836376, 9.44311745552028, -11.327396903881784, -21.009978354879923, -0.26013419636997526, -38.40511431615722, -16.126963134095284, 27.431363120716846, 29.446445385530453, 17.22622746846598, 8.889676136238265, -10.120322672451728, 10.581676494082537, -23.503131971434186, -8.417827044098605, -27.116003828602622, -12.758874616306827, 1.0207907369702198, 0.8606931175769184, 29.18908666856573, -3.9643172393774186, -19.04176319008885, -4.4350417424547, -11.944896743137392, -16.62438260460115, 7.063985195516096, -16.735050412218985, -24.323931173002745, -4.566196654961452, -8.227754801481279, -0.8068767800664212, -20.61418434970355, -27.499963221973474, -5.27579550127215, -23.985262022962463, -4.635537040984744, -6.185026133863602, -7.134045622481736, -19.478863048725838, 3.288073496675736, -6.850336706424464, 4.099798559641492, -11.240293054330383, -2.333588541015576, -6.7214817999857, -6.11520932521708, -24.50596504996324, 5.3928154274262745, 11.959021983340783, 9.622337152436373, -18.958812138395626, -18.735335252691645, -16.833673074311143, 5.816991699098963, -2.9191592338008157, 0.7448987136393121, 10.655256571223923, -13.381999471896794, -22.669577751131655, 11.001126666228128, 13.267229369281551, 7.24709034246694, -2.9945798102801007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.425663958662254, "mean_inference_ms": 1.121800046968607, "mean_action_processing_ms": 0.18276519632837535, "mean_env_wait_ms": 0.07456226134171685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035325288772583008, "StateBufferConnector_ms": 0.002916097640991211, "ViewRequirementAgentConnector_ms": 0.06556451320648193}, "num_episodes": 12, "episode_return_max": 41.99356752185655, "episode_return_min": -44.61902868728722, "episode_return_mean": -3.866544726094485}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.18796365203167, "num_env_steps_trained_throughput_per_sec": 491.18796365203167, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 1668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1668000, "timers": {"training_iteration_time_ms": 8284.276, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8284.243, "sample_time_ms": 781.498, "learn_time_ms": 7489.598, "learn_throughput": 534.074, "synch_weights_time_ms": 12.511}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 1668000, "num_agent_steps_trained": 1668000}, "done": false, "training_iteration": 139, "trial_id": "83a5c_00000", "date": "2024-08-10_12-33-42", "timestamp": 1723307622, "time_this_iter_s": 8.148682832717896, "time_total_s": 1183.8755660057068, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc74a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1183.8755660057068, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 26.672727272727272, "ram_util_percent": 82.94545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0432832624231065, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.897000803613158, "policy_loss": -0.007226197110986702, "vf_loss": 1.9035823356537591, "vf_explained_var": 0.12113013191828652, "kl": 0.012719746706863419, "entropy": 1.3635767399318635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4327507635268075, "cur_kl_coeff": 6.960135942790659e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8712602081398169, "policy_loss": -0.009689529538930704, "vf_loss": 1.8809497190018496, "vf_explained_var": 0.49837851064900557, "kl": 0.0062009720192874995, "entropy": 0.21210664662842948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 41.99356752185655, "episode_reward_min": -44.61902868728722, "episode_reward_mean": -5.746092473804425, "episode_len_mean": 352.94, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 35294, "policy_reward_min": {"agent_policy": -41.99356752185652, "adversary_policy": -56.2233554181845}, "policy_reward_max": {"agent_policy": 44.619028687287226, "adversary_policy": 46.878875332424776}, "policy_reward_mean": {"agent_policy": 5.746092473804427, "adversary_policy": -5.746092473804427}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.397964595148835, 3.46871304402233, -19.20778468318684, -10.174726678179304, 13.601926678073399, -0.9737294461312906, 13.06763780735009, -1.968797867604831, -5.52992713254894, 6.454477578790509, -19.001446900375953, 7.521867208138313, 14.399523527636953, -44.61902868728722, -19.833388624463996, -14.775456068770525, 0.014366928534430112, 33.42023751562142, 0.6399662069791994, 1.8760435926376395, -31.380950870501646, -17.21253430077997, -37.18984139390708, -25.145096223391636, -19.92225780844612, -17.545418303177456, -10.208997887428321, 15.282834152313612, -7.825488900470914, -33.38862858924244, -8.866779984197045, -33.677382451332655, 41.99356752185655, 6.762777983005135, -12.671529275319603, -5.023189103953216, -3.8743512892951237, 9.457993211900742, -11.39197420841938, -2.016733508856433, -24.14683441815132, -27.12341149893063, -21.413710955844525, -8.323248061080845, 11.409099143971918, 0.7308862912922542, -11.618883685995312, -15.489227135516838, -12.813571362501472, 13.043434124556509, -6.489616471261341, -12.663135362946681, -3.1740645055569523, 23.756689567099826, 32.897193237538644, 8.005796557325976, -9.969934450940356, 9.585739321067253, 35.736442541617755, -12.015090889592258, -0.9421397241807519, -10.63505627562495, -27.26603872512626, 28.438904253123642, 13.057951802352122, 0.2306769108154345, -15.960479507766394, -19.93743922245473, 0.9407419272735673, 12.612384714594151, -11.738402466271776, -14.284639673869268, -4.8355326083514445, -14.4450639139821, -4.517315790773864, -24.057073785838515, -14.630528762117306, -5.41028158742418, -13.306454335603789, -1.7811316048743482, -3.5702472473444455, -4.527535170500631, -15.310587187590158, 8.67591870538351, -4.668237492979593, -17.784504163501392, 1.4489162326490739, 5.700077642431621, -18.02578861151422, 12.134178017754842, 2.1262552660934197, -17.30536199556777, -9.566941781077123, -17.30214301650846, -7.822698010896049, -14.010191691444806, -19.849731277878398, -4.4496327193902925, -21.399022643406276, -16.698132019649886], "episode_lengths": [400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 26, 114, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 400, 400, 400, 400, 20, 400, 400, 400, 36, 93, 400, 400, 400, 88, 400, 400, 400, 400, 45, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [8.397964595148862, -3.46871304402233, 19.207784683186844, 10.174726678179281, -13.6019266780734, 0.97372944613128, -13.067637807350089, 1.968797867604831, 5.52992713254894, -6.454477578790505, 19.001446900375957, -7.5218672081383104, -14.399523527636958, 44.619028687287226, 19.833388624463993, 14.7754560687705, -0.014366928534431889, -33.42023751562141, -0.6399662069792025, -1.8760435926376395, 31.380950870501636, 17.212534300779947, 37.18984139390709, 25.145096223391633, 19.922257808446115, 17.545418303177467, 10.208997887428321, -15.282834152313617, 7.825488900470916, 33.388628589242444, 8.866779984197045, 33.67738245133265, -41.99356752185652, -6.76277798300514, 12.671529275319593, 5.023189103953216, 3.8743512892951237, -9.457993211900744, 11.39197420841938, 2.0167335088564418, 24.146834418151325, 27.123411498930626, 21.41371095584453, 8.323248061080845, -11.409099143971922, -0.7308862912922542, 11.618883685995312, 15.489227135516835, 12.813571362501472, -13.043434124556507, 6.489616471261341, 12.663135362946681, 3.1740645055569523, -23.756689567099826, -32.897193237538666, -8.005796557325958, 9.969934450940356, -9.585739321067253, -35.73644254161771, 12.015090889592258, 0.9421397241807519, 10.63505627562495, 27.266038725126272, -28.43890425312365, -13.057951802352122, -0.23067691081541852, 15.960479507766397, 19.937439222454728, -0.9407419272735655, -12.612384714594148, 11.738402466271776, 14.284639673869265, 4.8355326083514445, 14.445063913982098, 4.517315790773864, 24.05707378583851, 14.630528762117306, 5.410281587424169, 13.306454335603785, 1.7811316048743535, 3.5702472473444455, 4.527535170500636, 15.310587187590162, -8.675918705383545, 4.668237492979626, 17.78450416350139, -1.4489162326490739, -5.700077642431639, 18.02578861151423, -12.134178017754842, -2.1262552660934197, 17.30536199556777, 9.566941781077125, 17.30214301650847, 7.8226980108960475, 14.010191691444806, 19.84973127787838, 4.449632719390273, 21.39902264340628, 16.69813201964987], "policy_adversary_policy_reward": [-13.492266397762478, -3.3036627925352313, -2.4887265965457175, 9.426152684590377, -23.522994989735388, -14.8925743766383, -13.88665288522629, -6.4628004711322795, 5.719881207501867, 21.483972148644916, 11.040081664241967, -12.987540556504534, 20.708118241937385, 5.427157372762794, -11.041694952288736, 7.104099217079074, 0.43680979630788386, -11.496664061405763, -4.571821817846388, 17.48077697542739, -11.680551101153014, -26.32234269959888, -10.343903801350145, 25.38763821762677, -2.836775372609196, 31.635822427883106, -38.546123292650094, -50.69193408192433, -24.712712499302814, -14.954064749625143, -13.71306515570867, -15.837846981832335, 3.2242058567772816, -3.1954719997084196, 28.22557833994373, 38.614896691299116, -3.289104560955505, 4.569036974913885, -0.8738296418164779, 4.625916827091757, -17.596449812146, -45.16545192885727, -37.02244877301607, 2.5973801714561624, -31.07951472374205, -43.30016806407217, -18.27250567030159, -32.017686776481696, -19.09047926454072, -20.754036352351545, -20.926496246261316, -14.164340360093597, -12.12759378498042, -8.290401989876223, 18.58372217006197, 11.981946134565254, 0.5408897797356111, -16.191867580677442, -22.048218678500632, -44.72903849998431, 3.6692966663939472, -21.402856634788034, -11.131409484480802, -56.2233554181845, 42.310286717799464, 41.67684832591362, 15.982698106229552, -2.4571421402192613, -10.470108103314718, -14.872950447324481, 13.92945667207551, -23.975834879981942, -7.942413809965132, 0.1937112313748841, 7.535377466295948, 11.38060895750555, -10.123572381080841, -12.66037603575792, -13.782103210185298, 9.748636192472414, -4.639430769060059, -43.654238067242616, -14.874052983708495, -39.37277001415274, -25.03777658431414, -17.78964532737494, -22.181408516442858, 5.534912394281168, 12.12557540880874, 10.692622879135097, 5.734606548308392, -4.272833965723883, -21.454429410071945, -1.7833379619186793, -14.643940148070769, -16.3345141229629, -19.4879316734757, -6.139211051527244, 2.7795469253567493, 23.307321323756266, 3.196866542997256, -16.176099485519938, -12.838382041724977, -12.487888684168386, -11.78003289623408, 5.431903885120175, 23.593416395950413, 23.919962738249232, 18.915511142652534, 46.878875332424776, 8.177403120738028, 7.83418999391391, -2.177097093695785, -17.762771808184926, -5.28011740811284, 24.451596050247346, 28.269355637389904, 43.20352944584555, -8.999127193348137, -15.031054585836376, 9.44311745552028, -11.327396903881784, -21.009978354879923, -0.26013419636997526, -38.40511431615722, -16.126963134095284, 27.431363120716846, 29.446445385530453, 17.22622746846598, 8.889676136238265, -10.120322672451728, 10.581676494082537, -23.503131971434186, -8.417827044098605, -27.116003828602622, -12.758874616306827, 1.0207907369702198, 0.8606931175769184, 29.18908666856573, -3.9643172393774186, -19.04176319008885, -4.4350417424547, -11.944896743137392, -16.62438260460115, 7.063985195516096, -16.735050412218985, -24.323931173002745, -4.566196654961452, -8.227754801481279, -0.8068767800664212, -20.61418434970355, -27.499963221973474, -5.27579550127215, -23.985262022962463, -4.635537040984744, -6.185026133863602, -7.134045622481736, -19.478863048725838, 3.288073496675736, -6.850336706424464, 4.099798559641492, -11.240293054330383, -2.333588541015576, -6.7214817999857, -6.11520932521708, -24.50596504996324, 5.3928154274262745, 11.959021983340783, 9.622337152436373, -18.958812138395626, -18.735335252691645, -16.833673074311143, 5.816991699098963, -2.9191592338008157, 0.7448987136393121, 10.655256571223923, -13.381999471896794, -22.669577751131655, 11.001126666228128, 13.267229369281551, 7.24709034246694, -2.9945798102801007, -16.080954131084304, -18.529769860051243, -5.795776628532181, -13.338106933622065, -11.92476586772879, -22.67952016528814, -5.710202487611035, -9.93519353418106, -18.915940869385775, -9.104442513503837, -23.536345844074958, -16.163116711681806, -7.8013180874852335, -1.0979473512953177, -27.855767304861306, -14.942277981951246, -3.4521539469392053, -29.944110092360553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4255013413753765, "mean_inference_ms": 1.1208109274324862, "mean_action_processing_ms": 0.1826723653974657, "mean_env_wait_ms": 0.0745027466444146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034873485565185547, "StateBufferConnector_ms": 0.002875089645385742, "ViewRequirementAgentConnector_ms": 0.06483113765716553}, "num_episodes": 9, "episode_return_max": 41.99356752185655, "episode_return_min": -44.61902868728722, "episode_return_mean": -5.746092473804425}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.2290134994708, "num_env_steps_trained_throughput_per_sec": 504.2290134994708, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 8233.774, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8233.741, "sample_time_ms": 785.1, "learn_time_ms": 7435.366, "learn_throughput": 537.969, "synch_weights_time_ms": 12.641}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 140, "trial_id": "83a5c_00000", "date": "2024-08-10_12-33-50", "timestamp": 1723307630, "time_this_iter_s": 7.937251806259155, "time_total_s": 1191.812817811966, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc4e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1191.812817811966, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 24.983333333333334, "ram_util_percent": 83.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9863436039793427, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8438782069733535, "policy_loss": -0.011485008584463564, "vf_loss": 1.8547526673034385, "vf_explained_var": 0.027803214170314648, "kl": 0.012046650856930706, "entropy": 1.311671924275696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.711517333611846, "cur_kl_coeff": 6.960135942790659e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8659998164822658, "policy_loss": -0.001487849604745861, "vf_loss": 1.8674876597399512, "vf_explained_var": 0.667655062302947, "kl": 0.0011703882127546805, "entropy": 0.19862800878472625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "env_runners": {"episode_reward_max": 41.99356752185655, "episode_reward_min": -44.61902868728722, "episode_reward_mean": -6.496071086576041, "episode_len_mean": 356.32, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 35632, "policy_reward_min": {"agent_policy": -41.99356752185652, "adversary_policy": -56.2233554181845}, "policy_reward_max": {"agent_policy": 44.619028687287226, "adversary_policy": 46.878875332424776}, "policy_reward_mean": {"agent_policy": 6.496071086576041, "adversary_policy": -6.496071086576041}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.454477578790509, -19.001446900375953, 7.521867208138313, 14.399523527636953, -44.61902868728722, -19.833388624463996, -14.775456068770525, 0.014366928534430112, 33.42023751562142, 0.6399662069791994, 1.8760435926376395, -31.380950870501646, -17.21253430077997, -37.18984139390708, -25.145096223391636, -19.92225780844612, -17.545418303177456, -10.208997887428321, 15.282834152313612, -7.825488900470914, -33.38862858924244, -8.866779984197045, -33.677382451332655, 41.99356752185655, 6.762777983005135, -12.671529275319603, -5.023189103953216, -3.8743512892951237, 9.457993211900742, -11.39197420841938, -2.016733508856433, -24.14683441815132, -27.12341149893063, -21.413710955844525, -8.323248061080845, 11.409099143971918, 0.7308862912922542, -11.618883685995312, -15.489227135516838, -12.813571362501472, 13.043434124556509, -6.489616471261341, -12.663135362946681, -3.1740645055569523, 23.756689567099826, 32.897193237538644, 8.005796557325976, -9.969934450940356, 9.585739321067253, 35.736442541617755, -12.015090889592258, -0.9421397241807519, -10.63505627562495, -27.26603872512626, 28.438904253123642, 13.057951802352122, 0.2306769108154345, -15.960479507766394, -19.93743922245473, 0.9407419272735673, 12.612384714594151, -11.738402466271776, -14.284639673869268, -4.8355326083514445, -14.4450639139821, -4.517315790773864, -24.057073785838515, -14.630528762117306, -5.41028158742418, -13.306454335603789, -1.7811316048743482, -3.5702472473444455, -4.527535170500631, -15.310587187590158, 8.67591870538351, -4.668237492979593, -17.784504163501392, 1.4489162326490739, 5.700077642431621, -18.02578861151422, 12.134178017754842, 2.1262552660934197, -17.30536199556777, -9.566941781077123, -17.30214301650846, -7.822698010896049, -14.010191691444806, -19.849731277878398, -4.4496327193902925, -21.399022643406276, -16.698132019649886, 0.8550450134936209, -14.481220012192718, 12.19864399890422, -21.775799546582686, -16.25404523179016, -20.049787012541234, -16.77603520462583, -13.522552887970075, -1.306763267210803], "episode_lengths": [400, 400, 26, 114, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 400, 400, 400, 400, 20, 400, 400, 400, 36, 93, 400, 400, 400, 88, 400, 400, 400, 400, 45, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-6.454477578790505, 19.001446900375957, -7.5218672081383104, -14.399523527636958, 44.619028687287226, 19.833388624463993, 14.7754560687705, -0.014366928534431889, -33.42023751562141, -0.6399662069792025, -1.8760435926376395, 31.380950870501636, 17.212534300779947, 37.18984139390709, 25.145096223391633, 19.922257808446115, 17.545418303177467, 10.208997887428321, -15.282834152313617, 7.825488900470916, 33.388628589242444, 8.866779984197045, 33.67738245133265, -41.99356752185652, -6.76277798300514, 12.671529275319593, 5.023189103953216, 3.8743512892951237, -9.457993211900744, 11.39197420841938, 2.0167335088564418, 24.146834418151325, 27.123411498930626, 21.41371095584453, 8.323248061080845, -11.409099143971922, -0.7308862912922542, 11.618883685995312, 15.489227135516835, 12.813571362501472, -13.043434124556507, 6.489616471261341, 12.663135362946681, 3.1740645055569523, -23.756689567099826, -32.897193237538666, -8.005796557325958, 9.969934450940356, -9.585739321067253, -35.73644254161771, 12.015090889592258, 0.9421397241807519, 10.63505627562495, 27.266038725126272, -28.43890425312365, -13.057951802352122, -0.23067691081541852, 15.960479507766397, 19.937439222454728, -0.9407419272735655, -12.612384714594148, 11.738402466271776, 14.284639673869265, 4.8355326083514445, 14.445063913982098, 4.517315790773864, 24.05707378583851, 14.630528762117306, 5.410281587424169, 13.306454335603785, 1.7811316048743535, 3.5702472473444455, 4.527535170500636, 15.310587187590162, -8.675918705383545, 4.668237492979626, 17.78450416350139, -1.4489162326490739, -5.700077642431639, 18.02578861151423, -12.134178017754842, -2.1262552660934197, 17.30536199556777, 9.566941781077125, 17.30214301650847, 7.8226980108960475, 14.010191691444806, 19.84973127787838, 4.449632719390273, 21.39902264340628, 16.69813201964987, -0.8550450134936209, 14.481220012192718, -12.198643998904227, 21.775799546582682, 16.254045231790155, 20.049787012541238, 16.77603520462583, 13.522552887970075, 1.306763267210803], "policy_adversary_policy_reward": [-4.571821817846388, 17.48077697542739, -11.680551101153014, -26.32234269959888, -10.343903801350145, 25.38763821762677, -2.836775372609196, 31.635822427883106, -38.546123292650094, -50.69193408192433, -24.712712499302814, -14.954064749625143, -13.71306515570867, -15.837846981832335, 3.2242058567772816, -3.1954719997084196, 28.22557833994373, 38.614896691299116, -3.289104560955505, 4.569036974913885, -0.8738296418164779, 4.625916827091757, -17.596449812146, -45.16545192885727, -37.02244877301607, 2.5973801714561624, -31.07951472374205, -43.30016806407217, -18.27250567030159, -32.017686776481696, -19.09047926454072, -20.754036352351545, -20.926496246261316, -14.164340360093597, -12.12759378498042, -8.290401989876223, 18.58372217006197, 11.981946134565254, 0.5408897797356111, -16.191867580677442, -22.048218678500632, -44.72903849998431, 3.6692966663939472, -21.402856634788034, -11.131409484480802, -56.2233554181845, 42.310286717799464, 41.67684832591362, 15.982698106229552, -2.4571421402192613, -10.470108103314718, -14.872950447324481, 13.92945667207551, -23.975834879981942, -7.942413809965132, 0.1937112313748841, 7.535377466295948, 11.38060895750555, -10.123572381080841, -12.66037603575792, -13.782103210185298, 9.748636192472414, -4.639430769060059, -43.654238067242616, -14.874052983708495, -39.37277001415274, -25.03777658431414, -17.78964532737494, -22.181408516442858, 5.534912394281168, 12.12557540880874, 10.692622879135097, 5.734606548308392, -4.272833965723883, -21.454429410071945, -1.7833379619186793, -14.643940148070769, -16.3345141229629, -19.4879316734757, -6.139211051527244, 2.7795469253567493, 23.307321323756266, 3.196866542997256, -16.176099485519938, -12.838382041724977, -12.487888684168386, -11.78003289623408, 5.431903885120175, 23.593416395950413, 23.919962738249232, 18.915511142652534, 46.878875332424776, 8.177403120738028, 7.83418999391391, -2.177097093695785, -17.762771808184926, -5.28011740811284, 24.451596050247346, 28.269355637389904, 43.20352944584555, -8.999127193348137, -15.031054585836376, 9.44311745552028, -11.327396903881784, -21.009978354879923, -0.26013419636997526, -38.40511431615722, -16.126963134095284, 27.431363120716846, 29.446445385530453, 17.22622746846598, 8.889676136238265, -10.120322672451728, 10.581676494082537, -23.503131971434186, -8.417827044098605, -27.116003828602622, -12.758874616306827, 1.0207907369702198, 0.8606931175769184, 29.18908666856573, -3.9643172393774186, -19.04176319008885, -4.4350417424547, -11.944896743137392, -16.62438260460115, 7.063985195516096, -16.735050412218985, -24.323931173002745, -4.566196654961452, -8.227754801481279, -0.8068767800664212, -20.61418434970355, -27.499963221973474, -5.27579550127215, -23.985262022962463, -4.635537040984744, -6.185026133863602, -7.134045622481736, -19.478863048725838, 3.288073496675736, -6.850336706424464, 4.099798559641492, -11.240293054330383, -2.333588541015576, -6.7214817999857, -6.11520932521708, -24.50596504996324, 5.3928154274262745, 11.959021983340783, 9.622337152436373, -18.958812138395626, -18.735335252691645, -16.833673074311143, 5.816991699098963, -2.9191592338008157, 0.7448987136393121, 10.655256571223923, -13.381999471896794, -22.669577751131655, 11.001126666228128, 13.267229369281551, 7.24709034246694, -2.9945798102801007, -16.080954131084304, -18.529769860051243, -5.795776628532181, -13.338106933622065, -11.92476586772879, -22.67952016528814, -5.710202487611035, -9.93519353418106, -18.915940869385775, -9.104442513503837, -23.536345844074958, -16.163116711681806, -7.8013180874852335, -1.0979473512953177, -27.855767304861306, -14.942277981951246, -3.4521539469392053, -29.944110092360553, 7.708903223793115, -5.998813196805873, -22.167920839682804, -6.794519184702633, 8.744285586594017, 15.653002411214416, -19.131459461551053, -24.4201396316143, -19.426643649166078, -13.081446814414232, -28.155255756144893, -11.944318268937607, -17.1930507599631, -16.359019649288562, -3.603109836939545, -23.441995939000606, -5.970501531619679, 3.3569749971980727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.425306230507593, "mean_inference_ms": 1.120205140748781, "mean_action_processing_ms": 0.1825478557809044, "mean_env_wait_ms": 0.07445496451574363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003558039665222168, "StateBufferConnector_ms": 0.002910137176513672, "ViewRequirementAgentConnector_ms": 0.06556618213653564}, "num_episodes": 9, "episode_return_max": 41.99356752185655, "episode_return_min": -44.61902868728722, "episode_return_mean": -6.496071086576041}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.7028178882883, "num_env_steps_trained_throughput_per_sec": 504.7028178882883, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 1692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1692000, "timers": {"training_iteration_time_ms": 8215.213, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8215.181, "sample_time_ms": 787.501, "learn_time_ms": 7414.36, "learn_throughput": 539.494, "synch_weights_time_ms": 12.745}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 1692000, "num_agent_steps_trained": 1692000}, "done": false, "training_iteration": 141, "trial_id": "83a5c_00000", "date": "2024-08-10_12-33-58", "timestamp": 1723307638, "time_this_iter_s": 7.930815935134888, "time_total_s": 1199.7436337471008, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc74af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1199.7436337471008, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 26.74545454545455, "ram_util_percent": 83.10909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.008485117665044, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.743868348680476, "policy_loss": -0.004988528705551905, "vf_loss": 1.7482154673054104, "vf_explained_var": 0.24519309489815325, "kl": 0.012655520298536796, "entropy": 1.3678603564620648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.224188759674629, "cur_kl_coeff": 3.4800679713953297e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0021446524808804, "policy_loss": -0.006548051817905313, "vf_loss": 2.0086927027752, "vf_explained_var": 0.1927945862834652, "kl": 0.0042959110204378115, "entropy": 0.17455000961199402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "env_runners": {"episode_reward_max": 41.99356752185655, "episode_reward_min": -37.18984139390708, "episode_reward_mean": -7.051437374140963, "episode_len_mean": 365.93, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36593, "policy_reward_min": {"agent_policy": -41.99356752185652, "adversary_policy": -56.2233554181845}, "policy_reward_max": {"agent_policy": 37.18984139390709, "adversary_policy": 46.878875332424776}, "policy_reward_mean": {"agent_policy": 7.051437374140963, "adversary_policy": -7.051437374140963}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6399662069791994, 1.8760435926376395, -31.380950870501646, -17.21253430077997, -37.18984139390708, -25.145096223391636, -19.92225780844612, -17.545418303177456, -10.208997887428321, 15.282834152313612, -7.825488900470914, -33.38862858924244, -8.866779984197045, -33.677382451332655, 41.99356752185655, 6.762777983005135, -12.671529275319603, -5.023189103953216, -3.8743512892951237, 9.457993211900742, -11.39197420841938, -2.016733508856433, -24.14683441815132, -27.12341149893063, -21.413710955844525, -8.323248061080845, 11.409099143971918, 0.7308862912922542, -11.618883685995312, -15.489227135516838, -12.813571362501472, 13.043434124556509, -6.489616471261341, -12.663135362946681, -3.1740645055569523, 23.756689567099826, 32.897193237538644, 8.005796557325976, -9.969934450940356, 9.585739321067253, 35.736442541617755, -12.015090889592258, -0.9421397241807519, -10.63505627562495, -27.26603872512626, 28.438904253123642, 13.057951802352122, 0.2306769108154345, -15.960479507766394, -19.93743922245473, 0.9407419272735673, 12.612384714594151, -11.738402466271776, -14.284639673869268, -4.8355326083514445, -14.4450639139821, -4.517315790773864, -24.057073785838515, -14.630528762117306, -5.41028158742418, -13.306454335603789, -1.7811316048743482, -3.5702472473444455, -4.527535170500631, -15.310587187590158, 8.67591870538351, -4.668237492979593, -17.784504163501392, 1.4489162326490739, 5.700077642431621, -18.02578861151422, 12.134178017754842, 2.1262552660934197, -17.30536199556777, -9.566941781077123, -17.30214301650846, -7.822698010896049, -14.010191691444806, -19.849731277878398, -4.4496327193902925, -21.399022643406276, -16.698132019649886, 0.8550450134936209, -14.481220012192718, 12.19864399890422, -21.775799546582686, -16.25404523179016, -20.049787012541234, -16.77603520462583, -13.522552887970075, -1.306763267210803, -4.889470159436273, -18.140057360703377, -15.3436295321055, -19.36718384765179, -11.37106710540545, -5.741588049018585, -5.392075625557743, 1.9992313938072872, -13.709635992596706], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 62, 400, 400, 400, 400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 400, 400, 400, 400, 20, 400, 400, 400, 36, 93, 400, 400, 400, 88, 400, 400, 400, 400, 45, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-0.6399662069792025, -1.8760435926376395, 31.380950870501636, 17.212534300779947, 37.18984139390709, 25.145096223391633, 19.922257808446115, 17.545418303177467, 10.208997887428321, -15.282834152313617, 7.825488900470916, 33.388628589242444, 8.866779984197045, 33.67738245133265, -41.99356752185652, -6.76277798300514, 12.671529275319593, 5.023189103953216, 3.8743512892951237, -9.457993211900744, 11.39197420841938, 2.0167335088564418, 24.146834418151325, 27.123411498930626, 21.41371095584453, 8.323248061080845, -11.409099143971922, -0.7308862912922542, 11.618883685995312, 15.489227135516835, 12.813571362501472, -13.043434124556507, 6.489616471261341, 12.663135362946681, 3.1740645055569523, -23.756689567099826, -32.897193237538666, -8.005796557325958, 9.969934450940356, -9.585739321067253, -35.73644254161771, 12.015090889592258, 0.9421397241807519, 10.63505627562495, 27.266038725126272, -28.43890425312365, -13.057951802352122, -0.23067691081541852, 15.960479507766397, 19.937439222454728, -0.9407419272735655, -12.612384714594148, 11.738402466271776, 14.284639673869265, 4.8355326083514445, 14.445063913982098, 4.517315790773864, 24.05707378583851, 14.630528762117306, 5.410281587424169, 13.306454335603785, 1.7811316048743535, 3.5702472473444455, 4.527535170500636, 15.310587187590162, -8.675918705383545, 4.668237492979626, 17.78450416350139, -1.4489162326490739, -5.700077642431639, 18.02578861151423, -12.134178017754842, -2.1262552660934197, 17.30536199556777, 9.566941781077125, 17.30214301650847, 7.8226980108960475, 14.010191691444806, 19.84973127787838, 4.449632719390273, 21.39902264340628, 16.69813201964987, -0.8550450134936209, 14.481220012192718, -12.198643998904227, 21.775799546582682, 16.254045231790155, 20.049787012541238, 16.77603520462583, 13.522552887970075, 1.306763267210803, 4.889470159436275, 18.140057360703377, 15.343629532105497, 19.367183847651795, 11.37106710540545, 5.741588049018585, 5.392075625557743, -1.9992313938072908, 13.709635992596708], "policy_adversary_policy_reward": [-3.289104560955505, 4.569036974913885, -0.8738296418164779, 4.625916827091757, -17.596449812146, -45.16545192885727, -37.02244877301607, 2.5973801714561624, -31.07951472374205, -43.30016806407217, -18.27250567030159, -32.017686776481696, -19.09047926454072, -20.754036352351545, -20.926496246261316, -14.164340360093597, -12.12759378498042, -8.290401989876223, 18.58372217006197, 11.981946134565254, 0.5408897797356111, -16.191867580677442, -22.048218678500632, -44.72903849998431, 3.6692966663939472, -21.402856634788034, -11.131409484480802, -56.2233554181845, 42.310286717799464, 41.67684832591362, 15.982698106229552, -2.4571421402192613, -10.470108103314718, -14.872950447324481, 13.92945667207551, -23.975834879981942, -7.942413809965132, 0.1937112313748841, 7.535377466295948, 11.38060895750555, -10.123572381080841, -12.66037603575792, -13.782103210185298, 9.748636192472414, -4.639430769060059, -43.654238067242616, -14.874052983708495, -39.37277001415274, -25.03777658431414, -17.78964532737494, -22.181408516442858, 5.534912394281168, 12.12557540880874, 10.692622879135097, 5.734606548308392, -4.272833965723883, -21.454429410071945, -1.7833379619186793, -14.643940148070769, -16.3345141229629, -19.4879316734757, -6.139211051527244, 2.7795469253567493, 23.307321323756266, 3.196866542997256, -16.176099485519938, -12.838382041724977, -12.487888684168386, -11.78003289623408, 5.431903885120175, 23.593416395950413, 23.919962738249232, 18.915511142652534, 46.878875332424776, 8.177403120738028, 7.83418999391391, -2.177097093695785, -17.762771808184926, -5.28011740811284, 24.451596050247346, 28.269355637389904, 43.20352944584555, -8.999127193348137, -15.031054585836376, 9.44311745552028, -11.327396903881784, -21.009978354879923, -0.26013419636997526, -38.40511431615722, -16.126963134095284, 27.431363120716846, 29.446445385530453, 17.22622746846598, 8.889676136238265, -10.120322672451728, 10.581676494082537, -23.503131971434186, -8.417827044098605, -27.116003828602622, -12.758874616306827, 1.0207907369702198, 0.8606931175769184, 29.18908666856573, -3.9643172393774186, -19.04176319008885, -4.4350417424547, -11.944896743137392, -16.62438260460115, 7.063985195516096, -16.735050412218985, -24.323931173002745, -4.566196654961452, -8.227754801481279, -0.8068767800664212, -20.61418434970355, -27.499963221973474, -5.27579550127215, -23.985262022962463, -4.635537040984744, -6.185026133863602, -7.134045622481736, -19.478863048725838, 3.288073496675736, -6.850336706424464, 4.099798559641492, -11.240293054330383, -2.333588541015576, -6.7214817999857, -6.11520932521708, -24.50596504996324, 5.3928154274262745, 11.959021983340783, 9.622337152436373, -18.958812138395626, -18.735335252691645, -16.833673074311143, 5.816991699098963, -2.9191592338008157, 0.7448987136393121, 10.655256571223923, -13.381999471896794, -22.669577751131655, 11.001126666228128, 13.267229369281551, 7.24709034246694, -2.9945798102801007, -16.080954131084304, -18.529769860051243, -5.795776628532181, -13.338106933622065, -11.92476586772879, -22.67952016528814, -5.710202487611035, -9.93519353418106, -18.915940869385775, -9.104442513503837, -23.536345844074958, -16.163116711681806, -7.8013180874852335, -1.0979473512953177, -27.855767304861306, -14.942277981951246, -3.4521539469392053, -29.944110092360553, 7.708903223793115, -5.998813196805873, -22.167920839682804, -6.794519184702633, 8.744285586594017, 15.653002411214416, -19.131459461551053, -24.4201396316143, -19.426643649166078, -13.081446814414232, -28.155255756144893, -11.944318268937607, -17.1930507599631, -16.359019649288562, -3.603109836939545, -23.441995939000606, -5.970501531619679, 3.3569749971980727, -7.402944690463013, -2.375995628409539, -13.84733523945508, -22.432779481951677, -2.088837750933827, -28.598421313277168, -32.749251039173444, -5.985116656130149, -15.790968915814947, -6.951165294995953, -6.68317660242753, -4.79999949560964, -2.6193284731578395, -8.164822777957646, -0.495977955386774, 4.494440743001363, -24.833517845872105, -2.5857541393213097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42509421597224567, "mean_inference_ms": 1.1197267731455134, "mean_action_processing_ms": 0.18250470943791597, "mean_env_wait_ms": 0.0744152724009184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036672353744506836, "StateBufferConnector_ms": 0.002911090850830078, "ViewRequirementAgentConnector_ms": 0.06820535659790039}, "num_episodes": 9, "episode_return_max": 41.99356752185655, "episode_return_min": -37.18984139390708, "episode_return_mean": -7.051437374140963}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.9902525283837, "num_env_steps_trained_throughput_per_sec": 481.9902525283837, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 1704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1704000, "timers": {"training_iteration_time_ms": 8222.338, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8222.301, "sample_time_ms": 802.592, "learn_time_ms": 7406.323, "learn_throughput": 540.079, "synch_weights_time_ms": 12.817}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "done": false, "training_iteration": 142, "trial_id": "83a5c_00000", "date": "2024-08-10_12-34-06", "timestamp": 1723307646, "time_this_iter_s": 8.303423881530762, "time_total_s": 1208.0470576286316, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc74820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1208.0470576286316, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 29.558333333333334, "ram_util_percent": 83.09166666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.80500675275843, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.413315929306878, "policy_loss": -0.006296527450879612, "vf_loss": 2.4190171573527905, "vf_explained_var": -0.15339261533091308, "kl": 0.011745604358586702, "entropy": 1.3949840938603437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.275019669719041, "cur_kl_coeff": 1.7400339856976648e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9935390911996365, "policy_loss": -0.006248414970226198, "vf_loss": 1.999787504846851, "vf_explained_var": -0.019436712873478732, "kl": 0.0024361576577649853, "entropy": 0.24725529972153407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "env_runners": {"episode_reward_max": 50.02287922127907, "episode_reward_min": -33.677382451332655, "episode_reward_mean": -5.091231545201399, "episode_len_mean": 362.3, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 36230, "policy_reward_min": {"agent_policy": -50.022879221279055, "adversary_policy": -56.2233554181845}, "policy_reward_max": {"agent_policy": 33.67738245133265, "adversary_policy": 56.36003256074176}, "policy_reward_mean": {"agent_policy": 5.091231545201401, "adversary_policy": -5.091231545201401}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.677382451332655, 41.99356752185655, 6.762777983005135, -12.671529275319603, -5.023189103953216, -3.8743512892951237, 9.457993211900742, -11.39197420841938, -2.016733508856433, -24.14683441815132, -27.12341149893063, -21.413710955844525, -8.323248061080845, 11.409099143971918, 0.7308862912922542, -11.618883685995312, -15.489227135516838, -12.813571362501472, 13.043434124556509, -6.489616471261341, -12.663135362946681, -3.1740645055569523, 23.756689567099826, 32.897193237538644, 8.005796557325976, -9.969934450940356, 9.585739321067253, 35.736442541617755, -12.015090889592258, -0.9421397241807519, -10.63505627562495, -27.26603872512626, 28.438904253123642, 13.057951802352122, 0.2306769108154345, -15.960479507766394, -19.93743922245473, 0.9407419272735673, 12.612384714594151, -11.738402466271776, -14.284639673869268, -4.8355326083514445, -14.4450639139821, -4.517315790773864, -24.057073785838515, -14.630528762117306, -5.41028158742418, -13.306454335603789, -1.7811316048743482, -3.5702472473444455, -4.527535170500631, -15.310587187590158, 8.67591870538351, -4.668237492979593, -17.784504163501392, 1.4489162326490739, 5.700077642431621, -18.02578861151422, 12.134178017754842, 2.1262552660934197, -17.30536199556777, -9.566941781077123, -17.30214301650846, -7.822698010896049, -14.010191691444806, -19.849731277878398, -4.4496327193902925, -21.399022643406276, -16.698132019649886, 0.8550450134936209, -14.481220012192718, 12.19864399890422, -21.775799546582686, -16.25404523179016, -20.049787012541234, -16.77603520462583, -13.522552887970075, -1.306763267210803, -4.889470159436273, -18.140057360703377, -15.3436295321055, -19.36718384765179, -11.37106710540545, -5.741588049018585, -5.392075625557743, 1.9992313938072872, -13.709635992596706, -3.5703005048449796, 1.3710753912465616, 50.02287922127907, 3.131699711523982, -17.815209150756, -18.878247317150294, -10.157211431611874, -14.229589351476527, 17.234665084660538, -3.017492498896088, -7.544878576212826, -13.976296338705364, 22.56233834528775], "episode_lengths": [400, 112, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 85, 400, 400, 400, 400, 20, 400, 400, 400, 36, 93, 400, 400, 400, 88, 400, 400, 400, 400, 45, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 400, 400, 25], "policy_agent_policy_reward": [33.67738245133265, -41.99356752185652, -6.76277798300514, 12.671529275319593, 5.023189103953216, 3.8743512892951237, -9.457993211900744, 11.39197420841938, 2.0167335088564418, 24.146834418151325, 27.123411498930626, 21.41371095584453, 8.323248061080845, -11.409099143971922, -0.7308862912922542, 11.618883685995312, 15.489227135516835, 12.813571362501472, -13.043434124556507, 6.489616471261341, 12.663135362946681, 3.1740645055569523, -23.756689567099826, -32.897193237538666, -8.005796557325958, 9.969934450940356, -9.585739321067253, -35.73644254161771, 12.015090889592258, 0.9421397241807519, 10.63505627562495, 27.266038725126272, -28.43890425312365, -13.057951802352122, -0.23067691081541852, 15.960479507766397, 19.937439222454728, -0.9407419272735655, -12.612384714594148, 11.738402466271776, 14.284639673869265, 4.8355326083514445, 14.445063913982098, 4.517315790773864, 24.05707378583851, 14.630528762117306, 5.410281587424169, 13.306454335603785, 1.7811316048743535, 3.5702472473444455, 4.527535170500636, 15.310587187590162, -8.675918705383545, 4.668237492979626, 17.78450416350139, -1.4489162326490739, -5.700077642431639, 18.02578861151423, -12.134178017754842, -2.1262552660934197, 17.30536199556777, 9.566941781077125, 17.30214301650847, 7.8226980108960475, 14.010191691444806, 19.84973127787838, 4.449632719390273, 21.39902264340628, 16.69813201964987, -0.8550450134936209, 14.481220012192718, -12.198643998904227, 21.775799546582682, 16.254045231790155, 20.049787012541238, 16.77603520462583, 13.522552887970075, 1.306763267210803, 4.889470159436275, 18.140057360703377, 15.343629532105497, 19.367183847651795, 11.37106710540545, 5.741588049018585, 5.392075625557743, -1.9992313938072908, 13.709635992596708, 3.5703005048449796, -1.3710753912465616, -50.022879221279055, -3.131699711523982, 17.81520915075599, 18.878247317150283, 10.157211431611874, 14.22958935147653, -17.23466508466054, 3.017492498896088, 7.544878576212826, 13.976296338705364, -22.562338345287742], "policy_adversary_policy_reward": [-11.131409484480802, -56.2233554181845, 42.310286717799464, 41.67684832591362, 15.982698106229552, -2.4571421402192613, -10.470108103314718, -14.872950447324481, 13.92945667207551, -23.975834879981942, -7.942413809965132, 0.1937112313748841, 7.535377466295948, 11.38060895750555, -10.123572381080841, -12.66037603575792, -13.782103210185298, 9.748636192472414, -4.639430769060059, -43.654238067242616, -14.874052983708495, -39.37277001415274, -25.03777658431414, -17.78964532737494, -22.181408516442858, 5.534912394281168, 12.12557540880874, 10.692622879135097, 5.734606548308392, -4.272833965723883, -21.454429410071945, -1.7833379619186793, -14.643940148070769, -16.3345141229629, -19.4879316734757, -6.139211051527244, 2.7795469253567493, 23.307321323756266, 3.196866542997256, -16.176099485519938, -12.838382041724977, -12.487888684168386, -11.78003289623408, 5.431903885120175, 23.593416395950413, 23.919962738249232, 18.915511142652534, 46.878875332424776, 8.177403120738028, 7.83418999391391, -2.177097093695785, -17.762771808184926, -5.28011740811284, 24.451596050247346, 28.269355637389904, 43.20352944584555, -8.999127193348137, -15.031054585836376, 9.44311745552028, -11.327396903881784, -21.009978354879923, -0.26013419636997526, -38.40511431615722, -16.126963134095284, 27.431363120716846, 29.446445385530453, 17.22622746846598, 8.889676136238265, -10.120322672451728, 10.581676494082537, -23.503131971434186, -8.417827044098605, -27.116003828602622, -12.758874616306827, 1.0207907369702198, 0.8606931175769184, 29.18908666856573, -3.9643172393774186, -19.04176319008885, -4.4350417424547, -11.944896743137392, -16.62438260460115, 7.063985195516096, -16.735050412218985, -24.323931173002745, -4.566196654961452, -8.227754801481279, -0.8068767800664212, -20.61418434970355, -27.499963221973474, -5.27579550127215, -23.985262022962463, -4.635537040984744, -6.185026133863602, -7.134045622481736, -19.478863048725838, 3.288073496675736, -6.850336706424464, 4.099798559641492, -11.240293054330383, -2.333588541015576, -6.7214817999857, -6.11520932521708, -24.50596504996324, 5.3928154274262745, 11.959021983340783, 9.622337152436373, -18.958812138395626, -18.735335252691645, -16.833673074311143, 5.816991699098963, -2.9191592338008157, 0.7448987136393121, 10.655256571223923, -13.381999471896794, -22.669577751131655, 11.001126666228128, 13.267229369281551, 7.24709034246694, -2.9945798102801007, -16.080954131084304, -18.529769860051243, -5.795776628532181, -13.338106933622065, -11.92476586772879, -22.67952016528814, -5.710202487611035, -9.93519353418106, -18.915940869385775, -9.104442513503837, -23.536345844074958, -16.163116711681806, -7.8013180874852335, -1.0979473512953177, -27.855767304861306, -14.942277981951246, -3.4521539469392053, -29.944110092360553, 7.708903223793115, -5.998813196805873, -22.167920839682804, -6.794519184702633, 8.744285586594017, 15.653002411214416, -19.131459461551053, -24.4201396316143, -19.426643649166078, -13.081446814414232, -28.155255756144893, -11.944318268937607, -17.1930507599631, -16.359019649288562, -3.603109836939545, -23.441995939000606, -5.970501531619679, 3.3569749971980727, -7.402944690463013, -2.375995628409539, -13.84733523945508, -22.432779481951677, -2.088837750933827, -28.598421313277168, -32.749251039173444, -5.985116656130149, -15.790968915814947, -6.951165294995953, -6.68317660242753, -4.79999949560964, -2.6193284731578395, -8.164822777957646, -0.495977955386774, 4.494440743001363, -24.833517845872105, -2.5857541393213097, 4.739572061915936, -11.880173071605896, -12.845727799581699, 15.587878582074822, 43.68572588181636, 56.36003256074176, 10.718077225676534, -4.45467780262857, -7.580775148023232, -28.049643153488756, -13.565821510173315, -24.190673124127265, -8.187148277415101, -12.127274585808646, -9.03036425991938, -19.42881444303368, 15.628061537354263, 18.841268631966813, -12.568854945610358, 6.533869947818182, -24.26683142179697, 9.177074269371317, -16.095301888399597, -11.857290789011135, 22.653977216364012, 22.47069947421148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42486549475668034, "mean_inference_ms": 1.1187694513745798, "mean_action_processing_ms": 0.1822898114544826, "mean_env_wait_ms": 0.07435183087367682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003598332405090332, "StateBufferConnector_ms": 0.0028690099716186523, "ViewRequirementAgentConnector_ms": 0.06862342357635498}, "num_episodes": 13, "episode_return_max": 50.02287922127907, "episode_return_min": -33.677382451332655, "episode_return_mean": -5.091231545201399}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 495.1732226566414, "num_env_steps_trained_throughput_per_sec": 495.1732226566414, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 1716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1716000, "timers": {"training_iteration_time_ms": 8197.509, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8197.47, "sample_time_ms": 802.971, "learn_time_ms": 7380.113, "learn_throughput": 541.997, "synch_weights_time_ms": 13.797}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 1716000, "num_agent_steps_trained": 1716000}, "done": false, "training_iteration": 143, "trial_id": "83a5c_00000", "date": "2024-08-10_12-34-14", "timestamp": 1723307654, "time_this_iter_s": 8.083653211593628, "time_total_s": 1216.1307108402252, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1216.1307108402252, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 26.79090909090909, "ram_util_percent": 83.08181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7368388128343715, "cur_kl_coeff": 0.050682163238525375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.484529723061456, "policy_loss": -0.013524639281375265, "vf_loss": 3.496916421254476, "vf_explained_var": -0.2517193058180431, "kl": 0.022452508825072243, "entropy": 1.3964814300890322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.836841740521292, "cur_kl_coeff": 8.700169928488324e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9139312128225963, "policy_loss": -0.008279899474776661, "vf_loss": 2.9222110986709593, "vf_explained_var": 0.4452803314353029, "kl": 0.005612972181786535, "entropy": 0.2633963705350955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 50.02287922127907, "episode_reward_min": -27.26603872512626, "episode_reward_mean": -5.105008091039812, "episode_len_mean": 365.18, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36518, "policy_reward_min": {"agent_policy": -50.022879221279055, "adversary_policy": -38.40511431615722}, "policy_reward_max": {"agent_policy": 27.266038725126272, "adversary_policy": 56.36003256074176}, "policy_reward_mean": {"agent_policy": 5.105008091039812, "adversary_policy": -5.105008091039813}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.413710955844525, -8.323248061080845, 11.409099143971918, 0.7308862912922542, -11.618883685995312, -15.489227135516838, -12.813571362501472, 13.043434124556509, -6.489616471261341, -12.663135362946681, -3.1740645055569523, 23.756689567099826, 32.897193237538644, 8.005796557325976, -9.969934450940356, 9.585739321067253, 35.736442541617755, -12.015090889592258, -0.9421397241807519, -10.63505627562495, -27.26603872512626, 28.438904253123642, 13.057951802352122, 0.2306769108154345, -15.960479507766394, -19.93743922245473, 0.9407419272735673, 12.612384714594151, -11.738402466271776, -14.284639673869268, -4.8355326083514445, -14.4450639139821, -4.517315790773864, -24.057073785838515, -14.630528762117306, -5.41028158742418, -13.306454335603789, -1.7811316048743482, -3.5702472473444455, -4.527535170500631, -15.310587187590158, 8.67591870538351, -4.668237492979593, -17.784504163501392, 1.4489162326490739, 5.700077642431621, -18.02578861151422, 12.134178017754842, 2.1262552660934197, -17.30536199556777, -9.566941781077123, -17.30214301650846, -7.822698010896049, -14.010191691444806, -19.849731277878398, -4.4496327193902925, -21.399022643406276, -16.698132019649886, 0.8550450134936209, -14.481220012192718, 12.19864399890422, -21.775799546582686, -16.25404523179016, -20.049787012541234, -16.77603520462583, -13.522552887970075, -1.306763267210803, -4.889470159436273, -18.140057360703377, -15.3436295321055, -19.36718384765179, -11.37106710540545, -5.741588049018585, -5.392075625557743, 1.9992313938072872, -13.709635992596706, -3.5703005048449796, 1.3710753912465616, 50.02287922127907, 3.131699711523982, -17.815209150756, -18.878247317150294, -10.157211431611874, -14.229589351476527, 17.234665084660538, -3.017492498896088, -7.544878576212826, -13.976296338705364, 22.56233834528775, -8.649908522545026, -5.036880706745578, -25.030806327436064, 12.390373490602208, 8.901246921611387, -6.596286420089616, -4.307262357949, -16.5642939732713, -0.9048505436614782, -3.055279539865479, -14.234773641987196], "episode_lengths": [400, 400, 85, 400, 400, 400, 400, 20, 400, 400, 400, 36, 93, 400, 400, 400, 88, 400, 400, 400, 400, 45, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [21.41371095584453, 8.323248061080845, -11.409099143971922, -0.7308862912922542, 11.618883685995312, 15.489227135516835, 12.813571362501472, -13.043434124556507, 6.489616471261341, 12.663135362946681, 3.1740645055569523, -23.756689567099826, -32.897193237538666, -8.005796557325958, 9.969934450940356, -9.585739321067253, -35.73644254161771, 12.015090889592258, 0.9421397241807519, 10.63505627562495, 27.266038725126272, -28.43890425312365, -13.057951802352122, -0.23067691081541852, 15.960479507766397, 19.937439222454728, -0.9407419272735655, -12.612384714594148, 11.738402466271776, 14.284639673869265, 4.8355326083514445, 14.445063913982098, 4.517315790773864, 24.05707378583851, 14.630528762117306, 5.410281587424169, 13.306454335603785, 1.7811316048743535, 3.5702472473444455, 4.527535170500636, 15.310587187590162, -8.675918705383545, 4.668237492979626, 17.78450416350139, -1.4489162326490739, -5.700077642431639, 18.02578861151423, -12.134178017754842, -2.1262552660934197, 17.30536199556777, 9.566941781077125, 17.30214301650847, 7.8226980108960475, 14.010191691444806, 19.84973127787838, 4.449632719390273, 21.39902264340628, 16.69813201964987, -0.8550450134936209, 14.481220012192718, -12.198643998904227, 21.775799546582682, 16.254045231790155, 20.049787012541238, 16.77603520462583, 13.522552887970075, 1.306763267210803, 4.889470159436275, 18.140057360703377, 15.343629532105497, 19.367183847651795, 11.37106710540545, 5.741588049018585, 5.392075625557743, -1.9992313938072908, 13.709635992596708, 3.5703005048449796, -1.3710753912465616, -50.022879221279055, -3.131699711523982, 17.81520915075599, 18.878247317150283, 10.157211431611874, 14.22958935147653, -17.23466508466054, 3.017492498896088, 7.544878576212826, 13.976296338705364, -22.562338345287742, 8.649908522545026, 5.036880706745578, 25.030806327436068, -12.390373490602208, -8.901246921611387, 6.596286420089616, 4.307262357949, 16.564293973271297, 0.9048505436614693, 3.055279539865463, 14.234773641987196], "policy_adversary_policy_reward": [-25.03777658431414, -17.78964532737494, -22.181408516442858, 5.534912394281168, 12.12557540880874, 10.692622879135097, 5.734606548308392, -4.272833965723883, -21.454429410071945, -1.7833379619186793, -14.643940148070769, -16.3345141229629, -19.4879316734757, -6.139211051527244, 2.7795469253567493, 23.307321323756266, 3.196866542997256, -16.176099485519938, -12.838382041724977, -12.487888684168386, -11.78003289623408, 5.431903885120175, 23.593416395950413, 23.919962738249232, 18.915511142652534, 46.878875332424776, 8.177403120738028, 7.83418999391391, -2.177097093695785, -17.762771808184926, -5.28011740811284, 24.451596050247346, 28.269355637389904, 43.20352944584555, -8.999127193348137, -15.031054585836376, 9.44311745552028, -11.327396903881784, -21.009978354879923, -0.26013419636997526, -38.40511431615722, -16.126963134095284, 27.431363120716846, 29.446445385530453, 17.22622746846598, 8.889676136238265, -10.120322672451728, 10.581676494082537, -23.503131971434186, -8.417827044098605, -27.116003828602622, -12.758874616306827, 1.0207907369702198, 0.8606931175769184, 29.18908666856573, -3.9643172393774186, -19.04176319008885, -4.4350417424547, -11.944896743137392, -16.62438260460115, 7.063985195516096, -16.735050412218985, -24.323931173002745, -4.566196654961452, -8.227754801481279, -0.8068767800664212, -20.61418434970355, -27.499963221973474, -5.27579550127215, -23.985262022962463, -4.635537040984744, -6.185026133863602, -7.134045622481736, -19.478863048725838, 3.288073496675736, -6.850336706424464, 4.099798559641492, -11.240293054330383, -2.333588541015576, -6.7214817999857, -6.11520932521708, -24.50596504996324, 5.3928154274262745, 11.959021983340783, 9.622337152436373, -18.958812138395626, -18.735335252691645, -16.833673074311143, 5.816991699098963, -2.9191592338008157, 0.7448987136393121, 10.655256571223923, -13.381999471896794, -22.669577751131655, 11.001126666228128, 13.267229369281551, 7.24709034246694, -2.9945798102801007, -16.080954131084304, -18.529769860051243, -5.795776628532181, -13.338106933622065, -11.92476586772879, -22.67952016528814, -5.710202487611035, -9.93519353418106, -18.915940869385775, -9.104442513503837, -23.536345844074958, -16.163116711681806, -7.8013180874852335, -1.0979473512953177, -27.855767304861306, -14.942277981951246, -3.4521539469392053, -29.944110092360553, 7.708903223793115, -5.998813196805873, -22.167920839682804, -6.794519184702633, 8.744285586594017, 15.653002411214416, -19.131459461551053, -24.4201396316143, -19.426643649166078, -13.081446814414232, -28.155255756144893, -11.944318268937607, -17.1930507599631, -16.359019649288562, -3.603109836939545, -23.441995939000606, -5.970501531619679, 3.3569749971980727, -7.402944690463013, -2.375995628409539, -13.84733523945508, -22.432779481951677, -2.088837750933827, -28.598421313277168, -32.749251039173444, -5.985116656130149, -15.790968915814947, -6.951165294995953, -6.68317660242753, -4.79999949560964, -2.6193284731578395, -8.164822777957646, -0.495977955386774, 4.494440743001363, -24.833517845872105, -2.5857541393213097, 4.739572061915936, -11.880173071605896, -12.845727799581699, 15.587878582074822, 43.68572588181636, 56.36003256074176, 10.718077225676534, -4.45467780262857, -7.580775148023232, -28.049643153488756, -13.565821510173315, -24.190673124127265, -8.187148277415101, -12.127274585808646, -9.03036425991938, -19.42881444303368, 15.628061537354263, 18.841268631966813, -12.568854945610358, 6.533869947818182, -24.26683142179697, 9.177074269371317, -16.095301888399597, -11.857290789011135, 22.653977216364012, 22.47069947421148, 8.205169254770254, -25.504986299860306, -5.008809285296685, -5.06495212819447, -30.103307290384038, -19.95830536448812, 13.492711038982712, 11.288035942221704, 26.086119019595557, -8.28362517637278, -14.551435567989039, 1.3588627278098073, -5.677514441217781, -2.937010274680219, -9.887015813830203, -23.241572132712392, -0.656091190920435, -1.1536098964025001, 11.464046200850099, -17.574605280581032, -29.315884654477067, 0.846337370502674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42464714300245165, "mean_inference_ms": 1.1179940530271895, "mean_action_processing_ms": 0.1822430704515021, "mean_env_wait_ms": 0.0742907685669424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003542304039001465, "StateBufferConnector_ms": 0.002427339553833008, "ViewRequirementAgentConnector_ms": 0.0675438642501831}, "num_episodes": 11, "episode_return_max": 50.02287922127907, "episode_return_min": -27.26603872512626, "episode_return_mean": -5.105008091039812}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 457.13461131742497, "num_env_steps_trained_throughput_per_sec": 457.13461131742497, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 8239.131, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8239.09, "sample_time_ms": 796.709, "learn_time_ms": 7427.942, "learn_throughput": 538.507, "synch_weights_time_ms": 13.862}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 144, "trial_id": "83a5c_00000", "date": "2024-08-10_12-34-23", "timestamp": 1723307663, "time_this_iter_s": 8.75568675994873, "time_total_s": 1224.886397600174, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcfd670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1224.886397600174, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 30.407692307692308, "ram_util_percent": 82.56153846153848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9545882728995467, "cur_kl_coeff": 0.07602324485778808, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.779237051363345, "policy_loss": -0.007895263961501538, "vf_loss": 5.785817962979514, "vf_explained_var": -0.047690110925644166, "kl": 0.017288753050136094, "entropy": 1.3873526230690971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.029507944174111, "cur_kl_coeff": 8.700169928488324e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.52101830119888, "policy_loss": -0.003877954141110725, "vf_loss": 4.524896258612474, "vf_explained_var": 0.6449975220486521, "kl": 0.005600542542100821, "entropy": 0.2789542577850322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "env_runners": {"episode_reward_max": 50.02287922127907, "episode_reward_min": -27.26603872512626, "episode_reward_mean": -5.121726780820884, "episode_len_mean": 372.13, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37213, "policy_reward_min": {"agent_policy": -50.022879221279055, "adversary_policy": -44.45798029569407}, "policy_reward_max": {"agent_policy": 27.266038725126272, "adversary_policy": 56.36003256074176}, "policy_reward_mean": {"agent_policy": 5.121726780820882, "adversary_policy": -5.121726780820882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.663135362946681, -3.1740645055569523, 23.756689567099826, 32.897193237538644, 8.005796557325976, -9.969934450940356, 9.585739321067253, 35.736442541617755, -12.015090889592258, -0.9421397241807519, -10.63505627562495, -27.26603872512626, 28.438904253123642, 13.057951802352122, 0.2306769108154345, -15.960479507766394, -19.93743922245473, 0.9407419272735673, 12.612384714594151, -11.738402466271776, -14.284639673869268, -4.8355326083514445, -14.4450639139821, -4.517315790773864, -24.057073785838515, -14.630528762117306, -5.41028158742418, -13.306454335603789, -1.7811316048743482, -3.5702472473444455, -4.527535170500631, -15.310587187590158, 8.67591870538351, -4.668237492979593, -17.784504163501392, 1.4489162326490739, 5.700077642431621, -18.02578861151422, 12.134178017754842, 2.1262552660934197, -17.30536199556777, -9.566941781077123, -17.30214301650846, -7.822698010896049, -14.010191691444806, -19.849731277878398, -4.4496327193902925, -21.399022643406276, -16.698132019649886, 0.8550450134936209, -14.481220012192718, 12.19864399890422, -21.775799546582686, -16.25404523179016, -20.049787012541234, -16.77603520462583, -13.522552887970075, -1.306763267210803, -4.889470159436273, -18.140057360703377, -15.3436295321055, -19.36718384765179, -11.37106710540545, -5.741588049018585, -5.392075625557743, 1.9992313938072872, -13.709635992596706, -3.5703005048449796, 1.3710753912465616, 50.02287922127907, 3.131699711523982, -17.815209150756, -18.878247317150294, -10.157211431611874, -14.229589351476527, 17.234665084660538, -3.017492498896088, -7.544878576212826, -13.976296338705364, 22.56233834528775, -8.649908522545026, -5.036880706745578, -25.030806327436064, 12.390373490602208, 8.901246921611387, -6.596286420089616, -4.307262357949, -16.5642939732713, -0.9048505436614782, -3.055279539865479, -14.234773641987196, 7.978536150576371, -19.401964800814966, 4.095428948880027, -27.20346724734106, -26.14583594377608, 2.2492997605868172, -6.93290833708657, 8.47410103125631, 4.250103347232436], "episode_lengths": [400, 400, 36, 93, 400, 400, 400, 88, 400, 400, 400, 400, 45, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [12.663135362946681, 3.1740645055569523, -23.756689567099826, -32.897193237538666, -8.005796557325958, 9.969934450940356, -9.585739321067253, -35.73644254161771, 12.015090889592258, 0.9421397241807519, 10.63505627562495, 27.266038725126272, -28.43890425312365, -13.057951802352122, -0.23067691081541852, 15.960479507766397, 19.937439222454728, -0.9407419272735655, -12.612384714594148, 11.738402466271776, 14.284639673869265, 4.8355326083514445, 14.445063913982098, 4.517315790773864, 24.05707378583851, 14.630528762117306, 5.410281587424169, 13.306454335603785, 1.7811316048743535, 3.5702472473444455, 4.527535170500636, 15.310587187590162, -8.675918705383545, 4.668237492979626, 17.78450416350139, -1.4489162326490739, -5.700077642431639, 18.02578861151423, -12.134178017754842, -2.1262552660934197, 17.30536199556777, 9.566941781077125, 17.30214301650847, 7.8226980108960475, 14.010191691444806, 19.84973127787838, 4.449632719390273, 21.39902264340628, 16.69813201964987, -0.8550450134936209, 14.481220012192718, -12.198643998904227, 21.775799546582682, 16.254045231790155, 20.049787012541238, 16.77603520462583, 13.522552887970075, 1.306763267210803, 4.889470159436275, 18.140057360703377, 15.343629532105497, 19.367183847651795, 11.37106710540545, 5.741588049018585, 5.392075625557743, -1.9992313938072908, 13.709635992596708, 3.5703005048449796, -1.3710753912465616, -50.022879221279055, -3.131699711523982, 17.81520915075599, 18.878247317150283, 10.157211431611874, 14.22958935147653, -17.23466508466054, 3.017492498896088, 7.544878576212826, 13.976296338705364, -22.562338345287742, 8.649908522545026, 5.036880706745578, 25.030806327436068, -12.390373490602208, -8.901246921611387, 6.596286420089616, 4.307262357949, 16.564293973271297, 0.9048505436614693, 3.055279539865463, 14.234773641987196, -7.978536150576373, 19.401964800814966, -4.095428948880027, 27.203467247341063, 26.145835943776078, -2.2492997605868172, 6.93290833708657, -8.47410103125631, -4.250103347232436], "policy_adversary_policy_reward": [-12.838382041724977, -12.487888684168386, -11.78003289623408, 5.431903885120175, 23.593416395950413, 23.919962738249232, 18.915511142652534, 46.878875332424776, 8.177403120738028, 7.83418999391391, -2.177097093695785, -17.762771808184926, -5.28011740811284, 24.451596050247346, 28.269355637389904, 43.20352944584555, -8.999127193348137, -15.031054585836376, 9.44311745552028, -11.327396903881784, -21.009978354879923, -0.26013419636997526, -38.40511431615722, -16.126963134095284, 27.431363120716846, 29.446445385530453, 17.22622746846598, 8.889676136238265, -10.120322672451728, 10.581676494082537, -23.503131971434186, -8.417827044098605, -27.116003828602622, -12.758874616306827, 1.0207907369702198, 0.8606931175769184, 29.18908666856573, -3.9643172393774186, -19.04176319008885, -4.4350417424547, -11.944896743137392, -16.62438260460115, 7.063985195516096, -16.735050412218985, -24.323931173002745, -4.566196654961452, -8.227754801481279, -0.8068767800664212, -20.61418434970355, -27.499963221973474, -5.27579550127215, -23.985262022962463, -4.635537040984744, -6.185026133863602, -7.134045622481736, -19.478863048725838, 3.288073496675736, -6.850336706424464, 4.099798559641492, -11.240293054330383, -2.333588541015576, -6.7214817999857, -6.11520932521708, -24.50596504996324, 5.3928154274262745, 11.959021983340783, 9.622337152436373, -18.958812138395626, -18.735335252691645, -16.833673074311143, 5.816991699098963, -2.9191592338008157, 0.7448987136393121, 10.655256571223923, -13.381999471896794, -22.669577751131655, 11.001126666228128, 13.267229369281551, 7.24709034246694, -2.9945798102801007, -16.080954131084304, -18.529769860051243, -5.795776628532181, -13.338106933622065, -11.92476586772879, -22.67952016528814, -5.710202487611035, -9.93519353418106, -18.915940869385775, -9.104442513503837, -23.536345844074958, -16.163116711681806, -7.8013180874852335, -1.0979473512953177, -27.855767304861306, -14.942277981951246, -3.4521539469392053, -29.944110092360553, 7.708903223793115, -5.998813196805873, -22.167920839682804, -6.794519184702633, 8.744285586594017, 15.653002411214416, -19.131459461551053, -24.4201396316143, -19.426643649166078, -13.081446814414232, -28.155255756144893, -11.944318268937607, -17.1930507599631, -16.359019649288562, -3.603109836939545, -23.441995939000606, -5.970501531619679, 3.3569749971980727, -7.402944690463013, -2.375995628409539, -13.84733523945508, -22.432779481951677, -2.088837750933827, -28.598421313277168, -32.749251039173444, -5.985116656130149, -15.790968915814947, -6.951165294995953, -6.68317660242753, -4.79999949560964, -2.6193284731578395, -8.164822777957646, -0.495977955386774, 4.494440743001363, -24.833517845872105, -2.5857541393213097, 4.739572061915936, -11.880173071605896, -12.845727799581699, 15.587878582074822, 43.68572588181636, 56.36003256074176, 10.718077225676534, -4.45467780262857, -7.580775148023232, -28.049643153488756, -13.565821510173315, -24.190673124127265, -8.187148277415101, -12.127274585808646, -9.03036425991938, -19.42881444303368, 15.628061537354263, 18.841268631966813, -12.568854945610358, 6.533869947818182, -24.26683142179697, 9.177074269371317, -16.095301888399597, -11.857290789011135, 22.653977216364012, 22.47069947421148, 8.205169254770254, -25.504986299860306, -5.008809285296685, -5.06495212819447, -30.103307290384038, -19.95830536448812, 13.492711038982712, 11.288035942221704, 26.086119019595557, -8.28362517637278, -14.551435567989039, 1.3588627278098073, -5.677514441217781, -2.937010274680219, -9.887015813830203, -23.241572132712392, -0.656091190920435, -1.1536098964025001, 11.464046200850099, -17.574605280581032, -29.315884654477067, 0.846337370502674, 9.343417517823028, 6.613654783329718, -30.56894356743231, -8.234986034197618, -7.620178096207102, 15.811035993967156, -21.9699134544692, -32.43702104021292, -7.833691591858084, -44.45798029569407, 7.0689970456257, -2.5703975244520656, 5.306889617100282, -19.17270629127342, 5.405418925806025, 11.542783136706596, 13.985704692107156, -5.485497997642284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4244769786940935, "mean_inference_ms": 1.1175980586883179, "mean_action_processing_ms": 0.18219832439022438, "mean_env_wait_ms": 0.0742631311236871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035425424575805664, "StateBufferConnector_ms": 0.002444028854370117, "ViewRequirementAgentConnector_ms": 0.0683356523513794}, "num_episodes": 9, "episode_return_max": 50.02287922127907, "episode_return_min": -27.26603872512626, "episode_return_mean": -5.121726780820884}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 473.3523841789878, "num_env_steps_trained_throughput_per_sec": 473.3523841789878, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 1740000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1740000, "timers": {"training_iteration_time_ms": 8269.548, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8269.506, "sample_time_ms": 797.264, "learn_time_ms": 7457.724, "learn_throughput": 536.357, "synch_weights_time_ms": 13.932}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 1740000, "num_agent_steps_trained": 1740000}, "done": false, "training_iteration": 145, "trial_id": "83a5c_00000", "date": "2024-08-10_12-34-31", "timestamp": 1723307671, "time_this_iter_s": 8.46119499206543, "time_total_s": 1233.3475925922394, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd1de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1233.3475925922394, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 27.75000000000001, "ram_util_percent": 82.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4400578311511447, "cur_kl_coeff": 0.07602324485778808, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5388458175003215, "policy_loss": -0.009765770458296021, "vf_loss": 3.547038261474125, "vf_explained_var": 0.04834292136802875, "kl": 0.020695373877765873, "entropy": 1.3207702880183225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.822332203760743, "cur_kl_coeff": 8.700169928488324e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.273409290363391, "policy_loss": -0.009882630952779437, "vf_loss": 3.2832919135689735, "vf_explained_var": 0.6036397482578953, "kl": 0.00382099742454775, "entropy": 0.20217343737992147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "env_runners": {"episode_reward_max": 50.02287922127907, "episode_reward_min": -34.177433607122694, "episode_reward_mean": -7.959416571242878, "episode_len_mean": 381.96, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38196, "policy_reward_min": {"agent_policy": -50.022879221279055, "adversary_policy": -47.52574951756552}, "policy_reward_max": {"agent_policy": 34.17743360712269, "adversary_policy": 56.36003256074176}, "policy_reward_mean": {"agent_policy": 7.959416571242876, "adversary_policy": -7.959416571242879}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.26603872512626, 28.438904253123642, 13.057951802352122, 0.2306769108154345, -15.960479507766394, -19.93743922245473, 0.9407419272735673, 12.612384714594151, -11.738402466271776, -14.284639673869268, -4.8355326083514445, -14.4450639139821, -4.517315790773864, -24.057073785838515, -14.630528762117306, -5.41028158742418, -13.306454335603789, -1.7811316048743482, -3.5702472473444455, -4.527535170500631, -15.310587187590158, 8.67591870538351, -4.668237492979593, -17.784504163501392, 1.4489162326490739, 5.700077642431621, -18.02578861151422, 12.134178017754842, 2.1262552660934197, -17.30536199556777, -9.566941781077123, -17.30214301650846, -7.822698010896049, -14.010191691444806, -19.849731277878398, -4.4496327193902925, -21.399022643406276, -16.698132019649886, 0.8550450134936209, -14.481220012192718, 12.19864399890422, -21.775799546582686, -16.25404523179016, -20.049787012541234, -16.77603520462583, -13.522552887970075, -1.306763267210803, -4.889470159436273, -18.140057360703377, -15.3436295321055, -19.36718384765179, -11.37106710540545, -5.741588049018585, -5.392075625557743, 1.9992313938072872, -13.709635992596706, -3.5703005048449796, 1.3710753912465616, 50.02287922127907, 3.131699711523982, -17.815209150756, -18.878247317150294, -10.157211431611874, -14.229589351476527, 17.234665084660538, -3.017492498896088, -7.544878576212826, -13.976296338705364, 22.56233834528775, -8.649908522545026, -5.036880706745578, -25.030806327436064, 12.390373490602208, 8.901246921611387, -6.596286420089616, -4.307262357949, -16.5642939732713, -0.9048505436614782, -3.055279539865479, -14.234773641987196, 7.978536150576371, -19.401964800814966, 4.095428948880027, -27.20346724734106, -26.14583594377608, 2.2492997605868172, -6.93290833708657, 8.47410103125631, 4.250103347232436, -21.907709322306737, -32.52363765679799, -30.031552912783823, -25.643534826571898, -12.547730888561038, -24.7981333762369, -4.411050351023345, -33.74958153984562, -34.177433607122694, 1.7373259989804897, -5.133500544122452], "episode_lengths": [400, 45, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [27.266038725126272, -28.43890425312365, -13.057951802352122, -0.23067691081541852, 15.960479507766397, 19.937439222454728, -0.9407419272735655, -12.612384714594148, 11.738402466271776, 14.284639673869265, 4.8355326083514445, 14.445063913982098, 4.517315790773864, 24.05707378583851, 14.630528762117306, 5.410281587424169, 13.306454335603785, 1.7811316048743535, 3.5702472473444455, 4.527535170500636, 15.310587187590162, -8.675918705383545, 4.668237492979626, 17.78450416350139, -1.4489162326490739, -5.700077642431639, 18.02578861151423, -12.134178017754842, -2.1262552660934197, 17.30536199556777, 9.566941781077125, 17.30214301650847, 7.8226980108960475, 14.010191691444806, 19.84973127787838, 4.449632719390273, 21.39902264340628, 16.69813201964987, -0.8550450134936209, 14.481220012192718, -12.198643998904227, 21.775799546582682, 16.254045231790155, 20.049787012541238, 16.77603520462583, 13.522552887970075, 1.306763267210803, 4.889470159436275, 18.140057360703377, 15.343629532105497, 19.367183847651795, 11.37106710540545, 5.741588049018585, 5.392075625557743, -1.9992313938072908, 13.709635992596708, 3.5703005048449796, -1.3710753912465616, -50.022879221279055, -3.131699711523982, 17.81520915075599, 18.878247317150283, 10.157211431611874, 14.22958935147653, -17.23466508466054, 3.017492498896088, 7.544878576212826, 13.976296338705364, -22.562338345287742, 8.649908522545026, 5.036880706745578, 25.030806327436068, -12.390373490602208, -8.901246921611387, 6.596286420089616, 4.307262357949, 16.564293973271297, 0.9048505436614693, 3.055279539865463, 14.234773641987196, -7.978536150576373, 19.401964800814966, -4.095428948880027, 27.203467247341063, 26.145835943776078, -2.2492997605868172, 6.93290833708657, -8.47410103125631, -4.250103347232436, 21.907709322306733, 32.52363765679797, 30.031552912783827, 25.643534826571905, 12.547730888561038, 24.7981333762369, 4.411050351023338, 33.74958153984563, 34.17743360712269, -1.7373259989805074, 5.133500544122468], "policy_adversary_policy_reward": [-38.40511431615722, -16.126963134095284, 27.431363120716846, 29.446445385530453, 17.22622746846598, 8.889676136238265, -10.120322672451728, 10.581676494082537, -23.503131971434186, -8.417827044098605, -27.116003828602622, -12.758874616306827, 1.0207907369702198, 0.8606931175769184, 29.18908666856573, -3.9643172393774186, -19.04176319008885, -4.4350417424547, -11.944896743137392, -16.62438260460115, 7.063985195516096, -16.735050412218985, -24.323931173002745, -4.566196654961452, -8.227754801481279, -0.8068767800664212, -20.61418434970355, -27.499963221973474, -5.27579550127215, -23.985262022962463, -4.635537040984744, -6.185026133863602, -7.134045622481736, -19.478863048725838, 3.288073496675736, -6.850336706424464, 4.099798559641492, -11.240293054330383, -2.333588541015576, -6.7214817999857, -6.11520932521708, -24.50596504996324, 5.3928154274262745, 11.959021983340783, 9.622337152436373, -18.958812138395626, -18.735335252691645, -16.833673074311143, 5.816991699098963, -2.9191592338008157, 0.7448987136393121, 10.655256571223923, -13.381999471896794, -22.669577751131655, 11.001126666228128, 13.267229369281551, 7.24709034246694, -2.9945798102801007, -16.080954131084304, -18.529769860051243, -5.795776628532181, -13.338106933622065, -11.92476586772879, -22.67952016528814, -5.710202487611035, -9.93519353418106, -18.915940869385775, -9.104442513503837, -23.536345844074958, -16.163116711681806, -7.8013180874852335, -1.0979473512953177, -27.855767304861306, -14.942277981951246, -3.4521539469392053, -29.944110092360553, 7.708903223793115, -5.998813196805873, -22.167920839682804, -6.794519184702633, 8.744285586594017, 15.653002411214416, -19.131459461551053, -24.4201396316143, -19.426643649166078, -13.081446814414232, -28.155255756144893, -11.944318268937607, -17.1930507599631, -16.359019649288562, -3.603109836939545, -23.441995939000606, -5.970501531619679, 3.3569749971980727, -7.402944690463013, -2.375995628409539, -13.84733523945508, -22.432779481951677, -2.088837750933827, -28.598421313277168, -32.749251039173444, -5.985116656130149, -15.790968915814947, -6.951165294995953, -6.68317660242753, -4.79999949560964, -2.6193284731578395, -8.164822777957646, -0.495977955386774, 4.494440743001363, -24.833517845872105, -2.5857541393213097, 4.739572061915936, -11.880173071605896, -12.845727799581699, 15.587878582074822, 43.68572588181636, 56.36003256074176, 10.718077225676534, -4.45467780262857, -7.580775148023232, -28.049643153488756, -13.565821510173315, -24.190673124127265, -8.187148277415101, -12.127274585808646, -9.03036425991938, -19.42881444303368, 15.628061537354263, 18.841268631966813, -12.568854945610358, 6.533869947818182, -24.26683142179697, 9.177074269371317, -16.095301888399597, -11.857290789011135, 22.653977216364012, 22.47069947421148, 8.205169254770254, -25.504986299860306, -5.008809285296685, -5.06495212819447, -30.103307290384038, -19.95830536448812, 13.492711038982712, 11.288035942221704, 26.086119019595557, -8.28362517637278, -14.551435567989039, 1.3588627278098073, -5.677514441217781, -2.937010274680219, -9.887015813830203, -23.241572132712392, -0.656091190920435, -1.1536098964025001, 11.464046200850099, -17.574605280581032, -29.315884654477067, 0.846337370502674, 9.343417517823028, 6.613654783329718, -30.56894356743231, -8.234986034197618, -7.620178096207102, 15.811035993967156, -21.9699134544692, -32.43702104021292, -7.833691591858084, -44.45798029569407, 7.0689970456257, -2.5703975244520656, 5.306889617100282, -19.17270629127342, 5.405418925806025, 11.542783136706596, 13.985704692107156, -5.485497997642284, -14.96615176680016, -28.849266877813307, -43.52700440305836, -21.52027091053759, -12.537356308002124, -47.52574951756552, -27.090418265654648, -24.196651387489162, 0.6909666963603911, -25.786428473482466, -8.6912279793356, -40.9050387731382, 0.7917862838432796, -9.613886985889966, -44.758381672732256, -22.740781406958938, -46.71024056442817, -21.644626649817273, -9.731217647764804, 13.205869645725791, -16.454843884070236, 6.187842795825279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4242524284825141, "mean_inference_ms": 1.1166308232049522, "mean_action_processing_ms": 0.1820652582070236, "mean_env_wait_ms": 0.07420984572768825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003607630729675293, "StateBufferConnector_ms": 0.0024852752685546875, "ViewRequirementAgentConnector_ms": 0.06914448738098145}, "num_episodes": 11, "episode_return_max": 50.02287922127907, "episode_return_min": -34.177433607122694, "episode_return_mean": -7.959416571242878}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.95579594662894, "num_env_steps_trained_throughput_per_sec": 498.95579594662894, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 1752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1752000, "timers": {"training_iteration_time_ms": 8249.61, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8249.563, "sample_time_ms": 791.426, "learn_time_ms": 7443.576, "learn_throughput": 537.376, "synch_weights_time_ms": 14.034}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "done": false, "training_iteration": 146, "trial_id": "83a5c_00000", "date": "2024-08-10_12-34-40", "timestamp": 1723307680, "time_this_iter_s": 8.021812915802002, "time_total_s": 1241.3694055080414, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc74820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1241.3694055080414, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 25.8, "ram_util_percent": 82.55454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8530976781454034, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.077340482687824, "policy_loss": -0.00500343307143166, "vf_loss": 2.081577756291344, "vf_explained_var": 0.057376466541693955, "kl": 0.006718671096516072, "entropy": 1.3031823172140373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.198754715112348, "cur_kl_coeff": 4.350084964244162e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4694936806956926, "policy_loss": -0.009267664015836393, "vf_loss": 2.4787613468865555, "vf_explained_var": 0.19980488792061807, "kl": 0.007030345886975612, "entropy": 0.24524150819828114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "env_runners": {"episode_reward_max": 50.02287922127907, "episode_reward_min": -34.177433607122694, "episode_reward_mean": -8.60467695313416, "episode_len_mean": 385.51, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38551, "policy_reward_min": {"agent_policy": -50.022879221279055, "adversary_policy": -47.52574951756552}, "policy_reward_max": {"agent_policy": 34.17743360712269, "adversary_policy": 56.36003256074176}, "policy_reward_mean": {"agent_policy": 8.604676953134158, "adversary_policy": -8.60467695313416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.4450639139821, -4.517315790773864, -24.057073785838515, -14.630528762117306, -5.41028158742418, -13.306454335603789, -1.7811316048743482, -3.5702472473444455, -4.527535170500631, -15.310587187590158, 8.67591870538351, -4.668237492979593, -17.784504163501392, 1.4489162326490739, 5.700077642431621, -18.02578861151422, 12.134178017754842, 2.1262552660934197, -17.30536199556777, -9.566941781077123, -17.30214301650846, -7.822698010896049, -14.010191691444806, -19.849731277878398, -4.4496327193902925, -21.399022643406276, -16.698132019649886, 0.8550450134936209, -14.481220012192718, 12.19864399890422, -21.775799546582686, -16.25404523179016, -20.049787012541234, -16.77603520462583, -13.522552887970075, -1.306763267210803, -4.889470159436273, -18.140057360703377, -15.3436295321055, -19.36718384765179, -11.37106710540545, -5.741588049018585, -5.392075625557743, 1.9992313938072872, -13.709635992596706, -3.5703005048449796, 1.3710753912465616, 50.02287922127907, 3.131699711523982, -17.815209150756, -18.878247317150294, -10.157211431611874, -14.229589351476527, 17.234665084660538, -3.017492498896088, -7.544878576212826, -13.976296338705364, 22.56233834528775, -8.649908522545026, -5.036880706745578, -25.030806327436064, 12.390373490602208, 8.901246921611387, -6.596286420089616, -4.307262357949, -16.5642939732713, -0.9048505436614782, -3.055279539865479, -14.234773641987196, 7.978536150576371, -19.401964800814966, 4.095428948880027, -27.20346724734106, -26.14583594377608, 2.2492997605868172, -6.93290833708657, 8.47410103125631, 4.250103347232436, -21.907709322306737, -32.52363765679799, -30.031552912783823, -25.643534826571898, -12.547730888561038, -24.7981333762369, -4.411050351023345, -33.74958153984562, -34.177433607122694, 1.7373259989804897, -5.133500544122452, -7.469410967245501, -10.064951881564847, -18.14398263446751, -22.637308916263372, -3.321273182426797, 0.6079147054619476, -20.148844088048328, -10.193251559897135, -6.2634965594412115, -15.096209840219558, 9.462904139303275], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 33], "policy_agent_policy_reward": [14.445063913982098, 4.517315790773864, 24.05707378583851, 14.630528762117306, 5.410281587424169, 13.306454335603785, 1.7811316048743535, 3.5702472473444455, 4.527535170500636, 15.310587187590162, -8.675918705383545, 4.668237492979626, 17.78450416350139, -1.4489162326490739, -5.700077642431639, 18.02578861151423, -12.134178017754842, -2.1262552660934197, 17.30536199556777, 9.566941781077125, 17.30214301650847, 7.8226980108960475, 14.010191691444806, 19.84973127787838, 4.449632719390273, 21.39902264340628, 16.69813201964987, -0.8550450134936209, 14.481220012192718, -12.198643998904227, 21.775799546582682, 16.254045231790155, 20.049787012541238, 16.77603520462583, 13.522552887970075, 1.306763267210803, 4.889470159436275, 18.140057360703377, 15.343629532105497, 19.367183847651795, 11.37106710540545, 5.741588049018585, 5.392075625557743, -1.9992313938072908, 13.709635992596708, 3.5703005048449796, -1.3710753912465616, -50.022879221279055, -3.131699711523982, 17.81520915075599, 18.878247317150283, 10.157211431611874, 14.22958935147653, -17.23466508466054, 3.017492498896088, 7.544878576212826, 13.976296338705364, -22.562338345287742, 8.649908522545026, 5.036880706745578, 25.030806327436068, -12.390373490602208, -8.901246921611387, 6.596286420089616, 4.307262357949, 16.564293973271297, 0.9048505436614693, 3.055279539865463, 14.234773641987196, -7.978536150576373, 19.401964800814966, -4.095428948880027, 27.203467247341063, 26.145835943776078, -2.2492997605868172, 6.93290833708657, -8.47410103125631, -4.250103347232436, 21.907709322306733, 32.52363765679797, 30.031552912783827, 25.643534826571905, 12.547730888561038, 24.7981333762369, 4.411050351023338, 33.74958153984563, 34.17743360712269, -1.7373259989805074, 5.133500544122468, 7.469410967245501, 10.064951881564847, 18.143982634467516, 22.637308916263382, 3.321273182426797, -0.6079147054619298, 20.148844088048325, 10.193251559897135, 6.263496559441208, 15.096209840219558, -9.462904139303275], "policy_adversary_policy_reward": [-24.323931173002745, -4.566196654961452, -8.227754801481279, -0.8068767800664212, -20.61418434970355, -27.499963221973474, -5.27579550127215, -23.985262022962463, -4.635537040984744, -6.185026133863602, -7.134045622481736, -19.478863048725838, 3.288073496675736, -6.850336706424464, 4.099798559641492, -11.240293054330383, -2.333588541015576, -6.7214817999857, -6.11520932521708, -24.50596504996324, 5.3928154274262745, 11.959021983340783, 9.622337152436373, -18.958812138395626, -18.735335252691645, -16.833673074311143, 5.816991699098963, -2.9191592338008157, 0.7448987136393121, 10.655256571223923, -13.381999471896794, -22.669577751131655, 11.001126666228128, 13.267229369281551, 7.24709034246694, -2.9945798102801007, -16.080954131084304, -18.529769860051243, -5.795776628532181, -13.338106933622065, -11.92476586772879, -22.67952016528814, -5.710202487611035, -9.93519353418106, -18.915940869385775, -9.104442513503837, -23.536345844074958, -16.163116711681806, -7.8013180874852335, -1.0979473512953177, -27.855767304861306, -14.942277981951246, -3.4521539469392053, -29.944110092360553, 7.708903223793115, -5.998813196805873, -22.167920839682804, -6.794519184702633, 8.744285586594017, 15.653002411214416, -19.131459461551053, -24.4201396316143, -19.426643649166078, -13.081446814414232, -28.155255756144893, -11.944318268937607, -17.1930507599631, -16.359019649288562, -3.603109836939545, -23.441995939000606, -5.970501531619679, 3.3569749971980727, -7.402944690463013, -2.375995628409539, -13.84733523945508, -22.432779481951677, -2.088837750933827, -28.598421313277168, -32.749251039173444, -5.985116656130149, -15.790968915814947, -6.951165294995953, -6.68317660242753, -4.79999949560964, -2.6193284731578395, -8.164822777957646, -0.495977955386774, 4.494440743001363, -24.833517845872105, -2.5857541393213097, 4.739572061915936, -11.880173071605896, -12.845727799581699, 15.587878582074822, 43.68572588181636, 56.36003256074176, 10.718077225676534, -4.45467780262857, -7.580775148023232, -28.049643153488756, -13.565821510173315, -24.190673124127265, -8.187148277415101, -12.127274585808646, -9.03036425991938, -19.42881444303368, 15.628061537354263, 18.841268631966813, -12.568854945610358, 6.533869947818182, -24.26683142179697, 9.177074269371317, -16.095301888399597, -11.857290789011135, 22.653977216364012, 22.47069947421148, 8.205169254770254, -25.504986299860306, -5.008809285296685, -5.06495212819447, -30.103307290384038, -19.95830536448812, 13.492711038982712, 11.288035942221704, 26.086119019595557, -8.28362517637278, -14.551435567989039, 1.3588627278098073, -5.677514441217781, -2.937010274680219, -9.887015813830203, -23.241572132712392, -0.656091190920435, -1.1536098964025001, 11.464046200850099, -17.574605280581032, -29.315884654477067, 0.846337370502674, 9.343417517823028, 6.613654783329718, -30.56894356743231, -8.234986034197618, -7.620178096207102, 15.811035993967156, -21.9699134544692, -32.43702104021292, -7.833691591858084, -44.45798029569407, 7.0689970456257, -2.5703975244520656, 5.306889617100282, -19.17270629127342, 5.405418925806025, 11.542783136706596, 13.985704692107156, -5.485497997642284, -14.96615176680016, -28.849266877813307, -43.52700440305836, -21.52027091053759, -12.537356308002124, -47.52574951756552, -27.090418265654648, -24.196651387489162, 0.6909666963603911, -25.786428473482466, -8.6912279793356, -40.9050387731382, 0.7917862838432796, -9.613886985889966, -44.758381672732256, -22.740781406958938, -46.71024056442817, -21.644626649817273, -9.731217647764804, 13.205869645725791, -16.454843884070236, 6.187842795825279, -15.90408619324571, 0.9652642587547078, -16.260280888508973, -3.8696228746207204, -14.226848512700759, -22.061116756234288, -15.830858971874292, -29.44375886065246, 4.117490973923346, -10.76003733877694, 5.8527671005097375, -4.63693768958589, -10.866511960586276, -29.431176215510362, -29.502002720209703, 9.115499600415433, -6.352251194016169, -6.1747419248662485, -15.378378054487065, -14.814041625952047, 6.6237158992421215, 12.302092379364431]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4240178115450424, "mean_inference_ms": 1.1160113463731112, "mean_action_processing_ms": 0.18199361409826903, "mean_env_wait_ms": 0.07416896512805667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037041902542114258, "StateBufferConnector_ms": 0.0025023221969604492, "ViewRequirementAgentConnector_ms": 0.06963229179382324}, "num_episodes": 11, "episode_return_max": 50.02287922127907, "episode_return_min": -34.177433607122694, "episode_return_mean": -8.60467695313416}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 488.3902910412931, "num_env_steps_trained_throughput_per_sec": 488.3902910412931, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 1764000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1764000, "timers": {"training_iteration_time_ms": 8185.027, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8184.982, "sample_time_ms": 790.774, "learn_time_ms": 7379.909, "learn_throughput": 542.012, "synch_weights_time_ms": 13.864}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 1764000, "num_agent_steps_trained": 1764000}, "done": false, "training_iteration": 147, "trial_id": "83a5c_00000", "date": "2024-08-10_12-34-48", "timestamp": 1723307688, "time_this_iter_s": 8.195818901062012, "time_total_s": 1249.5652244091034, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1249.5652244091034, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 27.116666666666664, "ram_util_percent": 82.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7786360203273714, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.041901733288689, "policy_loss": -0.012192746395215628, "vf_loss": 2.0529438512035147, "vf_explained_var": -0.011514291782227773, "kl": 0.01009013025282567, "entropy": 1.3152317207326334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.872506181150675, "cur_kl_coeff": 4.350084964244162e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.849076014322539, "policy_loss": -0.01260147688347691, "vf_loss": 1.8616774945209424, "vf_explained_var": 0.29375241256008544, "kl": 0.006599143973201499, "entropy": 0.23870231768426795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 50.02287922127907, "episode_reward_min": -34.177433607122694, "episode_reward_mean": -8.352353771618102, "episode_len_mean": 385.51, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38551, "policy_reward_min": {"agent_policy": -50.022879221279055, "adversary_policy": -47.52574951756552}, "policy_reward_max": {"agent_policy": 34.17743360712269, "adversary_policy": 56.36003256074176}, "policy_reward_mean": {"agent_policy": 8.352353771618102, "adversary_policy": -8.352353771618104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.668237492979593, -17.784504163501392, 1.4489162326490739, 5.700077642431621, -18.02578861151422, 12.134178017754842, 2.1262552660934197, -17.30536199556777, -9.566941781077123, -17.30214301650846, -7.822698010896049, -14.010191691444806, -19.849731277878398, -4.4496327193902925, -21.399022643406276, -16.698132019649886, 0.8550450134936209, -14.481220012192718, 12.19864399890422, -21.775799546582686, -16.25404523179016, -20.049787012541234, -16.77603520462583, -13.522552887970075, -1.306763267210803, -4.889470159436273, -18.140057360703377, -15.3436295321055, -19.36718384765179, -11.37106710540545, -5.741588049018585, -5.392075625557743, 1.9992313938072872, -13.709635992596706, -3.5703005048449796, 1.3710753912465616, 50.02287922127907, 3.131699711523982, -17.815209150756, -18.878247317150294, -10.157211431611874, -14.229589351476527, 17.234665084660538, -3.017492498896088, -7.544878576212826, -13.976296338705364, 22.56233834528775, -8.649908522545026, -5.036880706745578, -25.030806327436064, 12.390373490602208, 8.901246921611387, -6.596286420089616, -4.307262357949, -16.5642939732713, -0.9048505436614782, -3.055279539865479, -14.234773641987196, 7.978536150576371, -19.401964800814966, 4.095428948880027, -27.20346724734106, -26.14583594377608, 2.2492997605868172, -6.93290833708657, 8.47410103125631, 4.250103347232436, -21.907709322306737, -32.52363765679799, -30.031552912783823, -25.643534826571898, -12.547730888561038, -24.7981333762369, -4.411050351023345, -33.74958153984562, -34.177433607122694, 1.7373259989804897, -5.133500544122452, -7.469410967245501, -10.064951881564847, -18.14398263446751, -22.637308916263372, -3.321273182426797, 0.6079147054619476, -20.148844088048328, -10.193251559897135, -6.2634965594412115, -15.096209840219558, 9.462904139303275, -8.435678584157175, 3.5822372550733057, -2.863503496150061, -18.61196484508745, -14.787468174327088, 1.4177602135300855, -17.749227524863418, -10.27102372943575, -5.373420967793201, -0.11121118791266049, 5.555518512063305], "episode_lengths": [400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [4.668237492979626, 17.78450416350139, -1.4489162326490739, -5.700077642431639, 18.02578861151423, -12.134178017754842, -2.1262552660934197, 17.30536199556777, 9.566941781077125, 17.30214301650847, 7.8226980108960475, 14.010191691444806, 19.84973127787838, 4.449632719390273, 21.39902264340628, 16.69813201964987, -0.8550450134936209, 14.481220012192718, -12.198643998904227, 21.775799546582682, 16.254045231790155, 20.049787012541238, 16.77603520462583, 13.522552887970075, 1.306763267210803, 4.889470159436275, 18.140057360703377, 15.343629532105497, 19.367183847651795, 11.37106710540545, 5.741588049018585, 5.392075625557743, -1.9992313938072908, 13.709635992596708, 3.5703005048449796, -1.3710753912465616, -50.022879221279055, -3.131699711523982, 17.81520915075599, 18.878247317150283, 10.157211431611874, 14.22958935147653, -17.23466508466054, 3.017492498896088, 7.544878576212826, 13.976296338705364, -22.562338345287742, 8.649908522545026, 5.036880706745578, 25.030806327436068, -12.390373490602208, -8.901246921611387, 6.596286420089616, 4.307262357949, 16.564293973271297, 0.9048505436614693, 3.055279539865463, 14.234773641987196, -7.978536150576373, 19.401964800814966, -4.095428948880027, 27.203467247341063, 26.145835943776078, -2.2492997605868172, 6.93290833708657, -8.47410103125631, -4.250103347232436, 21.907709322306733, 32.52363765679797, 30.031552912783827, 25.643534826571905, 12.547730888561038, 24.7981333762369, 4.411050351023338, 33.74958153984563, 34.17743360712269, -1.7373259989805074, 5.133500544122468, 7.469410967245501, 10.064951881564847, 18.143982634467516, 22.637308916263382, 3.321273182426797, -0.6079147054619298, 20.148844088048325, 10.193251559897135, 6.263496559441208, 15.096209840219558, -9.462904139303275, 8.435678584157175, -3.5822372550733057, 2.863503496150061, 18.611964845087456, 14.787468174327088, -1.4177602135300855, 17.749227524863414, 10.27102372943575, 5.373420967793201, 0.11121118791266049, -5.555518512063287], "policy_adversary_policy_reward": [9.622337152436373, -18.958812138395626, -18.735335252691645, -16.833673074311143, 5.816991699098963, -2.9191592338008157, 0.7448987136393121, 10.655256571223923, -13.381999471896794, -22.669577751131655, 11.001126666228128, 13.267229369281551, 7.24709034246694, -2.9945798102801007, -16.080954131084304, -18.529769860051243, -5.795776628532181, -13.338106933622065, -11.92476586772879, -22.67952016528814, -5.710202487611035, -9.93519353418106, -18.915940869385775, -9.104442513503837, -23.536345844074958, -16.163116711681806, -7.8013180874852335, -1.0979473512953177, -27.855767304861306, -14.942277981951246, -3.4521539469392053, -29.944110092360553, 7.708903223793115, -5.998813196805873, -22.167920839682804, -6.794519184702633, 8.744285586594017, 15.653002411214416, -19.131459461551053, -24.4201396316143, -19.426643649166078, -13.081446814414232, -28.155255756144893, -11.944318268937607, -17.1930507599631, -16.359019649288562, -3.603109836939545, -23.441995939000606, -5.970501531619679, 3.3569749971980727, -7.402944690463013, -2.375995628409539, -13.84733523945508, -22.432779481951677, -2.088837750933827, -28.598421313277168, -32.749251039173444, -5.985116656130149, -15.790968915814947, -6.951165294995953, -6.68317660242753, -4.79999949560964, -2.6193284731578395, -8.164822777957646, -0.495977955386774, 4.494440743001363, -24.833517845872105, -2.5857541393213097, 4.739572061915936, -11.880173071605896, -12.845727799581699, 15.587878582074822, 43.68572588181636, 56.36003256074176, 10.718077225676534, -4.45467780262857, -7.580775148023232, -28.049643153488756, -13.565821510173315, -24.190673124127265, -8.187148277415101, -12.127274585808646, -9.03036425991938, -19.42881444303368, 15.628061537354263, 18.841268631966813, -12.568854945610358, 6.533869947818182, -24.26683142179697, 9.177074269371317, -16.095301888399597, -11.857290789011135, 22.653977216364012, 22.47069947421148, 8.205169254770254, -25.504986299860306, -5.008809285296685, -5.06495212819447, -30.103307290384038, -19.95830536448812, 13.492711038982712, 11.288035942221704, 26.086119019595557, -8.28362517637278, -14.551435567989039, 1.3588627278098073, -5.677514441217781, -2.937010274680219, -9.887015813830203, -23.241572132712392, -0.656091190920435, -1.1536098964025001, 11.464046200850099, -17.574605280581032, -29.315884654477067, 0.846337370502674, 9.343417517823028, 6.613654783329718, -30.56894356743231, -8.234986034197618, -7.620178096207102, 15.811035993967156, -21.9699134544692, -32.43702104021292, -7.833691591858084, -44.45798029569407, 7.0689970456257, -2.5703975244520656, 5.306889617100282, -19.17270629127342, 5.405418925806025, 11.542783136706596, 13.985704692107156, -5.485497997642284, -14.96615176680016, -28.849266877813307, -43.52700440305836, -21.52027091053759, -12.537356308002124, -47.52574951756552, -27.090418265654648, -24.196651387489162, 0.6909666963603911, -25.786428473482466, -8.6912279793356, -40.9050387731382, 0.7917862838432796, -9.613886985889966, -44.758381672732256, -22.740781406958938, -46.71024056442817, -21.644626649817273, -9.731217647764804, 13.205869645725791, -16.454843884070236, 6.187842795825279, -15.90408619324571, 0.9652642587547078, -16.260280888508973, -3.8696228746207204, -14.226848512700759, -22.061116756234288, -15.830858971874292, -29.44375886065246, 4.117490973923346, -10.76003733877694, 5.8527671005097375, -4.63693768958589, -10.866511960586276, -29.431176215510362, -29.502002720209703, 9.115499600415433, -6.352251194016169, -6.1747419248662485, -15.378378054487065, -14.814041625952047, 6.6237158992421215, 12.302092379364431, -6.44090518587349, -10.43045198244086, 8.350545414228286, -1.1860709040816744, 0.7014551953102526, -6.428462187610375, -23.007207432305268, -14.216722257869659, -1.2825329110868182, -28.29240343756736, 2.737674264574281, 0.09784616248589018, -24.401365415394324, -11.097089634332509, -6.506686601635359, -14.035360857236142, -18.361537989281913, 7.614696053695511, 8.70306039985499, -8.925482775680312, 8.941672690546984, 2.1693643335796082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4237865649393923, "mean_inference_ms": 1.1152953476137433, "mean_action_processing_ms": 0.18191941364551886, "mean_env_wait_ms": 0.0741353734535641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036585330963134766, "StateBufferConnector_ms": 0.002492666244506836, "ViewRequirementAgentConnector_ms": 0.06883037090301514}, "num_episodes": 11, "episode_return_max": 50.02287922127907, "episode_return_min": -34.177433607122694, "episode_return_mean": -8.352353771618102}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.4403198349947, "num_env_steps_trained_throughput_per_sec": 485.4403198349947, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 8202.626, "restore_workers_time_ms": 0.016, "training_step_time_ms": 8202.58, "sample_time_ms": 783.408, "learn_time_ms": 7404.762, "learn_throughput": 540.193, "synch_weights_time_ms": 13.967}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 148, "trial_id": "83a5c_00000", "date": "2024-08-10_12-34-56", "timestamp": 1723307696, "time_this_iter_s": 8.245478868484497, "time_total_s": 1257.810703277588, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcfdee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1257.810703277588, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 28.71666666666667, "ram_util_percent": 82.99166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.307071649176734, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.93477123263021, "policy_loss": -0.005907086297997801, "vf_loss": 2.939930172067471, "vf_explained_var": -0.5500750747938005, "kl": 0.006560708506099621, "entropy": 1.3315781626121077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8232318932811418, "cur_kl_coeff": 4.350084964244162e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.247567694634199, "policy_loss": -0.008290731144855575, "vf_loss": 2.2558584245542685, "vf_explained_var": 0.3631192451963822, "kl": 0.006767049542096833, "entropy": 0.34946102562050024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "env_runners": {"episode_reward_max": 50.02287922127907, "episode_reward_min": -34.177433607122694, "episode_reward_mean": -8.813171099767928, "episode_len_mean": 389.32, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38932, "policy_reward_min": {"agent_policy": -50.022879221279055, "adversary_policy": -47.52574951756552}, "policy_reward_max": {"agent_policy": 34.17743360712269, "adversary_policy": 56.36003256074176}, "policy_reward_mean": {"agent_policy": 8.813171099767926, "adversary_policy": -8.813171099767928}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.30214301650846, -7.822698010896049, -14.010191691444806, -19.849731277878398, -4.4496327193902925, -21.399022643406276, -16.698132019649886, 0.8550450134936209, -14.481220012192718, 12.19864399890422, -21.775799546582686, -16.25404523179016, -20.049787012541234, -16.77603520462583, -13.522552887970075, -1.306763267210803, -4.889470159436273, -18.140057360703377, -15.3436295321055, -19.36718384765179, -11.37106710540545, -5.741588049018585, -5.392075625557743, 1.9992313938072872, -13.709635992596706, -3.5703005048449796, 1.3710753912465616, 50.02287922127907, 3.131699711523982, -17.815209150756, -18.878247317150294, -10.157211431611874, -14.229589351476527, 17.234665084660538, -3.017492498896088, -7.544878576212826, -13.976296338705364, 22.56233834528775, -8.649908522545026, -5.036880706745578, -25.030806327436064, 12.390373490602208, 8.901246921611387, -6.596286420089616, -4.307262357949, -16.5642939732713, -0.9048505436614782, -3.055279539865479, -14.234773641987196, 7.978536150576371, -19.401964800814966, 4.095428948880027, -27.20346724734106, -26.14583594377608, 2.2492997605868172, -6.93290833708657, 8.47410103125631, 4.250103347232436, -21.907709322306737, -32.52363765679799, -30.031552912783823, -25.643534826571898, -12.547730888561038, -24.7981333762369, -4.411050351023345, -33.74958153984562, -34.177433607122694, 1.7373259989804897, -5.133500544122452, -7.469410967245501, -10.064951881564847, -18.14398263446751, -22.637308916263372, -3.321273182426797, 0.6079147054619476, -20.148844088048328, -10.193251559897135, -6.2634965594412115, -15.096209840219558, 9.462904139303275, -8.435678584157175, 3.5822372550733057, -2.863503496150061, -18.61196484508745, -14.787468174327088, 1.4177602135300855, -17.749227524863418, -10.27102372943575, -5.373420967793201, -0.11121118791266049, 5.555518512063305, -22.312110376643663, 4.402614166107316, -18.192824158144116, -4.327560252504245, -27.391626943330298, -13.06371520883864, -4.499440530034002, -2.339342944703194, -4.299133452602826], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [17.30214301650847, 7.8226980108960475, 14.010191691444806, 19.84973127787838, 4.449632719390273, 21.39902264340628, 16.69813201964987, -0.8550450134936209, 14.481220012192718, -12.198643998904227, 21.775799546582682, 16.254045231790155, 20.049787012541238, 16.77603520462583, 13.522552887970075, 1.306763267210803, 4.889470159436275, 18.140057360703377, 15.343629532105497, 19.367183847651795, 11.37106710540545, 5.741588049018585, 5.392075625557743, -1.9992313938072908, 13.709635992596708, 3.5703005048449796, -1.3710753912465616, -50.022879221279055, -3.131699711523982, 17.81520915075599, 18.878247317150283, 10.157211431611874, 14.22958935147653, -17.23466508466054, 3.017492498896088, 7.544878576212826, 13.976296338705364, -22.562338345287742, 8.649908522545026, 5.036880706745578, 25.030806327436068, -12.390373490602208, -8.901246921611387, 6.596286420089616, 4.307262357949, 16.564293973271297, 0.9048505436614693, 3.055279539865463, 14.234773641987196, -7.978536150576373, 19.401964800814966, -4.095428948880027, 27.203467247341063, 26.145835943776078, -2.2492997605868172, 6.93290833708657, -8.47410103125631, -4.250103347232436, 21.907709322306733, 32.52363765679797, 30.031552912783827, 25.643534826571905, 12.547730888561038, 24.7981333762369, 4.411050351023338, 33.74958153984563, 34.17743360712269, -1.7373259989805074, 5.133500544122468, 7.469410967245501, 10.064951881564847, 18.143982634467516, 22.637308916263382, 3.321273182426797, -0.6079147054619298, 20.148844088048325, 10.193251559897135, 6.263496559441208, 15.096209840219558, -9.462904139303275, 8.435678584157175, -3.5822372550733057, 2.863503496150061, 18.611964845087456, 14.787468174327088, -1.4177602135300855, 17.749227524863414, 10.27102372943575, 5.373420967793201, 0.11121118791266049, -5.555518512063287, 22.312110376643666, -4.402614166107314, 18.19282415814412, 4.327560252504245, 27.391626943330294, 13.06371520883864, 4.499440530034002, 2.339342944703194, 4.299133452602826], "policy_adversary_policy_reward": [-11.92476586772879, -22.67952016528814, -5.710202487611035, -9.93519353418106, -18.915940869385775, -9.104442513503837, -23.536345844074958, -16.163116711681806, -7.8013180874852335, -1.0979473512953177, -27.855767304861306, -14.942277981951246, -3.4521539469392053, -29.944110092360553, 7.708903223793115, -5.998813196805873, -22.167920839682804, -6.794519184702633, 8.744285586594017, 15.653002411214416, -19.131459461551053, -24.4201396316143, -19.426643649166078, -13.081446814414232, -28.155255756144893, -11.944318268937607, -17.1930507599631, -16.359019649288562, -3.603109836939545, -23.441995939000606, -5.970501531619679, 3.3569749971980727, -7.402944690463013, -2.375995628409539, -13.84733523945508, -22.432779481951677, -2.088837750933827, -28.598421313277168, -32.749251039173444, -5.985116656130149, -15.790968915814947, -6.951165294995953, -6.68317660242753, -4.79999949560964, -2.6193284731578395, -8.164822777957646, -0.495977955386774, 4.494440743001363, -24.833517845872105, -2.5857541393213097, 4.739572061915936, -11.880173071605896, -12.845727799581699, 15.587878582074822, 43.68572588181636, 56.36003256074176, 10.718077225676534, -4.45467780262857, -7.580775148023232, -28.049643153488756, -13.565821510173315, -24.190673124127265, -8.187148277415101, -12.127274585808646, -9.03036425991938, -19.42881444303368, 15.628061537354263, 18.841268631966813, -12.568854945610358, 6.533869947818182, -24.26683142179697, 9.177074269371317, -16.095301888399597, -11.857290789011135, 22.653977216364012, 22.47069947421148, 8.205169254770254, -25.504986299860306, -5.008809285296685, -5.06495212819447, -30.103307290384038, -19.95830536448812, 13.492711038982712, 11.288035942221704, 26.086119019595557, -8.28362517637278, -14.551435567989039, 1.3588627278098073, -5.677514441217781, -2.937010274680219, -9.887015813830203, -23.241572132712392, -0.656091190920435, -1.1536098964025001, 11.464046200850099, -17.574605280581032, -29.315884654477067, 0.846337370502674, 9.343417517823028, 6.613654783329718, -30.56894356743231, -8.234986034197618, -7.620178096207102, 15.811035993967156, -21.9699134544692, -32.43702104021292, -7.833691591858084, -44.45798029569407, 7.0689970456257, -2.5703975244520656, 5.306889617100282, -19.17270629127342, 5.405418925806025, 11.542783136706596, 13.985704692107156, -5.485497997642284, -14.96615176680016, -28.849266877813307, -43.52700440305836, -21.52027091053759, -12.537356308002124, -47.52574951756552, -27.090418265654648, -24.196651387489162, 0.6909666963603911, -25.786428473482466, -8.6912279793356, -40.9050387731382, 0.7917862838432796, -9.613886985889966, -44.758381672732256, -22.740781406958938, -46.71024056442817, -21.644626649817273, -9.731217647764804, 13.205869645725791, -16.454843884070236, 6.187842795825279, -15.90408619324571, 0.9652642587547078, -16.260280888508973, -3.8696228746207204, -14.226848512700759, -22.061116756234288, -15.830858971874292, -29.44375886065246, 4.117490973923346, -10.76003733877694, 5.8527671005097375, -4.63693768958589, -10.866511960586276, -29.431176215510362, -29.502002720209703, 9.115499600415433, -6.352251194016169, -6.1747419248662485, -15.378378054487065, -14.814041625952047, 6.6237158992421215, 12.302092379364431, -6.44090518587349, -10.43045198244086, 8.350545414228286, -1.1860709040816744, 0.7014551953102526, -6.428462187610375, -23.007207432305268, -14.216722257869659, -1.2825329110868182, -28.29240343756736, 2.737674264574281, 0.09784616248589018, -24.401365415394324, -11.097089634332509, -6.506686601635359, -14.035360857236142, -18.361537989281913, 7.614696053695511, 8.70306039985499, -8.925482775680312, 8.941672690546984, 2.1693643335796082, -27.67666050276932, -16.947560250518013, 3.8398090846165687, 4.965419247598081, -22.098209012301336, -14.28743930398689, -10.912114518879761, 2.256994013871271, -31.24193480094852, -23.54131908571206, -14.415088179448276, -11.712342238229006, 6.068178157099084, -15.067059217167088, -6.852948574053649, 2.1742626846472604, 6.722660282464851, -15.320927187670502]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42365617488250834, "mean_inference_ms": 1.1146034633600108, "mean_action_processing_ms": 0.18180039470406492, "mean_env_wait_ms": 0.07406523478426376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036514997482299805, "StateBufferConnector_ms": 0.00245821475982666, "ViewRequirementAgentConnector_ms": 0.06998825073242188}, "num_episodes": 9, "episode_return_max": 50.02287922127907, "episode_return_min": -34.177433607122694, "episode_return_mean": -8.813171099767928}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.85199228016165, "num_env_steps_trained_throughput_per_sec": 475.85199228016165, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 1788000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1788000, "timers": {"training_iteration_time_ms": 8228.871, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8228.825, "sample_time_ms": 788.354, "learn_time_ms": 7425.928, "learn_throughput": 538.653, "synch_weights_time_ms": 14.093}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 1788000, "num_agent_steps_trained": 1788000}, "done": false, "training_iteration": 149, "trial_id": "83a5c_00000", "date": "2024-08-10_12-35-05", "timestamp": 1723307705, "time_this_iter_s": 8.411391973495483, "time_total_s": 1266.2220952510834, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcfdd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1266.2220952510834, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 29.741666666666664, "ram_util_percent": 82.91666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.026383798431467, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7658884787685656, "policy_loss": -0.005452373875403609, "vf_loss": 2.770084570135389, "vf_explained_var": -0.04476600144275282, "kl": 0.011016684547826693, "entropy": 1.3315713673041611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.144781500473618, "cur_kl_coeff": 4.350084964244162e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2642323311418293, "policy_loss": -0.009598848492775385, "vf_loss": 2.2738311832149822, "vf_explained_var": 0.48573729675263166, "kl": 0.005246171418919515, "entropy": 0.29991295823516945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 50.02287922127907, "episode_reward_min": -34.177433607122694, "episode_reward_mean": -8.09398597139297, "episode_len_mean": 381.68, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38168, "policy_reward_min": {"agent_policy": -50.022879221279055, "adversary_policy": -47.52574951756552}, "policy_reward_max": {"agent_policy": 34.17743360712269, "adversary_policy": 56.36003256074176}, "policy_reward_mean": {"agent_policy": 8.09398597139297, "adversary_policy": -8.093985971392971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.25404523179016, -20.049787012541234, -16.77603520462583, -13.522552887970075, -1.306763267210803, -4.889470159436273, -18.140057360703377, -15.3436295321055, -19.36718384765179, -11.37106710540545, -5.741588049018585, -5.392075625557743, 1.9992313938072872, -13.709635992596706, -3.5703005048449796, 1.3710753912465616, 50.02287922127907, 3.131699711523982, -17.815209150756, -18.878247317150294, -10.157211431611874, -14.229589351476527, 17.234665084660538, -3.017492498896088, -7.544878576212826, -13.976296338705364, 22.56233834528775, -8.649908522545026, -5.036880706745578, -25.030806327436064, 12.390373490602208, 8.901246921611387, -6.596286420089616, -4.307262357949, -16.5642939732713, -0.9048505436614782, -3.055279539865479, -14.234773641987196, 7.978536150576371, -19.401964800814966, 4.095428948880027, -27.20346724734106, -26.14583594377608, 2.2492997605868172, -6.93290833708657, 8.47410103125631, 4.250103347232436, -21.907709322306737, -32.52363765679799, -30.031552912783823, -25.643534826571898, -12.547730888561038, -24.7981333762369, -4.411050351023345, -33.74958153984562, -34.177433607122694, 1.7373259989804897, -5.133500544122452, -7.469410967245501, -10.064951881564847, -18.14398263446751, -22.637308916263372, -3.321273182426797, 0.6079147054619476, -20.148844088048328, -10.193251559897135, -6.2634965594412115, -15.096209840219558, 9.462904139303275, -8.435678584157175, 3.5822372550733057, -2.863503496150061, -18.61196484508745, -14.787468174327088, 1.4177602135300855, -17.749227524863418, -10.27102372943575, -5.373420967793201, -0.11121118791266049, 5.555518512063305, -22.312110376643663, 4.402614166107316, -18.192824158144116, -4.327560252504245, -27.391626943330298, -13.06371520883864, -4.499440530034002, -2.339342944703194, -4.299133452602826, -6.300949625479197, -19.098887481748868, -3.334979942264935, -9.117046972081173, -5.50853337503235, 7.37382060720348, 11.0817687984151, 0.902349067713585, 4.439645061835339, -22.156404615550446, -11.097150611066521], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 20, 400, 400, 400, 400], "policy_agent_policy_reward": [16.254045231790155, 20.049787012541238, 16.77603520462583, 13.522552887970075, 1.306763267210803, 4.889470159436275, 18.140057360703377, 15.343629532105497, 19.367183847651795, 11.37106710540545, 5.741588049018585, 5.392075625557743, -1.9992313938072908, 13.709635992596708, 3.5703005048449796, -1.3710753912465616, -50.022879221279055, -3.131699711523982, 17.81520915075599, 18.878247317150283, 10.157211431611874, 14.22958935147653, -17.23466508466054, 3.017492498896088, 7.544878576212826, 13.976296338705364, -22.562338345287742, 8.649908522545026, 5.036880706745578, 25.030806327436068, -12.390373490602208, -8.901246921611387, 6.596286420089616, 4.307262357949, 16.564293973271297, 0.9048505436614693, 3.055279539865463, 14.234773641987196, -7.978536150576373, 19.401964800814966, -4.095428948880027, 27.203467247341063, 26.145835943776078, -2.2492997605868172, 6.93290833708657, -8.47410103125631, -4.250103347232436, 21.907709322306733, 32.52363765679797, 30.031552912783827, 25.643534826571905, 12.547730888561038, 24.7981333762369, 4.411050351023338, 33.74958153984563, 34.17743360712269, -1.7373259989805074, 5.133500544122468, 7.469410967245501, 10.064951881564847, 18.143982634467516, 22.637308916263382, 3.321273182426797, -0.6079147054619298, 20.148844088048325, 10.193251559897135, 6.263496559441208, 15.096209840219558, -9.462904139303275, 8.435678584157175, -3.5822372550733057, 2.863503496150061, 18.611964845087456, 14.787468174327088, -1.4177602135300855, 17.749227524863414, 10.27102372943575, 5.373420967793201, 0.11121118791266049, -5.555518512063287, 22.312110376643666, -4.402614166107314, 18.19282415814412, 4.327560252504245, 27.391626943330294, 13.06371520883864, 4.499440530034002, 2.339342944703194, 4.299133452602826, 6.300949625479197, 19.098887481748868, 3.334979942264935, 9.117046972081175, 5.508533375032348, -7.373820607203481, -11.081768798415101, -0.9023490677135655, -4.439645061835339, 22.156404615550443, 11.097150611066521], "policy_adversary_policy_reward": [-19.426643649166078, -13.081446814414232, -28.155255756144893, -11.944318268937607, -17.1930507599631, -16.359019649288562, -3.603109836939545, -23.441995939000606, -5.970501531619679, 3.3569749971980727, -7.402944690463013, -2.375995628409539, -13.84733523945508, -22.432779481951677, -2.088837750933827, -28.598421313277168, -32.749251039173444, -5.985116656130149, -15.790968915814947, -6.951165294995953, -6.68317660242753, -4.79999949560964, -2.6193284731578395, -8.164822777957646, -0.495977955386774, 4.494440743001363, -24.833517845872105, -2.5857541393213097, 4.739572061915936, -11.880173071605896, -12.845727799581699, 15.587878582074822, 43.68572588181636, 56.36003256074176, 10.718077225676534, -4.45467780262857, -7.580775148023232, -28.049643153488756, -13.565821510173315, -24.190673124127265, -8.187148277415101, -12.127274585808646, -9.03036425991938, -19.42881444303368, 15.628061537354263, 18.841268631966813, -12.568854945610358, 6.533869947818182, -24.26683142179697, 9.177074269371317, -16.095301888399597, -11.857290789011135, 22.653977216364012, 22.47069947421148, 8.205169254770254, -25.504986299860306, -5.008809285296685, -5.06495212819447, -30.103307290384038, -19.95830536448812, 13.492711038982712, 11.288035942221704, 26.086119019595557, -8.28362517637278, -14.551435567989039, 1.3588627278098073, -5.677514441217781, -2.937010274680219, -9.887015813830203, -23.241572132712392, -0.656091190920435, -1.1536098964025001, 11.464046200850099, -17.574605280581032, -29.315884654477067, 0.846337370502674, 9.343417517823028, 6.613654783329718, -30.56894356743231, -8.234986034197618, -7.620178096207102, 15.811035993967156, -21.9699134544692, -32.43702104021292, -7.833691591858084, -44.45798029569407, 7.0689970456257, -2.5703975244520656, 5.306889617100282, -19.17270629127342, 5.405418925806025, 11.542783136706596, 13.985704692107156, -5.485497997642284, -14.96615176680016, -28.849266877813307, -43.52700440305836, -21.52027091053759, -12.537356308002124, -47.52574951756552, -27.090418265654648, -24.196651387489162, 0.6909666963603911, -25.786428473482466, -8.6912279793356, -40.9050387731382, 0.7917862838432796, -9.613886985889966, -44.758381672732256, -22.740781406958938, -46.71024056442817, -21.644626649817273, -9.731217647764804, 13.205869645725791, -16.454843884070236, 6.187842795825279, -15.90408619324571, 0.9652642587547078, -16.260280888508973, -3.8696228746207204, -14.226848512700759, -22.061116756234288, -15.830858971874292, -29.44375886065246, 4.117490973923346, -10.76003733877694, 5.8527671005097375, -4.63693768958589, -10.866511960586276, -29.431176215510362, -29.502002720209703, 9.115499600415433, -6.352251194016169, -6.1747419248662485, -15.378378054487065, -14.814041625952047, 6.6237158992421215, 12.302092379364431, -6.44090518587349, -10.43045198244086, 8.350545414228286, -1.1860709040816744, 0.7014551953102526, -6.428462187610375, -23.007207432305268, -14.216722257869659, -1.2825329110868182, -28.29240343756736, 2.737674264574281, 0.09784616248589018, -24.401365415394324, -11.097089634332509, -6.506686601635359, -14.035360857236142, -18.361537989281913, 7.614696053695511, 8.70306039985499, -8.925482775680312, 8.941672690546984, 2.1693643335796082, -27.67666050276932, -16.947560250518013, 3.8398090846165687, 4.965419247598081, -22.098209012301336, -14.28743930398689, -10.912114518879761, 2.256994013871271, -31.24193480094852, -23.54131908571206, -14.415088179448276, -11.712342238229006, 6.068178157099084, -15.067059217167088, -6.852948574053649, 2.1742626846472604, 6.722660282464851, -15.320927187670502, 3.2372885962274296, -15.839187847185823, -17.186876398661653, -21.01089856483608, -6.480327121421855, -0.18963276310801547, -9.988870958582304, -8.245222985580027, 5.447411350408814, -16.464478100473507, 4.511908554374592, 10.235732660032369, 8.233057626047097, 13.930479970783106, -8.768687287535826, 10.573385422962957, 8.200488351286893, 0.6788017723837854, -27.269803173947658, -17.043006057153235, -24.558071068947648, 2.3637698468146056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4233874085371225, "mean_inference_ms": 1.1139725119924615, "mean_action_processing_ms": 0.18171159405915005, "mean_env_wait_ms": 0.0740515002473212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037043094635009766, "StateBufferConnector_ms": 0.002480030059814453, "ViewRequirementAgentConnector_ms": 0.07091653347015381}, "num_episodes": 11, "episode_return_max": 50.02287922127907, "episode_return_min": -34.177433607122694, "episode_return_mean": -8.09398597139297}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 512.3748836619811, "num_env_steps_trained_throughput_per_sec": 512.3748836619811, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 8216.259, "restore_workers_time_ms": 0.017, "training_step_time_ms": 8216.214, "sample_time_ms": 784.144, "learn_time_ms": 7417.832, "learn_throughput": 539.241, "synch_weights_time_ms": 13.786}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 150, "trial_id": "83a5c_00000", "date": "2024-08-10_12-35-12", "timestamp": 1723307712, "time_this_iter_s": 7.811931133270264, "time_total_s": 1274.0340263843536, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fb0c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1274.0340263843536, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 25.645454545454548, "ram_util_percent": 82.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.264016628833044, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5900297920855264, "policy_loss": -0.004125083902747267, "vf_loss": 1.5935320289992783, "vf_explained_var": -0.16988664707809528, "kl": 0.005461882833859188, "entropy": 1.3159593871030857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.909126863069832, "cur_kl_coeff": 4.350084964244162e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1878981788953147, "policy_loss": -0.004385672143447057, "vf_loss": 2.1922838487972816, "vf_explained_var": 0.22990476737419765, "kl": 0.0021459806810592424, "entropy": 0.19603689208161085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "env_runners": {"episode_reward_max": 50.02287922127907, "episode_reward_min": -34.177433607122694, "episode_reward_mean": -8.036948164508871, "episode_len_mean": 381.68, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38168, "policy_reward_min": {"agent_policy": -50.022879221279055, "adversary_policy": -47.52574951756552}, "policy_reward_max": {"agent_policy": 34.17743360712269, "adversary_policy": 56.36003256074176}, "policy_reward_mean": {"agent_policy": 8.036948164508871, "adversary_policy": -8.036948164508871}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.37106710540545, -5.741588049018585, -5.392075625557743, 1.9992313938072872, -13.709635992596706, -3.5703005048449796, 1.3710753912465616, 50.02287922127907, 3.131699711523982, -17.815209150756, -18.878247317150294, -10.157211431611874, -14.229589351476527, 17.234665084660538, -3.017492498896088, -7.544878576212826, -13.976296338705364, 22.56233834528775, -8.649908522545026, -5.036880706745578, -25.030806327436064, 12.390373490602208, 8.901246921611387, -6.596286420089616, -4.307262357949, -16.5642939732713, -0.9048505436614782, -3.055279539865479, -14.234773641987196, 7.978536150576371, -19.401964800814966, 4.095428948880027, -27.20346724734106, -26.14583594377608, 2.2492997605868172, -6.93290833708657, 8.47410103125631, 4.250103347232436, -21.907709322306737, -32.52363765679799, -30.031552912783823, -25.643534826571898, -12.547730888561038, -24.7981333762369, -4.411050351023345, -33.74958153984562, -34.177433607122694, 1.7373259989804897, -5.133500544122452, -7.469410967245501, -10.064951881564847, -18.14398263446751, -22.637308916263372, -3.321273182426797, 0.6079147054619476, -20.148844088048328, -10.193251559897135, -6.2634965594412115, -15.096209840219558, 9.462904139303275, -8.435678584157175, 3.5822372550733057, -2.863503496150061, -18.61196484508745, -14.787468174327088, 1.4177602135300855, -17.749227524863418, -10.27102372943575, -5.373420967793201, -0.11121118791266049, 5.555518512063305, -22.312110376643663, 4.402614166107316, -18.192824158144116, -4.327560252504245, -27.391626943330298, -13.06371520883864, -4.499440530034002, -2.339342944703194, -4.299133452602826, -6.300949625479197, -19.098887481748868, -3.334979942264935, -9.117046972081173, -5.50853337503235, 7.37382060720348, 11.0817687984151, 0.902349067713585, 4.439645061835339, -22.156404615550446, -11.097150611066521, -19.026487272873354, -4.577741416463601, -13.510131070328192, -25.396240033704828, 7.086686487096259, -19.317627702161875, -16.88124065398115, -21.680300884742, -6.64266126846635], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 74, 400, 400, 400, 400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [11.37106710540545, 5.741588049018585, 5.392075625557743, -1.9992313938072908, 13.709635992596708, 3.5703005048449796, -1.3710753912465616, -50.022879221279055, -3.131699711523982, 17.81520915075599, 18.878247317150283, 10.157211431611874, 14.22958935147653, -17.23466508466054, 3.017492498896088, 7.544878576212826, 13.976296338705364, -22.562338345287742, 8.649908522545026, 5.036880706745578, 25.030806327436068, -12.390373490602208, -8.901246921611387, 6.596286420089616, 4.307262357949, 16.564293973271297, 0.9048505436614693, 3.055279539865463, 14.234773641987196, -7.978536150576373, 19.401964800814966, -4.095428948880027, 27.203467247341063, 26.145835943776078, -2.2492997605868172, 6.93290833708657, -8.47410103125631, -4.250103347232436, 21.907709322306733, 32.52363765679797, 30.031552912783827, 25.643534826571905, 12.547730888561038, 24.7981333762369, 4.411050351023338, 33.74958153984563, 34.17743360712269, -1.7373259989805074, 5.133500544122468, 7.469410967245501, 10.064951881564847, 18.143982634467516, 22.637308916263382, 3.321273182426797, -0.6079147054619298, 20.148844088048325, 10.193251559897135, 6.263496559441208, 15.096209840219558, -9.462904139303275, 8.435678584157175, -3.5822372550733057, 2.863503496150061, 18.611964845087456, 14.787468174327088, -1.4177602135300855, 17.749227524863414, 10.27102372943575, 5.373420967793201, 0.11121118791266049, -5.555518512063287, 22.312110376643666, -4.402614166107314, 18.19282415814412, 4.327560252504245, 27.391626943330294, 13.06371520883864, 4.499440530034002, 2.339342944703194, 4.299133452602826, 6.300949625479197, 19.098887481748868, 3.334979942264935, 9.117046972081175, 5.508533375032348, -7.373820607203481, -11.081768798415101, -0.9023490677135655, -4.439645061835339, 22.156404615550443, 11.097150611066521, 19.026487272873354, 4.577741416463601, 13.510131070328196, 25.396240033704824, -7.086686487096259, 19.317627702161886, 16.881240653981152, 21.680300884742003, 6.64266126846635], "policy_adversary_policy_reward": [-15.790968915814947, -6.951165294995953, -6.68317660242753, -4.79999949560964, -2.6193284731578395, -8.164822777957646, -0.495977955386774, 4.494440743001363, -24.833517845872105, -2.5857541393213097, 4.739572061915936, -11.880173071605896, -12.845727799581699, 15.587878582074822, 43.68572588181636, 56.36003256074176, 10.718077225676534, -4.45467780262857, -7.580775148023232, -28.049643153488756, -13.565821510173315, -24.190673124127265, -8.187148277415101, -12.127274585808646, -9.03036425991938, -19.42881444303368, 15.628061537354263, 18.841268631966813, -12.568854945610358, 6.533869947818182, -24.26683142179697, 9.177074269371317, -16.095301888399597, -11.857290789011135, 22.653977216364012, 22.47069947421148, 8.205169254770254, -25.504986299860306, -5.008809285296685, -5.06495212819447, -30.103307290384038, -19.95830536448812, 13.492711038982712, 11.288035942221704, 26.086119019595557, -8.28362517637278, -14.551435567989039, 1.3588627278098073, -5.677514441217781, -2.937010274680219, -9.887015813830203, -23.241572132712392, -0.656091190920435, -1.1536098964025001, 11.464046200850099, -17.574605280581032, -29.315884654477067, 0.846337370502674, 9.343417517823028, 6.613654783329718, -30.56894356743231, -8.234986034197618, -7.620178096207102, 15.811035993967156, -21.9699134544692, -32.43702104021292, -7.833691591858084, -44.45798029569407, 7.0689970456257, -2.5703975244520656, 5.306889617100282, -19.17270629127342, 5.405418925806025, 11.542783136706596, 13.985704692107156, -5.485497997642284, -14.96615176680016, -28.849266877813307, -43.52700440305836, -21.52027091053759, -12.537356308002124, -47.52574951756552, -27.090418265654648, -24.196651387489162, 0.6909666963603911, -25.786428473482466, -8.6912279793356, -40.9050387731382, 0.7917862838432796, -9.613886985889966, -44.758381672732256, -22.740781406958938, -46.71024056442817, -21.644626649817273, -9.731217647764804, 13.205869645725791, -16.454843884070236, 6.187842795825279, -15.90408619324571, 0.9652642587547078, -16.260280888508973, -3.8696228746207204, -14.226848512700759, -22.061116756234288, -15.830858971874292, -29.44375886065246, 4.117490973923346, -10.76003733877694, 5.8527671005097375, -4.63693768958589, -10.866511960586276, -29.431176215510362, -29.502002720209703, 9.115499600415433, -6.352251194016169, -6.1747419248662485, -15.378378054487065, -14.814041625952047, 6.6237158992421215, 12.302092379364431, -6.44090518587349, -10.43045198244086, 8.350545414228286, -1.1860709040816744, 0.7014551953102526, -6.428462187610375, -23.007207432305268, -14.216722257869659, -1.2825329110868182, -28.29240343756736, 2.737674264574281, 0.09784616248589018, -24.401365415394324, -11.097089634332509, -6.506686601635359, -14.035360857236142, -18.361537989281913, 7.614696053695511, 8.70306039985499, -8.925482775680312, 8.941672690546984, 2.1693643335796082, -27.67666050276932, -16.947560250518013, 3.8398090846165687, 4.965419247598081, -22.098209012301336, -14.28743930398689, -10.912114518879761, 2.256994013871271, -31.24193480094852, -23.54131908571206, -14.415088179448276, -11.712342238229006, 6.068178157099084, -15.067059217167088, -6.852948574053649, 2.1742626846472604, 6.722660282464851, -15.320927187670502, 3.2372885962274296, -15.839187847185823, -17.186876398661653, -21.01089856483608, -6.480327121421855, -0.18963276310801547, -9.988870958582304, -8.245222985580027, 5.447411350408814, -16.464478100473507, 4.511908554374592, 10.235732660032369, 8.233057626047097, 13.930479970783106, -8.768687287535826, 10.573385422962957, 8.200488351286893, 0.6788017723837854, -27.269803173947658, -17.043006057153235, -24.558071068947648, 2.3637698468146056, -24.772825692351564, -13.280148853395147, -9.009492621305942, -0.14599021162126036, -12.443844447775025, -14.576417692881368, -27.80592781870867, -22.986552248700978, 1.7364010332109245, 12.436971940981593, -23.771871434520143, -14.863383969803621, -27.215121508204824, -6.5473597997574835, -27.46966405490312, -15.890937714580886, -8.504048371836312, -4.781274165096388]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4232007372172441, "mean_inference_ms": 1.1133360227689, "mean_action_processing_ms": 0.18161991853507126, "mean_env_wait_ms": 0.07400500337767556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036122798919677734, "StateBufferConnector_ms": 0.0024453401565551758, "ViewRequirementAgentConnector_ms": 0.07000255584716797}, "num_episodes": 9, "episode_return_max": 50.02287922127907, "episode_return_min": -34.177433607122694, "episode_return_mean": -8.036948164508871}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.4241916930143, "num_env_steps_trained_throughput_per_sec": 494.4241916930143, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 1812000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1812000, "timers": {"training_iteration_time_ms": 8232.736, "restore_workers_time_ms": 0.016, "training_step_time_ms": 8232.691, "sample_time_ms": 787.43, "learn_time_ms": 7431.245, "learn_throughput": 538.268, "synch_weights_time_ms": 13.554}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 1812000, "num_agent_steps_trained": 1812000}, "done": false, "training_iteration": 151, "trial_id": "83a5c_00000", "date": "2024-08-10_12-35-20", "timestamp": 1723307720, "time_this_iter_s": 8.128475904464722, "time_total_s": 1282.1625022888184, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc74a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1282.1625022888184, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 32.054545454545455, "ram_util_percent": 83.23636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3147931281536342, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5685791769671062, "policy_loss": -0.004518745146031496, "vf_loss": 1.5722055824030012, "vf_explained_var": -0.032628132395012666, "kl": 0.007825128174673355, "entropy": 1.3433966952026206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4856046720718346, "cur_kl_coeff": 2.175042482122081e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1757869567722081, "policy_loss": -0.009699108974261132, "vf_loss": 1.1854860697562495, "vf_explained_var": 0.6749299503862858, "kl": 0.0074942312740062765, "entropy": 0.20443794562791784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 22.56233834528775, "episode_reward_min": -34.177433607122694, "episode_reward_mean": -8.366062723894391, "episode_len_mean": 380.96, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38096, "policy_reward_min": {"agent_policy": -22.562338345287742, "adversary_policy": -47.52574951756552}, "policy_reward_max": {"agent_policy": 34.17743360712269, "adversary_policy": 26.086119019595557}, "policy_reward_mean": {"agent_policy": 8.366062723894393, "adversary_policy": -8.366062723894393}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.157211431611874, -14.229589351476527, 17.234665084660538, -3.017492498896088, -7.544878576212826, -13.976296338705364, 22.56233834528775, -8.649908522545026, -5.036880706745578, -25.030806327436064, 12.390373490602208, 8.901246921611387, -6.596286420089616, -4.307262357949, -16.5642939732713, -0.9048505436614782, -3.055279539865479, -14.234773641987196, 7.978536150576371, -19.401964800814966, 4.095428948880027, -27.20346724734106, -26.14583594377608, 2.2492997605868172, -6.93290833708657, 8.47410103125631, 4.250103347232436, -21.907709322306737, -32.52363765679799, -30.031552912783823, -25.643534826571898, -12.547730888561038, -24.7981333762369, -4.411050351023345, -33.74958153984562, -34.177433607122694, 1.7373259989804897, -5.133500544122452, -7.469410967245501, -10.064951881564847, -18.14398263446751, -22.637308916263372, -3.321273182426797, 0.6079147054619476, -20.148844088048328, -10.193251559897135, -6.2634965594412115, -15.096209840219558, 9.462904139303275, -8.435678584157175, 3.5822372550733057, -2.863503496150061, -18.61196484508745, -14.787468174327088, 1.4177602135300855, -17.749227524863418, -10.27102372943575, -5.373420967793201, -0.11121118791266049, 5.555518512063305, -22.312110376643663, 4.402614166107316, -18.192824158144116, -4.327560252504245, -27.391626943330298, -13.06371520883864, -4.499440530034002, -2.339342944703194, -4.299133452602826, -6.300949625479197, -19.098887481748868, -3.334979942264935, -9.117046972081173, -5.50853337503235, 7.37382060720348, 11.0817687984151, 0.902349067713585, 4.439645061835339, -22.156404615550446, -11.097150611066521, -19.026487272873354, -4.577741416463601, -13.510131070328192, -25.396240033704828, 7.086686487096259, -19.317627702161875, -16.88124065398115, -21.680300884742, -6.64266126846635, 7.430404351282288, -0.11588974657037099, -4.527141834602588, 4.399939097048868, 5.446676201791885, -15.66695541602942, -9.77179475870106, -17.858840569167413, -8.175938503040207, -13.751942792515603, -0.2732099955213847], "episode_lengths": [400, 400, 400, 400, 400, 400, 25, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2], "policy_agent_policy_reward": [10.157211431611874, 14.22958935147653, -17.23466508466054, 3.017492498896088, 7.544878576212826, 13.976296338705364, -22.562338345287742, 8.649908522545026, 5.036880706745578, 25.030806327436068, -12.390373490602208, -8.901246921611387, 6.596286420089616, 4.307262357949, 16.564293973271297, 0.9048505436614693, 3.055279539865463, 14.234773641987196, -7.978536150576373, 19.401964800814966, -4.095428948880027, 27.203467247341063, 26.145835943776078, -2.2492997605868172, 6.93290833708657, -8.47410103125631, -4.250103347232436, 21.907709322306733, 32.52363765679797, 30.031552912783827, 25.643534826571905, 12.547730888561038, 24.7981333762369, 4.411050351023338, 33.74958153984563, 34.17743360712269, -1.7373259989805074, 5.133500544122468, 7.469410967245501, 10.064951881564847, 18.143982634467516, 22.637308916263382, 3.321273182426797, -0.6079147054619298, 20.148844088048325, 10.193251559897135, 6.263496559441208, 15.096209840219558, -9.462904139303275, 8.435678584157175, -3.5822372550733057, 2.863503496150061, 18.611964845087456, 14.787468174327088, -1.4177602135300855, 17.749227524863414, 10.27102372943575, 5.373420967793201, 0.11121118791266049, -5.555518512063287, 22.312110376643666, -4.402614166107314, 18.19282415814412, 4.327560252504245, 27.391626943330294, 13.06371520883864, 4.499440530034002, 2.339342944703194, 4.299133452602826, 6.300949625479197, 19.098887481748868, 3.334979942264935, 9.117046972081175, 5.508533375032348, -7.373820607203481, -11.081768798415101, -0.9023490677135655, -4.439645061835339, 22.156404615550443, 11.097150611066521, 19.026487272873354, 4.577741416463601, 13.510131070328196, 25.396240033704824, -7.086686487096259, 19.317627702161886, 16.881240653981152, 21.680300884742003, 6.64266126846635, -7.430404351282288, 0.11588974657037099, 4.527141834602588, -4.399939097048868, -5.446676201791885, 15.66695541602942, 9.77179475870106, 17.858840569167413, 8.175938503040207, 13.751942792515603, 0.27320999552138453], "policy_adversary_policy_reward": [-8.187148277415101, -12.127274585808646, -9.03036425991938, -19.42881444303368, 15.628061537354263, 18.841268631966813, -12.568854945610358, 6.533869947818182, -24.26683142179697, 9.177074269371317, -16.095301888399597, -11.857290789011135, 22.653977216364012, 22.47069947421148, 8.205169254770254, -25.504986299860306, -5.008809285296685, -5.06495212819447, -30.103307290384038, -19.95830536448812, 13.492711038982712, 11.288035942221704, 26.086119019595557, -8.28362517637278, -14.551435567989039, 1.3588627278098073, -5.677514441217781, -2.937010274680219, -9.887015813830203, -23.241572132712392, -0.656091190920435, -1.1536098964025001, 11.464046200850099, -17.574605280581032, -29.315884654477067, 0.846337370502674, 9.343417517823028, 6.613654783329718, -30.56894356743231, -8.234986034197618, -7.620178096207102, 15.811035993967156, -21.9699134544692, -32.43702104021292, -7.833691591858084, -44.45798029569407, 7.0689970456257, -2.5703975244520656, 5.306889617100282, -19.17270629127342, 5.405418925806025, 11.542783136706596, 13.985704692107156, -5.485497997642284, -14.96615176680016, -28.849266877813307, -43.52700440305836, -21.52027091053759, -12.537356308002124, -47.52574951756552, -27.090418265654648, -24.196651387489162, 0.6909666963603911, -25.786428473482466, -8.6912279793356, -40.9050387731382, 0.7917862838432796, -9.613886985889966, -44.758381672732256, -22.740781406958938, -46.71024056442817, -21.644626649817273, -9.731217647764804, 13.205869645725791, -16.454843884070236, 6.187842795825279, -15.90408619324571, 0.9652642587547078, -16.260280888508973, -3.8696228746207204, -14.226848512700759, -22.061116756234288, -15.830858971874292, -29.44375886065246, 4.117490973923346, -10.76003733877694, 5.8527671005097375, -4.63693768958589, -10.866511960586276, -29.431176215510362, -29.502002720209703, 9.115499600415433, -6.352251194016169, -6.1747419248662485, -15.378378054487065, -14.814041625952047, 6.6237158992421215, 12.302092379364431, -6.44090518587349, -10.43045198244086, 8.350545414228286, -1.1860709040816744, 0.7014551953102526, -6.428462187610375, -23.007207432305268, -14.216722257869659, -1.2825329110868182, -28.29240343756736, 2.737674264574281, 0.09784616248589018, -24.401365415394324, -11.097089634332509, -6.506686601635359, -14.035360857236142, -18.361537989281913, 7.614696053695511, 8.70306039985499, -8.925482775680312, 8.941672690546984, 2.1693643335796082, -27.67666050276932, -16.947560250518013, 3.8398090846165687, 4.965419247598081, -22.098209012301336, -14.28743930398689, -10.912114518879761, 2.256994013871271, -31.24193480094852, -23.54131908571206, -14.415088179448276, -11.712342238229006, 6.068178157099084, -15.067059217167088, -6.852948574053649, 2.1742626846472604, 6.722660282464851, -15.320927187670502, 3.2372885962274296, -15.839187847185823, -17.186876398661653, -21.01089856483608, -6.480327121421855, -0.18963276310801547, -9.988870958582304, -8.245222985580027, 5.447411350408814, -16.464478100473507, 4.511908554374592, 10.235732660032369, 8.233057626047097, 13.930479970783106, -8.768687287535826, 10.573385422962957, 8.200488351286893, 0.6788017723837854, -27.269803173947658, -17.043006057153235, -24.558071068947648, 2.3637698468146056, -24.772825692351564, -13.280148853395147, -9.009492621305942, -0.14599021162126036, -12.443844447775025, -14.576417692881368, -27.80592781870867, -22.986552248700978, 1.7364010332109245, 12.436971940981593, -23.771871434520143, -14.863383969803621, -27.215121508204824, -6.5473597997574835, -27.46966405490312, -15.890937714580886, -8.504048371836312, -4.781274165096388, 10.155342564401018, 4.705466138163558, 12.262113878592473, -12.493893371733215, -5.102997459318047, -3.9512862098871295, 0.25428781341874185, 8.545590380678995, 5.862386210513925, 5.030966193069844, -20.402517313310764, -10.931393518748074, -0.5536444131414555, -18.989945104260663, -11.50315465066872, -24.21452648766611, -9.732121083230599, -6.619755922849816, -5.413752580218858, -22.090133004812348, 2.215349289961428, -2.761769281004197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42305997397524725, "mean_inference_ms": 1.1127631422873037, "mean_action_processing_ms": 0.18151713658488802, "mean_env_wait_ms": 0.07395490628682361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036733150482177734, "StateBufferConnector_ms": 0.0025358200073242188, "ViewRequirementAgentConnector_ms": 0.07037246227264404}, "num_episodes": 11, "episode_return_max": 22.56233834528775, "episode_return_min": -34.177433607122694, "episode_return_mean": -8.366062723894391}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.5169730788791, "num_env_steps_trained_throughput_per_sec": 482.5169730788791, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 8231.831, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8231.787, "sample_time_ms": 795.089, "learn_time_ms": 7423.011, "learn_throughput": 538.865, "synch_weights_time_ms": 13.22}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 152, "trial_id": "83a5c_00000", "date": "2024-08-10_12-35-29", "timestamp": 1723307729, "time_this_iter_s": 8.297530174255371, "time_total_s": 1290.4600324630737, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcfdee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1290.4600324630737, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 33.24999999999999, "ram_util_percent": 83.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.445212296392552, "cur_kl_coeff": 0.11403486728668216, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6396580271935337, "policy_loss": -0.005382582889352408, "vf_loss": 1.6444859561466036, "vf_explained_var": 0.1144851528147541, "kl": 0.004863904654281186, "entropy": 1.2900456541429752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8667898112908006, "cur_kl_coeff": 2.175042482122081e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0777266326049966, "policy_loss": -0.005936303577618674, "vf_loss": 2.083662931621075, "vf_explained_var": 0.39425685312598946, "kl": 0.0026191831064276286, "entropy": 0.21477258551555375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "env_runners": {"episode_reward_max": 11.0817687984151, "episode_reward_min": -34.177433607122694, "episode_reward_mean": -9.15356937365726, "episode_len_mean": 376.8, "episode_media": {}, "episodes_this_iter": 14, "episodes_timesteps_total": 37680, "policy_reward_min": {"agent_policy": -11.081768798415101, "adversary_policy": -47.52574951756552}, "policy_reward_max": {"agent_policy": 34.17743360712269, "adversary_policy": 15.811035993967156}, "policy_reward_mean": {"agent_policy": 9.15356937365726, "adversary_policy": -9.153569373657263}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.5642939732713, -0.9048505436614782, -3.055279539865479, -14.234773641987196, 7.978536150576371, -19.401964800814966, 4.095428948880027, -27.20346724734106, -26.14583594377608, 2.2492997605868172, -6.93290833708657, 8.47410103125631, 4.250103347232436, -21.907709322306737, -32.52363765679799, -30.031552912783823, -25.643534826571898, -12.547730888561038, -24.7981333762369, -4.411050351023345, -33.74958153984562, -34.177433607122694, 1.7373259989804897, -5.133500544122452, -7.469410967245501, -10.064951881564847, -18.14398263446751, -22.637308916263372, -3.321273182426797, 0.6079147054619476, -20.148844088048328, -10.193251559897135, -6.2634965594412115, -15.096209840219558, 9.462904139303275, -8.435678584157175, 3.5822372550733057, -2.863503496150061, -18.61196484508745, -14.787468174327088, 1.4177602135300855, -17.749227524863418, -10.27102372943575, -5.373420967793201, -0.11121118791266049, 5.555518512063305, -22.312110376643663, 4.402614166107316, -18.192824158144116, -4.327560252504245, -27.391626943330298, -13.06371520883864, -4.499440530034002, -2.339342944703194, -4.299133452602826, -6.300949625479197, -19.098887481748868, -3.334979942264935, -9.117046972081173, -5.50853337503235, 7.37382060720348, 11.0817687984151, 0.902349067713585, 4.439645061835339, -22.156404615550446, -11.097150611066521, -19.026487272873354, -4.577741416463601, -13.510131070328192, -25.396240033704828, 7.086686487096259, -19.317627702161875, -16.88124065398115, -21.680300884742, -6.64266126846635, 7.430404351282288, -0.11588974657037099, -4.527141834602588, 4.399939097048868, 5.446676201791885, -15.66695541602942, -9.77179475870106, -17.858840569167413, -8.175938503040207, -13.751942792515603, -0.2732099955213847, -4.903711808974959, -9.593069679462591, -17.393917990762116, -0.2970355861135445, 1.719596796910006, -9.889367225120553, -29.30053923073974, -13.237185424240295, 4.436724634056612, -6.29627978881132, -14.623084861485744, -10.547908933305553, -10.931704728745933, 4.648830161002579], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 3, 400, 400, 400, 6, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [16.564293973271297, 0.9048505436614693, 3.055279539865463, 14.234773641987196, -7.978536150576373, 19.401964800814966, -4.095428948880027, 27.203467247341063, 26.145835943776078, -2.2492997605868172, 6.93290833708657, -8.47410103125631, -4.250103347232436, 21.907709322306733, 32.52363765679797, 30.031552912783827, 25.643534826571905, 12.547730888561038, 24.7981333762369, 4.411050351023338, 33.74958153984563, 34.17743360712269, -1.7373259989805074, 5.133500544122468, 7.469410967245501, 10.064951881564847, 18.143982634467516, 22.637308916263382, 3.321273182426797, -0.6079147054619298, 20.148844088048325, 10.193251559897135, 6.263496559441208, 15.096209840219558, -9.462904139303275, 8.435678584157175, -3.5822372550733057, 2.863503496150061, 18.611964845087456, 14.787468174327088, -1.4177602135300855, 17.749227524863414, 10.27102372943575, 5.373420967793201, 0.11121118791266049, -5.555518512063287, 22.312110376643666, -4.402614166107314, 18.19282415814412, 4.327560252504245, 27.391626943330294, 13.06371520883864, 4.499440530034002, 2.339342944703194, 4.299133452602826, 6.300949625479197, 19.098887481748868, 3.334979942264935, 9.117046972081175, 5.508533375032348, -7.373820607203481, -11.081768798415101, -0.9023490677135655, -4.439645061835339, 22.156404615550443, 11.097150611066521, 19.026487272873354, 4.577741416463601, 13.510131070328196, 25.396240033704824, -7.086686487096259, 19.317627702161886, 16.881240653981152, 21.680300884742003, 6.64266126846635, -7.430404351282288, 0.11588974657037099, 4.527141834602588, -4.399939097048868, -5.446676201791885, 15.66695541602942, 9.77179475870106, 17.858840569167413, 8.175938503040207, 13.751942792515603, 0.27320999552138453, 4.903711808974959, 9.593069679462587, 17.393917990762116, 0.2970355861135445, -1.719596796910006, 9.889367225120557, 29.300539230739744, 13.237185424240288, -4.436724634056612, 6.29627978881132, 14.623084861485744, 10.547908933305555, 10.931704728745933, -4.648830161002579], "policy_adversary_policy_reward": [-9.887015813830203, -23.241572132712392, -0.656091190920435, -1.1536098964025001, 11.464046200850099, -17.574605280581032, -29.315884654477067, 0.846337370502674, 9.343417517823028, 6.613654783329718, -30.56894356743231, -8.234986034197618, -7.620178096207102, 15.811035993967156, -21.9699134544692, -32.43702104021292, -7.833691591858084, -44.45798029569407, 7.0689970456257, -2.5703975244520656, 5.306889617100282, -19.17270629127342, 5.405418925806025, 11.542783136706596, 13.985704692107156, -5.485497997642284, -14.96615176680016, -28.849266877813307, -43.52700440305836, -21.52027091053759, -12.537356308002124, -47.52574951756552, -27.090418265654648, -24.196651387489162, 0.6909666963603911, -25.786428473482466, -8.6912279793356, -40.9050387731382, 0.7917862838432796, -9.613886985889966, -44.758381672732256, -22.740781406958938, -46.71024056442817, -21.644626649817273, -9.731217647764804, 13.205869645725791, -16.454843884070236, 6.187842795825279, -15.90408619324571, 0.9652642587547078, -16.260280888508973, -3.8696228746207204, -14.226848512700759, -22.061116756234288, -15.830858971874292, -29.44375886065246, 4.117490973923346, -10.76003733877694, 5.8527671005097375, -4.63693768958589, -10.866511960586276, -29.431176215510362, -29.502002720209703, 9.115499600415433, -6.352251194016169, -6.1747419248662485, -15.378378054487065, -14.814041625952047, 6.6237158992421215, 12.302092379364431, -6.44090518587349, -10.43045198244086, 8.350545414228286, -1.1860709040816744, 0.7014551953102526, -6.428462187610375, -23.007207432305268, -14.216722257869659, -1.2825329110868182, -28.29240343756736, 2.737674264574281, 0.09784616248589018, -24.401365415394324, -11.097089634332509, -6.506686601635359, -14.035360857236142, -18.361537989281913, 7.614696053695511, 8.70306039985499, -8.925482775680312, 8.941672690546984, 2.1693643335796082, -27.67666050276932, -16.947560250518013, 3.8398090846165687, 4.965419247598081, -22.098209012301336, -14.28743930398689, -10.912114518879761, 2.256994013871271, -31.24193480094852, -23.54131908571206, -14.415088179448276, -11.712342238229006, 6.068178157099084, -15.067059217167088, -6.852948574053649, 2.1742626846472604, 6.722660282464851, -15.320927187670502, 3.2372885962274296, -15.839187847185823, -17.186876398661653, -21.01089856483608, -6.480327121421855, -0.18963276310801547, -9.988870958582304, -8.245222985580027, 5.447411350408814, -16.464478100473507, 4.511908554374592, 10.235732660032369, 8.233057626047097, 13.930479970783106, -8.768687287535826, 10.573385422962957, 8.200488351286893, 0.6788017723837854, -27.269803173947658, -17.043006057153235, -24.558071068947648, 2.3637698468146056, -24.772825692351564, -13.280148853395147, -9.009492621305942, -0.14599021162126036, -12.443844447775025, -14.576417692881368, -27.80592781870867, -22.986552248700978, 1.7364010332109245, 12.436971940981593, -23.771871434520143, -14.863383969803621, -27.215121508204824, -6.5473597997574835, -27.46966405490312, -15.890937714580886, -8.504048371836312, -4.781274165096388, 10.155342564401018, 4.705466138163558, 12.262113878592473, -12.493893371733215, -5.102997459318047, -3.9512862098871295, 0.25428781341874185, 8.545590380678995, 5.862386210513925, 5.030966193069844, -20.402517313310764, -10.931393518748074, -0.5536444131414555, -18.989945104260663, -11.50315465066872, -24.21452648766611, -9.732121083230599, -6.619755922849816, -5.413752580218858, -22.090133004812348, 2.215349289961428, -2.761769281004197, -9.08513232866677, -0.7222912892831488, -5.7541367246198085, -13.432002634305373, -8.821182800574746, -25.966653180949486, 7.7303242593833446, -8.324395431610434, 5.026230295829394, -1.5870367020093816, -8.796538125259366, -10.98219632498175, -31.150245384510498, -27.45083307696901, -10.300953363063051, -16.17341748541751, 0.6999932910152253, 8.173455977098, -4.287133954534259, -8.305425623088382, -13.720457222081244, -15.525712500890243, -11.299593193120316, -9.79622467349079, 3.9144172296099313, -25.777826687101797, 6.648435315882601, 2.649225006122556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42275627760441237, "mean_inference_ms": 1.1120844713225806, "mean_action_processing_ms": 0.18142898172116312, "mean_env_wait_ms": 0.07388801689426396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036586523056030273, "StateBufferConnector_ms": 0.0025969743728637695, "ViewRequirementAgentConnector_ms": 0.06969976425170898}, "num_episodes": 14, "episode_return_max": 11.0817687984151, "episode_return_min": -34.177433607122694, "episode_return_mean": -9.15356937365726}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.1046893229126, "num_env_steps_trained_throughput_per_sec": 428.1046893229126, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 1836000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1836000, "timers": {"training_iteration_time_ms": 8358.384, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8358.341, "sample_time_ms": 809.921, "learn_time_ms": 7535.31, "learn_throughput": 530.834, "synch_weights_time_ms": 12.629}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 1836000, "num_agent_steps_trained": 1836000}, "done": false, "training_iteration": 153, "trial_id": "83a5c_00000", "date": "2024-08-10_12-35-38", "timestamp": 1723307738, "time_this_iter_s": 9.388718128204346, "time_total_s": 1299.848750591278, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcfdd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1299.848750591278, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 49.06153846153846, "ram_util_percent": 83.28461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5522154516643947, "cur_kl_coeff": 0.05701743364334108, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9565468846174774, "policy_loss": -0.007212447058828301, "vf_loss": 1.9631050401894503, "vf_explained_var": 0.06312882881315927, "kl": 0.011475356252246634, "entropy": 1.3628315910460458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.793055898944537, "cur_kl_coeff": 1.0875212410610405e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0564765336612862, "policy_loss": -0.003075753927017407, "vf_loss": 2.05955228805542, "vf_explained_var": 0.6873915592829386, "kl": 0.001609947399917344, "entropy": 0.2198005222560217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "env_runners": {"episode_reward_max": 11.0817687984151, "episode_reward_min": -34.177433607122694, "episode_reward_mean": -8.669047093226716, "episode_len_mean": 376.8, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37680, "policy_reward_min": {"agent_policy": -11.081768798415101, "adversary_policy": -47.52574951756552}, "policy_reward_max": {"agent_policy": 34.17743360712269, "adversary_policy": 18.66878962767936}, "policy_reward_mean": {"agent_policy": 8.669047093226716, "adversary_policy": -8.669047093226716}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.2492997605868172, -6.93290833708657, 8.47410103125631, 4.250103347232436, -21.907709322306737, -32.52363765679799, -30.031552912783823, -25.643534826571898, -12.547730888561038, -24.7981333762369, -4.411050351023345, -33.74958153984562, -34.177433607122694, 1.7373259989804897, -5.133500544122452, -7.469410967245501, -10.064951881564847, -18.14398263446751, -22.637308916263372, -3.321273182426797, 0.6079147054619476, -20.148844088048328, -10.193251559897135, -6.2634965594412115, -15.096209840219558, 9.462904139303275, -8.435678584157175, 3.5822372550733057, -2.863503496150061, -18.61196484508745, -14.787468174327088, 1.4177602135300855, -17.749227524863418, -10.27102372943575, -5.373420967793201, -0.11121118791266049, 5.555518512063305, -22.312110376643663, 4.402614166107316, -18.192824158144116, -4.327560252504245, -27.391626943330298, -13.06371520883864, -4.499440530034002, -2.339342944703194, -4.299133452602826, -6.300949625479197, -19.098887481748868, -3.334979942264935, -9.117046972081173, -5.50853337503235, 7.37382060720348, 11.0817687984151, 0.902349067713585, 4.439645061835339, -22.156404615550446, -11.097150611066521, -19.026487272873354, -4.577741416463601, -13.510131070328192, -25.396240033704828, 7.086686487096259, -19.317627702161875, -16.88124065398115, -21.680300884742, -6.64266126846635, 7.430404351282288, -0.11588974657037099, -4.527141834602588, 4.399939097048868, 5.446676201791885, -15.66695541602942, -9.77179475870106, -17.858840569167413, -8.175938503040207, -13.751942792515603, -0.2732099955213847, -4.903711808974959, -9.593069679462591, -17.393917990762116, -0.2970355861135445, 1.719596796910006, -9.889367225120553, -29.30053923073974, -13.237185424240295, 4.436724634056612, -6.29627978881132, -14.623084861485744, -10.547908933305553, -10.931704728745933, 4.648830161002579, -1.3313177022123277, -20.73990632138223, -0.029631378495363236, 4.811652435405055, -10.610668823739083, 1.9642603009392854, -5.802706097252489, -18.02184546740717, 2.7758905059377312], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 3, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-2.2492997605868172, 6.93290833708657, -8.47410103125631, -4.250103347232436, 21.907709322306733, 32.52363765679797, 30.031552912783827, 25.643534826571905, 12.547730888561038, 24.7981333762369, 4.411050351023338, 33.74958153984563, 34.17743360712269, -1.7373259989805074, 5.133500544122468, 7.469410967245501, 10.064951881564847, 18.143982634467516, 22.637308916263382, 3.321273182426797, -0.6079147054619298, 20.148844088048325, 10.193251559897135, 6.263496559441208, 15.096209840219558, -9.462904139303275, 8.435678584157175, -3.5822372550733057, 2.863503496150061, 18.611964845087456, 14.787468174327088, -1.4177602135300855, 17.749227524863414, 10.27102372943575, 5.373420967793201, 0.11121118791266049, -5.555518512063287, 22.312110376643666, -4.402614166107314, 18.19282415814412, 4.327560252504245, 27.391626943330294, 13.06371520883864, 4.499440530034002, 2.339342944703194, 4.299133452602826, 6.300949625479197, 19.098887481748868, 3.334979942264935, 9.117046972081175, 5.508533375032348, -7.373820607203481, -11.081768798415101, -0.9023490677135655, -4.439645061835339, 22.156404615550443, 11.097150611066521, 19.026487272873354, 4.577741416463601, 13.510131070328196, 25.396240033704824, -7.086686487096259, 19.317627702161886, 16.881240653981152, 21.680300884742003, 6.64266126846635, -7.430404351282288, 0.11588974657037099, 4.527141834602588, -4.399939097048868, -5.446676201791885, 15.66695541602942, 9.77179475870106, 17.858840569167413, 8.175938503040207, 13.751942792515603, 0.27320999552138453, 4.903711808974959, 9.593069679462587, 17.393917990762116, 0.2970355861135445, -1.719596796910006, 9.889367225120557, 29.300539230739744, 13.237185424240288, -4.436724634056612, 6.29627978881132, 14.623084861485744, 10.547908933305555, 10.931704728745933, -4.648830161002579, 1.3313177022123153, 20.739906321382232, 0.029631378495363236, -4.811652435405055, 10.610668823739083, -1.9642603009392836, 5.802706097252489, 18.02184546740717, -2.7758905059377312], "policy_adversary_policy_reward": [7.0689970456257, -2.5703975244520656, 5.306889617100282, -19.17270629127342, 5.405418925806025, 11.542783136706596, 13.985704692107156, -5.485497997642284, -14.96615176680016, -28.849266877813307, -43.52700440305836, -21.52027091053759, -12.537356308002124, -47.52574951756552, -27.090418265654648, -24.196651387489162, 0.6909666963603911, -25.786428473482466, -8.6912279793356, -40.9050387731382, 0.7917862838432796, -9.613886985889966, -44.758381672732256, -22.740781406958938, -46.71024056442817, -21.644626649817273, -9.731217647764804, 13.205869645725791, -16.454843884070236, 6.187842795825279, -15.90408619324571, 0.9652642587547078, -16.260280888508973, -3.8696228746207204, -14.226848512700759, -22.061116756234288, -15.830858971874292, -29.44375886065246, 4.117490973923346, -10.76003733877694, 5.8527671005097375, -4.63693768958589, -10.866511960586276, -29.431176215510362, -29.502002720209703, 9.115499600415433, -6.352251194016169, -6.1747419248662485, -15.378378054487065, -14.814041625952047, 6.6237158992421215, 12.302092379364431, -6.44090518587349, -10.43045198244086, 8.350545414228286, -1.1860709040816744, 0.7014551953102526, -6.428462187610375, -23.007207432305268, -14.216722257869659, -1.2825329110868182, -28.29240343756736, 2.737674264574281, 0.09784616248589018, -24.401365415394324, -11.097089634332509, -6.506686601635359, -14.035360857236142, -18.361537989281913, 7.614696053695511, 8.70306039985499, -8.925482775680312, 8.941672690546984, 2.1693643335796082, -27.67666050276932, -16.947560250518013, 3.8398090846165687, 4.965419247598081, -22.098209012301336, -14.28743930398689, -10.912114518879761, 2.256994013871271, -31.24193480094852, -23.54131908571206, -14.415088179448276, -11.712342238229006, 6.068178157099084, -15.067059217167088, -6.852948574053649, 2.1742626846472604, 6.722660282464851, -15.320927187670502, 3.2372885962274296, -15.839187847185823, -17.186876398661653, -21.01089856483608, -6.480327121421855, -0.18963276310801547, -9.988870958582304, -8.245222985580027, 5.447411350408814, -16.464478100473507, 4.511908554374592, 10.235732660032369, 8.233057626047097, 13.930479970783106, -8.768687287535826, 10.573385422962957, 8.200488351286893, 0.6788017723837854, -27.269803173947658, -17.043006057153235, -24.558071068947648, 2.3637698468146056, -24.772825692351564, -13.280148853395147, -9.009492621305942, -0.14599021162126036, -12.443844447775025, -14.576417692881368, -27.80592781870867, -22.986552248700978, 1.7364010332109245, 12.436971940981593, -23.771871434520143, -14.863383969803621, -27.215121508204824, -6.5473597997574835, -27.46966405490312, -15.890937714580886, -8.504048371836312, -4.781274165096388, 10.155342564401018, 4.705466138163558, 12.262113878592473, -12.493893371733215, -5.102997459318047, -3.9512862098871295, 0.25428781341874185, 8.545590380678995, 5.862386210513925, 5.030966193069844, -20.402517313310764, -10.931393518748074, -0.5536444131414555, -18.989945104260663, -11.50315465066872, -24.21452648766611, -9.732121083230599, -6.619755922849816, -5.413752580218858, -22.090133004812348, 2.215349289961428, -2.761769281004197, -9.08513232866677, -0.7222912892831488, -5.7541367246198085, -13.432002634305373, -8.821182800574746, -25.966653180949486, 7.7303242593833446, -8.324395431610434, 5.026230295829394, -1.5870367020093816, -8.796538125259366, -10.98219632498175, -31.150245384510498, -27.45083307696901, -10.300953363063051, -16.17341748541751, 0.6999932910152253, 8.173455977098, -4.287133954534259, -8.305425623088382, -13.720457222081244, -15.525712500890243, -11.299593193120316, -9.79622467349079, 3.9144172296099313, -25.777826687101797, 6.648435315882601, 2.649225006122556, 0.852608265538759, -3.5152436699633984, -15.985114487171053, -25.494698155593408, 18.66878962767936, -18.728052384670086, 2.562836237767179, 7.06046863304293, -10.34848344221803, -10.872854205260136, 6.454411166401819, -2.5258905645232517, 1.0466022597318343, -12.652014454236813, -26.710696709142802, -9.332994225671545, 1.6854177402754473, 3.866363271600015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4226460961235338, "mean_inference_ms": 1.111724982962033, "mean_action_processing_ms": 0.18134336357148292, "mean_env_wait_ms": 0.07387020672515325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036466121673583984, "StateBufferConnector_ms": 0.002573370933532715, "ViewRequirementAgentConnector_ms": 0.07158994674682617}, "num_episodes": 9, "episode_return_max": 11.0817687984151, "episode_return_min": -34.177433607122694, "episode_return_mean": -8.669047093226716}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.0811512908574, "num_env_steps_trained_throughput_per_sec": 496.0811512908574, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 1848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1848000, "timers": {"training_iteration_time_ms": 8289.688, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8289.647, "sample_time_ms": 807.811, "learn_time_ms": 7468.614, "learn_throughput": 535.575, "synch_weights_time_ms": 12.73}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "done": false, "training_iteration": 154, "trial_id": "83a5c_00000", "date": "2024-08-10_12-35-46", "timestamp": 1723307746, "time_this_iter_s": 8.069414138793945, "time_total_s": 1307.918164730072, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc8bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1307.918164730072, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 30.83333333333333, "ram_util_percent": 82.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8166266288391495, "cur_kl_coeff": 0.05701743364334108, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0685376049980286, "policy_loss": -0.006680286185761726, "vf_loss": 2.074691453434172, "vf_explained_var": 0.09295339000918877, "kl": 0.009233024116259857, "entropy": 1.3547352535384043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.3618712479248645, "cur_kl_coeff": 5.4376062053052026e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.179246529315909, "policy_loss": -0.006879429161684433, "vf_loss": 2.186125964174668, "vf_explained_var": 0.40927391896645227, "kl": 0.002276470532471701, "entropy": 0.2223911193975558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "env_runners": {"episode_reward_max": 11.0817687984151, "episode_reward_min": -34.177433607122694, "episode_reward_mean": -8.229316549232763, "episode_len_mean": 376.8, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37680, "policy_reward_min": {"agent_policy": -11.081768798415101, "adversary_policy": -46.71024056442817}, "policy_reward_max": {"agent_policy": 34.17743360712269, "adversary_policy": 21.084273427570437}, "policy_reward_mean": {"agent_policy": 8.229316549232765, "adversary_policy": -8.229316549232763}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.74958153984562, -34.177433607122694, 1.7373259989804897, -5.133500544122452, -7.469410967245501, -10.064951881564847, -18.14398263446751, -22.637308916263372, -3.321273182426797, 0.6079147054619476, -20.148844088048328, -10.193251559897135, -6.2634965594412115, -15.096209840219558, 9.462904139303275, -8.435678584157175, 3.5822372550733057, -2.863503496150061, -18.61196484508745, -14.787468174327088, 1.4177602135300855, -17.749227524863418, -10.27102372943575, -5.373420967793201, -0.11121118791266049, 5.555518512063305, -22.312110376643663, 4.402614166107316, -18.192824158144116, -4.327560252504245, -27.391626943330298, -13.06371520883864, -4.499440530034002, -2.339342944703194, -4.299133452602826, -6.300949625479197, -19.098887481748868, -3.334979942264935, -9.117046972081173, -5.50853337503235, 7.37382060720348, 11.0817687984151, 0.902349067713585, 4.439645061835339, -22.156404615550446, -11.097150611066521, -19.026487272873354, -4.577741416463601, -13.510131070328192, -25.396240033704828, 7.086686487096259, -19.317627702161875, -16.88124065398115, -21.680300884742, -6.64266126846635, 7.430404351282288, -0.11588974657037099, -4.527141834602588, 4.399939097048868, 5.446676201791885, -15.66695541602942, -9.77179475870106, -17.858840569167413, -8.175938503040207, -13.751942792515603, -0.2732099955213847, -4.903711808974959, -9.593069679462591, -17.393917990762116, -0.2970355861135445, 1.719596796910006, -9.889367225120553, -29.30053923073974, -13.237185424240295, 4.436724634056612, -6.29627978881132, -14.623084861485744, -10.547908933305553, -10.931704728745933, 4.648830161002579, -1.3313177022123277, -20.73990632138223, -0.029631378495363236, 4.811652435405055, -10.610668823739083, 1.9642603009392854, -5.802706097252489, -18.02184546740717, 2.7758905059377312, -2.258728913050275, -7.451987971136184, -1.6148655197603947, -0.14424385019939834, -2.8188653245161976, -15.11479969926378, -3.1242477870023535, -19.775672494943652, -4.5374144502352465, -16.40288500229289, -26.60598812049702], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 3, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [33.74958153984563, 34.17743360712269, -1.7373259989805074, 5.133500544122468, 7.469410967245501, 10.064951881564847, 18.143982634467516, 22.637308916263382, 3.321273182426797, -0.6079147054619298, 20.148844088048325, 10.193251559897135, 6.263496559441208, 15.096209840219558, -9.462904139303275, 8.435678584157175, -3.5822372550733057, 2.863503496150061, 18.611964845087456, 14.787468174327088, -1.4177602135300855, 17.749227524863414, 10.27102372943575, 5.373420967793201, 0.11121118791266049, -5.555518512063287, 22.312110376643666, -4.402614166107314, 18.19282415814412, 4.327560252504245, 27.391626943330294, 13.06371520883864, 4.499440530034002, 2.339342944703194, 4.299133452602826, 6.300949625479197, 19.098887481748868, 3.334979942264935, 9.117046972081175, 5.508533375032348, -7.373820607203481, -11.081768798415101, -0.9023490677135655, -4.439645061835339, 22.156404615550443, 11.097150611066521, 19.026487272873354, 4.577741416463601, 13.510131070328196, 25.396240033704824, -7.086686487096259, 19.317627702161886, 16.881240653981152, 21.680300884742003, 6.64266126846635, -7.430404351282288, 0.11588974657037099, 4.527141834602588, -4.399939097048868, -5.446676201791885, 15.66695541602942, 9.77179475870106, 17.858840569167413, 8.175938503040207, 13.751942792515603, 0.27320999552138453, 4.903711808974959, 9.593069679462587, 17.393917990762116, 0.2970355861135445, -1.719596796910006, 9.889367225120557, 29.300539230739744, 13.237185424240288, -4.436724634056612, 6.29627978881132, 14.623084861485744, 10.547908933305555, 10.931704728745933, -4.648830161002579, 1.3313177022123153, 20.739906321382232, 0.029631378495363236, -4.811652435405055, 10.610668823739083, -1.9642603009392836, 5.802706097252489, 18.02184546740717, -2.7758905059377312, 2.258728913050275, 7.451987971136184, 1.6148655197603938, 0.14424385019939834, 2.8188653245161976, 15.11479969926378, 3.1242477870023535, 19.775672494943656, 4.537414450235239, 16.402885002292887, 26.605988120497017], "policy_adversary_policy_reward": [-44.758381672732256, -22.740781406958938, -46.71024056442817, -21.644626649817273, -9.731217647764804, 13.205869645725791, -16.454843884070236, 6.187842795825279, -15.90408619324571, 0.9652642587547078, -16.260280888508973, -3.8696228746207204, -14.226848512700759, -22.061116756234288, -15.830858971874292, -29.44375886065246, 4.117490973923346, -10.76003733877694, 5.8527671005097375, -4.63693768958589, -10.866511960586276, -29.431176215510362, -29.502002720209703, 9.115499600415433, -6.352251194016169, -6.1747419248662485, -15.378378054487065, -14.814041625952047, 6.6237158992421215, 12.302092379364431, -6.44090518587349, -10.43045198244086, 8.350545414228286, -1.1860709040816744, 0.7014551953102526, -6.428462187610375, -23.007207432305268, -14.216722257869659, -1.2825329110868182, -28.29240343756736, 2.737674264574281, 0.09784616248589018, -24.401365415394324, -11.097089634332509, -6.506686601635359, -14.035360857236142, -18.361537989281913, 7.614696053695511, 8.70306039985499, -8.925482775680312, 8.941672690546984, 2.1693643335796082, -27.67666050276932, -16.947560250518013, 3.8398090846165687, 4.965419247598081, -22.098209012301336, -14.28743930398689, -10.912114518879761, 2.256994013871271, -31.24193480094852, -23.54131908571206, -14.415088179448276, -11.712342238229006, 6.068178157099084, -15.067059217167088, -6.852948574053649, 2.1742626846472604, 6.722660282464851, -15.320927187670502, 3.2372885962274296, -15.839187847185823, -17.186876398661653, -21.01089856483608, -6.480327121421855, -0.18963276310801547, -9.988870958582304, -8.245222985580027, 5.447411350408814, -16.464478100473507, 4.511908554374592, 10.235732660032369, 8.233057626047097, 13.930479970783106, -8.768687287535826, 10.573385422962957, 8.200488351286893, 0.6788017723837854, -27.269803173947658, -17.043006057153235, -24.558071068947648, 2.3637698468146056, -24.772825692351564, -13.280148853395147, -9.009492621305942, -0.14599021162126036, -12.443844447775025, -14.576417692881368, -27.80592781870867, -22.986552248700978, 1.7364010332109245, 12.436971940981593, -23.771871434520143, -14.863383969803621, -27.215121508204824, -6.5473597997574835, -27.46966405490312, -15.890937714580886, -8.504048371836312, -4.781274165096388, 10.155342564401018, 4.705466138163558, 12.262113878592473, -12.493893371733215, -5.102997459318047, -3.9512862098871295, 0.25428781341874185, 8.545590380678995, 5.862386210513925, 5.030966193069844, -20.402517313310764, -10.931393518748074, -0.5536444131414555, -18.989945104260663, -11.50315465066872, -24.21452648766611, -9.732121083230599, -6.619755922849816, -5.413752580218858, -22.090133004812348, 2.215349289961428, -2.761769281004197, -9.08513232866677, -0.7222912892831488, -5.7541367246198085, -13.432002634305373, -8.821182800574746, -25.966653180949486, 7.7303242593833446, -8.324395431610434, 5.026230295829394, -1.5870367020093816, -8.796538125259366, -10.98219632498175, -31.150245384510498, -27.45083307696901, -10.300953363063051, -16.17341748541751, 0.6999932910152253, 8.173455977098, -4.287133954534259, -8.305425623088382, -13.720457222081244, -15.525712500890243, -11.299593193120316, -9.79622467349079, 3.9144172296099313, -25.777826687101797, 6.648435315882601, 2.649225006122556, 0.852608265538759, -3.5152436699633984, -15.985114487171053, -25.494698155593408, 18.66878962767936, -18.728052384670086, 2.562836237767179, 7.06046863304293, -10.34848344221803, -10.872854205260136, 6.454411166401819, -2.5258905645232517, 1.0466022597318343, -12.652014454236813, -26.710696709142802, -9.332994225671545, 1.6854177402754473, 3.866363271600015, 10.800964796156805, -15.318422622257355, -7.478525615852096, -7.425450326420272, -24.314004467091227, 21.084273427570437, -1.2966427057879528, 1.0081550053891561, 2.955139661633531, -8.592870310665926, -12.461427507619092, -17.768171890908466, 0.8974184813913197, -7.145914055396027, -13.347524431602043, -26.203820558285248, -5.702784658626557, -3.3720442418439163, -23.536445849927045, -9.269324154658715, -29.04646807398155, -24.16550816701249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42241116251680944, "mean_inference_ms": 1.1111456595130655, "mean_action_processing_ms": 0.18128292853261108, "mean_env_wait_ms": 0.07382271580956438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036383867263793945, "StateBufferConnector_ms": 0.0025635957717895508, "ViewRequirementAgentConnector_ms": 0.07088768482208252}, "num_episodes": 11, "episode_return_max": 11.0817687984151, "episode_return_min": -34.177433607122694, "episode_return_mean": -8.229316549232763}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.60573941140143, "num_env_steps_trained_throughput_per_sec": 485.60573941140143, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 1860000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1860000, "timers": {"training_iteration_time_ms": 8268.365, "restore_workers_time_ms": 0.014, "training_step_time_ms": 8268.324, "sample_time_ms": 804.532, "learn_time_ms": 7450.567, "learn_throughput": 536.872, "synch_weights_time_ms": 12.736}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 1860000, "num_agent_steps_trained": 1860000}, "done": false, "training_iteration": 155, "trial_id": "83a5c_00000", "date": "2024-08-10_12-35-55", "timestamp": 1723307755, "time_this_iter_s": 8.242913007736206, "time_total_s": 1316.1610777378082, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc74dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1316.1610777378082, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 29.666666666666668, "ram_util_percent": 81.76666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.925111021440496, "cur_kl_coeff": 0.05701743364334108, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.218922239068955, "policy_loss": -0.0061684566317126155, "vf_loss": 2.2245061265097723, "vf_explained_var": 0.0013686581263466487, "kl": 0.0102524131996136, "entropy": 1.3256854196704884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.555175142238538, "cur_kl_coeff": 2.7188031026526013e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8376553202668826, "policy_loss": -0.00911328221700387, "vf_loss": 2.8467686026046675, "vf_explained_var": 0.33780479406317077, "kl": 0.004125252494888941, "entropy": 0.22851731427945196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 11.0817687984151, "episode_reward_min": -29.30053923073974, "episode_reward_mean": -7.151209169348185, "episode_len_mean": 372.92, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37292, "policy_reward_min": {"agent_policy": -11.081768798415101, "adversary_policy": -31.24193480094852}, "policy_reward_max": {"agent_policy": 29.300539230739744, "adversary_policy": 21.084273427570437}, "policy_reward_mean": {"agent_policy": 7.151209169348187, "adversary_policy": -7.151209169348185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.193251559897135, -6.2634965594412115, -15.096209840219558, 9.462904139303275, -8.435678584157175, 3.5822372550733057, -2.863503496150061, -18.61196484508745, -14.787468174327088, 1.4177602135300855, -17.749227524863418, -10.27102372943575, -5.373420967793201, -0.11121118791266049, 5.555518512063305, -22.312110376643663, 4.402614166107316, -18.192824158144116, -4.327560252504245, -27.391626943330298, -13.06371520883864, -4.499440530034002, -2.339342944703194, -4.299133452602826, -6.300949625479197, -19.098887481748868, -3.334979942264935, -9.117046972081173, -5.50853337503235, 7.37382060720348, 11.0817687984151, 0.902349067713585, 4.439645061835339, -22.156404615550446, -11.097150611066521, -19.026487272873354, -4.577741416463601, -13.510131070328192, -25.396240033704828, 7.086686487096259, -19.317627702161875, -16.88124065398115, -21.680300884742, -6.64266126846635, 7.430404351282288, -0.11588974657037099, -4.527141834602588, 4.399939097048868, 5.446676201791885, -15.66695541602942, -9.77179475870106, -17.858840569167413, -8.175938503040207, -13.751942792515603, -0.2732099955213847, -4.903711808974959, -9.593069679462591, -17.393917990762116, -0.2970355861135445, 1.719596796910006, -9.889367225120553, -29.30053923073974, -13.237185424240295, 4.436724634056612, -6.29627978881132, -14.623084861485744, -10.547908933305553, -10.931704728745933, 4.648830161002579, -1.3313177022123277, -20.73990632138223, -0.029631378495363236, 4.811652435405055, -10.610668823739083, 1.9642603009392854, -5.802706097252489, -18.02184546740717, 2.7758905059377312, -2.258728913050275, -7.451987971136184, -1.6148655197603947, -0.14424385019939834, -2.8188653245161976, -15.11479969926378, -3.1242477870023535, -19.775672494943652, -4.5374144502352465, -16.40288500229289, -26.60598812049702, -13.290811862331573, 10.913252023244812, -5.835536558010794, -8.339649566771769, -18.92995105092543, 0.8164034256378105, -18.172036127738036, -9.224116081942348, 5.6179589239143795, 9.76506570339063, 1.989112503325476], "episode_lengths": [400, 400, 400, 33, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 3, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400], "policy_agent_policy_reward": [10.193251559897135, 6.263496559441208, 15.096209840219558, -9.462904139303275, 8.435678584157175, -3.5822372550733057, 2.863503496150061, 18.611964845087456, 14.787468174327088, -1.4177602135300855, 17.749227524863414, 10.27102372943575, 5.373420967793201, 0.11121118791266049, -5.555518512063287, 22.312110376643666, -4.402614166107314, 18.19282415814412, 4.327560252504245, 27.391626943330294, 13.06371520883864, 4.499440530034002, 2.339342944703194, 4.299133452602826, 6.300949625479197, 19.098887481748868, 3.334979942264935, 9.117046972081175, 5.508533375032348, -7.373820607203481, -11.081768798415101, -0.9023490677135655, -4.439645061835339, 22.156404615550443, 11.097150611066521, 19.026487272873354, 4.577741416463601, 13.510131070328196, 25.396240033704824, -7.086686487096259, 19.317627702161886, 16.881240653981152, 21.680300884742003, 6.64266126846635, -7.430404351282288, 0.11588974657037099, 4.527141834602588, -4.399939097048868, -5.446676201791885, 15.66695541602942, 9.77179475870106, 17.858840569167413, 8.175938503040207, 13.751942792515603, 0.27320999552138453, 4.903711808974959, 9.593069679462587, 17.393917990762116, 0.2970355861135445, -1.719596796910006, 9.889367225120557, 29.300539230739744, 13.237185424240288, -4.436724634056612, 6.29627978881132, 14.623084861485744, 10.547908933305555, 10.931704728745933, -4.648830161002579, 1.3313177022123153, 20.739906321382232, 0.029631378495363236, -4.811652435405055, 10.610668823739083, -1.9642603009392836, 5.802706097252489, 18.02184546740717, -2.7758905059377312, 2.258728913050275, 7.451987971136184, 1.6148655197603938, 0.14424385019939834, 2.8188653245161976, 15.11479969926378, 3.1242477870023535, 19.775672494943656, 4.537414450235239, 16.402885002292887, 26.605988120497017, 13.290811862331573, -10.913252023244812, 5.835536558010794, 8.339649566771769, 18.929951050925425, -0.8164034256378105, 18.17203612773803, 9.224116081942352, -5.6179589239143795, -9.76506570339063, -1.989112503325476], "policy_adversary_policy_reward": [-29.502002720209703, 9.115499600415433, -6.352251194016169, -6.1747419248662485, -15.378378054487065, -14.814041625952047, 6.6237158992421215, 12.302092379364431, -6.44090518587349, -10.43045198244086, 8.350545414228286, -1.1860709040816744, 0.7014551953102526, -6.428462187610375, -23.007207432305268, -14.216722257869659, -1.2825329110868182, -28.29240343756736, 2.737674264574281, 0.09784616248589018, -24.401365415394324, -11.097089634332509, -6.506686601635359, -14.035360857236142, -18.361537989281913, 7.614696053695511, 8.70306039985499, -8.925482775680312, 8.941672690546984, 2.1693643335796082, -27.67666050276932, -16.947560250518013, 3.8398090846165687, 4.965419247598081, -22.098209012301336, -14.28743930398689, -10.912114518879761, 2.256994013871271, -31.24193480094852, -23.54131908571206, -14.415088179448276, -11.712342238229006, 6.068178157099084, -15.067059217167088, -6.852948574053649, 2.1742626846472604, 6.722660282464851, -15.320927187670502, 3.2372885962274296, -15.839187847185823, -17.186876398661653, -21.01089856483608, -6.480327121421855, -0.18963276310801547, -9.988870958582304, -8.245222985580027, 5.447411350408814, -16.464478100473507, 4.511908554374592, 10.235732660032369, 8.233057626047097, 13.930479970783106, -8.768687287535826, 10.573385422962957, 8.200488351286893, 0.6788017723837854, -27.269803173947658, -17.043006057153235, -24.558071068947648, 2.3637698468146056, -24.772825692351564, -13.280148853395147, -9.009492621305942, -0.14599021162126036, -12.443844447775025, -14.576417692881368, -27.80592781870867, -22.986552248700978, 1.7364010332109245, 12.436971940981593, -23.771871434520143, -14.863383969803621, -27.215121508204824, -6.5473597997574835, -27.46966405490312, -15.890937714580886, -8.504048371836312, -4.781274165096388, 10.155342564401018, 4.705466138163558, 12.262113878592473, -12.493893371733215, -5.102997459318047, -3.9512862098871295, 0.25428781341874185, 8.545590380678995, 5.862386210513925, 5.030966193069844, -20.402517313310764, -10.931393518748074, -0.5536444131414555, -18.989945104260663, -11.50315465066872, -24.21452648766611, -9.732121083230599, -6.619755922849816, -5.413752580218858, -22.090133004812348, 2.215349289961428, -2.761769281004197, -9.08513232866677, -0.7222912892831488, -5.7541367246198085, -13.432002634305373, -8.821182800574746, -25.966653180949486, 7.7303242593833446, -8.324395431610434, 5.026230295829394, -1.5870367020093816, -8.796538125259366, -10.98219632498175, -31.150245384510498, -27.45083307696901, -10.300953363063051, -16.17341748541751, 0.6999932910152253, 8.173455977098, -4.287133954534259, -8.305425623088382, -13.720457222081244, -15.525712500890243, -11.299593193120316, -9.79622467349079, 3.9144172296099313, -25.777826687101797, 6.648435315882601, 2.649225006122556, 0.852608265538759, -3.5152436699633984, -15.985114487171053, -25.494698155593408, 18.66878962767936, -18.728052384670086, 2.562836237767179, 7.06046863304293, -10.34848344221803, -10.872854205260136, 6.454411166401819, -2.5258905645232517, 1.0466022597318343, -12.652014454236813, -26.710696709142802, -9.332994225671545, 1.6854177402754473, 3.866363271600015, 10.800964796156805, -15.318422622257355, -7.478525615852096, -7.425450326420272, -24.314004467091227, 21.084273427570437, -1.2966427057879528, 1.0081550053891561, 2.955139661633531, -8.592870310665926, -12.461427507619092, -17.768171890908466, 0.8974184813913197, -7.145914055396027, -13.347524431602043, -26.203820558285248, -5.702784658626557, -3.3720442418439163, -23.536445849927045, -9.269324154658715, -29.04646807398155, -24.16550816701249, -19.114069303258923, -7.467554421404223, 6.529712137418592, 15.296791909071032, -4.392752166441561, -7.278320949580028, 4.5143638423936565, -21.193662975937194, -18.829598141598733, -19.030303960252123, 12.437562642923925, -10.804755791648304, -7.729706389194341, -28.614365866281727, -19.015208266373342, 0.5669761024886455, 3.7178173127882133, 7.518100535040546, 5.851145668201902, 13.678985738579353, 2.299428514805264, 1.678796491845688]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4222247521520964, "mean_inference_ms": 1.110717074327754, "mean_action_processing_ms": 0.1811981025394064, "mean_env_wait_ms": 0.07378778382047876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036323070526123047, "StateBufferConnector_ms": 0.002562880516052246, "ViewRequirementAgentConnector_ms": 0.07069885730743408}, "num_episodes": 11, "episode_return_max": 11.0817687984151, "episode_return_min": -29.30053923073974, "episode_return_mean": -7.151209169348185}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.87041930383896, "num_env_steps_trained_throughput_per_sec": 448.87041930383896, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 8357.814, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8357.778, "sample_time_ms": 809.41, "learn_time_ms": 7534.964, "learn_throughput": 530.859, "synch_weights_time_ms": 12.906}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 156, "trial_id": "83a5c_00000", "date": "2024-08-10_12-36-04", "timestamp": 1723307764, "time_this_iter_s": 8.916916847229004, "time_total_s": 1325.0779945850372, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc74820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1325.0779945850372, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 37.025, "ram_util_percent": 81.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.157296433871385, "cur_kl_coeff": 0.05701743364334108, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7612121152499367, "policy_loss": -0.006661594120869364, "vf_loss": 2.7672571500773153, "vf_explained_var": -0.5075872791191888, "kl": 0.010813673735666662, "entropy": 1.3208822017624264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.119172663924595, "cur_kl_coeff": 1.3594015513263006e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1055811648567517, "policy_loss": -0.007783971813478274, "vf_loss": 2.113365139067173, "vf_explained_var": 0.593680841413637, "kl": 0.00459568406455831, "entropy": 0.2526186522096395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "env_runners": {"episode_reward_max": 11.0817687984151, "episode_reward_min": -29.30053923073974, "episode_reward_mean": -7.108500581408438, "episode_len_mean": 376.59, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37659, "policy_reward_min": {"agent_policy": -11.081768798415101, "adversary_policy": -31.24193480094852}, "policy_reward_max": {"agent_policy": 29.300539230739744, "adversary_policy": 21.084273427570437}, "policy_reward_mean": {"agent_policy": 7.108500581408438, "adversary_policy": -7.108500581408438}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.749227524863418, -10.27102372943575, -5.373420967793201, -0.11121118791266049, 5.555518512063305, -22.312110376643663, 4.402614166107316, -18.192824158144116, -4.327560252504245, -27.391626943330298, -13.06371520883864, -4.499440530034002, -2.339342944703194, -4.299133452602826, -6.300949625479197, -19.098887481748868, -3.334979942264935, -9.117046972081173, -5.50853337503235, 7.37382060720348, 11.0817687984151, 0.902349067713585, 4.439645061835339, -22.156404615550446, -11.097150611066521, -19.026487272873354, -4.577741416463601, -13.510131070328192, -25.396240033704828, 7.086686487096259, -19.317627702161875, -16.88124065398115, -21.680300884742, -6.64266126846635, 7.430404351282288, -0.11588974657037099, -4.527141834602588, 4.399939097048868, 5.446676201791885, -15.66695541602942, -9.77179475870106, -17.858840569167413, -8.175938503040207, -13.751942792515603, -0.2732099955213847, -4.903711808974959, -9.593069679462591, -17.393917990762116, -0.2970355861135445, 1.719596796910006, -9.889367225120553, -29.30053923073974, -13.237185424240295, 4.436724634056612, -6.29627978881132, -14.623084861485744, -10.547908933305553, -10.931704728745933, 4.648830161002579, -1.3313177022123277, -20.73990632138223, -0.029631378495363236, 4.811652435405055, -10.610668823739083, 1.9642603009392854, -5.802706097252489, -18.02184546740717, 2.7758905059377312, -2.258728913050275, -7.451987971136184, -1.6148655197603947, -0.14424385019939834, -2.8188653245161976, -15.11479969926378, -3.1242477870023535, -19.775672494943652, -4.5374144502352465, -16.40288500229289, -26.60598812049702, -13.290811862331573, 10.913252023244812, -5.835536558010794, -8.339649566771769, -18.92995105092543, 0.8164034256378105, -18.172036127738036, -9.224116081942348, 5.6179589239143795, 9.76506570339063, 1.989112503325476, -12.549736709088256, -17.90989149081641, -5.028123741196193, 3.070358527480451, -3.9880903856897785, -2.3287573127157497, -3.4045944666341015, -23.21769399451491, 0.4296224346797697, 7.4090944810967905], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 16, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 3, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [17.749227524863414, 10.27102372943575, 5.373420967793201, 0.11121118791266049, -5.555518512063287, 22.312110376643666, -4.402614166107314, 18.19282415814412, 4.327560252504245, 27.391626943330294, 13.06371520883864, 4.499440530034002, 2.339342944703194, 4.299133452602826, 6.300949625479197, 19.098887481748868, 3.334979942264935, 9.117046972081175, 5.508533375032348, -7.373820607203481, -11.081768798415101, -0.9023490677135655, -4.439645061835339, 22.156404615550443, 11.097150611066521, 19.026487272873354, 4.577741416463601, 13.510131070328196, 25.396240033704824, -7.086686487096259, 19.317627702161886, 16.881240653981152, 21.680300884742003, 6.64266126846635, -7.430404351282288, 0.11588974657037099, 4.527141834602588, -4.399939097048868, -5.446676201791885, 15.66695541602942, 9.77179475870106, 17.858840569167413, 8.175938503040207, 13.751942792515603, 0.27320999552138453, 4.903711808974959, 9.593069679462587, 17.393917990762116, 0.2970355861135445, -1.719596796910006, 9.889367225120557, 29.300539230739744, 13.237185424240288, -4.436724634056612, 6.29627978881132, 14.623084861485744, 10.547908933305555, 10.931704728745933, -4.648830161002579, 1.3313177022123153, 20.739906321382232, 0.029631378495363236, -4.811652435405055, 10.610668823739083, -1.9642603009392836, 5.802706097252489, 18.02184546740717, -2.7758905059377312, 2.258728913050275, 7.451987971136184, 1.6148655197603938, 0.14424385019939834, 2.8188653245161976, 15.11479969926378, 3.1242477870023535, 19.775672494943656, 4.537414450235239, 16.402885002292887, 26.605988120497017, 13.290811862331573, -10.913252023244812, 5.835536558010794, 8.339649566771769, 18.929951050925425, -0.8164034256378105, 18.17203612773803, 9.224116081942352, -5.6179589239143795, -9.76506570339063, -1.989112503325476, 12.549736709088256, 17.909891490816406, 5.028123741196193, -3.070358527480451, 3.9880903856897767, 2.328757312715748, 3.4045944666341015, 23.2176939945149, -0.429622434679775, -7.4090944810967905], "policy_adversary_policy_reward": [-24.401365415394324, -11.097089634332509, -6.506686601635359, -14.035360857236142, -18.361537989281913, 7.614696053695511, 8.70306039985499, -8.925482775680312, 8.941672690546984, 2.1693643335796082, -27.67666050276932, -16.947560250518013, 3.8398090846165687, 4.965419247598081, -22.098209012301336, -14.28743930398689, -10.912114518879761, 2.256994013871271, -31.24193480094852, -23.54131908571206, -14.415088179448276, -11.712342238229006, 6.068178157099084, -15.067059217167088, -6.852948574053649, 2.1742626846472604, 6.722660282464851, -15.320927187670502, 3.2372885962274296, -15.839187847185823, -17.186876398661653, -21.01089856483608, -6.480327121421855, -0.18963276310801547, -9.988870958582304, -8.245222985580027, 5.447411350408814, -16.464478100473507, 4.511908554374592, 10.235732660032369, 8.233057626047097, 13.930479970783106, -8.768687287535826, 10.573385422962957, 8.200488351286893, 0.6788017723837854, -27.269803173947658, -17.043006057153235, -24.558071068947648, 2.3637698468146056, -24.772825692351564, -13.280148853395147, -9.009492621305942, -0.14599021162126036, -12.443844447775025, -14.576417692881368, -27.80592781870867, -22.986552248700978, 1.7364010332109245, 12.436971940981593, -23.771871434520143, -14.863383969803621, -27.215121508204824, -6.5473597997574835, -27.46966405490312, -15.890937714580886, -8.504048371836312, -4.781274165096388, 10.155342564401018, 4.705466138163558, 12.262113878592473, -12.493893371733215, -5.102997459318047, -3.9512862098871295, 0.25428781341874185, 8.545590380678995, 5.862386210513925, 5.030966193069844, -20.402517313310764, -10.931393518748074, -0.5536444131414555, -18.989945104260663, -11.50315465066872, -24.21452648766611, -9.732121083230599, -6.619755922849816, -5.413752580218858, -22.090133004812348, 2.215349289961428, -2.761769281004197, -9.08513232866677, -0.7222912892831488, -5.7541367246198085, -13.432002634305373, -8.821182800574746, -25.966653180949486, 7.7303242593833446, -8.324395431610434, 5.026230295829394, -1.5870367020093816, -8.796538125259366, -10.98219632498175, -31.150245384510498, -27.45083307696901, -10.300953363063051, -16.17341748541751, 0.6999932910152253, 8.173455977098, -4.287133954534259, -8.305425623088382, -13.720457222081244, -15.525712500890243, -11.299593193120316, -9.79622467349079, 3.9144172296099313, -25.777826687101797, 6.648435315882601, 2.649225006122556, 0.852608265538759, -3.5152436699633984, -15.985114487171053, -25.494698155593408, 18.66878962767936, -18.728052384670086, 2.562836237767179, 7.06046863304293, -10.34848344221803, -10.872854205260136, 6.454411166401819, -2.5258905645232517, 1.0466022597318343, -12.652014454236813, -26.710696709142802, -9.332994225671545, 1.6854177402754473, 3.866363271600015, 10.800964796156805, -15.318422622257355, -7.478525615852096, -7.425450326420272, -24.314004467091227, 21.084273427570437, -1.2966427057879528, 1.0081550053891561, 2.955139661633531, -8.592870310665926, -12.461427507619092, -17.768171890908466, 0.8974184813913197, -7.145914055396027, -13.347524431602043, -26.203820558285248, -5.702784658626557, -3.3720442418439163, -23.536445849927045, -9.269324154658715, -29.04646807398155, -24.16550816701249, -19.114069303258923, -7.467554421404223, 6.529712137418592, 15.296791909071032, -4.392752166441561, -7.278320949580028, 4.5143638423936565, -21.193662975937194, -18.829598141598733, -19.030303960252123, 12.437562642923925, -10.804755791648304, -7.729706389194341, -28.614365866281727, -19.015208266373342, 0.5669761024886455, 3.7178173127882133, 7.518100535040546, 5.851145668201902, 13.678985738579353, 2.299428514805264, 1.678796491845688, -18.65031008983797, -6.4491633283385426, -28.611785294589808, -7.207997687043001, -24.822454885361058, 14.766207402968675, 6.216139772290369, -0.0754227173294666, 2.427680456469261, -10.403861227848813, 3.3256594541211797, -7.9831740795526756, -8.058825800005899, 1.2496368667376956, -27.693714940297372, -18.741673048732448, -13.451138141108327, 14.310383010467874, 5.005184184451487, 9.813004777742094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4220738899979579, "mean_inference_ms": 1.1104062798310381, "mean_action_processing_ms": 0.18112315162771622, "mean_env_wait_ms": 0.07376678128582129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003726482391357422, "StateBufferConnector_ms": 0.002589106559753418, "ViewRequirementAgentConnector_ms": 0.07177042961120605}, "num_episodes": 10, "episode_return_max": 11.0817687984151, "episode_return_min": -29.30053923073974, "episode_return_mean": -7.108500581408438}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.9995005905262, "num_env_steps_trained_throughput_per_sec": 498.9995005905262, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 1884000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1884000, "timers": {"training_iteration_time_ms": 8340.401, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8340.364, "sample_time_ms": 806.311, "learn_time_ms": 7520.734, "learn_throughput": 531.863, "synch_weights_time_ms": 12.827}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 1884000, "num_agent_steps_trained": 1884000}, "done": false, "training_iteration": 157, "trial_id": "83a5c_00000", "date": "2024-08-10_12-36-12", "timestamp": 1723307772, "time_this_iter_s": 8.021357774734497, "time_total_s": 1333.0993523597717, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc31550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1333.0993523597717, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 26.783333333333335, "ram_util_percent": 81.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0216591594080446, "cur_kl_coeff": 0.05701743364334108, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8636975798657334, "policy_loss": -0.013901547482853174, "vf_loss": 2.8763265527114665, "vf_explained_var": -0.4192337468818382, "kl": 0.022319157478345817, "entropy": 1.366647014416084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.026770685923596, "cur_kl_coeff": 6.797007756631503e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0680800574521223, "policy_loss": -0.003250582384741089, "vf_loss": 2.0713306420793134, "vf_explained_var": 0.6187412821377317, "kl": 0.003095049049590402, "entropy": 0.30779613020519414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "env_runners": {"episode_reward_max": 11.0817687984151, "episode_reward_min": -29.30053923073974, "episode_reward_mean": -6.808727529943906, "episode_len_mean": 372.66, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37266, "policy_reward_min": {"agent_policy": -11.081768798415101, "adversary_policy": -31.150245384510498}, "policy_reward_max": {"agent_policy": 29.300539230739744, "adversary_policy": 21.084273427570437}, "policy_reward_mean": {"agent_policy": 6.808727529943906, "adversary_policy": -6.808727529943906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.499440530034002, -2.339342944703194, -4.299133452602826, -6.300949625479197, -19.098887481748868, -3.334979942264935, -9.117046972081173, -5.50853337503235, 7.37382060720348, 11.0817687984151, 0.902349067713585, 4.439645061835339, -22.156404615550446, -11.097150611066521, -19.026487272873354, -4.577741416463601, -13.510131070328192, -25.396240033704828, 7.086686487096259, -19.317627702161875, -16.88124065398115, -21.680300884742, -6.64266126846635, 7.430404351282288, -0.11588974657037099, -4.527141834602588, 4.399939097048868, 5.446676201791885, -15.66695541602942, -9.77179475870106, -17.858840569167413, -8.175938503040207, -13.751942792515603, -0.2732099955213847, -4.903711808974959, -9.593069679462591, -17.393917990762116, -0.2970355861135445, 1.719596796910006, -9.889367225120553, -29.30053923073974, -13.237185424240295, 4.436724634056612, -6.29627978881132, -14.623084861485744, -10.547908933305553, -10.931704728745933, 4.648830161002579, -1.3313177022123277, -20.73990632138223, -0.029631378495363236, 4.811652435405055, -10.610668823739083, 1.9642603009392854, -5.802706097252489, -18.02184546740717, 2.7758905059377312, -2.258728913050275, -7.451987971136184, -1.6148655197603947, -0.14424385019939834, -2.8188653245161976, -15.11479969926378, -3.1242477870023535, -19.775672494943652, -4.5374144502352465, -16.40288500229289, -26.60598812049702, -13.290811862331573, 10.913252023244812, -5.835536558010794, -8.339649566771769, -18.92995105092543, 0.8164034256378105, -18.172036127738036, -9.224116081942348, 5.6179589239143795, 9.76506570339063, 1.989112503325476, -12.549736709088256, -17.90989149081641, -5.028123741196193, 3.070358527480451, -3.9880903856897785, -2.3287573127157497, -3.4045944666341015, -23.21769399451491, 0.4296224346797697, 7.4090944810967905, -6.780346886926006, -21.12356213164666, 9.84419484593791, 6.9499313087771295, -9.486309689555167, -1.2448530647046159, -13.645442274178226, -3.687864237280234, -6.607890551045713, -16.829278661914433, -16.245861182305987], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 16, 20, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 3, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [4.499440530034002, 2.339342944703194, 4.299133452602826, 6.300949625479197, 19.098887481748868, 3.334979942264935, 9.117046972081175, 5.508533375032348, -7.373820607203481, -11.081768798415101, -0.9023490677135655, -4.439645061835339, 22.156404615550443, 11.097150611066521, 19.026487272873354, 4.577741416463601, 13.510131070328196, 25.396240033704824, -7.086686487096259, 19.317627702161886, 16.881240653981152, 21.680300884742003, 6.64266126846635, -7.430404351282288, 0.11588974657037099, 4.527141834602588, -4.399939097048868, -5.446676201791885, 15.66695541602942, 9.77179475870106, 17.858840569167413, 8.175938503040207, 13.751942792515603, 0.27320999552138453, 4.903711808974959, 9.593069679462587, 17.393917990762116, 0.2970355861135445, -1.719596796910006, 9.889367225120557, 29.300539230739744, 13.237185424240288, -4.436724634056612, 6.29627978881132, 14.623084861485744, 10.547908933305555, 10.931704728745933, -4.648830161002579, 1.3313177022123153, 20.739906321382232, 0.029631378495363236, -4.811652435405055, 10.610668823739083, -1.9642603009392836, 5.802706097252489, 18.02184546740717, -2.7758905059377312, 2.258728913050275, 7.451987971136184, 1.6148655197603938, 0.14424385019939834, 2.8188653245161976, 15.11479969926378, 3.1242477870023535, 19.775672494943656, 4.537414450235239, 16.402885002292887, 26.605988120497017, 13.290811862331573, -10.913252023244812, 5.835536558010794, 8.339649566771769, 18.929951050925425, -0.8164034256378105, 18.17203612773803, 9.224116081942352, -5.6179589239143795, -9.76506570339063, -1.989112503325476, 12.549736709088256, 17.909891490816406, 5.028123741196193, -3.070358527480451, 3.9880903856897767, 2.328757312715748, 3.4045944666341015, 23.2176939945149, -0.429622434679775, -7.4090944810967905, 6.780346886926006, 21.123562131646658, -9.8441948459379, -6.949931308777129, 9.486309689555167, 1.2448530647046159, 13.645442274178235, 3.687864237280234, 6.607890551045713, 16.829278661914433, 16.245861182305987], "policy_adversary_policy_reward": [6.068178157099084, -15.067059217167088, -6.852948574053649, 2.1742626846472604, 6.722660282464851, -15.320927187670502, 3.2372885962274296, -15.839187847185823, -17.186876398661653, -21.01089856483608, -6.480327121421855, -0.18963276310801547, -9.988870958582304, -8.245222985580027, 5.447411350408814, -16.464478100473507, 4.511908554374592, 10.235732660032369, 8.233057626047097, 13.930479970783106, -8.768687287535826, 10.573385422962957, 8.200488351286893, 0.6788017723837854, -27.269803173947658, -17.043006057153235, -24.558071068947648, 2.3637698468146056, -24.772825692351564, -13.280148853395147, -9.009492621305942, -0.14599021162126036, -12.443844447775025, -14.576417692881368, -27.80592781870867, -22.986552248700978, 1.7364010332109245, 12.436971940981593, -23.771871434520143, -14.863383969803621, -27.215121508204824, -6.5473597997574835, -27.46966405490312, -15.890937714580886, -8.504048371836312, -4.781274165096388, 10.155342564401018, 4.705466138163558, 12.262113878592473, -12.493893371733215, -5.102997459318047, -3.9512862098871295, 0.25428781341874185, 8.545590380678995, 5.862386210513925, 5.030966193069844, -20.402517313310764, -10.931393518748074, -0.5536444131414555, -18.989945104260663, -11.50315465066872, -24.21452648766611, -9.732121083230599, -6.619755922849816, -5.413752580218858, -22.090133004812348, 2.215349289961428, -2.761769281004197, -9.08513232866677, -0.7222912892831488, -5.7541367246198085, -13.432002634305373, -8.821182800574746, -25.966653180949486, 7.7303242593833446, -8.324395431610434, 5.026230295829394, -1.5870367020093816, -8.796538125259366, -10.98219632498175, -31.150245384510498, -27.45083307696901, -10.300953363063051, -16.17341748541751, 0.6999932910152253, 8.173455977098, -4.287133954534259, -8.305425623088382, -13.720457222081244, -15.525712500890243, -11.299593193120316, -9.79622467349079, 3.9144172296099313, -25.777826687101797, 6.648435315882601, 2.649225006122556, 0.852608265538759, -3.5152436699633984, -15.985114487171053, -25.494698155593408, 18.66878962767936, -18.728052384670086, 2.562836237767179, 7.06046863304293, -10.34848344221803, -10.872854205260136, 6.454411166401819, -2.5258905645232517, 1.0466022597318343, -12.652014454236813, -26.710696709142802, -9.332994225671545, 1.6854177402754473, 3.866363271600015, 10.800964796156805, -15.318422622257355, -7.478525615852096, -7.425450326420272, -24.314004467091227, 21.084273427570437, -1.2966427057879528, 1.0081550053891561, 2.955139661633531, -8.592870310665926, -12.461427507619092, -17.768171890908466, 0.8974184813913197, -7.145914055396027, -13.347524431602043, -26.203820558285248, -5.702784658626557, -3.3720442418439163, -23.536445849927045, -9.269324154658715, -29.04646807398155, -24.16550816701249, -19.114069303258923, -7.467554421404223, 6.529712137418592, 15.296791909071032, -4.392752166441561, -7.278320949580028, 4.5143638423936565, -21.193662975937194, -18.829598141598733, -19.030303960252123, 12.437562642923925, -10.804755791648304, -7.729706389194341, -28.614365866281727, -19.015208266373342, 0.5669761024886455, 3.7178173127882133, 7.518100535040546, 5.851145668201902, 13.678985738579353, 2.299428514805264, 1.678796491845688, -18.65031008983797, -6.4491633283385426, -28.611785294589808, -7.207997687043001, -24.822454885361058, 14.766207402968675, 6.216139772290369, -0.0754227173294666, 2.427680456469261, -10.403861227848813, 3.3256594541211797, -7.9831740795526756, -8.058825800005899, 1.2496368667376956, -27.693714940297372, -18.741673048732448, -13.451138141108327, 14.310383010467874, 5.005184184451487, 9.813004777742094, 4.183466116399778, -17.74415989025179, -22.000400239304664, -20.246724023988655, 9.210893132006532, 10.477496559869266, 5.845676287184148, 8.054186330370111, -9.619984092285613, -9.352635286824722, 10.154471177606894, -12.644177307016125, -11.56054697099879, -15.730337577357673, -25.518974681574747, 18.14324620701428, -12.312289969468736, -0.9034911326226904, -3.2829378426202744, -30.375619481208595, -19.00542673895236, -13.486295625659615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42190490501141875, "mean_inference_ms": 1.1098324921731275, "mean_action_processing_ms": 0.1810545948225186, "mean_env_wait_ms": 0.07371305036116403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037316083908081055, "StateBufferConnector_ms": 0.002603292465209961, "ViewRequirementAgentConnector_ms": 0.07159948348999023}, "num_episodes": 11, "episode_return_max": 11.0817687984151, "episode_return_min": -29.30053923073974, "episode_return_mean": -6.808727529943906}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.62553484571345, "num_env_steps_trained_throughput_per_sec": 503.62553484571345, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 1896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1896000, "timers": {"training_iteration_time_ms": 8310.648, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8310.61, "sample_time_ms": 809.375, "learn_time_ms": 7487.952, "learn_throughput": 534.191, "synch_weights_time_ms": 12.798}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "done": false, "training_iteration": 158, "trial_id": "83a5c_00000", "date": "2024-08-10_12-36-20", "timestamp": 1723307780, "time_this_iter_s": 7.9472832679748535, "time_total_s": 1341.0466356277466, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc8bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1341.0466356277466, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 25.981818181818184, "ram_util_percent": 81.73636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7721812803593893, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5283806661449413, "policy_loss": -0.008204116072584554, "vf_loss": 2.5355718513645193, "vf_explained_var": -0.010289648727134422, "kl": 0.011843610994189745, "entropy": 1.3923544791640428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.5304675217097, "cur_kl_coeff": 3.3985038783157516e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8070091700181365, "policy_loss": -0.0049774056111346, "vf_loss": 1.8119865785042444, "vf_explained_var": 0.5144171786804994, "kl": 0.003510209454735702, "entropy": 0.32905280594713987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "env_runners": {"episode_reward_max": 10.913252023244812, "episode_reward_min": -29.30053923073974, "episode_reward_mean": -7.253542639991037, "episode_len_mean": 376.4, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37640, "policy_reward_min": {"agent_policy": -10.913252023244812, "adversary_policy": -31.933375905059698}, "policy_reward_max": {"agent_policy": 29.300539230739744, "adversary_policy": 21.084273427570437}, "policy_reward_mean": {"agent_policy": 7.253542639991038, "adversary_policy": -7.253542639991037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.902349067713585, 4.439645061835339, -22.156404615550446, -11.097150611066521, -19.026487272873354, -4.577741416463601, -13.510131070328192, -25.396240033704828, 7.086686487096259, -19.317627702161875, -16.88124065398115, -21.680300884742, -6.64266126846635, 7.430404351282288, -0.11588974657037099, -4.527141834602588, 4.399939097048868, 5.446676201791885, -15.66695541602942, -9.77179475870106, -17.858840569167413, -8.175938503040207, -13.751942792515603, -0.2732099955213847, -4.903711808974959, -9.593069679462591, -17.393917990762116, -0.2970355861135445, 1.719596796910006, -9.889367225120553, -29.30053923073974, -13.237185424240295, 4.436724634056612, -6.29627978881132, -14.623084861485744, -10.547908933305553, -10.931704728745933, 4.648830161002579, -1.3313177022123277, -20.73990632138223, -0.029631378495363236, 4.811652435405055, -10.610668823739083, 1.9642603009392854, -5.802706097252489, -18.02184546740717, 2.7758905059377312, -2.258728913050275, -7.451987971136184, -1.6148655197603947, -0.14424385019939834, -2.8188653245161976, -15.11479969926378, -3.1242477870023535, -19.775672494943652, -4.5374144502352465, -16.40288500229289, -26.60598812049702, -13.290811862331573, 10.913252023244812, -5.835536558010794, -8.339649566771769, -18.92995105092543, 0.8164034256378105, -18.172036127738036, -9.224116081942348, 5.6179589239143795, 9.76506570339063, 1.989112503325476, -12.549736709088256, -17.90989149081641, -5.028123741196193, 3.070358527480451, -3.9880903856897785, -2.3287573127157497, -3.4045944666341015, -23.21769399451491, 0.4296224346797697, 7.4090944810967905, -6.780346886926006, -21.12356213164666, 9.84419484593791, 6.9499313087771295, -9.486309689555167, -1.2448530647046159, -13.645442274178226, -3.687864237280234, -6.607890551045713, -16.829278661914433, -16.245861182305987, -4.6860256080343845, -0.6543665199245492, -18.675050071113528, -11.530198711764855, 1.7299357342649166, -14.637674906794164, -8.274055846555784, -17.554125152715887, 6.475062558378143, -12.71773739878108], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 3, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400], "policy_agent_policy_reward": [-0.9023490677135655, -4.439645061835339, 22.156404615550443, 11.097150611066521, 19.026487272873354, 4.577741416463601, 13.510131070328196, 25.396240033704824, -7.086686487096259, 19.317627702161886, 16.881240653981152, 21.680300884742003, 6.64266126846635, -7.430404351282288, 0.11588974657037099, 4.527141834602588, -4.399939097048868, -5.446676201791885, 15.66695541602942, 9.77179475870106, 17.858840569167413, 8.175938503040207, 13.751942792515603, 0.27320999552138453, 4.903711808974959, 9.593069679462587, 17.393917990762116, 0.2970355861135445, -1.719596796910006, 9.889367225120557, 29.300539230739744, 13.237185424240288, -4.436724634056612, 6.29627978881132, 14.623084861485744, 10.547908933305555, 10.931704728745933, -4.648830161002579, 1.3313177022123153, 20.739906321382232, 0.029631378495363236, -4.811652435405055, 10.610668823739083, -1.9642603009392836, 5.802706097252489, 18.02184546740717, -2.7758905059377312, 2.258728913050275, 7.451987971136184, 1.6148655197603938, 0.14424385019939834, 2.8188653245161976, 15.11479969926378, 3.1242477870023535, 19.775672494943656, 4.537414450235239, 16.402885002292887, 26.605988120497017, 13.290811862331573, -10.913252023244812, 5.835536558010794, 8.339649566771769, 18.929951050925425, -0.8164034256378105, 18.17203612773803, 9.224116081942352, -5.6179589239143795, -9.76506570339063, -1.989112503325476, 12.549736709088256, 17.909891490816406, 5.028123741196193, -3.070358527480451, 3.9880903856897767, 2.328757312715748, 3.4045944666341015, 23.2176939945149, -0.429622434679775, -7.4090944810967905, 6.780346886926006, 21.123562131646658, -9.8441948459379, -6.949931308777129, 9.486309689555167, 1.2448530647046159, 13.645442274178235, 3.687864237280234, 6.607890551045713, 16.829278661914433, 16.245861182305987, 4.6860256080343845, 0.6543665199245492, 18.675050071113525, 11.530198711764854, -1.7299357342649166, 14.63767490679416, 8.274055846555786, 17.554125152715883, -6.475062558378144, 12.71773739878108], "policy_adversary_policy_reward": [-8.768687287535826, 10.573385422962957, 8.200488351286893, 0.6788017723837854, -27.269803173947658, -17.043006057153235, -24.558071068947648, 2.3637698468146056, -24.772825692351564, -13.280148853395147, -9.009492621305942, -0.14599021162126036, -12.443844447775025, -14.576417692881368, -27.80592781870867, -22.986552248700978, 1.7364010332109245, 12.436971940981593, -23.771871434520143, -14.863383969803621, -27.215121508204824, -6.5473597997574835, -27.46966405490312, -15.890937714580886, -8.504048371836312, -4.781274165096388, 10.155342564401018, 4.705466138163558, 12.262113878592473, -12.493893371733215, -5.102997459318047, -3.9512862098871295, 0.25428781341874185, 8.545590380678995, 5.862386210513925, 5.030966193069844, -20.402517313310764, -10.931393518748074, -0.5536444131414555, -18.989945104260663, -11.50315465066872, -24.21452648766611, -9.732121083230599, -6.619755922849816, -5.413752580218858, -22.090133004812348, 2.215349289961428, -2.761769281004197, -9.08513232866677, -0.7222912892831488, -5.7541367246198085, -13.432002634305373, -8.821182800574746, -25.966653180949486, 7.7303242593833446, -8.324395431610434, 5.026230295829394, -1.5870367020093816, -8.796538125259366, -10.98219632498175, -31.150245384510498, -27.45083307696901, -10.300953363063051, -16.17341748541751, 0.6999932910152253, 8.173455977098, -4.287133954534259, -8.305425623088382, -13.720457222081244, -15.525712500890243, -11.299593193120316, -9.79622467349079, 3.9144172296099313, -25.777826687101797, 6.648435315882601, 2.649225006122556, 0.852608265538759, -3.5152436699633984, -15.985114487171053, -25.494698155593408, 18.66878962767936, -18.728052384670086, 2.562836237767179, 7.06046863304293, -10.34848344221803, -10.872854205260136, 6.454411166401819, -2.5258905645232517, 1.0466022597318343, -12.652014454236813, -26.710696709142802, -9.332994225671545, 1.6854177402754473, 3.866363271600015, 10.800964796156805, -15.318422622257355, -7.478525615852096, -7.425450326420272, -24.314004467091227, 21.084273427570437, -1.2966427057879528, 1.0081550053891561, 2.955139661633531, -8.592870310665926, -12.461427507619092, -17.768171890908466, 0.8974184813913197, -7.145914055396027, -13.347524431602043, -26.203820558285248, -5.702784658626557, -3.3720442418439163, -23.536445849927045, -9.269324154658715, -29.04646807398155, -24.16550816701249, -19.114069303258923, -7.467554421404223, 6.529712137418592, 15.296791909071032, -4.392752166441561, -7.278320949580028, 4.5143638423936565, -21.193662975937194, -18.829598141598733, -19.030303960252123, 12.437562642923925, -10.804755791648304, -7.729706389194341, -28.614365866281727, -19.015208266373342, 0.5669761024886455, 3.7178173127882133, 7.518100535040546, 5.851145668201902, 13.678985738579353, 2.299428514805264, 1.678796491845688, -18.65031008983797, -6.4491633283385426, -28.611785294589808, -7.207997687043001, -24.822454885361058, 14.766207402968675, 6.216139772290369, -0.0754227173294666, 2.427680456469261, -10.403861227848813, 3.3256594541211797, -7.9831740795526756, -8.058825800005899, 1.2496368667376956, -27.693714940297372, -18.741673048732448, -13.451138141108327, 14.310383010467874, 5.005184184451487, 9.813004777742094, 4.183466116399778, -17.74415989025179, -22.000400239304664, -20.246724023988655, 9.210893132006532, 10.477496559869266, 5.845676287184148, 8.054186330370111, -9.619984092285613, -9.352635286824722, 10.154471177606894, -12.644177307016125, -11.56054697099879, -15.730337577357673, -25.518974681574747, 18.14324620701428, -12.312289969468736, -0.9034911326226904, -3.2829378426202744, -30.375619481208595, -19.00542673895236, -13.486295625659615, -11.817928758052837, 2.4458775419840677, -7.761404543893388, 6.4526715040442895, -31.933375905059698, -5.4167242371673545, -23.870540244644662, 0.8101428211149511, -0.7449781634197876, 4.204849631949621, -22.891027330256154, -6.3843224833321734, 1.0046018709901219, -17.552713564101694, -16.130899991378843, -18.977350314052952, 4.2254343765602655, 8.72469074019602, -14.48487288574863, -10.950601911813532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42178248623208864, "mean_inference_ms": 1.1094879377323732, "mean_action_processing_ms": 0.18100871113002776, "mean_env_wait_ms": 0.07366385550577834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036401748657226562, "StateBufferConnector_ms": 0.002559185028076172, "ViewRequirementAgentConnector_ms": 0.07017135620117188}, "num_episodes": 10, "episode_return_max": 10.913252023244812, "episode_return_min": -29.30053923073974, "episode_return_mean": -7.253542639991037}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.2618265115813, "num_env_steps_trained_throughput_per_sec": 487.2618265115813, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 1908000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1908000, "timers": {"training_iteration_time_ms": 8290.964, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8290.926, "sample_time_ms": 802.187, "learn_time_ms": 7475.427, "learn_throughput": 535.087, "synch_weights_time_ms": 12.806}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 1908000, "num_agent_steps_trained": 1908000}, "done": false, "training_iteration": 159, "trial_id": "83a5c_00000", "date": "2024-08-10_12-36-28", "timestamp": 1723307788, "time_this_iter_s": 8.216133832931519, "time_total_s": 1349.262769460678, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc74dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1349.262769460678, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 28.275000000000002, "ram_util_percent": 81.68333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8992042883047984, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3526855219608893, "policy_loss": -0.00792168269485787, "vf_loss": 2.3600826938316306, "vf_explained_var": -0.24266069988725048, "kl": 0.00613273513643069, "entropy": 1.4054533677757102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8041616237411895, "cur_kl_coeff": 1.6992519391578758e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3484896006062628, "policy_loss": -0.008673176396647856, "vf_loss": 1.3571627737333378, "vf_explained_var": 0.19253464018305141, "kl": 0.004782035098115985, "entropy": 0.2955118902182827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 12.595091113565632, "episode_reward_min": -29.30053923073974, "episode_reward_mean": -6.636172251610852, "episode_len_mean": 360.67, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 36067, "policy_reward_min": {"agent_policy": -12.595091113565633, "adversary_policy": -34.85792656805644}, "policy_reward_max": {"agent_policy": 29.300539230739744, "adversary_policy": 21.084273427570437}, "policy_reward_mean": {"agent_policy": 6.6361722516108514, "adversary_policy": -6.636172251610852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.430404351282288, -0.11588974657037099, -4.527141834602588, 4.399939097048868, 5.446676201791885, -15.66695541602942, -9.77179475870106, -17.858840569167413, -8.175938503040207, -13.751942792515603, -0.2732099955213847, -4.903711808974959, -9.593069679462591, -17.393917990762116, -0.2970355861135445, 1.719596796910006, -9.889367225120553, -29.30053923073974, -13.237185424240295, 4.436724634056612, -6.29627978881132, -14.623084861485744, -10.547908933305553, -10.931704728745933, 4.648830161002579, -1.3313177022123277, -20.73990632138223, -0.029631378495363236, 4.811652435405055, -10.610668823739083, 1.9642603009392854, -5.802706097252489, -18.02184546740717, 2.7758905059377312, -2.258728913050275, -7.451987971136184, -1.6148655197603947, -0.14424385019939834, -2.8188653245161976, -15.11479969926378, -3.1242477870023535, -19.775672494943652, -4.5374144502352465, -16.40288500229289, -26.60598812049702, -13.290811862331573, 10.913252023244812, -5.835536558010794, -8.339649566771769, -18.92995105092543, 0.8164034256378105, -18.172036127738036, -9.224116081942348, 5.6179589239143795, 9.76506570339063, 1.989112503325476, -12.549736709088256, -17.90989149081641, -5.028123741196193, 3.070358527480451, -3.9880903856897785, -2.3287573127157497, -3.4045944666341015, -23.21769399451491, 0.4296224346797697, 7.4090944810967905, -6.780346886926006, -21.12356213164666, 9.84419484593791, 6.9499313087771295, -9.486309689555167, -1.2448530647046159, -13.645442274178226, -3.687864237280234, -6.607890551045713, -16.829278661914433, -16.245861182305987, -4.6860256080343845, -0.6543665199245492, -18.675050071113528, -11.530198711764855, 1.7299357342649166, -14.637674906794164, -8.274055846555784, -17.554125152715887, 6.475062558378143, -12.71773739878108, -15.012810442823785, -9.284485705515351, -10.992953400249755, -13.91097901947175, 1.9642932868848089, -16.40431174090995, -7.238942960425749, 2.446596447283728, -6.69678086905029, 0.9650970956395934, 12.595091113565632, -26.39111817097538, 1.841038291373501], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 400, 3, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 1, 17, 400, 3], "policy_agent_policy_reward": [-7.430404351282288, 0.11588974657037099, 4.527141834602588, -4.399939097048868, -5.446676201791885, 15.66695541602942, 9.77179475870106, 17.858840569167413, 8.175938503040207, 13.751942792515603, 0.27320999552138453, 4.903711808974959, 9.593069679462587, 17.393917990762116, 0.2970355861135445, -1.719596796910006, 9.889367225120557, 29.300539230739744, 13.237185424240288, -4.436724634056612, 6.29627978881132, 14.623084861485744, 10.547908933305555, 10.931704728745933, -4.648830161002579, 1.3313177022123153, 20.739906321382232, 0.029631378495363236, -4.811652435405055, 10.610668823739083, -1.9642603009392836, 5.802706097252489, 18.02184546740717, -2.7758905059377312, 2.258728913050275, 7.451987971136184, 1.6148655197603938, 0.14424385019939834, 2.8188653245161976, 15.11479969926378, 3.1242477870023535, 19.775672494943656, 4.537414450235239, 16.402885002292887, 26.605988120497017, 13.290811862331573, -10.913252023244812, 5.835536558010794, 8.339649566771769, 18.929951050925425, -0.8164034256378105, 18.17203612773803, 9.224116081942352, -5.6179589239143795, -9.76506570339063, -1.989112503325476, 12.549736709088256, 17.909891490816406, 5.028123741196193, -3.070358527480451, 3.9880903856897767, 2.328757312715748, 3.4045944666341015, 23.2176939945149, -0.429622434679775, -7.4090944810967905, 6.780346886926006, 21.123562131646658, -9.8441948459379, -6.949931308777129, 9.486309689555167, 1.2448530647046159, 13.645442274178235, 3.687864237280234, 6.607890551045713, 16.829278661914433, 16.245861182305987, 4.6860256080343845, 0.6543665199245492, 18.675050071113525, 11.530198711764854, -1.7299357342649166, 14.63767490679416, 8.274055846555786, 17.554125152715883, -6.475062558378144, 12.71773739878108, 15.012810442823781, 9.284485705515351, 10.992953400249755, 13.910979019471746, -1.964293286884809, 16.404311740909947, 7.238942960425749, -2.446596447283728, 6.69678086905029, -0.9650970956395934, -12.595091113565633, 26.391118170975382, -1.841038291373501], "policy_adversary_policy_reward": [10.155342564401018, 4.705466138163558, 12.262113878592473, -12.493893371733215, -5.102997459318047, -3.9512862098871295, 0.25428781341874185, 8.545590380678995, 5.862386210513925, 5.030966193069844, -20.402517313310764, -10.931393518748074, -0.5536444131414555, -18.989945104260663, -11.50315465066872, -24.21452648766611, -9.732121083230599, -6.619755922849816, -5.413752580218858, -22.090133004812348, 2.215349289961428, -2.761769281004197, -9.08513232866677, -0.7222912892831488, -5.7541367246198085, -13.432002634305373, -8.821182800574746, -25.966653180949486, 7.7303242593833446, -8.324395431610434, 5.026230295829394, -1.5870367020093816, -8.796538125259366, -10.98219632498175, -31.150245384510498, -27.45083307696901, -10.300953363063051, -16.17341748541751, 0.6999932910152253, 8.173455977098, -4.287133954534259, -8.305425623088382, -13.720457222081244, -15.525712500890243, -11.299593193120316, -9.79622467349079, 3.9144172296099313, -25.777826687101797, 6.648435315882601, 2.649225006122556, 0.852608265538759, -3.5152436699633984, -15.985114487171053, -25.494698155593408, 18.66878962767936, -18.728052384670086, 2.562836237767179, 7.06046863304293, -10.34848344221803, -10.872854205260136, 6.454411166401819, -2.5258905645232517, 1.0466022597318343, -12.652014454236813, -26.710696709142802, -9.332994225671545, 1.6854177402754473, 3.866363271600015, 10.800964796156805, -15.318422622257355, -7.478525615852096, -7.425450326420272, -24.314004467091227, 21.084273427570437, -1.2966427057879528, 1.0081550053891561, 2.955139661633531, -8.592870310665926, -12.461427507619092, -17.768171890908466, 0.8974184813913197, -7.145914055396027, -13.347524431602043, -26.203820558285248, -5.702784658626557, -3.3720442418439163, -23.536445849927045, -9.269324154658715, -29.04646807398155, -24.16550816701249, -19.114069303258923, -7.467554421404223, 6.529712137418592, 15.296791909071032, -4.392752166441561, -7.278320949580028, 4.5143638423936565, -21.193662975937194, -18.829598141598733, -19.030303960252123, 12.437562642923925, -10.804755791648304, -7.729706389194341, -28.614365866281727, -19.015208266373342, 0.5669761024886455, 3.7178173127882133, 7.518100535040546, 5.851145668201902, 13.678985738579353, 2.299428514805264, 1.678796491845688, -18.65031008983797, -6.4491633283385426, -28.611785294589808, -7.207997687043001, -24.822454885361058, 14.766207402968675, 6.216139772290369, -0.0754227173294666, 2.427680456469261, -10.403861227848813, 3.3256594541211797, -7.9831740795526756, -8.058825800005899, 1.2496368667376956, -27.693714940297372, -18.741673048732448, -13.451138141108327, 14.310383010467874, 5.005184184451487, 9.813004777742094, 4.183466116399778, -17.74415989025179, -22.000400239304664, -20.246724023988655, 9.210893132006532, 10.477496559869266, 5.845676287184148, 8.054186330370111, -9.619984092285613, -9.352635286824722, 10.154471177606894, -12.644177307016125, -11.56054697099879, -15.730337577357673, -25.518974681574747, 18.14324620701428, -12.312289969468736, -0.9034911326226904, -3.2829378426202744, -30.375619481208595, -19.00542673895236, -13.486295625659615, -11.817928758052837, 2.4458775419840677, -7.761404543893388, 6.4526715040442895, -31.933375905059698, -5.4167242371673545, -23.870540244644662, 0.8101428211149511, -0.7449781634197876, 4.204849631949621, -22.891027330256154, -6.3843224833321734, 1.0046018709901219, -17.552713564101694, -16.130899991378843, -18.977350314052952, 4.2254343765602655, 8.72469074019602, -14.48487288574863, -10.950601911813532, -22.90042103655015, -7.125199849097406, -2.822682667054842, -15.74628874397586, -2.1050686473869007, -19.88083815311261, -6.32120099714238, -21.500757041801112, 3.8286099862868253, 0.09997658748279292, 2.0493030862365416, -34.85792656805644, -32.24401900878187, 17.76613308793037, 1.7853922320014703, 3.1078006625659853, -11.833925381452538, -1.559636356648042, 0.20082938166212472, 1.7293648096170622, 12.757020429584438, 12.433161797546825, -26.690780430531476, -26.09145591141927, 5.987492112733642, -2.3054155299866395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4215808945952253, "mean_inference_ms": 1.1088214140909853, "mean_action_processing_ms": 0.1809455889843533, "mean_env_wait_ms": 0.07361036843303824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003662586212158203, "StateBufferConnector_ms": 0.002644658088684082, "ViewRequirementAgentConnector_ms": 0.07043492794036865}, "num_episodes": 13, "episode_return_max": 12.595091113565632, "episode_return_min": -29.30053923073974, "episode_return_mean": -6.636172251610852}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.19771270268103, "num_env_steps_trained_throughput_per_sec": 485.19771270268103, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 8334.692, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8334.654, "sample_time_ms": 816.303, "learn_time_ms": 7505.301, "learn_throughput": 532.957, "synch_weights_time_ms": 12.547}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 160, "trial_id": "83a5c_00000", "date": "2024-08-10_12-36-36", "timestamp": 1723307796, "time_this_iter_s": 8.25006890296936, "time_total_s": 1357.5128383636475, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd1de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1357.5128383636475, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 27.76666666666667, "ram_util_percent": 81.88333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.766987089189903, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.684003008231915, "policy_loss": -0.007398148106100659, "vf_loss": 2.690447739381639, "vf_explained_var": -0.03074802696389496, "kl": 0.0111476838469944, "entropy": 1.3675005316103577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.666440094448626, "cur_kl_coeff": 8.496259695789379e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8372045669704675, "policy_loss": -0.007774680560396518, "vf_loss": 1.8449792556464673, "vf_explained_var": 0.5825671145071586, "kl": 0.006695773951749117, "entropy": 0.38536019387344517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "env_runners": {"episode_reward_max": 12.595091113565632, "episode_reward_min": -29.30053923073974, "episode_reward_mean": -6.818525537698443, "episode_len_mean": 357.25, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35725, "policy_reward_min": {"agent_policy": -12.595091113565633, "adversary_policy": -34.85792656805644}, "policy_reward_max": {"agent_policy": 29.300539230739744, "adversary_policy": 29.284185917462814}, "policy_reward_mean": {"agent_policy": 6.818525537698443, "adversary_policy": -6.818525537698443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.593069679462591, -17.393917990762116, -0.2970355861135445, 1.719596796910006, -9.889367225120553, -29.30053923073974, -13.237185424240295, 4.436724634056612, -6.29627978881132, -14.623084861485744, -10.547908933305553, -10.931704728745933, 4.648830161002579, -1.3313177022123277, -20.73990632138223, -0.029631378495363236, 4.811652435405055, -10.610668823739083, 1.9642603009392854, -5.802706097252489, -18.02184546740717, 2.7758905059377312, -2.258728913050275, -7.451987971136184, -1.6148655197603947, -0.14424385019939834, -2.8188653245161976, -15.11479969926378, -3.1242477870023535, -19.775672494943652, -4.5374144502352465, -16.40288500229289, -26.60598812049702, -13.290811862331573, 10.913252023244812, -5.835536558010794, -8.339649566771769, -18.92995105092543, 0.8164034256378105, -18.172036127738036, -9.224116081942348, 5.6179589239143795, 9.76506570339063, 1.989112503325476, -12.549736709088256, -17.90989149081641, -5.028123741196193, 3.070358527480451, -3.9880903856897785, -2.3287573127157497, -3.4045944666341015, -23.21769399451491, 0.4296224346797697, 7.4090944810967905, -6.780346886926006, -21.12356213164666, 9.84419484593791, 6.9499313087771295, -9.486309689555167, -1.2448530647046159, -13.645442274178226, -3.687864237280234, -6.607890551045713, -16.829278661914433, -16.245861182305987, -4.6860256080343845, -0.6543665199245492, -18.675050071113528, -11.530198711764855, 1.7299357342649166, -14.637674906794164, -8.274055846555784, -17.554125152715887, 6.475062558378143, -12.71773739878108, -15.012810442823785, -9.284485705515351, -10.992953400249755, -13.91097901947175, 1.9642932868848089, -16.40431174090995, -7.238942960425749, 2.446596447283728, -6.69678086905029, 0.9650970956395934, 12.595091113565632, -26.39111817097538, 1.841038291373501, -15.268923825517764, 3.546344744540356, 9.324562515040949, 0.17972365910904053, -14.428234151734337, -14.273156612036747, -14.732137621505206, -16.76875634308366, -1.4121201577898432, -17.95268411317941, -5.315030018122899, 11.096677540520389], "episode_lengths": [400, 400, 400, 3, 400, 400, 400, 6, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 1, 17, 400, 3, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 59], "policy_agent_policy_reward": [9.593069679462587, 17.393917990762116, 0.2970355861135445, -1.719596796910006, 9.889367225120557, 29.300539230739744, 13.237185424240288, -4.436724634056612, 6.29627978881132, 14.623084861485744, 10.547908933305555, 10.931704728745933, -4.648830161002579, 1.3313177022123153, 20.739906321382232, 0.029631378495363236, -4.811652435405055, 10.610668823739083, -1.9642603009392836, 5.802706097252489, 18.02184546740717, -2.7758905059377312, 2.258728913050275, 7.451987971136184, 1.6148655197603938, 0.14424385019939834, 2.8188653245161976, 15.11479969926378, 3.1242477870023535, 19.775672494943656, 4.537414450235239, 16.402885002292887, 26.605988120497017, 13.290811862331573, -10.913252023244812, 5.835536558010794, 8.339649566771769, 18.929951050925425, -0.8164034256378105, 18.17203612773803, 9.224116081942352, -5.6179589239143795, -9.76506570339063, -1.989112503325476, 12.549736709088256, 17.909891490816406, 5.028123741196193, -3.070358527480451, 3.9880903856897767, 2.328757312715748, 3.4045944666341015, 23.2176939945149, -0.429622434679775, -7.4090944810967905, 6.780346886926006, 21.123562131646658, -9.8441948459379, -6.949931308777129, 9.486309689555167, 1.2448530647046159, 13.645442274178235, 3.687864237280234, 6.607890551045713, 16.829278661914433, 16.245861182305987, 4.6860256080343845, 0.6543665199245492, 18.675050071113525, 11.530198711764854, -1.7299357342649166, 14.63767490679416, 8.274055846555786, 17.554125152715883, -6.475062558378144, 12.71773739878108, 15.012810442823781, 9.284485705515351, 10.992953400249755, 13.910979019471746, -1.964293286884809, 16.404311740909947, 7.238942960425749, -2.446596447283728, 6.69678086905029, -0.9650970956395934, -12.595091113565633, 26.391118170975382, -1.841038291373501, 15.268923825517767, -3.5463447445403524, -9.324562515040949, -0.17972365910904053, 14.428234151734337, 14.273156612036747, 14.732137621505206, 16.768756343083663, 1.4121201577898432, 17.952684113179405, 5.315030018122899, -11.096677540520387], "policy_adversary_policy_reward": [-5.7541367246198085, -13.432002634305373, -8.821182800574746, -25.966653180949486, 7.7303242593833446, -8.324395431610434, 5.026230295829394, -1.5870367020093816, -8.796538125259366, -10.98219632498175, -31.150245384510498, -27.45083307696901, -10.300953363063051, -16.17341748541751, 0.6999932910152253, 8.173455977098, -4.287133954534259, -8.305425623088382, -13.720457222081244, -15.525712500890243, -11.299593193120316, -9.79622467349079, 3.9144172296099313, -25.777826687101797, 6.648435315882601, 2.649225006122556, 0.852608265538759, -3.5152436699633984, -15.985114487171053, -25.494698155593408, 18.66878962767936, -18.728052384670086, 2.562836237767179, 7.06046863304293, -10.34848344221803, -10.872854205260136, 6.454411166401819, -2.5258905645232517, 1.0466022597318343, -12.652014454236813, -26.710696709142802, -9.332994225671545, 1.6854177402754473, 3.866363271600015, 10.800964796156805, -15.318422622257355, -7.478525615852096, -7.425450326420272, -24.314004467091227, 21.084273427570437, -1.2966427057879528, 1.0081550053891561, 2.955139661633531, -8.592870310665926, -12.461427507619092, -17.768171890908466, 0.8974184813913197, -7.145914055396027, -13.347524431602043, -26.203820558285248, -5.702784658626557, -3.3720442418439163, -23.536445849927045, -9.269324154658715, -29.04646807398155, -24.16550816701249, -19.114069303258923, -7.467554421404223, 6.529712137418592, 15.296791909071032, -4.392752166441561, -7.278320949580028, 4.5143638423936565, -21.193662975937194, -18.829598141598733, -19.030303960252123, 12.437562642923925, -10.804755791648304, -7.729706389194341, -28.614365866281727, -19.015208266373342, 0.5669761024886455, 3.7178173127882133, 7.518100535040546, 5.851145668201902, 13.678985738579353, 2.299428514805264, 1.678796491845688, -18.65031008983797, -6.4491633283385426, -28.611785294589808, -7.207997687043001, -24.822454885361058, 14.766207402968675, 6.216139772290369, -0.0754227173294666, 2.427680456469261, -10.403861227848813, 3.3256594541211797, -7.9831740795526756, -8.058825800005899, 1.2496368667376956, -27.693714940297372, -18.741673048732448, -13.451138141108327, 14.310383010467874, 5.005184184451487, 9.813004777742094, 4.183466116399778, -17.74415989025179, -22.000400239304664, -20.246724023988655, 9.210893132006532, 10.477496559869266, 5.845676287184148, 8.054186330370111, -9.619984092285613, -9.352635286824722, 10.154471177606894, -12.644177307016125, -11.56054697099879, -15.730337577357673, -25.518974681574747, 18.14324620701428, -12.312289969468736, -0.9034911326226904, -3.2829378426202744, -30.375619481208595, -19.00542673895236, -13.486295625659615, -11.817928758052837, 2.4458775419840677, -7.761404543893388, 6.4526715040442895, -31.933375905059698, -5.4167242371673545, -23.870540244644662, 0.8101428211149511, -0.7449781634197876, 4.204849631949621, -22.891027330256154, -6.3843224833321734, 1.0046018709901219, -17.552713564101694, -16.130899991378843, -18.977350314052952, 4.2254343765602655, 8.72469074019602, -14.48487288574863, -10.950601911813532, -22.90042103655015, -7.125199849097406, -2.822682667054842, -15.74628874397586, -2.1050686473869007, -19.88083815311261, -6.32120099714238, -21.500757041801112, 3.8286099862868253, 0.09997658748279292, 2.0493030862365416, -34.85792656805644, -32.24401900878187, 17.76613308793037, 1.7853922320014703, 3.1078006625659853, -11.833925381452538, -1.559636356648042, 0.20082938166212472, 1.7293648096170622, 12.757020429584438, 12.433161797546825, -26.690780430531476, -26.09145591141927, 5.987492112733642, -2.3054155299866395, -27.699380676308483, -2.838466974727041, 10.704273180183222, -3.611583691102517, 29.284185917462814, -10.635060887380916, 0.7254667907864207, -0.36601947256833967, -13.381939965161695, -15.474528338306978, -10.49294010032093, -18.05337312375256, -22.831985606353815, -6.632289636656598, -11.064823777292467, -22.47268890887485, -2.3054505964039933, -0.5187897191756932, -15.240934649597044, -20.664433576761763, -0.8661804457853037, -9.763879590460494, 11.785992021353625, 10.40736305968716]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42142177639899453, "mean_inference_ms": 1.1081043393211354, "mean_action_processing_ms": 0.1808377465262981, "mean_env_wait_ms": 0.07355304971107407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003532886505126953, "StateBufferConnector_ms": 0.0025709867477416992, "ViewRequirementAgentConnector_ms": 0.06742918491363525}, "num_episodes": 12, "episode_return_max": 12.595091113565632, "episode_return_min": -29.30053923073974, "episode_return_mean": -6.818525537698443}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.4797553240753, "num_env_steps_trained_throughput_per_sec": 481.4797553240753, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 1932000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1932000, "timers": {"training_iteration_time_ms": 8356.443, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8356.404, "sample_time_ms": 815.018, "learn_time_ms": 7527.663, "learn_throughput": 531.373, "synch_weights_time_ms": 13.227}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 1932000, "num_agent_steps_trained": 1932000}, "done": false, "training_iteration": 161, "trial_id": "83a5c_00000", "date": "2024-08-10_12-36-44", "timestamp": 1723307804, "time_this_iter_s": 8.316133260726929, "time_total_s": 1365.8289716243744, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd820d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1365.8289716243744, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 28.872727272727275, "ram_util_percent": 82.03636363636362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2324560219017915, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.547154430989866, "policy_loss": -0.004326779431559973, "vf_loss": 3.55065359968357, "vf_explained_var": 0.12648226357010936, "kl": 0.009676762836441534, "entropy": 1.3692161177831983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.917722366626064, "cur_kl_coeff": 8.496259695789379e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0040701482445002, "policy_loss": -0.004564944719459163, "vf_loss": 3.008635095010201, "vf_explained_var": 0.33556549934049446, "kl": 0.0029611329520358907, "entropy": 0.3572076853364706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "env_runners": {"episode_reward_max": 26.770384095277887, "episode_reward_min": -26.60598812049702, "episode_reward_mean": -6.4587146603234995, "episode_len_mean": 365.16, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36516, "policy_reward_min": {"agent_policy": -26.77038409527784, "adversary_policy": -34.85792656805644}, "policy_reward_max": {"agent_policy": 26.605988120497017, "adversary_policy": 36.98167156445223}, "policy_reward_mean": {"agent_policy": 6.458714660323501, "adversary_policy": -6.458714660323501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.931704728745933, 4.648830161002579, -1.3313177022123277, -20.73990632138223, -0.029631378495363236, 4.811652435405055, -10.610668823739083, 1.9642603009392854, -5.802706097252489, -18.02184546740717, 2.7758905059377312, -2.258728913050275, -7.451987971136184, -1.6148655197603947, -0.14424385019939834, -2.8188653245161976, -15.11479969926378, -3.1242477870023535, -19.775672494943652, -4.5374144502352465, -16.40288500229289, -26.60598812049702, -13.290811862331573, 10.913252023244812, -5.835536558010794, -8.339649566771769, -18.92995105092543, 0.8164034256378105, -18.172036127738036, -9.224116081942348, 5.6179589239143795, 9.76506570339063, 1.989112503325476, -12.549736709088256, -17.90989149081641, -5.028123741196193, 3.070358527480451, -3.9880903856897785, -2.3287573127157497, -3.4045944666341015, -23.21769399451491, 0.4296224346797697, 7.4090944810967905, -6.780346886926006, -21.12356213164666, 9.84419484593791, 6.9499313087771295, -9.486309689555167, -1.2448530647046159, -13.645442274178226, -3.687864237280234, -6.607890551045713, -16.829278661914433, -16.245861182305987, -4.6860256080343845, -0.6543665199245492, -18.675050071113528, -11.530198711764855, 1.7299357342649166, -14.637674906794164, -8.274055846555784, -17.554125152715887, 6.475062558378143, -12.71773739878108, -15.012810442823785, -9.284485705515351, -10.992953400249755, -13.91097901947175, 1.9642932868848089, -16.40431174090995, -7.238942960425749, 2.446596447283728, -6.69678086905029, 0.9650970956395934, 12.595091113565632, -26.39111817097538, 1.841038291373501, -15.268923825517764, 3.546344744540356, 9.324562515040949, 0.17972365910904053, -14.428234151734337, -14.273156612036747, -14.732137621505206, -16.76875634308366, -1.4121201577898432, -17.95268411317941, -5.315030018122899, 11.096677540520389, -7.46575749218351, -10.37489552378964, -7.401898383247829, -14.877951321700696, -0.9299693381261172, -22.49668996502641, 3.5734109775501492, -9.534895725537742, 26.770384095277887, -15.15481849864917, -11.147898376147399], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 1, 17, 400, 3, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [10.931704728745933, -4.648830161002579, 1.3313177022123153, 20.739906321382232, 0.029631378495363236, -4.811652435405055, 10.610668823739083, -1.9642603009392836, 5.802706097252489, 18.02184546740717, -2.7758905059377312, 2.258728913050275, 7.451987971136184, 1.6148655197603938, 0.14424385019939834, 2.8188653245161976, 15.11479969926378, 3.1242477870023535, 19.775672494943656, 4.537414450235239, 16.402885002292887, 26.605988120497017, 13.290811862331573, -10.913252023244812, 5.835536558010794, 8.339649566771769, 18.929951050925425, -0.8164034256378105, 18.17203612773803, 9.224116081942352, -5.6179589239143795, -9.76506570339063, -1.989112503325476, 12.549736709088256, 17.909891490816406, 5.028123741196193, -3.070358527480451, 3.9880903856897767, 2.328757312715748, 3.4045944666341015, 23.2176939945149, -0.429622434679775, -7.4090944810967905, 6.780346886926006, 21.123562131646658, -9.8441948459379, -6.949931308777129, 9.486309689555167, 1.2448530647046159, 13.645442274178235, 3.687864237280234, 6.607890551045713, 16.829278661914433, 16.245861182305987, 4.6860256080343845, 0.6543665199245492, 18.675050071113525, 11.530198711764854, -1.7299357342649166, 14.63767490679416, 8.274055846555786, 17.554125152715883, -6.475062558378144, 12.71773739878108, 15.012810442823781, 9.284485705515351, 10.992953400249755, 13.910979019471746, -1.964293286884809, 16.404311740909947, 7.238942960425749, -2.446596447283728, 6.69678086905029, -0.9650970956395934, -12.595091113565633, 26.391118170975382, -1.841038291373501, 15.268923825517767, -3.5463447445403524, -9.324562515040949, -0.17972365910904053, 14.428234151734337, 14.273156612036747, 14.732137621505206, 16.768756343083663, 1.4121201577898432, 17.952684113179405, 5.315030018122899, -11.096677540520387, 7.46575749218351, 10.37489552378964, 7.401898383247829, 14.877951321700696, 0.9299693381261047, 22.496689965026434, -3.5734109775501492, 9.534895725537742, -26.77038409527784, 15.15481849864917, 11.147898376147396], "policy_adversary_policy_reward": [3.9144172296099313, -25.777826687101797, 6.648435315882601, 2.649225006122556, 0.852608265538759, -3.5152436699633984, -15.985114487171053, -25.494698155593408, 18.66878962767936, -18.728052384670086, 2.562836237767179, 7.06046863304293, -10.34848344221803, -10.872854205260136, 6.454411166401819, -2.5258905645232517, 1.0466022597318343, -12.652014454236813, -26.710696709142802, -9.332994225671545, 1.6854177402754473, 3.866363271600015, 10.800964796156805, -15.318422622257355, -7.478525615852096, -7.425450326420272, -24.314004467091227, 21.084273427570437, -1.2966427057879528, 1.0081550053891561, 2.955139661633531, -8.592870310665926, -12.461427507619092, -17.768171890908466, 0.8974184813913197, -7.145914055396027, -13.347524431602043, -26.203820558285248, -5.702784658626557, -3.3720442418439163, -23.536445849927045, -9.269324154658715, -29.04646807398155, -24.16550816701249, -19.114069303258923, -7.467554421404223, 6.529712137418592, 15.296791909071032, -4.392752166441561, -7.278320949580028, 4.5143638423936565, -21.193662975937194, -18.829598141598733, -19.030303960252123, 12.437562642923925, -10.804755791648304, -7.729706389194341, -28.614365866281727, -19.015208266373342, 0.5669761024886455, 3.7178173127882133, 7.518100535040546, 5.851145668201902, 13.678985738579353, 2.299428514805264, 1.678796491845688, -18.65031008983797, -6.4491633283385426, -28.611785294589808, -7.207997687043001, -24.822454885361058, 14.766207402968675, 6.216139772290369, -0.0754227173294666, 2.427680456469261, -10.403861227848813, 3.3256594541211797, -7.9831740795526756, -8.058825800005899, 1.2496368667376956, -27.693714940297372, -18.741673048732448, -13.451138141108327, 14.310383010467874, 5.005184184451487, 9.813004777742094, 4.183466116399778, -17.74415989025179, -22.000400239304664, -20.246724023988655, 9.210893132006532, 10.477496559869266, 5.845676287184148, 8.054186330370111, -9.619984092285613, -9.352635286824722, 10.154471177606894, -12.644177307016125, -11.56054697099879, -15.730337577357673, -25.518974681574747, 18.14324620701428, -12.312289969468736, -0.9034911326226904, -3.2829378426202744, -30.375619481208595, -19.00542673895236, -13.486295625659615, -11.817928758052837, 2.4458775419840677, -7.761404543893388, 6.4526715040442895, -31.933375905059698, -5.4167242371673545, -23.870540244644662, 0.8101428211149511, -0.7449781634197876, 4.204849631949621, -22.891027330256154, -6.3843224833321734, 1.0046018709901219, -17.552713564101694, -16.130899991378843, -18.977350314052952, 4.2254343765602655, 8.72469074019602, -14.48487288574863, -10.950601911813532, -22.90042103655015, -7.125199849097406, -2.822682667054842, -15.74628874397586, -2.1050686473869007, -19.88083815311261, -6.32120099714238, -21.500757041801112, 3.8286099862868253, 0.09997658748279292, 2.0493030862365416, -34.85792656805644, -32.24401900878187, 17.76613308793037, 1.7853922320014703, 3.1078006625659853, -11.833925381452538, -1.559636356648042, 0.20082938166212472, 1.7293648096170622, 12.757020429584438, 12.433161797546825, -26.690780430531476, -26.09145591141927, 5.987492112733642, -2.3054155299866395, -27.699380676308483, -2.838466974727041, 10.704273180183222, -3.611583691102517, 29.284185917462814, -10.635060887380916, 0.7254667907864207, -0.36601947256833967, -13.381939965161695, -15.474528338306978, -10.49294010032093, -18.05337312375256, -22.831985606353815, -6.632289636656598, -11.064823777292467, -22.47268890887485, -2.3054505964039933, -0.5187897191756932, -15.240934649597044, -20.664433576761763, -0.8661804457853037, -9.763879590460494, 11.785992021353625, 10.40736305968716, 4.465063457322323, -19.396578441689343, -17.45190694800403, -3.297884099575249, -5.028464855749839, -9.77533191074582, -14.291824471133921, -15.464078172267474, 4.105776161773189, -5.965714838025404, -10.808843729305316, -34.18453620074749, -0.8959747918069638, 8.042796746907264, -23.253407517476973, 4.183616066401484, 16.55909662610343, 36.98167156445223, -4.471073665115966, -25.838563332182378, -18.13272731508481, -4.1630694372100265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42120954810195194, "mean_inference_ms": 1.1077777339784984, "mean_action_processing_ms": 0.18083614967649855, "mean_env_wait_ms": 0.07352405336513154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003731966018676758, "StateBufferConnector_ms": 0.0029717683792114258, "ViewRequirementAgentConnector_ms": 0.07223403453826904}, "num_episodes": 11, "episode_return_max": 26.770384095277887, "episode_return_min": -26.60598812049702, "episode_return_mean": -6.4587146603234995}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 463.20025316244613, "num_env_steps_trained_throughput_per_sec": 463.20025316244613, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 1944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1944000, "timers": {"training_iteration_time_ms": 8391.013, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8390.975, "sample_time_ms": 826.298, "learn_time_ms": 7550.681, "learn_throughput": 529.754, "synch_weights_time_ms": 13.442}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "done": false, "training_iteration": 162, "trial_id": "83a5c_00000", "date": "2024-08-10_12-36-53", "timestamp": 1723307813, "time_this_iter_s": 8.64281415939331, "time_total_s": 1374.4717857837677, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd82310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1374.4717857837677, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 30.292307692307695, "ram_util_percent": 83.08461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7740470905783314, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4711133726059447, "policy_loss": -0.005665416301045783, "vf_loss": 3.4757911513091395, "vf_explained_var": -0.0012907445746124105, "kl": 0.011547788726542448, "entropy": 1.3808236028151537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.076469774544239, "cur_kl_coeff": 4.2481298478946895e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.236028830707073, "policy_loss": -0.005665600304928376, "vf_loss": 3.2416944262882073, "vf_explained_var": 0.7394866089026133, "kl": 0.0069990016483852295, "entropy": 0.3789421691559255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "env_runners": {"episode_reward_max": 26.770384095277887, "episode_reward_min": -26.60598812049702, "episode_reward_mean": -7.175698787668658, "episode_len_mean": 365.16, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36516, "policy_reward_min": {"agent_policy": -26.77038409527784, "adversary_policy": -37.492165875489576}, "policy_reward_max": {"agent_policy": 26.605988120497017, "adversary_policy": 36.98167156445223}, "policy_reward_mean": {"agent_policy": 7.175698787668658, "adversary_policy": -7.17569878766866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.02184546740717, 2.7758905059377312, -2.258728913050275, -7.451987971136184, -1.6148655197603947, -0.14424385019939834, -2.8188653245161976, -15.11479969926378, -3.1242477870023535, -19.775672494943652, -4.5374144502352465, -16.40288500229289, -26.60598812049702, -13.290811862331573, 10.913252023244812, -5.835536558010794, -8.339649566771769, -18.92995105092543, 0.8164034256378105, -18.172036127738036, -9.224116081942348, 5.6179589239143795, 9.76506570339063, 1.989112503325476, -12.549736709088256, -17.90989149081641, -5.028123741196193, 3.070358527480451, -3.9880903856897785, -2.3287573127157497, -3.4045944666341015, -23.21769399451491, 0.4296224346797697, 7.4090944810967905, -6.780346886926006, -21.12356213164666, 9.84419484593791, 6.9499313087771295, -9.486309689555167, -1.2448530647046159, -13.645442274178226, -3.687864237280234, -6.607890551045713, -16.829278661914433, -16.245861182305987, -4.6860256080343845, -0.6543665199245492, -18.675050071113528, -11.530198711764855, 1.7299357342649166, -14.637674906794164, -8.274055846555784, -17.554125152715887, 6.475062558378143, -12.71773739878108, -15.012810442823785, -9.284485705515351, -10.992953400249755, -13.91097901947175, 1.9642932868848089, -16.40431174090995, -7.238942960425749, 2.446596447283728, -6.69678086905029, 0.9650970956395934, 12.595091113565632, -26.39111817097538, 1.841038291373501, -15.268923825517764, 3.546344744540356, 9.324562515040949, 0.17972365910904053, -14.428234151734337, -14.273156612036747, -14.732137621505206, -16.76875634308366, -1.4121201577898432, -17.95268411317941, -5.315030018122899, 11.096677540520389, -7.46575749218351, -10.37489552378964, -7.401898383247829, -14.877951321700696, -0.9299693381261172, -22.49668996502641, 3.5734109775501492, -9.534895725537742, 26.770384095277887, -15.15481849864917, -11.147898376147399, -22.016232660821682, -7.7646085757944, -24.60006205883015, -3.2959597212506164, -1.255907595776785, -19.03432975749136, -18.11860095305215, -18.173906613299213, 4.5400030473200985], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 1, 17, 400, 3, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [18.02184546740717, -2.7758905059377312, 2.258728913050275, 7.451987971136184, 1.6148655197603938, 0.14424385019939834, 2.8188653245161976, 15.11479969926378, 3.1242477870023535, 19.775672494943656, 4.537414450235239, 16.402885002292887, 26.605988120497017, 13.290811862331573, -10.913252023244812, 5.835536558010794, 8.339649566771769, 18.929951050925425, -0.8164034256378105, 18.17203612773803, 9.224116081942352, -5.6179589239143795, -9.76506570339063, -1.989112503325476, 12.549736709088256, 17.909891490816406, 5.028123741196193, -3.070358527480451, 3.9880903856897767, 2.328757312715748, 3.4045944666341015, 23.2176939945149, -0.429622434679775, -7.4090944810967905, 6.780346886926006, 21.123562131646658, -9.8441948459379, -6.949931308777129, 9.486309689555167, 1.2448530647046159, 13.645442274178235, 3.687864237280234, 6.607890551045713, 16.829278661914433, 16.245861182305987, 4.6860256080343845, 0.6543665199245492, 18.675050071113525, 11.530198711764854, -1.7299357342649166, 14.63767490679416, 8.274055846555786, 17.554125152715883, -6.475062558378144, 12.71773739878108, 15.012810442823781, 9.284485705515351, 10.992953400249755, 13.910979019471746, -1.964293286884809, 16.404311740909947, 7.238942960425749, -2.446596447283728, 6.69678086905029, -0.9650970956395934, -12.595091113565633, 26.391118170975382, -1.841038291373501, 15.268923825517767, -3.5463447445403524, -9.324562515040949, -0.17972365910904053, 14.428234151734337, 14.273156612036747, 14.732137621505206, 16.768756343083663, 1.4121201577898432, 17.952684113179405, 5.315030018122899, -11.096677540520387, 7.46575749218351, 10.37489552378964, 7.401898383247829, 14.877951321700696, 0.9299693381261047, 22.496689965026434, -3.5734109775501492, 9.534895725537742, -26.77038409527784, 15.15481849864917, 11.147898376147396, 22.016232660821686, 7.764608575794405, 24.600062058830147, 3.2959597212506164, 1.255907595776785, 19.034329757491356, 18.118600953052155, 18.173906613299224, -4.5400030473200985], "policy_adversary_policy_reward": [-26.710696709142802, -9.332994225671545, 1.6854177402754473, 3.866363271600015, 10.800964796156805, -15.318422622257355, -7.478525615852096, -7.425450326420272, -24.314004467091227, 21.084273427570437, -1.2966427057879528, 1.0081550053891561, 2.955139661633531, -8.592870310665926, -12.461427507619092, -17.768171890908466, 0.8974184813913197, -7.145914055396027, -13.347524431602043, -26.203820558285248, -5.702784658626557, -3.3720442418439163, -23.536445849927045, -9.269324154658715, -29.04646807398155, -24.16550816701249, -19.114069303258923, -7.467554421404223, 6.529712137418592, 15.296791909071032, -4.392752166441561, -7.278320949580028, 4.5143638423936565, -21.193662975937194, -18.829598141598733, -19.030303960252123, 12.437562642923925, -10.804755791648304, -7.729706389194341, -28.614365866281727, -19.015208266373342, 0.5669761024886455, 3.7178173127882133, 7.518100535040546, 5.851145668201902, 13.678985738579353, 2.299428514805264, 1.678796491845688, -18.65031008983797, -6.4491633283385426, -28.611785294589808, -7.207997687043001, -24.822454885361058, 14.766207402968675, 6.216139772290369, -0.0754227173294666, 2.427680456469261, -10.403861227848813, 3.3256594541211797, -7.9831740795526756, -8.058825800005899, 1.2496368667376956, -27.693714940297372, -18.741673048732448, -13.451138141108327, 14.310383010467874, 5.005184184451487, 9.813004777742094, 4.183466116399778, -17.74415989025179, -22.000400239304664, -20.246724023988655, 9.210893132006532, 10.477496559869266, 5.845676287184148, 8.054186330370111, -9.619984092285613, -9.352635286824722, 10.154471177606894, -12.644177307016125, -11.56054697099879, -15.730337577357673, -25.518974681574747, 18.14324620701428, -12.312289969468736, -0.9034911326226904, -3.2829378426202744, -30.375619481208595, -19.00542673895236, -13.486295625659615, -11.817928758052837, 2.4458775419840677, -7.761404543893388, 6.4526715040442895, -31.933375905059698, -5.4167242371673545, -23.870540244644662, 0.8101428211149511, -0.7449781634197876, 4.204849631949621, -22.891027330256154, -6.3843224833321734, 1.0046018709901219, -17.552713564101694, -16.130899991378843, -18.977350314052952, 4.2254343765602655, 8.72469074019602, -14.48487288574863, -10.950601911813532, -22.90042103655015, -7.125199849097406, -2.822682667054842, -15.74628874397586, -2.1050686473869007, -19.88083815311261, -6.32120099714238, -21.500757041801112, 3.8286099862868253, 0.09997658748279292, 2.0493030862365416, -34.85792656805644, -32.24401900878187, 17.76613308793037, 1.7853922320014703, 3.1078006625659853, -11.833925381452538, -1.559636356648042, 0.20082938166212472, 1.7293648096170622, 12.757020429584438, 12.433161797546825, -26.690780430531476, -26.09145591141927, 5.987492112733642, -2.3054155299866395, -27.699380676308483, -2.838466974727041, 10.704273180183222, -3.611583691102517, 29.284185917462814, -10.635060887380916, 0.7254667907864207, -0.36601947256833967, -13.381939965161695, -15.474528338306978, -10.49294010032093, -18.05337312375256, -22.831985606353815, -6.632289636656598, -11.064823777292467, -22.47268890887485, -2.3054505964039933, -0.5187897191756932, -15.240934649597044, -20.664433576761763, -0.8661804457853037, -9.763879590460494, 11.785992021353625, 10.40736305968716, 4.465063457322323, -19.396578441689343, -17.45190694800403, -3.297884099575249, -5.028464855749839, -9.77533191074582, -14.291824471133921, -15.464078172267474, 4.105776161773189, -5.965714838025404, -10.808843729305316, -34.18453620074749, -0.8959747918069638, 8.042796746907264, -23.253407517476973, 4.183616066401484, 16.55909662610343, 36.98167156445223, -4.471073665115966, -25.838563332182378, -18.13272731508481, -4.1630694372100265, -37.492165875489576, -6.540299446153824, -16.93838772773818, 1.4091705761493714, -22.8604725875468, -26.339651530113493, -8.974484473152547, 2.382565030651314, -4.005455612034712, 1.4936404204811424, -16.64249059469891, -21.4261689202838, -8.450027511514183, -27.787174394590146, -15.157066344632138, -21.190746881966323, 0.2678818531067222, 8.812124241533475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42108189021919473, "mean_inference_ms": 1.1073965983840777, "mean_action_processing_ms": 0.18083244688102706, "mean_env_wait_ms": 0.07350166846819751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003981232643127441, "StateBufferConnector_ms": 0.0030325651168823242, "ViewRequirementAgentConnector_ms": 0.07060074806213379}, "num_episodes": 9, "episode_return_max": 26.770384095277887, "episode_return_min": -26.60598812049702, "episode_return_mean": -7.175698787668658}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 448.3348384526899, "num_env_steps_trained_throughput_per_sec": 448.3348384526899, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 1956000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1956000, "timers": {"training_iteration_time_ms": 8348.852, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8348.816, "sample_time_ms": 819.721, "learn_time_ms": 7515.292, "learn_throughput": 532.248, "synch_weights_time_ms": 13.289}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 1956000, "num_agent_steps_trained": 1956000}, "done": false, "training_iteration": 163, "trial_id": "83a5c_00000", "date": "2024-08-10_12-37-02", "timestamp": 1723307822, "time_this_iter_s": 8.926702737808228, "time_total_s": 1383.398488521576, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd821f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1383.398488521576, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 35.43333333333334, "ram_util_percent": 83.16666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.166699117422104, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5350337027241943, "policy_loss": -0.009801792950497537, "vf_loss": 2.543793474681794, "vf_explained_var": 0.09228978298959278, "kl": 0.012183611891818887, "entropy": 1.350095236742938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.431019872799515, "cur_kl_coeff": 4.2481298478946895e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2238698940103254, "policy_loss": -0.014250915483474576, "vf_loss": 2.2381208135435977, "vf_explained_var": 0.5520011590793729, "kl": 0.020664390817906927, "entropy": 0.32240634141489866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 26.770384095277887, "episode_reward_min": -26.66915607120948, "episode_reward_mean": -7.5887769424735145, "episode_len_mean": 365.16, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36516, "policy_reward_min": {"agent_policy": -26.77038409527784, "adversary_policy": -37.492165875489576}, "policy_reward_max": {"agent_policy": 26.669156071209475, "adversary_policy": 36.98167156445223}, "policy_reward_mean": {"agent_policy": 7.5887769424735145, "adversary_policy": -7.5887769424735145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.40288500229289, -26.60598812049702, -13.290811862331573, 10.913252023244812, -5.835536558010794, -8.339649566771769, -18.92995105092543, 0.8164034256378105, -18.172036127738036, -9.224116081942348, 5.6179589239143795, 9.76506570339063, 1.989112503325476, -12.549736709088256, -17.90989149081641, -5.028123741196193, 3.070358527480451, -3.9880903856897785, -2.3287573127157497, -3.4045944666341015, -23.21769399451491, 0.4296224346797697, 7.4090944810967905, -6.780346886926006, -21.12356213164666, 9.84419484593791, 6.9499313087771295, -9.486309689555167, -1.2448530647046159, -13.645442274178226, -3.687864237280234, -6.607890551045713, -16.829278661914433, -16.245861182305987, -4.6860256080343845, -0.6543665199245492, -18.675050071113528, -11.530198711764855, 1.7299357342649166, -14.637674906794164, -8.274055846555784, -17.554125152715887, 6.475062558378143, -12.71773739878108, -15.012810442823785, -9.284485705515351, -10.992953400249755, -13.91097901947175, 1.9642932868848089, -16.40431174090995, -7.238942960425749, 2.446596447283728, -6.69678086905029, 0.9650970956395934, 12.595091113565632, -26.39111817097538, 1.841038291373501, -15.268923825517764, 3.546344744540356, 9.324562515040949, 0.17972365910904053, -14.428234151734337, -14.273156612036747, -14.732137621505206, -16.76875634308366, -1.4121201577898432, -17.95268411317941, -5.315030018122899, 11.096677540520389, -7.46575749218351, -10.37489552378964, -7.401898383247829, -14.877951321700696, -0.9299693381261172, -22.49668996502641, 3.5734109775501492, -9.534895725537742, 26.770384095277887, -15.15481849864917, -11.147898376147399, -22.016232660821682, -7.7646085757944, -24.60006205883015, -3.2959597212506164, -1.255907595776785, -19.03432975749136, -18.11860095305215, -18.173906613299213, 4.5400030473200985, -5.005262006967364, -16.937894829325092, -6.346492576401619, -18.894236296377546, -19.884306396745632, 10.6533712398756, -4.205931610058915, -3.791480239933687, -15.234618819830754, -7.078588845087964, -26.66915607120948], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 12, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 1, 17, 400, 3, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [16.402885002292887, 26.605988120497017, 13.290811862331573, -10.913252023244812, 5.835536558010794, 8.339649566771769, 18.929951050925425, -0.8164034256378105, 18.17203612773803, 9.224116081942352, -5.6179589239143795, -9.76506570339063, -1.989112503325476, 12.549736709088256, 17.909891490816406, 5.028123741196193, -3.070358527480451, 3.9880903856897767, 2.328757312715748, 3.4045944666341015, 23.2176939945149, -0.429622434679775, -7.4090944810967905, 6.780346886926006, 21.123562131646658, -9.8441948459379, -6.949931308777129, 9.486309689555167, 1.2448530647046159, 13.645442274178235, 3.687864237280234, 6.607890551045713, 16.829278661914433, 16.245861182305987, 4.6860256080343845, 0.6543665199245492, 18.675050071113525, 11.530198711764854, -1.7299357342649166, 14.63767490679416, 8.274055846555786, 17.554125152715883, -6.475062558378144, 12.71773739878108, 15.012810442823781, 9.284485705515351, 10.992953400249755, 13.910979019471746, -1.964293286884809, 16.404311740909947, 7.238942960425749, -2.446596447283728, 6.69678086905029, -0.9650970956395934, -12.595091113565633, 26.391118170975382, -1.841038291373501, 15.268923825517767, -3.5463447445403524, -9.324562515040949, -0.17972365910904053, 14.428234151734337, 14.273156612036747, 14.732137621505206, 16.768756343083663, 1.4121201577898432, 17.952684113179405, 5.315030018122899, -11.096677540520387, 7.46575749218351, 10.37489552378964, 7.401898383247829, 14.877951321700696, 0.9299693381261047, 22.496689965026434, -3.5734109775501492, 9.534895725537742, -26.77038409527784, 15.15481849864917, 11.147898376147396, 22.016232660821686, 7.764608575794405, 24.600062058830147, 3.2959597212506164, 1.255907595776785, 19.034329757491356, 18.118600953052155, 18.173906613299224, -4.5400030473200985, 5.005262006967364, 16.93789482932509, 6.346492576401619, 18.89423629637755, 19.884306396745636, -10.653371239875595, 4.205931610058926, 3.791480239933687, 15.234618819830754, 7.078588845087964, 26.669156071209475], "policy_adversary_policy_reward": [-23.536445849927045, -9.269324154658715, -29.04646807398155, -24.16550816701249, -19.114069303258923, -7.467554421404223, 6.529712137418592, 15.296791909071032, -4.392752166441561, -7.278320949580028, 4.5143638423936565, -21.193662975937194, -18.829598141598733, -19.030303960252123, 12.437562642923925, -10.804755791648304, -7.729706389194341, -28.614365866281727, -19.015208266373342, 0.5669761024886455, 3.7178173127882133, 7.518100535040546, 5.851145668201902, 13.678985738579353, 2.299428514805264, 1.678796491845688, -18.65031008983797, -6.4491633283385426, -28.611785294589808, -7.207997687043001, -24.822454885361058, 14.766207402968675, 6.216139772290369, -0.0754227173294666, 2.427680456469261, -10.403861227848813, 3.3256594541211797, -7.9831740795526756, -8.058825800005899, 1.2496368667376956, -27.693714940297372, -18.741673048732448, -13.451138141108327, 14.310383010467874, 5.005184184451487, 9.813004777742094, 4.183466116399778, -17.74415989025179, -22.000400239304664, -20.246724023988655, 9.210893132006532, 10.477496559869266, 5.845676287184148, 8.054186330370111, -9.619984092285613, -9.352635286824722, 10.154471177606894, -12.644177307016125, -11.56054697099879, -15.730337577357673, -25.518974681574747, 18.14324620701428, -12.312289969468736, -0.9034911326226904, -3.2829378426202744, -30.375619481208595, -19.00542673895236, -13.486295625659615, -11.817928758052837, 2.4458775419840677, -7.761404543893388, 6.4526715040442895, -31.933375905059698, -5.4167242371673545, -23.870540244644662, 0.8101428211149511, -0.7449781634197876, 4.204849631949621, -22.891027330256154, -6.3843224833321734, 1.0046018709901219, -17.552713564101694, -16.130899991378843, -18.977350314052952, 4.2254343765602655, 8.72469074019602, -14.48487288574863, -10.950601911813532, -22.90042103655015, -7.125199849097406, -2.822682667054842, -15.74628874397586, -2.1050686473869007, -19.88083815311261, -6.32120099714238, -21.500757041801112, 3.8286099862868253, 0.09997658748279292, 2.0493030862365416, -34.85792656805644, -32.24401900878187, 17.76613308793037, 1.7853922320014703, 3.1078006625659853, -11.833925381452538, -1.559636356648042, 0.20082938166212472, 1.7293648096170622, 12.757020429584438, 12.433161797546825, -26.690780430531476, -26.09145591141927, 5.987492112733642, -2.3054155299866395, -27.699380676308483, -2.838466974727041, 10.704273180183222, -3.611583691102517, 29.284185917462814, -10.635060887380916, 0.7254667907864207, -0.36601947256833967, -13.381939965161695, -15.474528338306978, -10.49294010032093, -18.05337312375256, -22.831985606353815, -6.632289636656598, -11.064823777292467, -22.47268890887485, -2.3054505964039933, -0.5187897191756932, -15.240934649597044, -20.664433576761763, -0.8661804457853037, -9.763879590460494, 11.785992021353625, 10.40736305968716, 4.465063457322323, -19.396578441689343, -17.45190694800403, -3.297884099575249, -5.028464855749839, -9.77533191074582, -14.291824471133921, -15.464078172267474, 4.105776161773189, -5.965714838025404, -10.808843729305316, -34.18453620074749, -0.8959747918069638, 8.042796746907264, -23.253407517476973, 4.183616066401484, 16.55909662610343, 36.98167156445223, -4.471073665115966, -25.838563332182378, -18.13272731508481, -4.1630694372100265, -37.492165875489576, -6.540299446153824, -16.93838772773818, 1.4091705761493714, -22.8604725875468, -26.339651530113493, -8.974484473152547, 2.382565030651314, -4.005455612034712, 1.4936404204811424, -16.64249059469891, -21.4261689202838, -8.450027511514183, -27.787174394590146, -15.157066344632138, -21.190746881966323, 0.2678818531067222, 8.812124241533475, 10.728144014930812, -20.73866802886554, -10.706437156685329, -23.169352501964852, -14.402009960889671, 1.7090248080864328, -7.890985197035857, -29.897487395719253, -31.172093572411015, -8.596519221080264, 6.618518689056231, 14.688223790694959, -5.842956471805117, -2.5689067483127204, -1.734693715454931, -5.848266764412443, -32.075214352070425, 1.6059767124089248, -4.2668563233081755, -9.890321366867752, -23.602293168122323, -29.73601897429661]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42093647802747824, "mean_inference_ms": 1.1070341706771145, "mean_action_processing_ms": 0.18076461933610344, "mean_env_wait_ms": 0.0734697326109123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004037022590637207, "StateBufferConnector_ms": 0.003070831298828125, "ViewRequirementAgentConnector_ms": 0.07099628448486328}, "num_episodes": 11, "episode_return_max": 26.770384095277887, "episode_return_min": -26.66915607120948, "episode_return_mean": -7.5887769424735145}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.2624037507359, "num_env_steps_trained_throughput_per_sec": 509.2624037507359, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 8327.981, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8327.946, "sample_time_ms": 810.291, "learn_time_ms": 7504.022, "learn_throughput": 533.048, "synch_weights_time_ms": 13.135}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 164, "trial_id": "83a5c_00000", "date": "2024-08-10_12-37-10", "timestamp": 1723307830, "time_this_iter_s": 7.859637022018433, "time_total_s": 1391.2581255435944, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd82700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1391.2581255435944, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 25.224999999999994, "ram_util_percent": 82.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5939831482670295, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4627804356908043, "policy_loss": -0.0038431882328555855, "vf_loss": 2.4660866927848293, "vf_explained_var": 0.10323272230763915, "kl": 0.006278002675998126, "entropy": 1.3344087617737905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9708172974487144, "cur_kl_coeff": 6.372194771842031e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.346082261639337, "policy_loss": -0.018871369884072918, "vf_loss": 2.3649536359434324, "vf_explained_var": 0.16685293323049943, "kl": 0.01199927622643054, "entropy": 0.32316436890202266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "env_runners": {"episode_reward_max": 26.770384095277887, "episode_reward_min": -26.66915607120948, "episode_reward_mean": -6.478833867729639, "episode_len_mean": 361.69, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36169, "policy_reward_min": {"agent_policy": -26.77038409527784, "adversary_policy": -37.492165875489576}, "policy_reward_max": {"agent_policy": 26.669156071209475, "adversary_policy": 36.98167156445223}, "policy_reward_mean": {"agent_policy": 6.478833867729639, "adversary_policy": -6.478833867729641}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.989112503325476, -12.549736709088256, -17.90989149081641, -5.028123741196193, 3.070358527480451, -3.9880903856897785, -2.3287573127157497, -3.4045944666341015, -23.21769399451491, 0.4296224346797697, 7.4090944810967905, -6.780346886926006, -21.12356213164666, 9.84419484593791, 6.9499313087771295, -9.486309689555167, -1.2448530647046159, -13.645442274178226, -3.687864237280234, -6.607890551045713, -16.829278661914433, -16.245861182305987, -4.6860256080343845, -0.6543665199245492, -18.675050071113528, -11.530198711764855, 1.7299357342649166, -14.637674906794164, -8.274055846555784, -17.554125152715887, 6.475062558378143, -12.71773739878108, -15.012810442823785, -9.284485705515351, -10.992953400249755, -13.91097901947175, 1.9642932868848089, -16.40431174090995, -7.238942960425749, 2.446596447283728, -6.69678086905029, 0.9650970956395934, 12.595091113565632, -26.39111817097538, 1.841038291373501, -15.268923825517764, 3.546344744540356, 9.324562515040949, 0.17972365910904053, -14.428234151734337, -14.273156612036747, -14.732137621505206, -16.76875634308366, -1.4121201577898432, -17.95268411317941, -5.315030018122899, 11.096677540520389, -7.46575749218351, -10.37489552378964, -7.401898383247829, -14.877951321700696, -0.9299693381261172, -22.49668996502641, 3.5734109775501492, -9.534895725537742, 26.770384095277887, -15.15481849864917, -11.147898376147399, -22.016232660821682, -7.7646085757944, -24.60006205883015, -3.2959597212506164, -1.255907595776785, -19.03432975749136, -18.11860095305215, -18.173906613299213, 4.5400030473200985, -5.005262006967364, -16.937894829325092, -6.346492576401619, -18.894236296377546, -19.884306396745632, 10.6533712398756, -4.205931610058915, -3.791480239933687, -15.234618819830754, -7.078588845087964, -26.66915607120948, -8.963500995156979, -2.2579689392915174, -4.287204037441196, -1.446083329977526, 19.720683029964597, 6.630334158969935, 1.4927916483920929, 0.038483399927898176, -4.046991461184362, -1.7598094480142201, 20.926282098458348, -4.741002944581872], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 1, 17, 400, 3, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 63, 400], "policy_agent_policy_reward": [-1.989112503325476, 12.549736709088256, 17.909891490816406, 5.028123741196193, -3.070358527480451, 3.9880903856897767, 2.328757312715748, 3.4045944666341015, 23.2176939945149, -0.429622434679775, -7.4090944810967905, 6.780346886926006, 21.123562131646658, -9.8441948459379, -6.949931308777129, 9.486309689555167, 1.2448530647046159, 13.645442274178235, 3.687864237280234, 6.607890551045713, 16.829278661914433, 16.245861182305987, 4.6860256080343845, 0.6543665199245492, 18.675050071113525, 11.530198711764854, -1.7299357342649166, 14.63767490679416, 8.274055846555786, 17.554125152715883, -6.475062558378144, 12.71773739878108, 15.012810442823781, 9.284485705515351, 10.992953400249755, 13.910979019471746, -1.964293286884809, 16.404311740909947, 7.238942960425749, -2.446596447283728, 6.69678086905029, -0.9650970956395934, -12.595091113565633, 26.391118170975382, -1.841038291373501, 15.268923825517767, -3.5463447445403524, -9.324562515040949, -0.17972365910904053, 14.428234151734337, 14.273156612036747, 14.732137621505206, 16.768756343083663, 1.4121201577898432, 17.952684113179405, 5.315030018122899, -11.096677540520387, 7.46575749218351, 10.37489552378964, 7.401898383247829, 14.877951321700696, 0.9299693381261047, 22.496689965026434, -3.5734109775501492, 9.534895725537742, -26.77038409527784, 15.15481849864917, 11.147898376147396, 22.016232660821686, 7.764608575794405, 24.600062058830147, 3.2959597212506164, 1.255907595776785, 19.034329757491356, 18.118600953052155, 18.173906613299224, -4.5400030473200985, 5.005262006967364, 16.93789482932509, 6.346492576401619, 18.89423629637755, 19.884306396745636, -10.653371239875595, 4.205931610058926, 3.791480239933687, 15.234618819830754, 7.078588845087964, 26.669156071209475, 8.96350099515698, 2.2579689392915174, 4.287204037441187, 1.4460833299775278, -19.720683029964615, -6.63033415896993, -1.4927916483920929, -0.038483399927898176, 4.04699146118436, 1.7598094480142201, -20.92628209845835, 4.741002944581872], "policy_adversary_policy_reward": [2.299428514805264, 1.678796491845688, -18.65031008983797, -6.4491633283385426, -28.611785294589808, -7.207997687043001, -24.822454885361058, 14.766207402968675, 6.216139772290369, -0.0754227173294666, 2.427680456469261, -10.403861227848813, 3.3256594541211797, -7.9831740795526756, -8.058825800005899, 1.2496368667376956, -27.693714940297372, -18.741673048732448, -13.451138141108327, 14.310383010467874, 5.005184184451487, 9.813004777742094, 4.183466116399778, -17.74415989025179, -22.000400239304664, -20.246724023988655, 9.210893132006532, 10.477496559869266, 5.845676287184148, 8.054186330370111, -9.619984092285613, -9.352635286824722, 10.154471177606894, -12.644177307016125, -11.56054697099879, -15.730337577357673, -25.518974681574747, 18.14324620701428, -12.312289969468736, -0.9034911326226904, -3.2829378426202744, -30.375619481208595, -19.00542673895236, -13.486295625659615, -11.817928758052837, 2.4458775419840677, -7.761404543893388, 6.4526715040442895, -31.933375905059698, -5.4167242371673545, -23.870540244644662, 0.8101428211149511, -0.7449781634197876, 4.204849631949621, -22.891027330256154, -6.3843224833321734, 1.0046018709901219, -17.552713564101694, -16.130899991378843, -18.977350314052952, 4.2254343765602655, 8.72469074019602, -14.48487288574863, -10.950601911813532, -22.90042103655015, -7.125199849097406, -2.822682667054842, -15.74628874397586, -2.1050686473869007, -19.88083815311261, -6.32120099714238, -21.500757041801112, 3.8286099862868253, 0.09997658748279292, 2.0493030862365416, -34.85792656805644, -32.24401900878187, 17.76613308793037, 1.7853922320014703, 3.1078006625659853, -11.833925381452538, -1.559636356648042, 0.20082938166212472, 1.7293648096170622, 12.757020429584438, 12.433161797546825, -26.690780430531476, -26.09145591141927, 5.987492112733642, -2.3054155299866395, -27.699380676308483, -2.838466974727041, 10.704273180183222, -3.611583691102517, 29.284185917462814, -10.635060887380916, 0.7254667907864207, -0.36601947256833967, -13.381939965161695, -15.474528338306978, -10.49294010032093, -18.05337312375256, -22.831985606353815, -6.632289636656598, -11.064823777292467, -22.47268890887485, -2.3054505964039933, -0.5187897191756932, -15.240934649597044, -20.664433576761763, -0.8661804457853037, -9.763879590460494, 11.785992021353625, 10.40736305968716, 4.465063457322323, -19.396578441689343, -17.45190694800403, -3.297884099575249, -5.028464855749839, -9.77533191074582, -14.291824471133921, -15.464078172267474, 4.105776161773189, -5.965714838025404, -10.808843729305316, -34.18453620074749, -0.8959747918069638, 8.042796746907264, -23.253407517476973, 4.183616066401484, 16.55909662610343, 36.98167156445223, -4.471073665115966, -25.838563332182378, -18.13272731508481, -4.1630694372100265, -37.492165875489576, -6.540299446153824, -16.93838772773818, 1.4091705761493714, -22.8604725875468, -26.339651530113493, -8.974484473152547, 2.382565030651314, -4.005455612034712, 1.4936404204811424, -16.64249059469891, -21.4261689202838, -8.450027511514183, -27.787174394590146, -15.157066344632138, -21.190746881966323, 0.2678818531067222, 8.812124241533475, 10.728144014930812, -20.73866802886554, -10.706437156685329, -23.169352501964852, -14.402009960889671, 1.7090248080864328, -7.890985197035857, -29.897487395719253, -31.172093572411015, -8.596519221080264, 6.618518689056231, 14.688223790694959, -5.842956471805117, -2.5689067483127204, -1.734693715454931, -5.848266764412443, -32.075214352070425, 1.6059767124089248, -4.2668563233081755, -9.890321366867752, -23.602293168122323, -29.73601897429661, -7.114285409037503, -10.812716581276453, 0.8509706519085753, -5.36690853049161, -4.066339109916704, -4.508068964965693, 1.2728787542769453, -4.165045414232001, 13.260468579118754, 26.18089748081045, 14.512553161509437, -1.2518848435695737, 2.801860679739989, 0.18372261704419657, -0.38260082591733635, 0.4595676257731327, -6.805709460371496, -1.288273461997214, 5.372407686841825, -8.892026582870265, 24.378997380146064, 17.473566816770667, 2.0452303078113943, -11.527236196975139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4207489436650156, "mean_inference_ms": 1.1065791244386924, "mean_action_processing_ms": 0.18068458667548104, "mean_env_wait_ms": 0.0734501440532877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004078865051269531, "StateBufferConnector_ms": 0.003092527389526367, "ViewRequirementAgentConnector_ms": 0.07134568691253662}, "num_episodes": 12, "episode_return_max": 26.770384095277887, "episode_return_min": -26.66915607120948, "episode_return_mean": -6.478833867729639}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 501.49106256209524, "num_env_steps_trained_throughput_per_sec": 501.49106256209524, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 1980000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1980000, "timers": {"training_iteration_time_ms": 8301.889, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8301.854, "sample_time_ms": 814.427, "learn_time_ms": 7473.882, "learn_throughput": 535.197, "synch_weights_time_ms": 13.051}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 1980000, "num_agent_steps_trained": 1980000}, "done": false, "training_iteration": 165, "trial_id": "83a5c_00000", "date": "2024-08-10_12-37-18", "timestamp": 1723307838, "time_this_iter_s": 7.98062801361084, "time_total_s": 1399.2387535572052, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd820d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1399.2387535572052, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 25.63636363636364, "ram_util_percent": 82.21818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.815912501080326, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7204899406306957, "policy_loss": -0.004809525658169555, "vf_loss": 2.7246974740709575, "vf_explained_var": -0.198435288005405, "kl": 0.0070387167121187, "entropy": 1.3262692451477052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.902504005158941, "cur_kl_coeff": 6.372194771842031e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9622292643412949, "policy_loss": -0.0042271545928088015, "vf_loss": 1.9664564134553075, "vf_explained_var": 0.5752842652921876, "kl": 0.0019068093130005682, "entropy": 0.23438304277757804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "env_runners": {"episode_reward_max": 26.770384095277887, "episode_reward_min": -26.66915607120948, "episode_reward_mean": -6.323466250110982, "episode_len_mean": 357.74, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35774, "policy_reward_min": {"agent_policy": -26.77038409527784, "adversary_policy": -37.492165875489576}, "policy_reward_max": {"agent_policy": 26.669156071209475, "adversary_policy": 36.98167156445223}, "policy_reward_mean": {"agent_policy": 6.323466250110985, "adversary_policy": -6.323466250110986}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.12356213164666, 9.84419484593791, 6.9499313087771295, -9.486309689555167, -1.2448530647046159, -13.645442274178226, -3.687864237280234, -6.607890551045713, -16.829278661914433, -16.245861182305987, -4.6860256080343845, -0.6543665199245492, -18.675050071113528, -11.530198711764855, 1.7299357342649166, -14.637674906794164, -8.274055846555784, -17.554125152715887, 6.475062558378143, -12.71773739878108, -15.012810442823785, -9.284485705515351, -10.992953400249755, -13.91097901947175, 1.9642932868848089, -16.40431174090995, -7.238942960425749, 2.446596447283728, -6.69678086905029, 0.9650970956395934, 12.595091113565632, -26.39111817097538, 1.841038291373501, -15.268923825517764, 3.546344744540356, 9.324562515040949, 0.17972365910904053, -14.428234151734337, -14.273156612036747, -14.732137621505206, -16.76875634308366, -1.4121201577898432, -17.95268411317941, -5.315030018122899, 11.096677540520389, -7.46575749218351, -10.37489552378964, -7.401898383247829, -14.877951321700696, -0.9299693381261172, -22.49668996502641, 3.5734109775501492, -9.534895725537742, 26.770384095277887, -15.15481849864917, -11.147898376147399, -22.016232660821682, -7.7646085757944, -24.60006205883015, -3.2959597212506164, -1.255907595776785, -19.03432975749136, -18.11860095305215, -18.173906613299213, 4.5400030473200985, -5.005262006967364, -16.937894829325092, -6.346492576401619, -18.894236296377546, -19.884306396745632, 10.6533712398756, -4.205931610058915, -3.791480239933687, -15.234618819830754, -7.078588845087964, -26.66915607120948, -8.963500995156979, -2.2579689392915174, -4.287204037441196, -1.446083329977526, 19.720683029964597, 6.630334158969935, 1.4927916483920929, 0.038483399927898176, -4.046991461184362, -1.7598094480142201, 20.926282098458348, -4.741002944581872, -10.32548173489308, 5.548104155947332, -0.4278881062959332, -11.381103847538835, 9.210563053491654, 8.626256981828206, -7.911499450055235, -8.64048192630617, -7.20246479109076, 2.830539868920929, -15.528344168279705, -11.570485314861793], "episode_lengths": [400, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 1, 17, 400, 3, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 5, 400, 400], "policy_agent_policy_reward": [21.123562131646658, -9.8441948459379, -6.949931308777129, 9.486309689555167, 1.2448530647046159, 13.645442274178235, 3.687864237280234, 6.607890551045713, 16.829278661914433, 16.245861182305987, 4.6860256080343845, 0.6543665199245492, 18.675050071113525, 11.530198711764854, -1.7299357342649166, 14.63767490679416, 8.274055846555786, 17.554125152715883, -6.475062558378144, 12.71773739878108, 15.012810442823781, 9.284485705515351, 10.992953400249755, 13.910979019471746, -1.964293286884809, 16.404311740909947, 7.238942960425749, -2.446596447283728, 6.69678086905029, -0.9650970956395934, -12.595091113565633, 26.391118170975382, -1.841038291373501, 15.268923825517767, -3.5463447445403524, -9.324562515040949, -0.17972365910904053, 14.428234151734337, 14.273156612036747, 14.732137621505206, 16.768756343083663, 1.4121201577898432, 17.952684113179405, 5.315030018122899, -11.096677540520387, 7.46575749218351, 10.37489552378964, 7.401898383247829, 14.877951321700696, 0.9299693381261047, 22.496689965026434, -3.5734109775501492, 9.534895725537742, -26.77038409527784, 15.15481849864917, 11.147898376147396, 22.016232660821686, 7.764608575794405, 24.600062058830147, 3.2959597212506164, 1.255907595776785, 19.034329757491356, 18.118600953052155, 18.173906613299224, -4.5400030473200985, 5.005262006967364, 16.93789482932509, 6.346492576401619, 18.89423629637755, 19.884306396745636, -10.653371239875595, 4.205931610058926, 3.791480239933687, 15.234618819830754, 7.078588845087964, 26.669156071209475, 8.96350099515698, 2.2579689392915174, 4.287204037441187, 1.4460833299775278, -19.720683029964615, -6.63033415896993, -1.4927916483920929, -0.038483399927898176, 4.04699146118436, 1.7598094480142201, -20.92628209845835, 4.741002944581872, 10.32548173489308, -5.548104155947332, 0.4278881062959332, 11.381103847538835, -9.210563053491658, -8.6262569818281, 7.911499450055235, 8.64048192630617, 7.20246479109076, -2.8305398689209285, 15.528344168279702, 11.570485314861793], "policy_adversary_policy_reward": [-22.000400239304664, -20.246724023988655, 9.210893132006532, 10.477496559869266, 5.845676287184148, 8.054186330370111, -9.619984092285613, -9.352635286824722, 10.154471177606894, -12.644177307016125, -11.56054697099879, -15.730337577357673, -25.518974681574747, 18.14324620701428, -12.312289969468736, -0.9034911326226904, -3.2829378426202744, -30.375619481208595, -19.00542673895236, -13.486295625659615, -11.817928758052837, 2.4458775419840677, -7.761404543893388, 6.4526715040442895, -31.933375905059698, -5.4167242371673545, -23.870540244644662, 0.8101428211149511, -0.7449781634197876, 4.204849631949621, -22.891027330256154, -6.3843224833321734, 1.0046018709901219, -17.552713564101694, -16.130899991378843, -18.977350314052952, 4.2254343765602655, 8.72469074019602, -14.48487288574863, -10.950601911813532, -22.90042103655015, -7.125199849097406, -2.822682667054842, -15.74628874397586, -2.1050686473869007, -19.88083815311261, -6.32120099714238, -21.500757041801112, 3.8286099862868253, 0.09997658748279292, 2.0493030862365416, -34.85792656805644, -32.24401900878187, 17.76613308793037, 1.7853922320014703, 3.1078006625659853, -11.833925381452538, -1.559636356648042, 0.20082938166212472, 1.7293648096170622, 12.757020429584438, 12.433161797546825, -26.690780430531476, -26.09145591141927, 5.987492112733642, -2.3054155299866395, -27.699380676308483, -2.838466974727041, 10.704273180183222, -3.611583691102517, 29.284185917462814, -10.635060887380916, 0.7254667907864207, -0.36601947256833967, -13.381939965161695, -15.474528338306978, -10.49294010032093, -18.05337312375256, -22.831985606353815, -6.632289636656598, -11.064823777292467, -22.47268890887485, -2.3054505964039933, -0.5187897191756932, -15.240934649597044, -20.664433576761763, -0.8661804457853037, -9.763879590460494, 11.785992021353625, 10.40736305968716, 4.465063457322323, -19.396578441689343, -17.45190694800403, -3.297884099575249, -5.028464855749839, -9.77533191074582, -14.291824471133921, -15.464078172267474, 4.105776161773189, -5.965714838025404, -10.808843729305316, -34.18453620074749, -0.8959747918069638, 8.042796746907264, -23.253407517476973, 4.183616066401484, 16.55909662610343, 36.98167156445223, -4.471073665115966, -25.838563332182378, -18.13272731508481, -4.1630694372100265, -37.492165875489576, -6.540299446153824, -16.93838772773818, 1.4091705761493714, -22.8604725875468, -26.339651530113493, -8.974484473152547, 2.382565030651314, -4.005455612034712, 1.4936404204811424, -16.64249059469891, -21.4261689202838, -8.450027511514183, -27.787174394590146, -15.157066344632138, -21.190746881966323, 0.2678818531067222, 8.812124241533475, 10.728144014930812, -20.73866802886554, -10.706437156685329, -23.169352501964852, -14.402009960889671, 1.7090248080864328, -7.890985197035857, -29.897487395719253, -31.172093572411015, -8.596519221080264, 6.618518689056231, 14.688223790694959, -5.842956471805117, -2.5689067483127204, -1.734693715454931, -5.848266764412443, -32.075214352070425, 1.6059767124089248, -4.2668563233081755, -9.890321366867752, -23.602293168122323, -29.73601897429661, -7.114285409037503, -10.812716581276453, 0.8509706519085753, -5.36690853049161, -4.066339109916704, -4.508068964965693, 1.2728787542769453, -4.165045414232001, 13.260468579118754, 26.18089748081045, 14.512553161509437, -1.2518848435695737, 2.801860679739989, 0.18372261704419657, -0.38260082591733635, 0.4595676257731327, -6.805709460371496, -1.288273461997214, 5.372407686841825, -8.892026582870265, 24.378997380146064, 17.473566816770667, 2.0452303078113943, -11.527236196975139, 5.903729855255186, -26.55469332504134, -1.8564476128166234, 12.952655924711287, 6.725682733778854, -7.58145894637072, -16.324046208984324, -6.438161486093346, 11.77717313441429, 6.643952972569011, 18.47435766025594, -1.2218436965996524, 1.8865023833941592, -17.709501283504633, 9.641931001442785, -26.922894854055127, -0.6933478350246602, -13.71158174715686, 0.0, 5.661079737841857, -26.40910125979707, -4.647587076762331, 7.269234393533239, -30.41020502325682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42058107808516887, "mean_inference_ms": 1.105987776606232, "mean_action_processing_ms": 0.18065018902335034, "mean_env_wait_ms": 0.07342039484420165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003927350044250488, "StateBufferConnector_ms": 0.003301262855529785, "ViewRequirementAgentConnector_ms": 0.07044601440429688}, "num_episodes": 12, "episode_return_max": 26.770384095277887, "episode_return_min": -26.66915607120948, "episode_return_mean": -6.323466250110982}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 467.3659915543147, "num_env_steps_trained_throughput_per_sec": 467.3659915543147, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 1992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1992000, "timers": {"training_iteration_time_ms": 8266.624, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8266.587, "sample_time_ms": 809.05, "learn_time_ms": 7443.992, "learn_throughput": 537.346, "synch_weights_time_ms": 13.052}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "done": false, "training_iteration": 166, "trial_id": "83a5c_00000", "date": "2024-08-10_12-37-27", "timestamp": 1723307847, "time_this_iter_s": 8.564938068389893, "time_total_s": 1407.803691625595, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc74040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1407.803691625595, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 30.424999999999997, "ram_util_percent": 81.84166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.061827613090081, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.145806039451922, "policy_loss": -0.006860500042666755, "vf_loss": 2.1516660405214503, "vf_explained_var": 0.015079510748071014, "kl": 0.011698161776994759, "entropy": 1.2771373023431767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.507323004429539, "cur_kl_coeff": 3.1860973859210156e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2820472986747822, "policy_loss": -0.0026646958756221767, "vf_loss": 1.2847119917472203, "vf_explained_var": 0.6659361296643813, "kl": 0.001823742345432135, "entropy": 0.1907858825288713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "env_runners": {"episode_reward_max": 26.770384095277887, "episode_reward_min": -26.66915607120948, "episode_reward_mean": -6.750114738670432, "episode_len_mean": 353.97, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35397, "policy_reward_min": {"agent_policy": -26.77038409527784, "adversary_policy": -37.492165875489576}, "policy_reward_max": {"agent_policy": 26.669156071209475, "adversary_policy": 36.98167156445223}, "policy_reward_mean": {"agent_policy": 6.750114738670436, "adversary_policy": -6.750114738670434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.6543665199245492, -18.675050071113528, -11.530198711764855, 1.7299357342649166, -14.637674906794164, -8.274055846555784, -17.554125152715887, 6.475062558378143, -12.71773739878108, -15.012810442823785, -9.284485705515351, -10.992953400249755, -13.91097901947175, 1.9642932868848089, -16.40431174090995, -7.238942960425749, 2.446596447283728, -6.69678086905029, 0.9650970956395934, 12.595091113565632, -26.39111817097538, 1.841038291373501, -15.268923825517764, 3.546344744540356, 9.324562515040949, 0.17972365910904053, -14.428234151734337, -14.273156612036747, -14.732137621505206, -16.76875634308366, -1.4121201577898432, -17.95268411317941, -5.315030018122899, 11.096677540520389, -7.46575749218351, -10.37489552378964, -7.401898383247829, -14.877951321700696, -0.9299693381261172, -22.49668996502641, 3.5734109775501492, -9.534895725537742, 26.770384095277887, -15.15481849864917, -11.147898376147399, -22.016232660821682, -7.7646085757944, -24.60006205883015, -3.2959597212506164, -1.255907595776785, -19.03432975749136, -18.11860095305215, -18.173906613299213, 4.5400030473200985, -5.005262006967364, -16.937894829325092, -6.346492576401619, -18.894236296377546, -19.884306396745632, 10.6533712398756, -4.205931610058915, -3.791480239933687, -15.234618819830754, -7.078588845087964, -26.66915607120948, -8.963500995156979, -2.2579689392915174, -4.287204037441196, -1.446083329977526, 19.720683029964597, 6.630334158969935, 1.4927916483920929, 0.038483399927898176, -4.046991461184362, -1.7598094480142201, 20.926282098458348, -4.741002944581872, -10.32548173489308, 5.548104155947332, -0.4278881062959332, -11.381103847538835, 9.210563053491654, 8.626256981828206, -7.911499450055235, -8.64048192630617, -7.20246479109076, 2.830539868920929, -15.528344168279705, -11.570485314861793, -15.923381385919118, -6.533849442530144, -23.23819395684403, -12.785216086332461, 3.595242267367125, -26.055881285586334, 12.065217417642634, -12.693506163778551, -11.553614069540858, -17.971872779821386, -8.332754616552082], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 10, 400, 400, 400, 400, 400, 6, 400, 400, 400, 400, 1, 17, 400, 3, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 5, 400, 400, 400, 400, 400, 400, 4, 400, 26, 400, 400, 400, 400], "policy_agent_policy_reward": [0.6543665199245492, 18.675050071113525, 11.530198711764854, -1.7299357342649166, 14.63767490679416, 8.274055846555786, 17.554125152715883, -6.475062558378144, 12.71773739878108, 15.012810442823781, 9.284485705515351, 10.992953400249755, 13.910979019471746, -1.964293286884809, 16.404311740909947, 7.238942960425749, -2.446596447283728, 6.69678086905029, -0.9650970956395934, -12.595091113565633, 26.391118170975382, -1.841038291373501, 15.268923825517767, -3.5463447445403524, -9.324562515040949, -0.17972365910904053, 14.428234151734337, 14.273156612036747, 14.732137621505206, 16.768756343083663, 1.4121201577898432, 17.952684113179405, 5.315030018122899, -11.096677540520387, 7.46575749218351, 10.37489552378964, 7.401898383247829, 14.877951321700696, 0.9299693381261047, 22.496689965026434, -3.5734109775501492, 9.534895725537742, -26.77038409527784, 15.15481849864917, 11.147898376147396, 22.016232660821686, 7.764608575794405, 24.600062058830147, 3.2959597212506164, 1.255907595776785, 19.034329757491356, 18.118600953052155, 18.173906613299224, -4.5400030473200985, 5.005262006967364, 16.93789482932509, 6.346492576401619, 18.89423629637755, 19.884306396745636, -10.653371239875595, 4.205931610058926, 3.791480239933687, 15.234618819830754, 7.078588845087964, 26.669156071209475, 8.96350099515698, 2.2579689392915174, 4.287204037441187, 1.4460833299775278, -19.720683029964615, -6.63033415896993, -1.4927916483920929, -0.038483399927898176, 4.04699146118436, 1.7598094480142201, -20.92628209845835, 4.741002944581872, 10.32548173489308, -5.548104155947332, 0.4278881062959332, 11.381103847538835, -9.210563053491658, -8.6262569818281, 7.911499450055235, 8.64048192630617, 7.20246479109076, -2.8305398689209285, 15.528344168279702, 11.570485314861793, 15.923381385919118, 6.533849442530144, 23.238193956844025, 12.785216086332461, -3.595242267367125, 26.055881285586338, -12.065217417642636, 12.693506163778553, 11.55361406954086, 17.971872779821386, 8.332754616552082], "policy_adversary_policy_reward": [-7.761404543893388, 6.4526715040442895, -31.933375905059698, -5.4167242371673545, -23.870540244644662, 0.8101428211149511, -0.7449781634197876, 4.204849631949621, -22.891027330256154, -6.3843224833321734, 1.0046018709901219, -17.552713564101694, -16.130899991378843, -18.977350314052952, 4.2254343765602655, 8.72469074019602, -14.48487288574863, -10.950601911813532, -22.90042103655015, -7.125199849097406, -2.822682667054842, -15.74628874397586, -2.1050686473869007, -19.88083815311261, -6.32120099714238, -21.500757041801112, 3.8286099862868253, 0.09997658748279292, 2.0493030862365416, -34.85792656805644, -32.24401900878187, 17.76613308793037, 1.7853922320014703, 3.1078006625659853, -11.833925381452538, -1.559636356648042, 0.20082938166212472, 1.7293648096170622, 12.757020429584438, 12.433161797546825, -26.690780430531476, -26.09145591141927, 5.987492112733642, -2.3054155299866395, -27.699380676308483, -2.838466974727041, 10.704273180183222, -3.611583691102517, 29.284185917462814, -10.635060887380916, 0.7254667907864207, -0.36601947256833967, -13.381939965161695, -15.474528338306978, -10.49294010032093, -18.05337312375256, -22.831985606353815, -6.632289636656598, -11.064823777292467, -22.47268890887485, -2.3054505964039933, -0.5187897191756932, -15.240934649597044, -20.664433576761763, -0.8661804457853037, -9.763879590460494, 11.785992021353625, 10.40736305968716, 4.465063457322323, -19.396578441689343, -17.45190694800403, -3.297884099575249, -5.028464855749839, -9.77533191074582, -14.291824471133921, -15.464078172267474, 4.105776161773189, -5.965714838025404, -10.808843729305316, -34.18453620074749, -0.8959747918069638, 8.042796746907264, -23.253407517476973, 4.183616066401484, 16.55909662610343, 36.98167156445223, -4.471073665115966, -25.838563332182378, -18.13272731508481, -4.1630694372100265, -37.492165875489576, -6.540299446153824, -16.93838772773818, 1.4091705761493714, -22.8604725875468, -26.339651530113493, -8.974484473152547, 2.382565030651314, -4.005455612034712, 1.4936404204811424, -16.64249059469891, -21.4261689202838, -8.450027511514183, -27.787174394590146, -15.157066344632138, -21.190746881966323, 0.2678818531067222, 8.812124241533475, 10.728144014930812, -20.73866802886554, -10.706437156685329, -23.169352501964852, -14.402009960889671, 1.7090248080864328, -7.890985197035857, -29.897487395719253, -31.172093572411015, -8.596519221080264, 6.618518689056231, 14.688223790694959, -5.842956471805117, -2.5689067483127204, -1.734693715454931, -5.848266764412443, -32.075214352070425, 1.6059767124089248, -4.2668563233081755, -9.890321366867752, -23.602293168122323, -29.73601897429661, -7.114285409037503, -10.812716581276453, 0.8509706519085753, -5.36690853049161, -4.066339109916704, -4.508068964965693, 1.2728787542769453, -4.165045414232001, 13.260468579118754, 26.18089748081045, 14.512553161509437, -1.2518848435695737, 2.801860679739989, 0.18372261704419657, -0.38260082591733635, 0.4595676257731327, -6.805709460371496, -1.288273461997214, 5.372407686841825, -8.892026582870265, 24.378997380146064, 17.473566816770667, 2.0452303078113943, -11.527236196975139, 5.903729855255186, -26.55469332504134, -1.8564476128166234, 12.952655924711287, 6.725682733778854, -7.58145894637072, -16.324046208984324, -6.438161486093346, 11.77717313441429, 6.643952972569011, 18.47435766025594, -1.2218436965996524, 1.8865023833941592, -17.709501283504633, 9.641931001442785, -26.922894854055127, -0.6933478350246602, -13.71158174715686, 0.0, 5.661079737841857, -26.40910125979707, -4.647587076762331, 7.269234393533239, -30.41020502325682, -8.185605710479877, -23.66115706135834, 11.318819263126542, -24.38651814818683, -23.65985441778712, -22.816533495900938, -11.24415852522074, -14.326273647444182, 3.4542536770420234, 3.7362308576922274, -22.405672296541216, -29.70609027463145, 15.313091205266995, 8.817343630018277, -6.020363694279633, -19.366648633277467, -9.90302865867641, -13.204199480405332, -25.166914052527016, -10.776831507115759, -8.313939748751771, -8.351569484352392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42037705526807245, "mean_inference_ms": 1.105609461011736, "mean_action_processing_ms": 0.18058683668299935, "mean_env_wait_ms": 0.0733903663121565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004488110542297363, "StateBufferConnector_ms": 0.0033458471298217773, "ViewRequirementAgentConnector_ms": 0.07186973094940186}, "num_episodes": 11, "episode_return_max": 26.770384095277887, "episode_return_min": -26.66915607120948, "episode_return_mean": -6.750114738670432}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 504.819585363616, "num_env_steps_trained_throughput_per_sec": 504.819585363616, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2004000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2004000, "timers": {"training_iteration_time_ms": 8257.382, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8257.345, "sample_time_ms": 809.539, "learn_time_ms": 7434.424, "learn_throughput": 538.038, "synch_weights_time_ms": 12.831}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2004000, "num_agent_steps_trained": 2004000}, "done": false, "training_iteration": 167, "trial_id": "83a5c_00000", "date": "2024-08-10_12-37-34", "timestamp": 1723307854, "time_this_iter_s": 7.929379940032959, "time_total_s": 1415.733071565628, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcda280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1415.733071565628, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 30.200000000000003, "ram_util_percent": 81.65454545454547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.710764932821667, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7583508770301859, "policy_loss": -0.005458803233325915, "vf_loss": 1.763359759408961, "vf_explained_var": 0.006109260472040328, "kl": 0.005260656986379389, "entropy": 1.2414446174783051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2717111146077515, "cur_kl_coeff": 1.5930486929605078e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2584541741758586, "policy_loss": -0.004767742568462078, "vf_loss": 1.263221917549769, "vf_explained_var": 0.6955831966673335, "kl": 0.0019956558366895387, "entropy": 0.19026689417660236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 26.770384095277887, "episode_reward_min": -26.66915607120948, "episode_reward_mean": -6.733390725740296, "episode_len_mean": 357.87, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 35787, "policy_reward_min": {"agent_policy": -26.77038409527784, "adversary_policy": -37.492165875489576}, "policy_reward_max": {"agent_policy": 26.669156071209475, "adversary_policy": 36.98167156445223}, "policy_reward_mean": {"agent_policy": 6.733390725740298, "adversary_policy": -6.7333907257403}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.284485705515351, -10.992953400249755, -13.91097901947175, 1.9642932868848089, -16.40431174090995, -7.238942960425749, 2.446596447283728, -6.69678086905029, 0.9650970956395934, 12.595091113565632, -26.39111817097538, 1.841038291373501, -15.268923825517764, 3.546344744540356, 9.324562515040949, 0.17972365910904053, -14.428234151734337, -14.273156612036747, -14.732137621505206, -16.76875634308366, -1.4121201577898432, -17.95268411317941, -5.315030018122899, 11.096677540520389, -7.46575749218351, -10.37489552378964, -7.401898383247829, -14.877951321700696, -0.9299693381261172, -22.49668996502641, 3.5734109775501492, -9.534895725537742, 26.770384095277887, -15.15481849864917, -11.147898376147399, -22.016232660821682, -7.7646085757944, -24.60006205883015, -3.2959597212506164, -1.255907595776785, -19.03432975749136, -18.11860095305215, -18.173906613299213, 4.5400030473200985, -5.005262006967364, -16.937894829325092, -6.346492576401619, -18.894236296377546, -19.884306396745632, 10.6533712398756, -4.205931610058915, -3.791480239933687, -15.234618819830754, -7.078588845087964, -26.66915607120948, -8.963500995156979, -2.2579689392915174, -4.287204037441196, -1.446083329977526, 19.720683029964597, 6.630334158969935, 1.4927916483920929, 0.038483399927898176, -4.046991461184362, -1.7598094480142201, 20.926282098458348, -4.741002944581872, -10.32548173489308, 5.548104155947332, -0.4278881062959332, -11.381103847538835, 9.210563053491654, 8.626256981828206, -7.911499450055235, -8.64048192630617, -7.20246479109076, 2.830539868920929, -15.528344168279705, -11.570485314861793, -15.923381385919118, -6.533849442530144, -23.23819395684403, -12.785216086332461, 3.595242267367125, -26.055881285586334, 12.065217417642634, -12.693506163778551, -11.553614069540858, -17.971872779821386, -8.332754616552082, -6.688244356367408, -7.5078835503302095, -21.10577011467518, -9.211556532780605, -5.676365728627653, -13.528587912570801, -11.874656592288295, -17.286114596343577, 7.321267830501542, -3.6207079113349305], "episode_lengths": [400, 400, 400, 6, 400, 400, 400, 400, 1, 17, 400, 3, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 5, 400, 400, 400, 400, 400, 400, 4, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [9.284485705515351, 10.992953400249755, 13.910979019471746, -1.964293286884809, 16.404311740909947, 7.238942960425749, -2.446596447283728, 6.69678086905029, -0.9650970956395934, -12.595091113565633, 26.391118170975382, -1.841038291373501, 15.268923825517767, -3.5463447445403524, -9.324562515040949, -0.17972365910904053, 14.428234151734337, 14.273156612036747, 14.732137621505206, 16.768756343083663, 1.4121201577898432, 17.952684113179405, 5.315030018122899, -11.096677540520387, 7.46575749218351, 10.37489552378964, 7.401898383247829, 14.877951321700696, 0.9299693381261047, 22.496689965026434, -3.5734109775501492, 9.534895725537742, -26.77038409527784, 15.15481849864917, 11.147898376147396, 22.016232660821686, 7.764608575794405, 24.600062058830147, 3.2959597212506164, 1.255907595776785, 19.034329757491356, 18.118600953052155, 18.173906613299224, -4.5400030473200985, 5.005262006967364, 16.93789482932509, 6.346492576401619, 18.89423629637755, 19.884306396745636, -10.653371239875595, 4.205931610058926, 3.791480239933687, 15.234618819830754, 7.078588845087964, 26.669156071209475, 8.96350099515698, 2.2579689392915174, 4.287204037441187, 1.4460833299775278, -19.720683029964615, -6.63033415896993, -1.4927916483920929, -0.038483399927898176, 4.04699146118436, 1.7598094480142201, -20.92628209845835, 4.741002944581872, 10.32548173489308, -5.548104155947332, 0.4278881062959332, 11.381103847538835, -9.210563053491658, -8.6262569818281, 7.911499450055235, 8.64048192630617, 7.20246479109076, -2.8305398689209285, 15.528344168279702, 11.570485314861793, 15.923381385919118, 6.533849442530144, 23.238193956844025, 12.785216086332461, -3.595242267367125, 26.055881285586338, -12.065217417642636, 12.693506163778553, 11.55361406954086, 17.971872779821386, 8.332754616552082, 6.688244356367408, 7.5078835503302095, 21.10577011467518, 9.211556532780605, 5.676365728627653, 13.528587912570798, 11.874656592288295, 17.28611459634357, -7.321267830501542, 3.6207079113349305], "policy_adversary_policy_reward": [-2.822682667054842, -15.74628874397586, -2.1050686473869007, -19.88083815311261, -6.32120099714238, -21.500757041801112, 3.8286099862868253, 0.09997658748279292, 2.0493030862365416, -34.85792656805644, -32.24401900878187, 17.76613308793037, 1.7853922320014703, 3.1078006625659853, -11.833925381452538, -1.559636356648042, 0.20082938166212472, 1.7293648096170622, 12.757020429584438, 12.433161797546825, -26.690780430531476, -26.09145591141927, 5.987492112733642, -2.3054155299866395, -27.699380676308483, -2.838466974727041, 10.704273180183222, -3.611583691102517, 29.284185917462814, -10.635060887380916, 0.7254667907864207, -0.36601947256833967, -13.381939965161695, -15.474528338306978, -10.49294010032093, -18.05337312375256, -22.831985606353815, -6.632289636656598, -11.064823777292467, -22.47268890887485, -2.3054505964039933, -0.5187897191756932, -15.240934649597044, -20.664433576761763, -0.8661804457853037, -9.763879590460494, 11.785992021353625, 10.40736305968716, 4.465063457322323, -19.396578441689343, -17.45190694800403, -3.297884099575249, -5.028464855749839, -9.77533191074582, -14.291824471133921, -15.464078172267474, 4.105776161773189, -5.965714838025404, -10.808843729305316, -34.18453620074749, -0.8959747918069638, 8.042796746907264, -23.253407517476973, 4.183616066401484, 16.55909662610343, 36.98167156445223, -4.471073665115966, -25.838563332182378, -18.13272731508481, -4.1630694372100265, -37.492165875489576, -6.540299446153824, -16.93838772773818, 1.4091705761493714, -22.8604725875468, -26.339651530113493, -8.974484473152547, 2.382565030651314, -4.005455612034712, 1.4936404204811424, -16.64249059469891, -21.4261689202838, -8.450027511514183, -27.787174394590146, -15.157066344632138, -21.190746881966323, 0.2678818531067222, 8.812124241533475, 10.728144014930812, -20.73866802886554, -10.706437156685329, -23.169352501964852, -14.402009960889671, 1.7090248080864328, -7.890985197035857, -29.897487395719253, -31.172093572411015, -8.596519221080264, 6.618518689056231, 14.688223790694959, -5.842956471805117, -2.5689067483127204, -1.734693715454931, -5.848266764412443, -32.075214352070425, 1.6059767124089248, -4.2668563233081755, -9.890321366867752, -23.602293168122323, -29.73601897429661, -7.114285409037503, -10.812716581276453, 0.8509706519085753, -5.36690853049161, -4.066339109916704, -4.508068964965693, 1.2728787542769453, -4.165045414232001, 13.260468579118754, 26.18089748081045, 14.512553161509437, -1.2518848435695737, 2.801860679739989, 0.18372261704419657, -0.38260082591733635, 0.4595676257731327, -6.805709460371496, -1.288273461997214, 5.372407686841825, -8.892026582870265, 24.378997380146064, 17.473566816770667, 2.0452303078113943, -11.527236196975139, 5.903729855255186, -26.55469332504134, -1.8564476128166234, 12.952655924711287, 6.725682733778854, -7.58145894637072, -16.324046208984324, -6.438161486093346, 11.77717313441429, 6.643952972569011, 18.47435766025594, -1.2218436965996524, 1.8865023833941592, -17.709501283504633, 9.641931001442785, -26.922894854055127, -0.6933478350246602, -13.71158174715686, 0.0, 5.661079737841857, -26.40910125979707, -4.647587076762331, 7.269234393533239, -30.41020502325682, -8.185605710479877, -23.66115706135834, 11.318819263126542, -24.38651814818683, -23.65985441778712, -22.816533495900938, -11.24415852522074, -14.326273647444182, 3.4542536770420234, 3.7362308576922274, -22.405672296541216, -29.70609027463145, 15.313091205266995, 8.817343630018277, -6.020363694279633, -19.366648633277467, -9.90302865867641, -13.204199480405332, -25.166914052527016, -10.776831507115759, -8.313939748751771, -8.351569484352392, -2.150571246529381, -11.225917466205434, 11.621887138929175, -26.637654239589594, -17.48603936127312, -24.72550086807724, -26.157227497428327, 7.734114431867113, -6.4709453846896565, -4.8817860725656494, -14.173848668456163, -12.88332715668544, -2.1962937889784655, -21.553019395598124, -23.74986045244283, -10.822368740244315, -6.43701937676288, 21.079555037765964, -0.981939127329106, -6.259476695340755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4202269340207593, "mean_inference_ms": 1.1053138251630938, "mean_action_processing_ms": 0.1805266750746237, "mean_env_wait_ms": 0.07337847357671748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004551291465759277, "StateBufferConnector_ms": 0.0033947229385375977, "ViewRequirementAgentConnector_ms": 0.07244503498077393}, "num_episodes": 10, "episode_return_max": 26.770384095277887, "episode_return_min": -26.66915607120948, "episode_return_mean": -6.733390725740296}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 518.7310931644755, "num_env_steps_trained_throughput_per_sec": 518.7310931644755, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 8234.254, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8234.218, "sample_time_ms": 806.329, "learn_time_ms": 7414.383, "learn_throughput": 539.492, "synch_weights_time_ms": 12.911}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 168, "trial_id": "83a5c_00000", "date": "2024-08-10_12-37-42", "timestamp": 1723307862, "time_this_iter_s": 7.715802192687988, "time_total_s": 1423.448873758316, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcdaca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1423.448873758316, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 26.072727272727274, "ram_util_percent": 81.46363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.90419005068837, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9571938320757851, "policy_loss": -0.006819493587685641, "vf_loss": 1.962722396219849, "vf_explained_var": -0.09406422386093745, "kl": 0.015093915384533925, "entropy": 1.1983740800902958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2949044049717484, "cur_kl_coeff": 7.965243464802539e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4274556439369916, "policy_loss": -0.0034800746313218647, "vf_loss": 1.430935717218866, "vf_explained_var": 0.6680386840055387, "kl": 0.00235498603423639, "entropy": 0.18730814539206525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "env_runners": {"episode_reward_max": 26.770384095277887, "episode_reward_min": -26.66915607120948, "episode_reward_mean": -7.0774159647202115, "episode_len_mean": 365.8, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 36580, "policy_reward_min": {"agent_policy": -26.77038409527784, "adversary_policy": -37.492165875489576}, "policy_reward_max": {"agent_policy": 26.669156071209475, "adversary_policy": 36.98167156445223}, "policy_reward_mean": {"agent_policy": 7.077415964720212, "adversary_policy": -7.077415964720212}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.595091113565632, -26.39111817097538, 1.841038291373501, -15.268923825517764, 3.546344744540356, 9.324562515040949, 0.17972365910904053, -14.428234151734337, -14.273156612036747, -14.732137621505206, -16.76875634308366, -1.4121201577898432, -17.95268411317941, -5.315030018122899, 11.096677540520389, -7.46575749218351, -10.37489552378964, -7.401898383247829, -14.877951321700696, -0.9299693381261172, -22.49668996502641, 3.5734109775501492, -9.534895725537742, 26.770384095277887, -15.15481849864917, -11.147898376147399, -22.016232660821682, -7.7646085757944, -24.60006205883015, -3.2959597212506164, -1.255907595776785, -19.03432975749136, -18.11860095305215, -18.173906613299213, 4.5400030473200985, -5.005262006967364, -16.937894829325092, -6.346492576401619, -18.894236296377546, -19.884306396745632, 10.6533712398756, -4.205931610058915, -3.791480239933687, -15.234618819830754, -7.078588845087964, -26.66915607120948, -8.963500995156979, -2.2579689392915174, -4.287204037441196, -1.446083329977526, 19.720683029964597, 6.630334158969935, 1.4927916483920929, 0.038483399927898176, -4.046991461184362, -1.7598094480142201, 20.926282098458348, -4.741002944581872, -10.32548173489308, 5.548104155947332, -0.4278881062959332, -11.381103847538835, 9.210563053491654, 8.626256981828206, -7.911499450055235, -8.64048192630617, -7.20246479109076, 2.830539868920929, -15.528344168279705, -11.570485314861793, -15.923381385919118, -6.533849442530144, -23.23819395684403, -12.785216086332461, 3.595242267367125, -26.055881285586334, 12.065217417642634, -12.693506163778551, -11.553614069540858, -17.971872779821386, -8.332754616552082, -6.688244356367408, -7.5078835503302095, -21.10577011467518, -9.211556532780605, -5.676365728627653, -13.528587912570801, -11.874656592288295, -17.286114596343577, 7.321267830501542, -3.6207079113349305, -5.061817906174658, -3.418241897020666, -9.241488489368136, -13.301848863200028, -0.7114838036837323, -23.20299402282425, -16.529138202092117, -25.31146383323106, 3.2234862537886126], "episode_lengths": [17, 400, 3, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 5, 400, 400, 400, 400, 400, 400, 4, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-12.595091113565633, 26.391118170975382, -1.841038291373501, 15.268923825517767, -3.5463447445403524, -9.324562515040949, -0.17972365910904053, 14.428234151734337, 14.273156612036747, 14.732137621505206, 16.768756343083663, 1.4121201577898432, 17.952684113179405, 5.315030018122899, -11.096677540520387, 7.46575749218351, 10.37489552378964, 7.401898383247829, 14.877951321700696, 0.9299693381261047, 22.496689965026434, -3.5734109775501492, 9.534895725537742, -26.77038409527784, 15.15481849864917, 11.147898376147396, 22.016232660821686, 7.764608575794405, 24.600062058830147, 3.2959597212506164, 1.255907595776785, 19.034329757491356, 18.118600953052155, 18.173906613299224, -4.5400030473200985, 5.005262006967364, 16.93789482932509, 6.346492576401619, 18.89423629637755, 19.884306396745636, -10.653371239875595, 4.205931610058926, 3.791480239933687, 15.234618819830754, 7.078588845087964, 26.669156071209475, 8.96350099515698, 2.2579689392915174, 4.287204037441187, 1.4460833299775278, -19.720683029964615, -6.63033415896993, -1.4927916483920929, -0.038483399927898176, 4.04699146118436, 1.7598094480142201, -20.92628209845835, 4.741002944581872, 10.32548173489308, -5.548104155947332, 0.4278881062959332, 11.381103847538835, -9.210563053491658, -8.6262569818281, 7.911499450055235, 8.64048192630617, 7.20246479109076, -2.8305398689209285, 15.528344168279702, 11.570485314861793, 15.923381385919118, 6.533849442530144, 23.238193956844025, 12.785216086332461, -3.595242267367125, 26.055881285586338, -12.065217417642636, 12.693506163778553, 11.55361406954086, 17.971872779821386, 8.332754616552082, 6.688244356367408, 7.5078835503302095, 21.10577011467518, 9.211556532780605, 5.676365728627653, 13.528587912570798, 11.874656592288295, 17.28611459634357, -7.321267830501542, 3.6207079113349305, 5.061817906174658, 3.418241897020666, 9.241488489368136, 13.301848863200028, 0.7114838036837199, 23.202994022824253, 16.529138202092106, 25.311463833231056, -3.2234862537886126], "policy_adversary_policy_reward": [12.757020429584438, 12.433161797546825, -26.690780430531476, -26.09145591141927, 5.987492112733642, -2.3054155299866395, -27.699380676308483, -2.838466974727041, 10.704273180183222, -3.611583691102517, 29.284185917462814, -10.635060887380916, 0.7254667907864207, -0.36601947256833967, -13.381939965161695, -15.474528338306978, -10.49294010032093, -18.05337312375256, -22.831985606353815, -6.632289636656598, -11.064823777292467, -22.47268890887485, -2.3054505964039933, -0.5187897191756932, -15.240934649597044, -20.664433576761763, -0.8661804457853037, -9.763879590460494, 11.785992021353625, 10.40736305968716, 4.465063457322323, -19.396578441689343, -17.45190694800403, -3.297884099575249, -5.028464855749839, -9.77533191074582, -14.291824471133921, -15.464078172267474, 4.105776161773189, -5.965714838025404, -10.808843729305316, -34.18453620074749, -0.8959747918069638, 8.042796746907264, -23.253407517476973, 4.183616066401484, 16.55909662610343, 36.98167156445223, -4.471073665115966, -25.838563332182378, -18.13272731508481, -4.1630694372100265, -37.492165875489576, -6.540299446153824, -16.93838772773818, 1.4091705761493714, -22.8604725875468, -26.339651530113493, -8.974484473152547, 2.382565030651314, -4.005455612034712, 1.4936404204811424, -16.64249059469891, -21.4261689202838, -8.450027511514183, -27.787174394590146, -15.157066344632138, -21.190746881966323, 0.2678818531067222, 8.812124241533475, 10.728144014930812, -20.73866802886554, -10.706437156685329, -23.169352501964852, -14.402009960889671, 1.7090248080864328, -7.890985197035857, -29.897487395719253, -31.172093572411015, -8.596519221080264, 6.618518689056231, 14.688223790694959, -5.842956471805117, -2.5689067483127204, -1.734693715454931, -5.848266764412443, -32.075214352070425, 1.6059767124089248, -4.2668563233081755, -9.890321366867752, -23.602293168122323, -29.73601897429661, -7.114285409037503, -10.812716581276453, 0.8509706519085753, -5.36690853049161, -4.066339109916704, -4.508068964965693, 1.2728787542769453, -4.165045414232001, 13.260468579118754, 26.18089748081045, 14.512553161509437, -1.2518848435695737, 2.801860679739989, 0.18372261704419657, -0.38260082591733635, 0.4595676257731327, -6.805709460371496, -1.288273461997214, 5.372407686841825, -8.892026582870265, 24.378997380146064, 17.473566816770667, 2.0452303078113943, -11.527236196975139, 5.903729855255186, -26.55469332504134, -1.8564476128166234, 12.952655924711287, 6.725682733778854, -7.58145894637072, -16.324046208984324, -6.438161486093346, 11.77717313441429, 6.643952972569011, 18.47435766025594, -1.2218436965996524, 1.8865023833941592, -17.709501283504633, 9.641931001442785, -26.922894854055127, -0.6933478350246602, -13.71158174715686, 0.0, 5.661079737841857, -26.40910125979707, -4.647587076762331, 7.269234393533239, -30.41020502325682, -8.185605710479877, -23.66115706135834, 11.318819263126542, -24.38651814818683, -23.65985441778712, -22.816533495900938, -11.24415852522074, -14.326273647444182, 3.4542536770420234, 3.7362308576922274, -22.405672296541216, -29.70609027463145, 15.313091205266995, 8.817343630018277, -6.020363694279633, -19.366648633277467, -9.90302865867641, -13.204199480405332, -25.166914052527016, -10.776831507115759, -8.313939748751771, -8.351569484352392, -2.150571246529381, -11.225917466205434, 11.621887138929175, -26.637654239589594, -17.48603936127312, -24.72550086807724, -26.157227497428327, 7.734114431867113, -6.4709453846896565, -4.8817860725656494, -14.173848668456163, -12.88332715668544, -2.1962937889784655, -21.553019395598124, -23.74986045244283, -10.822368740244315, -6.43701937676288, 21.079555037765964, -0.981939127329106, -6.259476695340755, -21.63062781853638, 11.506992006187062, -6.402726840066155, -0.4337569539751769, -17.87936601544116, -0.603610963295111, -16.34346379207388, -10.26023393432618, -3.2561294840294046, 1.8331618766619506, -22.364442847997687, -24.041545197650805, -13.014920746203455, -20.04335565798076, -29.911479357059918, -20.71144830940218, 16.776011444723686, -10.32903893714646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4200827251344616, "mean_inference_ms": 1.1050540325821843, "mean_action_processing_ms": 0.1805097119408774, "mean_env_wait_ms": 0.07335570098780651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004454135894775391, "StateBufferConnector_ms": 0.003378629684448242, "ViewRequirementAgentConnector_ms": 0.07229506969451904}, "num_episodes": 9, "episode_return_max": 26.770384095277887, "episode_return_min": -26.66915607120948, "episode_return_mean": -7.0774159647202115}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.48777239706527, "num_env_steps_trained_throughput_per_sec": 505.48777239706527, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2028000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2028000, "timers": {"training_iteration_time_ms": 8204.655, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8204.619, "sample_time_ms": 807.612, "learn_time_ms": 7383.527, "learn_throughput": 541.747, "synch_weights_time_ms": 12.907}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2028000, "num_agent_steps_trained": 2028000}, "done": false, "training_iteration": 169, "trial_id": "83a5c_00000", "date": "2024-08-10_12-37-50", "timestamp": 1723307870, "time_this_iter_s": 7.919518947601318, "time_total_s": 1431.3683927059174, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcdaf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1431.3683927059174, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 26.8, "ram_util_percent": 81.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.840495989767332, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7671194722728123, "policy_loss": -0.004648175840167496, "vf_loss": 1.771140488178011, "vf_explained_var": -0.11211178119851167, "kl": 0.007332947779594859, "entropy": 1.1722394697880618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2299457443878055, "cur_kl_coeff": 3.9826217324012695e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8081636067014187, "policy_loss": -0.002928003739846948, "vf_loss": 0.8110916059153775, "vf_explained_var": 0.8521763923888405, "kl": 0.003222478721056246, "entropy": 0.2250322296905021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 26.770384095277887, "episode_reward_min": -27.87786923882073, "episode_reward_mean": -7.713041564526512, "episode_len_mean": 377.59, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37759, "policy_reward_min": {"agent_policy": -26.77038409527784, "adversary_policy": -37.492165875489576}, "policy_reward_max": {"agent_policy": 27.877869238820733, "adversary_policy": 36.98167156445223}, "policy_reward_mean": {"agent_policy": 7.713041564526515, "adversary_policy": -7.713041564526513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.76875634308366, -1.4121201577898432, -17.95268411317941, -5.315030018122899, 11.096677540520389, -7.46575749218351, -10.37489552378964, -7.401898383247829, -14.877951321700696, -0.9299693381261172, -22.49668996502641, 3.5734109775501492, -9.534895725537742, 26.770384095277887, -15.15481849864917, -11.147898376147399, -22.016232660821682, -7.7646085757944, -24.60006205883015, -3.2959597212506164, -1.255907595776785, -19.03432975749136, -18.11860095305215, -18.173906613299213, 4.5400030473200985, -5.005262006967364, -16.937894829325092, -6.346492576401619, -18.894236296377546, -19.884306396745632, 10.6533712398756, -4.205931610058915, -3.791480239933687, -15.234618819830754, -7.078588845087964, -26.66915607120948, -8.963500995156979, -2.2579689392915174, -4.287204037441196, -1.446083329977526, 19.720683029964597, 6.630334158969935, 1.4927916483920929, 0.038483399927898176, -4.046991461184362, -1.7598094480142201, 20.926282098458348, -4.741002944581872, -10.32548173489308, 5.548104155947332, -0.4278881062959332, -11.381103847538835, 9.210563053491654, 8.626256981828206, -7.911499450055235, -8.64048192630617, -7.20246479109076, 2.830539868920929, -15.528344168279705, -11.570485314861793, -15.923381385919118, -6.533849442530144, -23.23819395684403, -12.785216086332461, 3.595242267367125, -26.055881285586334, 12.065217417642634, -12.693506163778551, -11.553614069540858, -17.971872779821386, -8.332754616552082, -6.688244356367408, -7.5078835503302095, -21.10577011467518, -9.211556532780605, -5.676365728627653, -13.528587912570801, -11.874656592288295, -17.286114596343577, 7.321267830501542, -3.6207079113349305, -5.061817906174658, -3.418241897020666, -9.241488489368136, -13.301848863200028, -0.7114838036837323, -23.20299402282425, -16.529138202092117, -25.31146383323106, 3.2234862537886126, -14.594503038634382, -20.934033213726206, -5.649305231346069, -13.07962518696211, 2.9885089471210193, -10.356853346569837, 0.8033948224702137, -24.39331411458406, -27.87786923882073, -8.075770437717898], "episode_lengths": [400, 400, 400, 400, 59, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 5, 400, 400, 400, 400, 400, 400, 4, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [16.768756343083663, 1.4121201577898432, 17.952684113179405, 5.315030018122899, -11.096677540520387, 7.46575749218351, 10.37489552378964, 7.401898383247829, 14.877951321700696, 0.9299693381261047, 22.496689965026434, -3.5734109775501492, 9.534895725537742, -26.77038409527784, 15.15481849864917, 11.147898376147396, 22.016232660821686, 7.764608575794405, 24.600062058830147, 3.2959597212506164, 1.255907595776785, 19.034329757491356, 18.118600953052155, 18.173906613299224, -4.5400030473200985, 5.005262006967364, 16.93789482932509, 6.346492576401619, 18.89423629637755, 19.884306396745636, -10.653371239875595, 4.205931610058926, 3.791480239933687, 15.234618819830754, 7.078588845087964, 26.669156071209475, 8.96350099515698, 2.2579689392915174, 4.287204037441187, 1.4460833299775278, -19.720683029964615, -6.63033415896993, -1.4927916483920929, -0.038483399927898176, 4.04699146118436, 1.7598094480142201, -20.92628209845835, 4.741002944581872, 10.32548173489308, -5.548104155947332, 0.4278881062959332, 11.381103847538835, -9.210563053491658, -8.6262569818281, 7.911499450055235, 8.64048192630617, 7.20246479109076, -2.8305398689209285, 15.528344168279702, 11.570485314861793, 15.923381385919118, 6.533849442530144, 23.238193956844025, 12.785216086332461, -3.595242267367125, 26.055881285586338, -12.065217417642636, 12.693506163778553, 11.55361406954086, 17.971872779821386, 8.332754616552082, 6.688244356367408, 7.5078835503302095, 21.10577011467518, 9.211556532780605, 5.676365728627653, 13.528587912570798, 11.874656592288295, 17.28611459634357, -7.321267830501542, 3.6207079113349305, 5.061817906174658, 3.418241897020666, 9.241488489368136, 13.301848863200028, 0.7114838036837199, 23.202994022824253, 16.529138202092106, 25.311463833231056, -3.2234862537886126, 14.594503038634382, 20.93403321372621, 5.649305231346069, 13.07962518696211, -2.9885089471210193, 10.356853346569837, -0.8033948224702137, 24.393314114584058, 27.877869238820733, 8.075770437717898], "policy_adversary_policy_reward": [-11.064823777292467, -22.47268890887485, -2.3054505964039933, -0.5187897191756932, -15.240934649597044, -20.664433576761763, -0.8661804457853037, -9.763879590460494, 11.785992021353625, 10.40736305968716, 4.465063457322323, -19.396578441689343, -17.45190694800403, -3.297884099575249, -5.028464855749839, -9.77533191074582, -14.291824471133921, -15.464078172267474, 4.105776161773189, -5.965714838025404, -10.808843729305316, -34.18453620074749, -0.8959747918069638, 8.042796746907264, -23.253407517476973, 4.183616066401484, 16.55909662610343, 36.98167156445223, -4.471073665115966, -25.838563332182378, -18.13272731508481, -4.1630694372100265, -37.492165875489576, -6.540299446153824, -16.93838772773818, 1.4091705761493714, -22.8604725875468, -26.339651530113493, -8.974484473152547, 2.382565030651314, -4.005455612034712, 1.4936404204811424, -16.64249059469891, -21.4261689202838, -8.450027511514183, -27.787174394590146, -15.157066344632138, -21.190746881966323, 0.2678818531067222, 8.812124241533475, 10.728144014930812, -20.73866802886554, -10.706437156685329, -23.169352501964852, -14.402009960889671, 1.7090248080864328, -7.890985197035857, -29.897487395719253, -31.172093572411015, -8.596519221080264, 6.618518689056231, 14.688223790694959, -5.842956471805117, -2.5689067483127204, -1.734693715454931, -5.848266764412443, -32.075214352070425, 1.6059767124089248, -4.2668563233081755, -9.890321366867752, -23.602293168122323, -29.73601897429661, -7.114285409037503, -10.812716581276453, 0.8509706519085753, -5.36690853049161, -4.066339109916704, -4.508068964965693, 1.2728787542769453, -4.165045414232001, 13.260468579118754, 26.18089748081045, 14.512553161509437, -1.2518848435695737, 2.801860679739989, 0.18372261704419657, -0.38260082591733635, 0.4595676257731327, -6.805709460371496, -1.288273461997214, 5.372407686841825, -8.892026582870265, 24.378997380146064, 17.473566816770667, 2.0452303078113943, -11.527236196975139, 5.903729855255186, -26.55469332504134, -1.8564476128166234, 12.952655924711287, 6.725682733778854, -7.58145894637072, -16.324046208984324, -6.438161486093346, 11.77717313441429, 6.643952972569011, 18.47435766025594, -1.2218436965996524, 1.8865023833941592, -17.709501283504633, 9.641931001442785, -26.922894854055127, -0.6933478350246602, -13.71158174715686, 0.0, 5.661079737841857, -26.40910125979707, -4.647587076762331, 7.269234393533239, -30.41020502325682, -8.185605710479877, -23.66115706135834, 11.318819263126542, -24.38651814818683, -23.65985441778712, -22.816533495900938, -11.24415852522074, -14.326273647444182, 3.4542536770420234, 3.7362308576922274, -22.405672296541216, -29.70609027463145, 15.313091205266995, 8.817343630018277, -6.020363694279633, -19.366648633277467, -9.90302865867641, -13.204199480405332, -25.166914052527016, -10.776831507115759, -8.313939748751771, -8.351569484352392, -2.150571246529381, -11.225917466205434, 11.621887138929175, -26.637654239589594, -17.48603936127312, -24.72550086807724, -26.157227497428327, 7.734114431867113, -6.4709453846896565, -4.8817860725656494, -14.173848668456163, -12.88332715668544, -2.1962937889784655, -21.553019395598124, -23.74986045244283, -10.822368740244315, -6.43701937676288, 21.079555037765964, -0.981939127329106, -6.259476695340755, -21.63062781853638, 11.506992006187062, -6.402726840066155, -0.4337569539751769, -17.87936601544116, -0.603610963295111, -16.34346379207388, -10.26023393432618, -3.2561294840294046, 1.8331618766619506, -22.364442847997687, -24.041545197650805, -13.014920746203455, -20.04335565798076, -29.911479357059918, -20.71144830940218, 16.776011444723686, -10.32903893714646, -32.8593033718809, 3.6702972946121335, -27.91667111972661, -13.951395307725807, 3.7113754624107287, -15.009985925102868, -21.09690662812247, -5.062343745801755, 4.581142733390635, 1.3958751608514035, 10.965683284267726, -31.679389977407396, 2.8187811136796554, -1.2119914687392281, -30.447896447969242, -18.338731781198916, -23.530710779919946, -32.225027697721515, 0.388227665929449, -16.539768541365245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4199163093010236, "mean_inference_ms": 1.1049145384645984, "mean_action_processing_ms": 0.18047629716838798, "mean_env_wait_ms": 0.0733475141335833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004549503326416016, "StateBufferConnector_ms": 0.0034908056259155273, "ViewRequirementAgentConnector_ms": 0.0742417573928833}, "num_episodes": 10, "episode_return_max": 26.770384095277887, "episode_return_min": -27.87786923882073, "episode_return_mean": -7.713041564526512}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.56380932534574, "num_env_steps_trained_throughput_per_sec": 481.56380932534574, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 8210.876, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8210.839, "sample_time_ms": 814.828, "learn_time_ms": 7382.162, "learn_throughput": 541.847, "synch_weights_time_ms": 13.23}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 170, "trial_id": "83a5c_00000", "date": "2024-08-10_12-37-59", "timestamp": 1723307879, "time_this_iter_s": 8.350497961044312, "time_total_s": 1439.7188906669617, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcdaee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1439.7188906669617, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 28.20833333333334, "ram_util_percent": 82.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8699867092427755, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.034957715506276, "policy_loss": -0.006293403388804229, "vf_loss": 2.0407796775222455, "vf_explained_var": -0.019082620282652518, "kl": 0.0055122465961896525, "entropy": 1.1813638957719954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.381438746955246, "cur_kl_coeff": 1.9913108662006347e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.253366469281415, "policy_loss": -0.003410167366140134, "vf_loss": 1.2567766388257344, "vf_explained_var": 0.6919074033697447, "kl": 0.0016975407926190344, "entropy": 0.204223881320407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "env_runners": {"episode_reward_max": 26.770384095277887, "episode_reward_min": -31.476644151017755, "episode_reward_mean": -8.569975469474535, "episode_len_mean": 381.0, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38100, "policy_reward_min": {"agent_policy": -26.77038409527784, "adversary_policy": -37.492165875489576}, "policy_reward_max": {"agent_policy": 31.47664415101776, "adversary_policy": 36.98167156445223}, "policy_reward_mean": {"agent_policy": 8.569975469474537, "adversary_policy": -8.569975469474539}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.5734109775501492, -9.534895725537742, 26.770384095277887, -15.15481849864917, -11.147898376147399, -22.016232660821682, -7.7646085757944, -24.60006205883015, -3.2959597212506164, -1.255907595776785, -19.03432975749136, -18.11860095305215, -18.173906613299213, 4.5400030473200985, -5.005262006967364, -16.937894829325092, -6.346492576401619, -18.894236296377546, -19.884306396745632, 10.6533712398756, -4.205931610058915, -3.791480239933687, -15.234618819830754, -7.078588845087964, -26.66915607120948, -8.963500995156979, -2.2579689392915174, -4.287204037441196, -1.446083329977526, 19.720683029964597, 6.630334158969935, 1.4927916483920929, 0.038483399927898176, -4.046991461184362, -1.7598094480142201, 20.926282098458348, -4.741002944581872, -10.32548173489308, 5.548104155947332, -0.4278881062959332, -11.381103847538835, 9.210563053491654, 8.626256981828206, -7.911499450055235, -8.64048192630617, -7.20246479109076, 2.830539868920929, -15.528344168279705, -11.570485314861793, -15.923381385919118, -6.533849442530144, -23.23819395684403, -12.785216086332461, 3.595242267367125, -26.055881285586334, 12.065217417642634, -12.693506163778551, -11.553614069540858, -17.971872779821386, -8.332754616552082, -6.688244356367408, -7.5078835503302095, -21.10577011467518, -9.211556532780605, -5.676365728627653, -13.528587912570801, -11.874656592288295, -17.286114596343577, 7.321267830501542, -3.6207079113349305, -5.061817906174658, -3.418241897020666, -9.241488489368136, -13.301848863200028, -0.7114838036837323, -23.20299402282425, -16.529138202092117, -25.31146383323106, 3.2234862537886126, -14.594503038634382, -20.934033213726206, -5.649305231346069, -13.07962518696211, 2.9885089471210193, -10.356853346569837, 0.8033948224702137, -24.39331411458406, -27.87786923882073, -8.075770437717898, -14.042589683731741, -14.095699895447765, -9.201857979739335, -25.557019584287737, -7.283417294376587, -8.554211713184875, -21.06652990850533, -31.476644151017755, -13.363056793657563, -27.35634595038793, -7.595092656195472], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 5, 400, 400, 400, 400, 400, 400, 4, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-3.5734109775501492, 9.534895725537742, -26.77038409527784, 15.15481849864917, 11.147898376147396, 22.016232660821686, 7.764608575794405, 24.600062058830147, 3.2959597212506164, 1.255907595776785, 19.034329757491356, 18.118600953052155, 18.173906613299224, -4.5400030473200985, 5.005262006967364, 16.93789482932509, 6.346492576401619, 18.89423629637755, 19.884306396745636, -10.653371239875595, 4.205931610058926, 3.791480239933687, 15.234618819830754, 7.078588845087964, 26.669156071209475, 8.96350099515698, 2.2579689392915174, 4.287204037441187, 1.4460833299775278, -19.720683029964615, -6.63033415896993, -1.4927916483920929, -0.038483399927898176, 4.04699146118436, 1.7598094480142201, -20.92628209845835, 4.741002944581872, 10.32548173489308, -5.548104155947332, 0.4278881062959332, 11.381103847538835, -9.210563053491658, -8.6262569818281, 7.911499450055235, 8.64048192630617, 7.20246479109076, -2.8305398689209285, 15.528344168279702, 11.570485314861793, 15.923381385919118, 6.533849442530144, 23.238193956844025, 12.785216086332461, -3.595242267367125, 26.055881285586338, -12.065217417642636, 12.693506163778553, 11.55361406954086, 17.971872779821386, 8.332754616552082, 6.688244356367408, 7.5078835503302095, 21.10577011467518, 9.211556532780605, 5.676365728627653, 13.528587912570798, 11.874656592288295, 17.28611459634357, -7.321267830501542, 3.6207079113349305, 5.061817906174658, 3.418241897020666, 9.241488489368136, 13.301848863200028, 0.7114838036837199, 23.202994022824253, 16.529138202092106, 25.311463833231056, -3.2234862537886126, 14.594503038634382, 20.93403321372621, 5.649305231346069, 13.07962518696211, -2.9885089471210193, 10.356853346569837, -0.8033948224702137, 24.393314114584058, 27.877869238820733, 8.075770437717898, 14.042589683731741, 14.095699895447765, 9.201857979739335, 25.557019584287733, 7.283417294376587, 8.554211713184875, 21.066529908505327, 31.47664415101776, 13.363056793657565, 27.356345950387926, 7.5950926561954635], "policy_adversary_policy_reward": [-0.8959747918069638, 8.042796746907264, -23.253407517476973, 4.183616066401484, 16.55909662610343, 36.98167156445223, -4.471073665115966, -25.838563332182378, -18.13272731508481, -4.1630694372100265, -37.492165875489576, -6.540299446153824, -16.93838772773818, 1.4091705761493714, -22.8604725875468, -26.339651530113493, -8.974484473152547, 2.382565030651314, -4.005455612034712, 1.4936404204811424, -16.64249059469891, -21.4261689202838, -8.450027511514183, -27.787174394590146, -15.157066344632138, -21.190746881966323, 0.2678818531067222, 8.812124241533475, 10.728144014930812, -20.73866802886554, -10.706437156685329, -23.169352501964852, -14.402009960889671, 1.7090248080864328, -7.890985197035857, -29.897487395719253, -31.172093572411015, -8.596519221080264, 6.618518689056231, 14.688223790694959, -5.842956471805117, -2.5689067483127204, -1.734693715454931, -5.848266764412443, -32.075214352070425, 1.6059767124089248, -4.2668563233081755, -9.890321366867752, -23.602293168122323, -29.73601897429661, -7.114285409037503, -10.812716581276453, 0.8509706519085753, -5.36690853049161, -4.066339109916704, -4.508068964965693, 1.2728787542769453, -4.165045414232001, 13.260468579118754, 26.18089748081045, 14.512553161509437, -1.2518848435695737, 2.801860679739989, 0.18372261704419657, -0.38260082591733635, 0.4595676257731327, -6.805709460371496, -1.288273461997214, 5.372407686841825, -8.892026582870265, 24.378997380146064, 17.473566816770667, 2.0452303078113943, -11.527236196975139, 5.903729855255186, -26.55469332504134, -1.8564476128166234, 12.952655924711287, 6.725682733778854, -7.58145894637072, -16.324046208984324, -6.438161486093346, 11.77717313441429, 6.643952972569011, 18.47435766025594, -1.2218436965996524, 1.8865023833941592, -17.709501283504633, 9.641931001442785, -26.922894854055127, -0.6933478350246602, -13.71158174715686, 0.0, 5.661079737841857, -26.40910125979707, -4.647587076762331, 7.269234393533239, -30.41020502325682, -8.185605710479877, -23.66115706135834, 11.318819263126542, -24.38651814818683, -23.65985441778712, -22.816533495900938, -11.24415852522074, -14.326273647444182, 3.4542536770420234, 3.7362308576922274, -22.405672296541216, -29.70609027463145, 15.313091205266995, 8.817343630018277, -6.020363694279633, -19.366648633277467, -9.90302865867641, -13.204199480405332, -25.166914052527016, -10.776831507115759, -8.313939748751771, -8.351569484352392, -2.150571246529381, -11.225917466205434, 11.621887138929175, -26.637654239589594, -17.48603936127312, -24.72550086807724, -26.157227497428327, 7.734114431867113, -6.4709453846896565, -4.8817860725656494, -14.173848668456163, -12.88332715668544, -2.1962937889784655, -21.553019395598124, -23.74986045244283, -10.822368740244315, -6.43701937676288, 21.079555037765964, -0.981939127329106, -6.259476695340755, -21.63062781853638, 11.506992006187062, -6.402726840066155, -0.4337569539751769, -17.87936601544116, -0.603610963295111, -16.34346379207388, -10.26023393432618, -3.2561294840294046, 1.8331618766619506, -22.364442847997687, -24.041545197650805, -13.014920746203455, -20.04335565798076, -29.911479357059918, -20.71144830940218, 16.776011444723686, -10.32903893714646, -32.8593033718809, 3.6702972946121335, -27.91667111972661, -13.951395307725807, 3.7113754624107287, -15.009985925102868, -21.09690662812247, -5.062343745801755, 4.581142733390635, 1.3958751608514035, 10.965683284267726, -31.679389977407396, 2.8187811136796554, -1.2119914687392281, -30.447896447969242, -18.338731781198916, -23.530710779919946, -32.225027697721515, 0.388227665929449, -16.539768541365245, -4.766025814223763, -23.319153553239722, -2.944529963434462, -25.246869827461072, -3.4478415863114087, -14.955874373167262, -19.72294915150913, -31.39109001706634, 6.405765543210819, -20.972600131963993, -5.940937297614422, -11.167486128755328, -19.072827317300543, -23.060232499710118, -34.71271762659551, -28.24057067544005, -7.524084635323323, -19.202028951991807, -25.08308814080562, -29.62960375997023, -9.621749688870523, -5.568435623520401]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41969705195056295, "mean_inference_ms": 1.10440931852658, "mean_action_processing_ms": 0.18042412602176833, "mean_env_wait_ms": 0.07330584869429671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004424571990966797, "StateBufferConnector_ms": 0.0034028291702270508, "ViewRequirementAgentConnector_ms": 0.07249605655670166}, "num_episodes": 11, "episode_return_max": 26.770384095277887, "episode_return_min": -31.476644151017755, "episode_return_mean": -8.569975469474535}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.19414879507343, "num_env_steps_trained_throughput_per_sec": 509.19414879507343, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2052000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2052000, "timers": {"training_iteration_time_ms": 8165.659, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8165.623, "sample_time_ms": 811.735, "learn_time_ms": 7340.532, "learn_throughput": 544.92, "synch_weights_time_ms": 12.739}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2052000, "num_agent_steps_trained": 2052000}, "done": false, "training_iteration": 171, "trial_id": "83a5c_00000", "date": "2024-08-10_12-38-06", "timestamp": 1723307886, "time_this_iter_s": 7.859595060348511, "time_total_s": 1447.5784857273102, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1447.5784857273102, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 27.181818181818187, "ram_util_percent": 82.49090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8099701757468876, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1622914260657375, "policy_loss": -0.0094362476227125, "vf_loss": 2.170474377637187, "vf_explained_var": -0.12300298330645082, "kl": 0.014653921443512869, "entropy": 1.1382182130107172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4848964515452585, "cur_kl_coeff": 9.956554331003174e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5341449367813766, "policy_loss": -0.012880243282415904, "vf_loss": 1.5470251799871524, "vf_explained_var": 0.3127625765278935, "kl": 0.00793971625013768, "entropy": 0.1588462912167112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 20.926282098458348, "episode_reward_min": -31.476644151017755, "episode_reward_mean": -8.414574218673495, "episode_len_mean": 381.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38100, "policy_reward_min": {"agent_policy": -20.92628209845835, "adversary_policy": -34.71271762659551}, "policy_reward_max": {"agent_policy": 31.47664415101776, "adversary_policy": 26.18089748081045}, "policy_reward_mean": {"agent_policy": 8.414574218673495, "adversary_policy": -8.414574218673495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.03432975749136, -18.11860095305215, -18.173906613299213, 4.5400030473200985, -5.005262006967364, -16.937894829325092, -6.346492576401619, -18.894236296377546, -19.884306396745632, 10.6533712398756, -4.205931610058915, -3.791480239933687, -15.234618819830754, -7.078588845087964, -26.66915607120948, -8.963500995156979, -2.2579689392915174, -4.287204037441196, -1.446083329977526, 19.720683029964597, 6.630334158969935, 1.4927916483920929, 0.038483399927898176, -4.046991461184362, -1.7598094480142201, 20.926282098458348, -4.741002944581872, -10.32548173489308, 5.548104155947332, -0.4278881062959332, -11.381103847538835, 9.210563053491654, 8.626256981828206, -7.911499450055235, -8.64048192630617, -7.20246479109076, 2.830539868920929, -15.528344168279705, -11.570485314861793, -15.923381385919118, -6.533849442530144, -23.23819395684403, -12.785216086332461, 3.595242267367125, -26.055881285586334, 12.065217417642634, -12.693506163778551, -11.553614069540858, -17.971872779821386, -8.332754616552082, -6.688244356367408, -7.5078835503302095, -21.10577011467518, -9.211556532780605, -5.676365728627653, -13.528587912570801, -11.874656592288295, -17.286114596343577, 7.321267830501542, -3.6207079113349305, -5.061817906174658, -3.418241897020666, -9.241488489368136, -13.301848863200028, -0.7114838036837323, -23.20299402282425, -16.529138202092117, -25.31146383323106, 3.2234862537886126, -14.594503038634382, -20.934033213726206, -5.649305231346069, -13.07962518696211, 2.9885089471210193, -10.356853346569837, 0.8033948224702137, -24.39331411458406, -27.87786923882073, -8.075770437717898, -14.042589683731741, -14.095699895447765, -9.201857979739335, -25.557019584287737, -7.283417294376587, -8.554211713184875, -21.06652990850533, -31.476644151017755, -13.363056793657563, -27.35634595038793, -7.595092656195472, -15.858298475605732, -8.375771239456503, 11.391991865453221, 11.534383098053311, 5.6170745997117635, -26.365662477574745, -18.10858328507871, 6.508546184405045, -7.5140245010085, -7.7161188287749685], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 5, 400, 400, 400, 400, 400, 400, 4, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [19.034329757491356, 18.118600953052155, 18.173906613299224, -4.5400030473200985, 5.005262006967364, 16.93789482932509, 6.346492576401619, 18.89423629637755, 19.884306396745636, -10.653371239875595, 4.205931610058926, 3.791480239933687, 15.234618819830754, 7.078588845087964, 26.669156071209475, 8.96350099515698, 2.2579689392915174, 4.287204037441187, 1.4460833299775278, -19.720683029964615, -6.63033415896993, -1.4927916483920929, -0.038483399927898176, 4.04699146118436, 1.7598094480142201, -20.92628209845835, 4.741002944581872, 10.32548173489308, -5.548104155947332, 0.4278881062959332, 11.381103847538835, -9.210563053491658, -8.6262569818281, 7.911499450055235, 8.64048192630617, 7.20246479109076, -2.8305398689209285, 15.528344168279702, 11.570485314861793, 15.923381385919118, 6.533849442530144, 23.238193956844025, 12.785216086332461, -3.595242267367125, 26.055881285586338, -12.065217417642636, 12.693506163778553, 11.55361406954086, 17.971872779821386, 8.332754616552082, 6.688244356367408, 7.5078835503302095, 21.10577011467518, 9.211556532780605, 5.676365728627653, 13.528587912570798, 11.874656592288295, 17.28611459634357, -7.321267830501542, 3.6207079113349305, 5.061817906174658, 3.418241897020666, 9.241488489368136, 13.301848863200028, 0.7114838036837199, 23.202994022824253, 16.529138202092106, 25.311463833231056, -3.2234862537886126, 14.594503038634382, 20.93403321372621, 5.649305231346069, 13.07962518696211, -2.9885089471210193, 10.356853346569837, -0.8033948224702137, 24.393314114584058, 27.877869238820733, 8.075770437717898, 14.042589683731741, 14.095699895447765, 9.201857979739335, 25.557019584287733, 7.283417294376587, 8.554211713184875, 21.066529908505327, 31.47664415101776, 13.363056793657565, 27.356345950387926, 7.5950926561954635, 15.858298475605732, 8.375771239456503, -11.391991865453221, -11.534383098053311, -5.6170745997117635, 26.36566247757474, 18.108583285078705, -6.508546184405045, 7.5140245010085, 7.7161188287749685], "policy_adversary_policy_reward": [-16.64249059469891, -21.4261689202838, -8.450027511514183, -27.787174394590146, -15.157066344632138, -21.190746881966323, 0.2678818531067222, 8.812124241533475, 10.728144014930812, -20.73866802886554, -10.706437156685329, -23.169352501964852, -14.402009960889671, 1.7090248080864328, -7.890985197035857, -29.897487395719253, -31.172093572411015, -8.596519221080264, 6.618518689056231, 14.688223790694959, -5.842956471805117, -2.5689067483127204, -1.734693715454931, -5.848266764412443, -32.075214352070425, 1.6059767124089248, -4.2668563233081755, -9.890321366867752, -23.602293168122323, -29.73601897429661, -7.114285409037503, -10.812716581276453, 0.8509706519085753, -5.36690853049161, -4.066339109916704, -4.508068964965693, 1.2728787542769453, -4.165045414232001, 13.260468579118754, 26.18089748081045, 14.512553161509437, -1.2518848435695737, 2.801860679739989, 0.18372261704419657, -0.38260082591733635, 0.4595676257731327, -6.805709460371496, -1.288273461997214, 5.372407686841825, -8.892026582870265, 24.378997380146064, 17.473566816770667, 2.0452303078113943, -11.527236196975139, 5.903729855255186, -26.55469332504134, -1.8564476128166234, 12.952655924711287, 6.725682733778854, -7.58145894637072, -16.324046208984324, -6.438161486093346, 11.77717313441429, 6.643952972569011, 18.47435766025594, -1.2218436965996524, 1.8865023833941592, -17.709501283504633, 9.641931001442785, -26.922894854055127, -0.6933478350246602, -13.71158174715686, 0.0, 5.661079737841857, -26.40910125979707, -4.647587076762331, 7.269234393533239, -30.41020502325682, -8.185605710479877, -23.66115706135834, 11.318819263126542, -24.38651814818683, -23.65985441778712, -22.816533495900938, -11.24415852522074, -14.326273647444182, 3.4542536770420234, 3.7362308576922274, -22.405672296541216, -29.70609027463145, 15.313091205266995, 8.817343630018277, -6.020363694279633, -19.366648633277467, -9.90302865867641, -13.204199480405332, -25.166914052527016, -10.776831507115759, -8.313939748751771, -8.351569484352392, -2.150571246529381, -11.225917466205434, 11.621887138929175, -26.637654239589594, -17.48603936127312, -24.72550086807724, -26.157227497428327, 7.734114431867113, -6.4709453846896565, -4.8817860725656494, -14.173848668456163, -12.88332715668544, -2.1962937889784655, -21.553019395598124, -23.74986045244283, -10.822368740244315, -6.43701937676288, 21.079555037765964, -0.981939127329106, -6.259476695340755, -21.63062781853638, 11.506992006187062, -6.402726840066155, -0.4337569539751769, -17.87936601544116, -0.603610963295111, -16.34346379207388, -10.26023393432618, -3.2561294840294046, 1.8331618766619506, -22.364442847997687, -24.041545197650805, -13.014920746203455, -20.04335565798076, -29.911479357059918, -20.71144830940218, 16.776011444723686, -10.32903893714646, -32.8593033718809, 3.6702972946121335, -27.91667111972661, -13.951395307725807, 3.7113754624107287, -15.009985925102868, -21.09690662812247, -5.062343745801755, 4.581142733390635, 1.3958751608514035, 10.965683284267726, -31.679389977407396, 2.8187811136796554, -1.2119914687392281, -30.447896447969242, -18.338731781198916, -23.530710779919946, -32.225027697721515, 0.388227665929449, -16.539768541365245, -4.766025814223763, -23.319153553239722, -2.944529963434462, -25.246869827461072, -3.4478415863114087, -14.955874373167262, -19.72294915150913, -31.39109001706634, 6.405765543210819, -20.972600131963993, -5.940937297614422, -11.167486128755328, -19.072827317300543, -23.060232499710118, -34.71271762659551, -28.24057067544005, -7.524084635323323, -19.202028951991807, -25.08308814080562, -29.62960375997023, -9.621749688870523, -5.568435623520401, -24.010561156470047, -7.7060357947414175, 13.055507941908573, -29.807050420821575, 11.009287455016704, 11.774696275889738, 14.744054551793198, 8.324711644313425, 0.9842708419798569, 10.24987835744367, -22.861510824684963, -29.869814130464512, -28.31235442630881, -7.904812143848577, -0.7520474272202762, 13.769139796030366, -15.16118072613392, 0.13313172411692165, 3.030827886719095, -18.463065544269032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4195506221113265, "mean_inference_ms": 1.1036214210703714, "mean_action_processing_ms": 0.18033728629791665, "mean_env_wait_ms": 0.07325135176636789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004191160202026367, "StateBufferConnector_ms": 0.0029969215393066406, "ViewRequirementAgentConnector_ms": 0.06908643245697021}, "num_episodes": 10, "episode_return_max": 20.926282098458348, "episode_return_min": -31.476644151017755, "episode_return_mean": -8.414574218673495}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.12697093563384, "num_env_steps_trained_throughput_per_sec": 510.12697093563384, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 8086.22, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8086.184, "sample_time_ms": 778.588, "learn_time_ms": 7294.424, "learn_throughput": 548.364, "synch_weights_time_ms": 12.614}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 172, "trial_id": "83a5c_00000", "date": "2024-08-10_12-38-14", "timestamp": 1723307894, "time_this_iter_s": 7.846287965774536, "time_total_s": 1455.4247736930847, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1455.4247736930847, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 27.836363636363636, "ram_util_percent": 82.32727272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7264163191040987, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8880730313914162, "policy_loss": -0.014628060445899056, "vf_loss": 1.9016409969203687, "vf_explained_var": -0.22971584055789565, "kl": 0.01239504484492255, "entropy": 1.1198606007313603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.217416187375784, "cur_kl_coeff": 9.956554331003174e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1655110077622035, "policy_loss": -0.004786881671316223, "vf_loss": 1.1702978920191527, "vf_explained_var": 0.7544272807737191, "kl": 0.002500519072212985, "entropy": 0.13006336925706516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "env_runners": {"episode_reward_max": 21.623629916595668, "episode_reward_min": -31.476644151017755, "episode_reward_mean": -8.08535122311053, "episode_len_mean": 381.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38100, "policy_reward_min": {"agent_policy": -21.623629916595664, "adversary_policy": -34.71271762659551}, "policy_reward_max": {"agent_policy": 31.47664415101776, "adversary_policy": 26.18089748081045}, "policy_reward_mean": {"agent_policy": 8.08535122311053, "adversary_policy": -8.08535122311053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.205931610058915, -3.791480239933687, -15.234618819830754, -7.078588845087964, -26.66915607120948, -8.963500995156979, -2.2579689392915174, -4.287204037441196, -1.446083329977526, 19.720683029964597, 6.630334158969935, 1.4927916483920929, 0.038483399927898176, -4.046991461184362, -1.7598094480142201, 20.926282098458348, -4.741002944581872, -10.32548173489308, 5.548104155947332, -0.4278881062959332, -11.381103847538835, 9.210563053491654, 8.626256981828206, -7.911499450055235, -8.64048192630617, -7.20246479109076, 2.830539868920929, -15.528344168279705, -11.570485314861793, -15.923381385919118, -6.533849442530144, -23.23819395684403, -12.785216086332461, 3.595242267367125, -26.055881285586334, 12.065217417642634, -12.693506163778551, -11.553614069540858, -17.971872779821386, -8.332754616552082, -6.688244356367408, -7.5078835503302095, -21.10577011467518, -9.211556532780605, -5.676365728627653, -13.528587912570801, -11.874656592288295, -17.286114596343577, 7.321267830501542, -3.6207079113349305, -5.061817906174658, -3.418241897020666, -9.241488489368136, -13.301848863200028, -0.7114838036837323, -23.20299402282425, -16.529138202092117, -25.31146383323106, 3.2234862537886126, -14.594503038634382, -20.934033213726206, -5.649305231346069, -13.07962518696211, 2.9885089471210193, -10.356853346569837, 0.8033948224702137, -24.39331411458406, -27.87786923882073, -8.075770437717898, -14.042589683731741, -14.095699895447765, -9.201857979739335, -25.557019584287737, -7.283417294376587, -8.554211713184875, -21.06652990850533, -31.476644151017755, -13.363056793657563, -27.35634595038793, -7.595092656195472, -15.858298475605732, -8.375771239456503, 11.391991865453221, 11.534383098053311, 5.6170745997117635, -26.365662477574745, -18.10858328507871, 6.508546184405045, -7.5140245010085, -7.7161188287749685, 6.41934599246682, 21.623629916595668, -10.786728267406259, -19.01224225587386, -22.069989351967077, -0.5955443822656417, -7.827076351185548, -12.463084590612524, -13.92975000920833, -15.63791628671105], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 2, 400, 400, 400, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 5, 400, 400, 400, 400, 400, 400, 4, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [4.205931610058926, 3.791480239933687, 15.234618819830754, 7.078588845087964, 26.669156071209475, 8.96350099515698, 2.2579689392915174, 4.287204037441187, 1.4460833299775278, -19.720683029964615, -6.63033415896993, -1.4927916483920929, -0.038483399927898176, 4.04699146118436, 1.7598094480142201, -20.92628209845835, 4.741002944581872, 10.32548173489308, -5.548104155947332, 0.4278881062959332, 11.381103847538835, -9.210563053491658, -8.6262569818281, 7.911499450055235, 8.64048192630617, 7.20246479109076, -2.8305398689209285, 15.528344168279702, 11.570485314861793, 15.923381385919118, 6.533849442530144, 23.238193956844025, 12.785216086332461, -3.595242267367125, 26.055881285586338, -12.065217417642636, 12.693506163778553, 11.55361406954086, 17.971872779821386, 8.332754616552082, 6.688244356367408, 7.5078835503302095, 21.10577011467518, 9.211556532780605, 5.676365728627653, 13.528587912570798, 11.874656592288295, 17.28611459634357, -7.321267830501542, 3.6207079113349305, 5.061817906174658, 3.418241897020666, 9.241488489368136, 13.301848863200028, 0.7114838036837199, 23.202994022824253, 16.529138202092106, 25.311463833231056, -3.2234862537886126, 14.594503038634382, 20.93403321372621, 5.649305231346069, 13.07962518696211, -2.9885089471210193, 10.356853346569837, -0.8033948224702137, 24.393314114584058, 27.877869238820733, 8.075770437717898, 14.042589683731741, 14.095699895447765, 9.201857979739335, 25.557019584287733, 7.283417294376587, 8.554211713184875, 21.066529908505327, 31.47664415101776, 13.363056793657565, 27.356345950387926, 7.5950926561954635, 15.858298475605732, 8.375771239456503, -11.391991865453221, -11.534383098053311, -5.6170745997117635, 26.36566247757474, 18.108583285078705, -6.508546184405045, 7.5140245010085, 7.7161188287749685, -6.41934599246682, -21.623629916595664, 10.786728267406259, 19.01224225587386, 22.069989351967074, 0.5955443822656417, 7.827076351185548, 12.46308459061252, 13.92975000920833, 15.637916286711047], "policy_adversary_policy_reward": [-5.842956471805117, -2.5689067483127204, -1.734693715454931, -5.848266764412443, -32.075214352070425, 1.6059767124089248, -4.2668563233081755, -9.890321366867752, -23.602293168122323, -29.73601897429661, -7.114285409037503, -10.812716581276453, 0.8509706519085753, -5.36690853049161, -4.066339109916704, -4.508068964965693, 1.2728787542769453, -4.165045414232001, 13.260468579118754, 26.18089748081045, 14.512553161509437, -1.2518848435695737, 2.801860679739989, 0.18372261704419657, -0.38260082591733635, 0.4595676257731327, -6.805709460371496, -1.288273461997214, 5.372407686841825, -8.892026582870265, 24.378997380146064, 17.473566816770667, 2.0452303078113943, -11.527236196975139, 5.903729855255186, -26.55469332504134, -1.8564476128166234, 12.952655924711287, 6.725682733778854, -7.58145894637072, -16.324046208984324, -6.438161486093346, 11.77717313441429, 6.643952972569011, 18.47435766025594, -1.2218436965996524, 1.8865023833941592, -17.709501283504633, 9.641931001442785, -26.922894854055127, -0.6933478350246602, -13.71158174715686, 0.0, 5.661079737841857, -26.40910125979707, -4.647587076762331, 7.269234393533239, -30.41020502325682, -8.185605710479877, -23.66115706135834, 11.318819263126542, -24.38651814818683, -23.65985441778712, -22.816533495900938, -11.24415852522074, -14.326273647444182, 3.4542536770420234, 3.7362308576922274, -22.405672296541216, -29.70609027463145, 15.313091205266995, 8.817343630018277, -6.020363694279633, -19.366648633277467, -9.90302865867641, -13.204199480405332, -25.166914052527016, -10.776831507115759, -8.313939748751771, -8.351569484352392, -2.150571246529381, -11.225917466205434, 11.621887138929175, -26.637654239589594, -17.48603936127312, -24.72550086807724, -26.157227497428327, 7.734114431867113, -6.4709453846896565, -4.8817860725656494, -14.173848668456163, -12.88332715668544, -2.1962937889784655, -21.553019395598124, -23.74986045244283, -10.822368740244315, -6.43701937676288, 21.079555037765964, -0.981939127329106, -6.259476695340755, -21.63062781853638, 11.506992006187062, -6.402726840066155, -0.4337569539751769, -17.87936601544116, -0.603610963295111, -16.34346379207388, -10.26023393432618, -3.2561294840294046, 1.8331618766619506, -22.364442847997687, -24.041545197650805, -13.014920746203455, -20.04335565798076, -29.911479357059918, -20.71144830940218, 16.776011444723686, -10.32903893714646, -32.8593033718809, 3.6702972946121335, -27.91667111972661, -13.951395307725807, 3.7113754624107287, -15.009985925102868, -21.09690662812247, -5.062343745801755, 4.581142733390635, 1.3958751608514035, 10.965683284267726, -31.679389977407396, 2.8187811136796554, -1.2119914687392281, -30.447896447969242, -18.338731781198916, -23.530710779919946, -32.225027697721515, 0.388227665929449, -16.539768541365245, -4.766025814223763, -23.319153553239722, -2.944529963434462, -25.246869827461072, -3.4478415863114087, -14.955874373167262, -19.72294915150913, -31.39109001706634, 6.405765543210819, -20.972600131963993, -5.940937297614422, -11.167486128755328, -19.072827317300543, -23.060232499710118, -34.71271762659551, -28.24057067544005, -7.524084635323323, -19.202028951991807, -25.08308814080562, -29.62960375997023, -9.621749688870523, -5.568435623520401, -24.010561156470047, -7.7060357947414175, 13.055507941908573, -29.807050420821575, 11.009287455016704, 11.774696275889738, 14.744054551793198, 8.324711644313425, 0.9842708419798569, 10.24987835744367, -22.861510824684963, -29.869814130464512, -28.31235442630881, -7.904812143848577, -0.7520474272202762, 13.769139796030366, -15.16118072613392, 0.13313172411692165, 3.030827886719095, -18.463065544269032, -3.1435382803271423, 15.982230265260782, 20.675710145804764, 22.57154968738657, -0.3548681995415741, -21.218588335270947, -22.529971038370924, -15.494513473376795, -16.87897179043474, -27.261006913499415, -11.662463722999224, 10.47137495846794, 3.6073640242562632, -19.26151672662736, -24.12795603443132, -0.7982131467937172, -7.558541909751469, -20.300958108665192, -18.346273445254667, -12.92955912816743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41932155062330945, "mean_inference_ms": 1.1029888814579853, "mean_action_processing_ms": 0.18024421839575958, "mean_env_wait_ms": 0.07320473181472542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004149198532104492, "StateBufferConnector_ms": 0.002940058708190918, "ViewRequirementAgentConnector_ms": 0.06812131404876709}, "num_episodes": 10, "episode_return_max": 21.623629916595668, "episode_return_min": -31.476644151017755, "episode_return_mean": -8.08535122311053}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 494.7680216054277, "num_env_steps_trained_throughput_per_sec": 494.7680216054277, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2076000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2076000, "timers": {"training_iteration_time_ms": 8002.489, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8002.453, "sample_time_ms": 772.359, "learn_time_ms": 7217.154, "learn_throughput": 554.235, "synch_weights_time_ms": 12.377}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2076000, "num_agent_steps_trained": 2076000}, "done": false, "training_iteration": 173, "trial_id": "83a5c_00000", "date": "2024-08-10_12-38-22", "timestamp": 1723307902, "time_this_iter_s": 8.088903903961182, "time_total_s": 1463.513677597046, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fbc8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1463.513677597046, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 28.854545454545452, "ram_util_percent": 82.17272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8255767577539674, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0451083586960244, "policy_loss": -0.005159185634600738, "vf_loss": 2.0492997820415195, "vf_explained_var": -0.04685055468448256, "kl": 0.011315386679337673, "entropy": 1.109644790553542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.19068541219458, "cur_kl_coeff": 4.978277165501587e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6578370709593098, "policy_loss": -0.007087921010194501, "vf_loss": 1.664924983556072, "vf_explained_var": 0.5137853282814224, "kl": 0.002145898832540827, "entropy": 0.13909682768086593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "env_runners": {"episode_reward_max": 21.623629916595668, "episode_reward_min": -31.476644151017755, "episode_reward_mean": -9.056126861506632, "episode_len_mean": 381.0, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38100, "policy_reward_min": {"agent_policy": -21.623629916595664, "adversary_policy": -35.38020076607657}, "policy_reward_max": {"agent_policy": 31.47664415101776, "adversary_policy": 24.378997380146064}, "policy_reward_mean": {"agent_policy": 9.056126861506632, "adversary_policy": -9.056126861506632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.630334158969935, 1.4927916483920929, 0.038483399927898176, -4.046991461184362, -1.7598094480142201, 20.926282098458348, -4.741002944581872, -10.32548173489308, 5.548104155947332, -0.4278881062959332, -11.381103847538835, 9.210563053491654, 8.626256981828206, -7.911499450055235, -8.64048192630617, -7.20246479109076, 2.830539868920929, -15.528344168279705, -11.570485314861793, -15.923381385919118, -6.533849442530144, -23.23819395684403, -12.785216086332461, 3.595242267367125, -26.055881285586334, 12.065217417642634, -12.693506163778551, -11.553614069540858, -17.971872779821386, -8.332754616552082, -6.688244356367408, -7.5078835503302095, -21.10577011467518, -9.211556532780605, -5.676365728627653, -13.528587912570801, -11.874656592288295, -17.286114596343577, 7.321267830501542, -3.6207079113349305, -5.061817906174658, -3.418241897020666, -9.241488489368136, -13.301848863200028, -0.7114838036837323, -23.20299402282425, -16.529138202092117, -25.31146383323106, 3.2234862537886126, -14.594503038634382, -20.934033213726206, -5.649305231346069, -13.07962518696211, 2.9885089471210193, -10.356853346569837, 0.8033948224702137, -24.39331411458406, -27.87786923882073, -8.075770437717898, -14.042589683731741, -14.095699895447765, -9.201857979739335, -25.557019584287737, -7.283417294376587, -8.554211713184875, -21.06652990850533, -31.476644151017755, -13.363056793657563, -27.35634595038793, -7.595092656195472, -15.858298475605732, -8.375771239456503, 11.391991865453221, 11.534383098053311, 5.6170745997117635, -26.365662477574745, -18.10858328507871, 6.508546184405045, -7.5140245010085, -7.7161188287749685, 6.41934599246682, 21.623629916595668, -10.786728267406259, -19.01224225587386, -22.069989351967077, -0.5955443822656417, -7.827076351185548, -12.463084590612524, -13.92975000920833, -15.63791628671105, -23.01472886719398, -5.890610331633916, -12.367818602174218, -15.373859760492707, -19.025329626704277, -7.9981623693261295, -17.297956487324804, -27.313024077925803, -10.396908678801474, -12.613014896056244], "episode_lengths": [400, 2, 400, 400, 400, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 5, 400, 400, 400, 400, 400, 400, 4, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-6.63033415896993, -1.4927916483920929, -0.038483399927898176, 4.04699146118436, 1.7598094480142201, -20.92628209845835, 4.741002944581872, 10.32548173489308, -5.548104155947332, 0.4278881062959332, 11.381103847538835, -9.210563053491658, -8.6262569818281, 7.911499450055235, 8.64048192630617, 7.20246479109076, -2.8305398689209285, 15.528344168279702, 11.570485314861793, 15.923381385919118, 6.533849442530144, 23.238193956844025, 12.785216086332461, -3.595242267367125, 26.055881285586338, -12.065217417642636, 12.693506163778553, 11.55361406954086, 17.971872779821386, 8.332754616552082, 6.688244356367408, 7.5078835503302095, 21.10577011467518, 9.211556532780605, 5.676365728627653, 13.528587912570798, 11.874656592288295, 17.28611459634357, -7.321267830501542, 3.6207079113349305, 5.061817906174658, 3.418241897020666, 9.241488489368136, 13.301848863200028, 0.7114838036837199, 23.202994022824253, 16.529138202092106, 25.311463833231056, -3.2234862537886126, 14.594503038634382, 20.93403321372621, 5.649305231346069, 13.07962518696211, -2.9885089471210193, 10.356853346569837, -0.8033948224702137, 24.393314114584058, 27.877869238820733, 8.075770437717898, 14.042589683731741, 14.095699895447765, 9.201857979739335, 25.557019584287733, 7.283417294376587, 8.554211713184875, 21.066529908505327, 31.47664415101776, 13.363056793657565, 27.356345950387926, 7.5950926561954635, 15.858298475605732, 8.375771239456503, -11.391991865453221, -11.534383098053311, -5.6170745997117635, 26.36566247757474, 18.108583285078705, -6.508546184405045, 7.5140245010085, 7.7161188287749685, -6.41934599246682, -21.623629916595664, 10.786728267406259, 19.01224225587386, 22.069989351967074, 0.5955443822656417, 7.827076351185548, 12.46308459061252, 13.92975000920833, 15.637916286711047, 23.01472886719398, 5.890610331633916, 12.367818602174218, 15.373859760492703, 19.025329626704274, 7.9981623693261295, 17.297956487324804, 27.313024077925807, 10.396908678801474, 12.613014896056244], "policy_adversary_policy_reward": [14.512553161509437, -1.2518848435695737, 2.801860679739989, 0.18372261704419657, -0.38260082591733635, 0.4595676257731327, -6.805709460371496, -1.288273461997214, 5.372407686841825, -8.892026582870265, 24.378997380146064, 17.473566816770667, 2.0452303078113943, -11.527236196975139, 5.903729855255186, -26.55469332504134, -1.8564476128166234, 12.952655924711287, 6.725682733778854, -7.58145894637072, -16.324046208984324, -6.438161486093346, 11.77717313441429, 6.643952972569011, 18.47435766025594, -1.2218436965996524, 1.8865023833941592, -17.709501283504633, 9.641931001442785, -26.922894854055127, -0.6933478350246602, -13.71158174715686, 0.0, 5.661079737841857, -26.40910125979707, -4.647587076762331, 7.269234393533239, -30.41020502325682, -8.185605710479877, -23.66115706135834, 11.318819263126542, -24.38651814818683, -23.65985441778712, -22.816533495900938, -11.24415852522074, -14.326273647444182, 3.4542536770420234, 3.7362308576922274, -22.405672296541216, -29.70609027463145, 15.313091205266995, 8.817343630018277, -6.020363694279633, -19.366648633277467, -9.90302865867641, -13.204199480405332, -25.166914052527016, -10.776831507115759, -8.313939748751771, -8.351569484352392, -2.150571246529381, -11.225917466205434, 11.621887138929175, -26.637654239589594, -17.48603936127312, -24.72550086807724, -26.157227497428327, 7.734114431867113, -6.4709453846896565, -4.8817860725656494, -14.173848668456163, -12.88332715668544, -2.1962937889784655, -21.553019395598124, -23.74986045244283, -10.822368740244315, -6.43701937676288, 21.079555037765964, -0.981939127329106, -6.259476695340755, -21.63062781853638, 11.506992006187062, -6.402726840066155, -0.4337569539751769, -17.87936601544116, -0.603610963295111, -16.34346379207388, -10.26023393432618, -3.2561294840294046, 1.8331618766619506, -22.364442847997687, -24.041545197650805, -13.014920746203455, -20.04335565798076, -29.911479357059918, -20.71144830940218, 16.776011444723686, -10.32903893714646, -32.8593033718809, 3.6702972946121335, -27.91667111972661, -13.951395307725807, 3.7113754624107287, -15.009985925102868, -21.09690662812247, -5.062343745801755, 4.581142733390635, 1.3958751608514035, 10.965683284267726, -31.679389977407396, 2.8187811136796554, -1.2119914687392281, -30.447896447969242, -18.338731781198916, -23.530710779919946, -32.225027697721515, 0.388227665929449, -16.539768541365245, -4.766025814223763, -23.319153553239722, -2.944529963434462, -25.246869827461072, -3.4478415863114087, -14.955874373167262, -19.72294915150913, -31.39109001706634, 6.405765543210819, -20.972600131963993, -5.940937297614422, -11.167486128755328, -19.072827317300543, -23.060232499710118, -34.71271762659551, -28.24057067544005, -7.524084635323323, -19.202028951991807, -25.08308814080562, -29.62960375997023, -9.621749688870523, -5.568435623520401, -24.010561156470047, -7.7060357947414175, 13.055507941908573, -29.807050420821575, 11.009287455016704, 11.774696275889738, 14.744054551793198, 8.324711644313425, 0.9842708419798569, 10.24987835744367, -22.861510824684963, -29.869814130464512, -28.31235442630881, -7.904812143848577, -0.7520474272202762, 13.769139796030366, -15.16118072613392, 0.13313172411692165, 3.030827886719095, -18.463065544269032, -3.1435382803271423, 15.982230265260782, 20.675710145804764, 22.57154968738657, -0.3548681995415741, -21.218588335270947, -22.529971038370924, -15.494513473376795, -16.87897179043474, -27.261006913499415, -11.662463722999224, 10.47137495846794, 3.6073640242562632, -19.26151672662736, -24.12795603443132, -0.7982131467937172, -7.558541909751469, -20.300958108665192, -18.346273445254667, -12.92955912816743, -19.4446800400585, -26.584777694329464, -14.952825931335589, 3.1716052680677578, -17.882233784551154, -6.8534034197972815, -0.19221522508031086, -30.555504295905095, -12.841124843247524, -25.209534410161044, -15.55355295941769, -0.4427717792345689, -18.391144157277278, -16.204768817372326, -35.38020076607657, -19.245847389775044, -8.048513122589682, -12.745304235013265, -12.383869571123174, -12.842160220989314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41909558165793825, "mean_inference_ms": 1.1022685790127935, "mean_action_processing_ms": 0.18014768200404663, "mean_env_wait_ms": 0.07316449696665511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004093527793884277, "StateBufferConnector_ms": 0.002949833869934082, "ViewRequirementAgentConnector_ms": 0.06898045539855957}, "num_episodes": 10, "episode_return_max": 21.623629916595668, "episode_return_min": -31.476644151017755, "episode_return_mean": -9.056126861506632}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.61375483358995, "num_env_steps_trained_throughput_per_sec": 486.61375483358995, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2088000, "timers": {"training_iteration_time_ms": 8039.047, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8039.011, "sample_time_ms": 780.002, "learn_time_ms": 7245.757, "learn_throughput": 552.047, "synch_weights_time_ms": 12.692}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "done": false, "training_iteration": 174, "trial_id": "83a5c_00000", "date": "2024-08-10_12-38-31", "timestamp": 1723307911, "time_this_iter_s": 8.26472783088684, "time_total_s": 1471.7784054279327, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd1d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1471.7784054279327, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 28.474999999999998, "ram_util_percent": 81.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.983499197449003, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0285833755182843, "policy_loss": -0.005822974958342485, "vf_loss": 2.03392594573359, "vf_explained_var": -0.03703443385936596, "kl": 0.005617042705465568, "entropy": 1.147260616948365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5889830003802974, "cur_kl_coeff": 2.4891385827507934e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5378970090920727, "policy_loss": -0.004792997658902702, "vf_loss": 1.5426900062089166, "vf_explained_var": 0.4706159275025129, "kl": 0.006028895519379311, "entropy": 0.1544482544219742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "env_runners": {"episode_reward_max": 21.623629916595668, "episode_reward_min": -31.476644151017755, "episode_reward_mean": -10.06024240982996, "episode_len_mean": 380.68, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38068, "policy_reward_min": {"agent_policy": -21.623629916595664, "adversary_policy": -35.38020076607657}, "policy_reward_max": {"agent_policy": 31.47664415101776, "adversary_policy": 22.57154968738657}, "policy_reward_mean": {"agent_policy": 10.06024240982996, "adversary_policy": -10.060242409829959}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.911499450055235, -8.64048192630617, -7.20246479109076, 2.830539868920929, -15.528344168279705, -11.570485314861793, -15.923381385919118, -6.533849442530144, -23.23819395684403, -12.785216086332461, 3.595242267367125, -26.055881285586334, 12.065217417642634, -12.693506163778551, -11.553614069540858, -17.971872779821386, -8.332754616552082, -6.688244356367408, -7.5078835503302095, -21.10577011467518, -9.211556532780605, -5.676365728627653, -13.528587912570801, -11.874656592288295, -17.286114596343577, 7.321267830501542, -3.6207079113349305, -5.061817906174658, -3.418241897020666, -9.241488489368136, -13.301848863200028, -0.7114838036837323, -23.20299402282425, -16.529138202092117, -25.31146383323106, 3.2234862537886126, -14.594503038634382, -20.934033213726206, -5.649305231346069, -13.07962518696211, 2.9885089471210193, -10.356853346569837, 0.8033948224702137, -24.39331411458406, -27.87786923882073, -8.075770437717898, -14.042589683731741, -14.095699895447765, -9.201857979739335, -25.557019584287737, -7.283417294376587, -8.554211713184875, -21.06652990850533, -31.476644151017755, -13.363056793657563, -27.35634595038793, -7.595092656195472, -15.858298475605732, -8.375771239456503, 11.391991865453221, 11.534383098053311, 5.6170745997117635, -26.365662477574745, -18.10858328507871, 6.508546184405045, -7.5140245010085, -7.7161188287749685, 6.41934599246682, 21.623629916595668, -10.786728267406259, -19.01224225587386, -22.069989351967077, -0.5955443822656417, -7.827076351185548, -12.463084590612524, -13.92975000920833, -15.63791628671105, -23.01472886719398, -5.890610331633916, -12.367818602174218, -15.373859760492707, -19.025329626704277, -7.9981623693261295, -17.297956487324804, -27.313024077925803, -10.396908678801474, -12.613014896056244, -16.488546287849374, -8.908148196918473, -25.63971344879051, -7.546503050633712, -1.3843996872178685, 3.978098221379822, -16.16427991125991, 11.822390658902485, -16.814816371186822, 14.689379981734001, -2.0627929827011204, -21.432792109301094, 5.331106306016924], "episode_lengths": [400, 400, 400, 5, 400, 400, 400, 400, 400, 400, 4, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 24, 400, 400, 400], "policy_agent_policy_reward": [7.911499450055235, 8.64048192630617, 7.20246479109076, -2.8305398689209285, 15.528344168279702, 11.570485314861793, 15.923381385919118, 6.533849442530144, 23.238193956844025, 12.785216086332461, -3.595242267367125, 26.055881285586338, -12.065217417642636, 12.693506163778553, 11.55361406954086, 17.971872779821386, 8.332754616552082, 6.688244356367408, 7.5078835503302095, 21.10577011467518, 9.211556532780605, 5.676365728627653, 13.528587912570798, 11.874656592288295, 17.28611459634357, -7.321267830501542, 3.6207079113349305, 5.061817906174658, 3.418241897020666, 9.241488489368136, 13.301848863200028, 0.7114838036837199, 23.202994022824253, 16.529138202092106, 25.311463833231056, -3.2234862537886126, 14.594503038634382, 20.93403321372621, 5.649305231346069, 13.07962518696211, -2.9885089471210193, 10.356853346569837, -0.8033948224702137, 24.393314114584058, 27.877869238820733, 8.075770437717898, 14.042589683731741, 14.095699895447765, 9.201857979739335, 25.557019584287733, 7.283417294376587, 8.554211713184875, 21.066529908505327, 31.47664415101776, 13.363056793657565, 27.356345950387926, 7.5950926561954635, 15.858298475605732, 8.375771239456503, -11.391991865453221, -11.534383098053311, -5.6170745997117635, 26.36566247757474, 18.108583285078705, -6.508546184405045, 7.5140245010085, 7.7161188287749685, -6.41934599246682, -21.623629916595664, 10.786728267406259, 19.01224225587386, 22.069989351967074, 0.5955443822656417, 7.827076351185548, 12.46308459061252, 13.92975000920833, 15.637916286711047, 23.01472886719398, 5.890610331633916, 12.367818602174218, 15.373859760492703, 19.025329626704274, 7.9981623693261295, 17.297956487324804, 27.313024077925807, 10.396908678801474, 12.613014896056244, 16.488546287849374, 8.908148196918473, 25.639713448790506, 7.546503050633712, 1.3843996872178685, -3.978098221379823, 16.164279911259904, -11.822390658902485, 16.814816371186833, -14.689379981734003, 2.0627929827011204, 21.432792109301097, -5.331106306016924], "policy_adversary_policy_reward": [1.8865023833941592, -17.709501283504633, 9.641931001442785, -26.922894854055127, -0.6933478350246602, -13.71158174715686, 0.0, 5.661079737841857, -26.40910125979707, -4.647587076762331, 7.269234393533239, -30.41020502325682, -8.185605710479877, -23.66115706135834, 11.318819263126542, -24.38651814818683, -23.65985441778712, -22.816533495900938, -11.24415852522074, -14.326273647444182, 3.4542536770420234, 3.7362308576922274, -22.405672296541216, -29.70609027463145, 15.313091205266995, 8.817343630018277, -6.020363694279633, -19.366648633277467, -9.90302865867641, -13.204199480405332, -25.166914052527016, -10.776831507115759, -8.313939748751771, -8.351569484352392, -2.150571246529381, -11.225917466205434, 11.621887138929175, -26.637654239589594, -17.48603936127312, -24.72550086807724, -26.157227497428327, 7.734114431867113, -6.4709453846896565, -4.8817860725656494, -14.173848668456163, -12.88332715668544, -2.1962937889784655, -21.553019395598124, -23.74986045244283, -10.822368740244315, -6.43701937676288, 21.079555037765964, -0.981939127329106, -6.259476695340755, -21.63062781853638, 11.506992006187062, -6.402726840066155, -0.4337569539751769, -17.87936601544116, -0.603610963295111, -16.34346379207388, -10.26023393432618, -3.2561294840294046, 1.8331618766619506, -22.364442847997687, -24.041545197650805, -13.014920746203455, -20.04335565798076, -29.911479357059918, -20.71144830940218, 16.776011444723686, -10.32903893714646, -32.8593033718809, 3.6702972946121335, -27.91667111972661, -13.951395307725807, 3.7113754624107287, -15.009985925102868, -21.09690662812247, -5.062343745801755, 4.581142733390635, 1.3958751608514035, 10.965683284267726, -31.679389977407396, 2.8187811136796554, -1.2119914687392281, -30.447896447969242, -18.338731781198916, -23.530710779919946, -32.225027697721515, 0.388227665929449, -16.539768541365245, -4.766025814223763, -23.319153553239722, -2.944529963434462, -25.246869827461072, -3.4478415863114087, -14.955874373167262, -19.72294915150913, -31.39109001706634, 6.405765543210819, -20.972600131963993, -5.940937297614422, -11.167486128755328, -19.072827317300543, -23.060232499710118, -34.71271762659551, -28.24057067544005, -7.524084635323323, -19.202028951991807, -25.08308814080562, -29.62960375997023, -9.621749688870523, -5.568435623520401, -24.010561156470047, -7.7060357947414175, 13.055507941908573, -29.807050420821575, 11.009287455016704, 11.774696275889738, 14.744054551793198, 8.324711644313425, 0.9842708419798569, 10.24987835744367, -22.861510824684963, -29.869814130464512, -28.31235442630881, -7.904812143848577, -0.7520474272202762, 13.769139796030366, -15.16118072613392, 0.13313172411692165, 3.030827886719095, -18.463065544269032, -3.1435382803271423, 15.982230265260782, 20.675710145804764, 22.57154968738657, -0.3548681995415741, -21.218588335270947, -22.529971038370924, -15.494513473376795, -16.87897179043474, -27.261006913499415, -11.662463722999224, 10.47137495846794, 3.6073640242562632, -19.26151672662736, -24.12795603443132, -0.7982131467937172, -7.558541909751469, -20.300958108665192, -18.346273445254667, -12.92955912816743, -19.4446800400585, -26.584777694329464, -14.952825931335589, 3.1716052680677578, -17.882233784551154, -6.8534034197972815, -0.19221522508031086, -30.555504295905095, -12.841124843247524, -25.209534410161044, -15.55355295941769, -0.4427717792345689, -18.391144157277278, -16.204768817372326, -35.38020076607657, -19.245847389775044, -8.048513122589682, -12.745304235013265, -12.383869571123174, -12.842160220989314, -3.1416054690088586, -29.835487106689886, -1.849336757656296, -15.96695963618065, -19.681472607906535, -31.597954289674476, -14.53409749288107, -0.5589086083863535, 8.02244368317232, -10.791243057608057, -4.451361426139243, 12.40755786889889, -9.544101458231115, -22.78445836428869, 7.328178461781896, 16.316602856023074, -21.776008666081427, -11.85362407629222, 10.562092612814283, 18.816667350653727, -8.18265949510712, 4.05707352970488, -21.341295887331675, -21.52428833127051, -0.44586413974156613, 11.108076751775414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4188512012045193, "mean_inference_ms": 1.1015221442922019, "mean_action_processing_ms": 0.18004580209761425, "mean_env_wait_ms": 0.07307334589406939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004076361656188965, "StateBufferConnector_ms": 0.002957463264465332, "ViewRequirementAgentConnector_ms": 0.07035529613494873}, "num_episodes": 13, "episode_return_max": 21.623629916595668, "episode_return_min": -31.476644151017755, "episode_return_mean": -10.06024240982996}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 502.1507621132921, "num_env_steps_trained_throughput_per_sec": 502.1507621132921, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2100000, "timers": {"training_iteration_time_ms": 8037.999, "restore_workers_time_ms": 0.013, "training_step_time_ms": 8037.963, "sample_time_ms": 780.202, "learn_time_ms": 7244.655, "learn_throughput": 552.131, "synch_weights_time_ms": 12.542}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2100000, "num_agent_steps_trained": 2100000}, "done": false, "training_iteration": 175, "trial_id": "83a5c_00000", "date": "2024-08-10_12-38-39", "timestamp": 1723307919, "time_this_iter_s": 7.971124887466431, "time_total_s": 1479.7495303153992, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1479.7495303153992, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 26.96666666666667, "ram_util_percent": 81.55833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.750847298411465, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.897344187043962, "policy_loss": -0.005564447421279968, "vf_loss": 1.9018098845683709, "vf_explained_var": 0.19121749211871436, "kl": 0.012846915345268935, "entropy": 1.1427953251455196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.311746247050663, "cur_kl_coeff": 2.4891385827507934e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.821300812313954, "policy_loss": -0.002238123615340252, "vf_loss": 1.8235389324525992, "vf_explained_var": 0.572345220297575, "kl": 0.0012994830763047084, "entropy": 0.2187822587477664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 21.623629916595668, "episode_reward_min": -31.476644151017755, "episode_reward_mean": -10.109823767531571, "episode_len_mean": 384.63, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38463, "policy_reward_min": {"agent_policy": -21.623629916595664, "adversary_policy": -35.38020076607657}, "policy_reward_max": {"agent_policy": 31.47664415101776, "adversary_policy": 22.57154968738657}, "policy_reward_mean": {"agent_policy": 10.109823767531571, "adversary_policy": -10.109823767531568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.785216086332461, 3.595242267367125, -26.055881285586334, 12.065217417642634, -12.693506163778551, -11.553614069540858, -17.971872779821386, -8.332754616552082, -6.688244356367408, -7.5078835503302095, -21.10577011467518, -9.211556532780605, -5.676365728627653, -13.528587912570801, -11.874656592288295, -17.286114596343577, 7.321267830501542, -3.6207079113349305, -5.061817906174658, -3.418241897020666, -9.241488489368136, -13.301848863200028, -0.7114838036837323, -23.20299402282425, -16.529138202092117, -25.31146383323106, 3.2234862537886126, -14.594503038634382, -20.934033213726206, -5.649305231346069, -13.07962518696211, 2.9885089471210193, -10.356853346569837, 0.8033948224702137, -24.39331411458406, -27.87786923882073, -8.075770437717898, -14.042589683731741, -14.095699895447765, -9.201857979739335, -25.557019584287737, -7.283417294376587, -8.554211713184875, -21.06652990850533, -31.476644151017755, -13.363056793657563, -27.35634595038793, -7.595092656195472, -15.858298475605732, -8.375771239456503, 11.391991865453221, 11.534383098053311, 5.6170745997117635, -26.365662477574745, -18.10858328507871, 6.508546184405045, -7.5140245010085, -7.7161188287749685, 6.41934599246682, 21.623629916595668, -10.786728267406259, -19.01224225587386, -22.069989351967077, -0.5955443822656417, -7.827076351185548, -12.463084590612524, -13.92975000920833, -15.63791628671105, -23.01472886719398, -5.890610331633916, -12.367818602174218, -15.373859760492707, -19.025329626704277, -7.9981623693261295, -17.297956487324804, -27.313024077925803, -10.396908678801474, -12.613014896056244, -16.488546287849374, -8.908148196918473, -25.63971344879051, -7.546503050633712, -1.3843996872178685, 3.978098221379822, -16.16427991125991, 11.822390658902485, -16.814816371186822, 14.689379981734001, -2.0627929827011204, -21.432792109301094, 5.331106306016924, -2.7434776029144565, -5.6710154649097255, -7.163682461033277, -1.542718779050853, -16.67222013308306, -16.967636335009256, -17.31519210116576, -25.028523485651895, -5.5718299743085336], "episode_lengths": [400, 4, 400, 26, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [12.785216086332461, -3.595242267367125, 26.055881285586338, -12.065217417642636, 12.693506163778553, 11.55361406954086, 17.971872779821386, 8.332754616552082, 6.688244356367408, 7.5078835503302095, 21.10577011467518, 9.211556532780605, 5.676365728627653, 13.528587912570798, 11.874656592288295, 17.28611459634357, -7.321267830501542, 3.6207079113349305, 5.061817906174658, 3.418241897020666, 9.241488489368136, 13.301848863200028, 0.7114838036837199, 23.202994022824253, 16.529138202092106, 25.311463833231056, -3.2234862537886126, 14.594503038634382, 20.93403321372621, 5.649305231346069, 13.07962518696211, -2.9885089471210193, 10.356853346569837, -0.8033948224702137, 24.393314114584058, 27.877869238820733, 8.075770437717898, 14.042589683731741, 14.095699895447765, 9.201857979739335, 25.557019584287733, 7.283417294376587, 8.554211713184875, 21.066529908505327, 31.47664415101776, 13.363056793657565, 27.356345950387926, 7.5950926561954635, 15.858298475605732, 8.375771239456503, -11.391991865453221, -11.534383098053311, -5.6170745997117635, 26.36566247757474, 18.108583285078705, -6.508546184405045, 7.5140245010085, 7.7161188287749685, -6.41934599246682, -21.623629916595664, 10.786728267406259, 19.01224225587386, 22.069989351967074, 0.5955443822656417, 7.827076351185548, 12.46308459061252, 13.92975000920833, 15.637916286711047, 23.01472886719398, 5.890610331633916, 12.367818602174218, 15.373859760492703, 19.025329626704274, 7.9981623693261295, 17.297956487324804, 27.313024077925807, 10.396908678801474, 12.613014896056244, 16.488546287849374, 8.908148196918473, 25.639713448790506, 7.546503050633712, 1.3843996872178685, -3.978098221379823, 16.164279911259904, -11.822390658902485, 16.814816371186833, -14.689379981734003, 2.0627929827011204, 21.432792109301097, -5.331106306016924, 2.7434776029144565, 5.6710154649097255, 7.163682461033277, 1.542718779050853, 16.672220133083062, 16.967636335009256, 17.315192101165756, 25.028523485651906, 5.5718299743085336], "policy_adversary_policy_reward": [-11.24415852522074, -14.326273647444182, 3.4542536770420234, 3.7362308576922274, -22.405672296541216, -29.70609027463145, 15.313091205266995, 8.817343630018277, -6.020363694279633, -19.366648633277467, -9.90302865867641, -13.204199480405332, -25.166914052527016, -10.776831507115759, -8.313939748751771, -8.351569484352392, -2.150571246529381, -11.225917466205434, 11.621887138929175, -26.637654239589594, -17.48603936127312, -24.72550086807724, -26.157227497428327, 7.734114431867113, -6.4709453846896565, -4.8817860725656494, -14.173848668456163, -12.88332715668544, -2.1962937889784655, -21.553019395598124, -23.74986045244283, -10.822368740244315, -6.43701937676288, 21.079555037765964, -0.981939127329106, -6.259476695340755, -21.63062781853638, 11.506992006187062, -6.402726840066155, -0.4337569539751769, -17.87936601544116, -0.603610963295111, -16.34346379207388, -10.26023393432618, -3.2561294840294046, 1.8331618766619506, -22.364442847997687, -24.041545197650805, -13.014920746203455, -20.04335565798076, -29.911479357059918, -20.71144830940218, 16.776011444723686, -10.32903893714646, -32.8593033718809, 3.6702972946121335, -27.91667111972661, -13.951395307725807, 3.7113754624107287, -15.009985925102868, -21.09690662812247, -5.062343745801755, 4.581142733390635, 1.3958751608514035, 10.965683284267726, -31.679389977407396, 2.8187811136796554, -1.2119914687392281, -30.447896447969242, -18.338731781198916, -23.530710779919946, -32.225027697721515, 0.388227665929449, -16.539768541365245, -4.766025814223763, -23.319153553239722, -2.944529963434462, -25.246869827461072, -3.4478415863114087, -14.955874373167262, -19.72294915150913, -31.39109001706634, 6.405765543210819, -20.972600131963993, -5.940937297614422, -11.167486128755328, -19.072827317300543, -23.060232499710118, -34.71271762659551, -28.24057067544005, -7.524084635323323, -19.202028951991807, -25.08308814080562, -29.62960375997023, -9.621749688870523, -5.568435623520401, -24.010561156470047, -7.7060357947414175, 13.055507941908573, -29.807050420821575, 11.009287455016704, 11.774696275889738, 14.744054551793198, 8.324711644313425, 0.9842708419798569, 10.24987835744367, -22.861510824684963, -29.869814130464512, -28.31235442630881, -7.904812143848577, -0.7520474272202762, 13.769139796030366, -15.16118072613392, 0.13313172411692165, 3.030827886719095, -18.463065544269032, -3.1435382803271423, 15.982230265260782, 20.675710145804764, 22.57154968738657, -0.3548681995415741, -21.218588335270947, -22.529971038370924, -15.494513473376795, -16.87897179043474, -27.261006913499415, -11.662463722999224, 10.47137495846794, 3.6073640242562632, -19.26151672662736, -24.12795603443132, -0.7982131467937172, -7.558541909751469, -20.300958108665192, -18.346273445254667, -12.92955912816743, -19.4446800400585, -26.584777694329464, -14.952825931335589, 3.1716052680677578, -17.882233784551154, -6.8534034197972815, -0.19221522508031086, -30.555504295905095, -12.841124843247524, -25.209534410161044, -15.55355295941769, -0.4427717792345689, -18.391144157277278, -16.204768817372326, -35.38020076607657, -19.245847389775044, -8.048513122589682, -12.745304235013265, -12.383869571123174, -12.842160220989314, -3.1416054690088586, -29.835487106689886, -1.849336757656296, -15.96695963618065, -19.681472607906535, -31.597954289674476, -14.53409749288107, -0.5589086083863535, 8.02244368317232, -10.791243057608057, -4.451361426139243, 12.40755786889889, -9.544101458231115, -22.78445836428869, 7.328178461781896, 16.316602856023074, -21.776008666081427, -11.85362407629222, 10.562092612814283, 18.816667350653727, -8.18265949510712, 4.05707352970488, -21.341295887331675, -21.52428833127051, -0.44586413974156613, 11.108076751775414, -2.20605668754855, -3.2808985182803596, -7.759753665719753, -3.582277264099698, 7.422180217674303, -21.749545139740857, -4.332045554130982, 1.246607996029276, -23.960462131114415, -9.38397813505171, -13.132053873680793, -20.80321879633772, -8.956488371455977, -25.67389583087555, -27.44462889783878, -22.612418073465008, 3.022063573138496, -14.165723521755563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4186554960108321, "mean_inference_ms": 1.1009186732184795, "mean_action_processing_ms": 0.17989347389752136, "mean_env_wait_ms": 0.07302518066789784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039501190185546875, "StateBufferConnector_ms": 0.0027207136154174805, "ViewRequirementAgentConnector_ms": 0.07084095478057861}, "num_episodes": 9, "episode_return_max": 21.623629916595668, "episode_return_min": -31.476644151017755, "episode_return_mean": -10.109823767531571}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 512.0254231373121, "num_env_steps_trained_throughput_per_sec": 512.0254231373121, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 7963.35, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7963.315, "sample_time_ms": 777.602, "learn_time_ms": 7172.608, "learn_throughput": 557.677, "synch_weights_time_ms": 12.546}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 176, "trial_id": "83a5c_00000", "date": "2024-08-10_12-38-47", "timestamp": 1723307927, "time_this_iter_s": 7.817456245422363, "time_total_s": 1487.5669865608215, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd52430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1487.5669865608215, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 25.790909090909096, "ram_util_percent": 81.68181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6423012043117846, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8217613374745405, "policy_loss": -0.006461442125808428, "vf_loss": 1.827496052671362, "vf_explained_var": 0.047088166046394875, "kl": 0.008497182660160496, "entropy": 1.1540645486463315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.659183720002572, "cur_kl_coeff": 1.2445692913753967e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.719763220163683, "policy_loss": -0.002789687371599333, "vf_loss": 1.7225529028723636, "vf_explained_var": 0.5097833787401517, "kl": 0.0024015612298345554, "entropy": 0.18531674219605823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "env_runners": {"episode_reward_max": 21.623629916595668, "episode_reward_min": -31.476644151017755, "episode_reward_mean": -9.525609207963466, "episode_len_mean": 388.34, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38834, "policy_reward_min": {"agent_policy": -21.623629916595664, "adversary_policy": -35.38020076607657}, "policy_reward_max": {"agent_policy": 31.47664415101776, "adversary_policy": 22.57154968738657}, "policy_reward_mean": {"agent_policy": 9.525609207963466, "adversary_policy": -9.525609207963466}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.211556532780605, -5.676365728627653, -13.528587912570801, -11.874656592288295, -17.286114596343577, 7.321267830501542, -3.6207079113349305, -5.061817906174658, -3.418241897020666, -9.241488489368136, -13.301848863200028, -0.7114838036837323, -23.20299402282425, -16.529138202092117, -25.31146383323106, 3.2234862537886126, -14.594503038634382, -20.934033213726206, -5.649305231346069, -13.07962518696211, 2.9885089471210193, -10.356853346569837, 0.8033948224702137, -24.39331411458406, -27.87786923882073, -8.075770437717898, -14.042589683731741, -14.095699895447765, -9.201857979739335, -25.557019584287737, -7.283417294376587, -8.554211713184875, -21.06652990850533, -31.476644151017755, -13.363056793657563, -27.35634595038793, -7.595092656195472, -15.858298475605732, -8.375771239456503, 11.391991865453221, 11.534383098053311, 5.6170745997117635, -26.365662477574745, -18.10858328507871, 6.508546184405045, -7.5140245010085, -7.7161188287749685, 6.41934599246682, 21.623629916595668, -10.786728267406259, -19.01224225587386, -22.069989351967077, -0.5955443822656417, -7.827076351185548, -12.463084590612524, -13.92975000920833, -15.63791628671105, -23.01472886719398, -5.890610331633916, -12.367818602174218, -15.373859760492707, -19.025329626704277, -7.9981623693261295, -17.297956487324804, -27.313024077925803, -10.396908678801474, -12.613014896056244, -16.488546287849374, -8.908148196918473, -25.63971344879051, -7.546503050633712, -1.3843996872178685, 3.978098221379822, -16.16427991125991, 11.822390658902485, -16.814816371186822, 14.689379981734001, -2.0627929827011204, -21.432792109301094, 5.331106306016924, -2.7434776029144565, -5.6710154649097255, -7.163682461033277, -1.542718779050853, -16.67222013308306, -16.967636335009256, -17.31519210116576, -25.028523485651895, -5.5718299743085336, -11.419539405998627, 0.527880211078702, -8.939924805241548, -9.664851692903019, -8.003456265897476, -0.19474994697356252, 3.6059803453407184, -21.408404632702148, -0.8493135077359444, 13.817747593804988, -8.084195273936581], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [9.211556532780605, 5.676365728627653, 13.528587912570798, 11.874656592288295, 17.28611459634357, -7.321267830501542, 3.6207079113349305, 5.061817906174658, 3.418241897020666, 9.241488489368136, 13.301848863200028, 0.7114838036837199, 23.202994022824253, 16.529138202092106, 25.311463833231056, -3.2234862537886126, 14.594503038634382, 20.93403321372621, 5.649305231346069, 13.07962518696211, -2.9885089471210193, 10.356853346569837, -0.8033948224702137, 24.393314114584058, 27.877869238820733, 8.075770437717898, 14.042589683731741, 14.095699895447765, 9.201857979739335, 25.557019584287733, 7.283417294376587, 8.554211713184875, 21.066529908505327, 31.47664415101776, 13.363056793657565, 27.356345950387926, 7.5950926561954635, 15.858298475605732, 8.375771239456503, -11.391991865453221, -11.534383098053311, -5.6170745997117635, 26.36566247757474, 18.108583285078705, -6.508546184405045, 7.5140245010085, 7.7161188287749685, -6.41934599246682, -21.623629916595664, 10.786728267406259, 19.01224225587386, 22.069989351967074, 0.5955443822656417, 7.827076351185548, 12.46308459061252, 13.92975000920833, 15.637916286711047, 23.01472886719398, 5.890610331633916, 12.367818602174218, 15.373859760492703, 19.025329626704274, 7.9981623693261295, 17.297956487324804, 27.313024077925807, 10.396908678801474, 12.613014896056244, 16.488546287849374, 8.908148196918473, 25.639713448790506, 7.546503050633712, 1.3843996872178685, -3.978098221379823, 16.164279911259904, -11.822390658902485, 16.814816371186833, -14.689379981734003, 2.0627929827011204, 21.432792109301097, -5.331106306016924, 2.7434776029144565, 5.6710154649097255, 7.163682461033277, 1.542718779050853, 16.672220133083062, 16.967636335009256, 17.315192101165756, 25.028523485651906, 5.5718299743085336, 11.419539405998625, -0.527880211078702, 8.939924805241548, 9.664851692903019, 8.003456265897476, 0.19474994697356252, -3.6059803453407184, 21.40840463270215, 0.8493135077359444, -13.817747593804977, 8.084195273936581], "policy_adversary_policy_reward": [-26.157227497428327, 7.734114431867113, -6.4709453846896565, -4.8817860725656494, -14.173848668456163, -12.88332715668544, -2.1962937889784655, -21.553019395598124, -23.74986045244283, -10.822368740244315, -6.43701937676288, 21.079555037765964, -0.981939127329106, -6.259476695340755, -21.63062781853638, 11.506992006187062, -6.402726840066155, -0.4337569539751769, -17.87936601544116, -0.603610963295111, -16.34346379207388, -10.26023393432618, -3.2561294840294046, 1.8331618766619506, -22.364442847997687, -24.041545197650805, -13.014920746203455, -20.04335565798076, -29.911479357059918, -20.71144830940218, 16.776011444723686, -10.32903893714646, -32.8593033718809, 3.6702972946121335, -27.91667111972661, -13.951395307725807, 3.7113754624107287, -15.009985925102868, -21.09690662812247, -5.062343745801755, 4.581142733390635, 1.3958751608514035, 10.965683284267726, -31.679389977407396, 2.8187811136796554, -1.2119914687392281, -30.447896447969242, -18.338731781198916, -23.530710779919946, -32.225027697721515, 0.388227665929449, -16.539768541365245, -4.766025814223763, -23.319153553239722, -2.944529963434462, -25.246869827461072, -3.4478415863114087, -14.955874373167262, -19.72294915150913, -31.39109001706634, 6.405765543210819, -20.972600131963993, -5.940937297614422, -11.167486128755328, -19.072827317300543, -23.060232499710118, -34.71271762659551, -28.24057067544005, -7.524084635323323, -19.202028951991807, -25.08308814080562, -29.62960375997023, -9.621749688870523, -5.568435623520401, -24.010561156470047, -7.7060357947414175, 13.055507941908573, -29.807050420821575, 11.009287455016704, 11.774696275889738, 14.744054551793198, 8.324711644313425, 0.9842708419798569, 10.24987835744367, -22.861510824684963, -29.869814130464512, -28.31235442630881, -7.904812143848577, -0.7520474272202762, 13.769139796030366, -15.16118072613392, 0.13313172411692165, 3.030827886719095, -18.463065544269032, -3.1435382803271423, 15.982230265260782, 20.675710145804764, 22.57154968738657, -0.3548681995415741, -21.218588335270947, -22.529971038370924, -15.494513473376795, -16.87897179043474, -27.261006913499415, -11.662463722999224, 10.47137495846794, 3.6073640242562632, -19.26151672662736, -24.12795603443132, -0.7982131467937172, -7.558541909751469, -20.300958108665192, -18.346273445254667, -12.92955912816743, -19.4446800400585, -26.584777694329464, -14.952825931335589, 3.1716052680677578, -17.882233784551154, -6.8534034197972815, -0.19221522508031086, -30.555504295905095, -12.841124843247524, -25.209534410161044, -15.55355295941769, -0.4427717792345689, -18.391144157277278, -16.204768817372326, -35.38020076607657, -19.245847389775044, -8.048513122589682, -12.745304235013265, -12.383869571123174, -12.842160220989314, -3.1416054690088586, -29.835487106689886, -1.849336757656296, -15.96695963618065, -19.681472607906535, -31.597954289674476, -14.53409749288107, -0.5589086083863535, 8.02244368317232, -10.791243057608057, -4.451361426139243, 12.40755786889889, -9.544101458231115, -22.78445836428869, 7.328178461781896, 16.316602856023074, -21.776008666081427, -11.85362407629222, 10.562092612814283, 18.816667350653727, -8.18265949510712, 4.05707352970488, -21.341295887331675, -21.52428833127051, -0.44586413974156613, 11.108076751775414, -2.20605668754855, -3.2808985182803596, -7.759753665719753, -3.582277264099698, 7.422180217674303, -21.749545139740857, -4.332045554130982, 1.246607996029276, -23.960462131114415, -9.38397813505171, -13.132053873680793, -20.80321879633772, -8.956488371455977, -25.67389583087555, -27.44462889783878, -22.612418073465008, 3.022063573138496, -14.165723521755563, -8.438349259582012, -14.400729552415239, 0.9279724651516816, 0.12778795700572232, -13.534787634909481, -4.345061975573614, -10.340268509309745, -8.989434876496293, 3.688621310932895, -19.695533842727848, 6.679563714844157, -7.069063608791282, 3.8505883280042497, 3.361372362677187, -22.461788805372763, -20.355020460031533, -8.441733291956862, 6.743106276484973, 13.54871301939626, 14.086782168213695, 6.308573725552691, -22.476964273425857]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4184056461031184, "mean_inference_ms": 1.1002229978492322, "mean_action_processing_ms": 0.17984364267697628, "mean_env_wait_ms": 0.0729710244998098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003548860549926758, "StateBufferConnector_ms": 0.0026950836181640625, "ViewRequirementAgentConnector_ms": 0.0698021650314331}, "num_episodes": 11, "episode_return_max": 21.623629916595668, "episode_return_min": -31.476644151017755, "episode_return_mean": -9.525609207963466}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 490.84367589404036, "num_env_steps_trained_throughput_per_sec": 490.84367589404036, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2124000, "timers": {"training_iteration_time_ms": 7985.911, "restore_workers_time_ms": 0.013, "training_step_time_ms": 7985.876, "sample_time_ms": 771.793, "learn_time_ms": 7200.571, "learn_throughput": 555.511, "synch_weights_time_ms": 12.967}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2124000, "num_agent_steps_trained": 2124000}, "done": false, "training_iteration": 177, "trial_id": "83a5c_00000", "date": "2024-08-10_12-38-55", "timestamp": 1723307935, "time_this_iter_s": 8.154324054718018, "time_total_s": 1495.7213106155396, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fbc8820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1495.7213106155396, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 27.299999999999997, "ram_util_percent": 81.77272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8448780473262545, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.823674806968245, "policy_loss": -0.003156013631079563, "vf_loss": 1.8261301717114826, "vf_explained_var": -0.012666154160070671, "kl": 0.008192149301421037, "entropy": 1.1122320575688882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4925552550082406, "cur_kl_coeff": 6.222846456876984e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4688793864722054, "policy_loss": -0.006741620904237303, "vf_loss": 1.475621006079018, "vf_explained_var": 0.4825232902541757, "kl": 0.004026669131625963, "entropy": 0.1809596387979885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "env_runners": {"episode_reward_max": 21.623629916595668, "episode_reward_min": -31.476644151017755, "episode_reward_mean": -9.624348702280866, "episode_len_mean": 388.34, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 38834, "policy_reward_min": {"agent_policy": -21.623629916595664, "adversary_policy": -35.38020076607657}, "policy_reward_max": {"agent_policy": 31.47664415101776, "adversary_policy": 22.949184320785058}, "policy_reward_mean": {"agent_policy": 9.624348702280866, "adversary_policy": -9.624348702280868}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.241488489368136, -13.301848863200028, -0.7114838036837323, -23.20299402282425, -16.529138202092117, -25.31146383323106, 3.2234862537886126, -14.594503038634382, -20.934033213726206, -5.649305231346069, -13.07962518696211, 2.9885089471210193, -10.356853346569837, 0.8033948224702137, -24.39331411458406, -27.87786923882073, -8.075770437717898, -14.042589683731741, -14.095699895447765, -9.201857979739335, -25.557019584287737, -7.283417294376587, -8.554211713184875, -21.06652990850533, -31.476644151017755, -13.363056793657563, -27.35634595038793, -7.595092656195472, -15.858298475605732, -8.375771239456503, 11.391991865453221, 11.534383098053311, 5.6170745997117635, -26.365662477574745, -18.10858328507871, 6.508546184405045, -7.5140245010085, -7.7161188287749685, 6.41934599246682, 21.623629916595668, -10.786728267406259, -19.01224225587386, -22.069989351967077, -0.5955443822656417, -7.827076351185548, -12.463084590612524, -13.92975000920833, -15.63791628671105, -23.01472886719398, -5.890610331633916, -12.367818602174218, -15.373859760492707, -19.025329626704277, -7.9981623693261295, -17.297956487324804, -27.313024077925803, -10.396908678801474, -12.613014896056244, -16.488546287849374, -8.908148196918473, -25.63971344879051, -7.546503050633712, -1.3843996872178685, 3.978098221379822, -16.16427991125991, 11.822390658902485, -16.814816371186822, 14.689379981734001, -2.0627929827011204, -21.432792109301094, 5.331106306016924, -2.7434776029144565, -5.6710154649097255, -7.163682461033277, -1.542718779050853, -16.67222013308306, -16.967636335009256, -17.31519210116576, -25.028523485651895, -5.5718299743085336, -11.419539405998627, 0.527880211078702, -8.939924805241548, -9.664851692903019, -8.003456265897476, -0.19474994697356252, 3.6059803453407184, -21.408404632702148, -0.8493135077359444, 13.817747593804988, -8.084195273936581, -7.617248147131054, -9.420648432673811, 6.328875193443896, -0.624391869597785, -12.554155875397974, -12.59713115999731, -7.9330020091698294, -17.016768445708408, -10.796259932147453], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [9.241488489368136, 13.301848863200028, 0.7114838036837199, 23.202994022824253, 16.529138202092106, 25.311463833231056, -3.2234862537886126, 14.594503038634382, 20.93403321372621, 5.649305231346069, 13.07962518696211, -2.9885089471210193, 10.356853346569837, -0.8033948224702137, 24.393314114584058, 27.877869238820733, 8.075770437717898, 14.042589683731741, 14.095699895447765, 9.201857979739335, 25.557019584287733, 7.283417294376587, 8.554211713184875, 21.066529908505327, 31.47664415101776, 13.363056793657565, 27.356345950387926, 7.5950926561954635, 15.858298475605732, 8.375771239456503, -11.391991865453221, -11.534383098053311, -5.6170745997117635, 26.36566247757474, 18.108583285078705, -6.508546184405045, 7.5140245010085, 7.7161188287749685, -6.41934599246682, -21.623629916595664, 10.786728267406259, 19.01224225587386, 22.069989351967074, 0.5955443822656417, 7.827076351185548, 12.46308459061252, 13.92975000920833, 15.637916286711047, 23.01472886719398, 5.890610331633916, 12.367818602174218, 15.373859760492703, 19.025329626704274, 7.9981623693261295, 17.297956487324804, 27.313024077925807, 10.396908678801474, 12.613014896056244, 16.488546287849374, 8.908148196918473, 25.639713448790506, 7.546503050633712, 1.3843996872178685, -3.978098221379823, 16.164279911259904, -11.822390658902485, 16.814816371186833, -14.689379981734003, 2.0627929827011204, 21.432792109301097, -5.331106306016924, 2.7434776029144565, 5.6710154649097255, 7.163682461033277, 1.542718779050853, 16.672220133083062, 16.967636335009256, 17.315192101165756, 25.028523485651906, 5.5718299743085336, 11.419539405998625, -0.527880211078702, 8.939924805241548, 9.664851692903019, 8.003456265897476, 0.19474994697356252, -3.6059803453407184, 21.40840463270215, 0.8493135077359444, -13.817747593804977, 8.084195273936581, 7.617248147131054, 9.420648432673811, -6.328875193443896, 0.6243918695977833, 12.554155875397974, 12.597131159997312, 7.9330020091698294, 17.01676844570841, 10.796259932147453], "policy_adversary_policy_reward": [-17.87936601544116, -0.603610963295111, -16.34346379207388, -10.26023393432618, -3.2561294840294046, 1.8331618766619506, -22.364442847997687, -24.041545197650805, -13.014920746203455, -20.04335565798076, -29.911479357059918, -20.71144830940218, 16.776011444723686, -10.32903893714646, -32.8593033718809, 3.6702972946121335, -27.91667111972661, -13.951395307725807, 3.7113754624107287, -15.009985925102868, -21.09690662812247, -5.062343745801755, 4.581142733390635, 1.3958751608514035, 10.965683284267726, -31.679389977407396, 2.8187811136796554, -1.2119914687392281, -30.447896447969242, -18.338731781198916, -23.530710779919946, -32.225027697721515, 0.388227665929449, -16.539768541365245, -4.766025814223763, -23.319153553239722, -2.944529963434462, -25.246869827461072, -3.4478415863114087, -14.955874373167262, -19.72294915150913, -31.39109001706634, 6.405765543210819, -20.972600131963993, -5.940937297614422, -11.167486128755328, -19.072827317300543, -23.060232499710118, -34.71271762659551, -28.24057067544005, -7.524084635323323, -19.202028951991807, -25.08308814080562, -29.62960375997023, -9.621749688870523, -5.568435623520401, -24.010561156470047, -7.7060357947414175, 13.055507941908573, -29.807050420821575, 11.009287455016704, 11.774696275889738, 14.744054551793198, 8.324711644313425, 0.9842708419798569, 10.24987835744367, -22.861510824684963, -29.869814130464512, -28.31235442630881, -7.904812143848577, -0.7520474272202762, 13.769139796030366, -15.16118072613392, 0.13313172411692165, 3.030827886719095, -18.463065544269032, -3.1435382803271423, 15.982230265260782, 20.675710145804764, 22.57154968738657, -0.3548681995415741, -21.218588335270947, -22.529971038370924, -15.494513473376795, -16.87897179043474, -27.261006913499415, -11.662463722999224, 10.47137495846794, 3.6073640242562632, -19.26151672662736, -24.12795603443132, -0.7982131467937172, -7.558541909751469, -20.300958108665192, -18.346273445254667, -12.92955912816743, -19.4446800400585, -26.584777694329464, -14.952825931335589, 3.1716052680677578, -17.882233784551154, -6.8534034197972815, -0.19221522508031086, -30.555504295905095, -12.841124843247524, -25.209534410161044, -15.55355295941769, -0.4427717792345689, -18.391144157277278, -16.204768817372326, -35.38020076607657, -19.245847389775044, -8.048513122589682, -12.745304235013265, -12.383869571123174, -12.842160220989314, -3.1416054690088586, -29.835487106689886, -1.849336757656296, -15.96695963618065, -19.681472607906535, -31.597954289674476, -14.53409749288107, -0.5589086083863535, 8.02244368317232, -10.791243057608057, -4.451361426139243, 12.40755786889889, -9.544101458231115, -22.78445836428869, 7.328178461781896, 16.316602856023074, -21.776008666081427, -11.85362407629222, 10.562092612814283, 18.816667350653727, -8.18265949510712, 4.05707352970488, -21.341295887331675, -21.52428833127051, -0.44586413974156613, 11.108076751775414, -2.20605668754855, -3.2808985182803596, -7.759753665719753, -3.582277264099698, 7.422180217674303, -21.749545139740857, -4.332045554130982, 1.246607996029276, -23.960462131114415, -9.38397813505171, -13.132053873680793, -20.80321879633772, -8.956488371455977, -25.67389583087555, -27.44462889783878, -22.612418073465008, 3.022063573138496, -14.165723521755563, -8.438349259582012, -14.400729552415239, 0.9279724651516816, 0.12778795700572232, -13.534787634909481, -4.345061975573614, -10.340268509309745, -8.989434876496293, 3.688621310932895, -19.695533842727848, 6.679563714844157, -7.069063608791282, 3.8505883280042497, 3.361372362677187, -22.461788805372763, -20.355020460031533, -8.441733291956862, 6.743106276484973, 13.54871301939626, 14.086782168213695, 6.308573725552691, -22.476964273425857, -23.40308214184861, 8.168585847586499, -13.815486492287654, -5.025810373059969, -10.291433933897267, 22.949184320785058, -1.8002725571367435, 0.5514888179411734, -21.043316523182344, -4.064995227613604, -15.011053747115625, -10.183208572878993, -14.406546117052244, -1.459457901287415, -1.2658849782842267, -32.76765191313259, 2.6184875187117456, -24.211007383006653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41825780515812483, "mean_inference_ms": 1.099541842858691, "mean_action_processing_ms": 0.1797683179952583, "mean_env_wait_ms": 0.07290242293470522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003568291664123535, "StateBufferConnector_ms": 0.002663731575012207, "ViewRequirementAgentConnector_ms": 0.06994485855102539}, "num_episodes": 9, "episode_return_max": 21.623629916595668, "episode_return_min": -31.476644151017755, "episode_return_mean": -9.624348702280866}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.01193130637836, "num_env_steps_trained_throughput_per_sec": 505.01193130637836, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2136000, "timers": {"training_iteration_time_ms": 8006.859, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8006.825, "sample_time_ms": 769.556, "learn_time_ms": 7223.793, "learn_throughput": 553.726, "synch_weights_time_ms": 12.961}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "done": false, "training_iteration": 178, "trial_id": "83a5c_00000", "date": "2024-08-10_12-39-03", "timestamp": 1723307943, "time_this_iter_s": 7.927973031997681, "time_total_s": 1503.6492836475372, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fbc8790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1503.6492836475372, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 25.858333333333334, "ram_util_percent": 81.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1759324330816825, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.339297984642957, "policy_loss": -0.007351601189963283, "vf_loss": 2.346102649194223, "vf_explained_var": -0.44696274078081527, "kl": 0.006394890273183189, "entropy": 1.1079618698074705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.800075499775509, "cur_kl_coeff": 3.111423228438492e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6345461349313457, "policy_loss": -0.003967903059553161, "vf_loss": 1.6385140402242542, "vf_explained_var": 0.5060500827928384, "kl": 0.0015594202124660228, "entropy": 0.16721683042123914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "env_runners": {"episode_reward_max": 21.623629916595668, "episode_reward_min": -31.476644151017755, "episode_reward_mean": -9.127015101137406, "episode_len_mean": 388.34, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38834, "policy_reward_min": {"agent_policy": -21.623629916595664, "adversary_policy": -35.38020076607657}, "policy_reward_max": {"agent_policy": 31.47664415101776, "adversary_policy": 22.949184320785058}, "policy_reward_mean": {"agent_policy": 9.127015101137408, "adversary_policy": -9.127015101137408}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.07962518696211, 2.9885089471210193, -10.356853346569837, 0.8033948224702137, -24.39331411458406, -27.87786923882073, -8.075770437717898, -14.042589683731741, -14.095699895447765, -9.201857979739335, -25.557019584287737, -7.283417294376587, -8.554211713184875, -21.06652990850533, -31.476644151017755, -13.363056793657563, -27.35634595038793, -7.595092656195472, -15.858298475605732, -8.375771239456503, 11.391991865453221, 11.534383098053311, 5.6170745997117635, -26.365662477574745, -18.10858328507871, 6.508546184405045, -7.5140245010085, -7.7161188287749685, 6.41934599246682, 21.623629916595668, -10.786728267406259, -19.01224225587386, -22.069989351967077, -0.5955443822656417, -7.827076351185548, -12.463084590612524, -13.92975000920833, -15.63791628671105, -23.01472886719398, -5.890610331633916, -12.367818602174218, -15.373859760492707, -19.025329626704277, -7.9981623693261295, -17.297956487324804, -27.313024077925803, -10.396908678801474, -12.613014896056244, -16.488546287849374, -8.908148196918473, -25.63971344879051, -7.546503050633712, -1.3843996872178685, 3.978098221379822, -16.16427991125991, 11.822390658902485, -16.814816371186822, 14.689379981734001, -2.0627929827011204, -21.432792109301094, 5.331106306016924, -2.7434776029144565, -5.6710154649097255, -7.163682461033277, -1.542718779050853, -16.67222013308306, -16.967636335009256, -17.31519210116576, -25.028523485651895, -5.5718299743085336, -11.419539405998627, 0.527880211078702, -8.939924805241548, -9.664851692903019, -8.003456265897476, -0.19474994697356252, 3.6059803453407184, -21.408404632702148, -0.8493135077359444, 13.817747593804988, -8.084195273936581, -7.617248147131054, -9.420648432673811, 6.328875193443896, -0.624391869597785, -12.554155875397974, -12.59713115999731, -7.9330020091698294, -17.016768445708408, -10.796259932147453, -14.41321805241001, -19.132226984338544, -1.762449291846874, 7.767276933899321, -5.042495018758416, -14.650549454133799, -0.5884814766654838, -3.5471569036206496, -4.285834965903081, -20.86427711619379], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [13.07962518696211, -2.9885089471210193, 10.356853346569837, -0.8033948224702137, 24.393314114584058, 27.877869238820733, 8.075770437717898, 14.042589683731741, 14.095699895447765, 9.201857979739335, 25.557019584287733, 7.283417294376587, 8.554211713184875, 21.066529908505327, 31.47664415101776, 13.363056793657565, 27.356345950387926, 7.5950926561954635, 15.858298475605732, 8.375771239456503, -11.391991865453221, -11.534383098053311, -5.6170745997117635, 26.36566247757474, 18.108583285078705, -6.508546184405045, 7.5140245010085, 7.7161188287749685, -6.41934599246682, -21.623629916595664, 10.786728267406259, 19.01224225587386, 22.069989351967074, 0.5955443822656417, 7.827076351185548, 12.46308459061252, 13.92975000920833, 15.637916286711047, 23.01472886719398, 5.890610331633916, 12.367818602174218, 15.373859760492703, 19.025329626704274, 7.9981623693261295, 17.297956487324804, 27.313024077925807, 10.396908678801474, 12.613014896056244, 16.488546287849374, 8.908148196918473, 25.639713448790506, 7.546503050633712, 1.3843996872178685, -3.978098221379823, 16.164279911259904, -11.822390658902485, 16.814816371186833, -14.689379981734003, 2.0627929827011204, 21.432792109301097, -5.331106306016924, 2.7434776029144565, 5.6710154649097255, 7.163682461033277, 1.542718779050853, 16.672220133083062, 16.967636335009256, 17.315192101165756, 25.028523485651906, 5.5718299743085336, 11.419539405998625, -0.527880211078702, 8.939924805241548, 9.664851692903019, 8.003456265897476, 0.19474994697356252, -3.6059803453407184, 21.40840463270215, 0.8493135077359444, -13.817747593804977, 8.084195273936581, 7.617248147131054, 9.420648432673811, -6.328875193443896, 0.6243918695977833, 12.554155875397974, 12.597131159997312, 7.9330020091698294, 17.01676844570841, 10.796259932147453, 14.41321805241001, 19.132226984338548, 1.762449291846874, -7.767276933899321, 5.042495018758416, 14.650549454133802, 0.5884814766654838, 3.5471569036206496, 4.285834965903081, 20.864277116193787], "policy_adversary_policy_reward": [-21.09690662812247, -5.062343745801755, 4.581142733390635, 1.3958751608514035, 10.965683284267726, -31.679389977407396, 2.8187811136796554, -1.2119914687392281, -30.447896447969242, -18.338731781198916, -23.530710779919946, -32.225027697721515, 0.388227665929449, -16.539768541365245, -4.766025814223763, -23.319153553239722, -2.944529963434462, -25.246869827461072, -3.4478415863114087, -14.955874373167262, -19.72294915150913, -31.39109001706634, 6.405765543210819, -20.972600131963993, -5.940937297614422, -11.167486128755328, -19.072827317300543, -23.060232499710118, -34.71271762659551, -28.24057067544005, -7.524084635323323, -19.202028951991807, -25.08308814080562, -29.62960375997023, -9.621749688870523, -5.568435623520401, -24.010561156470047, -7.7060357947414175, 13.055507941908573, -29.807050420821575, 11.009287455016704, 11.774696275889738, 14.744054551793198, 8.324711644313425, 0.9842708419798569, 10.24987835744367, -22.861510824684963, -29.869814130464512, -28.31235442630881, -7.904812143848577, -0.7520474272202762, 13.769139796030366, -15.16118072613392, 0.13313172411692165, 3.030827886719095, -18.463065544269032, -3.1435382803271423, 15.982230265260782, 20.675710145804764, 22.57154968738657, -0.3548681995415741, -21.218588335270947, -22.529971038370924, -15.494513473376795, -16.87897179043474, -27.261006913499415, -11.662463722999224, 10.47137495846794, 3.6073640242562632, -19.26151672662736, -24.12795603443132, -0.7982131467937172, -7.558541909751469, -20.300958108665192, -18.346273445254667, -12.92955912816743, -19.4446800400585, -26.584777694329464, -14.952825931335589, 3.1716052680677578, -17.882233784551154, -6.8534034197972815, -0.19221522508031086, -30.555504295905095, -12.841124843247524, -25.209534410161044, -15.55355295941769, -0.4427717792345689, -18.391144157277278, -16.204768817372326, -35.38020076607657, -19.245847389775044, -8.048513122589682, -12.745304235013265, -12.383869571123174, -12.842160220989314, -3.1416054690088586, -29.835487106689886, -1.849336757656296, -15.96695963618065, -19.681472607906535, -31.597954289674476, -14.53409749288107, -0.5589086083863535, 8.02244368317232, -10.791243057608057, -4.451361426139243, 12.40755786889889, -9.544101458231115, -22.78445836428869, 7.328178461781896, 16.316602856023074, -21.776008666081427, -11.85362407629222, 10.562092612814283, 18.816667350653727, -8.18265949510712, 4.05707352970488, -21.341295887331675, -21.52428833127051, -0.44586413974156613, 11.108076751775414, -2.20605668754855, -3.2808985182803596, -7.759753665719753, -3.582277264099698, 7.422180217674303, -21.749545139740857, -4.332045554130982, 1.246607996029276, -23.960462131114415, -9.38397813505171, -13.132053873680793, -20.80321879633772, -8.956488371455977, -25.67389583087555, -27.44462889783878, -22.612418073465008, 3.022063573138496, -14.165723521755563, -8.438349259582012, -14.400729552415239, 0.9279724651516816, 0.12778795700572232, -13.534787634909481, -4.345061975573614, -10.340268509309745, -8.989434876496293, 3.688621310932895, -19.695533842727848, 6.679563714844157, -7.069063608791282, 3.8505883280042497, 3.361372362677187, -22.461788805372763, -20.355020460031533, -8.441733291956862, 6.743106276484973, 13.54871301939626, 14.086782168213695, 6.308573725552691, -22.476964273425857, -23.40308214184861, 8.168585847586499, -13.815486492287654, -5.025810373059969, -10.291433933897267, 22.949184320785058, -1.8002725571367435, 0.5514888179411734, -21.043316523182344, -4.064995227613604, -15.011053747115625, -10.183208572878993, -14.406546117052244, -1.459457901287415, -1.2658849782842267, -32.76765191313259, 2.6184875187117456, -24.211007383006653, -18.345159753392867, -10.481276351427155, -16.70859083331146, -21.555863135365634, -5.141881707222211, 1.6169831235284633, 11.507926144450117, 4.0266277233485255, 13.284714546930658, -23.369704584447486, -4.605091193526441, -24.696007714741157, 17.762681840101358, -18.939644793432326, -21.296183118081906, 14.201869310840607, 5.010349052555156, -13.58201898436132, -22.74882146354868, -18.979732768838897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4180132761092151, "mean_inference_ms": 1.09890729816536, "mean_action_processing_ms": 0.17965089030281634, "mean_env_wait_ms": 0.07285757132393857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003606081008911133, "StateBufferConnector_ms": 0.002635478973388672, "ViewRequirementAgentConnector_ms": 0.06942832469940186}, "num_episodes": 10, "episode_return_max": 21.623629916595668, "episode_return_min": -31.476644151017755, "episode_return_mean": -9.127015101137406}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.5010381213139, "num_env_steps_trained_throughput_per_sec": 505.5010381213139, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2148000, "timers": {"training_iteration_time_ms": 8006.838, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8006.804, "sample_time_ms": 767.79, "learn_time_ms": 7225.408, "learn_throughput": 553.602, "synch_weights_time_ms": 13.094}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2148000, "num_agent_steps_trained": 2148000}, "done": false, "training_iteration": 179, "trial_id": "83a5c_00000", "date": "2024-08-10_12-39-11", "timestamp": 1723307951, "time_this_iter_s": 7.917935132980347, "time_total_s": 1511.5672187805176, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1511.5672187805176, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 26.518181818181816, "ram_util_percent": 81.66363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2596842765492737, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.109016794439346, "policy_loss": -0.007929661440559559, "vf_loss": 2.116320683968761, "vf_explained_var": -0.2329228114514124, "kl": 0.007316839989108841, "entropy": 1.095862060690683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.937918552507957, "cur_kl_coeff": 1.555711614219246e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6946682257267336, "policy_loss": -0.008815353209744596, "vf_loss": 1.7034835734094183, "vf_explained_var": 0.425715879475077, "kl": 0.0027981159364586007, "entropy": 0.22086290698498487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 21.623629916595668, "episode_reward_min": -31.476644151017755, "episode_reward_mean": -8.815053854016814, "episode_len_mean": 388.34, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38834, "policy_reward_min": {"agent_policy": -21.623629916595664, "adversary_policy": -35.38020076607657}, "policy_reward_max": {"agent_policy": 31.47664415101776, "adversary_policy": 22.949184320785058}, "policy_reward_mean": {"agent_policy": 8.815053854016814, "adversary_policy": -8.815053854016812}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.557019584287737, -7.283417294376587, -8.554211713184875, -21.06652990850533, -31.476644151017755, -13.363056793657563, -27.35634595038793, -7.595092656195472, -15.858298475605732, -8.375771239456503, 11.391991865453221, 11.534383098053311, 5.6170745997117635, -26.365662477574745, -18.10858328507871, 6.508546184405045, -7.5140245010085, -7.7161188287749685, 6.41934599246682, 21.623629916595668, -10.786728267406259, -19.01224225587386, -22.069989351967077, -0.5955443822656417, -7.827076351185548, -12.463084590612524, -13.92975000920833, -15.63791628671105, -23.01472886719398, -5.890610331633916, -12.367818602174218, -15.373859760492707, -19.025329626704277, -7.9981623693261295, -17.297956487324804, -27.313024077925803, -10.396908678801474, -12.613014896056244, -16.488546287849374, -8.908148196918473, -25.63971344879051, -7.546503050633712, -1.3843996872178685, 3.978098221379822, -16.16427991125991, 11.822390658902485, -16.814816371186822, 14.689379981734001, -2.0627929827011204, -21.432792109301094, 5.331106306016924, -2.7434776029144565, -5.6710154649097255, -7.163682461033277, -1.542718779050853, -16.67222013308306, -16.967636335009256, -17.31519210116576, -25.028523485651895, -5.5718299743085336, -11.419539405998627, 0.527880211078702, -8.939924805241548, -9.664851692903019, -8.003456265897476, -0.19474994697356252, 3.6059803453407184, -21.408404632702148, -0.8493135077359444, 13.817747593804988, -8.084195273936581, -7.617248147131054, -9.420648432673811, 6.328875193443896, -0.624391869597785, -12.554155875397974, -12.59713115999731, -7.9330020091698294, -17.016768445708408, -10.796259932147453, -14.41321805241001, -19.132226984338544, -1.762449291846874, 7.767276933899321, -5.042495018758416, -14.650549454133799, -0.5884814766654838, -3.5471569036206496, -4.285834965903081, -20.86427711619379, 14.80350751056363, -14.228214049129623, -22.855227966314292, 12.215496346548392, -21.576634061372353, 3.176060199231026, -1.4868613118194371, -18.518595330852865, -22.881373968440816, -14.783708770336474], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [25.557019584287733, 7.283417294376587, 8.554211713184875, 21.066529908505327, 31.47664415101776, 13.363056793657565, 27.356345950387926, 7.5950926561954635, 15.858298475605732, 8.375771239456503, -11.391991865453221, -11.534383098053311, -5.6170745997117635, 26.36566247757474, 18.108583285078705, -6.508546184405045, 7.5140245010085, 7.7161188287749685, -6.41934599246682, -21.623629916595664, 10.786728267406259, 19.01224225587386, 22.069989351967074, 0.5955443822656417, 7.827076351185548, 12.46308459061252, 13.92975000920833, 15.637916286711047, 23.01472886719398, 5.890610331633916, 12.367818602174218, 15.373859760492703, 19.025329626704274, 7.9981623693261295, 17.297956487324804, 27.313024077925807, 10.396908678801474, 12.613014896056244, 16.488546287849374, 8.908148196918473, 25.639713448790506, 7.546503050633712, 1.3843996872178685, -3.978098221379823, 16.164279911259904, -11.822390658902485, 16.814816371186833, -14.689379981734003, 2.0627929827011204, 21.432792109301097, -5.331106306016924, 2.7434776029144565, 5.6710154649097255, 7.163682461033277, 1.542718779050853, 16.672220133083062, 16.967636335009256, 17.315192101165756, 25.028523485651906, 5.5718299743085336, 11.419539405998625, -0.527880211078702, 8.939924805241548, 9.664851692903019, 8.003456265897476, 0.19474994697356252, -3.6059803453407184, 21.40840463270215, 0.8493135077359444, -13.817747593804977, 8.084195273936581, 7.617248147131054, 9.420648432673811, -6.328875193443896, 0.6243918695977833, 12.554155875397974, 12.597131159997312, 7.9330020091698294, 17.01676844570841, 10.796259932147453, 14.41321805241001, 19.132226984338548, 1.762449291846874, -7.767276933899321, 5.042495018758416, 14.650549454133802, 0.5884814766654838, 3.5471569036206496, 4.285834965903081, 20.864277116193787, -14.803507510563627, 14.228214049129623, 22.855227966314295, -12.215496346548392, 21.576634061372356, -3.1760601992310082, 1.4868613118194371, 18.518595330852865, 22.881373968440812, 14.783708770336478], "policy_adversary_policy_reward": [-19.72294915150913, -31.39109001706634, 6.405765543210819, -20.972600131963993, -5.940937297614422, -11.167486128755328, -19.072827317300543, -23.060232499710118, -34.71271762659551, -28.24057067544005, -7.524084635323323, -19.202028951991807, -25.08308814080562, -29.62960375997023, -9.621749688870523, -5.568435623520401, -24.010561156470047, -7.7060357947414175, 13.055507941908573, -29.807050420821575, 11.009287455016704, 11.774696275889738, 14.744054551793198, 8.324711644313425, 0.9842708419798569, 10.24987835744367, -22.861510824684963, -29.869814130464512, -28.31235442630881, -7.904812143848577, -0.7520474272202762, 13.769139796030366, -15.16118072613392, 0.13313172411692165, 3.030827886719095, -18.463065544269032, -3.1435382803271423, 15.982230265260782, 20.675710145804764, 22.57154968738657, -0.3548681995415741, -21.218588335270947, -22.529971038370924, -15.494513473376795, -16.87897179043474, -27.261006913499415, -11.662463722999224, 10.47137495846794, 3.6073640242562632, -19.26151672662736, -24.12795603443132, -0.7982131467937172, -7.558541909751469, -20.300958108665192, -18.346273445254667, -12.92955912816743, -19.4446800400585, -26.584777694329464, -14.952825931335589, 3.1716052680677578, -17.882233784551154, -6.8534034197972815, -0.19221522508031086, -30.555504295905095, -12.841124843247524, -25.209534410161044, -15.55355295941769, -0.4427717792345689, -18.391144157277278, -16.204768817372326, -35.38020076607657, -19.245847389775044, -8.048513122589682, -12.745304235013265, -12.383869571123174, -12.842160220989314, -3.1416054690088586, -29.835487106689886, -1.849336757656296, -15.96695963618065, -19.681472607906535, -31.597954289674476, -14.53409749288107, -0.5589086083863535, 8.02244368317232, -10.791243057608057, -4.451361426139243, 12.40755786889889, -9.544101458231115, -22.78445836428869, 7.328178461781896, 16.316602856023074, -21.776008666081427, -11.85362407629222, 10.562092612814283, 18.816667350653727, -8.18265949510712, 4.05707352970488, -21.341295887331675, -21.52428833127051, -0.44586413974156613, 11.108076751775414, -2.20605668754855, -3.2808985182803596, -7.759753665719753, -3.582277264099698, 7.422180217674303, -21.749545139740857, -4.332045554130982, 1.246607996029276, -23.960462131114415, -9.38397813505171, -13.132053873680793, -20.80321879633772, -8.956488371455977, -25.67389583087555, -27.44462889783878, -22.612418073465008, 3.022063573138496, -14.165723521755563, -8.438349259582012, -14.400729552415239, 0.9279724651516816, 0.12778795700572232, -13.534787634909481, -4.345061975573614, -10.340268509309745, -8.989434876496293, 3.688621310932895, -19.695533842727848, 6.679563714844157, -7.069063608791282, 3.8505883280042497, 3.361372362677187, -22.461788805372763, -20.355020460031533, -8.441733291956862, 6.743106276484973, 13.54871301939626, 14.086782168213695, 6.308573725552691, -22.476964273425857, -23.40308214184861, 8.168585847586499, -13.815486492287654, -5.025810373059969, -10.291433933897267, 22.949184320785058, -1.8002725571367435, 0.5514888179411734, -21.043316523182344, -4.064995227613604, -15.011053747115625, -10.183208572878993, -14.406546117052244, -1.459457901287415, -1.2658849782842267, -32.76765191313259, 2.6184875187117456, -24.211007383006653, -18.345159753392867, -10.481276351427155, -16.70859083331146, -21.555863135365634, -5.141881707222211, 1.6169831235284633, 11.507926144450117, 4.0266277233485255, 13.284714546930658, -23.369704584447486, -4.605091193526441, -24.696007714741157, 17.762681840101358, -18.939644793432326, -21.296183118081906, 14.201869310840607, 5.010349052555156, -13.58201898436132, -22.74882146354868, -18.979732768838897, 19.013045863421183, 10.593969157706063, -1.2410391070630808, -27.215388991196164, -22.1849151848991, -23.525540747729472, 15.235539945399857, 9.195452747696926, -17.166110423477118, -25.9871576992676, 5.753789972022748, 0.5983304264392828, 7.637889209642871, -10.611611833281746, -19.51338699238753, -17.523803669318188, -23.1613167685073, -22.601431168374326, -3.961756224453321, -25.60566131621963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4177695565848771, "mean_inference_ms": 1.0979959816744138, "mean_action_processing_ms": 0.17955470240035276, "mean_env_wait_ms": 0.07277739823730933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035725831985473633, "StateBufferConnector_ms": 0.0025011301040649414, "ViewRequirementAgentConnector_ms": 0.06812894344329834}, "num_episodes": 10, "episode_return_max": 21.623629916595668, "episode_return_min": -31.476644151017755, "episode_return_mean": -8.815053854016814}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.7100146137621, "num_env_steps_trained_throughput_per_sec": 507.7100146137621, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 7964.062, "restore_workers_time_ms": 0.012, "training_step_time_ms": 7964.029, "sample_time_ms": 754.516, "learn_time_ms": 7195.995, "learn_throughput": 555.865, "synch_weights_time_ms": 13.029}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 180, "trial_id": "83a5c_00000", "date": "2024-08-10_12-39-18", "timestamp": 1723307958, "time_this_iter_s": 7.882649898529053, "time_total_s": 1519.4498686790466, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd52430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1519.4498686790466, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 26.381818181818186, "ram_util_percent": 81.26363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.915725923972155, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.966560059754306, "policy_loss": -0.003530405856614745, "vf_loss": 1.9695590812693198, "vf_explained_var": 0.055007708356493996, "kl": 0.006213162647796092, "entropy": 1.0597431857119162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.759923224585752, "cur_kl_coeff": 7.77855807109623e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6813862901180983, "policy_loss": -0.006443288361576076, "vf_loss": 1.6878295788541435, "vf_explained_var": 0.5409372434640924, "kl": 0.0027573797646962992, "entropy": 0.23148054035070043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "env_runners": {"episode_reward_max": 21.623629916595668, "episode_reward_min": -27.313024077925803, "episode_reward_mean": -8.070524845022145, "episode_len_mean": 388.34, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38834, "policy_reward_min": {"agent_policy": -21.623629916595664, "adversary_policy": -35.38020076607657}, "policy_reward_max": {"agent_policy": 27.313024077925807, "adversary_policy": 22.949184320785058}, "policy_reward_mean": {"agent_policy": 8.070524845022145, "adversary_policy": -8.070524845022145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.534383098053311, 5.6170745997117635, -26.365662477574745, -18.10858328507871, 6.508546184405045, -7.5140245010085, -7.7161188287749685, 6.41934599246682, 21.623629916595668, -10.786728267406259, -19.01224225587386, -22.069989351967077, -0.5955443822656417, -7.827076351185548, -12.463084590612524, -13.92975000920833, -15.63791628671105, -23.01472886719398, -5.890610331633916, -12.367818602174218, -15.373859760492707, -19.025329626704277, -7.9981623693261295, -17.297956487324804, -27.313024077925803, -10.396908678801474, -12.613014896056244, -16.488546287849374, -8.908148196918473, -25.63971344879051, -7.546503050633712, -1.3843996872178685, 3.978098221379822, -16.16427991125991, 11.822390658902485, -16.814816371186822, 14.689379981734001, -2.0627929827011204, -21.432792109301094, 5.331106306016924, -2.7434776029144565, -5.6710154649097255, -7.163682461033277, -1.542718779050853, -16.67222013308306, -16.967636335009256, -17.31519210116576, -25.028523485651895, -5.5718299743085336, -11.419539405998627, 0.527880211078702, -8.939924805241548, -9.664851692903019, -8.003456265897476, -0.19474994697356252, 3.6059803453407184, -21.408404632702148, -0.8493135077359444, 13.817747593804988, -8.084195273936581, -7.617248147131054, -9.420648432673811, 6.328875193443896, -0.624391869597785, -12.554155875397974, -12.59713115999731, -7.9330020091698294, -17.016768445708408, -10.796259932147453, -14.41321805241001, -19.132226984338544, -1.762449291846874, 7.767276933899321, -5.042495018758416, -14.650549454133799, -0.5884814766654838, -3.5471569036206496, -4.285834965903081, -20.86427711619379, 14.80350751056363, -14.228214049129623, -22.855227966314292, 12.215496346548392, -21.576634061372353, 3.176060199231026, -1.4868613118194371, -18.518595330852865, -22.881373968440816, -14.783708770336474, -25.59402154317755, -19.119131807707696, 7.137771131435326, -19.728843245131173, 10.191347240408625, -10.700932080519635, -6.701654159825734, -7.373372291537324, -0.6872048399487731, -6.296554127429614, -1.7688992783220208], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-11.534383098053311, -5.6170745997117635, 26.36566247757474, 18.108583285078705, -6.508546184405045, 7.5140245010085, 7.7161188287749685, -6.41934599246682, -21.623629916595664, 10.786728267406259, 19.01224225587386, 22.069989351967074, 0.5955443822656417, 7.827076351185548, 12.46308459061252, 13.92975000920833, 15.637916286711047, 23.01472886719398, 5.890610331633916, 12.367818602174218, 15.373859760492703, 19.025329626704274, 7.9981623693261295, 17.297956487324804, 27.313024077925807, 10.396908678801474, 12.613014896056244, 16.488546287849374, 8.908148196918473, 25.639713448790506, 7.546503050633712, 1.3843996872178685, -3.978098221379823, 16.164279911259904, -11.822390658902485, 16.814816371186833, -14.689379981734003, 2.0627929827011204, 21.432792109301097, -5.331106306016924, 2.7434776029144565, 5.6710154649097255, 7.163682461033277, 1.542718779050853, 16.672220133083062, 16.967636335009256, 17.315192101165756, 25.028523485651906, 5.5718299743085336, 11.419539405998625, -0.527880211078702, 8.939924805241548, 9.664851692903019, 8.003456265897476, 0.19474994697356252, -3.6059803453407184, 21.40840463270215, 0.8493135077359444, -13.817747593804977, 8.084195273936581, 7.617248147131054, 9.420648432673811, -6.328875193443896, 0.6243918695977833, 12.554155875397974, 12.597131159997312, 7.9330020091698294, 17.01676844570841, 10.796259932147453, 14.41321805241001, 19.132226984338548, 1.762449291846874, -7.767276933899321, 5.042495018758416, 14.650549454133802, 0.5884814766654838, 3.5471569036206496, 4.285834965903081, 20.864277116193787, -14.803507510563627, 14.228214049129623, 22.855227966314295, -12.215496346548392, 21.576634061372356, -3.1760601992310082, 1.4868613118194371, 18.518595330852865, 22.881373968440812, 14.783708770336478, 25.594021543177547, 19.119131807707685, -7.137771131435326, 19.728843245131173, -10.191347240408625, 10.700932080519635, 6.701654159825734, 7.373372291537324, 0.6872048399487731, 6.296554127429614, 1.7688992783220208], "policy_adversary_policy_reward": [14.744054551793198, 8.324711644313425, 0.9842708419798569, 10.24987835744367, -22.861510824684963, -29.869814130464512, -28.31235442630881, -7.904812143848577, -0.7520474272202762, 13.769139796030366, -15.16118072613392, 0.13313172411692165, 3.030827886719095, -18.463065544269032, -3.1435382803271423, 15.982230265260782, 20.675710145804764, 22.57154968738657, -0.3548681995415741, -21.218588335270947, -22.529971038370924, -15.494513473376795, -16.87897179043474, -27.261006913499415, -11.662463722999224, 10.47137495846794, 3.6073640242562632, -19.26151672662736, -24.12795603443132, -0.7982131467937172, -7.558541909751469, -20.300958108665192, -18.346273445254667, -12.92955912816743, -19.4446800400585, -26.584777694329464, -14.952825931335589, 3.1716052680677578, -17.882233784551154, -6.8534034197972815, -0.19221522508031086, -30.555504295905095, -12.841124843247524, -25.209534410161044, -15.55355295941769, -0.4427717792345689, -18.391144157277278, -16.204768817372326, -35.38020076607657, -19.245847389775044, -8.048513122589682, -12.745304235013265, -12.383869571123174, -12.842160220989314, -3.1416054690088586, -29.835487106689886, -1.849336757656296, -15.96695963618065, -19.681472607906535, -31.597954289674476, -14.53409749288107, -0.5589086083863535, 8.02244368317232, -10.791243057608057, -4.451361426139243, 12.40755786889889, -9.544101458231115, -22.78445836428869, 7.328178461781896, 16.316602856023074, -21.776008666081427, -11.85362407629222, 10.562092612814283, 18.816667350653727, -8.18265949510712, 4.05707352970488, -21.341295887331675, -21.52428833127051, -0.44586413974156613, 11.108076751775414, -2.20605668754855, -3.2808985182803596, -7.759753665719753, -3.582277264099698, 7.422180217674303, -21.749545139740857, -4.332045554130982, 1.246607996029276, -23.960462131114415, -9.38397813505171, -13.132053873680793, -20.80321879633772, -8.956488371455977, -25.67389583087555, -27.44462889783878, -22.612418073465008, 3.022063573138496, -14.165723521755563, -8.438349259582012, -14.400729552415239, 0.9279724651516816, 0.12778795700572232, -13.534787634909481, -4.345061975573614, -10.340268509309745, -8.989434876496293, 3.688621310932895, -19.695533842727848, 6.679563714844157, -7.069063608791282, 3.8505883280042497, 3.361372362677187, -22.461788805372763, -20.355020460031533, -8.441733291956862, 6.743106276484973, 13.54871301939626, 14.086782168213695, 6.308573725552691, -22.476964273425857, -23.40308214184861, 8.168585847586499, -13.815486492287654, -5.025810373059969, -10.291433933897267, 22.949184320785058, -1.8002725571367435, 0.5514888179411734, -21.043316523182344, -4.064995227613604, -15.011053747115625, -10.183208572878993, -14.406546117052244, -1.459457901287415, -1.2658849782842267, -32.76765191313259, 2.6184875187117456, -24.211007383006653, -18.345159753392867, -10.481276351427155, -16.70859083331146, -21.555863135365634, -5.141881707222211, 1.6169831235284633, 11.507926144450117, 4.0266277233485255, 13.284714546930658, -23.369704584447486, -4.605091193526441, -24.696007714741157, 17.762681840101358, -18.939644793432326, -21.296183118081906, 14.201869310840607, 5.010349052555156, -13.58201898436132, -22.74882146354868, -18.979732768838897, 19.013045863421183, 10.593969157706063, -1.2410391070630808, -27.215388991196164, -22.1849151848991, -23.525540747729472, 15.235539945399857, 9.195452747696926, -17.166110423477118, -25.9871576992676, 5.753789972022748, 0.5983304264392828, 7.637889209642871, -10.611611833281746, -19.51338699238753, -17.523803669318188, -23.1613167685073, -22.601431168374326, -3.961756224453321, -25.60566131621963, -33.399896074263864, -17.78814701209124, -20.60932778360134, -17.62893583181405, 12.185247994850336, 2.0902942680203154, -16.372965540543877, -23.084720949718474, 7.654067144518137, 12.728627336299112, -10.203566330123682, -11.19829783091559, -3.121411944835149, -10.281896374816323, -4.20742951177845, -10.539315071296198, -12.034322128362398, 10.659912448464851, -7.033434751837344, -5.559673503021884, -3.38223226509907, -0.1555662915449716]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4174938337368818, "mean_inference_ms": 1.0971524996825355, "mean_action_processing_ms": 0.17943763058077167, "mean_env_wait_ms": 0.0727062230913859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034998655319213867, "StateBufferConnector_ms": 0.002489447593688965, "ViewRequirementAgentConnector_ms": 0.06760179996490479}, "num_episodes": 11, "episode_return_max": 21.623629916595668, "episode_return_min": -27.313024077925803, "episode_return_mean": -8.070524845022145}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 456.730233665809, "num_env_steps_trained_throughput_per_sec": 456.730233665809, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2172000, "timers": {"training_iteration_time_ms": 8054.297, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8054.264, "sample_time_ms": 755.524, "learn_time_ms": 7285.519, "learn_throughput": 549.034, "synch_weights_time_ms": 12.728}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2172000, "num_agent_steps_trained": 2172000}, "done": false, "training_iteration": 181, "trial_id": "83a5c_00000", "date": "2024-08-10_12-39-27", "timestamp": 1723307967, "time_this_iter_s": 8.780803203582764, "time_total_s": 1528.2306718826294, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc74af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1528.2306718826294, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 32.60769230769231, "ram_util_percent": 81.1923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.081028436195283, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.589618872902381, "policy_loss": -0.006952662975034583, "vf_loss": 2.5954115259584296, "vf_explained_var": 0.07016927073241541, "kl": 0.013563267508140771, "entropy": 1.0669092080580493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.167206725757569, "cur_kl_coeff": 3.889279035548115e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7444352159897487, "policy_loss": -0.004693226759991375, "vf_loss": 1.7491284376010299, "vf_explained_var": 0.7197009567171335, "kl": 0.0032382509879594385, "entropy": 0.21347192597265044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "env_runners": {"episode_reward_max": 14.80350751056363, "episode_reward_min": -27.313024077925803, "episode_reward_mean": -9.092784263274147, "episode_len_mean": 388.34, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38834, "policy_reward_min": {"agent_policy": -14.803507510563627, "adversary_policy": -35.38020076607657}, "policy_reward_max": {"agent_policy": 27.313024077925807, "adversary_policy": 22.949184320785058}, "policy_reward_mean": {"agent_policy": 9.092784263274147, "adversary_policy": -9.092784263274147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.01224225587386, -22.069989351967077, -0.5955443822656417, -7.827076351185548, -12.463084590612524, -13.92975000920833, -15.63791628671105, -23.01472886719398, -5.890610331633916, -12.367818602174218, -15.373859760492707, -19.025329626704277, -7.9981623693261295, -17.297956487324804, -27.313024077925803, -10.396908678801474, -12.613014896056244, -16.488546287849374, -8.908148196918473, -25.63971344879051, -7.546503050633712, -1.3843996872178685, 3.978098221379822, -16.16427991125991, 11.822390658902485, -16.814816371186822, 14.689379981734001, -2.0627929827011204, -21.432792109301094, 5.331106306016924, -2.7434776029144565, -5.6710154649097255, -7.163682461033277, -1.542718779050853, -16.67222013308306, -16.967636335009256, -17.31519210116576, -25.028523485651895, -5.5718299743085336, -11.419539405998627, 0.527880211078702, -8.939924805241548, -9.664851692903019, -8.003456265897476, -0.19474994697356252, 3.6059803453407184, -21.408404632702148, -0.8493135077359444, 13.817747593804988, -8.084195273936581, -7.617248147131054, -9.420648432673811, 6.328875193443896, -0.624391869597785, -12.554155875397974, -12.59713115999731, -7.9330020091698294, -17.016768445708408, -10.796259932147453, -14.41321805241001, -19.132226984338544, -1.762449291846874, 7.767276933899321, -5.042495018758416, -14.650549454133799, -0.5884814766654838, -3.5471569036206496, -4.285834965903081, -20.86427711619379, 14.80350751056363, -14.228214049129623, -22.855227966314292, 12.215496346548392, -21.576634061372353, 3.176060199231026, -1.4868613118194371, -18.518595330852865, -22.881373968440816, -14.783708770336474, -25.59402154317755, -19.119131807707696, 7.137771131435326, -19.728843245131173, 10.191347240408625, -10.700932080519635, -6.701654159825734, -7.373372291537324, -0.6872048399487731, -6.296554127429614, -1.7688992783220208, -8.34123111258984, -18.56108395927148, 0.016603181030085068, -15.439060079201447, -16.318490555550593, -22.493650695597786, -8.719548359116647, 1.8837207552229742, -12.098341747155938, -20.942996821580092], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [19.01224225587386, 22.069989351967074, 0.5955443822656417, 7.827076351185548, 12.46308459061252, 13.92975000920833, 15.637916286711047, 23.01472886719398, 5.890610331633916, 12.367818602174218, 15.373859760492703, 19.025329626704274, 7.9981623693261295, 17.297956487324804, 27.313024077925807, 10.396908678801474, 12.613014896056244, 16.488546287849374, 8.908148196918473, 25.639713448790506, 7.546503050633712, 1.3843996872178685, -3.978098221379823, 16.164279911259904, -11.822390658902485, 16.814816371186833, -14.689379981734003, 2.0627929827011204, 21.432792109301097, -5.331106306016924, 2.7434776029144565, 5.6710154649097255, 7.163682461033277, 1.542718779050853, 16.672220133083062, 16.967636335009256, 17.315192101165756, 25.028523485651906, 5.5718299743085336, 11.419539405998625, -0.527880211078702, 8.939924805241548, 9.664851692903019, 8.003456265897476, 0.19474994697356252, -3.6059803453407184, 21.40840463270215, 0.8493135077359444, -13.817747593804977, 8.084195273936581, 7.617248147131054, 9.420648432673811, -6.328875193443896, 0.6243918695977833, 12.554155875397974, 12.597131159997312, 7.9330020091698294, 17.01676844570841, 10.796259932147453, 14.41321805241001, 19.132226984338548, 1.762449291846874, -7.767276933899321, 5.042495018758416, 14.650549454133802, 0.5884814766654838, 3.5471569036206496, 4.285834965903081, 20.864277116193787, -14.803507510563627, 14.228214049129623, 22.855227966314295, -12.215496346548392, 21.576634061372356, -3.1760601992310082, 1.4868613118194371, 18.518595330852865, 22.881373968440812, 14.783708770336478, 25.594021543177547, 19.119131807707685, -7.137771131435326, 19.728843245131173, -10.191347240408625, 10.700932080519635, 6.701654159825734, 7.373372291537324, 0.6872048399487731, 6.296554127429614, 1.7688992783220208, 8.341231112589838, 18.56108395927148, -0.016603181030085068, 15.439060079201447, 16.318490555550593, 22.493650695597783, 8.719548359116647, -1.8837207552229724, 12.098341747155938, 20.94299682158009], "policy_adversary_policy_reward": [-22.529971038370924, -15.494513473376795, -16.87897179043474, -27.261006913499415, -11.662463722999224, 10.47137495846794, 3.6073640242562632, -19.26151672662736, -24.12795603443132, -0.7982131467937172, -7.558541909751469, -20.300958108665192, -18.346273445254667, -12.92955912816743, -19.4446800400585, -26.584777694329464, -14.952825931335589, 3.1716052680677578, -17.882233784551154, -6.8534034197972815, -0.19221522508031086, -30.555504295905095, -12.841124843247524, -25.209534410161044, -15.55355295941769, -0.4427717792345689, -18.391144157277278, -16.204768817372326, -35.38020076607657, -19.245847389775044, -8.048513122589682, -12.745304235013265, -12.383869571123174, -12.842160220989314, -3.1416054690088586, -29.835487106689886, -1.849336757656296, -15.96695963618065, -19.681472607906535, -31.597954289674476, -14.53409749288107, -0.5589086083863535, 8.02244368317232, -10.791243057608057, -4.451361426139243, 12.40755786889889, -9.544101458231115, -22.78445836428869, 7.328178461781896, 16.316602856023074, -21.776008666081427, -11.85362407629222, 10.562092612814283, 18.816667350653727, -8.18265949510712, 4.05707352970488, -21.341295887331675, -21.52428833127051, -0.44586413974156613, 11.108076751775414, -2.20605668754855, -3.2808985182803596, -7.759753665719753, -3.582277264099698, 7.422180217674303, -21.749545139740857, -4.332045554130982, 1.246607996029276, -23.960462131114415, -9.38397813505171, -13.132053873680793, -20.80321879633772, -8.956488371455977, -25.67389583087555, -27.44462889783878, -22.612418073465008, 3.022063573138496, -14.165723521755563, -8.438349259582012, -14.400729552415239, 0.9279724651516816, 0.12778795700572232, -13.534787634909481, -4.345061975573614, -10.340268509309745, -8.989434876496293, 3.688621310932895, -19.695533842727848, 6.679563714844157, -7.069063608791282, 3.8505883280042497, 3.361372362677187, -22.461788805372763, -20.355020460031533, -8.441733291956862, 6.743106276484973, 13.54871301939626, 14.086782168213695, 6.308573725552691, -22.476964273425857, -23.40308214184861, 8.168585847586499, -13.815486492287654, -5.025810373059969, -10.291433933897267, 22.949184320785058, -1.8002725571367435, 0.5514888179411734, -21.043316523182344, -4.064995227613604, -15.011053747115625, -10.183208572878993, -14.406546117052244, -1.459457901287415, -1.2658849782842267, -32.76765191313259, 2.6184875187117456, -24.211007383006653, -18.345159753392867, -10.481276351427155, -16.70859083331146, -21.555863135365634, -5.141881707222211, 1.6169831235284633, 11.507926144450117, 4.0266277233485255, 13.284714546930658, -23.369704584447486, -4.605091193526441, -24.696007714741157, 17.762681840101358, -18.939644793432326, -21.296183118081906, 14.201869310840607, 5.010349052555156, -13.58201898436132, -22.74882146354868, -18.979732768838897, 19.013045863421183, 10.593969157706063, -1.2410391070630808, -27.215388991196164, -22.1849151848991, -23.525540747729472, 15.235539945399857, 9.195452747696926, -17.166110423477118, -25.9871576992676, 5.753789972022748, 0.5983304264392828, 7.637889209642871, -10.611611833281746, -19.51338699238753, -17.523803669318188, -23.1613167685073, -22.601431168374326, -3.961756224453321, -25.60566131621963, -33.399896074263864, -17.78814701209124, -20.60932778360134, -17.62893583181405, 12.185247994850336, 2.0902942680203154, -16.372965540543877, -23.084720949718474, 7.654067144518137, 12.728627336299112, -10.203566330123682, -11.19829783091559, -3.121411944835149, -10.281896374816323, -4.20742951177845, -10.539315071296198, -12.034322128362398, 10.659912448464851, -7.033434751837344, -5.559673503021884, -3.38223226509907, -0.1555662915449716, -11.175488365194262, -5.506973859985415, -17.419535361614486, -19.702632556928474, -8.164759550958216, 8.197965913018386, -18.661318803153137, -12.216801355249757, -18.72942604509778, -13.907555066003404, -21.117446101035952, -23.869855290159627, 6.526380614105776, -23.96547733233907, -5.812610096774044, 9.580051607219993, -13.982855720425938, -10.213827773885939, -26.831829476885424, -15.05416416627476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41723797699268694, "mean_inference_ms": 1.096437225485517, "mean_action_processing_ms": 0.17932858173245025, "mean_env_wait_ms": 0.07264747242982636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034371614456176758, "StateBufferConnector_ms": 0.002484560012817383, "ViewRequirementAgentConnector_ms": 0.06734788417816162}, "num_episodes": 10, "episode_return_max": 14.80350751056363, "episode_return_min": -27.313024077925803, "episode_return_mean": -9.092784263274147}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.93546736301624, "num_env_steps_trained_throughput_per_sec": 498.93546736301624, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2184000, "timers": {"training_iteration_time_ms": 8071.886, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8071.852, "sample_time_ms": 764.051, "learn_time_ms": 7294.431, "learn_throughput": 548.364, "synch_weights_time_ms": 12.889}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "done": false, "training_iteration": 182, "trial_id": "83a5c_00000", "date": "2024-08-10_12-39-35", "timestamp": 1723307975, "time_this_iter_s": 8.021460056304932, "time_total_s": 1536.2521319389343, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fcdaa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1536.2521319389343, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 27.099999999999998, "ram_util_percent": 81.63636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3319491528014025, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4564820757618655, "policy_loss": -0.007046588931094717, "vf_loss": 2.462747555308872, "vf_explained_var": 0.1166596481093654, "kl": 0.009132967710617185, "entropy": 1.182080688110735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.559824830169479, "cur_kl_coeff": 1.9446395177740574e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8696481250847379, "policy_loss": -0.002989464600007826, "vf_loss": 1.8726375931873918, "vf_explained_var": 0.7430087064082423, "kl": 0.001801393058248853, "entropy": 0.25107049122452735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "env_runners": {"episode_reward_max": 14.80350751056363, "episode_reward_min": -28.27720750803006, "episode_reward_mean": -9.13299693718565, "episode_len_mean": 388.34, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 38834, "policy_reward_min": {"agent_policy": -14.803507510563627, "adversary_policy": -35.38020076607657}, "policy_reward_max": {"agent_policy": 28.277207508030063, "adversary_policy": 22.949184320785058}, "policy_reward_mean": {"agent_policy": 9.13299693718565, "adversary_policy": -9.13299693718565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.373859760492707, -19.025329626704277, -7.9981623693261295, -17.297956487324804, -27.313024077925803, -10.396908678801474, -12.613014896056244, -16.488546287849374, -8.908148196918473, -25.63971344879051, -7.546503050633712, -1.3843996872178685, 3.978098221379822, -16.16427991125991, 11.822390658902485, -16.814816371186822, 14.689379981734001, -2.0627929827011204, -21.432792109301094, 5.331106306016924, -2.7434776029144565, -5.6710154649097255, -7.163682461033277, -1.542718779050853, -16.67222013308306, -16.967636335009256, -17.31519210116576, -25.028523485651895, -5.5718299743085336, -11.419539405998627, 0.527880211078702, -8.939924805241548, -9.664851692903019, -8.003456265897476, -0.19474994697356252, 3.6059803453407184, -21.408404632702148, -0.8493135077359444, 13.817747593804988, -8.084195273936581, -7.617248147131054, -9.420648432673811, 6.328875193443896, -0.624391869597785, -12.554155875397974, -12.59713115999731, -7.9330020091698294, -17.016768445708408, -10.796259932147453, -14.41321805241001, -19.132226984338544, -1.762449291846874, 7.767276933899321, -5.042495018758416, -14.650549454133799, -0.5884814766654838, -3.5471569036206496, -4.285834965903081, -20.86427711619379, 14.80350751056363, -14.228214049129623, -22.855227966314292, 12.215496346548392, -21.576634061372353, 3.176060199231026, -1.4868613118194371, -18.518595330852865, -22.881373968440816, -14.783708770336474, -25.59402154317755, -19.119131807707696, 7.137771131435326, -19.728843245131173, 10.191347240408625, -10.700932080519635, -6.701654159825734, -7.373372291537324, -0.6872048399487731, -6.296554127429614, -1.7688992783220208, -8.34123111258984, -18.56108395927148, 0.016603181030085068, -15.439060079201447, -16.318490555550593, -22.493650695597786, -8.719548359116647, 1.8837207552229742, -12.098341747155938, -20.942996821580092, -28.27720750803006, -20.616938941813316, -12.161006248164927, -0.5551646099688057, -11.91403174371305, -24.22309944633931, -20.05063971796974, -8.793506772856597, -1.0889632133073963, -9.149470217813276], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [15.373859760492703, 19.025329626704274, 7.9981623693261295, 17.297956487324804, 27.313024077925807, 10.396908678801474, 12.613014896056244, 16.488546287849374, 8.908148196918473, 25.639713448790506, 7.546503050633712, 1.3843996872178685, -3.978098221379823, 16.164279911259904, -11.822390658902485, 16.814816371186833, -14.689379981734003, 2.0627929827011204, 21.432792109301097, -5.331106306016924, 2.7434776029144565, 5.6710154649097255, 7.163682461033277, 1.542718779050853, 16.672220133083062, 16.967636335009256, 17.315192101165756, 25.028523485651906, 5.5718299743085336, 11.419539405998625, -0.527880211078702, 8.939924805241548, 9.664851692903019, 8.003456265897476, 0.19474994697356252, -3.6059803453407184, 21.40840463270215, 0.8493135077359444, -13.817747593804977, 8.084195273936581, 7.617248147131054, 9.420648432673811, -6.328875193443896, 0.6243918695977833, 12.554155875397974, 12.597131159997312, 7.9330020091698294, 17.01676844570841, 10.796259932147453, 14.41321805241001, 19.132226984338548, 1.762449291846874, -7.767276933899321, 5.042495018758416, 14.650549454133802, 0.5884814766654838, 3.5471569036206496, 4.285834965903081, 20.864277116193787, -14.803507510563627, 14.228214049129623, 22.855227966314295, -12.215496346548392, 21.576634061372356, -3.1760601992310082, 1.4868613118194371, 18.518595330852865, 22.881373968440812, 14.783708770336478, 25.594021543177547, 19.119131807707685, -7.137771131435326, 19.728843245131173, -10.191347240408625, 10.700932080519635, 6.701654159825734, 7.373372291537324, 0.6872048399487731, 6.296554127429614, 1.7688992783220208, 8.341231112589838, 18.56108395927148, -0.016603181030085068, 15.439060079201447, 16.318490555550593, 22.493650695597783, 8.719548359116647, -1.8837207552229724, 12.098341747155938, 20.94299682158009, 28.277207508030063, 20.616938941813313, 12.161006248164927, 0.5551646099688057, 11.91403174371305, 24.223099446339308, 20.050639717969744, 8.793506772856595, 1.0889632133073963, 9.149470217813276], "policy_adversary_policy_reward": [-0.19221522508031086, -30.555504295905095, -12.841124843247524, -25.209534410161044, -15.55355295941769, -0.4427717792345689, -18.391144157277278, -16.204768817372326, -35.38020076607657, -19.245847389775044, -8.048513122589682, -12.745304235013265, -12.383869571123174, -12.842160220989314, -3.1416054690088586, -29.835487106689886, -1.849336757656296, -15.96695963618065, -19.681472607906535, -31.597954289674476, -14.53409749288107, -0.5589086083863535, 8.02244368317232, -10.791243057608057, -4.451361426139243, 12.40755786889889, -9.544101458231115, -22.78445836428869, 7.328178461781896, 16.316602856023074, -21.776008666081427, -11.85362407629222, 10.562092612814283, 18.816667350653727, -8.18265949510712, 4.05707352970488, -21.341295887331675, -21.52428833127051, -0.44586413974156613, 11.108076751775414, -2.20605668754855, -3.2808985182803596, -7.759753665719753, -3.582277264099698, 7.422180217674303, -21.749545139740857, -4.332045554130982, 1.246607996029276, -23.960462131114415, -9.38397813505171, -13.132053873680793, -20.80321879633772, -8.956488371455977, -25.67389583087555, -27.44462889783878, -22.612418073465008, 3.022063573138496, -14.165723521755563, -8.438349259582012, -14.400729552415239, 0.9279724651516816, 0.12778795700572232, -13.534787634909481, -4.345061975573614, -10.340268509309745, -8.989434876496293, 3.688621310932895, -19.695533842727848, 6.679563714844157, -7.069063608791282, 3.8505883280042497, 3.361372362677187, -22.461788805372763, -20.355020460031533, -8.441733291956862, 6.743106276484973, 13.54871301939626, 14.086782168213695, 6.308573725552691, -22.476964273425857, -23.40308214184861, 8.168585847586499, -13.815486492287654, -5.025810373059969, -10.291433933897267, 22.949184320785058, -1.8002725571367435, 0.5514888179411734, -21.043316523182344, -4.064995227613604, -15.011053747115625, -10.183208572878993, -14.406546117052244, -1.459457901287415, -1.2658849782842267, -32.76765191313259, 2.6184875187117456, -24.211007383006653, -18.345159753392867, -10.481276351427155, -16.70859083331146, -21.555863135365634, -5.141881707222211, 1.6169831235284633, 11.507926144450117, 4.0266277233485255, 13.284714546930658, -23.369704584447486, -4.605091193526441, -24.696007714741157, 17.762681840101358, -18.939644793432326, -21.296183118081906, 14.201869310840607, 5.010349052555156, -13.58201898436132, -22.74882146354868, -18.979732768838897, 19.013045863421183, 10.593969157706063, -1.2410391070630808, -27.215388991196164, -22.1849151848991, -23.525540747729472, 15.235539945399857, 9.195452747696926, -17.166110423477118, -25.9871576992676, 5.753789972022748, 0.5983304264392828, 7.637889209642871, -10.611611833281746, -19.51338699238753, -17.523803669318188, -23.1613167685073, -22.601431168374326, -3.961756224453321, -25.60566131621963, -33.399896074263864, -17.78814701209124, -20.60932778360134, -17.62893583181405, 12.185247994850336, 2.0902942680203154, -16.372965540543877, -23.084720949718474, 7.654067144518137, 12.728627336299112, -10.203566330123682, -11.19829783091559, -3.121411944835149, -10.281896374816323, -4.20742951177845, -10.539315071296198, -12.034322128362398, 10.659912448464851, -7.033434751837344, -5.559673503021884, -3.38223226509907, -0.1555662915449716, -11.175488365194262, -5.506973859985415, -17.419535361614486, -19.702632556928474, -8.164759550958216, 8.197965913018386, -18.661318803153137, -12.216801355249757, -18.72942604509778, -13.907555066003404, -21.117446101035952, -23.869855290159627, 6.526380614105776, -23.96547733233907, -5.812610096774044, 9.580051607219993, -13.982855720425938, -10.213827773885939, -26.831829476885424, -15.05416416627476, -28.522938770600398, -28.0314762454597, -24.263404637450225, -16.9704732461764, -2.691049923722261, -21.630962572607594, -8.61078794939069, 7.500458729453079, -11.458840903940626, -12.369222583485474, -29.35044765328477, -19.09575123939385, -17.645225096847955, -22.456054339091533, 5.04759769626407, -22.634611241977268, -14.503067872046717, 12.325141445431925, -5.318804684055042, -12.98013575157151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4170237795642359, "mean_inference_ms": 1.095614555124262, "mean_action_processing_ms": 0.17923113826647746, "mean_env_wait_ms": 0.07257636214619842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004148960113525391, "StateBufferConnector_ms": 0.0024771690368652344, "ViewRequirementAgentConnector_ms": 0.06792700290679932}, "num_episodes": 10, "episode_return_max": 14.80350751056363, "episode_return_min": -28.27720750803006, "episode_return_mean": -9.13299693718565}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.2600058511597, "num_env_steps_trained_throughput_per_sec": 486.2600058511597, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2196000, "timers": {"training_iteration_time_ms": 8086.031, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8085.999, "sample_time_ms": 760.369, "learn_time_ms": 7312.141, "learn_throughput": 547.035, "synch_weights_time_ms": 13.006}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2196000, "num_agent_steps_trained": 2196000}, "done": false, "training_iteration": 183, "trial_id": "83a5c_00000", "date": "2024-08-10_12-39-44", "timestamp": 1723307984, "time_this_iter_s": 8.231903791427612, "time_total_s": 1544.484035730362, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fdfc5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1544.484035730362, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 28.26666666666667, "ram_util_percent": 82.79166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5461939823690547, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.389978366932541, "policy_loss": -0.010405155764054999, "vf_loss": 3.3992430864818513, "vf_explained_var": -0.007645947308767409, "kl": 0.013334410119442275, "entropy": 1.1173516870806457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.346277075074613, "cur_kl_coeff": 9.723197588870287e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.248770878712336, "policy_loss": -0.0032750557746718794, "vf_loss": 2.2520459435880182, "vf_explained_var": 0.5458313204968969, "kl": 0.0017416519885900992, "entropy": 0.31440557915096484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 176160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 15.458160898302662, "episode_reward_min": -28.27720750803006, "episode_reward_mean": -8.125002546489966, "episode_len_mean": 380.77, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 38077, "policy_reward_min": {"agent_policy": -15.458160898302662, "adversary_policy": -33.399896074263864}, "policy_reward_max": {"agent_policy": 28.277207508030063, "adversary_policy": 22.949184320785058}, "policy_reward_mean": {"agent_policy": 8.125002546489966, "adversary_policy": -8.125002546489966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.16427991125991, 11.822390658902485, -16.814816371186822, 14.689379981734001, -2.0627929827011204, -21.432792109301094, 5.331106306016924, -2.7434776029144565, -5.6710154649097255, -7.163682461033277, -1.542718779050853, -16.67222013308306, -16.967636335009256, -17.31519210116576, -25.028523485651895, -5.5718299743085336, -11.419539405998627, 0.527880211078702, -8.939924805241548, -9.664851692903019, -8.003456265897476, -0.19474994697356252, 3.6059803453407184, -21.408404632702148, -0.8493135077359444, 13.817747593804988, -8.084195273936581, -7.617248147131054, -9.420648432673811, 6.328875193443896, -0.624391869597785, -12.554155875397974, -12.59713115999731, -7.9330020091698294, -17.016768445708408, -10.796259932147453, -14.41321805241001, -19.132226984338544, -1.762449291846874, 7.767276933899321, -5.042495018758416, -14.650549454133799, -0.5884814766654838, -3.5471569036206496, -4.285834965903081, -20.86427711619379, 14.80350751056363, -14.228214049129623, -22.855227966314292, 12.215496346548392, -21.576634061372353, 3.176060199231026, -1.4868613118194371, -18.518595330852865, -22.881373968440816, -14.783708770336474, -25.59402154317755, -19.119131807707696, 7.137771131435326, -19.728843245131173, 10.191347240408625, -10.700932080519635, -6.701654159825734, -7.373372291537324, -0.6872048399487731, -6.296554127429614, -1.7688992783220208, -8.34123111258984, -18.56108395927148, 0.016603181030085068, -15.439060079201447, -16.318490555550593, -22.493650695597786, -8.719548359116647, 1.8837207552229742, -12.098341747155938, -20.942996821580092, -28.27720750803006, -20.616938941813316, -12.161006248164927, -0.5551646099688057, -11.91403174371305, -24.22309944633931, -20.05063971796974, -8.793506772856597, -1.0889632133073963, -9.149470217813276, -2.8903265911065503, 3.1482227095794784, 5.958708375902798, -10.799925707361465, -14.696542400928777, -6.854856684590414, 3.335918185728506, 15.458160898302662, -7.664838252574016, -17.791204164266944, -16.576141989905544, 3.1104680998362317, -18.945671755709057], "episode_lengths": [400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 24, 400, 400, 400, 9, 400], "policy_agent_policy_reward": [16.164279911259904, -11.822390658902485, 16.814816371186833, -14.689379981734003, 2.0627929827011204, 21.432792109301097, -5.331106306016924, 2.7434776029144565, 5.6710154649097255, 7.163682461033277, 1.542718779050853, 16.672220133083062, 16.967636335009256, 17.315192101165756, 25.028523485651906, 5.5718299743085336, 11.419539405998625, -0.527880211078702, 8.939924805241548, 9.664851692903019, 8.003456265897476, 0.19474994697356252, -3.6059803453407184, 21.40840463270215, 0.8493135077359444, -13.817747593804977, 8.084195273936581, 7.617248147131054, 9.420648432673811, -6.328875193443896, 0.6243918695977833, 12.554155875397974, 12.597131159997312, 7.9330020091698294, 17.01676844570841, 10.796259932147453, 14.41321805241001, 19.132226984338548, 1.762449291846874, -7.767276933899321, 5.042495018758416, 14.650549454133802, 0.5884814766654838, 3.5471569036206496, 4.285834965903081, 20.864277116193787, -14.803507510563627, 14.228214049129623, 22.855227966314295, -12.215496346548392, 21.576634061372356, -3.1760601992310082, 1.4868613118194371, 18.518595330852865, 22.881373968440812, 14.783708770336478, 25.594021543177547, 19.119131807707685, -7.137771131435326, 19.728843245131173, -10.191347240408625, 10.700932080519635, 6.701654159825734, 7.373372291537324, 0.6872048399487731, 6.296554127429614, 1.7688992783220208, 8.341231112589838, 18.56108395927148, -0.016603181030085068, 15.439060079201447, 16.318490555550593, 22.493650695597783, 8.719548359116647, -1.8837207552229724, 12.098341747155938, 20.94299682158009, 28.277207508030063, 20.616938941813313, 12.161006248164927, 0.5551646099688057, 11.91403174371305, 24.223099446339308, 20.050639717969744, 8.793506772856595, 1.0889632133073963, 9.149470217813276, 2.8903265911065503, -3.1482227095794784, -5.958708375902798, 10.799925707361462, 14.696542400928777, 6.854856684590414, -3.335918185728504, -15.458160898302662, 7.66483825257402, 17.791204164266947, 16.576141989905544, -3.1104680998362317, 18.94567175570904], "policy_adversary_policy_reward": [-9.544101458231115, -22.78445836428869, 7.328178461781896, 16.316602856023074, -21.776008666081427, -11.85362407629222, 10.562092612814283, 18.816667350653727, -8.18265949510712, 4.05707352970488, -21.341295887331675, -21.52428833127051, -0.44586413974156613, 11.108076751775414, -2.20605668754855, -3.2808985182803596, -7.759753665719753, -3.582277264099698, 7.422180217674303, -21.749545139740857, -4.332045554130982, 1.246607996029276, -23.960462131114415, -9.38397813505171, -13.132053873680793, -20.80321879633772, -8.956488371455977, -25.67389583087555, -27.44462889783878, -22.612418073465008, 3.022063573138496, -14.165723521755563, -8.438349259582012, -14.400729552415239, 0.9279724651516816, 0.12778795700572232, -13.534787634909481, -4.345061975573614, -10.340268509309745, -8.989434876496293, 3.688621310932895, -19.695533842727848, 6.679563714844157, -7.069063608791282, 3.8505883280042497, 3.361372362677187, -22.461788805372763, -20.355020460031533, -8.441733291956862, 6.743106276484973, 13.54871301939626, 14.086782168213695, 6.308573725552691, -22.476964273425857, -23.40308214184861, 8.168585847586499, -13.815486492287654, -5.025810373059969, -10.291433933897267, 22.949184320785058, -1.8002725571367435, 0.5514888179411734, -21.043316523182344, -4.064995227613604, -15.011053747115625, -10.183208572878993, -14.406546117052244, -1.459457901287415, -1.2658849782842267, -32.76765191313259, 2.6184875187117456, -24.211007383006653, -18.345159753392867, -10.481276351427155, -16.70859083331146, -21.555863135365634, -5.141881707222211, 1.6169831235284633, 11.507926144450117, 4.0266277233485255, 13.284714546930658, -23.369704584447486, -4.605091193526441, -24.696007714741157, 17.762681840101358, -18.939644793432326, -21.296183118081906, 14.201869310840607, 5.010349052555156, -13.58201898436132, -22.74882146354868, -18.979732768838897, 19.013045863421183, 10.593969157706063, -1.2410391070630808, -27.215388991196164, -22.1849151848991, -23.525540747729472, 15.235539945399857, 9.195452747696926, -17.166110423477118, -25.9871576992676, 5.753789972022748, 0.5983304264392828, 7.637889209642871, -10.611611833281746, -19.51338699238753, -17.523803669318188, -23.1613167685073, -22.601431168374326, -3.961756224453321, -25.60566131621963, -33.399896074263864, -17.78814701209124, -20.60932778360134, -17.62893583181405, 12.185247994850336, 2.0902942680203154, -16.372965540543877, -23.084720949718474, 7.654067144518137, 12.728627336299112, -10.203566330123682, -11.19829783091559, -3.121411944835149, -10.281896374816323, -4.20742951177845, -10.539315071296198, -12.034322128362398, 10.659912448464851, -7.033434751837344, -5.559673503021884, -3.38223226509907, -0.1555662915449716, -11.175488365194262, -5.506973859985415, -17.419535361614486, -19.702632556928474, -8.164759550958216, 8.197965913018386, -18.661318803153137, -12.216801355249757, -18.72942604509778, -13.907555066003404, -21.117446101035952, -23.869855290159627, 6.526380614105776, -23.96547733233907, -5.812610096774044, 9.580051607219993, -13.982855720425938, -10.213827773885939, -26.831829476885424, -15.05416416627476, -28.522938770600398, -28.0314762454597, -24.263404637450225, -16.9704732461764, -2.691049923722261, -21.630962572607594, -8.61078794939069, 7.500458729453079, -11.458840903940626, -12.369222583485474, -29.35044765328477, -19.09575123939385, -17.645225096847955, -22.456054339091533, 5.04759769626407, -22.634611241977268, -14.503067872046717, 12.325141445431925, -5.318804684055042, -12.98013575157151, -25.60460595987584, 19.82395277766274, 19.104700594966772, -12.808255175807815, 3.1677880322177643, 8.749628719587832, -7.958525128185391, -13.641326286537538, -9.103008966218717, -20.290075835638838, -6.020285004548153, -7.6894283646326755, -4.995443704746464, 11.667280076203475, 21.006433481383365, 9.909888315221963, -11.207398472894052, -4.122278032253988, -19.687599181676312, -15.894809146857583, -25.864023740918817, -7.288260238892274, 3.8910180507269825, 2.329918148945481, -30.022371461284436, -7.868972050133664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41662728147289063, "mean_inference_ms": 1.094701108849652, "mean_action_processing_ms": 0.17917297096781198, "mean_env_wait_ms": 0.07251979133075741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004041194915771484, "StateBufferConnector_ms": 0.002420186996459961, "ViewRequirementAgentConnector_ms": 0.06578290462493896}, "num_episodes": 13, "episode_return_max": 15.458160898302662, "episode_return_min": -28.27720750803006, "episode_return_mean": -8.125002546489966}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 480.76467449581537, "num_env_steps_trained_throughput_per_sec": 480.76467449581537, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 8096.032, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8096.0, "sample_time_ms": 751.434, "learn_time_ms": 7331.476, "learn_throughput": 545.593, "synch_weights_time_ms": 12.609}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 184, "trial_id": "83a5c_00000", "date": "2024-08-10_12-39-52", "timestamp": 1723307992, "time_this_iter_s": 8.32433795928955, "time_total_s": 1552.8083736896515, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fdeb160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1552.8083736896515, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 28.458333333333332, "ram_util_percent": 83.24166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.551002235135073, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8557372617343115, "policy_loss": -0.007258498212618251, "vf_loss": 2.862251656206827, "vf_explained_var": -0.06642508137793768, "kl": 0.008700421870801297, "entropy": 1.1593985703887133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.7170417676369345, "cur_kl_coeff": 4.8615987944351434e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.343316822126508, "policy_loss": -0.0056252503464444695, "vf_loss": 2.3489420683433613, "vf_explained_var": 0.5792030343165, "kl": 0.003826514554045938, "entropy": 0.2760855453709761, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 177120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "env_runners": {"episode_reward_max": 15.458160898302662, "episode_reward_min": -29.12415392997981, "episode_reward_mean": -9.044432793309618, "episode_len_mean": 380.6, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 38060, "policy_reward_min": {"agent_policy": -15.458160898302662, "adversary_policy": -39.35374950071296}, "policy_reward_max": {"agent_policy": 29.124153929979805, "adversary_policy": 22.949184320785058}, "policy_reward_mean": {"agent_policy": 9.044432793309618, "adversary_policy": -9.044432793309616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.67222013308306, -16.967636335009256, -17.31519210116576, -25.028523485651895, -5.5718299743085336, -11.419539405998627, 0.527880211078702, -8.939924805241548, -9.664851692903019, -8.003456265897476, -0.19474994697356252, 3.6059803453407184, -21.408404632702148, -0.8493135077359444, 13.817747593804988, -8.084195273936581, -7.617248147131054, -9.420648432673811, 6.328875193443896, -0.624391869597785, -12.554155875397974, -12.59713115999731, -7.9330020091698294, -17.016768445708408, -10.796259932147453, -14.41321805241001, -19.132226984338544, -1.762449291846874, 7.767276933899321, -5.042495018758416, -14.650549454133799, -0.5884814766654838, -3.5471569036206496, -4.285834965903081, -20.86427711619379, 14.80350751056363, -14.228214049129623, -22.855227966314292, 12.215496346548392, -21.576634061372353, 3.176060199231026, -1.4868613118194371, -18.518595330852865, -22.881373968440816, -14.783708770336474, -25.59402154317755, -19.119131807707696, 7.137771131435326, -19.728843245131173, 10.191347240408625, -10.700932080519635, -6.701654159825734, -7.373372291537324, -0.6872048399487731, -6.296554127429614, -1.7688992783220208, -8.34123111258984, -18.56108395927148, 0.016603181030085068, -15.439060079201447, -16.318490555550593, -22.493650695597786, -8.719548359116647, 1.8837207552229742, -12.098341747155938, -20.942996821580092, -28.27720750803006, -20.616938941813316, -12.161006248164927, -0.5551646099688057, -11.91403174371305, -24.22309944633931, -20.05063971796974, -8.793506772856597, -1.0889632133073963, -9.149470217813276, -2.8903265911065503, 3.1482227095794784, 5.958708375902798, -10.799925707361465, -14.696542400928777, -6.854856684590414, 3.335918185728506, 15.458160898302662, -7.664838252574016, -17.791204164266944, -16.576141989905544, 3.1104680998362317, -18.945671755709057, -4.299090155360346, -6.723167241159841, -12.877781904681449, -29.12415392997981, 0.8226323023409563, -18.01248582599783, -10.04062305244571, -20.274406386581738, 6.324876704427792, -20.516732864976188, -18.974791063254546], "episode_lengths": [400, 400, 400, 400, 400, 400, 1, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 24, 400, 400, 400, 9, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400], "policy_agent_policy_reward": [16.672220133083062, 16.967636335009256, 17.315192101165756, 25.028523485651906, 5.5718299743085336, 11.419539405998625, -0.527880211078702, 8.939924805241548, 9.664851692903019, 8.003456265897476, 0.19474994697356252, -3.6059803453407184, 21.40840463270215, 0.8493135077359444, -13.817747593804977, 8.084195273936581, 7.617248147131054, 9.420648432673811, -6.328875193443896, 0.6243918695977833, 12.554155875397974, 12.597131159997312, 7.9330020091698294, 17.01676844570841, 10.796259932147453, 14.41321805241001, 19.132226984338548, 1.762449291846874, -7.767276933899321, 5.042495018758416, 14.650549454133802, 0.5884814766654838, 3.5471569036206496, 4.285834965903081, 20.864277116193787, -14.803507510563627, 14.228214049129623, 22.855227966314295, -12.215496346548392, 21.576634061372356, -3.1760601992310082, 1.4868613118194371, 18.518595330852865, 22.881373968440812, 14.783708770336478, 25.594021543177547, 19.119131807707685, -7.137771131435326, 19.728843245131173, -10.191347240408625, 10.700932080519635, 6.701654159825734, 7.373372291537324, 0.6872048399487731, 6.296554127429614, 1.7688992783220208, 8.341231112589838, 18.56108395927148, -0.016603181030085068, 15.439060079201447, 16.318490555550593, 22.493650695597783, 8.719548359116647, -1.8837207552229724, 12.098341747155938, 20.94299682158009, 28.277207508030063, 20.616938941813313, 12.161006248164927, 0.5551646099688057, 11.91403174371305, 24.223099446339308, 20.050639717969744, 8.793506772856595, 1.0889632133073963, 9.149470217813276, 2.8903265911065503, -3.1482227095794784, -5.958708375902798, 10.799925707361462, 14.696542400928777, 6.854856684590414, -3.335918185728504, -15.458160898302662, 7.66483825257402, 17.791204164266947, 16.576141989905544, -3.1104680998362317, 18.94567175570904, 4.299090155360348, 6.723167241159841, 12.877781904681449, 29.124153929979805, -0.8226323023409563, 18.01248582599783, 10.04062305244571, 20.274406386581735, -6.3248767044277905, 20.51673286497619, 18.974791063254546], "policy_adversary_policy_reward": [-23.960462131114415, -9.38397813505171, -13.132053873680793, -20.80321879633772, -8.956488371455977, -25.67389583087555, -27.44462889783878, -22.612418073465008, 3.022063573138496, -14.165723521755563, -8.438349259582012, -14.400729552415239, 0.9279724651516816, 0.12778795700572232, -13.534787634909481, -4.345061975573614, -10.340268509309745, -8.989434876496293, 3.688621310932895, -19.695533842727848, 6.679563714844157, -7.069063608791282, 3.8505883280042497, 3.361372362677187, -22.461788805372763, -20.355020460031533, -8.441733291956862, 6.743106276484973, 13.54871301939626, 14.086782168213695, 6.308573725552691, -22.476964273425857, -23.40308214184861, 8.168585847586499, -13.815486492287654, -5.025810373059969, -10.291433933897267, 22.949184320785058, -1.8002725571367435, 0.5514888179411734, -21.043316523182344, -4.064995227613604, -15.011053747115625, -10.183208572878993, -14.406546117052244, -1.459457901287415, -1.2658849782842267, -32.76765191313259, 2.6184875187117456, -24.211007383006653, -18.345159753392867, -10.481276351427155, -16.70859083331146, -21.555863135365634, -5.141881707222211, 1.6169831235284633, 11.507926144450117, 4.0266277233485255, 13.284714546930658, -23.369704584447486, -4.605091193526441, -24.696007714741157, 17.762681840101358, -18.939644793432326, -21.296183118081906, 14.201869310840607, 5.010349052555156, -13.58201898436132, -22.74882146354868, -18.979732768838897, 19.013045863421183, 10.593969157706063, -1.2410391070630808, -27.215388991196164, -22.1849151848991, -23.525540747729472, 15.235539945399857, 9.195452747696926, -17.166110423477118, -25.9871576992676, 5.753789972022748, 0.5983304264392828, 7.637889209642871, -10.611611833281746, -19.51338699238753, -17.523803669318188, -23.1613167685073, -22.601431168374326, -3.961756224453321, -25.60566131621963, -33.399896074263864, -17.78814701209124, -20.60932778360134, -17.62893583181405, 12.185247994850336, 2.0902942680203154, -16.372965540543877, -23.084720949718474, 7.654067144518137, 12.728627336299112, -10.203566330123682, -11.19829783091559, -3.121411944835149, -10.281896374816323, -4.20742951177845, -10.539315071296198, -12.034322128362398, 10.659912448464851, -7.033434751837344, -5.559673503021884, -3.38223226509907, -0.1555662915449716, -11.175488365194262, -5.506973859985415, -17.419535361614486, -19.702632556928474, -8.164759550958216, 8.197965913018386, -18.661318803153137, -12.216801355249757, -18.72942604509778, -13.907555066003404, -21.117446101035952, -23.869855290159627, 6.526380614105776, -23.96547733233907, -5.812610096774044, 9.580051607219993, -13.982855720425938, -10.213827773885939, -26.831829476885424, -15.05416416627476, -28.522938770600398, -28.0314762454597, -24.263404637450225, -16.9704732461764, -2.691049923722261, -21.630962572607594, -8.61078794939069, 7.500458729453079, -11.458840903940626, -12.369222583485474, -29.35044765328477, -19.09575123939385, -17.645225096847955, -22.456054339091533, 5.04759769626407, -22.634611241977268, -14.503067872046717, 12.325141445431925, -5.318804684055042, -12.98013575157151, -25.60460595987584, 19.82395277766274, 19.104700594966772, -12.808255175807815, 3.1677880322177643, 8.749628719587832, -7.958525128185391, -13.641326286537538, -9.103008966218717, -20.290075835638838, -6.020285004548153, -7.6894283646326755, -4.995443704746464, 11.667280076203475, 21.006433481383365, 9.909888315221963, -11.207398472894052, -4.122278032253988, -19.687599181676312, -15.894809146857583, -25.864023740918817, -7.288260238892274, 3.8910180507269825, 2.329918148945481, -30.022371461284436, -7.868972050133664, 5.143125693770408, -13.741306004491104, 7.99225014528718, -21.43858462760686, -27.361052457408054, 1.605488648045153, -18.894558359246666, -39.35374950071296, 13.16740213959811, -11.522137534916197, -11.74392632328426, -24.281045328711407, -7.812863014383211, -12.268383090508209, -25.647974780960602, -14.900837992202874, 9.94376259914424, 2.705990809711343, -29.541469348921524, -11.491996381030866, -17.918414444656698, -20.0311676818524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41639794996656, "mean_inference_ms": 1.0937611903333404, "mean_action_processing_ms": 0.17906958772341344, "mean_env_wait_ms": 0.07245286381841219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004113912582397461, "StateBufferConnector_ms": 0.002481222152709961, "ViewRequirementAgentConnector_ms": 0.06435561180114746}, "num_episodes": 11, "episode_return_max": 15.458160898302662, "episode_return_min": -29.12415392997981, "episode_return_mean": -9.044432793309618}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 503.46312874013944, "num_env_steps_trained_throughput_per_sec": 503.46312874013944, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2220000, "timers": {"training_iteration_time_ms": 8093.956, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8093.923, "sample_time_ms": 749.771, "learn_time_ms": 7330.682, "learn_throughput": 545.652, "synch_weights_time_ms": 12.903}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2220000, "num_agent_steps_trained": 2220000}, "done": false, "training_iteration": 185, "trial_id": "83a5c_00000", "date": "2024-08-10_12-40-00", "timestamp": 1723308000, "time_this_iter_s": 7.95002818107605, "time_total_s": 1560.7584018707275, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fdfcd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1560.7584018707275, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 29.509090909090915, "ram_util_percent": 83.16363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.147447197021, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9608493835837755, "policy_loss": -0.006316418690784346, "vf_loss": 2.966471722895506, "vf_explained_var": -0.02423896007436924, "kl": 0.008115407787710874, "entropy": 1.1272842260895584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.547429061122239, "cur_kl_coeff": 2.4307993972175717e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7593978231151897, "policy_loss": -0.006900555740382212, "vf_loss": 2.766298376644651, "vf_explained_var": 0.5235632861653964, "kl": 0.005945460496240614, "entropy": 0.28424462568946185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 178080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "env_runners": {"episode_reward_max": 15.458160898302662, "episode_reward_min": -29.12415392997981, "episode_reward_mean": -8.381336558287282, "episode_len_mean": 376.73, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 37673, "policy_reward_min": {"agent_policy": -15.458160898302662, "adversary_policy": -39.35374950071296}, "policy_reward_max": {"agent_policy": 29.124153929979805, "adversary_policy": 22.949184320785058}, "policy_reward_mean": {"agent_policy": 8.381336558287282, "adversary_policy": -8.381336558287282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.408404632702148, -0.8493135077359444, 13.817747593804988, -8.084195273936581, -7.617248147131054, -9.420648432673811, 6.328875193443896, -0.624391869597785, -12.554155875397974, -12.59713115999731, -7.9330020091698294, -17.016768445708408, -10.796259932147453, -14.41321805241001, -19.132226984338544, -1.762449291846874, 7.767276933899321, -5.042495018758416, -14.650549454133799, -0.5884814766654838, -3.5471569036206496, -4.285834965903081, -20.86427711619379, 14.80350751056363, -14.228214049129623, -22.855227966314292, 12.215496346548392, -21.576634061372353, 3.176060199231026, -1.4868613118194371, -18.518595330852865, -22.881373968440816, -14.783708770336474, -25.59402154317755, -19.119131807707696, 7.137771131435326, -19.728843245131173, 10.191347240408625, -10.700932080519635, -6.701654159825734, -7.373372291537324, -0.6872048399487731, -6.296554127429614, -1.7688992783220208, -8.34123111258984, -18.56108395927148, 0.016603181030085068, -15.439060079201447, -16.318490555550593, -22.493650695597786, -8.719548359116647, 1.8837207552229742, -12.098341747155938, -20.942996821580092, -28.27720750803006, -20.616938941813316, -12.161006248164927, -0.5551646099688057, -11.91403174371305, -24.22309944633931, -20.05063971796974, -8.793506772856597, -1.0889632133073963, -9.149470217813276, -2.8903265911065503, 3.1482227095794784, 5.958708375902798, -10.799925707361465, -14.696542400928777, -6.854856684590414, 3.335918185728506, 15.458160898302662, -7.664838252574016, -17.791204164266944, -16.576141989905544, 3.1104680998362317, -18.945671755709057, -4.299090155360346, -6.723167241159841, -12.877781904681449, -29.12415392997981, 0.8226323023409563, -18.01248582599783, -10.04062305244571, -20.274406386581738, 6.324876704427792, -20.516732864976188, -18.974791063254546, 14.843260653440254, 9.904684787206133, -5.271467609907761, -0.683389818095155, -12.614027785534677, 3.9904467071066403, -18.546571212632557, -9.325570357852463, -14.66463378673117, -5.134585609151522, -8.525944762263364, -3.3066412931644056], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 24, 400, 400, 400, 9, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 7, 400, 7, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [21.40840463270215, 0.8493135077359444, -13.817747593804977, 8.084195273936581, 7.617248147131054, 9.420648432673811, -6.328875193443896, 0.6243918695977833, 12.554155875397974, 12.597131159997312, 7.9330020091698294, 17.01676844570841, 10.796259932147453, 14.41321805241001, 19.132226984338548, 1.762449291846874, -7.767276933899321, 5.042495018758416, 14.650549454133802, 0.5884814766654838, 3.5471569036206496, 4.285834965903081, 20.864277116193787, -14.803507510563627, 14.228214049129623, 22.855227966314295, -12.215496346548392, 21.576634061372356, -3.1760601992310082, 1.4868613118194371, 18.518595330852865, 22.881373968440812, 14.783708770336478, 25.594021543177547, 19.119131807707685, -7.137771131435326, 19.728843245131173, -10.191347240408625, 10.700932080519635, 6.701654159825734, 7.373372291537324, 0.6872048399487731, 6.296554127429614, 1.7688992783220208, 8.341231112589838, 18.56108395927148, -0.016603181030085068, 15.439060079201447, 16.318490555550593, 22.493650695597783, 8.719548359116647, -1.8837207552229724, 12.098341747155938, 20.94299682158009, 28.277207508030063, 20.616938941813313, 12.161006248164927, 0.5551646099688057, 11.91403174371305, 24.223099446339308, 20.050639717969744, 8.793506772856595, 1.0889632133073963, 9.149470217813276, 2.8903265911065503, -3.1482227095794784, -5.958708375902798, 10.799925707361462, 14.696542400928777, 6.854856684590414, -3.335918185728504, -15.458160898302662, 7.66483825257402, 17.791204164266947, 16.576141989905544, -3.1104680998362317, 18.94567175570904, 4.299090155360348, 6.723167241159841, 12.877781904681449, 29.124153929979805, -0.8226323023409563, 18.01248582599783, 10.04062305244571, 20.274406386581735, -6.3248767044277905, 20.51673286497619, 18.974791063254546, -14.843260653440254, -9.90468478720614, 5.271467609907761, 0.6833898180951551, 12.614027785534681, -3.99044670710664, 18.54657121263255, 9.325570357852463, 14.664633786731173, 5.13458560915152, 8.525944762263364, 3.3066412931644074], "policy_adversary_policy_reward": [-22.461788805372763, -20.355020460031533, -8.441733291956862, 6.743106276484973, 13.54871301939626, 14.086782168213695, 6.308573725552691, -22.476964273425857, -23.40308214184861, 8.168585847586499, -13.815486492287654, -5.025810373059969, -10.291433933897267, 22.949184320785058, -1.8002725571367435, 0.5514888179411734, -21.043316523182344, -4.064995227613604, -15.011053747115625, -10.183208572878993, -14.406546117052244, -1.459457901287415, -1.2658849782842267, -32.76765191313259, 2.6184875187117456, -24.211007383006653, -18.345159753392867, -10.481276351427155, -16.70859083331146, -21.555863135365634, -5.141881707222211, 1.6169831235284633, 11.507926144450117, 4.0266277233485255, 13.284714546930658, -23.369704584447486, -4.605091193526441, -24.696007714741157, 17.762681840101358, -18.939644793432326, -21.296183118081906, 14.201869310840607, 5.010349052555156, -13.58201898436132, -22.74882146354868, -18.979732768838897, 19.013045863421183, 10.593969157706063, -1.2410391070630808, -27.215388991196164, -22.1849151848991, -23.525540747729472, 15.235539945399857, 9.195452747696926, -17.166110423477118, -25.9871576992676, 5.753789972022748, 0.5983304264392828, 7.637889209642871, -10.611611833281746, -19.51338699238753, -17.523803669318188, -23.1613167685073, -22.601431168374326, -3.961756224453321, -25.60566131621963, -33.399896074263864, -17.78814701209124, -20.60932778360134, -17.62893583181405, 12.185247994850336, 2.0902942680203154, -16.372965540543877, -23.084720949718474, 7.654067144518137, 12.728627336299112, -10.203566330123682, -11.19829783091559, -3.121411944835149, -10.281896374816323, -4.20742951177845, -10.539315071296198, -12.034322128362398, 10.659912448464851, -7.033434751837344, -5.559673503021884, -3.38223226509907, -0.1555662915449716, -11.175488365194262, -5.506973859985415, -17.419535361614486, -19.702632556928474, -8.164759550958216, 8.197965913018386, -18.661318803153137, -12.216801355249757, -18.72942604509778, -13.907555066003404, -21.117446101035952, -23.869855290159627, 6.526380614105776, -23.96547733233907, -5.812610096774044, 9.580051607219993, -13.982855720425938, -10.213827773885939, -26.831829476885424, -15.05416416627476, -28.522938770600398, -28.0314762454597, -24.263404637450225, -16.9704732461764, -2.691049923722261, -21.630962572607594, -8.61078794939069, 7.500458729453079, -11.458840903940626, -12.369222583485474, -29.35044765328477, -19.09575123939385, -17.645225096847955, -22.456054339091533, 5.04759769626407, -22.634611241977268, -14.503067872046717, 12.325141445431925, -5.318804684055042, -12.98013575157151, -25.60460595987584, 19.82395277766274, 19.104700594966772, -12.808255175807815, 3.1677880322177643, 8.749628719587832, -7.958525128185391, -13.641326286537538, -9.103008966218717, -20.290075835638838, -6.020285004548153, -7.6894283646326755, -4.995443704746464, 11.667280076203475, 21.006433481383365, 9.909888315221963, -11.207398472894052, -4.122278032253988, -19.687599181676312, -15.894809146857583, -25.864023740918817, -7.288260238892274, 3.8910180507269825, 2.329918148945481, -30.022371461284436, -7.868972050133664, 5.143125693770408, -13.741306004491104, 7.99225014528718, -21.43858462760686, -27.361052457408054, 1.605488648045153, -18.894558359246666, -39.35374950071296, 13.16740213959811, -11.522137534916197, -11.74392632328426, -24.281045328711407, -7.812863014383211, -12.268383090508209, -25.647974780960602, -14.900837992202874, 9.94376259914424, 2.705990809711343, -29.541469348921524, -11.491996381030866, -17.918414444656698, -20.0311676818524, 8.466229925925447, 21.22029138095506, 4.346858986256507, 15.462510588155773, -0.16155458064869777, -10.381380639166824, -8.114362217919698, 6.747582581729388, -18.334073286346023, -6.893982284723336, 0.3995670952180177, 7.581326318995262, -16.086811686424493, -21.006330738840617, -25.226854383750315, 6.575713668045388, -26.562108901189582, -2.767158672272757, -2.928272510916507, -7.340898707386536, 5.30788073913989, -22.35977026366662, -7.333557165837917, 0.720274579509109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4161951927809986, "mean_inference_ms": 1.0927953984972694, "mean_action_processing_ms": 0.17891774628209764, "mean_env_wait_ms": 0.0723606491597816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004121184349060059, "StateBufferConnector_ms": 0.0024759769439697266, "ViewRequirementAgentConnector_ms": 0.06332993507385254}, "num_episodes": 12, "episode_return_max": 15.458160898302662, "episode_return_min": -29.12415392997981, "episode_return_mean": -8.381336558287282}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 507.93546223681517, "num_env_steps_trained_throughput_per_sec": 507.93546223681517, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2232000, "timers": {"training_iteration_time_ms": 8100.246, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8100.213, "sample_time_ms": 751.64, "learn_time_ms": 7335.234, "learn_throughput": 545.313, "synch_weights_time_ms": 12.771}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "done": false, "training_iteration": 186, "trial_id": "83a5c_00000", "date": "2024-08-10_12-40-08", "timestamp": 1723308008, "time_this_iter_s": 7.878971099853516, "time_total_s": 1568.637372970581, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fdfc790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1568.637372970581, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 26.200000000000003, "ram_util_percent": 83.1909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1458713866415478, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.11251401011906, "policy_loss": -0.008170122385552281, "vf_loss": 3.119910462129684, "vf_explained_var": -0.1767547812411394, "kl": 0.009046019032282112, "entropy": 1.077515822680539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.613980994746089, "cur_kl_coeff": 2.4307993972175717e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.433629493539532, "policy_loss": -0.0044999290294072125, "vf_loss": 2.4381294236828883, "vf_explained_var": 0.6375980150575439, "kl": 0.003392474268008816, "entropy": 0.24158483395973843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 179040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "env_runners": {"episode_reward_max": 15.458160898302662, "episode_reward_min": -29.12415392997981, "episode_reward_mean": -8.618157195931948, "episode_len_mean": 376.73, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37673, "policy_reward_min": {"agent_policy": -15.458160898302662, "adversary_policy": -39.35374950071296}, "policy_reward_max": {"agent_policy": 29.124153929979805, "adversary_policy": 21.22029138095506}, "policy_reward_mean": {"agent_policy": 8.618157195931948, "adversary_policy": -8.618157195931948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.59713115999731, -7.9330020091698294, -17.016768445708408, -10.796259932147453, -14.41321805241001, -19.132226984338544, -1.762449291846874, 7.767276933899321, -5.042495018758416, -14.650549454133799, -0.5884814766654838, -3.5471569036206496, -4.285834965903081, -20.86427711619379, 14.80350751056363, -14.228214049129623, -22.855227966314292, 12.215496346548392, -21.576634061372353, 3.176060199231026, -1.4868613118194371, -18.518595330852865, -22.881373968440816, -14.783708770336474, -25.59402154317755, -19.119131807707696, 7.137771131435326, -19.728843245131173, 10.191347240408625, -10.700932080519635, -6.701654159825734, -7.373372291537324, -0.6872048399487731, -6.296554127429614, -1.7688992783220208, -8.34123111258984, -18.56108395927148, 0.016603181030085068, -15.439060079201447, -16.318490555550593, -22.493650695597786, -8.719548359116647, 1.8837207552229742, -12.098341747155938, -20.942996821580092, -28.27720750803006, -20.616938941813316, -12.161006248164927, -0.5551646099688057, -11.91403174371305, -24.22309944633931, -20.05063971796974, -8.793506772856597, -1.0889632133073963, -9.149470217813276, -2.8903265911065503, 3.1482227095794784, 5.958708375902798, -10.799925707361465, -14.696542400928777, -6.854856684590414, 3.335918185728506, 15.458160898302662, -7.664838252574016, -17.791204164266944, -16.576141989905544, 3.1104680998362317, -18.945671755709057, -4.299090155360346, -6.723167241159841, -12.877781904681449, -29.12415392997981, 0.8226323023409563, -18.01248582599783, -10.04062305244571, -20.274406386581738, 6.324876704427792, -20.516732864976188, -18.974791063254546, 14.843260653440254, 9.904684787206133, -5.271467609907761, -0.683389818095155, -12.614027785534677, 3.9904467071066403, -18.546571212632557, -9.325570357852463, -14.66463378673117, -5.134585609151522, -8.525944762263364, -3.3066412931644056, 4.828815550738188, -8.45111464216735, -20.86722588999736, -24.472523855673394, 5.151723163874578, -0.4621817976957381, -4.380252448978888, -3.545322501784865, -11.895716294708064], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 24, 400, 400, 400, 9, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 7, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [12.597131159997312, 7.9330020091698294, 17.01676844570841, 10.796259932147453, 14.41321805241001, 19.132226984338548, 1.762449291846874, -7.767276933899321, 5.042495018758416, 14.650549454133802, 0.5884814766654838, 3.5471569036206496, 4.285834965903081, 20.864277116193787, -14.803507510563627, 14.228214049129623, 22.855227966314295, -12.215496346548392, 21.576634061372356, -3.1760601992310082, 1.4868613118194371, 18.518595330852865, 22.881373968440812, 14.783708770336478, 25.594021543177547, 19.119131807707685, -7.137771131435326, 19.728843245131173, -10.191347240408625, 10.700932080519635, 6.701654159825734, 7.373372291537324, 0.6872048399487731, 6.296554127429614, 1.7688992783220208, 8.341231112589838, 18.56108395927148, -0.016603181030085068, 15.439060079201447, 16.318490555550593, 22.493650695597783, 8.719548359116647, -1.8837207552229724, 12.098341747155938, 20.94299682158009, 28.277207508030063, 20.616938941813313, 12.161006248164927, 0.5551646099688057, 11.91403174371305, 24.223099446339308, 20.050639717969744, 8.793506772856595, 1.0889632133073963, 9.149470217813276, 2.8903265911065503, -3.1482227095794784, -5.958708375902798, 10.799925707361462, 14.696542400928777, 6.854856684590414, -3.335918185728504, -15.458160898302662, 7.66483825257402, 17.791204164266947, 16.576141989905544, -3.1104680998362317, 18.94567175570904, 4.299090155360348, 6.723167241159841, 12.877781904681449, 29.124153929979805, -0.8226323023409563, 18.01248582599783, 10.04062305244571, 20.274406386581735, -6.3248767044277905, 20.51673286497619, 18.974791063254546, -14.843260653440254, -9.90468478720614, 5.271467609907761, 0.6833898180951551, 12.614027785534681, -3.99044670710664, 18.54657121263255, 9.325570357852463, 14.664633786731173, 5.13458560915152, 8.525944762263364, 3.3066412931644074, -4.828815550738188, 8.45111464216735, 20.867225889997357, 24.472523855673398, -5.151723163874578, 0.4621817976957381, 4.380252448978888, 3.545322501784865, 11.895716294708064], "policy_adversary_policy_reward": [-15.011053747115625, -10.183208572878993, -14.406546117052244, -1.459457901287415, -1.2658849782842267, -32.76765191313259, 2.6184875187117456, -24.211007383006653, -18.345159753392867, -10.481276351427155, -16.70859083331146, -21.555863135365634, -5.141881707222211, 1.6169831235284633, 11.507926144450117, 4.0266277233485255, 13.284714546930658, -23.369704584447486, -4.605091193526441, -24.696007714741157, 17.762681840101358, -18.939644793432326, -21.296183118081906, 14.201869310840607, 5.010349052555156, -13.58201898436132, -22.74882146354868, -18.979732768838897, 19.013045863421183, 10.593969157706063, -1.2410391070630808, -27.215388991196164, -22.1849151848991, -23.525540747729472, 15.235539945399857, 9.195452747696926, -17.166110423477118, -25.9871576992676, 5.753789972022748, 0.5983304264392828, 7.637889209642871, -10.611611833281746, -19.51338699238753, -17.523803669318188, -23.1613167685073, -22.601431168374326, -3.961756224453321, -25.60566131621963, -33.399896074263864, -17.78814701209124, -20.60932778360134, -17.62893583181405, 12.185247994850336, 2.0902942680203154, -16.372965540543877, -23.084720949718474, 7.654067144518137, 12.728627336299112, -10.203566330123682, -11.19829783091559, -3.121411944835149, -10.281896374816323, -4.20742951177845, -10.539315071296198, -12.034322128362398, 10.659912448464851, -7.033434751837344, -5.559673503021884, -3.38223226509907, -0.1555662915449716, -11.175488365194262, -5.506973859985415, -17.419535361614486, -19.702632556928474, -8.164759550958216, 8.197965913018386, -18.661318803153137, -12.216801355249757, -18.72942604509778, -13.907555066003404, -21.117446101035952, -23.869855290159627, 6.526380614105776, -23.96547733233907, -5.812610096774044, 9.580051607219993, -13.982855720425938, -10.213827773885939, -26.831829476885424, -15.05416416627476, -28.522938770600398, -28.0314762454597, -24.263404637450225, -16.9704732461764, -2.691049923722261, -21.630962572607594, -8.61078794939069, 7.500458729453079, -11.458840903940626, -12.369222583485474, -29.35044765328477, -19.09575123939385, -17.645225096847955, -22.456054339091533, 5.04759769626407, -22.634611241977268, -14.503067872046717, 12.325141445431925, -5.318804684055042, -12.98013575157151, -25.60460595987584, 19.82395277766274, 19.104700594966772, -12.808255175807815, 3.1677880322177643, 8.749628719587832, -7.958525128185391, -13.641326286537538, -9.103008966218717, -20.290075835638838, -6.020285004548153, -7.6894283646326755, -4.995443704746464, 11.667280076203475, 21.006433481383365, 9.909888315221963, -11.207398472894052, -4.122278032253988, -19.687599181676312, -15.894809146857583, -25.864023740918817, -7.288260238892274, 3.8910180507269825, 2.329918148945481, -30.022371461284436, -7.868972050133664, 5.143125693770408, -13.741306004491104, 7.99225014528718, -21.43858462760686, -27.361052457408054, 1.605488648045153, -18.894558359246666, -39.35374950071296, 13.16740213959811, -11.522137534916197, -11.74392632328426, -24.281045328711407, -7.812863014383211, -12.268383090508209, -25.647974780960602, -14.900837992202874, 9.94376259914424, 2.705990809711343, -29.541469348921524, -11.491996381030866, -17.918414444656698, -20.0311676818524, 8.466229925925447, 21.22029138095506, 4.346858986256507, 15.462510588155773, -0.16155458064869777, -10.381380639166824, -8.114362217919698, 6.747582581729388, -18.334073286346023, -6.893982284723336, 0.3995670952180177, 7.581326318995262, -16.086811686424493, -21.006330738840617, -25.226854383750315, 6.575713668045388, -26.562108901189582, -2.767158672272757, -2.928272510916507, -7.340898707386536, 5.30788073913989, -22.35977026366662, -7.333557165837917, 0.720274579509109, 6.616800943848617, 3.0408301576277594, -14.309162048334713, -2.593067235999989, -28.419164393770238, -13.31528738622448, -13.856669534327587, -35.0883781770192, 4.476725273364643, 5.826721054384514, -3.450671912906543, 2.526308317515067, -13.165599719255031, 4.405094821297254, 6.383265302531996, -13.473910306101725, -0.9073764404763196, -22.88405614893981]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4159884630177582, "mean_inference_ms": 1.0921513517862496, "mean_action_processing_ms": 0.17883326054655313, "mean_env_wait_ms": 0.07230825684664399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004142045974731445, "StateBufferConnector_ms": 0.0024678707122802734, "ViewRequirementAgentConnector_ms": 0.06320488452911377}, "num_episodes": 9, "episode_return_max": 15.458160898302662, "episode_return_min": -29.12415392997981, "episode_return_mean": -8.618157195931948}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 510.93223146939016, "num_env_steps_trained_throughput_per_sec": 510.93223146939016, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2244000, "timers": {"training_iteration_time_ms": 8068.205, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8068.173, "sample_time_ms": 752.421, "learn_time_ms": 7302.456, "learn_throughput": 547.761, "synch_weights_time_ms": 12.768}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2244000, "num_agent_steps_trained": 2244000}, "done": false, "training_iteration": 187, "trial_id": "83a5c_00000", "date": "2024-08-10_12-40-16", "timestamp": 1723308016, "time_this_iter_s": 7.83415675163269, "time_total_s": 1576.4715297222137, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fdeb4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1576.4715297222137, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 25.62727272727273, "ram_util_percent": 83.0909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.102189172733398, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.781196966436174, "policy_loss": -0.006863364116066978, "vf_loss": 2.7871815040628745, "vf_explained_var": 0.05576294055060735, "kl": 0.010275471392633751, "entropy": 1.0487115225463948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.409691061700384, "cur_kl_coeff": 1.2153996986087859e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0329066562776763, "policy_loss": -0.005701950184205392, "vf_loss": 2.038608606904745, "vf_explained_var": 0.5671341715380549, "kl": 0.0040732880735734, "entropy": 0.2412219272305568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 15.458160898302662, "episode_reward_min": -29.12415392997981, "episode_reward_mean": -8.659609100264856, "episode_len_mean": 372.76, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37276, "policy_reward_min": {"agent_policy": -15.458160898302662, "adversary_policy": -39.35374950071296}, "policy_reward_max": {"agent_policy": 29.124153929979805, "adversary_policy": 21.22029138095506}, "policy_reward_mean": {"agent_policy": 8.659609100264856, "adversary_policy": -8.659609100264856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.5884814766654838, -3.5471569036206496, -4.285834965903081, -20.86427711619379, 14.80350751056363, -14.228214049129623, -22.855227966314292, 12.215496346548392, -21.576634061372353, 3.176060199231026, -1.4868613118194371, -18.518595330852865, -22.881373968440816, -14.783708770336474, -25.59402154317755, -19.119131807707696, 7.137771131435326, -19.728843245131173, 10.191347240408625, -10.700932080519635, -6.701654159825734, -7.373372291537324, -0.6872048399487731, -6.296554127429614, -1.7688992783220208, -8.34123111258984, -18.56108395927148, 0.016603181030085068, -15.439060079201447, -16.318490555550593, -22.493650695597786, -8.719548359116647, 1.8837207552229742, -12.098341747155938, -20.942996821580092, -28.27720750803006, -20.616938941813316, -12.161006248164927, -0.5551646099688057, -11.91403174371305, -24.22309944633931, -20.05063971796974, -8.793506772856597, -1.0889632133073963, -9.149470217813276, -2.8903265911065503, 3.1482227095794784, 5.958708375902798, -10.799925707361465, -14.696542400928777, -6.854856684590414, 3.335918185728506, 15.458160898302662, -7.664838252574016, -17.791204164266944, -16.576141989905544, 3.1104680998362317, -18.945671755709057, -4.299090155360346, -6.723167241159841, -12.877781904681449, -29.12415392997981, 0.8226323023409563, -18.01248582599783, -10.04062305244571, -20.274406386581738, 6.324876704427792, -20.516732864976188, -18.974791063254546, 14.843260653440254, 9.904684787206133, -5.271467609907761, -0.683389818095155, -12.614027785534677, 3.9904467071066403, -18.546571212632557, -9.325570357852463, -14.66463378673117, -5.134585609151522, -8.525944762263364, -3.3066412931644056, 4.828815550738188, -8.45111464216735, -20.86722588999736, -24.472523855673394, 5.151723163874578, -0.4621817976957381, -4.380252448978888, -3.545322501784865, -11.895716294708064, 7.530331373023866, -7.36921576767136, 1.6402893166469097, -19.545318131617506, -17.0152866295156, -6.411464537307458, -26.587108607059662, 0.9660594401575313, -19.18569852868224, -13.744601775876689], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 24, 400, 400, 400, 9, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 7, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [0.5884814766654838, 3.5471569036206496, 4.285834965903081, 20.864277116193787, -14.803507510563627, 14.228214049129623, 22.855227966314295, -12.215496346548392, 21.576634061372356, -3.1760601992310082, 1.4868613118194371, 18.518595330852865, 22.881373968440812, 14.783708770336478, 25.594021543177547, 19.119131807707685, -7.137771131435326, 19.728843245131173, -10.191347240408625, 10.700932080519635, 6.701654159825734, 7.373372291537324, 0.6872048399487731, 6.296554127429614, 1.7688992783220208, 8.341231112589838, 18.56108395927148, -0.016603181030085068, 15.439060079201447, 16.318490555550593, 22.493650695597783, 8.719548359116647, -1.8837207552229724, 12.098341747155938, 20.94299682158009, 28.277207508030063, 20.616938941813313, 12.161006248164927, 0.5551646099688057, 11.91403174371305, 24.223099446339308, 20.050639717969744, 8.793506772856595, 1.0889632133073963, 9.149470217813276, 2.8903265911065503, -3.1482227095794784, -5.958708375902798, 10.799925707361462, 14.696542400928777, 6.854856684590414, -3.335918185728504, -15.458160898302662, 7.66483825257402, 17.791204164266947, 16.576141989905544, -3.1104680998362317, 18.94567175570904, 4.299090155360348, 6.723167241159841, 12.877781904681449, 29.124153929979805, -0.8226323023409563, 18.01248582599783, 10.04062305244571, 20.274406386581735, -6.3248767044277905, 20.51673286497619, 18.974791063254546, -14.843260653440254, -9.90468478720614, 5.271467609907761, 0.6833898180951551, 12.614027785534681, -3.99044670710664, 18.54657121263255, 9.325570357852463, 14.664633786731173, 5.13458560915152, 8.525944762263364, 3.3066412931644074, -4.828815550738188, 8.45111464216735, 20.867225889997357, 24.472523855673398, -5.151723163874578, 0.4621817976957381, 4.380252448978888, 3.545322501784865, 11.895716294708064, -7.530331373023866, 7.36921576767136, -1.6402893166469097, 19.545318131617506, 17.015286629515607, 6.411464537307458, 26.58710860705966, -0.9660594401575331, 19.185698528682245, 13.74460177587669], "policy_adversary_policy_reward": [17.762681840101358, -18.939644793432326, -21.296183118081906, 14.201869310840607, 5.010349052555156, -13.58201898436132, -22.74882146354868, -18.979732768838897, 19.013045863421183, 10.593969157706063, -1.2410391070630808, -27.215388991196164, -22.1849151848991, -23.525540747729472, 15.235539945399857, 9.195452747696926, -17.166110423477118, -25.9871576992676, 5.753789972022748, 0.5983304264392828, 7.637889209642871, -10.611611833281746, -19.51338699238753, -17.523803669318188, -23.1613167685073, -22.601431168374326, -3.961756224453321, -25.60566131621963, -33.399896074263864, -17.78814701209124, -20.60932778360134, -17.62893583181405, 12.185247994850336, 2.0902942680203154, -16.372965540543877, -23.084720949718474, 7.654067144518137, 12.728627336299112, -10.203566330123682, -11.19829783091559, -3.121411944835149, -10.281896374816323, -4.20742951177845, -10.539315071296198, -12.034322128362398, 10.659912448464851, -7.033434751837344, -5.559673503021884, -3.38223226509907, -0.1555662915449716, -11.175488365194262, -5.506973859985415, -17.419535361614486, -19.702632556928474, -8.164759550958216, 8.197965913018386, -18.661318803153137, -12.216801355249757, -18.72942604509778, -13.907555066003404, -21.117446101035952, -23.869855290159627, 6.526380614105776, -23.96547733233907, -5.812610096774044, 9.580051607219993, -13.982855720425938, -10.213827773885939, -26.831829476885424, -15.05416416627476, -28.522938770600398, -28.0314762454597, -24.263404637450225, -16.9704732461764, -2.691049923722261, -21.630962572607594, -8.61078794939069, 7.500458729453079, -11.458840903940626, -12.369222583485474, -29.35044765328477, -19.09575123939385, -17.645225096847955, -22.456054339091533, 5.04759769626407, -22.634611241977268, -14.503067872046717, 12.325141445431925, -5.318804684055042, -12.98013575157151, -25.60460595987584, 19.82395277766274, 19.104700594966772, -12.808255175807815, 3.1677880322177643, 8.749628719587832, -7.958525128185391, -13.641326286537538, -9.103008966218717, -20.290075835638838, -6.020285004548153, -7.6894283646326755, -4.995443704746464, 11.667280076203475, 21.006433481383365, 9.909888315221963, -11.207398472894052, -4.122278032253988, -19.687599181676312, -15.894809146857583, -25.864023740918817, -7.288260238892274, 3.8910180507269825, 2.329918148945481, -30.022371461284436, -7.868972050133664, 5.143125693770408, -13.741306004491104, 7.99225014528718, -21.43858462760686, -27.361052457408054, 1.605488648045153, -18.894558359246666, -39.35374950071296, 13.16740213959811, -11.522137534916197, -11.74392632328426, -24.281045328711407, -7.812863014383211, -12.268383090508209, -25.647974780960602, -14.900837992202874, 9.94376259914424, 2.705990809711343, -29.541469348921524, -11.491996381030866, -17.918414444656698, -20.0311676818524, 8.466229925925447, 21.22029138095506, 4.346858986256507, 15.462510588155773, -0.16155458064869777, -10.381380639166824, -8.114362217919698, 6.747582581729388, -18.334073286346023, -6.893982284723336, 0.3995670952180177, 7.581326318995262, -16.086811686424493, -21.006330738840617, -25.226854383750315, 6.575713668045388, -26.562108901189582, -2.767158672272757, -2.928272510916507, -7.340898707386536, 5.30788073913989, -22.35977026366662, -7.333557165837917, 0.720274579509109, 6.616800943848617, 3.0408301576277594, -14.309162048334713, -2.593067235999989, -28.419164393770238, -13.31528738622448, -13.856669534327587, -35.0883781770192, 4.476725273364643, 5.826721054384514, -3.450671912906543, 2.526308317515067, -13.165599719255031, 4.405094821297254, 6.383265302531996, -13.473910306101725, -0.9073764404763196, -22.88405614893981, 0.6237591678656784, 14.436903578182054, 2.378981968787677, -17.117413504130397, 0.04873204396781006, 3.2318465893260093, -7.072333598006541, -32.01830266522848, -31.67508813073372, -2.355485128297495, -5.569124511077902, -7.253804563537013, -34.19891915515392, -18.975298058965407, -2.291796461609213, 4.223915341924275, -23.26843202086778, -15.102965036496702, -11.819638075730264, -15.669565476023116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4157734920367239, "mean_inference_ms": 1.091549378429341, "mean_action_processing_ms": 0.17877026635045098, "mean_env_wait_ms": 0.07225499705815232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004172205924987793, "StateBufferConnector_ms": 0.0025309324264526367, "ViewRequirementAgentConnector_ms": 0.0640801191329956}, "num_episodes": 10, "episode_return_max": 15.458160898302662, "episode_return_min": -29.12415392997981, "episode_return_mean": -8.659609100264856}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 464.5747292212441, "num_env_steps_trained_throughput_per_sec": 464.5747292212441, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 8137.147, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8137.115, "sample_time_ms": 770.805, "learn_time_ms": 7353.169, "learn_throughput": 543.983, "synch_weights_time_ms": 12.621}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 188, "trial_id": "83a5c_00000", "date": "2024-08-10_12-40-24", "timestamp": 1723308024, "time_this_iter_s": 8.615010976791382, "time_total_s": 1585.0865406990051, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc19dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1585.0865406990051, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 29.353846153846156, "ram_util_percent": 82.96923076923076}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8343933694577093, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.788285899856103, "policy_loss": -0.008129403911526044, "vf_loss": 2.7954351687557484, "vf_explained_var": 0.005887914492339684, "kl": 0.011460065270630511, "entropy": 1.041041099425977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.384253336985906, "cur_kl_coeff": 6.076998493043929e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9477414001400273, "policy_loss": -0.007287636365314635, "vf_loss": 1.9550290420030554, "vf_explained_var": 0.2068215413019061, "kl": 0.008058113893581706, "entropy": 0.33859823597595096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 180960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "env_runners": {"episode_reward_max": 16.732359849429084, "episode_reward_min": -29.12415392997981, "episode_reward_mean": -8.923865593598304, "episode_len_mean": 369.75, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36975, "policy_reward_min": {"agent_policy": -16.732359849429088, "adversary_policy": -39.35374950071296}, "policy_reward_max": {"agent_policy": 29.124153929979805, "adversary_policy": 36.55008536719455}, "policy_reward_mean": {"agent_policy": 8.923865593598304, "adversary_policy": -8.923865593598304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.518595330852865, -22.881373968440816, -14.783708770336474, -25.59402154317755, -19.119131807707696, 7.137771131435326, -19.728843245131173, 10.191347240408625, -10.700932080519635, -6.701654159825734, -7.373372291537324, -0.6872048399487731, -6.296554127429614, -1.7688992783220208, -8.34123111258984, -18.56108395927148, 0.016603181030085068, -15.439060079201447, -16.318490555550593, -22.493650695597786, -8.719548359116647, 1.8837207552229742, -12.098341747155938, -20.942996821580092, -28.27720750803006, -20.616938941813316, -12.161006248164927, -0.5551646099688057, -11.91403174371305, -24.22309944633931, -20.05063971796974, -8.793506772856597, -1.0889632133073963, -9.149470217813276, -2.8903265911065503, 3.1482227095794784, 5.958708375902798, -10.799925707361465, -14.696542400928777, -6.854856684590414, 3.335918185728506, 15.458160898302662, -7.664838252574016, -17.791204164266944, -16.576141989905544, 3.1104680998362317, -18.945671755709057, -4.299090155360346, -6.723167241159841, -12.877781904681449, -29.12415392997981, 0.8226323023409563, -18.01248582599783, -10.04062305244571, -20.274406386581738, 6.324876704427792, -20.516732864976188, -18.974791063254546, 14.843260653440254, 9.904684787206133, -5.271467609907761, -0.683389818095155, -12.614027785534677, 3.9904467071066403, -18.546571212632557, -9.325570357852463, -14.66463378673117, -5.134585609151522, -8.525944762263364, -3.3066412931644056, 4.828815550738188, -8.45111464216735, -20.86722588999736, -24.472523855673394, 5.151723163874578, -0.4621817976957381, -4.380252448978888, -3.545322501784865, -11.895716294708064, 7.530331373023866, -7.36921576767136, 1.6402893166469097, -19.545318131617506, -17.0152866295156, -6.411464537307458, -26.587108607059662, 0.9660594401575313, -19.18569852868224, -13.744601775876689, -10.392028084105828, 16.732359849429084, -7.826778231680532, -6.581133223789825, -4.748488444529073, -24.062326341189355, -4.732854650243189, -3.4040854159736718, -11.09974593867236, -7.315866804663585, -22.232325842602243], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 24, 400, 400, 400, 9, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 7, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [18.518595330852865, 22.881373968440812, 14.783708770336478, 25.594021543177547, 19.119131807707685, -7.137771131435326, 19.728843245131173, -10.191347240408625, 10.700932080519635, 6.701654159825734, 7.373372291537324, 0.6872048399487731, 6.296554127429614, 1.7688992783220208, 8.341231112589838, 18.56108395927148, -0.016603181030085068, 15.439060079201447, 16.318490555550593, 22.493650695597783, 8.719548359116647, -1.8837207552229724, 12.098341747155938, 20.94299682158009, 28.277207508030063, 20.616938941813313, 12.161006248164927, 0.5551646099688057, 11.91403174371305, 24.223099446339308, 20.050639717969744, 8.793506772856595, 1.0889632133073963, 9.149470217813276, 2.8903265911065503, -3.1482227095794784, -5.958708375902798, 10.799925707361462, 14.696542400928777, 6.854856684590414, -3.335918185728504, -15.458160898302662, 7.66483825257402, 17.791204164266947, 16.576141989905544, -3.1104680998362317, 18.94567175570904, 4.299090155360348, 6.723167241159841, 12.877781904681449, 29.124153929979805, -0.8226323023409563, 18.01248582599783, 10.04062305244571, 20.274406386581735, -6.3248767044277905, 20.51673286497619, 18.974791063254546, -14.843260653440254, -9.90468478720614, 5.271467609907761, 0.6833898180951551, 12.614027785534681, -3.99044670710664, 18.54657121263255, 9.325570357852463, 14.664633786731173, 5.13458560915152, 8.525944762263364, 3.3066412931644074, -4.828815550738188, 8.45111464216735, 20.867225889997357, 24.472523855673398, -5.151723163874578, 0.4621817976957381, 4.380252448978888, 3.545322501784865, 11.895716294708064, -7.530331373023866, 7.36921576767136, -1.6402893166469097, 19.545318131617506, 17.015286629515607, 6.411464537307458, 26.58710860705966, -0.9660594401575331, 19.185698528682245, 13.74460177587669, 10.392028084105826, -16.732359849429088, 7.826778231680532, 6.581133223789825, 4.748488444529073, 24.06232634118935, 4.732854650243189, 3.4040854159736718, 11.09974593867236, 7.315866804663585, 22.232325842602247], "policy_adversary_policy_reward": [-19.51338699238753, -17.523803669318188, -23.1613167685073, -22.601431168374326, -3.961756224453321, -25.60566131621963, -33.399896074263864, -17.78814701209124, -20.60932778360134, -17.62893583181405, 12.185247994850336, 2.0902942680203154, -16.372965540543877, -23.084720949718474, 7.654067144518137, 12.728627336299112, -10.203566330123682, -11.19829783091559, -3.121411944835149, -10.281896374816323, -4.20742951177845, -10.539315071296198, -12.034322128362398, 10.659912448464851, -7.033434751837344, -5.559673503021884, -3.38223226509907, -0.1555662915449716, -11.175488365194262, -5.506973859985415, -17.419535361614486, -19.702632556928474, -8.164759550958216, 8.197965913018386, -18.661318803153137, -12.216801355249757, -18.72942604509778, -13.907555066003404, -21.117446101035952, -23.869855290159627, 6.526380614105776, -23.96547733233907, -5.812610096774044, 9.580051607219993, -13.982855720425938, -10.213827773885939, -26.831829476885424, -15.05416416627476, -28.522938770600398, -28.0314762454597, -24.263404637450225, -16.9704732461764, -2.691049923722261, -21.630962572607594, -8.61078794939069, 7.500458729453079, -11.458840903940626, -12.369222583485474, -29.35044765328477, -19.09575123939385, -17.645225096847955, -22.456054339091533, 5.04759769626407, -22.634611241977268, -14.503067872046717, 12.325141445431925, -5.318804684055042, -12.98013575157151, -25.60460595987584, 19.82395277766274, 19.104700594966772, -12.808255175807815, 3.1677880322177643, 8.749628719587832, -7.958525128185391, -13.641326286537538, -9.103008966218717, -20.290075835638838, -6.020285004548153, -7.6894283646326755, -4.995443704746464, 11.667280076203475, 21.006433481383365, 9.909888315221963, -11.207398472894052, -4.122278032253988, -19.687599181676312, -15.894809146857583, -25.864023740918817, -7.288260238892274, 3.8910180507269825, 2.329918148945481, -30.022371461284436, -7.868972050133664, 5.143125693770408, -13.741306004491104, 7.99225014528718, -21.43858462760686, -27.361052457408054, 1.605488648045153, -18.894558359246666, -39.35374950071296, 13.16740213959811, -11.522137534916197, -11.74392632328426, -24.281045328711407, -7.812863014383211, -12.268383090508209, -25.647974780960602, -14.900837992202874, 9.94376259914424, 2.705990809711343, -29.541469348921524, -11.491996381030866, -17.918414444656698, -20.0311676818524, 8.466229925925447, 21.22029138095506, 4.346858986256507, 15.462510588155773, -0.16155458064869777, -10.381380639166824, -8.114362217919698, 6.747582581729388, -18.334073286346023, -6.893982284723336, 0.3995670952180177, 7.581326318995262, -16.086811686424493, -21.006330738840617, -25.226854383750315, 6.575713668045388, -26.562108901189582, -2.767158672272757, -2.928272510916507, -7.340898707386536, 5.30788073913989, -22.35977026366662, -7.333557165837917, 0.720274579509109, 6.616800943848617, 3.0408301576277594, -14.309162048334713, -2.593067235999989, -28.419164393770238, -13.31528738622448, -13.856669534327587, -35.0883781770192, 4.476725273364643, 5.826721054384514, -3.450671912906543, 2.526308317515067, -13.165599719255031, 4.405094821297254, 6.383265302531996, -13.473910306101725, -0.9073764404763196, -22.88405614893981, 0.6237591678656784, 14.436903578182054, 2.378981968787677, -17.117413504130397, 0.04873204396781006, 3.2318465893260093, -7.072333598006541, -32.01830266522848, -31.67508813073372, -2.355485128297495, -5.569124511077902, -7.253804563537013, -34.19891915515392, -18.975298058965407, -2.291796461609213, 4.223915341924275, -23.26843202086778, -15.102965036496702, -11.819638075730264, -15.669565476023116, -0.013960105041348925, -20.770096063170303, 36.55008536719455, -3.085365668336376, 2.59785531996004, -18.251411783321103, -23.601136180884463, 10.438869733304813, 7.573763914889675, -17.07074080394782, -23.245955768049612, -24.87869691432905, -13.623310248406487, 4.157600947920109, 7.784834742450201, -14.593005574397544, -21.570648023429506, -0.6288438539152139, -20.360870290973097, 5.729136681645926, -16.42435849238176, -28.040293192822723]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41559918117431066, "mean_inference_ms": 1.0909573124596021, "mean_action_processing_ms": 0.17869868942760112, "mean_env_wait_ms": 0.07220850130085128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004314064979553223, "StateBufferConnector_ms": 0.0026074647903442383, "ViewRequirementAgentConnector_ms": 0.06594467163085938}, "num_episodes": 11, "episode_return_max": 16.732359849429084, "episode_return_min": -29.12415392997981, "episode_return_mean": -8.923865593598304}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 496.44181823847003, "num_env_steps_trained_throughput_per_sec": 496.44181823847003, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 2268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2268000, "timers": {"training_iteration_time_ms": 8151.587, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8151.554, "sample_time_ms": 773.983, "learn_time_ms": 7364.474, "learn_throughput": 543.148, "synch_weights_time_ms": 12.566}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 2268000, "num_agent_steps_trained": 2268000}, "done": false, "training_iteration": 189, "trial_id": "83a5c_00000", "date": "2024-08-10_12-40-32", "timestamp": 1723308032, "time_this_iter_s": 8.061926126480103, "time_total_s": 1593.1484668254852, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd80040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1593.1484668254852, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 27.772727272727273, "ram_util_percent": 82.62727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6477353667771375, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.94706999902372, "policy_loss": -0.0052416830205373344, "vf_loss": 2.95177350479459, "vf_explained_var": -0.16585691489239848, "kl": 0.0062925595078785895, "entropy": 1.0204410062265143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.259452389180661, "cur_kl_coeff": 6.076998493043929e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.854413498689731, "policy_loss": -0.00919363787555388, "vf_loss": 1.8636071370293696, "vf_explained_var": 0.467536694308122, "kl": 0.00519391301149907, "entropy": 0.30803111592928567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 181920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 20.373977651638853, "episode_reward_min": -29.12415392997981, "episode_reward_mean": -7.337165844521133, "episode_len_mean": 362.1, "episode_media": {}, "episodes_this_iter": 13, "episodes_timesteps_total": 36210, "policy_reward_min": {"agent_policy": -20.373977651638857, "adversary_policy": -39.35374950071296}, "policy_reward_max": {"agent_policy": 29.124153929979805, "adversary_policy": 36.55008536719455}, "policy_reward_mean": {"agent_policy": 7.337165844521133, "adversary_policy": -7.337165844521133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.7688992783220208, -8.34123111258984, -18.56108395927148, 0.016603181030085068, -15.439060079201447, -16.318490555550593, -22.493650695597786, -8.719548359116647, 1.8837207552229742, -12.098341747155938, -20.942996821580092, -28.27720750803006, -20.616938941813316, -12.161006248164927, -0.5551646099688057, -11.91403174371305, -24.22309944633931, -20.05063971796974, -8.793506772856597, -1.0889632133073963, -9.149470217813276, -2.8903265911065503, 3.1482227095794784, 5.958708375902798, -10.799925707361465, -14.696542400928777, -6.854856684590414, 3.335918185728506, 15.458160898302662, -7.664838252574016, -17.791204164266944, -16.576141989905544, 3.1104680998362317, -18.945671755709057, -4.299090155360346, -6.723167241159841, -12.877781904681449, -29.12415392997981, 0.8226323023409563, -18.01248582599783, -10.04062305244571, -20.274406386581738, 6.324876704427792, -20.516732864976188, -18.974791063254546, 14.843260653440254, 9.904684787206133, -5.271467609907761, -0.683389818095155, -12.614027785534677, 3.9904467071066403, -18.546571212632557, -9.325570357852463, -14.66463378673117, -5.134585609151522, -8.525944762263364, -3.3066412931644056, 4.828815550738188, -8.45111464216735, -20.86722588999736, -24.472523855673394, 5.151723163874578, -0.4621817976957381, -4.380252448978888, -3.545322501784865, -11.895716294708064, 7.530331373023866, -7.36921576767136, 1.6402893166469097, -19.545318131617506, -17.0152866295156, -6.411464537307458, -26.587108607059662, 0.9660594401575313, -19.18569852868224, -13.744601775876689, -10.392028084105828, 16.732359849429084, -7.826778231680532, -6.581133223789825, -4.748488444529073, -24.062326341189355, -4.732854650243189, -3.4040854159736718, -11.09974593867236, -7.315866804663585, -22.232325842602243, -5.694482359900524, 7.86472011403248, 4.177284628856411, 20.373977651638853, -3.159996435624725, 11.437808101924087, 6.7225632845054655, -8.21358140328356, 7.638951826313315, 2.190928324368117, -14.815907508096544, 5.578071627792408, -10.486636737872196], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 24, 400, 400, 400, 9, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 7, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 22, 400, 400, 400, 13, 400, 400, 400], "policy_agent_policy_reward": [1.7688992783220208, 8.341231112589838, 18.56108395927148, -0.016603181030085068, 15.439060079201447, 16.318490555550593, 22.493650695597783, 8.719548359116647, -1.8837207552229724, 12.098341747155938, 20.94299682158009, 28.277207508030063, 20.616938941813313, 12.161006248164927, 0.5551646099688057, 11.91403174371305, 24.223099446339308, 20.050639717969744, 8.793506772856595, 1.0889632133073963, 9.149470217813276, 2.8903265911065503, -3.1482227095794784, -5.958708375902798, 10.799925707361462, 14.696542400928777, 6.854856684590414, -3.335918185728504, -15.458160898302662, 7.66483825257402, 17.791204164266947, 16.576141989905544, -3.1104680998362317, 18.94567175570904, 4.299090155360348, 6.723167241159841, 12.877781904681449, 29.124153929979805, -0.8226323023409563, 18.01248582599783, 10.04062305244571, 20.274406386581735, -6.3248767044277905, 20.51673286497619, 18.974791063254546, -14.843260653440254, -9.90468478720614, 5.271467609907761, 0.6833898180951551, 12.614027785534681, -3.99044670710664, 18.54657121263255, 9.325570357852463, 14.664633786731173, 5.13458560915152, 8.525944762263364, 3.3066412931644074, -4.828815550738188, 8.45111464216735, 20.867225889997357, 24.472523855673398, -5.151723163874578, 0.4621817976957381, 4.380252448978888, 3.545322501784865, 11.895716294708064, -7.530331373023866, 7.36921576767136, -1.6402893166469097, 19.545318131617506, 17.015286629515607, 6.411464537307458, 26.58710860705966, -0.9660594401575331, 19.185698528682245, 13.74460177587669, 10.392028084105826, -16.732359849429088, 7.826778231680532, 6.581133223789825, 4.748488444529073, 24.06232634118935, 4.732854650243189, 3.4040854159736718, 11.09974593867236, 7.315866804663585, 22.232325842602247, 5.694482359900524, -7.864720114032478, -4.177284628856414, -20.373977651638857, 3.159996435624725, -11.43780810192408, -6.7225632845054655, 8.21358140328356, -7.638951826313312, -2.190928324368117, 14.815907508096544, -5.578071627792408, 10.486636737872196], "policy_adversary_policy_reward": [-3.38223226509907, -0.1555662915449716, -11.175488365194262, -5.506973859985415, -17.419535361614486, -19.702632556928474, -8.164759550958216, 8.197965913018386, -18.661318803153137, -12.216801355249757, -18.72942604509778, -13.907555066003404, -21.117446101035952, -23.869855290159627, 6.526380614105776, -23.96547733233907, -5.812610096774044, 9.580051607219993, -13.982855720425938, -10.213827773885939, -26.831829476885424, -15.05416416627476, -28.522938770600398, -28.0314762454597, -24.263404637450225, -16.9704732461764, -2.691049923722261, -21.630962572607594, -8.61078794939069, 7.500458729453079, -11.458840903940626, -12.369222583485474, -29.35044765328477, -19.09575123939385, -17.645225096847955, -22.456054339091533, 5.04759769626407, -22.634611241977268, -14.503067872046717, 12.325141445431925, -5.318804684055042, -12.98013575157151, -25.60460595987584, 19.82395277766274, 19.104700594966772, -12.808255175807815, 3.1677880322177643, 8.749628719587832, -7.958525128185391, -13.641326286537538, -9.103008966218717, -20.290075835638838, -6.020285004548153, -7.6894283646326755, -4.995443704746464, 11.667280076203475, 21.006433481383365, 9.909888315221963, -11.207398472894052, -4.122278032253988, -19.687599181676312, -15.894809146857583, -25.864023740918817, -7.288260238892274, 3.8910180507269825, 2.329918148945481, -30.022371461284436, -7.868972050133664, 5.143125693770408, -13.741306004491104, 7.99225014528718, -21.43858462760686, -27.361052457408054, 1.605488648045153, -18.894558359246666, -39.35374950071296, 13.16740213959811, -11.522137534916197, -11.74392632328426, -24.281045328711407, -7.812863014383211, -12.268383090508209, -25.647974780960602, -14.900837992202874, 9.94376259914424, 2.705990809711343, -29.541469348921524, -11.491996381030866, -17.918414444656698, -20.0311676818524, 8.466229925925447, 21.22029138095506, 4.346858986256507, 15.462510588155773, -0.16155458064869777, -10.381380639166824, -8.114362217919698, 6.747582581729388, -18.334073286346023, -6.893982284723336, 0.3995670952180177, 7.581326318995262, -16.086811686424493, -21.006330738840617, -25.226854383750315, 6.575713668045388, -26.562108901189582, -2.767158672272757, -2.928272510916507, -7.340898707386536, 5.30788073913989, -22.35977026366662, -7.333557165837917, 0.720274579509109, 6.616800943848617, 3.0408301576277594, -14.309162048334713, -2.593067235999989, -28.419164393770238, -13.31528738622448, -13.856669534327587, -35.0883781770192, 4.476725273364643, 5.826721054384514, -3.450671912906543, 2.526308317515067, -13.165599719255031, 4.405094821297254, 6.383265302531996, -13.473910306101725, -0.9073764404763196, -22.88405614893981, 0.6237591678656784, 14.436903578182054, 2.378981968787677, -17.117413504130397, 0.04873204396781006, 3.2318465893260093, -7.072333598006541, -32.01830266522848, -31.67508813073372, -2.355485128297495, -5.569124511077902, -7.253804563537013, -34.19891915515392, -18.975298058965407, -2.291796461609213, 4.223915341924275, -23.26843202086778, -15.102965036496702, -11.819638075730264, -15.669565476023116, -0.013960105041348925, -20.770096063170303, 36.55008536719455, -3.085365668336376, 2.59785531996004, -18.251411783321103, -23.601136180884463, 10.438869733304813, 7.573763914889675, -17.07074080394782, -23.245955768049612, -24.87869691432905, -13.623310248406487, 4.157600947920109, 7.784834742450201, -14.593005574397544, -21.570648023429506, -0.6288438539152139, -20.360870290973097, 5.729136681645926, -16.42435849238176, -28.040293192822723, 6.373512011273839, -17.762476731074887, -0.10802544063754738, 15.837465668702507, 4.243179952520471, 4.111389305192354, 22.234352172707986, 18.513603130569727, -8.175313514617542, 1.8553206433680955, 18.41344615052585, 4.462170053322318, 3.5647926132680894, 9.880333955742842, -26.97568691261646, 10.548524106049342, 3.2175901216118454, 12.060313531014756, 6.96357630505734, -2.5817196563211056, -20.83459586470903, -8.797219151484061, 6.439384996784895, 4.716758258799921, -17.148343477522058, -3.824929998222334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41541194646666946, "mean_inference_ms": 1.0903090503553634, "mean_action_processing_ms": 0.17857694822553186, "mean_env_wait_ms": 0.07215244709410294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00438380241394043, "StateBufferConnector_ms": 0.0025980472564697266, "ViewRequirementAgentConnector_ms": 0.0658639669418335}, "num_episodes": 13, "episode_return_max": 20.373977651638853, "episode_return_min": -29.12415392997981, "episode_return_mean": -7.337165844521133}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 509.67744307016966, "num_env_steps_trained_throughput_per_sec": 509.67744307016966, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 8148.546, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8148.513, "sample_time_ms": 768.076, "learn_time_ms": 7367.361, "learn_throughput": 542.935, "synch_weights_time_ms": 12.566}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 190, "trial_id": "83a5c_00000", "date": "2024-08-10_12-40-40", "timestamp": 1723308040, "time_this_iter_s": 7.853872776031494, "time_total_s": 1601.0023396015167, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fdfc790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1601.0023396015167, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 25.772727272727277, "ram_util_percent": 82.64545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0296798391632302, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0143870868380107, "policy_loss": -0.00626241135578504, "vf_loss": 3.0195228361578845, "vf_explained_var": -0.018571965309677932, "kl": 0.01317331047683421, "entropy": 0.9797628132439165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.321176742948592, "cur_kl_coeff": 6.076998493043929e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.350566028803587, "policy_loss": -0.005247247516429828, "vf_loss": 2.355813271552324, "vf_explained_var": 0.6696133796125651, "kl": 0.00371708676078543, "entropy": 0.3028805691904078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 182880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "env_runners": {"episode_reward_max": 20.373977651638853, "episode_reward_min": -29.12415392997981, "episode_reward_mean": -7.235623642949487, "episode_len_mean": 358.18, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 35818, "policy_reward_min": {"agent_policy": -20.373977651638857, "adversary_policy": -39.35374950071296}, "policy_reward_max": {"agent_policy": 29.124153929979805, "adversary_policy": 36.55008536719455}, "policy_reward_mean": {"agent_policy": 7.235623642949487, "adversary_policy": -7.235623642949488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.616938941813316, -12.161006248164927, -0.5551646099688057, -11.91403174371305, -24.22309944633931, -20.05063971796974, -8.793506772856597, -1.0889632133073963, -9.149470217813276, -2.8903265911065503, 3.1482227095794784, 5.958708375902798, -10.799925707361465, -14.696542400928777, -6.854856684590414, 3.335918185728506, 15.458160898302662, -7.664838252574016, -17.791204164266944, -16.576141989905544, 3.1104680998362317, -18.945671755709057, -4.299090155360346, -6.723167241159841, -12.877781904681449, -29.12415392997981, 0.8226323023409563, -18.01248582599783, -10.04062305244571, -20.274406386581738, 6.324876704427792, -20.516732864976188, -18.974791063254546, 14.843260653440254, 9.904684787206133, -5.271467609907761, -0.683389818095155, -12.614027785534677, 3.9904467071066403, -18.546571212632557, -9.325570357852463, -14.66463378673117, -5.134585609151522, -8.525944762263364, -3.3066412931644056, 4.828815550738188, -8.45111464216735, -20.86722588999736, -24.472523855673394, 5.151723163874578, -0.4621817976957381, -4.380252448978888, -3.545322501784865, -11.895716294708064, 7.530331373023866, -7.36921576767136, 1.6402893166469097, -19.545318131617506, -17.0152866295156, -6.411464537307458, -26.587108607059662, 0.9660594401575313, -19.18569852868224, -13.744601775876689, -10.392028084105828, 16.732359849429084, -7.826778231680532, -6.581133223789825, -4.748488444529073, -24.062326341189355, -4.732854650243189, -3.4040854159736718, -11.09974593867236, -7.315866804663585, -22.232325842602243, -5.694482359900524, 7.86472011403248, 4.177284628856411, 20.373977651638853, -3.159996435624725, 11.437808101924087, 6.7225632845054655, -8.21358140328356, 7.638951826313315, 2.190928324368117, -14.815907508096544, 5.578071627792408, -10.486636737872196, -12.106284945150644, -8.011822951979642, -16.393370892764715, -10.421928448805097, -14.444011849541614, -14.464246246324251, -17.29141661629063, -11.273734011706754, -7.243494597010695, -15.564524471031898, 1.138727571502169, -14.829858563894657], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 19, 400, 400, 400, 400, 400, 24, 400, 400, 400, 9, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 7, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 22, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400], "policy_agent_policy_reward": [20.616938941813313, 12.161006248164927, 0.5551646099688057, 11.91403174371305, 24.223099446339308, 20.050639717969744, 8.793506772856595, 1.0889632133073963, 9.149470217813276, 2.8903265911065503, -3.1482227095794784, -5.958708375902798, 10.799925707361462, 14.696542400928777, 6.854856684590414, -3.335918185728504, -15.458160898302662, 7.66483825257402, 17.791204164266947, 16.576141989905544, -3.1104680998362317, 18.94567175570904, 4.299090155360348, 6.723167241159841, 12.877781904681449, 29.124153929979805, -0.8226323023409563, 18.01248582599783, 10.04062305244571, 20.274406386581735, -6.3248767044277905, 20.51673286497619, 18.974791063254546, -14.843260653440254, -9.90468478720614, 5.271467609907761, 0.6833898180951551, 12.614027785534681, -3.99044670710664, 18.54657121263255, 9.325570357852463, 14.664633786731173, 5.13458560915152, 8.525944762263364, 3.3066412931644074, -4.828815550738188, 8.45111464216735, 20.867225889997357, 24.472523855673398, -5.151723163874578, 0.4621817976957381, 4.380252448978888, 3.545322501784865, 11.895716294708064, -7.530331373023866, 7.36921576767136, -1.6402893166469097, 19.545318131617506, 17.015286629515607, 6.411464537307458, 26.58710860705966, -0.9660594401575331, 19.185698528682245, 13.74460177587669, 10.392028084105826, -16.732359849429088, 7.826778231680532, 6.581133223789825, 4.748488444529073, 24.06232634118935, 4.732854650243189, 3.4040854159736718, 11.09974593867236, 7.315866804663585, 22.232325842602247, 5.694482359900524, -7.864720114032478, -4.177284628856414, -20.373977651638857, 3.159996435624725, -11.43780810192408, -6.7225632845054655, 8.21358140328356, -7.638951826313312, -2.190928324368117, 14.815907508096544, -5.578071627792408, 10.486636737872196, 12.106284945150641, 8.011822951979642, 16.393370892764697, 10.421928448805097, 14.444011849541615, 14.464246246324251, 17.29141661629063, 11.273734011706761, 7.243494597010702, 15.564524471031884, -1.138727571502169, 14.829858563894659], "policy_adversary_policy_reward": [-24.263404637450225, -16.9704732461764, -2.691049923722261, -21.630962572607594, -8.61078794939069, 7.500458729453079, -11.458840903940626, -12.369222583485474, -29.35044765328477, -19.09575123939385, -17.645225096847955, -22.456054339091533, 5.04759769626407, -22.634611241977268, -14.503067872046717, 12.325141445431925, -5.318804684055042, -12.98013575157151, -25.60460595987584, 19.82395277766274, 19.104700594966772, -12.808255175807815, 3.1677880322177643, 8.749628719587832, -7.958525128185391, -13.641326286537538, -9.103008966218717, -20.290075835638838, -6.020285004548153, -7.6894283646326755, -4.995443704746464, 11.667280076203475, 21.006433481383365, 9.909888315221963, -11.207398472894052, -4.122278032253988, -19.687599181676312, -15.894809146857583, -25.864023740918817, -7.288260238892274, 3.8910180507269825, 2.329918148945481, -30.022371461284436, -7.868972050133664, 5.143125693770408, -13.741306004491104, 7.99225014528718, -21.43858462760686, -27.361052457408054, 1.605488648045153, -18.894558359246666, -39.35374950071296, 13.16740213959811, -11.522137534916197, -11.74392632328426, -24.281045328711407, -7.812863014383211, -12.268383090508209, -25.647974780960602, -14.900837992202874, 9.94376259914424, 2.705990809711343, -29.541469348921524, -11.491996381030866, -17.918414444656698, -20.0311676818524, 8.466229925925447, 21.22029138095506, 4.346858986256507, 15.462510588155773, -0.16155458064869777, -10.381380639166824, -8.114362217919698, 6.747582581729388, -18.334073286346023, -6.893982284723336, 0.3995670952180177, 7.581326318995262, -16.086811686424493, -21.006330738840617, -25.226854383750315, 6.575713668045388, -26.562108901189582, -2.767158672272757, -2.928272510916507, -7.340898707386536, 5.30788073913989, -22.35977026366662, -7.333557165837917, 0.720274579509109, 6.616800943848617, 3.0408301576277594, -14.309162048334713, -2.593067235999989, -28.419164393770238, -13.31528738622448, -13.856669534327587, -35.0883781770192, 4.476725273364643, 5.826721054384514, -3.450671912906543, 2.526308317515067, -13.165599719255031, 4.405094821297254, 6.383265302531996, -13.473910306101725, -0.9073764404763196, -22.88405614893981, 0.6237591678656784, 14.436903578182054, 2.378981968787677, -17.117413504130397, 0.04873204396781006, 3.2318465893260093, -7.072333598006541, -32.01830266522848, -31.67508813073372, -2.355485128297495, -5.569124511077902, -7.253804563537013, -34.19891915515392, -18.975298058965407, -2.291796461609213, 4.223915341924275, -23.26843202086778, -15.102965036496702, -11.819638075730264, -15.669565476023116, -0.013960105041348925, -20.770096063170303, 36.55008536719455, -3.085365668336376, 2.59785531996004, -18.251411783321103, -23.601136180884463, 10.438869733304813, 7.573763914889675, -17.07074080394782, -23.245955768049612, -24.87869691432905, -13.623310248406487, 4.157600947920109, 7.784834742450201, -14.593005574397544, -21.570648023429506, -0.6288438539152139, -20.360870290973097, 5.729136681645926, -16.42435849238176, -28.040293192822723, 6.373512011273839, -17.762476731074887, -0.10802544063754738, 15.837465668702507, 4.243179952520471, 4.111389305192354, 22.234352172707986, 18.513603130569727, -8.175313514617542, 1.8553206433680955, 18.41344615052585, 4.462170053322318, 3.5647926132680894, 9.880333955742842, -26.97568691261646, 10.548524106049342, 3.2175901216118454, 12.060313531014756, 6.96357630505734, -2.5817196563211056, -20.83459586470903, -8.797219151484061, 6.439384996784895, 4.716758258799921, -17.148343477522058, -3.824929998222334, -22.213625229388747, -1.9989446609125352, 9.566009898476658, -25.589655802435946, -12.798043645313268, -19.988698140216123, -3.971741431215733, -16.87211546639446, -10.345722877812522, -18.5423008212707, -22.217662354145858, -6.710830138502647, -29.237007531412715, -5.345825701168543, -10.651224559452633, -11.896243463960879, -6.349474656479245, -8.137514537542152, -17.784506570272832, -13.344542371790958, -2.296053572045647, 4.573508715049985, -24.53330395041486, -5.12641317737447]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41522208384397064, "mean_inference_ms": 1.0897388079901598, "mean_action_processing_ms": 0.1785088164440107, "mean_env_wait_ms": 0.0721074304657941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004460692405700684, "StateBufferConnector_ms": 0.002633810043334961, "ViewRequirementAgentConnector_ms": 0.06635403633117676}, "num_episodes": 12, "episode_return_max": 20.373977651638853, "episode_return_min": -29.12415392997981, "episode_return_mean": -7.235623642949487}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 482.13606430474863, "num_env_steps_trained_throughput_per_sec": 482.13606430474863, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 2292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2292000, "timers": {"training_iteration_time_ms": 8102.397, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8102.364, "sample_time_ms": 766.568, "learn_time_ms": 7322.461, "learn_throughput": 546.264, "synch_weights_time_ms": 12.832}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 2292000, "num_agent_steps_trained": 2292000}, "done": false, "training_iteration": 191, "trial_id": "83a5c_00000", "date": "2024-08-10_12-40-49", "timestamp": 1723308049, "time_this_iter_s": 8.301151037216187, "time_total_s": 1609.303490638733, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fdeb4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1609.303490638733, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 27.058333333333326, "ram_util_percent": 82.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7885592038353915, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.54675491953653, "policy_loss": -0.003769952424792031, "vf_loss": 2.549942155111404, "vf_explained_var": -0.02595075800936058, "kl": 0.006813309267712769, "entropy": 0.994434680194451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.466919928044081, "cur_kl_coeff": 3.0384992465219646e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.428443361942967, "policy_loss": -0.009374002642046738, "vf_loss": 2.43781735599041, "vf_explained_var": 0.46628046755989394, "kl": 0.0052747461847938845, "entropy": 0.3236256592751791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 183840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 20.373977651638853, "episode_reward_min": -29.12415392997981, "episode_reward_mean": -6.817817994418281, "episode_len_mean": 358.23, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 35823, "policy_reward_min": {"agent_policy": -20.373977651638857, "adversary_policy": -39.35374950071296}, "policy_reward_max": {"agent_policy": 29.124153929979805, "adversary_policy": 36.55008536719455}, "policy_reward_mean": {"agent_policy": 6.817817994418281, "adversary_policy": -6.817817994418282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.958708375902798, -10.799925707361465, -14.696542400928777, -6.854856684590414, 3.335918185728506, 15.458160898302662, -7.664838252574016, -17.791204164266944, -16.576141989905544, 3.1104680998362317, -18.945671755709057, -4.299090155360346, -6.723167241159841, -12.877781904681449, -29.12415392997981, 0.8226323023409563, -18.01248582599783, -10.04062305244571, -20.274406386581738, 6.324876704427792, -20.516732864976188, -18.974791063254546, 14.843260653440254, 9.904684787206133, -5.271467609907761, -0.683389818095155, -12.614027785534677, 3.9904467071066403, -18.546571212632557, -9.325570357852463, -14.66463378673117, -5.134585609151522, -8.525944762263364, -3.3066412931644056, 4.828815550738188, -8.45111464216735, -20.86722588999736, -24.472523855673394, 5.151723163874578, -0.4621817976957381, -4.380252448978888, -3.545322501784865, -11.895716294708064, 7.530331373023866, -7.36921576767136, 1.6402893166469097, -19.545318131617506, -17.0152866295156, -6.411464537307458, -26.587108607059662, 0.9660594401575313, -19.18569852868224, -13.744601775876689, -10.392028084105828, 16.732359849429084, -7.826778231680532, -6.581133223789825, -4.748488444529073, -24.062326341189355, -4.732854650243189, -3.4040854159736718, -11.09974593867236, -7.315866804663585, -22.232325842602243, -5.694482359900524, 7.86472011403248, 4.177284628856411, 20.373977651638853, -3.159996435624725, 11.437808101924087, 6.7225632845054655, -8.21358140328356, 7.638951826313315, 2.190928324368117, -14.815907508096544, 5.578071627792408, -10.486636737872196, -12.106284945150644, -8.011822951979642, -16.393370892764715, -10.421928448805097, -14.444011849541614, -14.464246246324251, -17.29141661629063, -11.273734011706754, -7.243494597010695, -15.564524471031898, 1.138727571502169, -14.829858563894657, -16.913254198031506, 5.566613026203479, 6.833978765858273, -28.217149061445582, 11.026672755443508, -13.36886126851363, 10.357011811422272, -13.76421241440443, -8.251690133251566, -17.890188152436654, -1.8932810711970038], "episode_lengths": [400, 400, 400, 400, 400, 24, 400, 400, 400, 9, 400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 7, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 22, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-5.958708375902798, 10.799925707361462, 14.696542400928777, 6.854856684590414, -3.335918185728504, -15.458160898302662, 7.66483825257402, 17.791204164266947, 16.576141989905544, -3.1104680998362317, 18.94567175570904, 4.299090155360348, 6.723167241159841, 12.877781904681449, 29.124153929979805, -0.8226323023409563, 18.01248582599783, 10.04062305244571, 20.274406386581735, -6.3248767044277905, 20.51673286497619, 18.974791063254546, -14.843260653440254, -9.90468478720614, 5.271467609907761, 0.6833898180951551, 12.614027785534681, -3.99044670710664, 18.54657121263255, 9.325570357852463, 14.664633786731173, 5.13458560915152, 8.525944762263364, 3.3066412931644074, -4.828815550738188, 8.45111464216735, 20.867225889997357, 24.472523855673398, -5.151723163874578, 0.4621817976957381, 4.380252448978888, 3.545322501784865, 11.895716294708064, -7.530331373023866, 7.36921576767136, -1.6402893166469097, 19.545318131617506, 17.015286629515607, 6.411464537307458, 26.58710860705966, -0.9660594401575331, 19.185698528682245, 13.74460177587669, 10.392028084105826, -16.732359849429088, 7.826778231680532, 6.581133223789825, 4.748488444529073, 24.06232634118935, 4.732854650243189, 3.4040854159736718, 11.09974593867236, 7.315866804663585, 22.232325842602247, 5.694482359900524, -7.864720114032478, -4.177284628856414, -20.373977651638857, 3.159996435624725, -11.43780810192408, -6.7225632845054655, 8.21358140328356, -7.638951826313312, -2.190928324368117, 14.815907508096544, -5.578071627792408, 10.486636737872196, 12.106284945150641, 8.011822951979642, 16.393370892764697, 10.421928448805097, 14.444011849541615, 14.464246246324251, 17.29141661629063, 11.273734011706761, 7.243494597010702, 15.564524471031884, -1.138727571502169, 14.829858563894659, 16.91325419803151, -5.566613026203475, -6.833978765858273, 28.21714906144558, -11.026672755443506, 13.368861268513628, -10.357011811422272, 13.764212414404426, 8.251690133251566, 17.890188152436654, 1.8932810711970092], "policy_adversary_policy_reward": [3.1677880322177643, 8.749628719587832, -7.958525128185391, -13.641326286537538, -9.103008966218717, -20.290075835638838, -6.020285004548153, -7.6894283646326755, -4.995443704746464, 11.667280076203475, 21.006433481383365, 9.909888315221963, -11.207398472894052, -4.122278032253988, -19.687599181676312, -15.894809146857583, -25.864023740918817, -7.288260238892274, 3.8910180507269825, 2.329918148945481, -30.022371461284436, -7.868972050133664, 5.143125693770408, -13.741306004491104, 7.99225014528718, -21.43858462760686, -27.361052457408054, 1.605488648045153, -18.894558359246666, -39.35374950071296, 13.16740213959811, -11.522137534916197, -11.74392632328426, -24.281045328711407, -7.812863014383211, -12.268383090508209, -25.647974780960602, -14.900837992202874, 9.94376259914424, 2.705990809711343, -29.541469348921524, -11.491996381030866, -17.918414444656698, -20.0311676818524, 8.466229925925447, 21.22029138095506, 4.346858986256507, 15.462510588155773, -0.16155458064869777, -10.381380639166824, -8.114362217919698, 6.747582581729388, -18.334073286346023, -6.893982284723336, 0.3995670952180177, 7.581326318995262, -16.086811686424493, -21.006330738840617, -25.226854383750315, 6.575713668045388, -26.562108901189582, -2.767158672272757, -2.928272510916507, -7.340898707386536, 5.30788073913989, -22.35977026366662, -7.333557165837917, 0.720274579509109, 6.616800943848617, 3.0408301576277594, -14.309162048334713, -2.593067235999989, -28.419164393770238, -13.31528738622448, -13.856669534327587, -35.0883781770192, 4.476725273364643, 5.826721054384514, -3.450671912906543, 2.526308317515067, -13.165599719255031, 4.405094821297254, 6.383265302531996, -13.473910306101725, -0.9073764404763196, -22.88405614893981, 0.6237591678656784, 14.436903578182054, 2.378981968787677, -17.117413504130397, 0.04873204396781006, 3.2318465893260093, -7.072333598006541, -32.01830266522848, -31.67508813073372, -2.355485128297495, -5.569124511077902, -7.253804563537013, -34.19891915515392, -18.975298058965407, -2.291796461609213, 4.223915341924275, -23.26843202086778, -15.102965036496702, -11.819638075730264, -15.669565476023116, -0.013960105041348925, -20.770096063170303, 36.55008536719455, -3.085365668336376, 2.59785531996004, -18.251411783321103, -23.601136180884463, 10.438869733304813, 7.573763914889675, -17.07074080394782, -23.245955768049612, -24.87869691432905, -13.623310248406487, 4.157600947920109, 7.784834742450201, -14.593005574397544, -21.570648023429506, -0.6288438539152139, -20.360870290973097, 5.729136681645926, -16.42435849238176, -28.040293192822723, 6.373512011273839, -17.762476731074887, -0.10802544063754738, 15.837465668702507, 4.243179952520471, 4.111389305192354, 22.234352172707986, 18.513603130569727, -8.175313514617542, 1.8553206433680955, 18.41344615052585, 4.462170053322318, 3.5647926132680894, 9.880333955742842, -26.97568691261646, 10.548524106049342, 3.2175901216118454, 12.060313531014756, 6.96357630505734, -2.5817196563211056, -20.83459586470903, -8.797219151484061, 6.439384996784895, 4.716758258799921, -17.148343477522058, -3.824929998222334, -22.213625229388747, -1.9989446609125352, 9.566009898476658, -25.589655802435946, -12.798043645313268, -19.988698140216123, -3.971741431215733, -16.87211546639446, -10.345722877812522, -18.5423008212707, -22.217662354145858, -6.710830138502647, -29.237007531412715, -5.345825701168543, -10.651224559452633, -11.896243463960879, -6.349474656479245, -8.137514537542152, -17.784506570272832, -13.344542371790958, -2.296053572045647, 4.573508715049985, -24.53330395041486, -5.12641317737447, -2.1108322798334243, -31.715676116229595, 4.031797868230335, 7.101428184176626, -0.4584290821307846, 14.12638661384733, -33.06393480381444, -23.370363319076723, 26.292013222376013, -4.238667711489001, -10.308852088578337, -16.42887044844892, 22.612415391084348, -1.8983917682398044, -3.5295706238667606, -23.99885420494209, 9.190852857150524, -25.694233123653653, -9.218856907110982, -26.56151939776232, 0.23056942026238758, -4.0171315626564095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4151195634875959, "mean_inference_ms": 1.089180135716469, "mean_action_processing_ms": 0.17842039194595558, "mean_env_wait_ms": 0.07206650781575127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003815293312072754, "StateBufferConnector_ms": 0.0026453733444213867, "ViewRequirementAgentConnector_ms": 0.06734240055084229}, "num_episodes": 11, "episode_return_max": 20.373977651638853, "episode_return_min": -29.12415392997981, "episode_return_mean": -6.817817994418281}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 491.33022849738967, "num_env_steps_trained_throughput_per_sec": 491.33022849738967, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 8114.805, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8114.773, "sample_time_ms": 760.073, "learn_time_ms": 7341.435, "learn_throughput": 544.853, "synch_weights_time_ms": 12.688}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 192, "trial_id": "83a5c_00000", "date": "2024-08-10_12-40-57", "timestamp": 1723308057, "time_this_iter_s": 8.146888017654419, "time_total_s": 1617.4503786563873, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd80a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1617.4503786563873, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 25.616666666666664, "ram_util_percent": 82.90833333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.347558826744241, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.10867223619784, "policy_loss": -0.008462203446425813, "vf_loss": 2.1162188907148978, "vf_explained_var": 0.07204563308645177, "kl": 0.010704885332244559, "entropy": 0.9970415104949285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.536114463955164, "cur_kl_coeff": 3.0384992465219646e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.095399715875586, "policy_loss": -0.005628929606852277, "vf_loss": 2.10102865571777, "vf_explained_var": 0.532995703133444, "kl": 0.004052446895275219, "entropy": 0.28885276544218264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 184800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "env_runners": {"episode_reward_max": 20.373977651638853, "episode_reward_min": -29.12415392997981, "episode_reward_mean": -7.037562276049348, "episode_len_mean": 362.05, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36205, "policy_reward_min": {"agent_policy": -20.373977651638857, "adversary_policy": -39.35374950071296}, "policy_reward_max": {"agent_policy": 29.124153929979805, "adversary_policy": 36.55008536719455}, "policy_reward_mean": {"agent_policy": 7.037562276049346, "adversary_policy": -7.037562276049348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.945671755709057, -4.299090155360346, -6.723167241159841, -12.877781904681449, -29.12415392997981, 0.8226323023409563, -18.01248582599783, -10.04062305244571, -20.274406386581738, 6.324876704427792, -20.516732864976188, -18.974791063254546, 14.843260653440254, 9.904684787206133, -5.271467609907761, -0.683389818095155, -12.614027785534677, 3.9904467071066403, -18.546571212632557, -9.325570357852463, -14.66463378673117, -5.134585609151522, -8.525944762263364, -3.3066412931644056, 4.828815550738188, -8.45111464216735, -20.86722588999736, -24.472523855673394, 5.151723163874578, -0.4621817976957381, -4.380252448978888, -3.545322501784865, -11.895716294708064, 7.530331373023866, -7.36921576767136, 1.6402893166469097, -19.545318131617506, -17.0152866295156, -6.411464537307458, -26.587108607059662, 0.9660594401575313, -19.18569852868224, -13.744601775876689, -10.392028084105828, 16.732359849429084, -7.826778231680532, -6.581133223789825, -4.748488444529073, -24.062326341189355, -4.732854650243189, -3.4040854159736718, -11.09974593867236, -7.315866804663585, -22.232325842602243, -5.694482359900524, 7.86472011403248, 4.177284628856411, 20.373977651638853, -3.159996435624725, 11.437808101924087, 6.7225632845054655, -8.21358140328356, 7.638951826313315, 2.190928324368117, -14.815907508096544, 5.578071627792408, -10.486636737872196, -12.106284945150644, -8.011822951979642, -16.393370892764715, -10.421928448805097, -14.444011849541614, -14.464246246324251, -17.29141661629063, -11.273734011706754, -7.243494597010695, -15.564524471031898, 1.138727571502169, -14.829858563894657, -16.913254198031506, 5.566613026203479, 6.833978765858273, -28.217149061445582, 11.026672755443508, -13.36886126851363, 10.357011811422272, -13.76421241440443, -8.251690133251566, -17.890188152436654, -1.8932810711970038, -16.337441644216987, 7.689223292800582, -13.65828506868398, 12.909852579826744, -2.1066264122190343, -5.599766815653018, -8.504623974797115, -11.493879052406534, -15.425483987394824, -15.96765072021941], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 7, 400, 400, 400, 400, 400, 7, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 22, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [18.94567175570904, 4.299090155360348, 6.723167241159841, 12.877781904681449, 29.124153929979805, -0.8226323023409563, 18.01248582599783, 10.04062305244571, 20.274406386581735, -6.3248767044277905, 20.51673286497619, 18.974791063254546, -14.843260653440254, -9.90468478720614, 5.271467609907761, 0.6833898180951551, 12.614027785534681, -3.99044670710664, 18.54657121263255, 9.325570357852463, 14.664633786731173, 5.13458560915152, 8.525944762263364, 3.3066412931644074, -4.828815550738188, 8.45111464216735, 20.867225889997357, 24.472523855673398, -5.151723163874578, 0.4621817976957381, 4.380252448978888, 3.545322501784865, 11.895716294708064, -7.530331373023866, 7.36921576767136, -1.6402893166469097, 19.545318131617506, 17.015286629515607, 6.411464537307458, 26.58710860705966, -0.9660594401575331, 19.185698528682245, 13.74460177587669, 10.392028084105826, -16.732359849429088, 7.826778231680532, 6.581133223789825, 4.748488444529073, 24.06232634118935, 4.732854650243189, 3.4040854159736718, 11.09974593867236, 7.315866804663585, 22.232325842602247, 5.694482359900524, -7.864720114032478, -4.177284628856414, -20.373977651638857, 3.159996435624725, -11.43780810192408, -6.7225632845054655, 8.21358140328356, -7.638951826313312, -2.190928324368117, 14.815907508096544, -5.578071627792408, 10.486636737872196, 12.106284945150641, 8.011822951979642, 16.393370892764697, 10.421928448805097, 14.444011849541615, 14.464246246324251, 17.29141661629063, 11.273734011706761, 7.243494597010702, 15.564524471031884, -1.138727571502169, 14.829858563894659, 16.91325419803151, -5.566613026203475, -6.833978765858273, 28.21714906144558, -11.026672755443506, 13.368861268513628, -10.357011811422272, 13.764212414404426, 8.251690133251566, 17.890188152436654, 1.8932810711970092, 16.337441644216987, -7.68922329280058, 13.65828506868398, -12.909852579826746, 2.1066264122190343, 5.599766815653018, 8.504623974797115, 11.49387905240653, 15.425483987394824, 15.967650720219407], "policy_adversary_policy_reward": [-30.022371461284436, -7.868972050133664, 5.143125693770408, -13.741306004491104, 7.99225014528718, -21.43858462760686, -27.361052457408054, 1.605488648045153, -18.894558359246666, -39.35374950071296, 13.16740213959811, -11.522137534916197, -11.74392632328426, -24.281045328711407, -7.812863014383211, -12.268383090508209, -25.647974780960602, -14.900837992202874, 9.94376259914424, 2.705990809711343, -29.541469348921524, -11.491996381030866, -17.918414444656698, -20.0311676818524, 8.466229925925447, 21.22029138095506, 4.346858986256507, 15.462510588155773, -0.16155458064869777, -10.381380639166824, -8.114362217919698, 6.747582581729388, -18.334073286346023, -6.893982284723336, 0.3995670952180177, 7.581326318995262, -16.086811686424493, -21.006330738840617, -25.226854383750315, 6.575713668045388, -26.562108901189582, -2.767158672272757, -2.928272510916507, -7.340898707386536, 5.30788073913989, -22.35977026366662, -7.333557165837917, 0.720274579509109, 6.616800943848617, 3.0408301576277594, -14.309162048334713, -2.593067235999989, -28.419164393770238, -13.31528738622448, -13.856669534327587, -35.0883781770192, 4.476725273364643, 5.826721054384514, -3.450671912906543, 2.526308317515067, -13.165599719255031, 4.405094821297254, 6.383265302531996, -13.473910306101725, -0.9073764404763196, -22.88405614893981, 0.6237591678656784, 14.436903578182054, 2.378981968787677, -17.117413504130397, 0.04873204396781006, 3.2318465893260093, -7.072333598006541, -32.01830266522848, -31.67508813073372, -2.355485128297495, -5.569124511077902, -7.253804563537013, -34.19891915515392, -18.975298058965407, -2.291796461609213, 4.223915341924275, -23.26843202086778, -15.102965036496702, -11.819638075730264, -15.669565476023116, -0.013960105041348925, -20.770096063170303, 36.55008536719455, -3.085365668336376, 2.59785531996004, -18.251411783321103, -23.601136180884463, 10.438869733304813, 7.573763914889675, -17.07074080394782, -23.245955768049612, -24.87869691432905, -13.623310248406487, 4.157600947920109, 7.784834742450201, -14.593005574397544, -21.570648023429506, -0.6288438539152139, -20.360870290973097, 5.729136681645926, -16.42435849238176, -28.040293192822723, 6.373512011273839, -17.762476731074887, -0.10802544063754738, 15.837465668702507, 4.243179952520471, 4.111389305192354, 22.234352172707986, 18.513603130569727, -8.175313514617542, 1.8553206433680955, 18.41344615052585, 4.462170053322318, 3.5647926132680894, 9.880333955742842, -26.97568691261646, 10.548524106049342, 3.2175901216118454, 12.060313531014756, 6.96357630505734, -2.5817196563211056, -20.83459586470903, -8.797219151484061, 6.439384996784895, 4.716758258799921, -17.148343477522058, -3.824929998222334, -22.213625229388747, -1.9989446609125352, 9.566009898476658, -25.589655802435946, -12.798043645313268, -19.988698140216123, -3.971741431215733, -16.87211546639446, -10.345722877812522, -18.5423008212707, -22.217662354145858, -6.710830138502647, -29.237007531412715, -5.345825701168543, -10.651224559452633, -11.896243463960879, -6.349474656479245, -8.137514537542152, -17.784506570272832, -13.344542371790958, -2.296053572045647, 4.573508715049985, -24.53330395041486, -5.12641317737447, -2.1108322798334243, -31.715676116229595, 4.031797868230335, 7.101428184176626, -0.4584290821307846, 14.12638661384733, -33.06393480381444, -23.370363319076723, 26.292013222376013, -4.238667711489001, -10.308852088578337, -16.42887044844892, 22.612415391084348, -1.8983917682398044, -3.5295706238667606, -23.99885420494209, 9.190852857150524, -25.694233123653653, -9.218856907110982, -26.56151939776232, 0.23056942026238758, -4.0171315626564095, -3.6204149414838653, -29.054468346950095, 15.94333097522894, -0.5648843896277782, -13.099243750093692, -14.21732638727427, 6.561477392499977, 19.258227767153507, 10.933277921873305, -15.146530746311374, -12.464986556104815, 1.2654529247987796, 2.946546712697838, -19.955794662292067, -21.09045608341955, -1.8973020213935072, -2.2830486210542684, -28.567919353735377, -23.17481956340891, -8.760481877029914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149613284538273, "mean_inference_ms": 1.0888898410527412, "mean_action_processing_ms": 0.17843916497984924, "mean_env_wait_ms": 0.07202171712215712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003925800323486328, "StateBufferConnector_ms": 0.0027000904083251953, "ViewRequirementAgentConnector_ms": 0.0688859224319458}, "num_episodes": 10, "episode_return_max": 20.373977651638853, "episode_return_min": -29.12415392997981, "episode_return_mean": -7.037562276049348}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 498.56352435328284, "num_env_steps_trained_throughput_per_sec": 498.56352435328284, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 2316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2316000, "timers": {"training_iteration_time_ms": 8094.505, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8094.472, "sample_time_ms": 773.607, "learn_time_ms": 7307.525, "learn_throughput": 547.381, "synch_weights_time_ms": 12.766}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 2316000, "num_agent_steps_trained": 2316000}, "done": false, "training_iteration": 193, "trial_id": "83a5c_00000", "date": "2024-08-10_12-41-05", "timestamp": 1723308065, "time_this_iter_s": 8.028334856033325, "time_total_s": 1625.4787135124207, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd52430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1625.4787135124207, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 25.94545454545455, "ram_util_percent": 82.92727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1129395562504967, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.741952226212416, "policy_loss": -0.009616282152593452, "vf_loss": 2.750869460963698, "vf_explained_var": -0.5415615963872779, "kl": 0.0081734539249257, "entropy": 1.0009848282450722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.818951290224989, "cur_kl_coeff": 1.5192496232609823e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5099006527413925, "policy_loss": -0.008404110325136572, "vf_loss": 2.5183047643552223, "vf_explained_var": 0.16693122771879038, "kl": 0.005860035601857779, "entropy": 0.3023078569521507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 185760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "env_runners": {"episode_reward_max": 20.373977651638853, "episode_reward_min": -29.157405418874944, "episode_reward_mean": -7.035566847097303, "episode_len_mean": 365.98, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 36598, "policy_reward_min": {"agent_policy": -20.373977651638857, "adversary_policy": -35.0883781770192}, "policy_reward_max": {"agent_policy": 29.157405418874934, "adversary_policy": 36.55008536719455}, "policy_reward_mean": {"agent_policy": 7.035566847097303, "adversary_policy": -7.035566847097303}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.974791063254546, 14.843260653440254, 9.904684787206133, -5.271467609907761, -0.683389818095155, -12.614027785534677, 3.9904467071066403, -18.546571212632557, -9.325570357852463, -14.66463378673117, -5.134585609151522, -8.525944762263364, -3.3066412931644056, 4.828815550738188, -8.45111464216735, -20.86722588999736, -24.472523855673394, 5.151723163874578, -0.4621817976957381, -4.380252448978888, -3.545322501784865, -11.895716294708064, 7.530331373023866, -7.36921576767136, 1.6402893166469097, -19.545318131617506, -17.0152866295156, -6.411464537307458, -26.587108607059662, 0.9660594401575313, -19.18569852868224, -13.744601775876689, -10.392028084105828, 16.732359849429084, -7.826778231680532, -6.581133223789825, -4.748488444529073, -24.062326341189355, -4.732854650243189, -3.4040854159736718, -11.09974593867236, -7.315866804663585, -22.232325842602243, -5.694482359900524, 7.86472011403248, 4.177284628856411, 20.373977651638853, -3.159996435624725, 11.437808101924087, 6.7225632845054655, -8.21358140328356, 7.638951826313315, 2.190928324368117, -14.815907508096544, 5.578071627792408, -10.486636737872196, -12.106284945150644, -8.011822951979642, -16.393370892764715, -10.421928448805097, -14.444011849541614, -14.464246246324251, -17.29141661629063, -11.273734011706754, -7.243494597010695, -15.564524471031898, 1.138727571502169, -14.829858563894657, -16.913254198031506, 5.566613026203479, 6.833978765858273, -28.217149061445582, 11.026672755443508, -13.36886126851363, 10.357011811422272, -13.76421241440443, -8.251690133251566, -17.890188152436654, -1.8932810711970038, -16.337441644216987, 7.689223292800582, -13.65828506868398, 12.909852579826744, -2.1066264122190343, -5.599766815653018, -8.504623974797115, -11.493879052406534, -15.425483987394824, -15.96765072021941, -9.556332276832245, -12.981164962315852, -25.730389254711596, -18.012250197882686, 9.6819200192799, -2.8199595756344795, -5.306468031221007, -14.029259062890276, -23.4957054774532, -29.157405418874944, -2.060046976382445], "episode_lengths": [400, 400, 400, 400, 7, 400, 7, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 22, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [18.974791063254546, -14.843260653440254, -9.90468478720614, 5.271467609907761, 0.6833898180951551, 12.614027785534681, -3.99044670710664, 18.54657121263255, 9.325570357852463, 14.664633786731173, 5.13458560915152, 8.525944762263364, 3.3066412931644074, -4.828815550738188, 8.45111464216735, 20.867225889997357, 24.472523855673398, -5.151723163874578, 0.4621817976957381, 4.380252448978888, 3.545322501784865, 11.895716294708064, -7.530331373023866, 7.36921576767136, -1.6402893166469097, 19.545318131617506, 17.015286629515607, 6.411464537307458, 26.58710860705966, -0.9660594401575331, 19.185698528682245, 13.74460177587669, 10.392028084105826, -16.732359849429088, 7.826778231680532, 6.581133223789825, 4.748488444529073, 24.06232634118935, 4.732854650243189, 3.4040854159736718, 11.09974593867236, 7.315866804663585, 22.232325842602247, 5.694482359900524, -7.864720114032478, -4.177284628856414, -20.373977651638857, 3.159996435624725, -11.43780810192408, -6.7225632845054655, 8.21358140328356, -7.638951826313312, -2.190928324368117, 14.815907508096544, -5.578071627792408, 10.486636737872196, 12.106284945150641, 8.011822951979642, 16.393370892764697, 10.421928448805097, 14.444011849541615, 14.464246246324251, 17.29141661629063, 11.273734011706761, 7.243494597010702, 15.564524471031884, -1.138727571502169, 14.829858563894659, 16.91325419803151, -5.566613026203475, -6.833978765858273, 28.21714906144558, -11.026672755443506, 13.368861268513628, -10.357011811422272, 13.764212414404426, 8.251690133251566, 17.890188152436654, 1.8932810711970092, 16.337441644216987, -7.68922329280058, 13.65828506868398, -12.909852579826746, 2.1066264122190343, 5.599766815653018, 8.504623974797115, 11.49387905240653, 15.425483987394824, 15.967650720219407, 9.556332276832245, 12.981164962315852, 25.730389254711593, 18.012250197882683, -9.6819200192799, 2.8199595756344795, 5.306468031221007, 14.029259062890276, 23.495705477453196, 29.157405418874934, 2.060046976382445], "policy_adversary_policy_reward": [-17.918414444656698, -20.0311676818524, 8.466229925925447, 21.22029138095506, 4.346858986256507, 15.462510588155773, -0.16155458064869777, -10.381380639166824, -8.114362217919698, 6.747582581729388, -18.334073286346023, -6.893982284723336, 0.3995670952180177, 7.581326318995262, -16.086811686424493, -21.006330738840617, -25.226854383750315, 6.575713668045388, -26.562108901189582, -2.767158672272757, -2.928272510916507, -7.340898707386536, 5.30788073913989, -22.35977026366662, -7.333557165837917, 0.720274579509109, 6.616800943848617, 3.0408301576277594, -14.309162048334713, -2.593067235999989, -28.419164393770238, -13.31528738622448, -13.856669534327587, -35.0883781770192, 4.476725273364643, 5.826721054384514, -3.450671912906543, 2.526308317515067, -13.165599719255031, 4.405094821297254, 6.383265302531996, -13.473910306101725, -0.9073764404763196, -22.88405614893981, 0.6237591678656784, 14.436903578182054, 2.378981968787677, -17.117413504130397, 0.04873204396781006, 3.2318465893260093, -7.072333598006541, -32.01830266522848, -31.67508813073372, -2.355485128297495, -5.569124511077902, -7.253804563537013, -34.19891915515392, -18.975298058965407, -2.291796461609213, 4.223915341924275, -23.26843202086778, -15.102965036496702, -11.819638075730264, -15.669565476023116, -0.013960105041348925, -20.770096063170303, 36.55008536719455, -3.085365668336376, 2.59785531996004, -18.251411783321103, -23.601136180884463, 10.438869733304813, 7.573763914889675, -17.07074080394782, -23.245955768049612, -24.87869691432905, -13.623310248406487, 4.157600947920109, 7.784834742450201, -14.593005574397544, -21.570648023429506, -0.6288438539152139, -20.360870290973097, 5.729136681645926, -16.42435849238176, -28.040293192822723, 6.373512011273839, -17.762476731074887, -0.10802544063754738, 15.837465668702507, 4.243179952520471, 4.111389305192354, 22.234352172707986, 18.513603130569727, -8.175313514617542, 1.8553206433680955, 18.41344615052585, 4.462170053322318, 3.5647926132680894, 9.880333955742842, -26.97568691261646, 10.548524106049342, 3.2175901216118454, 12.060313531014756, 6.96357630505734, -2.5817196563211056, -20.83459586470903, -8.797219151484061, 6.439384996784895, 4.716758258799921, -17.148343477522058, -3.824929998222334, -22.213625229388747, -1.9989446609125352, 9.566009898476658, -25.589655802435946, -12.798043645313268, -19.988698140216123, -3.971741431215733, -16.87211546639446, -10.345722877812522, -18.5423008212707, -22.217662354145858, -6.710830138502647, -29.237007531412715, -5.345825701168543, -10.651224559452633, -11.896243463960879, -6.349474656479245, -8.137514537542152, -17.784506570272832, -13.344542371790958, -2.296053572045647, 4.573508715049985, -24.53330395041486, -5.12641317737447, -2.1108322798334243, -31.715676116229595, 4.031797868230335, 7.101428184176626, -0.4584290821307846, 14.12638661384733, -33.06393480381444, -23.370363319076723, 26.292013222376013, -4.238667711489001, -10.308852088578337, -16.42887044844892, 22.612415391084348, -1.8983917682398044, -3.5295706238667606, -23.99885420494209, 9.190852857150524, -25.694233123653653, -9.218856907110982, -26.56151939776232, 0.23056942026238758, -4.0171315626564095, -3.6204149414838653, -29.054468346950095, 15.94333097522894, -0.5648843896277782, -13.099243750093692, -14.21732638727427, 6.561477392499977, 19.258227767153507, 10.933277921873305, -15.146530746311374, -12.464986556104815, 1.2654529247987796, 2.946546712697838, -19.955794662292067, -21.09045608341955, -1.8973020213935072, -2.2830486210542684, -28.567919353735377, -23.17481956340891, -8.760481877029914, -14.688293809957283, -4.4243707437072075, 1.9986768950058007, -27.96100681963751, -29.102864759415183, -22.35791375000801, -14.530931110137704, -21.49356928562767, 7.564905111793941, 11.79893492676586, 3.285406546438921, -8.92532569770788, 2.7643429862740128, -13.37727904871602, -14.420584711540531, -13.637933414240017, -20.449659819270778, -26.541751135635636, -29.802451497934534, -28.512359339815315, -19.63906347235998, 15.518969519595089]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41480277371530844, "mean_inference_ms": 1.0883690250890472, "mean_action_processing_ms": 0.1783325638936976, "mean_env_wait_ms": 0.07197310945272019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038532018661499023, "StateBufferConnector_ms": 0.0026248693466186523, "ViewRequirementAgentConnector_ms": 0.06894385814666748}, "num_episodes": 11, "episode_return_max": 20.373977651638853, "episode_return_min": -29.157405418874944, "episode_return_mean": -7.035566847097303}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 500.48253269240655, "num_env_steps_trained_throughput_per_sec": 500.48253269240655, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 2328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2328000, "timers": {"training_iteration_time_ms": 8061.726, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8061.693, "sample_time_ms": 780.011, "learn_time_ms": 7268.16, "learn_throughput": 550.346, "synch_weights_time_ms": 12.941}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "done": false, "training_iteration": 194, "trial_id": "83a5c_00000", "date": "2024-08-10_12-41-13", "timestamp": 1723308073, "time_this_iter_s": 7.9974260330200195, "time_total_s": 1633.4761395454407, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc74ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1633.4761395454407, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 25.09166666666667, "ram_util_percent": 82.95833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7805981322571083, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.688446203299931, "policy_loss": -0.005264842817091713, "vf_loss": 2.693037366930139, "vf_explained_var": -0.11479471048350057, "kl": 0.007876865967805185, "entropy": 0.9831047859772173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.444259212662776, "cur_kl_coeff": 1.5192496232609823e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0211942239974934, "policy_loss": -0.007936061877505078, "vf_loss": 2.0291302777826785, "vf_explained_var": 0.4856544012203813, "kl": 0.012011473360837263, "entropy": 0.36658434520165123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 186720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "env_runners": {"episode_reward_max": 20.373977651638853, "episode_reward_min": -29.157405418874944, "episode_reward_mean": -7.154242760894148, "episode_len_mean": 373.84, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37384, "policy_reward_min": {"agent_policy": -20.373977651638857, "adversary_policy": -35.0883781770192}, "policy_reward_max": {"agent_policy": 29.157405418874934, "adversary_policy": 36.55008536719455}, "policy_reward_mean": {"agent_policy": 7.154242760894148, "adversary_policy": -7.154242760894149}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.134585609151522, -8.525944762263364, -3.3066412931644056, 4.828815550738188, -8.45111464216735, -20.86722588999736, -24.472523855673394, 5.151723163874578, -0.4621817976957381, -4.380252448978888, -3.545322501784865, -11.895716294708064, 7.530331373023866, -7.36921576767136, 1.6402893166469097, -19.545318131617506, -17.0152866295156, -6.411464537307458, -26.587108607059662, 0.9660594401575313, -19.18569852868224, -13.744601775876689, -10.392028084105828, 16.732359849429084, -7.826778231680532, -6.581133223789825, -4.748488444529073, -24.062326341189355, -4.732854650243189, -3.4040854159736718, -11.09974593867236, -7.315866804663585, -22.232325842602243, -5.694482359900524, 7.86472011403248, 4.177284628856411, 20.373977651638853, -3.159996435624725, 11.437808101924087, 6.7225632845054655, -8.21358140328356, 7.638951826313315, 2.190928324368117, -14.815907508096544, 5.578071627792408, -10.486636737872196, -12.106284945150644, -8.011822951979642, -16.393370892764715, -10.421928448805097, -14.444011849541614, -14.464246246324251, -17.29141661629063, -11.273734011706754, -7.243494597010695, -15.564524471031898, 1.138727571502169, -14.829858563894657, -16.913254198031506, 5.566613026203479, 6.833978765858273, -28.217149061445582, 11.026672755443508, -13.36886126851363, 10.357011811422272, -13.76421241440443, -8.251690133251566, -17.890188152436654, -1.8932810711970038, -16.337441644216987, 7.689223292800582, -13.65828506868398, 12.909852579826744, -2.1066264122190343, -5.599766815653018, -8.504623974797115, -11.493879052406534, -15.425483987394824, -15.96765072021941, -9.556332276832245, -12.981164962315852, -25.730389254711596, -18.012250197882686, 9.6819200192799, -2.8199595756344795, -5.306468031221007, -14.029259062890276, -23.4957054774532, -29.157405418874944, -2.060046976382445, -1.3722278242023798, 10.915107334077629, -13.321242211586508, -4.701205566603864, -20.614938363763496, 4.443673687164811, -14.610266625978337, 6.665732425275571, -18.606332489622297, -12.007951230700932], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 22, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [5.13458560915152, 8.525944762263364, 3.3066412931644074, -4.828815550738188, 8.45111464216735, 20.867225889997357, 24.472523855673398, -5.151723163874578, 0.4621817976957381, 4.380252448978888, 3.545322501784865, 11.895716294708064, -7.530331373023866, 7.36921576767136, -1.6402893166469097, 19.545318131617506, 17.015286629515607, 6.411464537307458, 26.58710860705966, -0.9660594401575331, 19.185698528682245, 13.74460177587669, 10.392028084105826, -16.732359849429088, 7.826778231680532, 6.581133223789825, 4.748488444529073, 24.06232634118935, 4.732854650243189, 3.4040854159736718, 11.09974593867236, 7.315866804663585, 22.232325842602247, 5.694482359900524, -7.864720114032478, -4.177284628856414, -20.373977651638857, 3.159996435624725, -11.43780810192408, -6.7225632845054655, 8.21358140328356, -7.638951826313312, -2.190928324368117, 14.815907508096544, -5.578071627792408, 10.486636737872196, 12.106284945150641, 8.011822951979642, 16.393370892764697, 10.421928448805097, 14.444011849541615, 14.464246246324251, 17.29141661629063, 11.273734011706761, 7.243494597010702, 15.564524471031884, -1.138727571502169, 14.829858563894659, 16.91325419803151, -5.566613026203475, -6.833978765858273, 28.21714906144558, -11.026672755443506, 13.368861268513628, -10.357011811422272, 13.764212414404426, 8.251690133251566, 17.890188152436654, 1.8932810711970092, 16.337441644216987, -7.68922329280058, 13.65828506868398, -12.909852579826746, 2.1066264122190343, 5.599766815653018, 8.504623974797115, 11.49387905240653, 15.425483987394824, 15.967650720219407, 9.556332276832245, 12.981164962315852, 25.730389254711593, 18.012250197882683, -9.6819200192799, 2.8199595756344795, 5.306468031221007, 14.029259062890276, 23.495705477453196, 29.157405418874934, 2.060046976382445, 1.3722278242023798, -10.915107334077629, 13.321242211586508, 4.701205566603864, 20.614938363763493, -4.443673687164811, 14.61026662597834, -6.665732425275571, 18.606332489622293, 12.007951230700932], "policy_adversary_policy_reward": [-2.928272510916507, -7.340898707386536, 5.30788073913989, -22.35977026366662, -7.333557165837917, 0.720274579509109, 6.616800943848617, 3.0408301576277594, -14.309162048334713, -2.593067235999989, -28.419164393770238, -13.31528738622448, -13.856669534327587, -35.0883781770192, 4.476725273364643, 5.826721054384514, -3.450671912906543, 2.526308317515067, -13.165599719255031, 4.405094821297254, 6.383265302531996, -13.473910306101725, -0.9073764404763196, -22.88405614893981, 0.6237591678656784, 14.436903578182054, 2.378981968787677, -17.117413504130397, 0.04873204396781006, 3.2318465893260093, -7.072333598006541, -32.01830266522848, -31.67508813073372, -2.355485128297495, -5.569124511077902, -7.253804563537013, -34.19891915515392, -18.975298058965407, -2.291796461609213, 4.223915341924275, -23.26843202086778, -15.102965036496702, -11.819638075730264, -15.669565476023116, -0.013960105041348925, -20.770096063170303, 36.55008536719455, -3.085365668336376, 2.59785531996004, -18.251411783321103, -23.601136180884463, 10.438869733304813, 7.573763914889675, -17.07074080394782, -23.245955768049612, -24.87869691432905, -13.623310248406487, 4.157600947920109, 7.784834742450201, -14.593005574397544, -21.570648023429506, -0.6288438539152139, -20.360870290973097, 5.729136681645926, -16.42435849238176, -28.040293192822723, 6.373512011273839, -17.762476731074887, -0.10802544063754738, 15.837465668702507, 4.243179952520471, 4.111389305192354, 22.234352172707986, 18.513603130569727, -8.175313514617542, 1.8553206433680955, 18.41344615052585, 4.462170053322318, 3.5647926132680894, 9.880333955742842, -26.97568691261646, 10.548524106049342, 3.2175901216118454, 12.060313531014756, 6.96357630505734, -2.5817196563211056, -20.83459586470903, -8.797219151484061, 6.439384996784895, 4.716758258799921, -17.148343477522058, -3.824929998222334, -22.213625229388747, -1.9989446609125352, 9.566009898476658, -25.589655802435946, -12.798043645313268, -19.988698140216123, -3.971741431215733, -16.87211546639446, -10.345722877812522, -18.5423008212707, -22.217662354145858, -6.710830138502647, -29.237007531412715, -5.345825701168543, -10.651224559452633, -11.896243463960879, -6.349474656479245, -8.137514537542152, -17.784506570272832, -13.344542371790958, -2.296053572045647, 4.573508715049985, -24.53330395041486, -5.12641317737447, -2.1108322798334243, -31.715676116229595, 4.031797868230335, 7.101428184176626, -0.4584290821307846, 14.12638661384733, -33.06393480381444, -23.370363319076723, 26.292013222376013, -4.238667711489001, -10.308852088578337, -16.42887044844892, 22.612415391084348, -1.8983917682398044, -3.5295706238667606, -23.99885420494209, 9.190852857150524, -25.694233123653653, -9.218856907110982, -26.56151939776232, 0.23056942026238758, -4.0171315626564095, -3.6204149414838653, -29.054468346950095, 15.94333097522894, -0.5648843896277782, -13.099243750093692, -14.21732638727427, 6.561477392499977, 19.258227767153507, 10.933277921873305, -15.146530746311374, -12.464986556104815, 1.2654529247987796, 2.946546712697838, -19.955794662292067, -21.09045608341955, -1.8973020213935072, -2.2830486210542684, -28.567919353735377, -23.17481956340891, -8.760481877029914, -14.688293809957283, -4.4243707437072075, 1.9986768950058007, -27.96100681963751, -29.102864759415183, -22.35791375000801, -14.530931110137704, -21.49356928562767, 7.564905111793941, 11.79893492676586, 3.285406546438921, -8.92532569770788, 2.7643429862740128, -13.37727904871602, -14.420584711540531, -13.637933414240017, -20.449659819270778, -26.541751135635636, -29.802451497934534, -28.512359339815315, -19.63906347235998, 15.518969519595089, -1.1485650432870997, -1.5958906051176598, 17.281010254688063, 4.549204413467194, -8.142008947094954, -18.500475476078062, 1.7084831053876428, -11.110894238595371, -10.365682077197494, -30.864194650329495, 3.41463822127988, 5.472709153049742, -4.337551100993382, -24.882982150963297, 13.077561316438917, 0.25390353411222577, -14.458516755054244, -22.754148224190363, -2.794084906440496, -21.22181755496137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4145949656636182, "mean_inference_ms": 1.0880401149780874, "mean_action_processing_ms": 0.17831395978790582, "mean_env_wait_ms": 0.07194850097303922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037647485733032227, "StateBufferConnector_ms": 0.002566814422607422, "ViewRequirementAgentConnector_ms": 0.06854641437530518}, "num_episodes": 10, "episode_return_max": 20.373977651638853, "episode_return_min": -29.157405418874944, "episode_return_mean": -7.154242760894148}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 487.5401771581432, "num_env_steps_trained_throughput_per_sec": 487.5401771581432, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 2340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2340000, "timers": {"training_iteration_time_ms": 8087.674, "restore_workers_time_ms": 0.012, "training_step_time_ms": 8087.628, "sample_time_ms": 778.587, "learn_time_ms": 7291.736, "learn_throughput": 548.566, "synch_weights_time_ms": 16.708}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 2340000, "num_agent_steps_trained": 2340000}, "done": false, "training_iteration": 195, "trial_id": "83a5c_00000", "date": "2024-08-10_12-41-21", "timestamp": 1723308081, "time_this_iter_s": 8.230293035507202, "time_total_s": 1641.7064325809479, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fbc8a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1641.7064325809479, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 27.518181818181816, "ram_util_percent": 82.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8409781399227323, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4784449367926866, "policy_loss": -0.006598214005248217, "vf_loss": 2.484590360916481, "vf_explained_var": -0.016475951324695003, "kl": 0.005294140257562764, "entropy": 0.996603113412857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.529321033197145, "cur_kl_coeff": 1.5192496232609823e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.952965432188163, "policy_loss": -0.01043672061811473, "vf_loss": 1.9634021461009978, "vf_explained_var": 0.2742338884000977, "kl": 0.029112806002398118, "entropy": 0.24295841671215992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 187680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 20.373977651638853, "episode_reward_min": -29.157405418874944, "episode_reward_mean": -7.169504098709535, "episode_len_mean": 369.92, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 36992, "policy_reward_min": {"agent_policy": -20.373977651638857, "adversary_policy": -34.19891915515392}, "policy_reward_max": {"agent_policy": 29.157405418874934, "adversary_policy": 36.55008536719455}, "policy_reward_mean": {"agent_policy": 7.169504098709535, "adversary_policy": -7.169504098709533}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.545322501784865, -11.895716294708064, 7.530331373023866, -7.36921576767136, 1.6402893166469097, -19.545318131617506, -17.0152866295156, -6.411464537307458, -26.587108607059662, 0.9660594401575313, -19.18569852868224, -13.744601775876689, -10.392028084105828, 16.732359849429084, -7.826778231680532, -6.581133223789825, -4.748488444529073, -24.062326341189355, -4.732854650243189, -3.4040854159736718, -11.09974593867236, -7.315866804663585, -22.232325842602243, -5.694482359900524, 7.86472011403248, 4.177284628856411, 20.373977651638853, -3.159996435624725, 11.437808101924087, 6.7225632845054655, -8.21358140328356, 7.638951826313315, 2.190928324368117, -14.815907508096544, 5.578071627792408, -10.486636737872196, -12.106284945150644, -8.011822951979642, -16.393370892764715, -10.421928448805097, -14.444011849541614, -14.464246246324251, -17.29141661629063, -11.273734011706754, -7.243494597010695, -15.564524471031898, 1.138727571502169, -14.829858563894657, -16.913254198031506, 5.566613026203479, 6.833978765858273, -28.217149061445582, 11.026672755443508, -13.36886126851363, 10.357011811422272, -13.76421241440443, -8.251690133251566, -17.890188152436654, -1.8932810711970038, -16.337441644216987, 7.689223292800582, -13.65828506868398, 12.909852579826744, -2.1066264122190343, -5.599766815653018, -8.504623974797115, -11.493879052406534, -15.425483987394824, -15.96765072021941, -9.556332276832245, -12.981164962315852, -25.730389254711596, -18.012250197882686, 9.6819200192799, -2.8199595756344795, -5.306468031221007, -14.029259062890276, -23.4957054774532, -29.157405418874944, -2.060046976382445, -1.3722278242023798, 10.915107334077629, -13.321242211586508, -4.701205566603864, -20.614938363763496, 4.443673687164811, -14.610266625978337, 6.665732425275571, -18.606332489622297, -12.007951230700932, -6.056496855852963, 2.4158735361536916, -15.238144743621412, -11.856892531499549, 3.0556715667735475, -1.8812080305176533, -17.954197810703654, -9.995285684905985, -2.6233382643528707, -7.012046547490916], "episode_lengths": [400, 400, 400, 400, 3, 400, 400, 400, 400, 400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 22, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [3.545322501784865, 11.895716294708064, -7.530331373023866, 7.36921576767136, -1.6402893166469097, 19.545318131617506, 17.015286629515607, 6.411464537307458, 26.58710860705966, -0.9660594401575331, 19.185698528682245, 13.74460177587669, 10.392028084105826, -16.732359849429088, 7.826778231680532, 6.581133223789825, 4.748488444529073, 24.06232634118935, 4.732854650243189, 3.4040854159736718, 11.09974593867236, 7.315866804663585, 22.232325842602247, 5.694482359900524, -7.864720114032478, -4.177284628856414, -20.373977651638857, 3.159996435624725, -11.43780810192408, -6.7225632845054655, 8.21358140328356, -7.638951826313312, -2.190928324368117, 14.815907508096544, -5.578071627792408, 10.486636737872196, 12.106284945150641, 8.011822951979642, 16.393370892764697, 10.421928448805097, 14.444011849541615, 14.464246246324251, 17.29141661629063, 11.273734011706761, 7.243494597010702, 15.564524471031884, -1.138727571502169, 14.829858563894659, 16.91325419803151, -5.566613026203475, -6.833978765858273, 28.21714906144558, -11.026672755443506, 13.368861268513628, -10.357011811422272, 13.764212414404426, 8.251690133251566, 17.890188152436654, 1.8932810711970092, 16.337441644216987, -7.68922329280058, 13.65828506868398, -12.909852579826746, 2.1066264122190343, 5.599766815653018, 8.504623974797115, 11.49387905240653, 15.425483987394824, 15.967650720219407, 9.556332276832245, 12.981164962315852, 25.730389254711593, 18.012250197882683, -9.6819200192799, 2.8199595756344795, 5.306468031221007, 14.029259062890276, 23.495705477453196, 29.157405418874934, 2.060046976382445, 1.3722278242023798, -10.915107334077629, 13.321242211586508, 4.701205566603864, 20.614938363763493, -4.443673687164811, 14.61026662597834, -6.665732425275571, 18.606332489622293, 12.007951230700932, 6.056496855852963, -2.4158735361536916, 15.238144743621415, 11.856892531499549, -3.0556715667735475, 1.8812080305176533, 17.954197810703654, 9.995285684905983, 2.6233382643528707, 7.012046547490916], "policy_adversary_policy_reward": [6.383265302531996, -13.473910306101725, -0.9073764404763196, -22.88405614893981, 0.6237591678656784, 14.436903578182054, 2.378981968787677, -17.117413504130397, 0.04873204396781006, 3.2318465893260093, -7.072333598006541, -32.01830266522848, -31.67508813073372, -2.355485128297495, -5.569124511077902, -7.253804563537013, -34.19891915515392, -18.975298058965407, -2.291796461609213, 4.223915341924275, -23.26843202086778, -15.102965036496702, -11.819638075730264, -15.669565476023116, -0.013960105041348925, -20.770096063170303, 36.55008536719455, -3.085365668336376, 2.59785531996004, -18.251411783321103, -23.601136180884463, 10.438869733304813, 7.573763914889675, -17.07074080394782, -23.245955768049612, -24.87869691432905, -13.623310248406487, 4.157600947920109, 7.784834742450201, -14.593005574397544, -21.570648023429506, -0.6288438539152139, -20.360870290973097, 5.729136681645926, -16.42435849238176, -28.040293192822723, 6.373512011273839, -17.762476731074887, -0.10802544063754738, 15.837465668702507, 4.243179952520471, 4.111389305192354, 22.234352172707986, 18.513603130569727, -8.175313514617542, 1.8553206433680955, 18.41344615052585, 4.462170053322318, 3.5647926132680894, 9.880333955742842, -26.97568691261646, 10.548524106049342, 3.2175901216118454, 12.060313531014756, 6.96357630505734, -2.5817196563211056, -20.83459586470903, -8.797219151484061, 6.439384996784895, 4.716758258799921, -17.148343477522058, -3.824929998222334, -22.213625229388747, -1.9989446609125352, 9.566009898476658, -25.589655802435946, -12.798043645313268, -19.988698140216123, -3.971741431215733, -16.87211546639446, -10.345722877812522, -18.5423008212707, -22.217662354145858, -6.710830138502647, -29.237007531412715, -5.345825701168543, -10.651224559452633, -11.896243463960879, -6.349474656479245, -8.137514537542152, -17.784506570272832, -13.344542371790958, -2.296053572045647, 4.573508715049985, -24.53330395041486, -5.12641317737447, -2.1108322798334243, -31.715676116229595, 4.031797868230335, 7.101428184176626, -0.4584290821307846, 14.12638661384733, -33.06393480381444, -23.370363319076723, 26.292013222376013, -4.238667711489001, -10.308852088578337, -16.42887044844892, 22.612415391084348, -1.8983917682398044, -3.5295706238667606, -23.99885420494209, 9.190852857150524, -25.694233123653653, -9.218856907110982, -26.56151939776232, 0.23056942026238758, -4.0171315626564095, -3.6204149414838653, -29.054468346950095, 15.94333097522894, -0.5648843896277782, -13.099243750093692, -14.21732638727427, 6.561477392499977, 19.258227767153507, 10.933277921873305, -15.146530746311374, -12.464986556104815, 1.2654529247987796, 2.946546712697838, -19.955794662292067, -21.09045608341955, -1.8973020213935072, -2.2830486210542684, -28.567919353735377, -23.17481956340891, -8.760481877029914, -14.688293809957283, -4.4243707437072075, 1.9986768950058007, -27.96100681963751, -29.102864759415183, -22.35791375000801, -14.530931110137704, -21.49356928562767, 7.564905111793941, 11.79893492676586, 3.285406546438921, -8.92532569770788, 2.7643429862740128, -13.37727904871602, -14.420584711540531, -13.637933414240017, -20.449659819270778, -26.541751135635636, -29.802451497934534, -28.512359339815315, -19.63906347235998, 15.518969519595089, -1.1485650432870997, -1.5958906051176598, 17.281010254688063, 4.549204413467194, -8.142008947094954, -18.500475476078062, 1.7084831053876428, -11.110894238595371, -10.365682077197494, -30.864194650329495, 3.41463822127988, 5.472709153049742, -4.337551100993382, -24.882982150963297, 13.077561316438917, 0.25390353411222577, -14.458516755054244, -22.754148224190363, -2.794084906440496, -21.22181755496137, -12.2602228277295, 0.14722911602357414, -3.7636216255710515, 8.595368697878435, -5.194194012173616, -25.282095475069216, -13.088243764466494, -10.625541298532603, -1.69653613876131, 7.807879272308405, 11.20039852729522, -14.962814588330527, -21.648202174353305, -14.260193447054004, -12.100006677043886, -7.890564692768077, -15.972247820618882, 10.725571291913141, -4.14462078598465, -9.879472308997183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41450918127772846, "mean_inference_ms": 1.087628375604338, "mean_action_processing_ms": 0.1782520726629703, "mean_env_wait_ms": 0.0719298339323208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003853440284729004, "StateBufferConnector_ms": 0.0026961565017700195, "ViewRequirementAgentConnector_ms": 0.07120585441589355}, "num_episodes": 10, "episode_return_max": 20.373977651638853, "episode_return_min": -29.157405418874944, "episode_return_mean": -7.169504098709535}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 475.6978572379841, "num_env_steps_trained_throughput_per_sec": 475.6978572379841, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 8141.045, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8140.991, "sample_time_ms": 799.173, "learn_time_ms": 7324.423, "learn_throughput": 546.118, "synch_weights_time_ms": 16.792}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 196, "trial_id": "83a5c_00000", "date": "2024-08-10_12-41-30", "timestamp": 1723308090, "time_this_iter_s": 8.41379976272583, "time_total_s": 1650.1202323436737, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd80a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1650.1202323436737, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 29.583333333333332, "ram_util_percent": 82.84999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0976031458882427, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5735181611681743, "policy_loss": -0.012636378167502621, "vf_loss": 3.5844621706261206, "vf_explained_var": -0.17858268855110046, "kl": 0.01978769486381803, "entropy": 1.028322333065921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.763188241546353, "cur_kl_coeff": 2.278874434891474e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.24476648910592, "policy_loss": -0.0034359457616422637, "vf_loss": 2.248202437783281, "vf_explained_var": 0.6793264289697011, "kl": 0.0026451528975963063, "entropy": 0.3186159955958525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 188640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "env_runners": {"episode_reward_max": 20.373977651638853, "episode_reward_min": -29.157405418874944, "episode_reward_mean": -6.899005757958372, "episode_len_mean": 373.89, "episode_media": {}, "episodes_this_iter": 9, "episodes_timesteps_total": 37389, "policy_reward_min": {"agent_policy": -20.373977651638857, "adversary_policy": -34.653647080257954}, "policy_reward_max": {"agent_policy": 29.157405418874934, "adversary_policy": 36.55008536719455}, "policy_reward_mean": {"agent_policy": 6.899005757958372, "adversary_policy": -6.899005757958371}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9660594401575313, -19.18569852868224, -13.744601775876689, -10.392028084105828, 16.732359849429084, -7.826778231680532, -6.581133223789825, -4.748488444529073, -24.062326341189355, -4.732854650243189, -3.4040854159736718, -11.09974593867236, -7.315866804663585, -22.232325842602243, -5.694482359900524, 7.86472011403248, 4.177284628856411, 20.373977651638853, -3.159996435624725, 11.437808101924087, 6.7225632845054655, -8.21358140328356, 7.638951826313315, 2.190928324368117, -14.815907508096544, 5.578071627792408, -10.486636737872196, -12.106284945150644, -8.011822951979642, -16.393370892764715, -10.421928448805097, -14.444011849541614, -14.464246246324251, -17.29141661629063, -11.273734011706754, -7.243494597010695, -15.564524471031898, 1.138727571502169, -14.829858563894657, -16.913254198031506, 5.566613026203479, 6.833978765858273, -28.217149061445582, 11.026672755443508, -13.36886126851363, 10.357011811422272, -13.76421241440443, -8.251690133251566, -17.890188152436654, -1.8932810711970038, -16.337441644216987, 7.689223292800582, -13.65828506868398, 12.909852579826744, -2.1066264122190343, -5.599766815653018, -8.504623974797115, -11.493879052406534, -15.425483987394824, -15.96765072021941, -9.556332276832245, -12.981164962315852, -25.730389254711596, -18.012250197882686, 9.6819200192799, -2.8199595756344795, -5.306468031221007, -14.029259062890276, -23.4957054774532, -29.157405418874944, -2.060046976382445, -1.3722278242023798, 10.915107334077629, -13.321242211586508, -4.701205566603864, -20.614938363763496, 4.443673687164811, -14.610266625978337, 6.665732425275571, -18.606332489622297, -12.007951230700932, -6.056496855852963, 2.4158735361536916, -15.238144743621412, -11.856892531499549, 3.0556715667735475, -1.8812080305176533, -17.954197810703654, -9.995285684905985, -2.6233382643528707, -7.012046547490916, -1.5440585381834584, -12.169976195731902, -13.50963321524109, -3.923666143950406, -4.747143122127483, -23.278966304375516, -10.537112496990087, 8.569954164746537, 4.99162414697593], "episode_lengths": [400, 400, 400, 400, 99, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 22, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [-0.9660594401575331, 19.185698528682245, 13.74460177587669, 10.392028084105826, -16.732359849429088, 7.826778231680532, 6.581133223789825, 4.748488444529073, 24.06232634118935, 4.732854650243189, 3.4040854159736718, 11.09974593867236, 7.315866804663585, 22.232325842602247, 5.694482359900524, -7.864720114032478, -4.177284628856414, -20.373977651638857, 3.159996435624725, -11.43780810192408, -6.7225632845054655, 8.21358140328356, -7.638951826313312, -2.190928324368117, 14.815907508096544, -5.578071627792408, 10.486636737872196, 12.106284945150641, 8.011822951979642, 16.393370892764697, 10.421928448805097, 14.444011849541615, 14.464246246324251, 17.29141661629063, 11.273734011706761, 7.243494597010702, 15.564524471031884, -1.138727571502169, 14.829858563894659, 16.91325419803151, -5.566613026203475, -6.833978765858273, 28.21714906144558, -11.026672755443506, 13.368861268513628, -10.357011811422272, 13.764212414404426, 8.251690133251566, 17.890188152436654, 1.8932810711970092, 16.337441644216987, -7.68922329280058, 13.65828506868398, -12.909852579826746, 2.1066264122190343, 5.599766815653018, 8.504623974797115, 11.49387905240653, 15.425483987394824, 15.967650720219407, 9.556332276832245, 12.981164962315852, 25.730389254711593, 18.012250197882683, -9.6819200192799, 2.8199595756344795, 5.306468031221007, 14.029259062890276, 23.495705477453196, 29.157405418874934, 2.060046976382445, 1.3722278242023798, -10.915107334077629, 13.321242211586508, 4.701205566603864, 20.614938363763493, -4.443673687164811, 14.61026662597834, -6.665732425275571, 18.606332489622293, 12.007951230700932, 6.056496855852963, -2.4158735361536916, 15.238144743621415, 11.856892531499549, -3.0556715667735475, 1.8812080305176533, 17.954197810703654, 9.995285684905983, 2.6233382643528707, 7.012046547490916, 1.5440585381834566, 12.169976195731902, 13.50963321524109, 3.923666143950406, 4.747143122127477, 23.27896630437552, 10.537112496990087, -8.569954164746537, -4.99162414697593], "policy_adversary_policy_reward": [-2.291796461609213, 4.223915341924275, -23.26843202086778, -15.102965036496702, -11.819638075730264, -15.669565476023116, -0.013960105041348925, -20.770096063170303, 36.55008536719455, -3.085365668336376, 2.59785531996004, -18.251411783321103, -23.601136180884463, 10.438869733304813, 7.573763914889675, -17.07074080394782, -23.245955768049612, -24.87869691432905, -13.623310248406487, 4.157600947920109, 7.784834742450201, -14.593005574397544, -21.570648023429506, -0.6288438539152139, -20.360870290973097, 5.729136681645926, -16.42435849238176, -28.040293192822723, 6.373512011273839, -17.762476731074887, -0.10802544063754738, 15.837465668702507, 4.243179952520471, 4.111389305192354, 22.234352172707986, 18.513603130569727, -8.175313514617542, 1.8553206433680955, 18.41344615052585, 4.462170053322318, 3.5647926132680894, 9.880333955742842, -26.97568691261646, 10.548524106049342, 3.2175901216118454, 12.060313531014756, 6.96357630505734, -2.5817196563211056, -20.83459586470903, -8.797219151484061, 6.439384996784895, 4.716758258799921, -17.148343477522058, -3.824929998222334, -22.213625229388747, -1.9989446609125352, 9.566009898476658, -25.589655802435946, -12.798043645313268, -19.988698140216123, -3.971741431215733, -16.87211546639446, -10.345722877812522, -18.5423008212707, -22.217662354145858, -6.710830138502647, -29.237007531412715, -5.345825701168543, -10.651224559452633, -11.896243463960879, -6.349474656479245, -8.137514537542152, -17.784506570272832, -13.344542371790958, -2.296053572045647, 4.573508715049985, -24.53330395041486, -5.12641317737447, -2.1108322798334243, -31.715676116229595, 4.031797868230335, 7.101428184176626, -0.4584290821307846, 14.12638661384733, -33.06393480381444, -23.370363319076723, 26.292013222376013, -4.238667711489001, -10.308852088578337, -16.42887044844892, 22.612415391084348, -1.8983917682398044, -3.5295706238667606, -23.99885420494209, 9.190852857150524, -25.694233123653653, -9.218856907110982, -26.56151939776232, 0.23056942026238758, -4.0171315626564095, -3.6204149414838653, -29.054468346950095, 15.94333097522894, -0.5648843896277782, -13.099243750093692, -14.21732638727427, 6.561477392499977, 19.258227767153507, 10.933277921873305, -15.146530746311374, -12.464986556104815, 1.2654529247987796, 2.946546712697838, -19.955794662292067, -21.09045608341955, -1.8973020213935072, -2.2830486210542684, -28.567919353735377, -23.17481956340891, -8.760481877029914, -14.688293809957283, -4.4243707437072075, 1.9986768950058007, -27.96100681963751, -29.102864759415183, -22.35791375000801, -14.530931110137704, -21.49356928562767, 7.564905111793941, 11.79893492676586, 3.285406546438921, -8.92532569770788, 2.7643429862740128, -13.37727904871602, -14.420584711540531, -13.637933414240017, -20.449659819270778, -26.541751135635636, -29.802451497934534, -28.512359339815315, -19.63906347235998, 15.518969519595089, -1.1485650432870997, -1.5958906051176598, 17.281010254688063, 4.549204413467194, -8.142008947094954, -18.500475476078062, 1.7084831053876428, -11.110894238595371, -10.365682077197494, -30.864194650329495, 3.41463822127988, 5.472709153049742, -4.337551100993382, -24.882982150963297, 13.077561316438917, 0.25390353411222577, -14.458516755054244, -22.754148224190363, -2.794084906440496, -21.22181755496137, -12.2602228277295, 0.14722911602357414, -3.7636216255710515, 8.595368697878435, -5.194194012173616, -25.282095475069216, -13.088243764466494, -10.625541298532603, -1.69653613876131, 7.807879272308405, 11.20039852729522, -14.962814588330527, -21.648202174353305, -14.260193447054004, -12.100006677043886, -7.890564692768077, -15.972247820618882, 10.725571291913141, -4.14462078598465, -9.879472308997183, -7.894768184534609, 4.806651108167699, -7.207487333247549, -17.13246505821625, -9.62848611913764, -17.39078031134454, -18.30430968144568, 10.456977393544868, -14.274554904264079, 4.7802686600091135, -34.653647080257954, -11.904285528493098, -27.915294362335914, 6.84106936835574, 16.579794563209198, 0.5601137662838767, 4.444998589326445, 5.538249704625414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41438486131010477, "mean_inference_ms": 1.0873222659418986, "mean_action_processing_ms": 0.17820884504314777, "mean_env_wait_ms": 0.0718964683164574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037287473678588867, "StateBufferConnector_ms": 0.0026320219039916992, "ViewRequirementAgentConnector_ms": 0.07040810585021973}, "num_episodes": 9, "episode_return_max": 20.373977651638853, "episode_return_min": -29.157405418874944, "episode_return_mean": -6.899005757958372}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 479.5094998506214, "num_env_steps_trained_throughput_per_sec": 479.5094998506214, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 2364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2364000, "timers": {"training_iteration_time_ms": 8192.348, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8192.293, "sample_time_ms": 804.428, "learn_time_ms": 7370.154, "learn_throughput": 542.73, "synch_weights_time_ms": 17.096}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 2364000, "num_agent_steps_trained": 2364000}, "done": false, "training_iteration": 197, "trial_id": "83a5c_00000", "date": "2024-08-10_12-41-38", "timestamp": 1723308098, "time_this_iter_s": 8.348383903503418, "time_total_s": 1658.4686162471771, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fdebaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1658.4686162471771, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 29.85833333333333, "ram_util_percent": 82.65833333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6243134410293014, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.29185573423981, "policy_loss": -0.005819095839825139, "vf_loss": 5.297085475417041, "vf_explained_var": -0.045050799278985885, "kl": 0.00689081247465828, "entropy": 1.1739809211599763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.998282180850705, "cur_kl_coeff": 1.139437217445737e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.418059637149175, "policy_loss": -0.005129846623458434, "vf_loss": 4.423189486811558, "vf_explained_var": 0.19981018491089345, "kl": 0.006475491635785344, "entropy": 0.3417969576548785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 189600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "env_runners": {"episode_reward_max": 20.373977651638853, "episode_reward_min": -35.452317559290385, "episode_reward_mean": -7.640293293882878, "episode_len_mean": 372.99, "episode_media": {}, "episodes_this_iter": 11, "episodes_timesteps_total": 37299, "policy_reward_min": {"agent_policy": -20.373977651638857, "adversary_policy": -37.914916664620165}, "policy_reward_max": {"agent_policy": 35.45231755929039, "adversary_policy": 26.292013222376013}, "policy_reward_mean": {"agent_policy": 7.640293293882878, "adversary_policy": -7.640293293882878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.09974593867236, -7.315866804663585, -22.232325842602243, -5.694482359900524, 7.86472011403248, 4.177284628856411, 20.373977651638853, -3.159996435624725, 11.437808101924087, 6.7225632845054655, -8.21358140328356, 7.638951826313315, 2.190928324368117, -14.815907508096544, 5.578071627792408, -10.486636737872196, -12.106284945150644, -8.011822951979642, -16.393370892764715, -10.421928448805097, -14.444011849541614, -14.464246246324251, -17.29141661629063, -11.273734011706754, -7.243494597010695, -15.564524471031898, 1.138727571502169, -14.829858563894657, -16.913254198031506, 5.566613026203479, 6.833978765858273, -28.217149061445582, 11.026672755443508, -13.36886126851363, 10.357011811422272, -13.76421241440443, -8.251690133251566, -17.890188152436654, -1.8932810711970038, -16.337441644216987, 7.689223292800582, -13.65828506868398, 12.909852579826744, -2.1066264122190343, -5.599766815653018, -8.504623974797115, -11.493879052406534, -15.425483987394824, -15.96765072021941, -9.556332276832245, -12.981164962315852, -25.730389254711596, -18.012250197882686, 9.6819200192799, -2.8199595756344795, -5.306468031221007, -14.029259062890276, -23.4957054774532, -29.157405418874944, -2.060046976382445, -1.3722278242023798, 10.915107334077629, -13.321242211586508, -4.701205566603864, -20.614938363763496, 4.443673687164811, -14.610266625978337, 6.665732425275571, -18.606332489622297, -12.007951230700932, -6.056496855852963, 2.4158735361536916, -15.238144743621412, -11.856892531499549, 3.0556715667735475, -1.8812080305176533, -17.954197810703654, -9.995285684905985, -2.6233382643528707, -7.012046547490916, -1.5440585381834584, -12.169976195731902, -13.50963321524109, -3.923666143950406, -4.747143122127483, -23.278966304375516, -10.537112496990087, 8.569954164746537, 4.99162414697593, -13.521403310678242, 5.183640159699602, -3.7665324446014647, -3.175809404152794, -35.452317559290385, -18.33323133216965, -11.625444126074227, -20.225058151930337, -16.38408318586595, -10.411394480249767, -23.39669516362134], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 22, 400, 400, 400, 13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [11.09974593867236, 7.315866804663585, 22.232325842602247, 5.694482359900524, -7.864720114032478, -4.177284628856414, -20.373977651638857, 3.159996435624725, -11.43780810192408, -6.7225632845054655, 8.21358140328356, -7.638951826313312, -2.190928324368117, 14.815907508096544, -5.578071627792408, 10.486636737872196, 12.106284945150641, 8.011822951979642, 16.393370892764697, 10.421928448805097, 14.444011849541615, 14.464246246324251, 17.29141661629063, 11.273734011706761, 7.243494597010702, 15.564524471031884, -1.138727571502169, 14.829858563894659, 16.91325419803151, -5.566613026203475, -6.833978765858273, 28.21714906144558, -11.026672755443506, 13.368861268513628, -10.357011811422272, 13.764212414404426, 8.251690133251566, 17.890188152436654, 1.8932810711970092, 16.337441644216987, -7.68922329280058, 13.65828506868398, -12.909852579826746, 2.1066264122190343, 5.599766815653018, 8.504623974797115, 11.49387905240653, 15.425483987394824, 15.967650720219407, 9.556332276832245, 12.981164962315852, 25.730389254711593, 18.012250197882683, -9.6819200192799, 2.8199595756344795, 5.306468031221007, 14.029259062890276, 23.495705477453196, 29.157405418874934, 2.060046976382445, 1.3722278242023798, -10.915107334077629, 13.321242211586508, 4.701205566603864, 20.614938363763493, -4.443673687164811, 14.61026662597834, -6.665732425275571, 18.606332489622293, 12.007951230700932, 6.056496855852963, -2.4158735361536916, 15.238144743621415, 11.856892531499549, -3.0556715667735475, 1.8812080305176533, 17.954197810703654, 9.995285684905983, 2.6233382643528707, 7.012046547490916, 1.5440585381834566, 12.169976195731902, 13.50963321524109, 3.923666143950406, 4.747143122127477, 23.27896630437552, 10.537112496990087, -8.569954164746537, -4.99162414697593, 13.521403310678238, -5.183640159699602, 3.7665324446014647, 3.175809404152794, 35.45231755929039, 18.333231332169653, 11.625444126074225, 20.22505815193034, 16.38408318586595, 10.411394480249767, 23.396695163621345], "policy_adversary_policy_reward": [-21.570648023429506, -0.6288438539152139, -20.360870290973097, 5.729136681645926, -16.42435849238176, -28.040293192822723, 6.373512011273839, -17.762476731074887, -0.10802544063754738, 15.837465668702507, 4.243179952520471, 4.111389305192354, 22.234352172707986, 18.513603130569727, -8.175313514617542, 1.8553206433680955, 18.41344615052585, 4.462170053322318, 3.5647926132680894, 9.880333955742842, -26.97568691261646, 10.548524106049342, 3.2175901216118454, 12.060313531014756, 6.96357630505734, -2.5817196563211056, -20.83459586470903, -8.797219151484061, 6.439384996784895, 4.716758258799921, -17.148343477522058, -3.824929998222334, -22.213625229388747, -1.9989446609125352, 9.566009898476658, -25.589655802435946, -12.798043645313268, -19.988698140216123, -3.971741431215733, -16.87211546639446, -10.345722877812522, -18.5423008212707, -22.217662354145858, -6.710830138502647, -29.237007531412715, -5.345825701168543, -10.651224559452633, -11.896243463960879, -6.349474656479245, -8.137514537542152, -17.784506570272832, -13.344542371790958, -2.296053572045647, 4.573508715049985, -24.53330395041486, -5.12641317737447, -2.1108322798334243, -31.715676116229595, 4.031797868230335, 7.101428184176626, -0.4584290821307846, 14.12638661384733, -33.06393480381444, -23.370363319076723, 26.292013222376013, -4.238667711489001, -10.308852088578337, -16.42887044844892, 22.612415391084348, -1.8983917682398044, -3.5295706238667606, -23.99885420494209, 9.190852857150524, -25.694233123653653, -9.218856907110982, -26.56151939776232, 0.23056942026238758, -4.0171315626564095, -3.6204149414838653, -29.054468346950095, 15.94333097522894, -0.5648843896277782, -13.099243750093692, -14.21732638727427, 6.561477392499977, 19.258227767153507, 10.933277921873305, -15.146530746311374, -12.464986556104815, 1.2654529247987796, 2.946546712697838, -19.955794662292067, -21.09045608341955, -1.8973020213935072, -2.2830486210542684, -28.567919353735377, -23.17481956340891, -8.760481877029914, -14.688293809957283, -4.4243707437072075, 1.9986768950058007, -27.96100681963751, -29.102864759415183, -22.35791375000801, -14.530931110137704, -21.49356928562767, 7.564905111793941, 11.79893492676586, 3.285406546438921, -8.92532569770788, 2.7643429862740128, -13.37727904871602, -14.420584711540531, -13.637933414240017, -20.449659819270778, -26.541751135635636, -29.802451497934534, -28.512359339815315, -19.63906347235998, 15.518969519595089, -1.1485650432870997, -1.5958906051176598, 17.281010254688063, 4.549204413467194, -8.142008947094954, -18.500475476078062, 1.7084831053876428, -11.110894238595371, -10.365682077197494, -30.864194650329495, 3.41463822127988, 5.472709153049742, -4.337551100993382, -24.882982150963297, 13.077561316438917, 0.25390353411222577, -14.458516755054244, -22.754148224190363, -2.794084906440496, -21.22181755496137, -12.2602228277295, 0.14722911602357414, -3.7636216255710515, 8.595368697878435, -5.194194012173616, -25.282095475069216, -13.088243764466494, -10.625541298532603, -1.69653613876131, 7.807879272308405, 11.20039852729522, -14.962814588330527, -21.648202174353305, -14.260193447054004, -12.100006677043886, -7.890564692768077, -15.972247820618882, 10.725571291913141, -4.14462078598465, -9.879472308997183, -7.894768184534609, 4.806651108167699, -7.207487333247549, -17.13246505821625, -9.62848611913764, -17.39078031134454, -18.30430968144568, 10.456977393544868, -14.274554904264079, 4.7802686600091135, -34.653647080257954, -11.904285528493098, -27.915294362335914, 6.84106936835574, 16.579794563209198, 0.5601137662838767, 4.444998589326445, 5.538249704625414, -0.4794989813194128, -26.563307640037067, 0.33489115465971153, 10.032389164739493, 14.656615607682888, -22.189680496885817, 6.037135537594665, -12.388754345900253, -37.914916664620165, -32.9897184539606, -24.77605157753303, -11.890411086806292, -12.858008977182283, -10.39287927496617, -10.996678398932438, -29.453437904928244, -20.303943106873874, -12.464223264858031, -5.367930825975925, -15.454858134523608, -26.95868234076138, -19.834707986481316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4142475401304045, "mean_inference_ms": 1.086878049147408, "mean_action_processing_ms": 0.17814217292406428, "mean_env_wait_ms": 0.071856925551356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003580927848815918, "StateBufferConnector_ms": 0.002583742141723633, "ViewRequirementAgentConnector_ms": 0.0708993673324585}, "num_episodes": 11, "episode_return_max": 20.373977651638853, "episode_return_min": -35.452317559290385, "episode_return_mean": -7.640293293882878}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 485.25609257978164, "num_env_steps_trained_throughput_per_sec": 485.25609257978164, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 2376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2376000, "timers": {"training_iteration_time_ms": 8155.653, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8155.597, "sample_time_ms": 792.673, "learn_time_ms": 7345.008, "learn_throughput": 544.588, "synch_weights_time_ms": 17.3}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "done": false, "training_iteration": 198, "trial_id": "83a5c_00000", "date": "2024-08-10_12-41-46", "timestamp": 1723308106, "time_this_iter_s": 8.249335050582886, "time_total_s": 1666.71795129776, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fd58670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1666.71795129776, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 25.791666666666668, "ram_util_percent": 82.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5700579390323983, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.309475961816374, "policy_loss": -0.006653816053624112, "vf_loss": 5.315042000346714, "vf_explained_var": -0.13201964276808278, "kl": 0.012718670497400959, "entropy": 1.1755269430932545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.211437240801752, "cur_kl_coeff": 1.139437217445737e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9478406722346944, "policy_loss": -0.0036288808252720626, "vf_loss": 3.951469564437866, "vf_explained_var": 0.28170267964402834, "kl": 0.003802073700802407, "entropy": 0.25148177447263154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 190560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "env_runners": {"episode_reward_max": 29.197150048505364, "episode_reward_min": -35.452317559290385, "episode_reward_mean": -8.388185785494993, "episode_len_mean": 369.46, "episode_media": {}, "episodes_this_iter": 12, "episodes_timesteps_total": 36946, "policy_reward_min": {"agent_policy": -29.19715004850536, "adversary_policy": -37.914916664620165}, "policy_reward_max": {"agent_policy": 35.45231755929039, "adversary_policy": 34.39968439877876}, "policy_reward_mean": {"agent_policy": 8.388185785494993, "adversary_policy": -8.388185785494995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.190928324368117, -14.815907508096544, 5.578071627792408, -10.486636737872196, -12.106284945150644, -8.011822951979642, -16.393370892764715, -10.421928448805097, -14.444011849541614, -14.464246246324251, -17.29141661629063, -11.273734011706754, -7.243494597010695, -15.564524471031898, 1.138727571502169, -14.829858563894657, -16.913254198031506, 5.566613026203479, 6.833978765858273, -28.217149061445582, 11.026672755443508, -13.36886126851363, 10.357011811422272, -13.76421241440443, -8.251690133251566, -17.890188152436654, -1.8932810711970038, -16.337441644216987, 7.689223292800582, -13.65828506868398, 12.909852579826744, -2.1066264122190343, -5.599766815653018, -8.504623974797115, -11.493879052406534, -15.425483987394824, -15.96765072021941, -9.556332276832245, -12.981164962315852, -25.730389254711596, -18.012250197882686, 9.6819200192799, -2.8199595756344795, -5.306468031221007, -14.029259062890276, -23.4957054774532, -29.157405418874944, -2.060046976382445, -1.3722278242023798, 10.915107334077629, -13.321242211586508, -4.701205566603864, -20.614938363763496, 4.443673687164811, -14.610266625978337, 6.665732425275571, -18.606332489622297, -12.007951230700932, -6.056496855852963, 2.4158735361536916, -15.238144743621412, -11.856892531499549, 3.0556715667735475, -1.8812080305176533, -17.954197810703654, -9.995285684905985, -2.6233382643528707, -7.012046547490916, -1.5440585381834584, -12.169976195731902, -13.50963321524109, -3.923666143950406, -4.747143122127483, -23.278966304375516, -10.537112496990087, 8.569954164746537, 4.99162414697593, -13.521403310678242, 5.183640159699602, -3.7665324446014647, -3.175809404152794, -35.452317559290385, -18.33323133216965, -11.625444126074227, -20.225058151930337, -16.38408318586595, -10.411394480249767, -23.39669516362134, 4.201675081017385, -33.26268217191265, -16.172176205659603, 11.75324202041211, -1.5119672864341496, -18.35966603215663, -7.857654303463818, -12.91788116964386, -17.10363671626636, 1.4541162746514358, -13.710461877737245, 29.197150048505364], "episode_lengths": [13, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 63], "policy_agent_policy_reward": [-2.190928324368117, 14.815907508096544, -5.578071627792408, 10.486636737872196, 12.106284945150641, 8.011822951979642, 16.393370892764697, 10.421928448805097, 14.444011849541615, 14.464246246324251, 17.29141661629063, 11.273734011706761, 7.243494597010702, 15.564524471031884, -1.138727571502169, 14.829858563894659, 16.91325419803151, -5.566613026203475, -6.833978765858273, 28.21714906144558, -11.026672755443506, 13.368861268513628, -10.357011811422272, 13.764212414404426, 8.251690133251566, 17.890188152436654, 1.8932810711970092, 16.337441644216987, -7.68922329280058, 13.65828506868398, -12.909852579826746, 2.1066264122190343, 5.599766815653018, 8.504623974797115, 11.49387905240653, 15.425483987394824, 15.967650720219407, 9.556332276832245, 12.981164962315852, 25.730389254711593, 18.012250197882683, -9.6819200192799, 2.8199595756344795, 5.306468031221007, 14.029259062890276, 23.495705477453196, 29.157405418874934, 2.060046976382445, 1.3722278242023798, -10.915107334077629, 13.321242211586508, 4.701205566603864, 20.614938363763493, -4.443673687164811, 14.61026662597834, -6.665732425275571, 18.606332489622293, 12.007951230700932, 6.056496855852963, -2.4158735361536916, 15.238144743621415, 11.856892531499549, -3.0556715667735475, 1.8812080305176533, 17.954197810703654, 9.995285684905983, 2.6233382643528707, 7.012046547490916, 1.5440585381834566, 12.169976195731902, 13.50963321524109, 3.923666143950406, 4.747143122127477, 23.27896630437552, 10.537112496990087, -8.569954164746537, -4.99162414697593, 13.521403310678238, -5.183640159699602, 3.7665324446014647, 3.175809404152794, 35.45231755929039, 18.333231332169653, 11.625444126074225, 20.22505815193034, 16.38408318586595, 10.411394480249767, 23.396695163621345, -4.201675081017382, 33.262682171912644, 16.172176205659607, -11.753242020412097, 1.5119672864341496, 18.35966603215663, 7.857654303463818, 12.917881169643856, 17.10363671626636, -1.4541162746514367, 13.710461877737249, -29.19715004850536], "policy_adversary_policy_reward": [6.96357630505734, -2.5817196563211056, -20.83459586470903, -8.797219151484061, 6.439384996784895, 4.716758258799921, -17.148343477522058, -3.824929998222334, -22.213625229388747, -1.9989446609125352, 9.566009898476658, -25.589655802435946, -12.798043645313268, -19.988698140216123, -3.971741431215733, -16.87211546639446, -10.345722877812522, -18.5423008212707, -22.217662354145858, -6.710830138502647, -29.237007531412715, -5.345825701168543, -10.651224559452633, -11.896243463960879, -6.349474656479245, -8.137514537542152, -17.784506570272832, -13.344542371790958, -2.296053572045647, 4.573508715049985, -24.53330395041486, -5.12641317737447, -2.1108322798334243, -31.715676116229595, 4.031797868230335, 7.101428184176626, -0.4584290821307846, 14.12638661384733, -33.06393480381444, -23.370363319076723, 26.292013222376013, -4.238667711489001, -10.308852088578337, -16.42887044844892, 22.612415391084348, -1.8983917682398044, -3.5295706238667606, -23.99885420494209, 9.190852857150524, -25.694233123653653, -9.218856907110982, -26.56151939776232, 0.23056942026238758, -4.0171315626564095, -3.6204149414838653, -29.054468346950095, 15.94333097522894, -0.5648843896277782, -13.099243750093692, -14.21732638727427, 6.561477392499977, 19.258227767153507, 10.933277921873305, -15.146530746311374, -12.464986556104815, 1.2654529247987796, 2.946546712697838, -19.955794662292067, -21.09045608341955, -1.8973020213935072, -2.2830486210542684, -28.567919353735377, -23.17481956340891, -8.760481877029914, -14.688293809957283, -4.4243707437072075, 1.9986768950058007, -27.96100681963751, -29.102864759415183, -22.35791375000801, -14.530931110137704, -21.49356928562767, 7.564905111793941, 11.79893492676586, 3.285406546438921, -8.92532569770788, 2.7643429862740128, -13.37727904871602, -14.420584711540531, -13.637933414240017, -20.449659819270778, -26.541751135635636, -29.802451497934534, -28.512359339815315, -19.63906347235998, 15.518969519595089, -1.1485650432870997, -1.5958906051176598, 17.281010254688063, 4.549204413467194, -8.142008947094954, -18.500475476078062, 1.7084831053876428, -11.110894238595371, -10.365682077197494, -30.864194650329495, 3.41463822127988, 5.472709153049742, -4.337551100993382, -24.882982150963297, 13.077561316438917, 0.25390353411222577, -14.458516755054244, -22.754148224190363, -2.794084906440496, -21.22181755496137, -12.2602228277295, 0.14722911602357414, -3.7636216255710515, 8.595368697878435, -5.194194012173616, -25.282095475069216, -13.088243764466494, -10.625541298532603, -1.69653613876131, 7.807879272308405, 11.20039852729522, -14.962814588330527, -21.648202174353305, -14.260193447054004, -12.100006677043886, -7.890564692768077, -15.972247820618882, 10.725571291913141, -4.14462078598465, -9.879472308997183, -7.894768184534609, 4.806651108167699, -7.207487333247549, -17.13246505821625, -9.62848611913764, -17.39078031134454, -18.30430968144568, 10.456977393544868, -14.274554904264079, 4.7802686600091135, -34.653647080257954, -11.904285528493098, -27.915294362335914, 6.84106936835574, 16.579794563209198, 0.5601137662838767, 4.444998589326445, 5.538249704625414, -0.4794989813194128, -26.563307640037067, 0.33489115465971153, 10.032389164739493, 14.656615607682888, -22.189680496885817, 6.037135537594665, -12.388754345900253, -37.914916664620165, -32.9897184539606, -24.77605157753303, -11.890411086806292, -12.858008977182283, -10.39287927496617, -10.996678398932438, -29.453437904928244, -20.303943106873874, -12.464223264858031, -5.367930825975925, -15.454858134523608, -26.95868234076138, -19.834707986481316, 4.423786356809874, 3.979563805224892, -32.44372668956001, -34.08163765426534, -34.025380269748965, 1.6810278584297507, 14.723557431668503, 8.782926609155695, -7.229912914746421, 4.205978341878122, -10.547502554029354, -26.171829510283906, -10.468263563681706, -5.247045043245933, -13.202659206789324, -12.633103132498391, -21.115820593049175, -13.091452839483544, 6.769948219690828, -3.861715670387955, 2.7346456794058582, -30.155569434880356, 34.39968439877876, 23.99461569823197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41405559795254243, "mean_inference_ms": 1.0864288418781773, "mean_action_processing_ms": 0.1781007965895799, "mean_env_wait_ms": 0.07182284670551961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034821033477783203, "StateBufferConnector_ms": 0.0026023387908935547, "ViewRequirementAgentConnector_ms": 0.07079696655273438}, "num_episodes": 12, "episode_return_max": 29.197150048505364, "episode_return_min": -35.452317559290385, "episode_return_mean": -8.388185785494993}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 486.0365442513672, "num_env_steps_trained_throughput_per_sec": 486.0365442513672, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 2388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2388000, "timers": {"training_iteration_time_ms": 8172.903, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8172.847, "sample_time_ms": 794.815, "learn_time_ms": 7360.21, "learn_throughput": 543.463, "synch_weights_time_ms": 17.218}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 2388000, "num_agent_steps_trained": 2388000}, "done": false, "training_iteration": 199, "trial_id": "83a5c_00000", "date": "2024-08-10_12-41-54", "timestamp": 1723308114, "time_this_iter_s": 8.234992980957031, "time_total_s": 1674.952944278717, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fdeb1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1674.952944278717, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 25.333333333333332, "ram_util_percent": 82.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"adversary_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8801171993452406, "cur_kl_coeff": 0.08552615046501158, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.85564140377852, "policy_loss": -0.005724951922129741, "vf_loss": 4.860683826416258, "vf_explained_var": -0.06148585282936298, "kl": 0.007980165314580918, "entropy": 1.2156852719645022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "agent_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.860292815168699, "cur_kl_coeff": 5.697186087228686e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.20254668717583, "policy_loss": -0.007714273931924254, "vf_loss": 4.210260963936647, "vf_explained_var": 0.5607420011733969, "kl": 0.005184677533583463, "entropy": 0.2903833884590616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 191520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 29.197150048505364, "episode_reward_min": -35.452317559290385, "episode_reward_mean": -8.107034437975539, "episode_len_mean": 373.33, "episode_media": {}, "episodes_this_iter": 10, "episodes_timesteps_total": 37333, "policy_reward_min": {"agent_policy": -29.19715004850536, "adversary_policy": -37.914916664620165}, "policy_reward_max": {"agent_policy": 35.45231755929039, "adversary_policy": 34.39968439877876}, "policy_reward_mean": {"agent_policy": 8.107034437975539, "adversary_policy": -8.107034437975543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.29141661629063, -11.273734011706754, -7.243494597010695, -15.564524471031898, 1.138727571502169, -14.829858563894657, -16.913254198031506, 5.566613026203479, 6.833978765858273, -28.217149061445582, 11.026672755443508, -13.36886126851363, 10.357011811422272, -13.76421241440443, -8.251690133251566, -17.890188152436654, -1.8932810711970038, -16.337441644216987, 7.689223292800582, -13.65828506868398, 12.909852579826744, -2.1066264122190343, -5.599766815653018, -8.504623974797115, -11.493879052406534, -15.425483987394824, -15.96765072021941, -9.556332276832245, -12.981164962315852, -25.730389254711596, -18.012250197882686, 9.6819200192799, -2.8199595756344795, -5.306468031221007, -14.029259062890276, -23.4957054774532, -29.157405418874944, -2.060046976382445, -1.3722278242023798, 10.915107334077629, -13.321242211586508, -4.701205566603864, -20.614938363763496, 4.443673687164811, -14.610266625978337, 6.665732425275571, -18.606332489622297, -12.007951230700932, -6.056496855852963, 2.4158735361536916, -15.238144743621412, -11.856892531499549, 3.0556715667735475, -1.8812080305176533, -17.954197810703654, -9.995285684905985, -2.6233382643528707, -7.012046547490916, -1.5440585381834584, -12.169976195731902, -13.50963321524109, -3.923666143950406, -4.747143122127483, -23.278966304375516, -10.537112496990087, 8.569954164746537, 4.99162414697593, -13.521403310678242, 5.183640159699602, -3.7665324446014647, -3.175809404152794, -35.452317559290385, -18.33323133216965, -11.625444126074227, -20.225058151930337, -16.38408318586595, -10.411394480249767, -23.39669516362134, 4.201675081017385, -33.26268217191265, -16.172176205659603, 11.75324202041211, -1.5119672864341496, -18.35966603215663, -7.857654303463818, -12.91788116964386, -17.10363671626636, 1.4541162746514358, -13.710461877737245, 29.197150048505364, -2.4731496032283022, -5.138110920329819, -5.910351150461217, -8.800266326978234, -16.102748817333946, 1.6870680756315117, 6.731851799068071, -12.916557837157733, -14.973281741536468, -7.364528354102626], "episode_lengths": [400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 24, 400, 400, 400, 400, 400, 400, 400, 15, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 8, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 9, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 6, 400, 63, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_agent_policy_reward": [17.29141661629063, 11.273734011706761, 7.243494597010702, 15.564524471031884, -1.138727571502169, 14.829858563894659, 16.91325419803151, -5.566613026203475, -6.833978765858273, 28.21714906144558, -11.026672755443506, 13.368861268513628, -10.357011811422272, 13.764212414404426, 8.251690133251566, 17.890188152436654, 1.8932810711970092, 16.337441644216987, -7.68922329280058, 13.65828506868398, -12.909852579826746, 2.1066264122190343, 5.599766815653018, 8.504623974797115, 11.49387905240653, 15.425483987394824, 15.967650720219407, 9.556332276832245, 12.981164962315852, 25.730389254711593, 18.012250197882683, -9.6819200192799, 2.8199595756344795, 5.306468031221007, 14.029259062890276, 23.495705477453196, 29.157405418874934, 2.060046976382445, 1.3722278242023798, -10.915107334077629, 13.321242211586508, 4.701205566603864, 20.614938363763493, -4.443673687164811, 14.61026662597834, -6.665732425275571, 18.606332489622293, 12.007951230700932, 6.056496855852963, -2.4158735361536916, 15.238144743621415, 11.856892531499549, -3.0556715667735475, 1.8812080305176533, 17.954197810703654, 9.995285684905983, 2.6233382643528707, 7.012046547490916, 1.5440585381834566, 12.169976195731902, 13.50963321524109, 3.923666143950406, 4.747143122127477, 23.27896630437552, 10.537112496990087, -8.569954164746537, -4.99162414697593, 13.521403310678238, -5.183640159699602, 3.7665324446014647, 3.175809404152794, 35.45231755929039, 18.333231332169653, 11.625444126074225, 20.22505815193034, 16.38408318586595, 10.411394480249767, 23.396695163621345, -4.201675081017382, 33.262682171912644, 16.172176205659607, -11.753242020412097, 1.5119672864341496, 18.35966603215663, 7.857654303463818, 12.917881169643856, 17.10363671626636, -1.4541162746514367, 13.710461877737249, -29.19715004850536, 2.473149603228297, 5.138110920329824, 5.910351150461217, 8.800266326978234, 16.102748817333946, -1.6870680756315117, -6.731851799068073, 12.916557837157733, 14.973281741536468, 7.364528354102626], "policy_adversary_policy_reward": [-29.237007531412715, -5.345825701168543, -10.651224559452633, -11.896243463960879, -6.349474656479245, -8.137514537542152, -17.784506570272832, -13.344542371790958, -2.296053572045647, 4.573508715049985, -24.53330395041486, -5.12641317737447, -2.1108322798334243, -31.715676116229595, 4.031797868230335, 7.101428184176626, -0.4584290821307846, 14.12638661384733, -33.06393480381444, -23.370363319076723, 26.292013222376013, -4.238667711489001, -10.308852088578337, -16.42887044844892, 22.612415391084348, -1.8983917682398044, -3.5295706238667606, -23.99885420494209, 9.190852857150524, -25.694233123653653, -9.218856907110982, -26.56151939776232, 0.23056942026238758, -4.0171315626564095, -3.6204149414838653, -29.054468346950095, 15.94333097522894, -0.5648843896277782, -13.099243750093692, -14.21732638727427, 6.561477392499977, 19.258227767153507, 10.933277921873305, -15.146530746311374, -12.464986556104815, 1.2654529247987796, 2.946546712697838, -19.955794662292067, -21.09045608341955, -1.8973020213935072, -2.2830486210542684, -28.567919353735377, -23.17481956340891, -8.760481877029914, -14.688293809957283, -4.4243707437072075, 1.9986768950058007, -27.96100681963751, -29.102864759415183, -22.35791375000801, -14.530931110137704, -21.49356928562767, 7.564905111793941, 11.79893492676586, 3.285406546438921, -8.92532569770788, 2.7643429862740128, -13.37727904871602, -14.420584711540531, -13.637933414240017, -20.449659819270778, -26.541751135635636, -29.802451497934534, -28.512359339815315, -19.63906347235998, 15.518969519595089, -1.1485650432870997, -1.5958906051176598, 17.281010254688063, 4.549204413467194, -8.142008947094954, -18.500475476078062, 1.7084831053876428, -11.110894238595371, -10.365682077197494, -30.864194650329495, 3.41463822127988, 5.472709153049742, -4.337551100993382, -24.882982150963297, 13.077561316438917, 0.25390353411222577, -14.458516755054244, -22.754148224190363, -2.794084906440496, -21.22181755496137, -12.2602228277295, 0.14722911602357414, -3.7636216255710515, 8.595368697878435, -5.194194012173616, -25.282095475069216, -13.088243764466494, -10.625541298532603, -1.69653613876131, 7.807879272308405, 11.20039852729522, -14.962814588330527, -21.648202174353305, -14.260193447054004, -12.100006677043886, -7.890564692768077, -15.972247820618882, 10.725571291913141, -4.14462078598465, -9.879472308997183, -7.894768184534609, 4.806651108167699, -7.207487333247549, -17.13246505821625, -9.62848611913764, -17.39078031134454, -18.30430968144568, 10.456977393544868, -14.274554904264079, 4.7802686600091135, -34.653647080257954, -11.904285528493098, -27.915294362335914, 6.84106936835574, 16.579794563209198, 0.5601137662838767, 4.444998589326445, 5.538249704625414, -0.4794989813194128, -26.563307640037067, 0.33489115465971153, 10.032389164739493, 14.656615607682888, -22.189680496885817, 6.037135537594665, -12.388754345900253, -37.914916664620165, -32.9897184539606, -24.77605157753303, -11.890411086806292, -12.858008977182283, -10.39287927496617, -10.996678398932438, -29.453437904928244, -20.303943106873874, -12.464223264858031, -5.367930825975925, -15.454858134523608, -26.95868234076138, -19.834707986481316, 4.423786356809874, 3.979563805224892, -32.44372668956001, -34.08163765426534, -34.025380269748965, 1.6810278584297507, 14.723557431668503, 8.782926609155695, -7.229912914746421, 4.205978341878122, -10.547502554029354, -26.171829510283906, -10.468263563681706, -5.247045043245933, -13.202659206789324, -12.633103132498391, -21.115820593049175, -13.091452839483544, 6.769948219690828, -3.861715670387955, 2.7346456794058582, -30.155569434880356, 34.39968439877876, 23.99461569823197, -6.960650863028267, 2.014351656571675, -9.634856662530101, -0.6413651781295471, 11.322681114227827, -23.14338341515026, -7.606652466387551, -9.993880187568916, -24.801741726594923, -7.40375590807297, 5.072216634391594, -1.698080483128571, 16.065971752702477, -2.6022681545663353, 6.127603665475398, -31.960719339790863, -9.69573820860138, -20.250825274471552, -5.837142776753051, -8.891913931452201]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41404207222778155, "mean_inference_ms": 1.085922789391457, "mean_action_processing_ms": 0.1779888128505064, "mean_env_wait_ms": 0.07179196457771979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003527402877807617, "StateBufferConnector_ms": 0.002652287483215332, "ViewRequirementAgentConnector_ms": 0.07250785827636719}, "num_episodes": 10, "episode_return_max": 29.197150048505364, "episode_return_min": -35.452317559290385, "episode_return_mean": -8.107034437975539}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 481.57174359277, "num_env_steps_trained_throughput_per_sec": 481.57174359277, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 8218.706, "restore_workers_time_ms": 0.015, "training_step_time_ms": 8218.649, "sample_time_ms": 794.165, "learn_time_ms": 7406.216, "learn_throughput": 540.087, "synch_weights_time_ms": 17.646}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": true, "training_iteration": 200, "trial_id": "83a5c_00000", "date": "2024-08-10_12-42-03", "timestamp": 1723308123, "time_this_iter_s": 8.311337947845459, "time_total_s": 1683.2642822265625, "pid": 66036, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31fc8b8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"adversary_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}], "agent_policy": [null, "Box(0.0, 1.0, (2,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1683.2642822265625, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 29.816666666666674, "ram_util_percent": 83.13333333333333}}
