{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8490609224195833, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.920564878554571, "policy_loss": -0.005473384601137941, "vf_loss": 7.924546977451869, "vf_explained_var": 0.004145137248215852, "kl": 0.007456406705448649, "entropy": 1.6019271037565967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0214610732421674, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.249414398556664, "policy_loss": -0.0060616683442805885, "vf_loss": 5.254003955952074, "vf_explained_var": 0.0011636539741798682, "kl": 0.007360512130029959, "entropy": 1.6020079645530256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 1289.2156150028295, "episode_reward_min": 193.73197234057596, "episode_reward_mean": 651.1668331229348, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": 2.0000000000000013, "predator_policy": -7.346291634830462}, "policy_reward_max": {"prey_policy": 497.2681564464114, "predator_policy": 619.2970307134275}, "policy_reward_mean": {"prey_policy": 226.06609229161558, "predator_policy": 99.51732426985247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [871.229999999998, 799.9399999999982, 1289.2156150028295, 364.7299999999986, 558.1199999999981, 193.73197234057596, 395.4667897671361, 482.2463438122168, 600.8202692058776, 944.7662557387126, 573.4189300983595, 894.7119438002326, 664.1416066419596, 805.2307683311685, 636.0238582314599, 348.15944219638413, 542.7999999999977, 756.2492010459243], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [320.2276795705218, 289.1016998151591, 251.49237804114418, 271.028422131794, 337.2505204861956, 289.70939915037604, 98.92109921215618, 208.97252475352053, 194.1285160393638, 242.7320607106813, 84.01028109859183, 115.79055151755358, 110.36429458241818, 220.6259630986759, 56.08203881826356, 300.46048258090536, 405.88309016683263, 2.0000000000000013, 432.5450320125034, 116.83999999999997, 228.10013297784846, 216.61088501568085, 497.2681564464114, 143.5699999999997, 246.46511258536174, 299.2064233219376, 92.18324284655345, 455.77959738193823, 216.15145998477084, 213.48099282746952, 171.29000000000002, 110.43937154413172, 213.52464643211914, 217.8669931845971, 194.25764316524194, 274.0186309974426], "policy_predator_policy_reward": [208.6923204294777, 53.208300184839835, 142.68157786820535, 134.73762195885553, 42.95866465282997, 619.2970307134275, 21.96259413171009, 34.87378190261377, 80.87793928931832, 40.38148396063499, 1.2774313592634208, -7.346291634830462, 68.68678843184586, -4.210256345800744, 121.6134380065479, 4.09038440650107, 80.33328251513561, 112.60389652391127, 124.7357641073882, 270.6454596188217, 39.040748677464855, 89.66716342736727, 63.00134471533589, 190.872442638485, 30.40513329515251, 88.06493743950824, 140.70115821937105, 116.56676988330781, 143.05286981081258, 63.33853560840787, 33.672003998553755, 32.758066653701135, 13.55300681540218, 97.85535356787973, 99.96108576688734, 188.01184111635453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6390623531028792, "mean_inference_ms": 1.698512478495899, "mean_action_processing_ms": 0.270748011358719, "mean_env_wait_ms": 0.22192104199268434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007623434066772461, "StateBufferConnector_ms": 0.0029471185472276476, "ViewRequirementAgentConnector_ms": 0.08123450809054905}, "num_episodes": 18, "episode_return_max": 1289.2156150028295, "episode_return_min": 193.73197234057596, "episode_return_mean": 651.1668331229348, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.0516844289849, "num_env_steps_trained_throughput_per_sec": 324.0516844289849, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12343.719, "restore_workers_time_ms": 0.019, "training_step_time_ms": 12343.67, "sample_time_ms": 1377.125, "learn_time_ms": 10953.026, "learn_throughput": 365.196, "synch_weights_time_ms": 12.326}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "8abce_00000", "date": "2024-08-16_11-21-37", "timestamp": 1723787497, "time_this_iter_s": 12.364518165588379, "time_total_s": 12.364518165588379, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a416bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.364518165588379, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.83888888888888, "ram_util_percent": 82.61666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8114636845058865, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.708674550182605, "policy_loss": -0.006572322689967536, "vf_loss": 7.713835241428758, "vf_explained_var": 0.0053704632337761935, "kl": 0.00705814735934204, "entropy": 1.5884559837598649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0725375629606702, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.802161151517636, "policy_loss": -0.006412603882530695, "vf_loss": 4.806622227159127, "vf_explained_var": -0.0011437905528557993, "kl": 0.009757676396580225, "entropy": 1.5919339513021802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 1289.2156150028295, "episode_reward_min": 193.73197234057596, "episode_reward_mean": 660.7731560269243, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": 2.0000000000000013, "predator_policy": -7.346291634830462}, "policy_reward_max": {"prey_policy": 586.7967612814602, "predator_policy": 619.2970307134275}, "policy_reward_mean": {"prey_policy": 237.421925202401, "predator_policy": 92.96465281106154}, "custom_metrics": {}, "hist_stats": {"episode_reward": [871.229999999998, 799.9399999999982, 1289.2156150028295, 364.7299999999986, 558.1199999999981, 193.73197234057596, 395.4667897671361, 482.2463438122168, 600.8202692058776, 944.7662557387126, 573.4189300983595, 894.7119438002326, 664.1416066419596, 805.2307683311685, 636.0238582314599, 348.15944219638413, 542.7999999999977, 756.2492010459243, 585.0099999999983, 428.06860567263925, 853.2399999999989, 998.0736355506923, 934.5977536065398, 513.7671880108044, 603.8999999999984, 445.2399999999989, 334.55999999999796, 838.2026910342684, 625.7373505996685, 342.74999999999955, 557.6468462913549, 896.4372655900472, 321.47999999999905, 936.5856862955322, 946.5535190653458, 904.9800790395603], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [320.2276795705218, 289.1016998151591, 251.49237804114418, 271.028422131794, 337.2505204861956, 289.70939915037604, 98.92109921215618, 208.97252475352053, 194.1285160393638, 242.7320607106813, 84.01028109859183, 115.79055151755358, 110.36429458241818, 220.6259630986759, 56.08203881826356, 300.46048258090536, 405.88309016683263, 2.0000000000000013, 432.5450320125034, 116.83999999999997, 228.10013297784846, 216.61088501568085, 497.2681564464114, 143.5699999999997, 246.46511258536174, 299.2064233219376, 92.18324284655345, 455.77959738193823, 216.15145998477084, 213.48099282746952, 171.29000000000002, 110.43937154413172, 213.52464643211914, 217.8669931845971, 194.25764316524194, 274.0186309974426, 363.47563745758544, 148.58299363618661, 319.2918660358129, 60.41000000000002, 406.8913496613354, 216.81647584590644, 345.3659467342838, 502.4034186035938, 164.8963620625524, 465.2512732704009, 210.81222136965803, 228.89009166227763, 378.22832379232625, 79.8601881625939, 220.6648264663013, 142.3840505950985, 184.32674857366425, 98.03, 331.94541218256086, 208.53102004990902, 219.6591781426801, 170.63142930709745, 173.58354274220238, 138.22479302383488, 2.0000000000000013, 327.76048658587274, 451.2582125868745, 11.296094419756885, 121.21518911034096, 199.84016489836148, 498.00993866016177, 167.18936365426873, 586.7967612814602, 81.20000000000039, 460.5196936215978, 269.756237878158], "policy_predator_policy_reward": [208.6923204294777, 53.208300184839835, 142.68157786820535, 134.73762195885553, 42.95866465282997, 619.2970307134275, 21.96259413171009, 34.87378190261377, 80.87793928931832, 40.38148396063499, 1.2774313592634208, -7.346291634830462, 68.68678843184586, -4.210256345800744, 121.6134380065479, 4.09038440650107, 80.33328251513561, 112.60389652391127, 124.7357641073882, 270.6454596188217, 39.040748677464855, 89.66716342736727, 63.00134471533589, 190.872442638485, 30.40513329515251, 88.06493743950824, 140.70115821937105, 116.56676988330781, 143.05286981081258, 63.33853560840787, 33.672003998553755, 32.758066653701135, 13.55300681540218, 97.85535356787973, 99.96108576688734, 188.01184111635453, 70.91715617582308, 2.0342127304033744, 28.337849162547013, 20.028890474280555, 136.00865033866455, 93.52352415409356, 88.18490485234796, 62.11936536046733, 125.60215826179872, 178.84796001178705, -1.4859036780522308, 75.55077865692117, 41.27181165811276, 104.5396763869667, 77.95517353369897, 4.2359494049009285, 52.20325142633435, 0.0, 138.3014024493441, 159.4248563524542, 175.5690794005204, 59.877663749371195, 5.945908290944695, 24.995755943017716, 70.69369579480667, 157.1926639106773, 286.1407185934798, 147.74223998993764, 0.19983510163847473, 0.22481088965975804, 85.51017290245763, 185.87621107864553, 100.14169384310046, 178.41506394078615, 56.34887272400047, 118.355274815804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6202998344838886, "mean_inference_ms": 1.6279874176474662, "mean_action_processing_ms": 0.26166026068474074, "mean_env_wait_ms": 0.2144866431353963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006891290346781413, "StateBufferConnector_ms": 0.0030332141452365452, "ViewRequirementAgentConnector_ms": 0.08738736311594646}, "num_episodes": 18, "episode_return_max": 1289.2156150028295, "episode_return_min": 193.73197234057596, "episode_return_mean": 660.7731560269243, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.8257688603665, "num_env_steps_trained_throughput_per_sec": 335.8257688603665, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12127.332, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12127.289, "sample_time_ms": 1268.27, "learn_time_ms": 10845.377, "learn_throughput": 368.821, "synch_weights_time_ms": 12.551}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "8abce_00000", "date": "2024-08-16_11-21-51", "timestamp": 1723787511, "time_this_iter_s": 11.916279077529907, "time_total_s": 24.280797243118286, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a419ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.280797243118286, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.13809523809524, "ram_util_percent": 81.68095238095239}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2269050375652062, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.963769272647838, "policy_loss": -0.007858414921870149, "vf_loss": 8.969554390478386, "vf_explained_var": 0.02895950091578973, "kl": 0.01036655902025217, "entropy": 1.5545565534521033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.206682287495603, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.793628852707999, "policy_loss": -0.010464743005663708, "vf_loss": 4.801681504930769, "vf_explained_var": 0.00022209434912949012, "kl": 0.01206045230667254, "entropy": 1.5784442212215808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 1367.581461702441, "episode_reward_min": 193.73197234057596, "episode_reward_mean": 739.9396122049706, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": 2.0000000000000013, "predator_policy": -10.201445473423313}, "policy_reward_max": {"prey_policy": 615.0348478079856, "predator_policy": 619.2970307134275}, "policy_reward_mean": {"prey_policy": 269.32776263602636, "predator_policy": 100.6420434664592}, "custom_metrics": {}, "hist_stats": {"episode_reward": [871.229999999998, 799.9399999999982, 1289.2156150028295, 364.7299999999986, 558.1199999999981, 193.73197234057596, 395.4667897671361, 482.2463438122168, 600.8202692058776, 944.7662557387126, 573.4189300983595, 894.7119438002326, 664.1416066419596, 805.2307683311685, 636.0238582314599, 348.15944219638413, 542.7999999999977, 756.2492010459243, 585.0099999999983, 428.06860567263925, 853.2399999999989, 998.0736355506923, 934.5977536065398, 513.7671880108044, 603.8999999999984, 445.2399999999989, 334.55999999999796, 838.2026910342684, 625.7373505996685, 342.74999999999955, 557.6468462913549, 896.4372655900472, 321.47999999999905, 936.5856862955322, 946.5535190653458, 904.9800790395603, 814.1562310528811, 958.5468250909554, 581.7199999999984, 1072.3171067256185, 342.39999999999804, 1079.9515092302747, 1360.1665325598915, 657.0399999999998, 1330.8699999999994, 559.6085013677323, 495.3899999999981, 1317.712005438091, 295.8507665949368, 1032.5327624488039, 1216.3352824736492, 471.80722182581115, 1367.581461702441, 1214.9192355880489], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [320.2276795705218, 289.1016998151591, 251.49237804114418, 271.028422131794, 337.2505204861956, 289.70939915037604, 98.92109921215618, 208.97252475352053, 194.1285160393638, 242.7320607106813, 84.01028109859183, 115.79055151755358, 110.36429458241818, 220.6259630986759, 56.08203881826356, 300.46048258090536, 405.88309016683263, 2.0000000000000013, 432.5450320125034, 116.83999999999997, 228.10013297784846, 216.61088501568085, 497.2681564464114, 143.5699999999997, 246.46511258536174, 299.2064233219376, 92.18324284655345, 455.77959738193823, 216.15145998477084, 213.48099282746952, 171.29000000000002, 110.43937154413172, 213.52464643211914, 217.8669931845971, 194.25764316524194, 274.0186309974426, 363.47563745758544, 148.58299363618661, 319.2918660358129, 60.41000000000002, 406.8913496613354, 216.81647584590644, 345.3659467342838, 502.4034186035938, 164.8963620625524, 465.2512732704009, 210.81222136965803, 228.89009166227763, 378.22832379232625, 79.8601881625939, 220.6648264663013, 142.3840505950985, 184.32674857366425, 98.03, 331.94541218256086, 208.53102004990902, 219.6591781426801, 170.63142930709745, 173.58354274220238, 138.22479302383488, 2.0000000000000013, 327.76048658587274, 451.2582125868745, 11.296094419756885, 121.21518911034096, 199.84016489836148, 498.00993866016177, 167.18936365426873, 586.7967612814602, 81.20000000000039, 460.5196936215978, 269.756237878158, 434.40894273147006, 223.2229380555809, 352.29840855960475, 387.6289646415488, 180.30413243202162, 292.9622455320758, 216.35419455773047, 615.0348478079856, 132.15816292614005, 159.01895388480452, 427.4304903848464, 424.92378161056564, 408.2992022373288, 446.9570377359567, 421.82052367074135, 203.62842494349565, 436.5009978008752, 347.1825996252004, 339.1934357121203, 109.20911334410752, 2.0000000000000013, 371.2823879609332, 422.0904285144327, 500.51549512441375, 2.0000000000000013, 294.2449305957225, 436.558456188275, 200.76872409394548, 593.4216849108553, 354.093321274984, 181.15374904656642, 220.56954026478405, 453.20331453078757, 484.3443523580123, 488.6219012284792, 429.61406583157844], "policy_predator_policy_reward": [208.6923204294777, 53.208300184839835, 142.68157786820535, 134.73762195885553, 42.95866465282997, 619.2970307134275, 21.96259413171009, 34.87378190261377, 80.87793928931832, 40.38148396063499, 1.2774313592634208, -7.346291634830462, 68.68678843184586, -4.210256345800744, 121.6134380065479, 4.09038440650107, 80.33328251513561, 112.60389652391127, 124.7357641073882, 270.6454596188217, 39.040748677464855, 89.66716342736727, 63.00134471533589, 190.872442638485, 30.40513329515251, 88.06493743950824, 140.70115821937105, 116.56676988330781, 143.05286981081258, 63.33853560840787, 33.672003998553755, 32.758066653701135, 13.55300681540218, 97.85535356787973, 99.96108576688734, 188.01184111635453, 70.91715617582308, 2.0342127304033744, 28.337849162547013, 20.028890474280555, 136.00865033866455, 93.52352415409356, 88.18490485234796, 62.11936536046733, 125.60215826179872, 178.84796001178705, -1.4859036780522308, 75.55077865692117, 41.27181165811276, 104.5396763869667, 77.95517353369897, 4.2359494049009285, 52.20325142633435, 0.0, 138.3014024493441, 159.4248563524542, 175.5690794005204, 59.877663749371195, 5.945908290944695, 24.995755943017716, 70.69369579480667, 157.1926639106773, 286.1407185934798, 147.74223998993764, 0.19983510163847473, 0.22481088965975804, 85.51017290245763, 185.87621107864553, 100.14169384310046, 178.41506394078615, 56.34887272400047, 118.355274815804, -0.6301901563769556, 157.15454042220748, 158.47010812318786, 60.14934376661418, 29.165867567978157, 79.2877544679231, 217.80401027212565, 23.124054087778443, -1.889656108025263, 53.11253929707954, 35.32009710863673, 192.27714012622621, 343.8270582649813, 161.0832343216248, 34.29220899486485, -2.701157609101738, 185.0890021991243, 362.0974003747994, 80.96392009780632, 30.242032213700337, 29.07674968682835, 93.03086235223839, 291.31615291216684, 103.78992888707667, 9.807281472638934, -10.201445473423313, 212.98714604769893, 182.21843611888409, 13.757651448148287, 255.0626248396609, 71.59825390468342, -1.5143213902227615, 262.08682308875586, 167.94697172488574, 291.30534856381456, 5.377919964176698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6264343478987034, "mean_inference_ms": 1.638818702141881, "mean_action_processing_ms": 0.2650638019125097, "mean_env_wait_ms": 0.2155892469817458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009895474822432906, "StateBufferConnector_ms": 0.0034919491520634402, "ViewRequirementAgentConnector_ms": 0.10691903255603931}, "num_episodes": 18, "episode_return_max": 1367.581461702441, "episode_return_min": 193.73197234057596, "episode_return_mean": 739.9396122049706, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.6587384585197, "num_env_steps_trained_throughput_per_sec": 326.6587384585197, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12166.622, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12166.582, "sample_time_ms": 1337.32, "learn_time_ms": 10815.795, "learn_throughput": 369.83, "synch_weights_time_ms": 12.389}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "8abce_00000", "date": "2024-08-16_11-22-04", "timestamp": 1723787524, "time_this_iter_s": 12.24852204322815, "time_total_s": 36.529319286346436, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.529319286346436, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.247058823529414, "ram_util_percent": 81.7529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2871906023649942, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.56745455807479, "policy_loss": -0.004451017780599022, "vf_loss": 9.570643962880292, "vf_explained_var": 0.008963862676469106, "kl": 0.00630794868168606, "entropy": 1.54189038560504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1781204631877324, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.742941240280394, "policy_loss": -0.00937463749007928, "vf_loss": 6.750281721448141, "vf_explained_var": 0.002672640261826692, "kl": 0.01017089245780072, "entropy": 1.567032311013136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 1658.8269754016258, "episode_reward_min": 193.73197234057596, "episode_reward_mean": 798.5453107434494, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": 2.0000000000000013, "predator_policy": -10.201445473423313}, "policy_reward_max": {"prey_policy": 615.0348478079856, "predator_policy": 619.2970307134275}, "policy_reward_mean": {"prey_policy": 289.80337389594075, "predator_policy": 109.46928147578429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [871.229999999998, 799.9399999999982, 1289.2156150028295, 364.7299999999986, 558.1199999999981, 193.73197234057596, 395.4667897671361, 482.2463438122168, 600.8202692058776, 944.7662557387126, 573.4189300983595, 894.7119438002326, 664.1416066419596, 805.2307683311685, 636.0238582314599, 348.15944219638413, 542.7999999999977, 756.2492010459243, 585.0099999999983, 428.06860567263925, 853.2399999999989, 998.0736355506923, 934.5977536065398, 513.7671880108044, 603.8999999999984, 445.2399999999989, 334.55999999999796, 838.2026910342684, 625.7373505996685, 342.74999999999955, 557.6468462913549, 896.4372655900472, 321.47999999999905, 936.5856862955322, 946.5535190653458, 904.9800790395603, 814.1562310528811, 958.5468250909554, 581.7199999999984, 1072.3171067256185, 342.39999999999804, 1079.9515092302747, 1360.1665325598915, 657.0399999999998, 1330.8699999999994, 559.6085013677323, 495.3899999999981, 1317.712005438091, 295.8507665949368, 1032.5327624488039, 1216.3352824736492, 471.80722182581115, 1367.581461702441, 1214.9192355880489, 807.188520422378, 1158.7504275741596, 790.5899999999988, 1337.1172872095071, 755.0710636279708, 1002.9562806533607, 935.9330203429455, 754.7380773252582, 994.5332008636892, 906.5918864796027, 964.2354617791613, 930.6759646792566, 342.4299999999991, 1658.8269754016258, 408.0199999999984, 1370.0198301939, 1032.0700748086165, 1388.7752430985227], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [320.2276795705218, 289.1016998151591, 251.49237804114418, 271.028422131794, 337.2505204861956, 289.70939915037604, 98.92109921215618, 208.97252475352053, 194.1285160393638, 242.7320607106813, 84.01028109859183, 115.79055151755358, 110.36429458241818, 220.6259630986759, 56.08203881826356, 300.46048258090536, 405.88309016683263, 2.0000000000000013, 432.5450320125034, 116.83999999999997, 228.10013297784846, 216.61088501568085, 497.2681564464114, 143.5699999999997, 246.46511258536174, 299.2064233219376, 92.18324284655345, 455.77959738193823, 216.15145998477084, 213.48099282746952, 171.29000000000002, 110.43937154413172, 213.52464643211914, 217.8669931845971, 194.25764316524194, 274.0186309974426, 363.47563745758544, 148.58299363618661, 319.2918660358129, 60.41000000000002, 406.8913496613354, 216.81647584590644, 345.3659467342838, 502.4034186035938, 164.8963620625524, 465.2512732704009, 210.81222136965803, 228.89009166227763, 378.22832379232625, 79.8601881625939, 220.6648264663013, 142.3840505950985, 184.32674857366425, 98.03, 331.94541218256086, 208.53102004990902, 219.6591781426801, 170.63142930709745, 173.58354274220238, 138.22479302383488, 2.0000000000000013, 327.76048658587274, 451.2582125868745, 11.296094419756885, 121.21518911034096, 199.84016489836148, 498.00993866016177, 167.18936365426873, 586.7967612814602, 81.20000000000039, 460.5196936215978, 269.756237878158, 434.40894273147006, 223.2229380555809, 352.29840855960475, 387.6289646415488, 180.30413243202162, 292.9622455320758, 216.35419455773047, 615.0348478079856, 132.15816292614005, 159.01895388480452, 427.4304903848464, 424.92378161056564, 408.2992022373288, 446.9570377359567, 421.82052367074135, 203.62842494349565, 436.5009978008752, 347.1825996252004, 339.1934357121203, 109.20911334410752, 2.0000000000000013, 371.2823879609332, 422.0904285144327, 500.51549512441375, 2.0000000000000013, 294.2449305957225, 436.558456188275, 200.76872409394548, 593.4216849108553, 354.093321274984, 181.15374904656642, 220.56954026478405, 453.20331453078757, 484.3443523580123, 488.6219012284792, 429.61406583157844, 339.62446758804685, 332.29963210827725, 551.697368968479, 362.73302467206867, 256.26309787774596, 240.45380042453914, 412.47257114669054, 457.39797774433185, 393.15342306708413, 266.2996409220547, 357.9813178912771, 398.0448858831094, 455.8091441685116, 223.46394886088203, 403.8771244994936, 102.22916020769742, 310.4874661846878, 456.45477174850697, 459.46406379173925, 81.25685300570892, 234.43970560449551, 396.12324852772093, 402.1529900734625, 400.81530361605894, 114.36584642018263, 235.1205490468486, 571.4048355003575, 540.0736384728617, 183.10341916021477, 173.9415485024974, 528.8007311984582, 427.63004873388627, 430.20854240755415, 137.00110852658, 541.4883734522984, 466.15384632021016], "policy_predator_policy_reward": [208.6923204294777, 53.208300184839835, 142.68157786820535, 134.73762195885553, 42.95866465282997, 619.2970307134275, 21.96259413171009, 34.87378190261377, 80.87793928931832, 40.38148396063499, 1.2774313592634208, -7.346291634830462, 68.68678843184586, -4.210256345800744, 121.6134380065479, 4.09038440650107, 80.33328251513561, 112.60389652391127, 124.7357641073882, 270.6454596188217, 39.040748677464855, 89.66716342736727, 63.00134471533589, 190.872442638485, 30.40513329515251, 88.06493743950824, 140.70115821937105, 116.56676988330781, 143.05286981081258, 63.33853560840787, 33.672003998553755, 32.758066653701135, 13.55300681540218, 97.85535356787973, 99.96108576688734, 188.01184111635453, 70.91715617582308, 2.0342127304033744, 28.337849162547013, 20.028890474280555, 136.00865033866455, 93.52352415409356, 88.18490485234796, 62.11936536046733, 125.60215826179872, 178.84796001178705, -1.4859036780522308, 75.55077865692117, 41.27181165811276, 104.5396763869667, 77.95517353369897, 4.2359494049009285, 52.20325142633435, 0.0, 138.3014024493441, 159.4248563524542, 175.5690794005204, 59.877663749371195, 5.945908290944695, 24.995755943017716, 70.69369579480667, 157.1926639106773, 286.1407185934798, 147.74223998993764, 0.19983510163847473, 0.22481088965975804, 85.51017290245763, 185.87621107864553, 100.14169384310046, 178.41506394078615, 56.34887272400047, 118.355274815804, -0.6301901563769556, 157.15454042220748, 158.47010812318786, 60.14934376661418, 29.165867567978157, 79.2877544679231, 217.80401027212565, 23.124054087778443, -1.889656108025263, 53.11253929707954, 35.32009710863673, 192.27714012622621, 343.8270582649813, 161.0832343216248, 34.29220899486485, -2.701157609101738, 185.0890021991243, 362.0974003747994, 80.96392009780632, 30.242032213700337, 29.07674968682835, 93.03086235223839, 291.31615291216684, 103.78992888707667, 9.807281472638934, -10.201445473423313, 212.98714604769893, 182.21843611888409, 13.757651448148287, 255.0626248396609, 71.59825390468342, -1.5143213902227615, 262.08682308875586, 167.94697172488574, 291.30534856381456, 5.377919964176698, 94.81103247952947, 40.453388246524646, 141.23618553152795, 103.08384840208417, 228.54186260198964, 65.33123909572397, 232.1480541832406, 235.09868413524472, 12.64950507837477, 82.96849456045794, 211.92994316849413, 35.00013371048034, 187.92983263061168, 68.73009468293968, 225.80158015494672, 22.830212463120684, 174.28522825149338, 53.30573467900249, 219.79087878360863, 146.08009089854718, 273.960283189884, 59.712224457061296, 128.02182808027, -0.3141570905347697, -5.8105490468488545, -1.2458464201826072, 258.7673928819778, 288.5811085464284, 7.528451497502661, 43.446580839785696, 309.07374368784775, 104.51530657370769, 182.76867213843488, 282.091751736049, 352.72535180398023, 28.407671522032402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6257315073032379, "mean_inference_ms": 1.6336012963890911, "mean_action_processing_ms": 0.264602002413435, "mean_env_wait_ms": 0.21520237026358766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008819003899892172, "StateBufferConnector_ms": 0.0033411714765760633, "ViewRequirementAgentConnector_ms": 0.1030441787507799}, "num_episodes": 18, "episode_return_max": 1658.8269754016258, "episode_return_min": 193.73197234057596, "episode_return_mean": 798.5453107434494, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.8071651154798, "num_env_steps_trained_throughput_per_sec": 323.8071651154798, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12213.226, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12213.184, "sample_time_ms": 1302.555, "learn_time_ms": 10895.905, "learn_throughput": 367.11, "synch_weights_time_ms": 12.405}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "8abce_00000", "date": "2024-08-16_11-22-16", "timestamp": 1723787536, "time_this_iter_s": 12.392599821090698, "time_total_s": 48.921919107437134, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.921919107437134, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 52.87222222222223, "ram_util_percent": 82.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.354991173980728, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.707104133928894, "policy_loss": -0.003958489933105373, "vf_loss": 9.709690772667132, "vf_explained_var": 0.004169207811355591, "kl": 0.0068593067041814405, "entropy": 1.51646835009257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1778450165003065, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.799764450517282, "policy_loss": -0.01221412298979149, "vf_loss": 8.809254361460448, "vf_explained_var": 0.0038756531066995448, "kl": 0.013621007754361685, "entropy": 1.5393198517264512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 1854.7416738052762, "episode_reward_min": 193.73197234057596, "episode_reward_mean": 926.9601831869273, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": 2.0000000000000013, "predator_policy": -10.201445473423313}, "policy_reward_max": {"prey_policy": 667.1971771969868, "predator_policy": 619.2970307134275}, "policy_reward_mean": {"prey_policy": 329.915869853917, "predator_policy": 133.56422173954704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [871.229999999998, 799.9399999999982, 1289.2156150028295, 364.7299999999986, 558.1199999999981, 193.73197234057596, 395.4667897671361, 482.2463438122168, 600.8202692058776, 944.7662557387126, 573.4189300983595, 894.7119438002326, 664.1416066419596, 805.2307683311685, 636.0238582314599, 348.15944219638413, 542.7999999999977, 756.2492010459243, 585.0099999999983, 428.06860567263925, 853.2399999999989, 998.0736355506923, 934.5977536065398, 513.7671880108044, 603.8999999999984, 445.2399999999989, 334.55999999999796, 838.2026910342684, 625.7373505996685, 342.74999999999955, 557.6468462913549, 896.4372655900472, 321.47999999999905, 936.5856862955322, 946.5535190653458, 904.9800790395603, 814.1562310528811, 958.5468250909554, 581.7199999999984, 1072.3171067256185, 342.39999999999804, 1079.9515092302747, 1360.1665325598915, 657.0399999999998, 1330.8699999999994, 559.6085013677323, 495.3899999999981, 1317.712005438091, 295.8507665949368, 1032.5327624488039, 1216.3352824736492, 471.80722182581115, 1367.581461702441, 1214.9192355880489, 807.188520422378, 1158.7504275741596, 790.5899999999988, 1337.1172872095071, 755.0710636279708, 1002.9562806533607, 935.9330203429455, 754.7380773252582, 994.5332008636892, 906.5918864796027, 964.2354617791613, 930.6759646792566, 342.4299999999991, 1658.8269754016258, 408.0199999999984, 1370.0198301939, 1032.0700748086165, 1388.7752430985227, 566.2699999999992, 1541.78390657499, 1270.5486402045722, 830.4345216843285, 1410.4355925667373, 1812.9293265390263, 636.2215508485497, 1291.8505280259312, 1104.2446201423675, 1595.1887337493138, 1663.9662006806516, 814.6507260280877, 1270.1447001191186, 1567.6330304919848, 1472.5590572413134, 976.6912397468282, 1625.3957774505875, 1332.8964834226138, 1044.467615433705, 1192.7744941346625, 1230.4023730990368, 728.3503466765521, 1640.9354524088953, 1854.7416738052762, 1301.3934998244845, 1501.5628110148566, 995.322860062993], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [320.2276795705218, 289.1016998151591, 251.49237804114418, 271.028422131794, 337.2505204861956, 289.70939915037604, 98.92109921215618, 208.97252475352053, 194.1285160393638, 242.7320607106813, 84.01028109859183, 115.79055151755358, 110.36429458241818, 220.6259630986759, 56.08203881826356, 300.46048258090536, 405.88309016683263, 2.0000000000000013, 432.5450320125034, 116.83999999999997, 228.10013297784846, 216.61088501568085, 497.2681564464114, 143.5699999999997, 246.46511258536174, 299.2064233219376, 92.18324284655345, 455.77959738193823, 216.15145998477084, 213.48099282746952, 171.29000000000002, 110.43937154413172, 213.52464643211914, 217.8669931845971, 194.25764316524194, 274.0186309974426, 363.47563745758544, 148.58299363618661, 319.2918660358129, 60.41000000000002, 406.8913496613354, 216.81647584590644, 345.3659467342838, 502.4034186035938, 164.8963620625524, 465.2512732704009, 210.81222136965803, 228.89009166227763, 378.22832379232625, 79.8601881625939, 220.6648264663013, 142.3840505950985, 184.32674857366425, 98.03, 331.94541218256086, 208.53102004990902, 219.6591781426801, 170.63142930709745, 173.58354274220238, 138.22479302383488, 2.0000000000000013, 327.76048658587274, 451.2582125868745, 11.296094419756885, 121.21518911034096, 199.84016489836148, 498.00993866016177, 167.18936365426873, 586.7967612814602, 81.20000000000039, 460.5196936215978, 269.756237878158, 434.40894273147006, 223.2229380555809, 352.29840855960475, 387.6289646415488, 180.30413243202162, 292.9622455320758, 216.35419455773047, 615.0348478079856, 132.15816292614005, 159.01895388480452, 427.4304903848464, 424.92378161056564, 408.2992022373288, 446.9570377359567, 421.82052367074135, 203.62842494349565, 436.5009978008752, 347.1825996252004, 339.1934357121203, 109.20911334410752, 2.0000000000000013, 371.2823879609332, 422.0904285144327, 500.51549512441375, 2.0000000000000013, 294.2449305957225, 436.558456188275, 200.76872409394548, 593.4216849108553, 354.093321274984, 181.15374904656642, 220.56954026478405, 453.20331453078757, 484.3443523580123, 488.6219012284792, 429.61406583157844, 339.62446758804685, 332.29963210827725, 551.697368968479, 362.73302467206867, 256.26309787774596, 240.45380042453914, 412.47257114669054, 457.39797774433185, 393.15342306708413, 266.2996409220547, 357.9813178912771, 398.0448858831094, 455.8091441685116, 223.46394886088203, 403.8771244994936, 102.22916020769742, 310.4874661846878, 456.45477174850697, 459.46406379173925, 81.25685300570892, 234.43970560449551, 396.12324852772093, 402.1529900734625, 400.81530361605894, 114.36584642018263, 235.1205490468486, 571.4048355003575, 540.0736384728617, 183.10341916021477, 173.9415485024974, 528.8007311984582, 427.63004873388627, 430.20854240755415, 137.00110852658, 541.4883734522984, 466.15384632021016, 98.16584171709927, 390.3872831048003, 621.9823151172388, 391.0247274473623, 499.5163234029585, 468.52177519218696, 263.26995688997715, 424.0719735772743, 577.6431376723876, 579.0290347763953, 547.1233467466435, 476.7461627163548, 441.73436089837674, 73.96782628432747, 433.92495841841543, 388.6924670416244, 200.6082364348306, 562.8014151547445, 667.1971771969868, 518.6637814858318, 659.579442672403, 480.85523653810577, 365.295671073908, 254.49249214964456, 472.98631469511946, 382.7842443032195, 546.4324522502136, 548.66515759476, 397.3338342766283, 505.11038266752246, 514.23062417399, 395.62198137821935, 604.8606429518411, 427.284878988319, 441.5254005487006, 401.19776135422535, 464.93270529185077, 243.96592252384696, 355.59943968795994, 385.38413986205586, 473.4088149899812, 476.3886787632211, 185.6402736399108, 427.1817090231022, 463.5020443726835, 424.3453437376532, 457.5791351772121, 558.212107370261, 414.2775829279132, 538.9191852596398, 456.25921926251146, 530.5699001270824, 74.86143079024134, 637.3001383603337], "policy_predator_policy_reward": [208.6923204294777, 53.208300184839835, 142.68157786820535, 134.73762195885553, 42.95866465282997, 619.2970307134275, 21.96259413171009, 34.87378190261377, 80.87793928931832, 40.38148396063499, 1.2774313592634208, -7.346291634830462, 68.68678843184586, -4.210256345800744, 121.6134380065479, 4.09038440650107, 80.33328251513561, 112.60389652391127, 124.7357641073882, 270.6454596188217, 39.040748677464855, 89.66716342736727, 63.00134471533589, 190.872442638485, 30.40513329515251, 88.06493743950824, 140.70115821937105, 116.56676988330781, 143.05286981081258, 63.33853560840787, 33.672003998553755, 32.758066653701135, 13.55300681540218, 97.85535356787973, 99.96108576688734, 188.01184111635453, 70.91715617582308, 2.0342127304033744, 28.337849162547013, 20.028890474280555, 136.00865033866455, 93.52352415409356, 88.18490485234796, 62.11936536046733, 125.60215826179872, 178.84796001178705, -1.4859036780522308, 75.55077865692117, 41.27181165811276, 104.5396763869667, 77.95517353369897, 4.2359494049009285, 52.20325142633435, 0.0, 138.3014024493441, 159.4248563524542, 175.5690794005204, 59.877663749371195, 5.945908290944695, 24.995755943017716, 70.69369579480667, 157.1926639106773, 286.1407185934798, 147.74223998993764, 0.19983510163847473, 0.22481088965975804, 85.51017290245763, 185.87621107864553, 100.14169384310046, 178.41506394078615, 56.34887272400047, 118.355274815804, -0.6301901563769556, 157.15454042220748, 158.47010812318786, 60.14934376661418, 29.165867567978157, 79.2877544679231, 217.80401027212565, 23.124054087778443, -1.889656108025263, 53.11253929707954, 35.32009710863673, 192.27714012622621, 343.8270582649813, 161.0832343216248, 34.29220899486485, -2.701157609101738, 185.0890021991243, 362.0974003747994, 80.96392009780632, 30.242032213700337, 29.07674968682835, 93.03086235223839, 291.31615291216684, 103.78992888707667, 9.807281472638934, -10.201445473423313, 212.98714604769893, 182.21843611888409, 13.757651448148287, 255.0626248396609, 71.59825390468342, -1.5143213902227615, 262.08682308875586, 167.94697172488574, 291.30534856381456, 5.377919964176698, 94.81103247952947, 40.453388246524646, 141.23618553152795, 103.08384840208417, 228.54186260198964, 65.33123909572397, 232.1480541832406, 235.09868413524472, 12.64950507837477, 82.96849456045794, 211.92994316849413, 35.00013371048034, 187.92983263061168, 68.73009468293968, 225.80158015494672, 22.830212463120684, 174.28522825149338, 53.30573467900249, 219.79087878360863, 146.08009089854718, 273.960283189884, 59.712224457061296, 128.02182808027, -0.3141570905347697, -5.8105490468488545, -1.2458464201826072, 258.7673928819778, 288.5811085464284, 7.528451497502661, 43.446580839785696, 309.07374368784775, 104.51530657370769, 182.76867213843488, 282.091751736049, 352.72535180398023, 28.407671522032402, 76.7827168951995, 0.9341582829006976, 335.0584145444282, 193.7184494659618, 25.607673819971446, 276.9028677894553, 96.34775900472027, 46.7448322123566, 30.589423194949838, 223.17399692300506, 346.54165870536747, 442.51815837066135, 106.06570691591051, 14.453656749935789, 232.62721747400082, 236.60588509189174, 243.6525895205392, 97.1823790322538, 225.5006054726939, 183.8271695938008, 242.7857488210456, 280.74577264909715, 97.40873778693634, 97.45382501759897, 165.45273594572444, 248.92140517505416, 310.0057252804088, 162.52969536660376, 376.83447672880203, 193.28036356836196, 68.41146002590807, -1.57282583128897, 237.9974644568495, 355.2527910535788, 353.90491445900926, 136.26840706067776, 192.93440888775757, 142.63457873024998, 266.4788851146247, 185.3120294700213, 164.188231192473, 116.41664815336114, 22.883246913621804, 92.64511709991761, 362.43345202061306, 390.6546122779454, 397.7369333136249, 441.2134979441779, 259.8156007962104, 88.38113084072138, 218.1897892353122, 296.5439023899497, 130.34787786250683, 152.81341304991264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6271225366938361, "mean_inference_ms": 1.6305074615277098, "mean_action_processing_ms": 0.2643001247915859, "mean_env_wait_ms": 0.21630481635422974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008524427510271168, "StateBufferConnector_ms": 0.004478295644124349, "ViewRequirementAgentConnector_ms": 0.10828995945477726}, "num_episodes": 27, "episode_return_max": 1854.7416738052762, "episode_return_min": 193.73197234057596, "episode_return_mean": 926.9601831869273, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.20308264785106, "num_env_steps_trained_throughput_per_sec": 253.20308264785106, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12930.101, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12930.059, "sample_time_ms": 1303.0, "learn_time_ms": 11608.829, "learn_throughput": 344.565, "synch_weights_time_ms": 15.818}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "8abce_00000", "date": "2024-08-16_11-22-32", "timestamp": 1723787552, "time_this_iter_s": 15.941138982772827, "time_total_s": 64.86305809020996, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a419ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 64.86305809020996, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 77.63181818181819, "ram_util_percent": 81.23636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2148401381004423, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.877571926419698, "policy_loss": -0.0045641485288758915, "vf_loss": 9.880566935059885, "vf_explained_var": -0.02054874651015751, "kl": 0.007845532653456534, "entropy": 1.5034486225042394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2874277339252844, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.259424870607084, "policy_loss": -0.009500241816221248, "vf_loss": 9.265993275718083, "vf_explained_var": -0.004163069794417689, "kl": 0.014659197757897284, "entropy": 1.5377509983759077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 1866.577920305304, "episode_reward_min": 295.8507665949368, "episode_reward_mean": 1076.2135592513039, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 2.0000000000000013, "predator_policy": -10.201445473423313}, "policy_reward_max": {"prey_policy": 720.3824439204143, "predator_policy": 518.6119727858727}, "policy_reward_mean": {"prey_policy": 375.1640955424111, "predator_policy": 162.94268408324118}, "custom_metrics": {}, "hist_stats": {"episode_reward": [756.2492010459243, 585.0099999999983, 428.06860567263925, 853.2399999999989, 998.0736355506923, 934.5977536065398, 513.7671880108044, 603.8999999999984, 445.2399999999989, 334.55999999999796, 838.2026910342684, 625.7373505996685, 342.74999999999955, 557.6468462913549, 896.4372655900472, 321.47999999999905, 936.5856862955322, 946.5535190653458, 904.9800790395603, 814.1562310528811, 958.5468250909554, 581.7199999999984, 1072.3171067256185, 342.39999999999804, 1079.9515092302747, 1360.1665325598915, 657.0399999999998, 1330.8699999999994, 559.6085013677323, 495.3899999999981, 1317.712005438091, 295.8507665949368, 1032.5327624488039, 1216.3352824736492, 471.80722182581115, 1367.581461702441, 1214.9192355880489, 807.188520422378, 1158.7504275741596, 790.5899999999988, 1337.1172872095071, 755.0710636279708, 1002.9562806533607, 935.9330203429455, 754.7380773252582, 994.5332008636892, 906.5918864796027, 964.2354617791613, 930.6759646792566, 342.4299999999991, 1658.8269754016258, 408.0199999999984, 1370.0198301939, 1032.0700748086165, 1388.7752430985227, 566.2699999999992, 1541.78390657499, 1270.5486402045722, 830.4345216843285, 1410.4355925667373, 1812.9293265390263, 636.2215508485497, 1291.8505280259312, 1104.2446201423675, 1595.1887337493138, 1663.9662006806516, 814.6507260280877, 1270.1447001191186, 1567.6330304919848, 1472.5590572413134, 976.6912397468282, 1625.3957774505875, 1332.8964834226138, 1044.467615433705, 1192.7744941346625, 1230.4023730990368, 728.3503466765521, 1640.9354524088953, 1854.7416738052762, 1301.3934998244845, 1501.5628110148566, 995.322860062993, 1332.5876302375234, 1772.52118047651, 1316.2911110578987, 1866.577920305304, 1550.7593927486478, 1799.8464062534952, 1237.7116116234415, 1777.7381216309304, 1760.1018037343629, 1337.3140368956285, 1445.9097350103611, 1274.8462934618694, 1266.6724796817591, 843.2097043720812, 1482.8187411422184, 1703.4403720416476, 1426.3552326804795, 1622.3498114373315], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.25764316524194, 274.0186309974426, 363.47563745758544, 148.58299363618661, 319.2918660358129, 60.41000000000002, 406.8913496613354, 216.81647584590644, 345.3659467342838, 502.4034186035938, 164.8963620625524, 465.2512732704009, 210.81222136965803, 228.89009166227763, 378.22832379232625, 79.8601881625939, 220.6648264663013, 142.3840505950985, 184.32674857366425, 98.03, 331.94541218256086, 208.53102004990902, 219.6591781426801, 170.63142930709745, 173.58354274220238, 138.22479302383488, 2.0000000000000013, 327.76048658587274, 451.2582125868745, 11.296094419756885, 121.21518911034096, 199.84016489836148, 498.00993866016177, 167.18936365426873, 586.7967612814602, 81.20000000000039, 460.5196936215978, 269.756237878158, 434.40894273147006, 223.2229380555809, 352.29840855960475, 387.6289646415488, 180.30413243202162, 292.9622455320758, 216.35419455773047, 615.0348478079856, 132.15816292614005, 159.01895388480452, 427.4304903848464, 424.92378161056564, 408.2992022373288, 446.9570377359567, 421.82052367074135, 203.62842494349565, 436.5009978008752, 347.1825996252004, 339.1934357121203, 109.20911334410752, 2.0000000000000013, 371.2823879609332, 422.0904285144327, 500.51549512441375, 2.0000000000000013, 294.2449305957225, 436.558456188275, 200.76872409394548, 593.4216849108553, 354.093321274984, 181.15374904656642, 220.56954026478405, 453.20331453078757, 484.3443523580123, 488.6219012284792, 429.61406583157844, 339.62446758804685, 332.29963210827725, 551.697368968479, 362.73302467206867, 256.26309787774596, 240.45380042453914, 412.47257114669054, 457.39797774433185, 393.15342306708413, 266.2996409220547, 357.9813178912771, 398.0448858831094, 455.8091441685116, 223.46394886088203, 403.8771244994936, 102.22916020769742, 310.4874661846878, 456.45477174850697, 459.46406379173925, 81.25685300570892, 234.43970560449551, 396.12324852772093, 402.1529900734625, 400.81530361605894, 114.36584642018263, 235.1205490468486, 571.4048355003575, 540.0736384728617, 183.10341916021477, 173.9415485024974, 528.8007311984582, 427.63004873388627, 430.20854240755415, 137.00110852658, 541.4883734522984, 466.15384632021016, 98.16584171709927, 390.3872831048003, 621.9823151172388, 391.0247274473623, 499.5163234029585, 468.52177519218696, 263.26995688997715, 424.0719735772743, 577.6431376723876, 579.0290347763953, 547.1233467466435, 476.7461627163548, 441.73436089837674, 73.96782628432747, 433.92495841841543, 388.6924670416244, 200.6082364348306, 562.8014151547445, 667.1971771969868, 518.6637814858318, 659.579442672403, 480.85523653810577, 365.295671073908, 254.49249214964456, 472.98631469511946, 382.7842443032195, 546.4324522502136, 548.66515759476, 397.3338342766283, 505.11038266752246, 514.23062417399, 395.62198137821935, 604.8606429518411, 427.284878988319, 441.5254005487006, 401.19776135422535, 464.93270529185077, 243.96592252384696, 355.59943968795994, 385.38413986205586, 473.4088149899812, 476.3886787632211, 185.6402736399108, 427.1817090231022, 463.5020443726835, 424.3453437376532, 457.5791351772121, 558.212107370261, 414.2775829279132, 538.9191852596398, 456.25921926251146, 530.5699001270824, 74.86143079024134, 637.3001383603337, 423.4265250294157, 398.88203172211297, 644.6201116485347, 408.9207220673596, 333.39261855818455, 658.6392539869922, 470.32455970709856, 527.2287704607891, 534.7870789432336, 508.71218828919143, 484.81951625059344, 414.04796474651124, 410.07989268988547, 299.02248729555174, 653.8223368648438, 510.3038824883644, 720.3824439204143, 537.0905389773733, 493.1098551141152, 416.2340651466866, 577.4893075042696, 438.6615584177249, 590.5989030364998, 370.482260369801, 419.36681901835846, 447.73768648984515, 345.41024717426586, 316.85184538773495, 636.8425465203542, 499.6014477325153, 568.29488938529, 472.51331156064305, 577.4435313467922, 347.5989879821784, 531.7124797231926, 391.127260185404], "policy_predator_policy_reward": [99.96108576688734, 188.01184111635453, 70.91715617582308, 2.0342127304033744, 28.337849162547013, 20.028890474280555, 136.00865033866455, 93.52352415409356, 88.18490485234796, 62.11936536046733, 125.60215826179872, 178.84796001178705, -1.4859036780522308, 75.55077865692117, 41.27181165811276, 104.5396763869667, 77.95517353369897, 4.2359494049009285, 52.20325142633435, 0.0, 138.3014024493441, 159.4248563524542, 175.5690794005204, 59.877663749371195, 5.945908290944695, 24.995755943017716, 70.69369579480667, 157.1926639106773, 286.1407185934798, 147.74223998993764, 0.19983510163847473, 0.22481088965975804, 85.51017290245763, 185.87621107864553, 100.14169384310046, 178.41506394078615, 56.34887272400047, 118.355274815804, -0.6301901563769556, 157.15454042220748, 158.47010812318786, 60.14934376661418, 29.165867567978157, 79.2877544679231, 217.80401027212565, 23.124054087778443, -1.889656108025263, 53.11253929707954, 35.32009710863673, 192.27714012622621, 343.8270582649813, 161.0832343216248, 34.29220899486485, -2.701157609101738, 185.0890021991243, 362.0974003747994, 80.96392009780632, 30.242032213700337, 29.07674968682835, 93.03086235223839, 291.31615291216684, 103.78992888707667, 9.807281472638934, -10.201445473423313, 212.98714604769893, 182.21843611888409, 13.757651448148287, 255.0626248396609, 71.59825390468342, -1.5143213902227615, 262.08682308875586, 167.94697172488574, 291.30534856381456, 5.377919964176698, 94.81103247952947, 40.453388246524646, 141.23618553152795, 103.08384840208417, 228.54186260198964, 65.33123909572397, 232.1480541832406, 235.09868413524472, 12.64950507837477, 82.96849456045794, 211.92994316849413, 35.00013371048034, 187.92983263061168, 68.73009468293968, 225.80158015494672, 22.830212463120684, 174.28522825149338, 53.30573467900249, 219.79087878360863, 146.08009089854718, 273.960283189884, 59.712224457061296, 128.02182808027, -0.3141570905347697, -5.8105490468488545, -1.2458464201826072, 258.7673928819778, 288.5811085464284, 7.528451497502661, 43.446580839785696, 309.07374368784775, 104.51530657370769, 182.76867213843488, 282.091751736049, 352.72535180398023, 28.407671522032402, 76.7827168951995, 0.9341582829006976, 335.0584145444282, 193.7184494659618, 25.607673819971446, 276.9028677894553, 96.34775900472027, 46.7448322123566, 30.589423194949838, 223.17399692300506, 346.54165870536747, 442.51815837066135, 106.06570691591051, 14.453656749935789, 232.62721747400082, 236.60588509189174, 243.6525895205392, 97.1823790322538, 225.5006054726939, 183.8271695938008, 242.7857488210456, 280.74577264909715, 97.40873778693634, 97.45382501759897, 165.45273594572444, 248.92140517505416, 310.0057252804088, 162.52969536660376, 376.83447672880203, 193.28036356836196, 68.41146002590807, -1.57282583128897, 237.9974644568495, 355.2527910535788, 353.90491445900926, 136.26840706067776, 192.93440888775757, 142.63457873024998, 266.4788851146247, 185.3120294700213, 164.188231192473, 116.41664815336114, 22.883246913621804, 92.64511709991761, 362.43345202061306, 390.6546122779454, 397.7369333136249, 441.2134979441779, 259.8156007962104, 88.38113084072138, 218.1897892353122, 296.5439023899497, 130.34787786250683, 152.81341304991264, 337.1562990458326, 173.12277444016362, 381.02783097971076, 337.9525157809065, 171.86768278854277, 152.3915557241788, 512.1578117419754, 356.86677839544024, 330.6845980263426, 176.57552748988167, 518.6119727858727, 382.36695247051836, 253.96595443400045, 274.64327720400377, 239.20675931440093, 374.4051429633218, 245.7515650750035, 256.87725576156987, 105.45185904531105, 322.51825758951594, 171.06263292060873, 258.69623616775914, 166.41494704932992, 147.3501830062383, 95.17687754692217, 304.3910966266326, 36.05743360100641, 144.89017820907506, 140.4610505751084, 205.91369631424095, 344.6417727623058, 317.99039833340856, 118.39298984617139, 382.9197235053382, 371.5156189323193, 327.99445259641567]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6781497385058646, "mean_inference_ms": 1.7872981224448825, "mean_action_processing_ms": 0.2848953442256058, "mean_env_wait_ms": 0.23643544331848157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015291333198547363, "StateBufferConnector_ms": 0.004601001739501953, "ViewRequirementAgentConnector_ms": 0.15228915214538574}, "num_episodes": 18, "episode_return_max": 1866.577920305304, "episode_return_min": 295.8507665949368, "episode_return_mean": 1076.2135592513039, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.50672230870208, "num_env_steps_trained_throughput_per_sec": 231.50672230870208, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13654.773, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13654.717, "sample_time_ms": 1986.979, "learn_time_ms": 11650.137, "learn_throughput": 343.344, "synch_weights_time_ms": 15.219}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "8abce_00000", "date": "2024-08-16_11-22-50", "timestamp": 1723787570, "time_this_iter_s": 17.321717023849487, "time_total_s": 82.18477511405945, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 82.18477511405945, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 79.828, "ram_util_percent": 82.936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3254061194481672, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.840668990624645, "policy_loss": -0.0026478904422628817, "vf_loss": 9.84231995072945, "vf_explained_var": -0.0002106454637315538, "kl": 0.004984744396153482, "entropy": 1.5041753722877098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1096913093296938, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.78440891901652, "policy_loss": -0.00869621412407252, "vf_loss": 9.790824594447221, "vf_explained_var": -0.0015042732947717899, "kl": 0.011402738364339757, "entropy": 1.5203280489280742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 1982.7599411630565, "episode_reward_min": 295.8507665949368, "episode_reward_mean": 1260.6169244065193, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 2.0000000000000013, "predator_policy": -10.201445473423313}, "policy_reward_max": {"prey_policy": 720.3824439204143, "predator_policy": 518.6119727858727}, "policy_reward_mean": {"prey_policy": 420.1658489235369, "predator_policy": 210.14261327972284}, "custom_metrics": {}, "hist_stats": {"episode_reward": [904.9800790395603, 814.1562310528811, 958.5468250909554, 581.7199999999984, 1072.3171067256185, 342.39999999999804, 1079.9515092302747, 1360.1665325598915, 657.0399999999998, 1330.8699999999994, 559.6085013677323, 495.3899999999981, 1317.712005438091, 295.8507665949368, 1032.5327624488039, 1216.3352824736492, 471.80722182581115, 1367.581461702441, 1214.9192355880489, 807.188520422378, 1158.7504275741596, 790.5899999999988, 1337.1172872095071, 755.0710636279708, 1002.9562806533607, 935.9330203429455, 754.7380773252582, 994.5332008636892, 906.5918864796027, 964.2354617791613, 930.6759646792566, 342.4299999999991, 1658.8269754016258, 408.0199999999984, 1370.0198301939, 1032.0700748086165, 1388.7752430985227, 566.2699999999992, 1541.78390657499, 1270.5486402045722, 830.4345216843285, 1410.4355925667373, 1812.9293265390263, 636.2215508485497, 1291.8505280259312, 1104.2446201423675, 1595.1887337493138, 1663.9662006806516, 814.6507260280877, 1270.1447001191186, 1567.6330304919848, 1472.5590572413134, 976.6912397468282, 1625.3957774505875, 1332.8964834226138, 1044.467615433705, 1192.7744941346625, 1230.4023730990368, 728.3503466765521, 1640.9354524088953, 1854.7416738052762, 1301.3934998244845, 1501.5628110148566, 995.322860062993, 1332.5876302375234, 1772.52118047651, 1316.2911110578987, 1866.577920305304, 1550.7593927486478, 1799.8464062534952, 1237.7116116234415, 1777.7381216309304, 1760.1018037343629, 1337.3140368956285, 1445.9097350103611, 1274.8462934618694, 1266.6724796817591, 843.2097043720812, 1482.8187411422184, 1703.4403720416476, 1426.3552326804795, 1622.3498114373315, 1751.8097520266838, 1750.7297037339843, 1769.277624274923, 1605.1660415210254, 1472.7997305095985, 1698.6835081812849, 1674.1811095388514, 1499.7897850774143, 1249.787018605682, 1763.1817666067998, 1620.549399600198, 1821.857431812934, 1982.7599411630565, 1832.1804959165488, 1941.7828742270312, 1670.598396303821, 1434.7591286240897, 1818.5425505603862], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [460.5196936215978, 269.756237878158, 434.40894273147006, 223.2229380555809, 352.29840855960475, 387.6289646415488, 180.30413243202162, 292.9622455320758, 216.35419455773047, 615.0348478079856, 132.15816292614005, 159.01895388480452, 427.4304903848464, 424.92378161056564, 408.2992022373288, 446.9570377359567, 421.82052367074135, 203.62842494349565, 436.5009978008752, 347.1825996252004, 339.1934357121203, 109.20911334410752, 2.0000000000000013, 371.2823879609332, 422.0904285144327, 500.51549512441375, 2.0000000000000013, 294.2449305957225, 436.558456188275, 200.76872409394548, 593.4216849108553, 354.093321274984, 181.15374904656642, 220.56954026478405, 453.20331453078757, 484.3443523580123, 488.6219012284792, 429.61406583157844, 339.62446758804685, 332.29963210827725, 551.697368968479, 362.73302467206867, 256.26309787774596, 240.45380042453914, 412.47257114669054, 457.39797774433185, 393.15342306708413, 266.2996409220547, 357.9813178912771, 398.0448858831094, 455.8091441685116, 223.46394886088203, 403.8771244994936, 102.22916020769742, 310.4874661846878, 456.45477174850697, 459.46406379173925, 81.25685300570892, 234.43970560449551, 396.12324852772093, 402.1529900734625, 400.81530361605894, 114.36584642018263, 235.1205490468486, 571.4048355003575, 540.0736384728617, 183.10341916021477, 173.9415485024974, 528.8007311984582, 427.63004873388627, 430.20854240755415, 137.00110852658, 541.4883734522984, 466.15384632021016, 98.16584171709927, 390.3872831048003, 621.9823151172388, 391.0247274473623, 499.5163234029585, 468.52177519218696, 263.26995688997715, 424.0719735772743, 577.6431376723876, 579.0290347763953, 547.1233467466435, 476.7461627163548, 441.73436089837674, 73.96782628432747, 433.92495841841543, 388.6924670416244, 200.6082364348306, 562.8014151547445, 667.1971771969868, 518.6637814858318, 659.579442672403, 480.85523653810577, 365.295671073908, 254.49249214964456, 472.98631469511946, 382.7842443032195, 546.4324522502136, 548.66515759476, 397.3338342766283, 505.11038266752246, 514.23062417399, 395.62198137821935, 604.8606429518411, 427.284878988319, 441.5254005487006, 401.19776135422535, 464.93270529185077, 243.96592252384696, 355.59943968795994, 385.38413986205586, 473.4088149899812, 476.3886787632211, 185.6402736399108, 427.1817090231022, 463.5020443726835, 424.3453437376532, 457.5791351772121, 558.212107370261, 414.2775829279132, 538.9191852596398, 456.25921926251146, 530.5699001270824, 74.86143079024134, 637.3001383603337, 423.4265250294157, 398.88203172211297, 644.6201116485347, 408.9207220673596, 333.39261855818455, 658.6392539869922, 470.32455970709856, 527.2287704607891, 534.7870789432336, 508.71218828919143, 484.81951625059344, 414.04796474651124, 410.07989268988547, 299.02248729555174, 653.8223368648438, 510.3038824883644, 720.3824439204143, 537.0905389773733, 493.1098551141152, 416.2340651466866, 577.4893075042696, 438.6615584177249, 590.5989030364998, 370.482260369801, 419.36681901835846, 447.73768648984515, 345.41024717426586, 316.85184538773495, 636.8425465203542, 499.6014477325153, 568.29488938529, 472.51331156064305, 577.4435313467922, 347.5989879821784, 531.7124797231926, 391.127260185404, 547.6342343599986, 564.5123156684476, 589.2441960592696, 341.2194111680858, 473.27842332401286, 586.6261934242178, 535.1467400785098, 412.83300798186986, 469.18702338925914, 408.9282881262988, 572.0880238039344, 459.37488509911674, 578.2908350502953, 459.45661764473397, 387.9415241055164, 620.1815477925204, 502.5639237608278, 371.2649625470064, 515.9115939934331, 578.0782310674966, 564.5809917091898, 423.2094552026433, 409.1461956923008, 419.07201253901417, 547.7861803482069, 518.9650233656363, 511.6149904395216, 471.6288913075285, 469.3866876148382, 505.92175661834875, 482.7392566401484, 509.51640197945983, 485.780895112012, 416.91125504265256, 483.04716420875934, 501.2811746976962], "policy_predator_policy_reward": [56.34887272400047, 118.355274815804, -0.6301901563769556, 157.15454042220748, 158.47010812318786, 60.14934376661418, 29.165867567978157, 79.2877544679231, 217.80401027212565, 23.124054087778443, -1.889656108025263, 53.11253929707954, 35.32009710863673, 192.27714012622621, 343.8270582649813, 161.0832343216248, 34.29220899486485, -2.701157609101738, 185.0890021991243, 362.0974003747994, 80.96392009780632, 30.242032213700337, 29.07674968682835, 93.03086235223839, 291.31615291216684, 103.78992888707667, 9.807281472638934, -10.201445473423313, 212.98714604769893, 182.21843611888409, 13.757651448148287, 255.0626248396609, 71.59825390468342, -1.5143213902227615, 262.08682308875586, 167.94697172488574, 291.30534856381456, 5.377919964176698, 94.81103247952947, 40.453388246524646, 141.23618553152795, 103.08384840208417, 228.54186260198964, 65.33123909572397, 232.1480541832406, 235.09868413524472, 12.64950507837477, 82.96849456045794, 211.92994316849413, 35.00013371048034, 187.92983263061168, 68.73009468293968, 225.80158015494672, 22.830212463120684, 174.28522825149338, 53.30573467900249, 219.79087878360863, 146.08009089854718, 273.960283189884, 59.712224457061296, 128.02182808027, -0.3141570905347697, -5.8105490468488545, -1.2458464201826072, 258.7673928819778, 288.5811085464284, 7.528451497502661, 43.446580839785696, 309.07374368784775, 104.51530657370769, 182.76867213843488, 282.091751736049, 352.72535180398023, 28.407671522032402, 76.7827168951995, 0.9341582829006976, 335.0584145444282, 193.7184494659618, 25.607673819971446, 276.9028677894553, 96.34775900472027, 46.7448322123566, 30.589423194949838, 223.17399692300506, 346.54165870536747, 442.51815837066135, 106.06570691591051, 14.453656749935789, 232.62721747400082, 236.60588509189174, 243.6525895205392, 97.1823790322538, 225.5006054726939, 183.8271695938008, 242.7857488210456, 280.74577264909715, 97.40873778693634, 97.45382501759897, 165.45273594572444, 248.92140517505416, 310.0057252804088, 162.52969536660376, 376.83447672880203, 193.28036356836196, 68.41146002590807, -1.57282583128897, 237.9974644568495, 355.2527910535788, 353.90491445900926, 136.26840706067776, 192.93440888775757, 142.63457873024998, 266.4788851146247, 185.3120294700213, 164.188231192473, 116.41664815336114, 22.883246913621804, 92.64511709991761, 362.43345202061306, 390.6546122779454, 397.7369333136249, 441.2134979441779, 259.8156007962104, 88.38113084072138, 218.1897892353122, 296.5439023899497, 130.34787786250683, 152.81341304991264, 337.1562990458326, 173.12277444016362, 381.02783097971076, 337.9525157809065, 171.86768278854277, 152.3915557241788, 512.1578117419754, 356.86677839544024, 330.6845980263426, 176.57552748988167, 518.6119727858727, 382.36695247051836, 253.96595443400045, 274.64327720400377, 239.20675931440093, 374.4051429633218, 245.7515650750035, 256.87725576156987, 105.45185904531105, 322.51825758951594, 171.06263292060873, 258.69623616775914, 166.41494704932992, 147.3501830062383, 95.17687754692217, 304.3910966266326, 36.05743360100641, 144.89017820907506, 140.4610505751084, 205.91369631424095, 344.6417727623058, 317.99039833340856, 118.39298984617139, 382.9197235053382, 371.5156189323193, 327.99445259641567, 293.9328994210866, 345.7303025771536, 398.0328139575963, 422.23328254903385, 258.97469287066673, 450.3983146560266, 278.2022751493543, 378.9840183112922, 265.9127766629009, 328.7716423311411, 395.5357648179763, 271.6848344602569, 309.9890895169071, 326.444567326914, 218.1283837073755, 273.5383294720028, 219.39821284963617, 156.5599194482118, 442.2592022010663, 226.93273934480348, 302.5915458277853, 330.16740686058046, 511.07648769584677, 482.5627358857717, 407.3477099184938, 508.66102753071976, 483.63530839265127, 365.3013057768457, 476.0565266172203, 490.4179033766237, 365.2388301531481, 313.1039075310634, 234.0483808495098, 298.01859761991494, 494.75689965133904, 339.45731200259195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7291681014708563, "mean_inference_ms": 1.944279779754015, "mean_action_processing_ms": 0.304137959271882, "mean_env_wait_ms": 0.25656633882086644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014979124069213867, "StateBufferConnector_ms": 0.004623889923095703, "ViewRequirementAgentConnector_ms": 0.15451550483703613}, "num_episodes": 18, "episode_return_max": 1982.7599411630565, "episode_return_min": 295.8507665949368, "episode_return_mean": 1260.6169244065193, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.2396422310437, "num_env_steps_trained_throughput_per_sec": 331.2396422310437, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 13429.219, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13429.16, "sample_time_ms": 1897.991, "learn_time_ms": 11514.178, "learn_throughput": 347.398, "synch_weights_time_ms": 14.76}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "8abce_00000", "date": "2024-08-16_11-23-02", "timestamp": 1723787582, "time_this_iter_s": 12.090463161468506, "time_total_s": 94.27523827552795, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4337c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 94.27523827552795, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 55.4764705882353, "ram_util_percent": 81.47647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.300852893963062, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.85072114076564, "policy_loss": -0.0021789917117477488, "vf_loss": 9.852242754880713, "vf_explained_var": -0.016853541419619606, "kl": 0.0065737712576766465, "entropy": 1.485386799756812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3375345509203653, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.649545849189556, "policy_loss": -0.005508474711077436, "vf_loss": 9.653608902421578, "vf_explained_var": -0.004398978198016132, "kl": 0.0072271665839925316, "entropy": 1.5087720134270886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 1982.7599411630565, "episode_reward_min": 342.4299999999991, "episode_reward_mean": 1381.5966852594129, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 73.96782628432747, "predator_policy": -5.8105490468488545}, "policy_reward_max": {"prey_policy": 720.3824439204143, "predator_policy": 518.6119727858727}, "policy_reward_mean": {"prey_policy": 446.96803154243855, "predator_policy": 243.83031108726817}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1214.9192355880489, 807.188520422378, 1158.7504275741596, 790.5899999999988, 1337.1172872095071, 755.0710636279708, 1002.9562806533607, 935.9330203429455, 754.7380773252582, 994.5332008636892, 906.5918864796027, 964.2354617791613, 930.6759646792566, 342.4299999999991, 1658.8269754016258, 408.0199999999984, 1370.0198301939, 1032.0700748086165, 1388.7752430985227, 566.2699999999992, 1541.78390657499, 1270.5486402045722, 830.4345216843285, 1410.4355925667373, 1812.9293265390263, 636.2215508485497, 1291.8505280259312, 1104.2446201423675, 1595.1887337493138, 1663.9662006806516, 814.6507260280877, 1270.1447001191186, 1567.6330304919848, 1472.5590572413134, 976.6912397468282, 1625.3957774505875, 1332.8964834226138, 1044.467615433705, 1192.7744941346625, 1230.4023730990368, 728.3503466765521, 1640.9354524088953, 1854.7416738052762, 1301.3934998244845, 1501.5628110148566, 995.322860062993, 1332.5876302375234, 1772.52118047651, 1316.2911110578987, 1866.577920305304, 1550.7593927486478, 1799.8464062534952, 1237.7116116234415, 1777.7381216309304, 1760.1018037343629, 1337.3140368956285, 1445.9097350103611, 1274.8462934618694, 1266.6724796817591, 843.2097043720812, 1482.8187411422184, 1703.4403720416476, 1426.3552326804795, 1622.3498114373315, 1751.8097520266838, 1750.7297037339843, 1769.277624274923, 1605.1660415210254, 1472.7997305095985, 1698.6835081812849, 1674.1811095388514, 1499.7897850774143, 1249.787018605682, 1763.1817666067998, 1620.549399600198, 1821.857431812934, 1982.7599411630565, 1832.1804959165488, 1941.7828742270312, 1670.598396303821, 1434.7591286240897, 1818.5425505603862, 1719.3609243594246, 1436.813579150918, 1641.6298926883292, 1424.775642789456, 1765.7165227900136, 1578.1457284117794, 1700.1063411743162, 1412.7319702285959, 1664.1066620501797, 1441.9611471963876, 1273.6594334536667, 1270.3738745245046, 1254.7956930859975, 1889.573477601345, 1856.89373993056, 1643.749017910314, 1450.6530713019536, 1531.895652192309], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [488.6219012284792, 429.61406583157844, 339.62446758804685, 332.29963210827725, 551.697368968479, 362.73302467206867, 256.26309787774596, 240.45380042453914, 412.47257114669054, 457.39797774433185, 393.15342306708413, 266.2996409220547, 357.9813178912771, 398.0448858831094, 455.8091441685116, 223.46394886088203, 403.8771244994936, 102.22916020769742, 310.4874661846878, 456.45477174850697, 459.46406379173925, 81.25685300570892, 234.43970560449551, 396.12324852772093, 402.1529900734625, 400.81530361605894, 114.36584642018263, 235.1205490468486, 571.4048355003575, 540.0736384728617, 183.10341916021477, 173.9415485024974, 528.8007311984582, 427.63004873388627, 430.20854240755415, 137.00110852658, 541.4883734522984, 466.15384632021016, 98.16584171709927, 390.3872831048003, 621.9823151172388, 391.0247274473623, 499.5163234029585, 468.52177519218696, 263.26995688997715, 424.0719735772743, 577.6431376723876, 579.0290347763953, 547.1233467466435, 476.7461627163548, 441.73436089837674, 73.96782628432747, 433.92495841841543, 388.6924670416244, 200.6082364348306, 562.8014151547445, 667.1971771969868, 518.6637814858318, 659.579442672403, 480.85523653810577, 365.295671073908, 254.49249214964456, 472.98631469511946, 382.7842443032195, 546.4324522502136, 548.66515759476, 397.3338342766283, 505.11038266752246, 514.23062417399, 395.62198137821935, 604.8606429518411, 427.284878988319, 441.5254005487006, 401.19776135422535, 464.93270529185077, 243.96592252384696, 355.59943968795994, 385.38413986205586, 473.4088149899812, 476.3886787632211, 185.6402736399108, 427.1817090231022, 463.5020443726835, 424.3453437376532, 457.5791351772121, 558.212107370261, 414.2775829279132, 538.9191852596398, 456.25921926251146, 530.5699001270824, 74.86143079024134, 637.3001383603337, 423.4265250294157, 398.88203172211297, 644.6201116485347, 408.9207220673596, 333.39261855818455, 658.6392539869922, 470.32455970709856, 527.2287704607891, 534.7870789432336, 508.71218828919143, 484.81951625059344, 414.04796474651124, 410.07989268988547, 299.02248729555174, 653.8223368648438, 510.3038824883644, 720.3824439204143, 537.0905389773733, 493.1098551141152, 416.2340651466866, 577.4893075042696, 438.6615584177249, 590.5989030364998, 370.482260369801, 419.36681901835846, 447.73768648984515, 345.41024717426586, 316.85184538773495, 636.8425465203542, 499.6014477325153, 568.29488938529, 472.51331156064305, 577.4435313467922, 347.5989879821784, 531.7124797231926, 391.127260185404, 547.6342343599986, 564.5123156684476, 589.2441960592696, 341.2194111680858, 473.27842332401286, 586.6261934242178, 535.1467400785098, 412.83300798186986, 469.18702338925914, 408.9282881262988, 572.0880238039344, 459.37488509911674, 578.2908350502953, 459.45661764473397, 387.9415241055164, 620.1815477925204, 502.5639237608278, 371.2649625470064, 515.9115939934331, 578.0782310674966, 564.5809917091898, 423.2094552026433, 409.1461956923008, 419.07201253901417, 547.7861803482069, 518.9650233656363, 511.6149904395216, 471.6288913075285, 469.3866876148382, 505.92175661834875, 482.7392566401484, 509.51640197945983, 485.780895112012, 416.91125504265256, 483.04716420875934, 501.2811746976962, 658.7461877564846, 459.28404623205455, 357.6202649921975, 507.25391251945126, 524.4139058765605, 386.98117116357355, 456.4212970487006, 434.03421648224884, 530.6300485322332, 570.7871897335268, 343.97613516788624, 527.2830622186822, 511.50183169217524, 482.8353402014054, 603.0150221419871, 363.96954121519707, 477.6334090286904, 443.652475158371, 390.52194909878904, 544.2649303347724, 432.78893690017765, 355.8576944233378, 403.7974881987335, 316.3670692832397, 488.64840544552527, 500.7005879675468, 581.0171413633852, 392.1416794617075, 619.0332999713719, 524.0491758742701, 558.1597676940006, 528.096441166941, 423.1340783242997, 393.3353271818202, 581.0294973778524, 492.51371110881837], "policy_predator_policy_reward": [291.30534856381456, 5.377919964176698, 94.81103247952947, 40.453388246524646, 141.23618553152795, 103.08384840208417, 228.54186260198964, 65.33123909572397, 232.1480541832406, 235.09868413524472, 12.64950507837477, 82.96849456045794, 211.92994316849413, 35.00013371048034, 187.92983263061168, 68.73009468293968, 225.80158015494672, 22.830212463120684, 174.28522825149338, 53.30573467900249, 219.79087878360863, 146.08009089854718, 273.960283189884, 59.712224457061296, 128.02182808027, -0.3141570905347697, -5.8105490468488545, -1.2458464201826072, 258.7673928819778, 288.5811085464284, 7.528451497502661, 43.446580839785696, 309.07374368784775, 104.51530657370769, 182.76867213843488, 282.091751736049, 352.72535180398023, 28.407671522032402, 76.7827168951995, 0.9341582829006976, 335.0584145444282, 193.7184494659618, 25.607673819971446, 276.9028677894553, 96.34775900472027, 46.7448322123566, 30.589423194949838, 223.17399692300506, 346.54165870536747, 442.51815837066135, 106.06570691591051, 14.453656749935789, 232.62721747400082, 236.60588509189174, 243.6525895205392, 97.1823790322538, 225.5006054726939, 183.8271695938008, 242.7857488210456, 280.74577264909715, 97.40873778693634, 97.45382501759897, 165.45273594572444, 248.92140517505416, 310.0057252804088, 162.52969536660376, 376.83447672880203, 193.28036356836196, 68.41146002590807, -1.57282583128897, 237.9974644568495, 355.2527910535788, 353.90491445900926, 136.26840706067776, 192.93440888775757, 142.63457873024998, 266.4788851146247, 185.3120294700213, 164.188231192473, 116.41664815336114, 22.883246913621804, 92.64511709991761, 362.43345202061306, 390.6546122779454, 397.7369333136249, 441.2134979441779, 259.8156007962104, 88.38113084072138, 218.1897892353122, 296.5439023899497, 130.34787786250683, 152.81341304991264, 337.1562990458326, 173.12277444016362, 381.02783097971076, 337.9525157809065, 171.86768278854277, 152.3915557241788, 512.1578117419754, 356.86677839544024, 330.6845980263426, 176.57552748988167, 518.6119727858727, 382.36695247051836, 253.96595443400045, 274.64327720400377, 239.20675931440093, 374.4051429633218, 245.7515650750035, 256.87725576156987, 105.45185904531105, 322.51825758951594, 171.06263292060873, 258.69623616775914, 166.41494704932992, 147.3501830062383, 95.17687754692217, 304.3910966266326, 36.05743360100641, 144.89017820907506, 140.4610505751084, 205.91369631424095, 344.6417727623058, 317.99039833340856, 118.39298984617139, 382.9197235053382, 371.5156189323193, 327.99445259641567, 293.9328994210866, 345.7303025771536, 398.0328139575963, 422.23328254903385, 258.97469287066673, 450.3983146560266, 278.2022751493543, 378.9840183112922, 265.9127766629009, 328.7716423311411, 395.5357648179763, 271.6848344602569, 309.9890895169071, 326.444567326914, 218.1283837073755, 273.5383294720028, 219.39821284963617, 156.5599194482118, 442.2592022010663, 226.93273934480348, 302.5915458277853, 330.16740686058046, 511.07648769584677, 482.5627358857717, 407.3477099184938, 508.66102753071976, 483.63530839265127, 365.3013057768457, 476.0565266172203, 490.4179033766237, 365.2388301531481, 313.1039075310634, 234.0483808495098, 298.01859761991494, 494.75689965133904, 339.45731200259195, 312.5953558472497, 288.73533452363506, 283.04658985923726, 288.8928117800316, 338.3697413372613, 391.8650743109352, 264.62185278573685, 269.6982764727695, 411.3147207274106, 252.98456379684404, 319.30214114321916, 387.5843898819929, 296.65064694782353, 409.1185223329124, 181.84776914398032, 263.89963772743243, 486.8705039277839, 255.9502739353363, 285.93106438869194, 221.24320337413502, 257.86910607962835, 227.14369605052298, 271.29861746505384, 278.9106995774772, 113.57674726377175, 151.86995240915323, 477.8535940646405, 438.56106271161224, 356.1263579116279, 357.68490617329036, 316.9580877335779, 240.5347213157964, 277.6039567013441, 356.5797090944897, 316.2456548001068, 142.10678890553282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7730317865712155, "mean_inference_ms": 2.077187371185754, "mean_action_processing_ms": 0.31977609869463547, "mean_env_wait_ms": 0.2744662350626898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014728665351867676, "StateBufferConnector_ms": 0.004488110542297363, "ViewRequirementAgentConnector_ms": 0.15157651901245117}, "num_episodes": 18, "episode_return_max": 1982.7599411630565, "episode_return_min": 342.4299999999991, "episode_return_mean": 1381.5966852594129, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.09408880623914, "num_env_steps_trained_throughput_per_sec": 324.09408880623914, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 13293.33, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13293.274, "sample_time_ms": 1870.114, "learn_time_ms": 11406.904, "learn_throughput": 350.665, "synch_weights_time_ms": 14.217}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "8abce_00000", "date": "2024-08-16_11-23-14", "timestamp": 1723787594, "time_this_iter_s": 12.345392227172852, "time_total_s": 106.6206305027008, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a416bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.6206305027008, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 57.138888888888886, "ram_util_percent": 70.99444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3668149430679266, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.839036640792928, "policy_loss": -0.004839256177680991, "vf_loss": 9.842555060714641, "vf_explained_var": -0.013439411397964235, "kl": 0.013208424369953257, "entropy": 1.4824739388057164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5070649456567866, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.617704753270225, "policy_loss": -0.004055227417124327, "vf_loss": 9.619750188393567, "vf_explained_var": 0.0016954480655609616, "kl": 0.01004910851683527, "entropy": 1.5128281381395128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 1982.7599411630565, "episode_reward_min": 636.2215508485497, "episode_reward_mean": 1497.9169143396937, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 73.96782628432747, "predator_policy": -1.57282583128897}, "policy_reward_max": {"prey_policy": 720.3824439204143, "predator_policy": 571.9160531170212}, "policy_reward_mean": {"prey_policy": 469.3993721805537, "predator_policy": 279.5590849892932}, "custom_metrics": {}, "hist_stats": {"episode_reward": [830.4345216843285, 1410.4355925667373, 1812.9293265390263, 636.2215508485497, 1291.8505280259312, 1104.2446201423675, 1595.1887337493138, 1663.9662006806516, 814.6507260280877, 1270.1447001191186, 1567.6330304919848, 1472.5590572413134, 976.6912397468282, 1625.3957774505875, 1332.8964834226138, 1044.467615433705, 1192.7744941346625, 1230.4023730990368, 728.3503466765521, 1640.9354524088953, 1854.7416738052762, 1301.3934998244845, 1501.5628110148566, 995.322860062993, 1332.5876302375234, 1772.52118047651, 1316.2911110578987, 1866.577920305304, 1550.7593927486478, 1799.8464062534952, 1237.7116116234415, 1777.7381216309304, 1760.1018037343629, 1337.3140368956285, 1445.9097350103611, 1274.8462934618694, 1266.6724796817591, 843.2097043720812, 1482.8187411422184, 1703.4403720416476, 1426.3552326804795, 1622.3498114373315, 1751.8097520266838, 1750.7297037339843, 1769.277624274923, 1605.1660415210254, 1472.7997305095985, 1698.6835081812849, 1674.1811095388514, 1499.7897850774143, 1249.787018605682, 1763.1817666067998, 1620.549399600198, 1821.857431812934, 1982.7599411630565, 1832.1804959165488, 1941.7828742270312, 1670.598396303821, 1434.7591286240897, 1818.5425505603862, 1719.3609243594246, 1436.813579150918, 1641.6298926883292, 1424.775642789456, 1765.7165227900136, 1578.1457284117794, 1700.1063411743162, 1412.7319702285959, 1664.1066620501797, 1441.9611471963876, 1273.6594334536667, 1270.3738745245046, 1254.7956930859975, 1889.573477601345, 1856.89373993056, 1643.749017910314, 1450.6530713019536, 1531.895652192309, 1673.2734170083324, 1574.8183315439137, 1593.0433107136262, 1133.1467395734614, 1711.9879394039033, 1922.4345009367744, 1290.0743309686152, 1457.5043052257524, 1697.0606317090167, 1327.1947988064344, 1690.2045913024874, 1491.0849125191166, 1674.7671286888894, 1706.338154988053, 1561.6679739955237, 1707.1321265351578, 1076.651816602918, 1811.036779663419, 1447.3808506555852, 1324.1361944675245, 1372.5712033742143, 1520.5579661728927], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [263.26995688997715, 424.0719735772743, 577.6431376723876, 579.0290347763953, 547.1233467466435, 476.7461627163548, 441.73436089837674, 73.96782628432747, 433.92495841841543, 388.6924670416244, 200.6082364348306, 562.8014151547445, 667.1971771969868, 518.6637814858318, 659.579442672403, 480.85523653810577, 365.295671073908, 254.49249214964456, 472.98631469511946, 382.7842443032195, 546.4324522502136, 548.66515759476, 397.3338342766283, 505.11038266752246, 514.23062417399, 395.62198137821935, 604.8606429518411, 427.284878988319, 441.5254005487006, 401.19776135422535, 464.93270529185077, 243.96592252384696, 355.59943968795994, 385.38413986205586, 473.4088149899812, 476.3886787632211, 185.6402736399108, 427.1817090231022, 463.5020443726835, 424.3453437376532, 457.5791351772121, 558.212107370261, 414.2775829279132, 538.9191852596398, 456.25921926251146, 530.5699001270824, 74.86143079024134, 637.3001383603337, 423.4265250294157, 398.88203172211297, 644.6201116485347, 408.9207220673596, 333.39261855818455, 658.6392539869922, 470.32455970709856, 527.2287704607891, 534.7870789432336, 508.71218828919143, 484.81951625059344, 414.04796474651124, 410.07989268988547, 299.02248729555174, 653.8223368648438, 510.3038824883644, 720.3824439204143, 537.0905389773733, 493.1098551141152, 416.2340651466866, 577.4893075042696, 438.6615584177249, 590.5989030364998, 370.482260369801, 419.36681901835846, 447.73768648984515, 345.41024717426586, 316.85184538773495, 636.8425465203542, 499.6014477325153, 568.29488938529, 472.51331156064305, 577.4435313467922, 347.5989879821784, 531.7124797231926, 391.127260185404, 547.6342343599986, 564.5123156684476, 589.2441960592696, 341.2194111680858, 473.27842332401286, 586.6261934242178, 535.1467400785098, 412.83300798186986, 469.18702338925914, 408.9282881262988, 572.0880238039344, 459.37488509911674, 578.2908350502953, 459.45661764473397, 387.9415241055164, 620.1815477925204, 502.5639237608278, 371.2649625470064, 515.9115939934331, 578.0782310674966, 564.5809917091898, 423.2094552026433, 409.1461956923008, 419.07201253901417, 547.7861803482069, 518.9650233656363, 511.6149904395216, 471.6288913075285, 469.3866876148382, 505.92175661834875, 482.7392566401484, 509.51640197945983, 485.780895112012, 416.91125504265256, 483.04716420875934, 501.2811746976962, 658.7461877564846, 459.28404623205455, 357.6202649921975, 507.25391251945126, 524.4139058765605, 386.98117116357355, 456.4212970487006, 434.03421648224884, 530.6300485322332, 570.7871897335268, 343.97613516788624, 527.2830622186822, 511.50183169217524, 482.8353402014054, 603.0150221419871, 363.96954121519707, 477.6334090286904, 443.652475158371, 390.52194909878904, 544.2649303347724, 432.78893690017765, 355.8576944233378, 403.7974881987335, 316.3670692832397, 488.64840544552527, 500.7005879675468, 581.0171413633852, 392.1416794617075, 619.0332999713719, 524.0491758742701, 558.1597676940006, 528.096441166941, 423.1340783242997, 393.3353271818202, 581.0294973778524, 492.51371110881837, 480.05733894360986, 399.92848729858736, 377.41079735909415, 519.3528696777188, 453.98326506950093, 551.7959738324296, 321.04343789751294, 381.2031832047492, 400.25149733579843, 486.237667496529, 387.671638148676, 402.4919127699674, 424.1150274544693, 446.73713363476156, 446.99560264498086, 577.445844237125, 515.257782183566, 486.7004127109443, 396.2165079147458, 310.4052087106538, 410.6641335904798, 566.7308078834783, 451.9563181523904, 574.5403033660613, 521.5951666141387, 415.60777879259865, 546.5410866878453, 497.8526712409561, 475.34154293802925, 489.58902358191443, 424.67604750934464, 564.5531839880464, 450.0137264013068, 422.56106205308663, 544.5164252030827, 477.25136265768225, 465.828746772688, 570.7494375142453, 534.7525892605379, 412.1214811822749, 459.566857708324, 449.30449188951934, 548.2456029868947, 478.52840048899714], "policy_predator_policy_reward": [96.34775900472027, 46.7448322123566, 30.589423194949838, 223.17399692300506, 346.54165870536747, 442.51815837066135, 106.06570691591051, 14.453656749935789, 232.62721747400082, 236.60588509189174, 243.6525895205392, 97.1823790322538, 225.5006054726939, 183.8271695938008, 242.7857488210456, 280.74577264909715, 97.40873778693634, 97.45382501759897, 165.45273594572444, 248.92140517505416, 310.0057252804088, 162.52969536660376, 376.83447672880203, 193.28036356836196, 68.41146002590807, -1.57282583128897, 237.9974644568495, 355.2527910535788, 353.90491445900926, 136.26840706067776, 192.93440888775757, 142.63457873024998, 266.4788851146247, 185.3120294700213, 164.188231192473, 116.41664815336114, 22.883246913621804, 92.64511709991761, 362.43345202061306, 390.6546122779454, 397.7369333136249, 441.2134979441779, 259.8156007962104, 88.38113084072138, 218.1897892353122, 296.5439023899497, 130.34787786250683, 152.81341304991264, 337.1562990458326, 173.12277444016362, 381.02783097971076, 337.9525157809065, 171.86768278854277, 152.3915557241788, 512.1578117419754, 356.86677839544024, 330.6845980263426, 176.57552748988167, 518.6119727858727, 382.36695247051836, 253.96595443400045, 274.64327720400377, 239.20675931440093, 374.4051429633218, 245.7515650750035, 256.87725576156987, 105.45185904531105, 322.51825758951594, 171.06263292060873, 258.69623616775914, 166.41494704932992, 147.3501830062383, 95.17687754692217, 304.3910966266326, 36.05743360100641, 144.89017820907506, 140.4610505751084, 205.91369631424095, 344.6417727623058, 317.99039833340856, 118.39298984617139, 382.9197235053382, 371.5156189323193, 327.99445259641567, 293.9328994210866, 345.7303025771536, 398.0328139575963, 422.23328254903385, 258.97469287066673, 450.3983146560266, 278.2022751493543, 378.9840183112922, 265.9127766629009, 328.7716423311411, 395.5357648179763, 271.6848344602569, 309.9890895169071, 326.444567326914, 218.1283837073755, 273.5383294720028, 219.39821284963617, 156.5599194482118, 442.2592022010663, 226.93273934480348, 302.5915458277853, 330.16740686058046, 511.07648769584677, 482.5627358857717, 407.3477099184938, 508.66102753071976, 483.63530839265127, 365.3013057768457, 476.0565266172203, 490.4179033766237, 365.2388301531481, 313.1039075310634, 234.0483808495098, 298.01859761991494, 494.75689965133904, 339.45731200259195, 312.5953558472497, 288.73533452363506, 283.04658985923726, 288.8928117800316, 338.3697413372613, 391.8650743109352, 264.62185278573685, 269.6982764727695, 411.3147207274106, 252.98456379684404, 319.30214114321916, 387.5843898819929, 296.65064694782353, 409.1185223329124, 181.84776914398032, 263.89963772743243, 486.8705039277839, 255.9502739353363, 285.93106438869194, 221.24320337413502, 257.86910607962835, 227.14369605052298, 271.29861746505384, 278.9106995774772, 113.57674726377175, 151.86995240915323, 477.8535940646405, 438.56106271161224, 356.1263579116279, 357.68490617329036, 316.9580877335779, 240.5347213157964, 277.6039567013441, 356.5797090944897, 316.2456548001068, 142.10678890553282, 384.8720219674753, 408.41556879865914, 347.3065507395487, 330.7481137675537, 319.6102567982507, 267.65381501344416, 179.36289142870913, 251.53722704249057, 394.91631034340315, 430.5824642281702, 560.3548969011107, 571.9160531170212, 306.4439915044378, 112.77817837494732, 222.3740996056106, 210.68875873803543, 330.42047867284424, 364.68195814166165, 331.0137514357363, 289.5593307452995, 379.8657347412993, 332.9439150872309, 390.6948075076026, 73.89348349306124, 440.91082096605976, 296.65336231609143, 270.0657322729933, 391.8786647862579, 288.70662630512135, 308.0307811704564, 331.6635835960509, 386.23931144171695, 96.95643320042161, 107.12059494810347, 382.77755773796656, 406.49143406468784, 211.7163108778251, 199.0863554908249, 156.2702135095444, 220.99191051516704, 284.98046977656486, 178.71938399980579, 229.66252299147266, 264.12143970552677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.827576136979056, "mean_inference_ms": 2.243500297095074, "mean_action_processing_ms": 0.3403145423282774, "mean_env_wait_ms": 0.2958596930860502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014516115188598633, "StateBufferConnector_ms": 0.0045680999755859375, "ViewRequirementAgentConnector_ms": 0.16589152812957764}, "num_episodes": 22, "episode_return_max": 1982.7599411630565, "episode_return_min": 636.2215508485497, "episode_return_mean": 1497.9169143396937, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.62076983012963, "num_env_steps_trained_throughput_per_sec": 347.62076983012963, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 13094.826, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13094.772, "sample_time_ms": 1845.45, "learn_time_ms": 11233.426, "learn_throughput": 356.08, "synch_weights_time_ms": 13.985}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "8abce_00000", "date": "2024-08-16_11-23-26", "timestamp": 1723787606, "time_this_iter_s": 11.511409044265747, "time_total_s": 118.13203954696655, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x322793790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 118.13203954696655, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 54.09375000000001, "ram_util_percent": 72.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3883758321798667, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.796894068945022, "policy_loss": -0.0011843210408986403, "vf_loss": 9.796183219283977, "vf_explained_var": -0.005946821825844901, "kl": 0.01895155554489996, "entropy": 1.4561779277034537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2923518835867525, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.649168089710216, "policy_loss": -0.0076999059758794605, "vf_loss": 9.654545490325443, "vf_explained_var": -0.0011826964282484911, "kl": 0.01161275353544153, "entropy": 1.4838573211084598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 1982.7599411630565, "episode_reward_min": 843.2097043720812, "episode_reward_mean": 1596.3504558029456, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 74.86143079024134, "predator_policy": 36.05743360100641}, "policy_reward_max": {"prey_policy": 720.3824439204143, "predator_policy": 571.9160531170212}, "policy_reward_mean": {"prey_policy": 480.96502491471415, "predator_policy": 317.21020298675876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [995.322860062993, 1332.5876302375234, 1772.52118047651, 1316.2911110578987, 1866.577920305304, 1550.7593927486478, 1799.8464062534952, 1237.7116116234415, 1777.7381216309304, 1760.1018037343629, 1337.3140368956285, 1445.9097350103611, 1274.8462934618694, 1266.6724796817591, 843.2097043720812, 1482.8187411422184, 1703.4403720416476, 1426.3552326804795, 1622.3498114373315, 1751.8097520266838, 1750.7297037339843, 1769.277624274923, 1605.1660415210254, 1472.7997305095985, 1698.6835081812849, 1674.1811095388514, 1499.7897850774143, 1249.787018605682, 1763.1817666067998, 1620.549399600198, 1821.857431812934, 1982.7599411630565, 1832.1804959165488, 1941.7828742270312, 1670.598396303821, 1434.7591286240897, 1818.5425505603862, 1719.3609243594246, 1436.813579150918, 1641.6298926883292, 1424.775642789456, 1765.7165227900136, 1578.1457284117794, 1700.1063411743162, 1412.7319702285959, 1664.1066620501797, 1441.9611471963876, 1273.6594334536667, 1270.3738745245046, 1254.7956930859975, 1889.573477601345, 1856.89373993056, 1643.749017910314, 1450.6530713019536, 1531.895652192309, 1673.2734170083324, 1574.8183315439137, 1593.0433107136262, 1133.1467395734614, 1711.9879394039033, 1922.4345009367744, 1290.0743309686152, 1457.5043052257524, 1697.0606317090167, 1327.1947988064344, 1690.2045913024874, 1491.0849125191166, 1674.7671286888894, 1706.338154988053, 1561.6679739955237, 1707.1321265351578, 1076.651816602918, 1811.036779663419, 1447.3808506555852, 1324.1361944675245, 1372.5712033742143, 1520.5579661728927, 1652.4386324820491, 1830.8383267565255, 1812.2624354346574, 1584.5908632190533, 1852.9981615708168, 1744.7746104050166, 1583.4104776697345, 1836.6066558920963, 1919.9113002817037, 1810.3471463731603, 1694.7499813324064, 1549.367485537712, 1821.176446054967, 1590.2834753245106, 1428.3185260219989, 1663.731086249757, 1890.2924228139645, 1737.7960916641887, 1651.4947638251215, 1780.7625301370988, 1588.5682593875767, 1890.523011888713, 1827.981811137286], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [74.86143079024134, 637.3001383603337, 423.4265250294157, 398.88203172211297, 644.6201116485347, 408.9207220673596, 333.39261855818455, 658.6392539869922, 470.32455970709856, 527.2287704607891, 534.7870789432336, 508.71218828919143, 484.81951625059344, 414.04796474651124, 410.07989268988547, 299.02248729555174, 653.8223368648438, 510.3038824883644, 720.3824439204143, 537.0905389773733, 493.1098551141152, 416.2340651466866, 577.4893075042696, 438.6615584177249, 590.5989030364998, 370.482260369801, 419.36681901835846, 447.73768648984515, 345.41024717426586, 316.85184538773495, 636.8425465203542, 499.6014477325153, 568.29488938529, 472.51331156064305, 577.4435313467922, 347.5989879821784, 531.7124797231926, 391.127260185404, 547.6342343599986, 564.5123156684476, 589.2441960592696, 341.2194111680858, 473.27842332401286, 586.6261934242178, 535.1467400785098, 412.83300798186986, 469.18702338925914, 408.9282881262988, 572.0880238039344, 459.37488509911674, 578.2908350502953, 459.45661764473397, 387.9415241055164, 620.1815477925204, 502.5639237608278, 371.2649625470064, 515.9115939934331, 578.0782310674966, 564.5809917091898, 423.2094552026433, 409.1461956923008, 419.07201253901417, 547.7861803482069, 518.9650233656363, 511.6149904395216, 471.6288913075285, 469.3866876148382, 505.92175661834875, 482.7392566401484, 509.51640197945983, 485.780895112012, 416.91125504265256, 483.04716420875934, 501.2811746976962, 658.7461877564846, 459.28404623205455, 357.6202649921975, 507.25391251945126, 524.4139058765605, 386.98117116357355, 456.4212970487006, 434.03421648224884, 530.6300485322332, 570.7871897335268, 343.97613516788624, 527.2830622186822, 511.50183169217524, 482.8353402014054, 603.0150221419871, 363.96954121519707, 477.6334090286904, 443.652475158371, 390.52194909878904, 544.2649303347724, 432.78893690017765, 355.8576944233378, 403.7974881987335, 316.3670692832397, 488.64840544552527, 500.7005879675468, 581.0171413633852, 392.1416794617075, 619.0332999713719, 524.0491758742701, 558.1597676940006, 528.096441166941, 423.1340783242997, 393.3353271818202, 581.0294973778524, 492.51371110881837, 480.05733894360986, 399.92848729858736, 377.41079735909415, 519.3528696777188, 453.98326506950093, 551.7959738324296, 321.04343789751294, 381.2031832047492, 400.25149733579843, 486.237667496529, 387.671638148676, 402.4919127699674, 424.1150274544693, 446.73713363476156, 446.99560264498086, 577.445844237125, 515.257782183566, 486.7004127109443, 396.2165079147458, 310.4052087106538, 410.6641335904798, 566.7308078834783, 451.9563181523904, 574.5403033660613, 521.5951666141387, 415.60777879259865, 546.5410866878453, 497.8526712409561, 475.34154293802925, 489.58902358191443, 424.67604750934464, 564.5531839880464, 450.0137264013068, 422.56106205308663, 544.5164252030827, 477.25136265768225, 465.828746772688, 570.7494375142453, 534.7525892605379, 412.1214811822749, 459.566857708324, 449.30449188951934, 548.2456029868947, 478.52840048899714, 547.5524540162669, 493.1452071135171, 593.9588026427724, 570.5697996648089, 472.93514335663446, 492.49920610969696, 383.9159142629804, 559.8753942763705, 481.9929663259685, 449.2407416703212, 568.3112862251783, 502.4454786200608, 537.8126274797858, 412.80719799586666, 394.89848591214104, 420.0590909696199, 468.24500918970574, 456.37446648852756, 402.16555537925353, 459.04181813994745, 487.60114854814447, 458.51616211288837, 570.2580015023854, 502.27335781306, 580.6209797445239, 434.2505860995722, 568.4291682738555, 515.1999305350557, 480.4878907304975, 484.8929093303705, 494.02317737009804, 408.0210924685986, 479.9783789916037, 501.18290686855886, 538.8471109300983, 531.388754756879, 432.62312572201074, 587.0178604618095, 556.7413394599207, 558.4504832897964, 436.650730804486, 627.1466307988545, 336.04455874357143, 456.9687042019476, 482.61353908660897, 544.9519272753523], "policy_predator_policy_reward": [130.34787786250683, 152.81341304991264, 337.1562990458326, 173.12277444016362, 381.02783097971076, 337.9525157809065, 171.86768278854277, 152.3915557241788, 512.1578117419754, 356.86677839544024, 330.6845980263426, 176.57552748988167, 518.6119727858727, 382.36695247051836, 253.96595443400045, 274.64327720400377, 239.20675931440093, 374.4051429633218, 245.7515650750035, 256.87725576156987, 105.45185904531105, 322.51825758951594, 171.06263292060873, 258.69623616775914, 166.41494704932992, 147.3501830062383, 95.17687754692217, 304.3910966266326, 36.05743360100641, 144.89017820907506, 140.4610505751084, 205.91369631424095, 344.6417727623058, 317.99039833340856, 118.39298984617139, 382.9197235053382, 371.5156189323193, 327.99445259641567, 293.9328994210866, 345.7303025771536, 398.0328139575963, 422.23328254903385, 258.97469287066673, 450.3983146560266, 278.2022751493543, 378.9840183112922, 265.9127766629009, 328.7716423311411, 395.5357648179763, 271.6848344602569, 309.9890895169071, 326.444567326914, 218.1283837073755, 273.5383294720028, 219.39821284963617, 156.5599194482118, 442.2592022010663, 226.93273934480348, 302.5915458277853, 330.16740686058046, 511.07648769584677, 482.5627358857717, 407.3477099184938, 508.66102753071976, 483.63530839265127, 365.3013057768457, 476.0565266172203, 490.4179033766237, 365.2388301531481, 313.1039075310634, 234.0483808495098, 298.01859761991494, 494.75689965133904, 339.45731200259195, 312.5953558472497, 288.73533452363506, 283.04658985923726, 288.8928117800316, 338.3697413372613, 391.8650743109352, 264.62185278573685, 269.6982764727695, 411.3147207274106, 252.98456379684404, 319.30214114321916, 387.5843898819929, 296.65064694782353, 409.1185223329124, 181.84776914398032, 263.89963772743243, 486.8705039277839, 255.9502739353363, 285.93106438869194, 221.24320337413502, 257.86910607962835, 227.14369605052298, 271.29861746505384, 278.9106995774772, 113.57674726377175, 151.86995240915323, 477.8535940646405, 438.56106271161224, 356.1263579116279, 357.68490617329036, 316.9580877335779, 240.5347213157964, 277.6039567013441, 356.5797090944897, 316.2456548001068, 142.10678890553282, 384.8720219674753, 408.41556879865914, 347.3065507395487, 330.7481137675537, 319.6102567982507, 267.65381501344416, 179.36289142870913, 251.53722704249057, 394.91631034340315, 430.5824642281702, 560.3548969011107, 571.9160531170212, 306.4439915044378, 112.77817837494732, 222.3740996056106, 210.68875873803543, 330.42047867284424, 364.68195814166165, 331.0137514357363, 289.5593307452995, 379.8657347412993, 332.9439150872309, 390.6948075076026, 73.89348349306124, 440.91082096605976, 296.65336231609143, 270.0657322729933, 391.8786647862579, 288.70662630512135, 308.0307811704564, 331.6635835960509, 386.23931144171695, 96.95643320042161, 107.12059494810347, 382.77755773796656, 406.49143406468784, 211.7163108778251, 199.0863554908249, 156.2702135095444, 220.99191051516704, 284.98046977656486, 178.71938399980579, 229.66252299147266, 264.12143970552677, 289.0180045356166, 322.72296681664835, 249.27155642158687, 417.0381680273561, 430.87868448834695, 415.9494014799806, 333.0827889839425, 307.71676569576016, 510.0090382592955, 411.75541531523135, 295.40053229491576, 378.6173132648637, 261.94183110531407, 370.84882108876803, 480.53252624242197, 541.1165527679141, 544.8915806844134, 450.4002439190574, 522.820179095688, 426.3195937582709, 359.1122134207614, 389.52045725061333, 189.59281195390787, 287.24331426836136, 418.80141614786913, 387.5034640630025, 239.1890350747433, 267.46534144085564, 144.48094437742674, 318.45678158370356, 309.6202137774966, 452.0666026335639, 438.70878844054397, 470.42234851325776, 369.8905230424254, 297.6697029347865, 292.86778161962286, 338.9859960216784, 366.1340980975838, 299.4366092897978, 304.21335399609734, 220.55754378813762, 525.9061658005805, 571.6035831426153, 416.4262348079802, 383.99010996734427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8784146368498351, "mean_inference_ms": 2.4045497286882695, "mean_action_processing_ms": 0.35999695955066163, "mean_env_wait_ms": 0.3171050959297649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01356661319732666, "StateBufferConnector_ms": 0.003415703773498535, "ViewRequirementAgentConnector_ms": 0.16367638111114502}, "num_episodes": 23, "episode_return_max": 1982.7599411630565, "episode_return_min": 843.2097043720812, "episode_return_mean": 1596.3504558029456, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.2391604182711, "num_env_steps_trained_throughput_per_sec": 315.2391604182711, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 13054.222, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13054.169, "sample_time_ms": 1811.025, "learn_time_ms": 11227.379, "learn_throughput": 356.272, "synch_weights_time_ms": 13.946}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "8abce_00000", "date": "2024-08-16_11-23-38", "timestamp": 1723787618, "time_this_iter_s": 12.804519891738892, "time_total_s": 130.93655943870544, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4196280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 130.93655943870544, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 68.58333333333333, "ram_util_percent": 73.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3612333323116657, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.82594569725965, "policy_loss": -0.004492507956271607, "vf_loss": 9.829568402729338, "vf_explained_var": -0.013135631437654848, "kl": 0.008697896798270805, "entropy": 1.4602949060460246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3828609010845265, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.815199648640144, "policy_loss": -0.0030301262545719665, "vf_loss": 9.816643663436647, "vf_explained_var": -0.0010130360959068178, "kl": 0.007930667629595847, "entropy": 1.5265569785284618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 2004.521459603488, "episode_reward_min": 1076.651816602918, "episode_reward_mean": 1653.1191078758543, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 310.4052087106538, "predator_policy": 73.89348349306124}, "policy_reward_max": {"prey_policy": 658.7461877564846, "predator_policy": 571.9160531170212}, "policy_reward_mean": {"prey_policy": 486.3561301948372, "predator_policy": 340.20342374309024}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1622.3498114373315, 1751.8097520266838, 1750.7297037339843, 1769.277624274923, 1605.1660415210254, 1472.7997305095985, 1698.6835081812849, 1674.1811095388514, 1499.7897850774143, 1249.787018605682, 1763.1817666067998, 1620.549399600198, 1821.857431812934, 1982.7599411630565, 1832.1804959165488, 1941.7828742270312, 1670.598396303821, 1434.7591286240897, 1818.5425505603862, 1719.3609243594246, 1436.813579150918, 1641.6298926883292, 1424.775642789456, 1765.7165227900136, 1578.1457284117794, 1700.1063411743162, 1412.7319702285959, 1664.1066620501797, 1441.9611471963876, 1273.6594334536667, 1270.3738745245046, 1254.7956930859975, 1889.573477601345, 1856.89373993056, 1643.749017910314, 1450.6530713019536, 1531.895652192309, 1673.2734170083324, 1574.8183315439137, 1593.0433107136262, 1133.1467395734614, 1711.9879394039033, 1922.4345009367744, 1290.0743309686152, 1457.5043052257524, 1697.0606317090167, 1327.1947988064344, 1690.2045913024874, 1491.0849125191166, 1674.7671286888894, 1706.338154988053, 1561.6679739955237, 1707.1321265351578, 1076.651816602918, 1811.036779663419, 1447.3808506555852, 1324.1361944675245, 1372.5712033742143, 1520.5579661728927, 1652.4386324820491, 1830.8383267565255, 1812.2624354346574, 1584.5908632190533, 1852.9981615708168, 1744.7746104050166, 1583.4104776697345, 1836.6066558920963, 1919.9113002817037, 1810.3471463731603, 1694.7499813324064, 1549.367485537712, 1821.176446054967, 1590.2834753245106, 1428.3185260219989, 1663.731086249757, 1890.2924228139645, 1737.7960916641887, 1651.4947638251215, 1780.7625301370988, 1588.5682593875767, 1890.523011888713, 1827.981811137286, 1895.6596723548153, 1727.9967122817689, 1907.0050009659394, 1607.5369115530173, 1844.0499879909285, 1247.08776308109, 1939.1571644555322, 1628.1620850049383, 1771.7087027437874, 1683.4515611656159, 1669.5625850066406, 1840.282501103384, 2004.521459603488, 1949.7066345537455, 1676.3197144721269, 1879.390087394257, 1876.934880336688, 1718.3564166402643], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [531.7124797231926, 391.127260185404, 547.6342343599986, 564.5123156684476, 589.2441960592696, 341.2194111680858, 473.27842332401286, 586.6261934242178, 535.1467400785098, 412.83300798186986, 469.18702338925914, 408.9282881262988, 572.0880238039344, 459.37488509911674, 578.2908350502953, 459.45661764473397, 387.9415241055164, 620.1815477925204, 502.5639237608278, 371.2649625470064, 515.9115939934331, 578.0782310674966, 564.5809917091898, 423.2094552026433, 409.1461956923008, 419.07201253901417, 547.7861803482069, 518.9650233656363, 511.6149904395216, 471.6288913075285, 469.3866876148382, 505.92175661834875, 482.7392566401484, 509.51640197945983, 485.780895112012, 416.91125504265256, 483.04716420875934, 501.2811746976962, 658.7461877564846, 459.28404623205455, 357.6202649921975, 507.25391251945126, 524.4139058765605, 386.98117116357355, 456.4212970487006, 434.03421648224884, 530.6300485322332, 570.7871897335268, 343.97613516788624, 527.2830622186822, 511.50183169217524, 482.8353402014054, 603.0150221419871, 363.96954121519707, 477.6334090286904, 443.652475158371, 390.52194909878904, 544.2649303347724, 432.78893690017765, 355.8576944233378, 403.7974881987335, 316.3670692832397, 488.64840544552527, 500.7005879675468, 581.0171413633852, 392.1416794617075, 619.0332999713719, 524.0491758742701, 558.1597676940006, 528.096441166941, 423.1340783242997, 393.3353271818202, 581.0294973778524, 492.51371110881837, 480.05733894360986, 399.92848729858736, 377.41079735909415, 519.3528696777188, 453.98326506950093, 551.7959738324296, 321.04343789751294, 381.2031832047492, 400.25149733579843, 486.237667496529, 387.671638148676, 402.4919127699674, 424.1150274544693, 446.73713363476156, 446.99560264498086, 577.445844237125, 515.257782183566, 486.7004127109443, 396.2165079147458, 310.4052087106538, 410.6641335904798, 566.7308078834783, 451.9563181523904, 574.5403033660613, 521.5951666141387, 415.60777879259865, 546.5410866878453, 497.8526712409561, 475.34154293802925, 489.58902358191443, 424.67604750934464, 564.5531839880464, 450.0137264013068, 422.56106205308663, 544.5164252030827, 477.25136265768225, 465.828746772688, 570.7494375142453, 534.7525892605379, 412.1214811822749, 459.566857708324, 449.30449188951934, 548.2456029868947, 478.52840048899714, 547.5524540162669, 493.1452071135171, 593.9588026427724, 570.5697996648089, 472.93514335663446, 492.49920610969696, 383.9159142629804, 559.8753942763705, 481.9929663259685, 449.2407416703212, 568.3112862251783, 502.4454786200608, 537.8126274797858, 412.80719799586666, 394.89848591214104, 420.0590909696199, 468.24500918970574, 456.37446648852756, 402.16555537925353, 459.04181813994745, 487.60114854814447, 458.51616211288837, 570.2580015023854, 502.27335781306, 580.6209797445239, 434.2505860995722, 568.4291682738555, 515.1999305350557, 480.4878907304975, 484.8929093303705, 494.02317737009804, 408.0210924685986, 479.9783789916037, 501.18290686855886, 538.8471109300983, 531.388754756879, 432.62312572201074, 587.0178604618095, 556.7413394599207, 558.4504832897964, 436.650730804486, 627.1466307988545, 336.04455874357143, 456.9687042019476, 482.61353908660897, 544.9519272753523, 578.1848539041317, 548.992088196517, 573.6800686420597, 398.81660727357144, 565.9797349653561, 582.9888482987277, 440.5023964781945, 460.0428430254789, 412.45672119033514, 509.0258401361668, 398.5294102518424, 435.1428280067931, 453.75845896518354, 571.276222491651, 624.4269455117992, 539.9195697573382, 328.50233984177567, 539.5669498546549, 428.36461863497993, 513.1758999634217, 485.9753351369292, 579.3884846892923, 608.9569963525556, 465.540754341842, 568.2994805578411, 529.4497045022911, 406.83179764618643, 499.3112596599584, 481.8847475475693, 468.80721714694164, 468.6786084234768, 643.6443833902113, 560.8552226262557, 553.3112810813018, 532.5026389731869, 490.35165354287915], "policy_predator_policy_reward": [371.5156189323193, 327.99445259641567, 293.9328994210866, 345.7303025771536, 398.0328139575963, 422.23328254903385, 258.97469287066673, 450.3983146560266, 278.2022751493543, 378.9840183112922, 265.9127766629009, 328.7716423311411, 395.5357648179763, 271.6848344602569, 309.9890895169071, 326.444567326914, 218.1283837073755, 273.5383294720028, 219.39821284963617, 156.5599194482118, 442.2592022010663, 226.93273934480348, 302.5915458277853, 330.16740686058046, 511.07648769584677, 482.5627358857717, 407.3477099184938, 508.66102753071976, 483.63530839265127, 365.3013057768457, 476.0565266172203, 490.4179033766237, 365.2388301531481, 313.1039075310634, 234.0483808495098, 298.01859761991494, 494.75689965133904, 339.45731200259195, 312.5953558472497, 288.73533452363506, 283.04658985923726, 288.8928117800316, 338.3697413372613, 391.8650743109352, 264.62185278573685, 269.6982764727695, 411.3147207274106, 252.98456379684404, 319.30214114321916, 387.5843898819929, 296.65064694782353, 409.1185223329124, 181.84776914398032, 263.89963772743243, 486.8705039277839, 255.9502739353363, 285.93106438869194, 221.24320337413502, 257.86910607962835, 227.14369605052298, 271.29861746505384, 278.9106995774772, 113.57674726377175, 151.86995240915323, 477.8535940646405, 438.56106271161224, 356.1263579116279, 357.68490617329036, 316.9580877335779, 240.5347213157964, 277.6039567013441, 356.5797090944897, 316.2456548001068, 142.10678890553282, 384.8720219674753, 408.41556879865914, 347.3065507395487, 330.7481137675537, 319.6102567982507, 267.65381501344416, 179.36289142870913, 251.53722704249057, 394.91631034340315, 430.5824642281702, 560.3548969011107, 571.9160531170212, 306.4439915044378, 112.77817837494732, 222.3740996056106, 210.68875873803543, 330.42047867284424, 364.68195814166165, 331.0137514357363, 289.5593307452995, 379.8657347412993, 332.9439150872309, 390.6948075076026, 73.89348349306124, 440.91082096605976, 296.65336231609143, 270.0657322729933, 391.8786647862579, 288.70662630512135, 308.0307811704564, 331.6635835960509, 386.23931144171695, 96.95643320042161, 107.12059494810347, 382.77755773796656, 406.49143406468784, 211.7163108778251, 199.0863554908249, 156.2702135095444, 220.99191051516704, 284.98046977656486, 178.71938399980579, 229.66252299147266, 264.12143970552677, 289.0180045356166, 322.72296681664835, 249.27155642158687, 417.0381680273561, 430.87868448834695, 415.9494014799806, 333.0827889839425, 307.71676569576016, 510.0090382592955, 411.75541531523135, 295.40053229491576, 378.6173132648637, 261.94183110531407, 370.84882108876803, 480.53252624242197, 541.1165527679141, 544.8915806844134, 450.4002439190574, 522.820179095688, 426.3195937582709, 359.1122134207614, 389.52045725061333, 189.59281195390787, 287.24331426836136, 418.80141614786913, 387.5034640630025, 239.1890350747433, 267.46534144085564, 144.48094437742674, 318.45678158370356, 309.6202137774966, 452.0666026335639, 438.70878844054397, 470.42234851325776, 369.8905230424254, 297.6697029347865, 292.86778161962286, 338.9859960216784, 366.1340980975838, 299.4366092897978, 304.21335399609734, 220.55754378813762, 525.9061658005805, 571.6035831426153, 416.4262348079802, 383.99010996734427, 348.4195861490679, 420.06314410509697, 365.41686702568865, 390.0831693404502, 441.90522375579263, 316.13119394606304, 364.91136255229065, 342.08030949705295, 406.5325306405517, 516.0348960238747, 257.42082136189634, 155.99470346055912, 430.98914258834174, 483.1333404103558, 245.36827107114883, 218.44729866465303, 390.3620415620637, 513.2773714852943, 373.1692610275377, 368.7417815396779, 379.0473217806454, 225.15144339977493, 378.16140844715466, 387.6233419618325, 373.901945578928, 532.8703289644287, 556.5011568074212, 487.06242044017813, 343.98529384314867, 381.64245593446907, 410.3415007050795, 356.72559487549125, 350.6100529047214, 412.15832372441014, 370.60079111596485, 324.9013330082354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8767224024614128, "mean_inference_ms": 2.385875328469261, "mean_action_processing_ms": 0.3580125739445527, "mean_env_wait_ms": 0.31551885114088407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009441733360290527, "StateBufferConnector_ms": 0.0034084320068359375, "ViewRequirementAgentConnector_ms": 0.14732050895690918}, "num_episodes": 18, "episode_return_max": 2004.521459603488, "episode_return_min": 1076.651816602918, "episode_return_mean": 1653.1191078758543, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.89787313895874, "num_env_steps_trained_throughput_per_sec": 253.89787313895874, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 13395.29, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13395.232, "sample_time_ms": 1939.73, "learn_time_ms": 11438.328, "learn_throughput": 349.701, "synch_weights_time_ms": 15.276}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "8abce_00000", "date": "2024-08-16_11-23-54", "timestamp": 1723787634, "time_this_iter_s": 15.781022071838379, "time_total_s": 146.71758151054382, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a436b700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 146.71758151054382, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 72.54347826086958, "ram_util_percent": 78.02608695652174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3650220591239828, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.838866101118622, "policy_loss": -0.0007147784352243419, "vf_loss": 9.838531265561542, "vf_explained_var": -0.020927293874599316, "kl": 0.010496337250980045, "entropy": 1.4646584688040314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4142469331543281, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.71123470276121, "policy_loss": -0.0076300610121704205, "vf_loss": 9.716143576808708, "vf_explained_var": -0.014568421449610796, "kl": 0.013605833378001145, "entropy": 1.5208617636766384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 2004.521459603488, "episode_reward_min": 1076.651816602918, "episode_reward_mean": 1659.6337509453735, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 310.4052087106538, "predator_policy": 73.89348349306124}, "policy_reward_max": {"prey_policy": 727.6341418919948, "predator_policy": 571.9160531170212}, "policy_reward_mean": {"prey_policy": 491.59802199881904, "predator_policy": 338.21885347386785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1818.5425505603862, 1719.3609243594246, 1436.813579150918, 1641.6298926883292, 1424.775642789456, 1765.7165227900136, 1578.1457284117794, 1700.1063411743162, 1412.7319702285959, 1664.1066620501797, 1441.9611471963876, 1273.6594334536667, 1270.3738745245046, 1254.7956930859975, 1889.573477601345, 1856.89373993056, 1643.749017910314, 1450.6530713019536, 1531.895652192309, 1673.2734170083324, 1574.8183315439137, 1593.0433107136262, 1133.1467395734614, 1711.9879394039033, 1922.4345009367744, 1290.0743309686152, 1457.5043052257524, 1697.0606317090167, 1327.1947988064344, 1690.2045913024874, 1491.0849125191166, 1674.7671286888894, 1706.338154988053, 1561.6679739955237, 1707.1321265351578, 1076.651816602918, 1811.036779663419, 1447.3808506555852, 1324.1361944675245, 1372.5712033742143, 1520.5579661728927, 1652.4386324820491, 1830.8383267565255, 1812.2624354346574, 1584.5908632190533, 1852.9981615708168, 1744.7746104050166, 1583.4104776697345, 1836.6066558920963, 1919.9113002817037, 1810.3471463731603, 1694.7499813324064, 1549.367485537712, 1821.176446054967, 1590.2834753245106, 1428.3185260219989, 1663.731086249757, 1890.2924228139645, 1737.7960916641887, 1651.4947638251215, 1780.7625301370988, 1588.5682593875767, 1890.523011888713, 1827.981811137286, 1895.6596723548153, 1727.9967122817689, 1907.0050009659394, 1607.5369115530173, 1844.0499879909285, 1247.08776308109, 1939.1571644555322, 1628.1620850049383, 1771.7087027437874, 1683.4515611656159, 1669.5625850066406, 1840.282501103384, 2004.521459603488, 1949.7066345537455, 1676.3197144721269, 1879.390087394257, 1876.934880336688, 1718.3564166402643, 1398.0612574429292, 1914.8160532758138, 1504.4492431787326, 1706.6302556285034, 1794.8533430553823, 1625.6171271891294, 1461.8736616639246, 1717.3038196758196, 1594.1793121720352, 1664.4088217806025, 1791.4909538137747, 1766.733995668956, 1764.2599930742902, 1947.2463964331941, 1460.501776754481, 1961.2899762810953, 1799.0755104412294, 1940.9163285832597], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [483.04716420875934, 501.2811746976962, 658.7461877564846, 459.28404623205455, 357.6202649921975, 507.25391251945126, 524.4139058765605, 386.98117116357355, 456.4212970487006, 434.03421648224884, 530.6300485322332, 570.7871897335268, 343.97613516788624, 527.2830622186822, 511.50183169217524, 482.8353402014054, 603.0150221419871, 363.96954121519707, 477.6334090286904, 443.652475158371, 390.52194909878904, 544.2649303347724, 432.78893690017765, 355.8576944233378, 403.7974881987335, 316.3670692832397, 488.64840544552527, 500.7005879675468, 581.0171413633852, 392.1416794617075, 619.0332999713719, 524.0491758742701, 558.1597676940006, 528.096441166941, 423.1340783242997, 393.3353271818202, 581.0294973778524, 492.51371110881837, 480.05733894360986, 399.92848729858736, 377.41079735909415, 519.3528696777188, 453.98326506950093, 551.7959738324296, 321.04343789751294, 381.2031832047492, 400.25149733579843, 486.237667496529, 387.671638148676, 402.4919127699674, 424.1150274544693, 446.73713363476156, 446.99560264498086, 577.445844237125, 515.257782183566, 486.7004127109443, 396.2165079147458, 310.4052087106538, 410.6641335904798, 566.7308078834783, 451.9563181523904, 574.5403033660613, 521.5951666141387, 415.60777879259865, 546.5410866878453, 497.8526712409561, 475.34154293802925, 489.58902358191443, 424.67604750934464, 564.5531839880464, 450.0137264013068, 422.56106205308663, 544.5164252030827, 477.25136265768225, 465.828746772688, 570.7494375142453, 534.7525892605379, 412.1214811822749, 459.566857708324, 449.30449188951934, 548.2456029868947, 478.52840048899714, 547.5524540162669, 493.1452071135171, 593.9588026427724, 570.5697996648089, 472.93514335663446, 492.49920610969696, 383.9159142629804, 559.8753942763705, 481.9929663259685, 449.2407416703212, 568.3112862251783, 502.4454786200608, 537.8126274797858, 412.80719799586666, 394.89848591214104, 420.0590909696199, 468.24500918970574, 456.37446648852756, 402.16555537925353, 459.04181813994745, 487.60114854814447, 458.51616211288837, 570.2580015023854, 502.27335781306, 580.6209797445239, 434.2505860995722, 568.4291682738555, 515.1999305350557, 480.4878907304975, 484.8929093303705, 494.02317737009804, 408.0210924685986, 479.9783789916037, 501.18290686855886, 538.8471109300983, 531.388754756879, 432.62312572201074, 587.0178604618095, 556.7413394599207, 558.4504832897964, 436.650730804486, 627.1466307988545, 336.04455874357143, 456.9687042019476, 482.61353908660897, 544.9519272753523, 578.1848539041317, 548.992088196517, 573.6800686420597, 398.81660727357144, 565.9797349653561, 582.9888482987277, 440.5023964781945, 460.0428430254789, 412.45672119033514, 509.0258401361668, 398.5294102518424, 435.1428280067931, 453.75845896518354, 571.276222491651, 624.4269455117992, 539.9195697573382, 328.50233984177567, 539.5669498546549, 428.36461863497993, 513.1758999634217, 485.9753351369292, 579.3884846892923, 608.9569963525556, 465.540754341842, 568.2994805578411, 529.4497045022911, 406.83179764618643, 499.3112596599584, 481.8847475475693, 468.80721714694164, 468.6786084234768, 643.6443833902113, 560.8552226262557, 553.3112810813018, 532.5026389731869, 490.35165354287915, 372.98246995007, 443.9625310087374, 470.0170434339778, 500.0116261678656, 438.88522027030655, 413.4621060826835, 527.5353198291466, 582.2241061736412, 494.5061754489957, 601.6179314451517, 464.9231040101301, 535.8079347564899, 390.8077812113244, 568.7086093841966, 583.1013984087891, 540.6165054212192, 499.08165083756694, 481.3598973944799, 630.7570781325037, 511.81651101115233, 614.7125249079586, 535.5087396987809, 443.85397497883093, 544.0640924789019, 625.0176359543626, 727.6341418919948, 541.8882448378722, 608.6916281593141, 425.43363669054855, 519.1284884363031, 528.848572679664, 540.5429413775983, 571.1881211134886, 481.13500044912075, 517.3538301648113, 404.0534985633372], "policy_predator_policy_reward": [494.75689965133904, 339.45731200259195, 312.5953558472497, 288.73533452363506, 283.04658985923726, 288.8928117800316, 338.3697413372613, 391.8650743109352, 264.62185278573685, 269.6982764727695, 411.3147207274106, 252.98456379684404, 319.30214114321916, 387.5843898819929, 296.65064694782353, 409.1185223329124, 181.84776914398032, 263.89963772743243, 486.8705039277839, 255.9502739353363, 285.93106438869194, 221.24320337413502, 257.86910607962835, 227.14369605052298, 271.29861746505384, 278.9106995774772, 113.57674726377175, 151.86995240915323, 477.8535940646405, 438.56106271161224, 356.1263579116279, 357.68490617329036, 316.9580877335779, 240.5347213157964, 277.6039567013441, 356.5797090944897, 316.2456548001068, 142.10678890553282, 384.8720219674753, 408.41556879865914, 347.3065507395487, 330.7481137675537, 319.6102567982507, 267.65381501344416, 179.36289142870913, 251.53722704249057, 394.91631034340315, 430.5824642281702, 560.3548969011107, 571.9160531170212, 306.4439915044378, 112.77817837494732, 222.3740996056106, 210.68875873803543, 330.42047867284424, 364.68195814166165, 331.0137514357363, 289.5593307452995, 379.8657347412993, 332.9439150872309, 390.6948075076026, 73.89348349306124, 440.91082096605976, 296.65336231609143, 270.0657322729933, 391.8786647862579, 288.70662630512135, 308.0307811704564, 331.6635835960509, 386.23931144171695, 96.95643320042161, 107.12059494810347, 382.77755773796656, 406.49143406468784, 211.7163108778251, 199.0863554908249, 156.2702135095444, 220.99191051516704, 284.98046977656486, 178.71938399980579, 229.66252299147266, 264.12143970552677, 289.0180045356166, 322.72296681664835, 249.27155642158687, 417.0381680273561, 430.87868448834695, 415.9494014799806, 333.0827889839425, 307.71676569576016, 510.0090382592955, 411.75541531523135, 295.40053229491576, 378.6173132648637, 261.94183110531407, 370.84882108876803, 480.53252624242197, 541.1165527679141, 544.8915806844134, 450.4002439190574, 522.820179095688, 426.3195937582709, 359.1122134207614, 389.52045725061333, 189.59281195390787, 287.24331426836136, 418.80141614786913, 387.5034640630025, 239.1890350747433, 267.46534144085564, 144.48094437742674, 318.45678158370356, 309.6202137774966, 452.0666026335639, 438.70878844054397, 470.42234851325776, 369.8905230424254, 297.6697029347865, 292.86778161962286, 338.9859960216784, 366.1340980975838, 299.4366092897978, 304.21335399609734, 220.55754378813762, 525.9061658005805, 571.6035831426153, 416.4262348079802, 383.99010996734427, 348.4195861490679, 420.06314410509697, 365.41686702568865, 390.0831693404502, 441.90522375579263, 316.13119394606304, 364.91136255229065, 342.08030949705295, 406.5325306405517, 516.0348960238747, 257.42082136189634, 155.99470346055912, 430.98914258834174, 483.1333404103558, 245.36827107114883, 218.44729866465303, 390.3620415620637, 513.2773714852943, 373.1692610275377, 368.7417815396779, 379.0473217806454, 225.15144339977493, 378.16140844715466, 387.6233419618325, 373.901945578928, 532.8703289644287, 556.5011568074212, 487.06242044017813, 343.98529384314867, 381.64245593446907, 410.3415007050795, 356.72559487549125, 350.6100529047214, 412.15832372441014, 370.60079111596485, 324.9013330082354, 293.2289257664001, 287.8873307177202, 493.5409713900471, 451.24641228392323, 322.77600838996415, 329.32590843577685, 312.91999007353377, 283.950839552181, 328.99887546714484, 369.7303606940894, 328.58832756895674, 296.297760853553, 238.28394995152127, 264.07332111688413, 322.5998343721697, 270.9860814736413, 317.80368746579643, 295.9340764741927, 293.61456049642976, 228.2206721405169, 312.1541464749673, 329.115542732067, 372.36630059649093, 406.4496276147333, 239.44262320862273, 172.1655920193105, 340.696969005593, 455.9695544304145, 237.00614921137864, 278.93350241625035, 443.1495216577155, 448.7489405661191, 453.26386414141575, 293.4885247372046, 484.71850611599, 534.7904937391196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8758203650061566, "mean_inference_ms": 2.3804670670740267, "mean_action_processing_ms": 0.3569256497050389, "mean_env_wait_ms": 0.31456646409735034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009429574012756348, "StateBufferConnector_ms": 0.003411412239074707, "ViewRequirementAgentConnector_ms": 0.14635169506072998}, "num_episodes": 18, "episode_return_max": 2004.521459603488, "episode_return_min": 1076.651816602918, "episode_return_mean": 1659.6337509453735, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.4507217528806, "num_env_steps_trained_throughput_per_sec": 326.4507217528806, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 13429.497, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13429.438, "sample_time_ms": 1993.984, "learn_time_ms": 11417.944, "learn_throughput": 350.326, "synch_weights_time_ms": 15.577}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "8abce_00000", "date": "2024-08-16_11-24-07", "timestamp": 1723787647, "time_this_iter_s": 12.259315013885498, "time_total_s": 158.97689652442932, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a436b940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 158.97689652442932, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 48.66470588235294, "ram_util_percent": 71.95294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4215728683604134, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.802257272932264, "policy_loss": -0.004166398629812258, "vf_loss": 9.804919785797281, "vf_explained_var": -0.0312168109353888, "kl": 0.015039036223767455, "entropy": 1.4707308263375014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6218574056076625, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.537635336981879, "policy_loss": -0.002582128639160483, "vf_loss": 9.538569636571975, "vf_explained_var": -0.019696459410682557, "kl": 0.0082391762634964, "entropy": 1.5299903282412777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 2004.521459603488, "episode_reward_min": 1076.651816602918, "episode_reward_mean": 1684.9437659580071, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 310.4052087106538, "predator_policy": 73.89348349306124}, "policy_reward_max": {"prey_policy": 727.6341418919948, "predator_policy": 571.9160531170212}, "policy_reward_mean": {"prey_policy": 499.71099723629743, "predator_policy": 342.76088574270614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1531.895652192309, 1673.2734170083324, 1574.8183315439137, 1593.0433107136262, 1133.1467395734614, 1711.9879394039033, 1922.4345009367744, 1290.0743309686152, 1457.5043052257524, 1697.0606317090167, 1327.1947988064344, 1690.2045913024874, 1491.0849125191166, 1674.7671286888894, 1706.338154988053, 1561.6679739955237, 1707.1321265351578, 1076.651816602918, 1811.036779663419, 1447.3808506555852, 1324.1361944675245, 1372.5712033742143, 1520.5579661728927, 1652.4386324820491, 1830.8383267565255, 1812.2624354346574, 1584.5908632190533, 1852.9981615708168, 1744.7746104050166, 1583.4104776697345, 1836.6066558920963, 1919.9113002817037, 1810.3471463731603, 1694.7499813324064, 1549.367485537712, 1821.176446054967, 1590.2834753245106, 1428.3185260219989, 1663.731086249757, 1890.2924228139645, 1737.7960916641887, 1651.4947638251215, 1780.7625301370988, 1588.5682593875767, 1890.523011888713, 1827.981811137286, 1895.6596723548153, 1727.9967122817689, 1907.0050009659394, 1607.5369115530173, 1844.0499879909285, 1247.08776308109, 1939.1571644555322, 1628.1620850049383, 1771.7087027437874, 1683.4515611656159, 1669.5625850066406, 1840.282501103384, 2004.521459603488, 1949.7066345537455, 1676.3197144721269, 1879.390087394257, 1876.934880336688, 1718.3564166402643, 1398.0612574429292, 1914.8160532758138, 1504.4492431787326, 1706.6302556285034, 1794.8533430553823, 1625.6171271891294, 1461.8736616639246, 1717.3038196758196, 1594.1793121720352, 1664.4088217806025, 1791.4909538137747, 1766.733995668956, 1764.2599930742902, 1947.2463964331941, 1460.501776754481, 1961.2899762810953, 1799.0755104412294, 1940.9163285832597, 1947.6919029688927, 1765.8951547753977, 1724.9331152268849, 1530.9823122400053, 1670.3853747282817, 1636.8600538458998, 1883.5821826239007, 1486.2658995897311, 1911.6502200921348, 1946.1627271444813, 1691.4983581180077, 1757.0422045594912, 1419.9435217162927, 1756.3584875655986, 1904.512397441111, 1871.890455707344, 1593.7683452779893, 1275.1680568500567], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [581.0294973778524, 492.51371110881837, 480.05733894360986, 399.92848729858736, 377.41079735909415, 519.3528696777188, 453.98326506950093, 551.7959738324296, 321.04343789751294, 381.2031832047492, 400.25149733579843, 486.237667496529, 387.671638148676, 402.4919127699674, 424.1150274544693, 446.73713363476156, 446.99560264498086, 577.445844237125, 515.257782183566, 486.7004127109443, 396.2165079147458, 310.4052087106538, 410.6641335904798, 566.7308078834783, 451.9563181523904, 574.5403033660613, 521.5951666141387, 415.60777879259865, 546.5410866878453, 497.8526712409561, 475.34154293802925, 489.58902358191443, 424.67604750934464, 564.5531839880464, 450.0137264013068, 422.56106205308663, 544.5164252030827, 477.25136265768225, 465.828746772688, 570.7494375142453, 534.7525892605379, 412.1214811822749, 459.566857708324, 449.30449188951934, 548.2456029868947, 478.52840048899714, 547.5524540162669, 493.1452071135171, 593.9588026427724, 570.5697996648089, 472.93514335663446, 492.49920610969696, 383.9159142629804, 559.8753942763705, 481.9929663259685, 449.2407416703212, 568.3112862251783, 502.4454786200608, 537.8126274797858, 412.80719799586666, 394.89848591214104, 420.0590909696199, 468.24500918970574, 456.37446648852756, 402.16555537925353, 459.04181813994745, 487.60114854814447, 458.51616211288837, 570.2580015023854, 502.27335781306, 580.6209797445239, 434.2505860995722, 568.4291682738555, 515.1999305350557, 480.4878907304975, 484.8929093303705, 494.02317737009804, 408.0210924685986, 479.9783789916037, 501.18290686855886, 538.8471109300983, 531.388754756879, 432.62312572201074, 587.0178604618095, 556.7413394599207, 558.4504832897964, 436.650730804486, 627.1466307988545, 336.04455874357143, 456.9687042019476, 482.61353908660897, 544.9519272753523, 578.1848539041317, 548.992088196517, 573.6800686420597, 398.81660727357144, 565.9797349653561, 582.9888482987277, 440.5023964781945, 460.0428430254789, 412.45672119033514, 509.0258401361668, 398.5294102518424, 435.1428280067931, 453.75845896518354, 571.276222491651, 624.4269455117992, 539.9195697573382, 328.50233984177567, 539.5669498546549, 428.36461863497993, 513.1758999634217, 485.9753351369292, 579.3884846892923, 608.9569963525556, 465.540754341842, 568.2994805578411, 529.4497045022911, 406.83179764618643, 499.3112596599584, 481.8847475475693, 468.80721714694164, 468.6786084234768, 643.6443833902113, 560.8552226262557, 553.3112810813018, 532.5026389731869, 490.35165354287915, 372.98246995007, 443.9625310087374, 470.0170434339778, 500.0116261678656, 438.88522027030655, 413.4621060826835, 527.5353198291466, 582.2241061736412, 494.5061754489957, 601.6179314451517, 464.9231040101301, 535.8079347564899, 390.8077812113244, 568.7086093841966, 583.1013984087891, 540.6165054212192, 499.08165083756694, 481.3598973944799, 630.7570781325037, 511.81651101115233, 614.7125249079586, 535.5087396987809, 443.85397497883093, 544.0640924789019, 625.0176359543626, 727.6341418919948, 541.8882448378722, 608.6916281593141, 425.43363669054855, 519.1284884363031, 528.848572679664, 540.5429413775983, 571.1881211134886, 481.13500044912075, 517.3538301648113, 404.0534985633372, 558.6580469702443, 487.8621112608273, 654.9535183843047, 569.5134832797667, 463.3662642393447, 650.4291280758442, 543.9107536597998, 580.1938121944797, 448.4624593235672, 472.94297972568177, 530.246569344967, 547.3613435186622, 421.14433088869947, 485.6928534882005, 554.2110053354579, 407.10922513769265, 559.4308350128443, 484.355977416292, 511.7216019742122, 592.2720907968617, 464.6930772279343, 409.5281237736157, 525.085001011394, 565.8864268661009, 535.928673184215, 420.9794641463336, 514.9947856845912, 514.9768078008528, 594.4579965087414, 584.4818061069609, 531.937634110536, 497.5390082179307, 441.76589275935197, 572.5324142306167, 480.67909659837414, 519.5718179981889], "policy_predator_policy_reward": [316.2456548001068, 142.10678890553282, 384.8720219674753, 408.41556879865914, 347.3065507395487, 330.7481137675537, 319.6102567982507, 267.65381501344416, 179.36289142870913, 251.53722704249057, 394.91631034340315, 430.5824642281702, 560.3548969011107, 571.9160531170212, 306.4439915044378, 112.77817837494732, 222.3740996056106, 210.68875873803543, 330.42047867284424, 364.68195814166165, 331.0137514357363, 289.5593307452995, 379.8657347412993, 332.9439150872309, 390.6948075076026, 73.89348349306124, 440.91082096605976, 296.65336231609143, 270.0657322729933, 391.8786647862579, 288.70662630512135, 308.0307811704564, 331.6635835960509, 386.23931144171695, 96.95643320042161, 107.12059494810347, 382.77755773796656, 406.49143406468784, 211.7163108778251, 199.0863554908249, 156.2702135095444, 220.99191051516704, 284.98046977656486, 178.71938399980579, 229.66252299147266, 264.12143970552677, 289.0180045356166, 322.72296681664835, 249.27155642158687, 417.0381680273561, 430.87868448834695, 415.9494014799806, 333.0827889839425, 307.71676569576016, 510.0090382592955, 411.75541531523135, 295.40053229491576, 378.6173132648637, 261.94183110531407, 370.84882108876803, 480.53252624242197, 541.1165527679141, 544.8915806844134, 450.4002439190574, 522.820179095688, 426.3195937582709, 359.1122134207614, 389.52045725061333, 189.59281195390787, 287.24331426836136, 418.80141614786913, 387.5034640630025, 239.1890350747433, 267.46534144085564, 144.48094437742674, 318.45678158370356, 309.6202137774966, 452.0666026335639, 438.70878844054397, 470.42234851325776, 369.8905230424254, 297.6697029347865, 292.86778161962286, 338.9859960216784, 366.1340980975838, 299.4366092897978, 304.21335399609734, 220.55754378813762, 525.9061658005805, 571.6035831426153, 416.4262348079802, 383.99010996734427, 348.4195861490679, 420.06314410509697, 365.41686702568865, 390.0831693404502, 441.90522375579263, 316.13119394606304, 364.91136255229065, 342.08030949705295, 406.5325306405517, 516.0348960238747, 257.42082136189634, 155.99470346055912, 430.98914258834174, 483.1333404103558, 245.36827107114883, 218.44729866465303, 390.3620415620637, 513.2773714852943, 373.1692610275377, 368.7417815396779, 379.0473217806454, 225.15144339977493, 378.16140844715466, 387.6233419618325, 373.901945578928, 532.8703289644287, 556.5011568074212, 487.06242044017813, 343.98529384314867, 381.64245593446907, 410.3415007050795, 356.72559487549125, 350.6100529047214, 412.15832372441014, 370.60079111596485, 324.9013330082354, 293.2289257664001, 287.8873307177202, 493.5409713900471, 451.24641228392323, 322.77600838996415, 329.32590843577685, 312.91999007353377, 283.950839552181, 328.99887546714484, 369.7303606940894, 328.58832756895674, 296.297760853553, 238.28394995152127, 264.07332111688413, 322.5998343721697, 270.9860814736413, 317.80368746579643, 295.9340764741927, 293.61456049642976, 228.2206721405169, 312.1541464749673, 329.115542732067, 372.36630059649093, 406.4496276147333, 239.44262320862273, 172.1655920193105, 340.696969005593, 455.9695544304145, 237.00614921137864, 278.93350241625035, 443.1495216577155, 448.7489405661191, 453.26386414141575, 293.4885247372046, 484.71850611599, 534.7904937391196, 443.03823465283267, 458.13351008498995, 355.5471803438854, 185.88097276744048, 237.17993468454208, 373.95778822715255, 176.5986270686445, 230.27911931708005, 408.58174621413815, 340.3981894648924, 302.6958306767935, 256.5563103054783, 460.8500284809344, 515.8949697660653, 312.8374117171642, 212.10825739941527, 452.40634277374227, 415.4570648892557, 379.73414850574454, 462.4348858676639, 420.1215794099759, 397.1555777064811, 425.48246354589276, 240.58831313610426, 129.77610435790595, 333.2592800278375, 321.99653971065754, 404.39035436949774, 391.8118744505992, 333.76072037481157, 358.2735623670934, 484.14025101178333, 269.5465927049476, 309.923445583072, 172.48198957414434, 102.43515267934879]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8726729901175656, "mean_inference_ms": 2.376990841267049, "mean_action_processing_ms": 0.35524797589294665, "mean_env_wait_ms": 0.3127481300993438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665753364562988, "StateBufferConnector_ms": 0.0034189224243164062, "ViewRequirementAgentConnector_ms": 0.14384782314300537}, "num_episodes": 18, "episode_return_max": 2004.521459603488, "episode_return_min": 1076.651816602918, "episode_return_mean": 1684.9437659580071, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.45472828183696, "num_env_steps_trained_throughput_per_sec": 235.45472828183696, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 13903.818, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13903.758, "sample_time_ms": 1990.723, "learn_time_ms": 11892.44, "learn_throughput": 336.348, "synch_weights_time_ms": 18.182}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "8abce_00000", "date": "2024-08-16_11-24-24", "timestamp": 1723787664, "time_this_iter_s": 17.040717840194702, "time_total_s": 176.01761436462402, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43a1ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176.01761436462402, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 81.25, "ram_util_percent": 75.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6621529965804367, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.773838076515803, "policy_loss": -0.004234744232670261, "vf_loss": 9.777039783215397, "vf_explained_var": 0.018905517096241945, "kl": 0.0103302104513628, "entropy": 1.4431057116972705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7438141959527182, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.342983988605479, "policy_loss": -0.007400959304400853, "vf_loss": 9.347948857968447, "vf_explained_var": -0.02110008300927581, "kl": 0.012180542707429048, "entropy": 1.5128482467913753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 2004.521459603488, "episode_reward_min": 1228.4868853335217, "episode_reward_mean": 1690.8769377757449, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 195.80608464036195, "predator_policy": 59.06344444125024}, "policy_reward_max": {"prey_policy": 727.6341418919948, "predator_policy": 571.6035831426153}, "policy_reward_mean": {"prey_policy": 505.98285603834256, "predator_policy": 339.45561284952987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1852.9981615708168, 1744.7746104050166, 1583.4104776697345, 1836.6066558920963, 1919.9113002817037, 1810.3471463731603, 1694.7499813324064, 1549.367485537712, 1821.176446054967, 1590.2834753245106, 1428.3185260219989, 1663.731086249757, 1890.2924228139645, 1737.7960916641887, 1651.4947638251215, 1780.7625301370988, 1588.5682593875767, 1890.523011888713, 1827.981811137286, 1895.6596723548153, 1727.9967122817689, 1907.0050009659394, 1607.5369115530173, 1844.0499879909285, 1247.08776308109, 1939.1571644555322, 1628.1620850049383, 1771.7087027437874, 1683.4515611656159, 1669.5625850066406, 1840.282501103384, 2004.521459603488, 1949.7066345537455, 1676.3197144721269, 1879.390087394257, 1876.934880336688, 1718.3564166402643, 1398.0612574429292, 1914.8160532758138, 1504.4492431787326, 1706.6302556285034, 1794.8533430553823, 1625.6171271891294, 1461.8736616639246, 1717.3038196758196, 1594.1793121720352, 1664.4088217806025, 1791.4909538137747, 1766.733995668956, 1764.2599930742902, 1947.2463964331941, 1460.501776754481, 1961.2899762810953, 1799.0755104412294, 1940.9163285832597, 1947.6919029688927, 1765.8951547753977, 1724.9331152268849, 1530.9823122400053, 1670.3853747282817, 1636.8600538458998, 1883.5821826239007, 1486.2658995897311, 1911.6502200921348, 1946.1627271444813, 1691.4983581180077, 1757.0422045594912, 1419.9435217162927, 1756.3584875655986, 1904.512397441111, 1871.890455707344, 1593.7683452779893, 1275.1680568500567, 1671.7199567043772, 1483.0357814299418, 1685.879059668499, 1853.7175147331536, 1228.4868853335217, 1714.7877044290015, 1436.5357057720616, 1476.3262138662294, 1473.1239675854204, 1640.0891693728017, 1557.6722838742194, 1238.9423489847604, 1270.437261544881, 1865.048732567649, 1966.563576219861, 1315.6144592170915, 1737.878435330016, 1649.7389429747311, 1502.163176514226, 1486.0504682546803, 1892.2272143733458, 1307.7207646159477, 1800.282411968562, 1614.8301826875822, 1389.6698601939609, 1742.4514995939537, 1768.4175189034843], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [481.9929663259685, 449.2407416703212, 568.3112862251783, 502.4454786200608, 537.8126274797858, 412.80719799586666, 394.89848591214104, 420.0590909696199, 468.24500918970574, 456.37446648852756, 402.16555537925353, 459.04181813994745, 487.60114854814447, 458.51616211288837, 570.2580015023854, 502.27335781306, 580.6209797445239, 434.2505860995722, 568.4291682738555, 515.1999305350557, 480.4878907304975, 484.8929093303705, 494.02317737009804, 408.0210924685986, 479.9783789916037, 501.18290686855886, 538.8471109300983, 531.388754756879, 432.62312572201074, 587.0178604618095, 556.7413394599207, 558.4504832897964, 436.650730804486, 627.1466307988545, 336.04455874357143, 456.9687042019476, 482.61353908660897, 544.9519272753523, 578.1848539041317, 548.992088196517, 573.6800686420597, 398.81660727357144, 565.9797349653561, 582.9888482987277, 440.5023964781945, 460.0428430254789, 412.45672119033514, 509.0258401361668, 398.5294102518424, 435.1428280067931, 453.75845896518354, 571.276222491651, 624.4269455117992, 539.9195697573382, 328.50233984177567, 539.5669498546549, 428.36461863497993, 513.1758999634217, 485.9753351369292, 579.3884846892923, 608.9569963525556, 465.540754341842, 568.2994805578411, 529.4497045022911, 406.83179764618643, 499.3112596599584, 481.8847475475693, 468.80721714694164, 468.6786084234768, 643.6443833902113, 560.8552226262557, 553.3112810813018, 532.5026389731869, 490.35165354287915, 372.98246995007, 443.9625310087374, 470.0170434339778, 500.0116261678656, 438.88522027030655, 413.4621060826835, 527.5353198291466, 582.2241061736412, 494.5061754489957, 601.6179314451517, 464.9231040101301, 535.8079347564899, 390.8077812113244, 568.7086093841966, 583.1013984087891, 540.6165054212192, 499.08165083756694, 481.3598973944799, 630.7570781325037, 511.81651101115233, 614.7125249079586, 535.5087396987809, 443.85397497883093, 544.0640924789019, 625.0176359543626, 727.6341418919948, 541.8882448378722, 608.6916281593141, 425.43363669054855, 519.1284884363031, 528.848572679664, 540.5429413775983, 571.1881211134886, 481.13500044912075, 517.3538301648113, 404.0534985633372, 558.6580469702443, 487.8621112608273, 654.9535183843047, 569.5134832797667, 463.3662642393447, 650.4291280758442, 543.9107536597998, 580.1938121944797, 448.4624593235672, 472.94297972568177, 530.246569344967, 547.3613435186622, 421.14433088869947, 485.6928534882005, 554.2110053354579, 407.10922513769265, 559.4308350128443, 484.355977416292, 511.7216019742122, 592.2720907968617, 464.6930772279343, 409.5281237736157, 525.085001011394, 565.8864268661009, 535.928673184215, 420.9794641463336, 514.9947856845912, 514.9768078008528, 594.4579965087414, 584.4818061069609, 531.937634110536, 497.5390082179307, 441.76589275935197, 572.5324142306167, 480.67909659837414, 519.5718179981889, 466.2671344881832, 607.5644675671477, 346.9766052596107, 526.9770364289487, 557.979144335923, 467.7028405587844, 431.59639296636385, 483.35300033524067, 478.7062428516916, 195.80608464036195, 526.4280984957937, 464.58800540725883, 514.5329068026699, 481.03981454042366, 499.50078581644397, 489.9426446493652, 471.8854367710367, 548.0271793622373, 613.5659749819667, 517.1498221956955, 591.3327057711397, 394.20696102701675, 568.1682584755204, 486.11019266004195, 403.572097922223, 525.2178401654256, 475.44233886562176, 497.17008656685107, 563.4857135500797, 589.2560696570778, 455.5094386479557, 555.4133850265159, 668.4993928478161, 521.9631689199974, 553.858087142475, 429.2196391817673, 540.3441850045765, 423.70622771278073, 634.8856141459103, 436.74184947641896, 637.3799644630333, 475.8188347633645, 297.98366814824, 536.1360122086794, 479.60400839460027, 541.9809109496047, 412.5729671101935, 521.6194854240207, 415.308014241703, 454.8276269455901, 579.5464753338358, 529.908465986191, 547.3832350095468, 526.9941871271321], "policy_predator_policy_reward": [510.0090382592955, 411.75541531523135, 295.40053229491576, 378.6173132648637, 261.94183110531407, 370.84882108876803, 480.53252624242197, 541.1165527679141, 544.8915806844134, 450.4002439190574, 522.820179095688, 426.3195937582709, 359.1122134207614, 389.52045725061333, 189.59281195390787, 287.24331426836136, 418.80141614786913, 387.5034640630025, 239.1890350747433, 267.46534144085564, 144.48094437742674, 318.45678158370356, 309.6202137774966, 452.0666026335639, 438.70878844054397, 470.42234851325776, 369.8905230424254, 297.6697029347865, 292.86778161962286, 338.9859960216784, 366.1340980975838, 299.4366092897978, 304.21335399609734, 220.55754378813762, 525.9061658005805, 571.6035831426153, 416.4262348079802, 383.99010996734427, 348.4195861490679, 420.06314410509697, 365.41686702568865, 390.0831693404502, 441.90522375579263, 316.13119394606304, 364.91136255229065, 342.08030949705295, 406.5325306405517, 516.0348960238747, 257.42082136189634, 155.99470346055912, 430.98914258834174, 483.1333404103558, 245.36827107114883, 218.44729866465303, 390.3620415620637, 513.2773714852943, 373.1692610275377, 368.7417815396779, 379.0473217806454, 225.15144339977493, 378.16140844715466, 387.6233419618325, 373.901945578928, 532.8703289644287, 556.5011568074212, 487.06242044017813, 343.98529384314867, 381.64245593446907, 410.3415007050795, 356.72559487549125, 350.6100529047214, 412.15832372441014, 370.60079111596485, 324.9013330082354, 293.2289257664001, 287.8873307177202, 493.5409713900471, 451.24641228392323, 322.77600838996415, 329.32590843577685, 312.91999007353377, 283.950839552181, 328.99887546714484, 369.7303606940894, 328.58832756895674, 296.297760853553, 238.28394995152127, 264.07332111688413, 322.5998343721697, 270.9860814736413, 317.80368746579643, 295.9340764741927, 293.61456049642976, 228.2206721405169, 312.1541464749673, 329.115542732067, 372.36630059649093, 406.4496276147333, 239.44262320862273, 172.1655920193105, 340.696969005593, 455.9695544304145, 237.00614921137864, 278.93350241625035, 443.1495216577155, 448.7489405661191, 453.26386414141575, 293.4885247372046, 484.71850611599, 534.7904937391196, 443.03823465283267, 458.13351008498995, 355.5471803438854, 185.88097276744048, 237.17993468454208, 373.95778822715255, 176.5986270686445, 230.27911931708005, 408.58174621413815, 340.3981894648924, 302.6958306767935, 256.5563103054783, 460.8500284809344, 515.8949697660653, 312.8374117171642, 212.10825739941527, 452.40634277374227, 415.4570648892557, 379.73414850574454, 462.4348858676639, 420.1215794099759, 397.1555777064811, 425.48246354589276, 240.58831313610426, 129.77610435790595, 333.2592800278375, 321.99653971065754, 404.39035436949774, 391.8118744505992, 333.76072037481157, 358.2735623670934, 484.14025101178333, 269.5465927049476, 309.923445583072, 172.48198957414434, 102.43515267934879, 317.98412361319293, 279.90423103585175, 297.3841371487796, 311.6980025926025, 348.35502924217, 311.84204553162016, 460.17347786232506, 478.59464356922535, 228.59063115259886, 325.38392668886996, 356.4667661582779, 367.3048343676714, 200.11887430441985, 240.8441101245473, 223.3836930535295, 263.499090346892, 200.6251423734875, 252.58620907865904, 243.6439826322425, 265.7293895628964, 301.61347075484565, 270.51914632121805, 59.06344444125024, 125.60045340794683, 145.85372736031266, 195.7935960969199, 382.7937554166154, 509.64255171856337, 453.734233364462, 360.0875596482432, 120.37977185044525, 184.3118636921759, 386.9406609229006, 160.4752126393025, 331.76128180390634, 334.89993484658225, 254.51392966741525, 283.598834129454, 109.36546121231662, 305.05754342003473, 375.313758299946, 403.71465684700223, 214.24255520886905, 259.3585290501598, 463.0381219097838, 315.6593707145721, 331.96228742989746, 348.6754427234706, 299.6799654117085, 219.85425359495946, 322.5519960036889, 310.4445622702373, 301.7390063292554, 392.3010904375499]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8781128921555365, "mean_inference_ms": 2.4082591276622063, "mean_action_processing_ms": 0.357712973775446, "mean_env_wait_ms": 0.3156477775908262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008163690567016602, "StateBufferConnector_ms": 0.003827333450317383, "ViewRequirementAgentConnector_ms": 0.15887713432312012}, "num_episodes": 27, "episode_return_max": 2004.521459603488, "episode_return_min": 1228.4868853335217, "episode_return_mean": 1690.8769377757449, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.6248437667664, "num_env_steps_trained_throughput_per_sec": 276.6248437667664, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 14114.517, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14114.457, "sample_time_ms": 2151.316, "learn_time_ms": 11941.951, "learn_throughput": 334.954, "synch_weights_time_ms": 19.244}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "8abce_00000", "date": "2024-08-16_11-24-38", "timestamp": 1723787678, "time_this_iter_s": 14.469182968139648, "time_total_s": 190.48679733276367, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43379d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 190.48679733276367, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 57.1809523809524, "ram_util_percent": 78.86190476190475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4164580065737327, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.791209552906178, "policy_loss": -0.0038004744743741063, "vf_loss": 9.794200253360486, "vf_explained_var": 0.004987341985500679, "kl": 0.008097624337559377, "entropy": 1.457540701621424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4999010464344076, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.709369115476255, "policy_loss": -0.005187251246115439, "vf_loss": 9.712741667126853, "vf_explained_var": -0.0014736796182299417, "kl": 0.00907341606575936, "entropy": 1.5145863588524875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 2004.521459603488, "episode_reward_min": 1228.4868853335217, "episode_reward_mean": 1696.3807478885585, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 195.80608464036195, "predator_policy": 59.06344444125024}, "policy_reward_max": {"prey_policy": 736.0554234518064, "predator_policy": 556.5011568074212}, "policy_reward_mean": {"prey_policy": 509.6903992188849, "predator_policy": 338.4999747253944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1827.981811137286, 1895.6596723548153, 1727.9967122817689, 1907.0050009659394, 1607.5369115530173, 1844.0499879909285, 1247.08776308109, 1939.1571644555322, 1628.1620850049383, 1771.7087027437874, 1683.4515611656159, 1669.5625850066406, 1840.282501103384, 2004.521459603488, 1949.7066345537455, 1676.3197144721269, 1879.390087394257, 1876.934880336688, 1718.3564166402643, 1398.0612574429292, 1914.8160532758138, 1504.4492431787326, 1706.6302556285034, 1794.8533430553823, 1625.6171271891294, 1461.8736616639246, 1717.3038196758196, 1594.1793121720352, 1664.4088217806025, 1791.4909538137747, 1766.733995668956, 1764.2599930742902, 1947.2463964331941, 1460.501776754481, 1961.2899762810953, 1799.0755104412294, 1940.9163285832597, 1947.6919029688927, 1765.8951547753977, 1724.9331152268849, 1530.9823122400053, 1670.3853747282817, 1636.8600538458998, 1883.5821826239007, 1486.2658995897311, 1911.6502200921348, 1946.1627271444813, 1691.4983581180077, 1757.0422045594912, 1419.9435217162927, 1756.3584875655986, 1904.512397441111, 1871.890455707344, 1593.7683452779893, 1275.1680568500567, 1671.7199567043772, 1483.0357814299418, 1685.879059668499, 1853.7175147331536, 1228.4868853335217, 1714.7877044290015, 1436.5357057720616, 1476.3262138662294, 1473.1239675854204, 1640.0891693728017, 1557.6722838742194, 1238.9423489847604, 1270.437261544881, 1865.048732567649, 1966.563576219861, 1315.6144592170915, 1737.878435330016, 1649.7389429747311, 1502.163176514226, 1486.0504682546803, 1892.2272143733458, 1307.7207646159477, 1800.282411968562, 1614.8301826875822, 1389.6698601939609, 1742.4514995939537, 1768.4175189034843, 1874.3381206134527, 1725.9955445265684, 1618.6939166969332, 1728.4085661183024, 2003.0547046984589, 1750.4240386638933, 1733.8200491595398, 1532.5116072929409, 1780.9356952925089, 1810.7539411798712, 1910.4270598941387, 1775.9729689931441, 1655.0013971737264, 1818.0012689950263, 1680.0454805329985, 1870.4955310500009, 1509.991908547189, 1806.6216442832358], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [482.61353908660897, 544.9519272753523, 578.1848539041317, 548.992088196517, 573.6800686420597, 398.81660727357144, 565.9797349653561, 582.9888482987277, 440.5023964781945, 460.0428430254789, 412.45672119033514, 509.0258401361668, 398.5294102518424, 435.1428280067931, 453.75845896518354, 571.276222491651, 624.4269455117992, 539.9195697573382, 328.50233984177567, 539.5669498546549, 428.36461863497993, 513.1758999634217, 485.9753351369292, 579.3884846892923, 608.9569963525556, 465.540754341842, 568.2994805578411, 529.4497045022911, 406.83179764618643, 499.3112596599584, 481.8847475475693, 468.80721714694164, 468.6786084234768, 643.6443833902113, 560.8552226262557, 553.3112810813018, 532.5026389731869, 490.35165354287915, 372.98246995007, 443.9625310087374, 470.0170434339778, 500.0116261678656, 438.88522027030655, 413.4621060826835, 527.5353198291466, 582.2241061736412, 494.5061754489957, 601.6179314451517, 464.9231040101301, 535.8079347564899, 390.8077812113244, 568.7086093841966, 583.1013984087891, 540.6165054212192, 499.08165083756694, 481.3598973944799, 630.7570781325037, 511.81651101115233, 614.7125249079586, 535.5087396987809, 443.85397497883093, 544.0640924789019, 625.0176359543626, 727.6341418919948, 541.8882448378722, 608.6916281593141, 425.43363669054855, 519.1284884363031, 528.848572679664, 540.5429413775983, 571.1881211134886, 481.13500044912075, 517.3538301648113, 404.0534985633372, 558.6580469702443, 487.8621112608273, 654.9535183843047, 569.5134832797667, 463.3662642393447, 650.4291280758442, 543.9107536597998, 580.1938121944797, 448.4624593235672, 472.94297972568177, 530.246569344967, 547.3613435186622, 421.14433088869947, 485.6928534882005, 554.2110053354579, 407.10922513769265, 559.4308350128443, 484.355977416292, 511.7216019742122, 592.2720907968617, 464.6930772279343, 409.5281237736157, 525.085001011394, 565.8864268661009, 535.928673184215, 420.9794641463336, 514.9947856845912, 514.9768078008528, 594.4579965087414, 584.4818061069609, 531.937634110536, 497.5390082179307, 441.76589275935197, 572.5324142306167, 480.67909659837414, 519.5718179981889, 466.2671344881832, 607.5644675671477, 346.9766052596107, 526.9770364289487, 557.979144335923, 467.7028405587844, 431.59639296636385, 483.35300033524067, 478.7062428516916, 195.80608464036195, 526.4280984957937, 464.58800540725883, 514.5329068026699, 481.03981454042366, 499.50078581644397, 489.9426446493652, 471.8854367710367, 548.0271793622373, 613.5659749819667, 517.1498221956955, 591.3327057711397, 394.20696102701675, 568.1682584755204, 486.11019266004195, 403.572097922223, 525.2178401654256, 475.44233886562176, 497.17008656685107, 563.4857135500797, 589.2560696570778, 455.5094386479557, 555.4133850265159, 668.4993928478161, 521.9631689199974, 553.858087142475, 429.2196391817673, 540.3441850045765, 423.70622771278073, 634.8856141459103, 436.74184947641896, 637.3799644630333, 475.8188347633645, 297.98366814824, 536.1360122086794, 479.60400839460027, 541.9809109496047, 412.5729671101935, 521.6194854240207, 415.308014241703, 454.8276269455901, 579.5464753338358, 529.908465986191, 547.3832350095468, 526.9941871271321, 516.4871575476482, 523.1468875831058, 371.5072493797375, 461.2432702812701, 454.9035415919542, 588.4074808614052, 530.1665857766665, 587.6150989704032, 636.188664749625, 478.2421886879522, 426.5811543286153, 496.14098756728885, 467.4744523011311, 588.6909438950365, 394.39710876899204, 498.50735013100694, 541.2076933806453, 581.3317857492929, 561.8691636297524, 425.2297160316944, 521.947689136583, 553.1085135770427, 550.9733603045261, 615.6478412322555, 449.95597880474804, 447.0520487988753, 504.10072409451647, 451.71836639190406, 429.73701190446405, 508.58982526977616, 736.0554234518064, 507.520874098069, 320.41837754058963, 536.8588638723922, 496.89560741095875, 562.5993629616853], "policy_predator_policy_reward": [416.4262348079802, 383.99010996734427, 348.4195861490679, 420.06314410509697, 365.41686702568865, 390.0831693404502, 441.90522375579263, 316.13119394606304, 364.91136255229065, 342.08030949705295, 406.5325306405517, 516.0348960238747, 257.42082136189634, 155.99470346055912, 430.98914258834174, 483.1333404103558, 245.36827107114883, 218.44729866465303, 390.3620415620637, 513.2773714852943, 373.1692610275377, 368.7417815396779, 379.0473217806454, 225.15144339977493, 378.16140844715466, 387.6233419618325, 373.901945578928, 532.8703289644287, 556.5011568074212, 487.06242044017813, 343.98529384314867, 381.64245593446907, 410.3415007050795, 356.72559487549125, 350.6100529047214, 412.15832372441014, 370.60079111596485, 324.9013330082354, 293.2289257664001, 287.8873307177202, 493.5409713900471, 451.24641228392323, 322.77600838996415, 329.32590843577685, 312.91999007353377, 283.950839552181, 328.99887546714484, 369.7303606940894, 328.58832756895674, 296.297760853553, 238.28394995152127, 264.07332111688413, 322.5998343721697, 270.9860814736413, 317.80368746579643, 295.9340764741927, 293.61456049642976, 228.2206721405169, 312.1541464749673, 329.115542732067, 372.36630059649093, 406.4496276147333, 239.44262320862273, 172.1655920193105, 340.696969005593, 455.9695544304145, 237.00614921137864, 278.93350241625035, 443.1495216577155, 448.7489405661191, 453.26386414141575, 293.4885247372046, 484.71850611599, 534.7904937391196, 443.03823465283267, 458.13351008498995, 355.5471803438854, 185.88097276744048, 237.17993468454208, 373.95778822715255, 176.5986270686445, 230.27911931708005, 408.58174621413815, 340.3981894648924, 302.6958306767935, 256.5563103054783, 460.8500284809344, 515.8949697660653, 312.8374117171642, 212.10825739941527, 452.40634277374227, 415.4570648892557, 379.73414850574454, 462.4348858676639, 420.1215794099759, 397.1555777064811, 425.48246354589276, 240.58831313610426, 129.77610435790595, 333.2592800278375, 321.99653971065754, 404.39035436949774, 391.8118744505992, 333.76072037481157, 358.2735623670934, 484.14025101178333, 269.5465927049476, 309.923445583072, 172.48198957414434, 102.43515267934879, 317.98412361319293, 279.90423103585175, 297.3841371487796, 311.6980025926025, 348.35502924217, 311.84204553162016, 460.17347786232506, 478.59464356922535, 228.59063115259886, 325.38392668886996, 356.4667661582779, 367.3048343676714, 200.11887430441985, 240.8441101245473, 223.3836930535295, 263.499090346892, 200.6251423734875, 252.58620907865904, 243.6439826322425, 265.7293895628964, 301.61347075484565, 270.51914632121805, 59.06344444125024, 125.60045340794683, 145.85372736031266, 195.7935960969199, 382.7937554166154, 509.64255171856337, 453.734233364462, 360.0875596482432, 120.37977185044525, 184.3118636921759, 386.9406609229006, 160.4752126393025, 331.76128180390634, 334.89993484658225, 254.51392966741525, 283.598834129454, 109.36546121231662, 305.05754342003473, 375.313758299946, 403.71465684700223, 214.24255520886905, 259.3585290501598, 463.0381219097838, 315.6593707145721, 331.96228742989746, 348.6754427234706, 299.6799654117085, 219.85425359495946, 322.5519960036889, 310.4445622702373, 301.7390063292554, 392.3010904375499, 397.24933824403837, 437.45473723865945, 436.6224683971793, 456.62255646838213, 186.83678903795317, 388.5461052056193, 340.6367899407888, 269.9900914304443, 420.2896800023554, 468.3341712585255, 467.3759527650696, 360.32594400291924, 291.7077320805663, 385.9469208828087, 245.53889405388975, 394.068254339052, 246.4962662098003, 411.8999499527691, 396.3400996350352, 427.31496188338997, 459.37188296188754, 375.99897421862653, 230.43719063371265, 378.9145768226492, 328.58027374223514, 429.4130958278655, 449.2145810104778, 412.9675974981305, 460.5156256979293, 281.20301766082787, 321.96237192711305, 304.95686157301236, 318.07549049159593, 334.6391766426106, 365.1549908897208, 381.9716830208707]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.879861741488309, "mean_inference_ms": 2.429411854257937, "mean_action_processing_ms": 0.3578706225268167, "mean_env_wait_ms": 0.31563147193292534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008166790008544922, "StateBufferConnector_ms": 0.003867030143737793, "ViewRequirementAgentConnector_ms": 0.15854179859161377}, "num_episodes": 18, "episode_return_max": 2004.521459603488, "episode_return_min": 1228.4868853335217, "episode_return_mean": 1696.3807478885585, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.9787842393927, "num_env_steps_trained_throughput_per_sec": 320.9787842393927, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 13780.946, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13780.887, "sample_time_ms": 2174.707, "learn_time_ms": 11586.881, "learn_throughput": 345.218, "synch_weights_time_ms": 17.575}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "8abce_00000", "date": "2024-08-16_11-24-51", "timestamp": 1723787691, "time_this_iter_s": 12.467162132263184, "time_total_s": 202.95395946502686, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4337280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 202.95395946502686, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 47.594444444444456, "ram_util_percent": 71.71111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4007876001810902, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.817096918600576, "policy_loss": -0.0003195170155435643, "vf_loss": 9.815884093128185, "vf_explained_var": -0.020990673700968424, "kl": 0.015323134511920954, "entropy": 1.4558663104577039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.573657911085578, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.633128577943832, "policy_loss": -0.005769820180450561, "vf_loss": 9.637288691000963, "vf_explained_var": -0.005968718522440189, "kl": 0.008048560330949821, "entropy": 1.486464902080556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 2003.0547046984589, "episode_reward_min": 1189.0773711497825, "episode_reward_mean": 1678.0554790534172, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 195.80608464036195, "predator_policy": 59.06344444125024}, "policy_reward_max": {"prey_policy": 748.0777542176662, "predator_policy": 534.7904937391196}, "policy_reward_mean": {"prey_policy": 508.32556325349316, "predator_policy": 330.7021762732155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1718.3564166402643, 1398.0612574429292, 1914.8160532758138, 1504.4492431787326, 1706.6302556285034, 1794.8533430553823, 1625.6171271891294, 1461.8736616639246, 1717.3038196758196, 1594.1793121720352, 1664.4088217806025, 1791.4909538137747, 1766.733995668956, 1764.2599930742902, 1947.2463964331941, 1460.501776754481, 1961.2899762810953, 1799.0755104412294, 1940.9163285832597, 1947.6919029688927, 1765.8951547753977, 1724.9331152268849, 1530.9823122400053, 1670.3853747282817, 1636.8600538458998, 1883.5821826239007, 1486.2658995897311, 1911.6502200921348, 1946.1627271444813, 1691.4983581180077, 1757.0422045594912, 1419.9435217162927, 1756.3584875655986, 1904.512397441111, 1871.890455707344, 1593.7683452779893, 1275.1680568500567, 1671.7199567043772, 1483.0357814299418, 1685.879059668499, 1853.7175147331536, 1228.4868853335217, 1714.7877044290015, 1436.5357057720616, 1476.3262138662294, 1473.1239675854204, 1640.0891693728017, 1557.6722838742194, 1238.9423489847604, 1270.437261544881, 1865.048732567649, 1966.563576219861, 1315.6144592170915, 1737.878435330016, 1649.7389429747311, 1502.163176514226, 1486.0504682546803, 1892.2272143733458, 1307.7207646159477, 1800.282411968562, 1614.8301826875822, 1389.6698601939609, 1742.4514995939537, 1768.4175189034843, 1874.3381206134527, 1725.9955445265684, 1618.6939166969332, 1728.4085661183024, 2003.0547046984589, 1750.4240386638933, 1733.8200491595398, 1532.5116072929409, 1780.9356952925089, 1810.7539411798712, 1910.4270598941387, 1775.9729689931441, 1655.0013971737264, 1818.0012689950263, 1680.0454805329985, 1870.4955310500009, 1509.991908547189, 1806.6216442832358, 1273.6846282350398, 1536.877052719687, 1808.0838954802014, 1697.7316109065307, 1540.6246218060633, 1546.4423452022352, 1658.7535541704747, 1741.594729050505, 1996.5490991538047, 1189.0773711497825, 1728.8862349757958, 1846.032921024098, 1800.0653097057998, 1759.5318261196537, 1901.8789677911516, 1505.2277253521609, 1694.706139090697, 1918.2403197572394], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [532.5026389731869, 490.35165354287915, 372.98246995007, 443.9625310087374, 470.0170434339778, 500.0116261678656, 438.88522027030655, 413.4621060826835, 527.5353198291466, 582.2241061736412, 494.5061754489957, 601.6179314451517, 464.9231040101301, 535.8079347564899, 390.8077812113244, 568.7086093841966, 583.1013984087891, 540.6165054212192, 499.08165083756694, 481.3598973944799, 630.7570781325037, 511.81651101115233, 614.7125249079586, 535.5087396987809, 443.85397497883093, 544.0640924789019, 625.0176359543626, 727.6341418919948, 541.8882448378722, 608.6916281593141, 425.43363669054855, 519.1284884363031, 528.848572679664, 540.5429413775983, 571.1881211134886, 481.13500044912075, 517.3538301648113, 404.0534985633372, 558.6580469702443, 487.8621112608273, 654.9535183843047, 569.5134832797667, 463.3662642393447, 650.4291280758442, 543.9107536597998, 580.1938121944797, 448.4624593235672, 472.94297972568177, 530.246569344967, 547.3613435186622, 421.14433088869947, 485.6928534882005, 554.2110053354579, 407.10922513769265, 559.4308350128443, 484.355977416292, 511.7216019742122, 592.2720907968617, 464.6930772279343, 409.5281237736157, 525.085001011394, 565.8864268661009, 535.928673184215, 420.9794641463336, 514.9947856845912, 514.9768078008528, 594.4579965087414, 584.4818061069609, 531.937634110536, 497.5390082179307, 441.76589275935197, 572.5324142306167, 480.67909659837414, 519.5718179981889, 466.2671344881832, 607.5644675671477, 346.9766052596107, 526.9770364289487, 557.979144335923, 467.7028405587844, 431.59639296636385, 483.35300033524067, 478.7062428516916, 195.80608464036195, 526.4280984957937, 464.58800540725883, 514.5329068026699, 481.03981454042366, 499.50078581644397, 489.9426446493652, 471.8854367710367, 548.0271793622373, 613.5659749819667, 517.1498221956955, 591.3327057711397, 394.20696102701675, 568.1682584755204, 486.11019266004195, 403.572097922223, 525.2178401654256, 475.44233886562176, 497.17008656685107, 563.4857135500797, 589.2560696570778, 455.5094386479557, 555.4133850265159, 668.4993928478161, 521.9631689199974, 553.858087142475, 429.2196391817673, 540.3441850045765, 423.70622771278073, 634.8856141459103, 436.74184947641896, 637.3799644630333, 475.8188347633645, 297.98366814824, 536.1360122086794, 479.60400839460027, 541.9809109496047, 412.5729671101935, 521.6194854240207, 415.308014241703, 454.8276269455901, 579.5464753338358, 529.908465986191, 547.3832350095468, 526.9941871271321, 516.4871575476482, 523.1468875831058, 371.5072493797375, 461.2432702812701, 454.9035415919542, 588.4074808614052, 530.1665857766665, 587.6150989704032, 636.188664749625, 478.2421886879522, 426.5811543286153, 496.14098756728885, 467.4744523011311, 588.6909438950365, 394.39710876899204, 498.50735013100694, 541.2076933806453, 581.3317857492929, 561.8691636297524, 425.2297160316944, 521.947689136583, 553.1085135770427, 550.9733603045261, 615.6478412322555, 449.95597880474804, 447.0520487988753, 504.10072409451647, 451.71836639190406, 429.73701190446405, 508.58982526977616, 736.0554234518064, 507.520874098069, 320.41837754058963, 536.8588638723922, 496.89560741095875, 562.5993629616853, 366.3806781422078, 469.9916355909585, 409.61243383792794, 592.9969056342479, 365.18974475762667, 417.0334462489246, 547.7487343556801, 490.2164967534999, 553.072167782312, 423.6234498693471, 441.16509581367944, 400.5590838849592, 445.55918687731423, 461.59591489087376, 405.5375599072169, 503.73849470530166, 659.9157534612685, 524.941672138508, 423.79883371105177, 424.7783332010121, 654.094868039976, 550.8010019762306, 536.0833430953131, 517.0219243539046, 449.56290845150573, 605.9890194681316, 586.4125579233358, 508.3835532040361, 536.8314199895747, 492.54720124432987, 465.89154229958035, 565.8701301947577, 495.3916029581208, 491.33086245487084, 748.0777542176662, 447.1214803409885], "policy_predator_policy_reward": [370.60079111596485, 324.9013330082354, 293.2289257664001, 287.8873307177202, 493.5409713900471, 451.24641228392323, 322.77600838996415, 329.32590843577685, 312.91999007353377, 283.950839552181, 328.99887546714484, 369.7303606940894, 328.58832756895674, 296.297760853553, 238.28394995152127, 264.07332111688413, 322.5998343721697, 270.9860814736413, 317.80368746579643, 295.9340764741927, 293.61456049642976, 228.2206721405169, 312.1541464749673, 329.115542732067, 372.36630059649093, 406.4496276147333, 239.44262320862273, 172.1655920193105, 340.696969005593, 455.9695544304145, 237.00614921137864, 278.93350241625035, 443.1495216577155, 448.7489405661191, 453.26386414141575, 293.4885247372046, 484.71850611599, 534.7904937391196, 443.03823465283267, 458.13351008498995, 355.5471803438854, 185.88097276744048, 237.17993468454208, 373.95778822715255, 176.5986270686445, 230.27911931708005, 408.58174621413815, 340.3981894648924, 302.6958306767935, 256.5563103054783, 460.8500284809344, 515.8949697660653, 312.8374117171642, 212.10825739941527, 452.40634277374227, 415.4570648892557, 379.73414850574454, 462.4348858676639, 420.1215794099759, 397.1555777064811, 425.48246354589276, 240.58831313610426, 129.77610435790595, 333.2592800278375, 321.99653971065754, 404.39035436949774, 391.8118744505992, 333.76072037481157, 358.2735623670934, 484.14025101178333, 269.5465927049476, 309.923445583072, 172.48198957414434, 102.43515267934879, 317.98412361319293, 279.90423103585175, 297.3841371487796, 311.6980025926025, 348.35502924217, 311.84204553162016, 460.17347786232506, 478.59464356922535, 228.59063115259886, 325.38392668886996, 356.4667661582779, 367.3048343676714, 200.11887430441985, 240.8441101245473, 223.3836930535295, 263.499090346892, 200.6251423734875, 252.58620907865904, 243.6439826322425, 265.7293895628964, 301.61347075484565, 270.51914632121805, 59.06344444125024, 125.60045340794683, 145.85372736031266, 195.7935960969199, 382.7937554166154, 509.64255171856337, 453.734233364462, 360.0875596482432, 120.37977185044525, 184.3118636921759, 386.9406609229006, 160.4752126393025, 331.76128180390634, 334.89993484658225, 254.51392966741525, 283.598834129454, 109.36546121231662, 305.05754342003473, 375.313758299946, 403.71465684700223, 214.24255520886905, 259.3585290501598, 463.0381219097838, 315.6593707145721, 331.96228742989746, 348.6754427234706, 299.6799654117085, 219.85425359495946, 322.5519960036889, 310.4445622702373, 301.7390063292554, 392.3010904375499, 397.24933824403837, 437.45473723865945, 436.6224683971793, 456.62255646838213, 186.83678903795317, 388.5461052056193, 340.6367899407888, 269.9900914304443, 420.2896800023554, 468.3341712585255, 467.3759527650696, 360.32594400291924, 291.7077320805663, 385.9469208828087, 245.53889405388975, 394.068254339052, 246.4962662098003, 411.8999499527691, 396.3400996350352, 427.31496188338997, 459.37188296188754, 375.99897421862653, 230.43719063371265, 378.9145768226492, 328.58027374223514, 429.4130958278655, 449.2145810104778, 412.9675974981305, 460.5156256979293, 281.20301766082787, 321.96237192711305, 304.95686157301236, 318.07549049159593, 334.6391766426106, 365.1549908897208, 381.9716830208707, 225.02569715736126, 212.28661734451236, 256.9839580476775, 277.2837551998341, 505.4355150984035, 520.4251893752471, 251.65106584114184, 408.1153139562093, 304.3802808584149, 259.5487232959888, 400.3342286440853, 304.38393685951013, 398.2199650110206, 353.37848739126576, 394.71243151801616, 437.60624291996993, 341.4308339472835, 470.2608396067443, 137.0008658022259, 203.4993384354924, 177.7574090075462, 346.232955952042, 462.87329621684984, 330.05435735803, 491.98684441226925, 252.52653737389397, 326.3793948027617, 338.3563201895207, 454.77564868345985, 417.7246978737871, 235.14893320742954, 238.31711965039213, 428.06847264430263, 279.9152010334025, 381.81239306856963, 341.2286921300156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8716602538973671, "mean_inference_ms": 2.43101812250484, "mean_action_processing_ms": 0.35556142677733765, "mean_env_wait_ms": 0.31433229835784915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004819750785827637, "StateBufferConnector_ms": 0.0037480592727661133, "ViewRequirementAgentConnector_ms": 0.13500308990478516}, "num_episodes": 18, "episode_return_max": 2003.0547046984589, "episode_return_min": 1189.0773711497825, "episode_return_mean": 1678.0554790534172, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.78156213624754, "num_env_steps_trained_throughput_per_sec": 297.78156213624754, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 13396.4, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13396.35, "sample_time_ms": 1781.524, "learn_time_ms": 11595.464, "learn_throughput": 344.962, "synch_weights_time_ms": 17.756}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "8abce_00000", "date": "2024-08-16_11-25-04", "timestamp": 1723787704, "time_this_iter_s": 13.440558195114136, "time_total_s": 216.394517660141, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 216.394517660141, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 54.278947368421065, "ram_util_percent": 72.79473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5428470994744983, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.748096139594992, "policy_loss": -0.004681640859846045, "vf_loss": 9.75164718426094, "vf_explained_var": -0.03326940331509504, "kl": 0.011305909983476489, "entropy": 1.4664806671874233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5425994431530987, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.595202609470912, "policy_loss": -0.00955060439827364, "vf_loss": 9.601899118272085, "vf_explained_var": -0.012108297543550925, "kl": 0.014270397578761012, "entropy": 1.4522714648297224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 2003.0547046984589, "episode_reward_min": 1146.364713665203, "episode_reward_mean": 1652.9552389553894, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 195.80608464036195, "predator_policy": 59.06344444125024}, "policy_reward_max": {"prey_policy": 748.0777542176662, "predator_policy": 577.7479061811567}, "policy_reward_mean": {"prey_policy": 503.0370714048297, "predator_policy": 323.4405480728649}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1940.9163285832597, 1947.6919029688927, 1765.8951547753977, 1724.9331152268849, 1530.9823122400053, 1670.3853747282817, 1636.8600538458998, 1883.5821826239007, 1486.2658995897311, 1911.6502200921348, 1946.1627271444813, 1691.4983581180077, 1757.0422045594912, 1419.9435217162927, 1756.3584875655986, 1904.512397441111, 1871.890455707344, 1593.7683452779893, 1275.1680568500567, 1671.7199567043772, 1483.0357814299418, 1685.879059668499, 1853.7175147331536, 1228.4868853335217, 1714.7877044290015, 1436.5357057720616, 1476.3262138662294, 1473.1239675854204, 1640.0891693728017, 1557.6722838742194, 1238.9423489847604, 1270.437261544881, 1865.048732567649, 1966.563576219861, 1315.6144592170915, 1737.878435330016, 1649.7389429747311, 1502.163176514226, 1486.0504682546803, 1892.2272143733458, 1307.7207646159477, 1800.282411968562, 1614.8301826875822, 1389.6698601939609, 1742.4514995939537, 1768.4175189034843, 1874.3381206134527, 1725.9955445265684, 1618.6939166969332, 1728.4085661183024, 2003.0547046984589, 1750.4240386638933, 1733.8200491595398, 1532.5116072929409, 1780.9356952925089, 1810.7539411798712, 1910.4270598941387, 1775.9729689931441, 1655.0013971737264, 1818.0012689950263, 1680.0454805329985, 1870.4955310500009, 1509.991908547189, 1806.6216442832358, 1273.6846282350398, 1536.877052719687, 1808.0838954802014, 1697.7316109065307, 1540.6246218060633, 1546.4423452022352, 1658.7535541704747, 1741.594729050505, 1996.5490991538047, 1189.0773711497825, 1728.8862349757958, 1846.032921024098, 1800.0653097057998, 1759.5318261196537, 1901.8789677911516, 1505.2277253521609, 1694.706139090697, 1918.2403197572394, 1306.3167434485981, 1579.7314076118182, 1915.2215030236123, 1677.5398306192642, 1849.9566772173987, 1446.189346530799, 1762.8981849165389, 1146.364713665203, 1539.5956076010534, 1528.1652314830565, 1684.1260030451851, 1756.635804048191, 1795.9221892196222, 1280.9292176331587, 1595.4920665673333, 1589.5004620537413, 1405.7517067244328, 1220.7872089583475], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [517.3538301648113, 404.0534985633372, 558.6580469702443, 487.8621112608273, 654.9535183843047, 569.5134832797667, 463.3662642393447, 650.4291280758442, 543.9107536597998, 580.1938121944797, 448.4624593235672, 472.94297972568177, 530.246569344967, 547.3613435186622, 421.14433088869947, 485.6928534882005, 554.2110053354579, 407.10922513769265, 559.4308350128443, 484.355977416292, 511.7216019742122, 592.2720907968617, 464.6930772279343, 409.5281237736157, 525.085001011394, 565.8864268661009, 535.928673184215, 420.9794641463336, 514.9947856845912, 514.9768078008528, 594.4579965087414, 584.4818061069609, 531.937634110536, 497.5390082179307, 441.76589275935197, 572.5324142306167, 480.67909659837414, 519.5718179981889, 466.2671344881832, 607.5644675671477, 346.9766052596107, 526.9770364289487, 557.979144335923, 467.7028405587844, 431.59639296636385, 483.35300033524067, 478.7062428516916, 195.80608464036195, 526.4280984957937, 464.58800540725883, 514.5329068026699, 481.03981454042366, 499.50078581644397, 489.9426446493652, 471.8854367710367, 548.0271793622373, 613.5659749819667, 517.1498221956955, 591.3327057711397, 394.20696102701675, 568.1682584755204, 486.11019266004195, 403.572097922223, 525.2178401654256, 475.44233886562176, 497.17008656685107, 563.4857135500797, 589.2560696570778, 455.5094386479557, 555.4133850265159, 668.4993928478161, 521.9631689199974, 553.858087142475, 429.2196391817673, 540.3441850045765, 423.70622771278073, 634.8856141459103, 436.74184947641896, 637.3799644630333, 475.8188347633645, 297.98366814824, 536.1360122086794, 479.60400839460027, 541.9809109496047, 412.5729671101935, 521.6194854240207, 415.308014241703, 454.8276269455901, 579.5464753338358, 529.908465986191, 547.3832350095468, 526.9941871271321, 516.4871575476482, 523.1468875831058, 371.5072493797375, 461.2432702812701, 454.9035415919542, 588.4074808614052, 530.1665857766665, 587.6150989704032, 636.188664749625, 478.2421886879522, 426.5811543286153, 496.14098756728885, 467.4744523011311, 588.6909438950365, 394.39710876899204, 498.50735013100694, 541.2076933806453, 581.3317857492929, 561.8691636297524, 425.2297160316944, 521.947689136583, 553.1085135770427, 550.9733603045261, 615.6478412322555, 449.95597880474804, 447.0520487988753, 504.10072409451647, 451.71836639190406, 429.73701190446405, 508.58982526977616, 736.0554234518064, 507.520874098069, 320.41837754058963, 536.8588638723922, 496.89560741095875, 562.5993629616853, 366.3806781422078, 469.9916355909585, 409.61243383792794, 592.9969056342479, 365.18974475762667, 417.0334462489246, 547.7487343556801, 490.2164967534999, 553.072167782312, 423.6234498693471, 441.16509581367944, 400.5590838849592, 445.55918687731423, 461.59591489087376, 405.5375599072169, 503.73849470530166, 659.9157534612685, 524.941672138508, 423.79883371105177, 424.7783332010121, 654.094868039976, 550.8010019762306, 536.0833430953131, 517.0219243539046, 449.56290845150573, 605.9890194681316, 586.4125579233358, 508.3835532040361, 536.8314199895747, 492.54720124432987, 465.89154229958035, 565.8701301947577, 495.3916029581208, 491.33086245487084, 748.0777542176662, 447.1214803409885, 532.6657486817192, 440.43727092988814, 534.1672081439953, 511.6487697029283, 501.13834582071644, 446.7155319328165, 526.5681342704011, 475.2706734592542, 454.8280058958903, 514.2145321222068, 543.6327269828845, 476.8184998816288, 490.21273500507, 481.25242191020305, 463.416155928362, 375.95860108863855, 520.2199125439491, 535.6434028240351, 610.526247595923, 625.5624876442589, 487.0870772397529, 461.87401039253797, 532.312762754101, 562.7111615460432, 482.88944012058613, 646.1976588251978, 458.07063027465125, 470.6355790115096, 519.3240358253677, 407.0040906482656, 461.9509278251555, 362.77742208801914, 376.1741307622365, 553.9584705675867, 465.2153272996127, 415.90852927115117], "policy_predator_policy_reward": [484.71850611599, 534.7904937391196, 443.03823465283267, 458.13351008498995, 355.5471803438854, 185.88097276744048, 237.17993468454208, 373.95778822715255, 176.5986270686445, 230.27911931708005, 408.58174621413815, 340.3981894648924, 302.6958306767935, 256.5563103054783, 460.8500284809344, 515.8949697660653, 312.8374117171642, 212.10825739941527, 452.40634277374227, 415.4570648892557, 379.73414850574454, 462.4348858676639, 420.1215794099759, 397.1555777064811, 425.48246354589276, 240.58831313610426, 129.77610435790595, 333.2592800278375, 321.99653971065754, 404.39035436949774, 391.8118744505992, 333.76072037481157, 358.2735623670934, 484.14025101178333, 269.5465927049476, 309.923445583072, 172.48198957414434, 102.43515267934879, 317.98412361319293, 279.90423103585175, 297.3841371487796, 311.6980025926025, 348.35502924217, 311.84204553162016, 460.17347786232506, 478.59464356922535, 228.59063115259886, 325.38392668886996, 356.4667661582779, 367.3048343676714, 200.11887430441985, 240.8441101245473, 223.3836930535295, 263.499090346892, 200.6251423734875, 252.58620907865904, 243.6439826322425, 265.7293895628964, 301.61347075484565, 270.51914632121805, 59.06344444125024, 125.60045340794683, 145.85372736031266, 195.7935960969199, 382.7937554166154, 509.64255171856337, 453.734233364462, 360.0875596482432, 120.37977185044525, 184.3118636921759, 386.9406609229006, 160.4752126393025, 331.76128180390634, 334.89993484658225, 254.51392966741525, 283.598834129454, 109.36546121231662, 305.05754342003473, 375.313758299946, 403.71465684700223, 214.24255520886905, 259.3585290501598, 463.0381219097838, 315.6593707145721, 331.96228742989746, 348.6754427234706, 299.6799654117085, 219.85425359495946, 322.5519960036889, 310.4445622702373, 301.7390063292554, 392.3010904375499, 397.24933824403837, 437.45473723865945, 436.6224683971793, 456.62255646838213, 186.83678903795317, 388.5461052056193, 340.6367899407888, 269.9900914304443, 420.2896800023554, 468.3341712585255, 467.3759527650696, 360.32594400291924, 291.7077320805663, 385.9469208828087, 245.53889405388975, 394.068254339052, 246.4962662098003, 411.8999499527691, 396.3400996350352, 427.31496188338997, 459.37188296188754, 375.99897421862653, 230.43719063371265, 378.9145768226492, 328.58027374223514, 429.4130958278655, 449.2145810104778, 412.9675974981305, 460.5156256979293, 281.20301766082787, 321.96237192711305, 304.95686157301236, 318.07549049159593, 334.6391766426106, 365.1549908897208, 381.9716830208707, 225.02569715736126, 212.28661734451236, 256.9839580476775, 277.2837551998341, 505.4355150984035, 520.4251893752471, 251.65106584114184, 408.1153139562093, 304.3802808584149, 259.5487232959888, 400.3342286440853, 304.38393685951013, 398.2199650110206, 353.37848739126576, 394.71243151801616, 437.60624291996993, 341.4308339472835, 470.2608396067443, 137.0008658022259, 203.4993384354924, 177.7574090075462, 346.232955952042, 462.87329621684984, 330.05435735803, 491.98684441226925, 252.52653737389397, 326.3793948027617, 338.3563201895207, 454.77564868345985, 417.7246978737871, 235.14893320742954, 238.31711965039213, 428.06847264430263, 279.9152010334025, 381.81239306856963, 341.2286921300156, 203.82718707258323, 129.386536764408, 296.06257786981746, 237.8528518950767, 389.61971908892394, 577.7479061811567, 316.35230128730564, 359.3487216023019, 498.63687583026757, 382.2772633690322, 230.18941130149355, 195.5487083647916, 402.0240146158511, 389.40901338541505, 159.8588117034069, 147.13114494479606, 101.12148774108205, 382.61080449198755, 181.10551962813616, 110.970976614737, 300.7155967972282, 434.4493186156657, 365.62107035735795, 295.9908093906878, 321.04925700941294, 345.785833264425, 102.31403455464742, 249.9089737923503, 372.165144001003, 296.9987960926973, 461.2164440344276, 303.5556681061381, 276.65668476001656, 198.96242063459212, 178.44640474887424, 161.216947638709]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.864970753524073, "mean_inference_ms": 2.433834763124918, "mean_action_processing_ms": 0.3537527864403343, "mean_env_wait_ms": 0.31321112104655713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052100419998168945, "StateBufferConnector_ms": 0.003772735595703125, "ViewRequirementAgentConnector_ms": 0.13376367092132568}, "num_episodes": 18, "episode_return_max": 2003.0547046984589, "episode_return_min": 1146.364713665203, "episode_return_mean": 1652.9552389553894, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.24327026035303, "num_env_steps_trained_throughput_per_sec": 297.24327026035303, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 13534.51, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13534.464, "sample_time_ms": 1825.795, "learn_time_ms": 11688.932, "learn_throughput": 342.204, "synch_weights_time_ms": 18.084}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "8abce_00000", "date": "2024-08-16_11-25-18", "timestamp": 1723787718, "time_this_iter_s": 13.462870121002197, "time_total_s": 229.8573877811432, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 229.8573877811432, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 53.30526315789473, "ram_util_percent": 73.07894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4582509802132058, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.781567972173136, "policy_loss": -0.0036007103039612056, "vf_loss": 9.784243158814768, "vf_explained_var": -0.03309948034387417, "kl": 0.009255154664274342, "entropy": 1.4890456091159234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5900534644644095, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.545179705140452, "policy_loss": -0.003982698521700013, "vf_loss": 9.547244965084015, "vf_explained_var": -0.011643073136213595, "kl": 0.0095871637744196, "entropy": 1.4557347849563316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 2065.207083882092, "episode_reward_min": 1146.364713665203, "episode_reward_mean": 1648.4447342182302, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 195.80608464036195, "predator_policy": 59.06344444125024}, "policy_reward_max": {"prey_policy": 748.0777542176662, "predator_policy": 577.7479061811567}, "policy_reward_mean": {"prey_policy": 501.92189966766813, "predator_policy": 322.3004674414471}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1853.7175147331536, 1228.4868853335217, 1714.7877044290015, 1436.5357057720616, 1476.3262138662294, 1473.1239675854204, 1640.0891693728017, 1557.6722838742194, 1238.9423489847604, 1270.437261544881, 1865.048732567649, 1966.563576219861, 1315.6144592170915, 1737.878435330016, 1649.7389429747311, 1502.163176514226, 1486.0504682546803, 1892.2272143733458, 1307.7207646159477, 1800.282411968562, 1614.8301826875822, 1389.6698601939609, 1742.4514995939537, 1768.4175189034843, 1874.3381206134527, 1725.9955445265684, 1618.6939166969332, 1728.4085661183024, 2003.0547046984589, 1750.4240386638933, 1733.8200491595398, 1532.5116072929409, 1780.9356952925089, 1810.7539411798712, 1910.4270598941387, 1775.9729689931441, 1655.0013971737264, 1818.0012689950263, 1680.0454805329985, 1870.4955310500009, 1509.991908547189, 1806.6216442832358, 1273.6846282350398, 1536.877052719687, 1808.0838954802014, 1697.7316109065307, 1540.6246218060633, 1546.4423452022352, 1658.7535541704747, 1741.594729050505, 1996.5490991538047, 1189.0773711497825, 1728.8862349757958, 1846.032921024098, 1800.0653097057998, 1759.5318261196537, 1901.8789677911516, 1505.2277253521609, 1694.706139090697, 1918.2403197572394, 1306.3167434485981, 1579.7314076118182, 1915.2215030236123, 1677.5398306192642, 1849.9566772173987, 1446.189346530799, 1762.8981849165389, 1146.364713665203, 1539.5956076010534, 1528.1652314830565, 1684.1260030451851, 1756.635804048191, 1795.9221892196222, 1280.9292176331587, 1595.4920665673333, 1589.5004620537413, 1405.7517067244328, 1220.7872089583475, 1862.8004661966322, 2021.7792695447642, 1429.1462424475533, 1944.5338176966543, 1645.7004028807912, 1795.1890606903953, 1647.5131434213797, 1442.9803841249197, 1455.0712488915347, 1402.4893116680123, 1790.427982102391, 1847.8999142124208, 1973.1827445102595, 1343.9444951280525, 1562.6976314636995, 2065.207083882092, 1744.080351035646, 1533.0033520216004, 1694.0663494986372, 1830.2901691359739, 1395.1028254096593, 1677.9851771786161], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [431.59639296636385, 483.35300033524067, 478.7062428516916, 195.80608464036195, 526.4280984957937, 464.58800540725883, 514.5329068026699, 481.03981454042366, 499.50078581644397, 489.9426446493652, 471.8854367710367, 548.0271793622373, 613.5659749819667, 517.1498221956955, 591.3327057711397, 394.20696102701675, 568.1682584755204, 486.11019266004195, 403.572097922223, 525.2178401654256, 475.44233886562176, 497.17008656685107, 563.4857135500797, 589.2560696570778, 455.5094386479557, 555.4133850265159, 668.4993928478161, 521.9631689199974, 553.858087142475, 429.2196391817673, 540.3441850045765, 423.70622771278073, 634.8856141459103, 436.74184947641896, 637.3799644630333, 475.8188347633645, 297.98366814824, 536.1360122086794, 479.60400839460027, 541.9809109496047, 412.5729671101935, 521.6194854240207, 415.308014241703, 454.8276269455901, 579.5464753338358, 529.908465986191, 547.3832350095468, 526.9941871271321, 516.4871575476482, 523.1468875831058, 371.5072493797375, 461.2432702812701, 454.9035415919542, 588.4074808614052, 530.1665857766665, 587.6150989704032, 636.188664749625, 478.2421886879522, 426.5811543286153, 496.14098756728885, 467.4744523011311, 588.6909438950365, 394.39710876899204, 498.50735013100694, 541.2076933806453, 581.3317857492929, 561.8691636297524, 425.2297160316944, 521.947689136583, 553.1085135770427, 550.9733603045261, 615.6478412322555, 449.95597880474804, 447.0520487988753, 504.10072409451647, 451.71836639190406, 429.73701190446405, 508.58982526977616, 736.0554234518064, 507.520874098069, 320.41837754058963, 536.8588638723922, 496.89560741095875, 562.5993629616853, 366.3806781422078, 469.9916355909585, 409.61243383792794, 592.9969056342479, 365.18974475762667, 417.0334462489246, 547.7487343556801, 490.2164967534999, 553.072167782312, 423.6234498693471, 441.16509581367944, 400.5590838849592, 445.55918687731423, 461.59591489087376, 405.5375599072169, 503.73849470530166, 659.9157534612685, 524.941672138508, 423.79883371105177, 424.7783332010121, 654.094868039976, 550.8010019762306, 536.0833430953131, 517.0219243539046, 449.56290845150573, 605.9890194681316, 586.4125579233358, 508.3835532040361, 536.8314199895747, 492.54720124432987, 465.89154229958035, 565.8701301947577, 495.3916029581208, 491.33086245487084, 748.0777542176662, 447.1214803409885, 532.6657486817192, 440.43727092988814, 534.1672081439953, 511.6487697029283, 501.13834582071644, 446.7155319328165, 526.5681342704011, 475.2706734592542, 454.8280058958903, 514.2145321222068, 543.6327269828845, 476.8184998816288, 490.21273500507, 481.25242191020305, 463.416155928362, 375.95860108863855, 520.2199125439491, 535.6434028240351, 610.526247595923, 625.5624876442589, 487.0870772397529, 461.87401039253797, 532.312762754101, 562.7111615460432, 482.88944012058613, 646.1976588251978, 458.07063027465125, 470.6355790115096, 519.3240358253677, 407.0040906482656, 461.9509278251555, 362.77742208801914, 376.1741307622365, 553.9584705675867, 465.2153272996127, 415.90852927115117, 496.0362752549318, 524.100450925719, 496.0588107652257, 554.1623949866491, 578.1878195191209, 526.0230238646253, 457.9623344235839, 489.0196104476929, 552.7303356553494, 492.6462751599646, 451.7269325438547, 545.4439743533331, 412.31665851608375, 509.3184891073124, 494.1620751972943, 428.68225044143156, 479.39899797111104, 602.4419762517477, 455.26414626850976, 450.4709169684844, 569.0495877335761, 594.3018730094467, 520.9284595661666, 474.5967768951028, 519.9592556137454, 544.6695505606225, 567.6904872156261, 342.2957103705139, 453.3760107642365, 468.2936272942379, 635.8322911983938, 496.66136476830286, 535.2041539897863, 606.0752111960629, 563.8384075937889, 436.8823190873376, 524.0603783014117, 487.61111231268194, 595.1151503484958, 520.3043789093967, 490.02002472561946, 465.07208733087043, 512.3802418238465, 450.3444169566207], "policy_predator_policy_reward": [460.17347786232506, 478.59464356922535, 228.59063115259886, 325.38392668886996, 356.4667661582779, 367.3048343676714, 200.11887430441985, 240.8441101245473, 223.3836930535295, 263.499090346892, 200.6251423734875, 252.58620907865904, 243.6439826322425, 265.7293895628964, 301.61347075484565, 270.51914632121805, 59.06344444125024, 125.60045340794683, 145.85372736031266, 195.7935960969199, 382.7937554166154, 509.64255171856337, 453.734233364462, 360.0875596482432, 120.37977185044525, 184.3118636921759, 386.9406609229006, 160.4752126393025, 331.76128180390634, 334.89993484658225, 254.51392966741525, 283.598834129454, 109.36546121231662, 305.05754342003473, 375.313758299946, 403.71465684700223, 214.24255520886905, 259.3585290501598, 463.0381219097838, 315.6593707145721, 331.96228742989746, 348.6754427234706, 299.6799654117085, 219.85425359495946, 322.5519960036889, 310.4445622702373, 301.7390063292554, 392.3010904375499, 397.24933824403837, 437.45473723865945, 436.6224683971793, 456.62255646838213, 186.83678903795317, 388.5461052056193, 340.6367899407888, 269.9900914304443, 420.2896800023554, 468.3341712585255, 467.3759527650696, 360.32594400291924, 291.7077320805663, 385.9469208828087, 245.53889405388975, 394.068254339052, 246.4962662098003, 411.8999499527691, 396.3400996350352, 427.31496188338997, 459.37188296188754, 375.99897421862653, 230.43719063371265, 378.9145768226492, 328.58027374223514, 429.4130958278655, 449.2145810104778, 412.9675974981305, 460.5156256979293, 281.20301766082787, 321.96237192711305, 304.95686157301236, 318.07549049159593, 334.6391766426106, 365.1549908897208, 381.9716830208707, 225.02569715736126, 212.28661734451236, 256.9839580476775, 277.2837551998341, 505.4355150984035, 520.4251893752471, 251.65106584114184, 408.1153139562093, 304.3802808584149, 259.5487232959888, 400.3342286440853, 304.38393685951013, 398.2199650110206, 353.37848739126576, 394.71243151801616, 437.60624291996993, 341.4308339472835, 470.2608396067443, 137.0008658022259, 203.4993384354924, 177.7574090075462, 346.232955952042, 462.87329621684984, 330.05435735803, 491.98684441226925, 252.52653737389397, 326.3793948027617, 338.3563201895207, 454.77564868345985, 417.7246978737871, 235.14893320742954, 238.31711965039213, 428.06847264430263, 279.9152010334025, 381.81239306856963, 341.2286921300156, 203.82718707258323, 129.386536764408, 296.06257786981746, 237.8528518950767, 389.61971908892394, 577.7479061811567, 316.35230128730564, 359.3487216023019, 498.63687583026757, 382.2772633690322, 230.18941130149355, 195.5487083647916, 402.0240146158511, 389.40901338541505, 159.8588117034069, 147.13114494479606, 101.12148774108205, 382.61080449198755, 181.10551962813616, 110.970976614737, 300.7155967972282, 434.4493186156657, 365.62107035735795, 295.9908093906878, 321.04925700941294, 345.785833264425, 102.31403455464742, 249.9089737923503, 372.165144001003, 296.9987960926973, 461.2164440344276, 303.5556681061381, 276.65668476001656, 198.96242063459212, 178.44640474887424, 161.216947638709, 404.87456816409536, 437.78917185188607, 474.4079640676653, 497.1500997252232, 169.39598785085673, 155.53941121295063, 561.0386488074661, 436.5132240179115, 301.581487603064, 298.742304462415, 393.108124146894, 404.9100296463123, 424.5695291731044, 301.3084666248781, 211.92237092913004, 308.213687557067, 185.7749868851273, 187.45528778354898, 244.52011968659252, 252.23412874442474, 369.56780644257935, 257.5087149167892, 487.0855135380574, 365.2891642130936, 418.9108709852549, 489.643067350638, 257.9726470155553, 175.98565052635942, 340.9351533996549, 300.0928400055693, 481.2515400753274, 451.46188784007103, 326.77758358237867, 276.02340226741944, 279.1767556112679, 253.10586972920555, 306.33119968383147, 376.06365920071204, 393.26628122983965, 321.6043586482439, 206.9874233574541, 233.02328999571534, 331.9988156878103, 383.26170271033976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8598538459011984, "mean_inference_ms": 2.443698774659763, "mean_action_processing_ms": 0.35285520113731494, "mean_env_wait_ms": 0.3129678850908924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005143880844116211, "StateBufferConnector_ms": 0.003763437271118164, "ViewRequirementAgentConnector_ms": 0.13620424270629883}, "num_episodes": 22, "episode_return_max": 2065.207083882092, "episode_return_min": 1146.364713665203, "episode_return_mean": 1648.4447342182302, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.62509086515144, "num_env_steps_trained_throughput_per_sec": 257.62509086515144, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 13852.944, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13852.898, "sample_time_ms": 1845.019, "learn_time_ms": 11987.538, "learn_throughput": 333.68, "synch_weights_time_ms": 18.516}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "8abce_00000", "date": "2024-08-16_11-25-33", "timestamp": 1723787733, "time_this_iter_s": 15.603786945343018, "time_total_s": 245.4611747264862, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4337280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 245.4611747264862, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 76.11363636363636, "ram_util_percent": 74.08636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4347044106829103, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.787824565140658, "policy_loss": -0.002836647049632298, "vf_loss": 9.789445259457542, "vf_explained_var": -0.00867832104365031, "kl": 0.012159470611393712, "entropy": 1.4606833088965643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.589078446528899, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.638303555382622, "policy_loss": -0.005272510509676837, "vf_loss": 9.641939329217982, "vf_explained_var": -0.014417823029573631, "kl": 0.008183685073663823, "entropy": 1.4313782596714282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 2065.207083882092, "episode_reward_min": 1146.364713665203, "episode_reward_mean": 1689.737531714605, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 320.41837754058963, "predator_policy": 76.69343808034509}, "policy_reward_max": {"prey_policy": 748.0777542176662, "predator_policy": 577.7479061811567}, "policy_reward_mean": {"prey_policy": 514.4915669510051, "predator_policy": 330.37719890629756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1768.4175189034843, 1874.3381206134527, 1725.9955445265684, 1618.6939166969332, 1728.4085661183024, 2003.0547046984589, 1750.4240386638933, 1733.8200491595398, 1532.5116072929409, 1780.9356952925089, 1810.7539411798712, 1910.4270598941387, 1775.9729689931441, 1655.0013971737264, 1818.0012689950263, 1680.0454805329985, 1870.4955310500009, 1509.991908547189, 1806.6216442832358, 1273.6846282350398, 1536.877052719687, 1808.0838954802014, 1697.7316109065307, 1540.6246218060633, 1546.4423452022352, 1658.7535541704747, 1741.594729050505, 1996.5490991538047, 1189.0773711497825, 1728.8862349757958, 1846.032921024098, 1800.0653097057998, 1759.5318261196537, 1901.8789677911516, 1505.2277253521609, 1694.706139090697, 1918.2403197572394, 1306.3167434485981, 1579.7314076118182, 1915.2215030236123, 1677.5398306192642, 1849.9566772173987, 1446.189346530799, 1762.8981849165389, 1146.364713665203, 1539.5956076010534, 1528.1652314830565, 1684.1260030451851, 1756.635804048191, 1795.9221892196222, 1280.9292176331587, 1595.4920665673333, 1589.5004620537413, 1405.7517067244328, 1220.7872089583475, 1862.8004661966322, 2021.7792695447642, 1429.1462424475533, 1944.5338176966543, 1645.7004028807912, 1795.1890606903953, 1647.5131434213797, 1442.9803841249197, 1455.0712488915347, 1402.4893116680123, 1790.427982102391, 1847.8999142124208, 1973.1827445102595, 1343.9444951280525, 1562.6976314636995, 2065.207083882092, 1744.080351035646, 1533.0033520216004, 1694.0663494986372, 1830.2901691359739, 1395.1028254096593, 1677.9851771786161, 1720.2990445129624, 1732.8283939887049, 1726.6990769653269, 1730.7609533183168, 1607.8323877729706, 1807.5568588639053, 1765.7100849092085, 1607.5761862501197, 1822.2705818987722, 1684.3909970912323, 1826.537562297801, 1663.7912038643267, 1623.893223439907, 1616.5229874208749, 1911.263913113355, 1888.0070219290117, 1898.6199401525514, 1857.4865209578256, 1735.4994101644686, 2010.5928629174707, 1926.4813029298186, 1437.8057704278904, 1687.2122444583133], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [547.3832350095468, 526.9941871271321, 516.4871575476482, 523.1468875831058, 371.5072493797375, 461.2432702812701, 454.9035415919542, 588.4074808614052, 530.1665857766665, 587.6150989704032, 636.188664749625, 478.2421886879522, 426.5811543286153, 496.14098756728885, 467.4744523011311, 588.6909438950365, 394.39710876899204, 498.50735013100694, 541.2076933806453, 581.3317857492929, 561.8691636297524, 425.2297160316944, 521.947689136583, 553.1085135770427, 550.9733603045261, 615.6478412322555, 449.95597880474804, 447.0520487988753, 504.10072409451647, 451.71836639190406, 429.73701190446405, 508.58982526977616, 736.0554234518064, 507.520874098069, 320.41837754058963, 536.8588638723922, 496.89560741095875, 562.5993629616853, 366.3806781422078, 469.9916355909585, 409.61243383792794, 592.9969056342479, 365.18974475762667, 417.0334462489246, 547.7487343556801, 490.2164967534999, 553.072167782312, 423.6234498693471, 441.16509581367944, 400.5590838849592, 445.55918687731423, 461.59591489087376, 405.5375599072169, 503.73849470530166, 659.9157534612685, 524.941672138508, 423.79883371105177, 424.7783332010121, 654.094868039976, 550.8010019762306, 536.0833430953131, 517.0219243539046, 449.56290845150573, 605.9890194681316, 586.4125579233358, 508.3835532040361, 536.8314199895747, 492.54720124432987, 465.89154229958035, 565.8701301947577, 495.3916029581208, 491.33086245487084, 748.0777542176662, 447.1214803409885, 532.6657486817192, 440.43727092988814, 534.1672081439953, 511.6487697029283, 501.13834582071644, 446.7155319328165, 526.5681342704011, 475.2706734592542, 454.8280058958903, 514.2145321222068, 543.6327269828845, 476.8184998816288, 490.21273500507, 481.25242191020305, 463.416155928362, 375.95860108863855, 520.2199125439491, 535.6434028240351, 610.526247595923, 625.5624876442589, 487.0870772397529, 461.87401039253797, 532.312762754101, 562.7111615460432, 482.88944012058613, 646.1976588251978, 458.07063027465125, 470.6355790115096, 519.3240358253677, 407.0040906482656, 461.9509278251555, 362.77742208801914, 376.1741307622365, 553.9584705675867, 465.2153272996127, 415.90852927115117, 496.0362752549318, 524.100450925719, 496.0588107652257, 554.1623949866491, 578.1878195191209, 526.0230238646253, 457.9623344235839, 489.0196104476929, 552.7303356553494, 492.6462751599646, 451.7269325438547, 545.4439743533331, 412.31665851608375, 509.3184891073124, 494.1620751972943, 428.68225044143156, 479.39899797111104, 602.4419762517477, 455.26414626850976, 450.4709169684844, 569.0495877335761, 594.3018730094467, 520.9284595661666, 474.5967768951028, 519.9592556137454, 544.6695505606225, 567.6904872156261, 342.2957103705139, 453.3760107642365, 468.2936272942379, 635.8322911983938, 496.66136476830286, 535.2041539897863, 606.0752111960629, 563.8384075937889, 436.8823190873376, 524.0603783014117, 487.61111231268194, 595.1151503484958, 520.3043789093967, 490.02002472561946, 465.07208733087043, 512.3802418238465, 450.3444169566207, 565.3234241803739, 606.3625241468264, 494.7486841199584, 574.6269833719956, 641.5503080634321, 681.0954677015509, 450.2818099343408, 462.58965098146774, 604.1651001919265, 349.99924608928796, 529.5805513772341, 580.7410246822358, 523.8389288011141, 586.7468750747067, 741.7376742065509, 526.9307681702608, 588.6050391041839, 487.04442057444294, 540.124437705463, 497.6487958388198, 571.77405958478, 565.7597789197954, 635.5219016804592, 694.3685883291356, 507.70391895556105, 592.4840897546138, 532.2558835978275, 509.76879616804644, 489.1753447047738, 567.7281538535319, 656.9600218046539, 575.0305082342536, 652.5560372981136, 481.05390526698864, 556.349910151361, 494.58574666632046, 536.5388131509887, 514.2262145146861, 524.1398090276365, 572.4721691544245, 513.4814415676723, 658.7805189164583, 649.9528745126682, 451.12021985449326, 370.95978180968285, 518.3553314251081], "policy_predator_policy_reward": [301.7390063292554, 392.3010904375499, 397.24933824403837, 437.45473723865945, 436.6224683971793, 456.62255646838213, 186.83678903795317, 388.5461052056193, 340.6367899407888, 269.9900914304443, 420.2896800023554, 468.3341712585255, 467.3759527650696, 360.32594400291924, 291.7077320805663, 385.9469208828087, 245.53889405388975, 394.068254339052, 246.4962662098003, 411.8999499527691, 396.3400996350352, 427.31496188338997, 459.37188296188754, 375.99897421862653, 230.43719063371265, 378.9145768226492, 328.58027374223514, 429.4130958278655, 449.2145810104778, 412.9675974981305, 460.5156256979293, 281.20301766082787, 321.96237192711305, 304.95686157301236, 318.07549049159593, 334.6391766426106, 365.1549908897208, 381.9716830208707, 225.02569715736126, 212.28661734451236, 256.9839580476775, 277.2837551998341, 505.4355150984035, 520.4251893752471, 251.65106584114184, 408.1153139562093, 304.3802808584149, 259.5487232959888, 400.3342286440853, 304.38393685951013, 398.2199650110206, 353.37848739126576, 394.71243151801616, 437.60624291996993, 341.4308339472835, 470.2608396067443, 137.0008658022259, 203.4993384354924, 177.7574090075462, 346.232955952042, 462.87329621684984, 330.05435735803, 491.98684441226925, 252.52653737389397, 326.3793948027617, 338.3563201895207, 454.77564868345985, 417.7246978737871, 235.14893320742954, 238.31711965039213, 428.06847264430263, 279.9152010334025, 381.81239306856963, 341.2286921300156, 203.82718707258323, 129.386536764408, 296.06257786981746, 237.8528518950767, 389.61971908892394, 577.7479061811567, 316.35230128730564, 359.3487216023019, 498.63687583026757, 382.2772633690322, 230.18941130149355, 195.5487083647916, 402.0240146158511, 389.40901338541505, 159.8588117034069, 147.13114494479606, 101.12148774108205, 382.61080449198755, 181.10551962813616, 110.970976614737, 300.7155967972282, 434.4493186156657, 365.62107035735795, 295.9908093906878, 321.04925700941294, 345.785833264425, 102.31403455464742, 249.9089737923503, 372.165144001003, 296.9987960926973, 461.2164440344276, 303.5556681061381, 276.65668476001656, 198.96242063459212, 178.44640474887424, 161.216947638709, 404.87456816409536, 437.78917185188607, 474.4079640676653, 497.1500997252232, 169.39598785085673, 155.53941121295063, 561.0386488074661, 436.5132240179115, 301.581487603064, 298.742304462415, 393.108124146894, 404.9100296463123, 424.5695291731044, 301.3084666248781, 211.92237092913004, 308.213687557067, 185.7749868851273, 187.45528778354898, 244.52011968659252, 252.23412874442474, 369.56780644257935, 257.5087149167892, 487.0855135380574, 365.2891642130936, 418.9108709852549, 489.643067350638, 257.9726470155553, 175.98565052635942, 340.9351533996549, 300.0928400055693, 481.2515400753274, 451.46188784007103, 326.77758358237867, 276.02340226741944, 279.1767556112679, 253.10586972920555, 306.33119968383147, 376.06365920071204, 393.26628122983965, 321.6043586482439, 206.9874233574541, 233.02328999571534, 331.9988156878103, 383.26170271033976, 252.55600510105882, 296.05709108470273, 364.00792082723956, 299.44480566951006, 76.69343808034509, 327.35986311999807, 431.1371212785984, 386.7523711239077, 282.4702627975692, 371.19777869418675, 278.08318129714434, 419.15210150728973, 337.30808687879767, 317.81619415458954, 205.14200353815622, 133.76574033515232, 331.9545535106818, 414.66656870946395, 367.5538159619877, 279.06394758496145, 332.7047979947556, 356.2989257984712, 145.50980641383347, 188.39090744089938, 329.4769017355444, 194.22831299418897, 234.48217986446, 340.01612779054176, 446.3351251106915, 408.02528944435693, 316.96619221559195, 339.05029967451236, 343.5686739038657, 421.4413236835829, 441.908181231615, 364.64268290852937, 380.92915536157614, 303.8052271372168, 443.405424612221, 470.57546012318875, 383.6493293030711, 370.5700131426172, 218.6534239156627, 118.0792521450658, 422.4687616611731, 375.42836956235186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8537445563865492, "mean_inference_ms": 2.444415133824552, "mean_action_processing_ms": 0.34965588436536743, "mean_env_wait_ms": 0.3115537800706495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00692439079284668, "StateBufferConnector_ms": 0.0036584138870239258, "ViewRequirementAgentConnector_ms": 0.13056600093841553}, "num_episodes": 23, "episode_return_max": 2065.207083882092, "episode_return_min": 1146.364713665203, "episode_return_mean": 1689.737531714605, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.14927262105215, "num_env_steps_trained_throughput_per_sec": 286.14927262105215, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 14100.137, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14100.09, "sample_time_ms": 1940.538, "learn_time_ms": 12138.089, "learn_throughput": 329.541, "synch_weights_time_ms": 19.362}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "8abce_00000", "date": "2024-08-16_11-25-47", "timestamp": 1723787747, "time_this_iter_s": 14.032020807266235, "time_total_s": 259.49319553375244, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 259.49319553375244, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 58.065, "ram_util_percent": 81.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.373856113054765, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.824698005656085, "policy_loss": -0.002213459236118647, "vf_loss": 9.825940736639437, "vf_explained_var": -0.018620826800664268, "kl": 0.009707138064913632, "entropy": 1.4543509064528046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7419267369798883, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.458262780103734, "policy_loss": -0.006336009983101455, "vf_loss": 9.462791561449647, "vf_explained_var": -0.001630471906964741, "kl": 0.009036254668259079, "entropy": 1.4373918291752932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 2065.207083882092, "episode_reward_min": 1146.364713665203, "episode_reward_mean": 1680.7159988491371, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 342.2957103705139, "predator_policy": 70.97521811450505}, "policy_reward_max": {"prey_policy": 748.0777542176662, "predator_policy": 577.7479061811567}, "policy_reward_mean": {"prey_policy": 522.3155092980351, "predator_policy": 318.0424901265335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1806.6216442832358, 1273.6846282350398, 1536.877052719687, 1808.0838954802014, 1697.7316109065307, 1540.6246218060633, 1546.4423452022352, 1658.7535541704747, 1741.594729050505, 1996.5490991538047, 1189.0773711497825, 1728.8862349757958, 1846.032921024098, 1800.0653097057998, 1759.5318261196537, 1901.8789677911516, 1505.2277253521609, 1694.706139090697, 1918.2403197572394, 1306.3167434485981, 1579.7314076118182, 1915.2215030236123, 1677.5398306192642, 1849.9566772173987, 1446.189346530799, 1762.8981849165389, 1146.364713665203, 1539.5956076010534, 1528.1652314830565, 1684.1260030451851, 1756.635804048191, 1795.9221892196222, 1280.9292176331587, 1595.4920665673333, 1589.5004620537413, 1405.7517067244328, 1220.7872089583475, 1862.8004661966322, 2021.7792695447642, 1429.1462424475533, 1944.5338176966543, 1645.7004028807912, 1795.1890606903953, 1647.5131434213797, 1442.9803841249197, 1455.0712488915347, 1402.4893116680123, 1790.427982102391, 1847.8999142124208, 1973.1827445102595, 1343.9444951280525, 1562.6976314636995, 2065.207083882092, 1744.080351035646, 1533.0033520216004, 1694.0663494986372, 1830.2901691359739, 1395.1028254096593, 1677.9851771786161, 1720.2990445129624, 1732.8283939887049, 1726.6990769653269, 1730.7609533183168, 1607.8323877729706, 1807.5568588639053, 1765.7100849092085, 1607.5761862501197, 1822.2705818987722, 1684.3909970912323, 1826.537562297801, 1663.7912038643267, 1623.893223439907, 1616.5229874208749, 1911.263913113355, 1888.0070219290117, 1898.6199401525514, 1857.4865209578256, 1735.4994101644686, 2010.5928629174707, 1926.4813029298186, 1437.8057704278904, 1687.2122444583133, 1666.6432868694571, 1711.245844418697, 1896.9558956998824, 1638.2480245972909, 1703.2457268721562, 1888.844649525285, 1796.1029688341594, 1767.0636011919778, 1844.9563046668063, 1443.2731760871272, 1736.9954977878642, 1843.042263819829, 1436.398844038521, 1757.0158372530818, 1871.1982007901079, 1436.6392420382867, 1338.713521425337, 1868.5531458695064], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [496.89560741095875, 562.5993629616853, 366.3806781422078, 469.9916355909585, 409.61243383792794, 592.9969056342479, 365.18974475762667, 417.0334462489246, 547.7487343556801, 490.2164967534999, 553.072167782312, 423.6234498693471, 441.16509581367944, 400.5590838849592, 445.55918687731423, 461.59591489087376, 405.5375599072169, 503.73849470530166, 659.9157534612685, 524.941672138508, 423.79883371105177, 424.7783332010121, 654.094868039976, 550.8010019762306, 536.0833430953131, 517.0219243539046, 449.56290845150573, 605.9890194681316, 586.4125579233358, 508.3835532040361, 536.8314199895747, 492.54720124432987, 465.89154229958035, 565.8701301947577, 495.3916029581208, 491.33086245487084, 748.0777542176662, 447.1214803409885, 532.6657486817192, 440.43727092988814, 534.1672081439953, 511.6487697029283, 501.13834582071644, 446.7155319328165, 526.5681342704011, 475.2706734592542, 454.8280058958903, 514.2145321222068, 543.6327269828845, 476.8184998816288, 490.21273500507, 481.25242191020305, 463.416155928362, 375.95860108863855, 520.2199125439491, 535.6434028240351, 610.526247595923, 625.5624876442589, 487.0870772397529, 461.87401039253797, 532.312762754101, 562.7111615460432, 482.88944012058613, 646.1976588251978, 458.07063027465125, 470.6355790115096, 519.3240358253677, 407.0040906482656, 461.9509278251555, 362.77742208801914, 376.1741307622365, 553.9584705675867, 465.2153272996127, 415.90852927115117, 496.0362752549318, 524.100450925719, 496.0588107652257, 554.1623949866491, 578.1878195191209, 526.0230238646253, 457.9623344235839, 489.0196104476929, 552.7303356553494, 492.6462751599646, 451.7269325438547, 545.4439743533331, 412.31665851608375, 509.3184891073124, 494.1620751972943, 428.68225044143156, 479.39899797111104, 602.4419762517477, 455.26414626850976, 450.4709169684844, 569.0495877335761, 594.3018730094467, 520.9284595661666, 474.5967768951028, 519.9592556137454, 544.6695505606225, 567.6904872156261, 342.2957103705139, 453.3760107642365, 468.2936272942379, 635.8322911983938, 496.66136476830286, 535.2041539897863, 606.0752111960629, 563.8384075937889, 436.8823190873376, 524.0603783014117, 487.61111231268194, 595.1151503484958, 520.3043789093967, 490.02002472561946, 465.07208733087043, 512.3802418238465, 450.3444169566207, 565.3234241803739, 606.3625241468264, 494.7486841199584, 574.6269833719956, 641.5503080634321, 681.0954677015509, 450.2818099343408, 462.58965098146774, 604.1651001919265, 349.99924608928796, 529.5805513772341, 580.7410246822358, 523.8389288011141, 586.7468750747067, 741.7376742065509, 526.9307681702608, 588.6050391041839, 487.04442057444294, 540.124437705463, 497.6487958388198, 571.77405958478, 565.7597789197954, 635.5219016804592, 694.3685883291356, 507.70391895556105, 592.4840897546138, 532.2558835978275, 509.76879616804644, 489.1753447047738, 567.7281538535319, 656.9600218046539, 575.0305082342536, 652.5560372981136, 481.05390526698864, 556.349910151361, 494.58574666632046, 536.5388131509887, 514.2262145146861, 524.1398090276365, 572.4721691544245, 513.4814415676723, 658.7805189164583, 649.9528745126682, 451.12021985449326, 370.95978180968285, 518.3553314251081, 477.19513460504703, 513.3954392961822, 510.96034821080764, 535.4651975268604, 577.442805517777, 660.0521946193293, 539.9952993856805, 513.3277246095993, 620.5198351224252, 565.4523957553148, 587.5090852512869, 542.2068756409507, 435.24856410363765, 527.5732413909094, 580.2392168712039, 620.7893010810357, 671.1760160948731, 612.4522888881988, 514.0459499917204, 434.46843059038684, 665.2564821948616, 525.6106751676538, 526.5491555928468, 527.5474716357375, 523.7375142293131, 588.1528138619841, 484.4249123337699, 572.176104084133, 692.6579475105157, 543.0412677228279, 502.80861811272655, 511.8451061077099, 563.752500969587, 444.2101616086108, 561.6472328279935, 629.2559627199621], "policy_predator_policy_reward": [365.1549908897208, 381.9716830208707, 225.02569715736126, 212.28661734451236, 256.9839580476775, 277.2837551998341, 505.4355150984035, 520.4251893752471, 251.65106584114184, 408.1153139562093, 304.3802808584149, 259.5487232959888, 400.3342286440853, 304.38393685951013, 398.2199650110206, 353.37848739126576, 394.71243151801616, 437.60624291996993, 341.4308339472835, 470.2608396067443, 137.0008658022259, 203.4993384354924, 177.7574090075462, 346.232955952042, 462.87329621684984, 330.05435735803, 491.98684441226925, 252.52653737389397, 326.3793948027617, 338.3563201895207, 454.77564868345985, 417.7246978737871, 235.14893320742954, 238.31711965039213, 428.06847264430263, 279.9152010334025, 381.81239306856963, 341.2286921300156, 203.82718707258323, 129.386536764408, 296.06257786981746, 237.8528518950767, 389.61971908892394, 577.7479061811567, 316.35230128730564, 359.3487216023019, 498.63687583026757, 382.2772633690322, 230.18941130149355, 195.5487083647916, 402.0240146158511, 389.40901338541505, 159.8588117034069, 147.13114494479606, 101.12148774108205, 382.61080449198755, 181.10551962813616, 110.970976614737, 300.7155967972282, 434.4493186156657, 365.62107035735795, 295.9908093906878, 321.04925700941294, 345.785833264425, 102.31403455464742, 249.9089737923503, 372.165144001003, 296.9987960926973, 461.2164440344276, 303.5556681061381, 276.65668476001656, 198.96242063459212, 178.44640474887424, 161.216947638709, 404.87456816409536, 437.78917185188607, 474.4079640676653, 497.1500997252232, 169.39598785085673, 155.53941121295063, 561.0386488074661, 436.5132240179115, 301.581487603064, 298.742304462415, 393.108124146894, 404.9100296463123, 424.5695291731044, 301.3084666248781, 211.92237092913004, 308.213687557067, 185.7749868851273, 187.45528778354898, 244.52011968659252, 252.23412874442474, 369.56780644257935, 257.5087149167892, 487.0855135380574, 365.2891642130936, 418.9108709852549, 489.643067350638, 257.9726470155553, 175.98565052635942, 340.9351533996549, 300.0928400055693, 481.2515400753274, 451.46188784007103, 326.77758358237867, 276.02340226741944, 279.1767556112679, 253.10586972920555, 306.33119968383147, 376.06365920071204, 393.26628122983965, 321.6043586482439, 206.9874233574541, 233.02328999571534, 331.9988156878103, 383.26170271033976, 252.55600510105882, 296.05709108470273, 364.00792082723956, 299.44480566951006, 76.69343808034509, 327.35986311999807, 431.1371212785984, 386.7523711239077, 282.4702627975692, 371.19777869418675, 278.08318129714434, 419.15210150728973, 337.30808687879767, 317.81619415458954, 205.14200353815622, 133.76574033515232, 331.9545535106818, 414.66656870946395, 367.5538159619877, 279.06394758496145, 332.7047979947556, 356.2989257984712, 145.50980641383347, 188.39090744089938, 329.4769017355444, 194.22831299418897, 234.48217986446, 340.01612779054176, 446.3351251106915, 408.02528944435693, 316.96619221559195, 339.05029967451236, 343.5686739038657, 421.4413236835829, 441.908181231615, 364.64268290852937, 380.92915536157614, 303.8052271372168, 443.405424612221, 470.57546012318875, 383.6493293030711, 370.5700131426172, 218.6534239156627, 118.0792521450658, 422.4687616611731, 375.42836956235186, 336.5662654380362, 339.4864475301903, 310.2054708995516, 354.6148277814782, 349.21302592688943, 310.2478696358877, 325.4966098642354, 259.4283907377776, 254.82684489167966, 262.44665110273564, 375.5216106103044, 383.60707802274237, 365.84137693864636, 467.43978640096554, 263.13031175728804, 302.90477148244935, 280.68757056111497, 280.6404291226185, 258.34672746585494, 236.4120680391648, 281.292896777692, 264.83544364765925, 367.976751511483, 420.9688850797615, 253.53329783271892, 70.97521811450505, 317.667810578748, 382.74701025643174, 352.48199939749253, 283.01698615927364, 175.00770220742166, 246.97781561042865, 179.25788616224744, 151.4929726848908, 338.78371532532793, 338.8662349962225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8505449339319475, "mean_inference_ms": 2.447914916769254, "mean_action_processing_ms": 0.3480247453464478, "mean_env_wait_ms": 0.31114534080140666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006959676742553711, "StateBufferConnector_ms": 0.0038537979125976562, "ViewRequirementAgentConnector_ms": 0.1321260929107666}, "num_episodes": 18, "episode_return_max": 2065.207083882092, "episode_return_min": 1146.364713665203, "episode_return_mean": 1680.7159988491371, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.56994617419065, "num_env_steps_trained_throughput_per_sec": 333.56994617419065, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 14030.409, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14030.361, "sample_time_ms": 1953.454, "learn_time_ms": 12054.5, "learn_throughput": 331.826, "synch_weights_time_ms": 20.081}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "8abce_00000", "date": "2024-08-16_11-25-59", "timestamp": 1723787759, "time_this_iter_s": 11.998384237289429, "time_total_s": 271.49157977104187, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 271.49157977104187, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 51.88823529411765, "ram_util_percent": 81.47058823529413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3652766324540295, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.810502209739079, "policy_loss": -0.0011503678230351951, "vf_loss": 9.810618493418215, "vf_explained_var": -0.0441007637788379, "kl": 0.010340775304521798, "entropy": 1.4184777664759802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4563824760535407, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.76437310516519, "policy_loss": -0.006276741078882306, "vf_loss": 9.768900723432107, "vf_explained_var": -0.011299211322945892, "kl": 0.008745509191945493, "entropy": 1.416453407996546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 2065.207083882092, "episode_reward_min": 1146.364713665203, "episode_reward_mean": 1688.0024145759935, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 302.52971539799177, "predator_policy": 70.97521811450505}, "policy_reward_max": {"prey_policy": 748.0777542176662, "predator_policy": 577.7479061811567}, "policy_reward_mean": {"prey_policy": 527.7517824294075, "predator_policy": 316.24942485858935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1918.2403197572394, 1306.3167434485981, 1579.7314076118182, 1915.2215030236123, 1677.5398306192642, 1849.9566772173987, 1446.189346530799, 1762.8981849165389, 1146.364713665203, 1539.5956076010534, 1528.1652314830565, 1684.1260030451851, 1756.635804048191, 1795.9221892196222, 1280.9292176331587, 1595.4920665673333, 1589.5004620537413, 1405.7517067244328, 1220.7872089583475, 1862.8004661966322, 2021.7792695447642, 1429.1462424475533, 1944.5338176966543, 1645.7004028807912, 1795.1890606903953, 1647.5131434213797, 1442.9803841249197, 1455.0712488915347, 1402.4893116680123, 1790.427982102391, 1847.8999142124208, 1973.1827445102595, 1343.9444951280525, 1562.6976314636995, 2065.207083882092, 1744.080351035646, 1533.0033520216004, 1694.0663494986372, 1830.2901691359739, 1395.1028254096593, 1677.9851771786161, 1720.2990445129624, 1732.8283939887049, 1726.6990769653269, 1730.7609533183168, 1607.8323877729706, 1807.5568588639053, 1765.7100849092085, 1607.5761862501197, 1822.2705818987722, 1684.3909970912323, 1826.537562297801, 1663.7912038643267, 1623.893223439907, 1616.5229874208749, 1911.263913113355, 1888.0070219290117, 1898.6199401525514, 1857.4865209578256, 1735.4994101644686, 2010.5928629174707, 1926.4813029298186, 1437.8057704278904, 1687.2122444583133, 1666.6432868694571, 1711.245844418697, 1896.9558956998824, 1638.2480245972909, 1703.2457268721562, 1888.844649525285, 1796.1029688341594, 1767.0636011919778, 1844.9563046668063, 1443.2731760871272, 1736.9954977878642, 1843.042263819829, 1436.398844038521, 1757.0158372530818, 1871.1982007901079, 1436.6392420382867, 1338.713521425337, 1868.5531458695064, 2053.316438902253, 1826.416692776779, 1583.6906466385594, 1694.1971540667134, 1745.617569872704, 1830.4923344583028, 1741.3552126144386, 1837.9500555844877, 1456.3227236384125, 1230.1441227404266, 1659.820424641707, 1894.546919026727, 1724.4783536782152, 1571.3101662867473, 1870.2451019988787, 1781.8199504871204, 1669.2320362144437, 1590.055345275658], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [748.0777542176662, 447.1214803409885, 532.6657486817192, 440.43727092988814, 534.1672081439953, 511.6487697029283, 501.13834582071644, 446.7155319328165, 526.5681342704011, 475.2706734592542, 454.8280058958903, 514.2145321222068, 543.6327269828845, 476.8184998816288, 490.21273500507, 481.25242191020305, 463.416155928362, 375.95860108863855, 520.2199125439491, 535.6434028240351, 610.526247595923, 625.5624876442589, 487.0870772397529, 461.87401039253797, 532.312762754101, 562.7111615460432, 482.88944012058613, 646.1976588251978, 458.07063027465125, 470.6355790115096, 519.3240358253677, 407.0040906482656, 461.9509278251555, 362.77742208801914, 376.1741307622365, 553.9584705675867, 465.2153272996127, 415.90852927115117, 496.0362752549318, 524.100450925719, 496.0588107652257, 554.1623949866491, 578.1878195191209, 526.0230238646253, 457.9623344235839, 489.0196104476929, 552.7303356553494, 492.6462751599646, 451.7269325438547, 545.4439743533331, 412.31665851608375, 509.3184891073124, 494.1620751972943, 428.68225044143156, 479.39899797111104, 602.4419762517477, 455.26414626850976, 450.4709169684844, 569.0495877335761, 594.3018730094467, 520.9284595661666, 474.5967768951028, 519.9592556137454, 544.6695505606225, 567.6904872156261, 342.2957103705139, 453.3760107642365, 468.2936272942379, 635.8322911983938, 496.66136476830286, 535.2041539897863, 606.0752111960629, 563.8384075937889, 436.8823190873376, 524.0603783014117, 487.61111231268194, 595.1151503484958, 520.3043789093967, 490.02002472561946, 465.07208733087043, 512.3802418238465, 450.3444169566207, 565.3234241803739, 606.3625241468264, 494.7486841199584, 574.6269833719956, 641.5503080634321, 681.0954677015509, 450.2818099343408, 462.58965098146774, 604.1651001919265, 349.99924608928796, 529.5805513772341, 580.7410246822358, 523.8389288011141, 586.7468750747067, 741.7376742065509, 526.9307681702608, 588.6050391041839, 487.04442057444294, 540.124437705463, 497.6487958388198, 571.77405958478, 565.7597789197954, 635.5219016804592, 694.3685883291356, 507.70391895556105, 592.4840897546138, 532.2558835978275, 509.76879616804644, 489.1753447047738, 567.7281538535319, 656.9600218046539, 575.0305082342536, 652.5560372981136, 481.05390526698864, 556.349910151361, 494.58574666632046, 536.5388131509887, 514.2262145146861, 524.1398090276365, 572.4721691544245, 513.4814415676723, 658.7805189164583, 649.9528745126682, 451.12021985449326, 370.95978180968285, 518.3553314251081, 477.19513460504703, 513.3954392961822, 510.96034821080764, 535.4651975268604, 577.442805517777, 660.0521946193293, 539.9952993856805, 513.3277246095993, 620.5198351224252, 565.4523957553148, 587.5090852512869, 542.2068756409507, 435.24856410363765, 527.5732413909094, 580.2392168712039, 620.7893010810357, 671.1760160948731, 612.4522888881988, 514.0459499917204, 434.46843059038684, 665.2564821948616, 525.6106751676538, 526.5491555928468, 527.5474716357375, 523.7375142293131, 588.1528138619841, 484.4249123337699, 572.176104084133, 692.6579475105157, 543.0412677228279, 502.80861811272655, 511.8451061077099, 563.752500969587, 444.2101616086108, 561.6472328279935, 629.2559627199621, 588.8684141669551, 550.4740648314062, 593.7256404824519, 396.0901434249358, 593.8823522170077, 517.7077203166123, 491.70264007803115, 507.52388313531384, 578.6064512176351, 444.76737361952735, 481.7217209975687, 601.4249804826171, 521.4713729794523, 588.8542516664797, 502.1966474726563, 490.9270981866964, 601.0270268119776, 557.8504601417274, 711.4323543974812, 302.52971539799177, 569.3487726512767, 368.13924131880265, 599.297930011228, 560.9845509999566, 572.3576311583813, 591.4403011785471, 523.4490099588063, 448.43733551618374, 488.6022885959826, 569.5752971111118, 662.0110838193543, 472.4203790261082, 570.8436163507499, 387.2591496696938, 415.92287309700913, 507.5433813770067], "policy_predator_policy_reward": [381.81239306856963, 341.2286921300156, 203.82718707258323, 129.386536764408, 296.06257786981746, 237.8528518950767, 389.61971908892394, 577.7479061811567, 316.35230128730564, 359.3487216023019, 498.63687583026757, 382.2772633690322, 230.18941130149355, 195.5487083647916, 402.0240146158511, 389.40901338541505, 159.8588117034069, 147.13114494479606, 101.12148774108205, 382.61080449198755, 181.10551962813616, 110.970976614737, 300.7155967972282, 434.4493186156657, 365.62107035735795, 295.9908093906878, 321.04925700941294, 345.785833264425, 102.31403455464742, 249.9089737923503, 372.165144001003, 296.9987960926973, 461.2164440344276, 303.5556681061381, 276.65668476001656, 198.96242063459212, 178.44640474887424, 161.216947638709, 404.87456816409536, 437.78917185188607, 474.4079640676653, 497.1500997252232, 169.39598785085673, 155.53941121295063, 561.0386488074661, 436.5132240179115, 301.581487603064, 298.742304462415, 393.108124146894, 404.9100296463123, 424.5695291731044, 301.3084666248781, 211.92237092913004, 308.213687557067, 185.7749868851273, 187.45528778354898, 244.52011968659252, 252.23412874442474, 369.56780644257935, 257.5087149167892, 487.0855135380574, 365.2891642130936, 418.9108709852549, 489.643067350638, 257.9726470155553, 175.98565052635942, 340.9351533996549, 300.0928400055693, 481.2515400753274, 451.46188784007103, 326.77758358237867, 276.02340226741944, 279.1767556112679, 253.10586972920555, 306.33119968383147, 376.06365920071204, 393.26628122983965, 321.6043586482439, 206.9874233574541, 233.02328999571534, 331.9988156878103, 383.26170271033976, 252.55600510105882, 296.05709108470273, 364.00792082723956, 299.44480566951006, 76.69343808034509, 327.35986311999807, 431.1371212785984, 386.7523711239077, 282.4702627975692, 371.19777869418675, 278.08318129714434, 419.15210150728973, 337.30808687879767, 317.81619415458954, 205.14200353815622, 133.76574033515232, 331.9545535106818, 414.66656870946395, 367.5538159619877, 279.06394758496145, 332.7047979947556, 356.2989257984712, 145.50980641383347, 188.39090744089938, 329.4769017355444, 194.22831299418897, 234.48217986446, 340.01612779054176, 446.3351251106915, 408.02528944435693, 316.96619221559195, 339.05029967451236, 343.5686739038657, 421.4413236835829, 441.908181231615, 364.64268290852937, 380.92915536157614, 303.8052271372168, 443.405424612221, 470.57546012318875, 383.6493293030711, 370.5700131426172, 218.6534239156627, 118.0792521450658, 422.4687616611731, 375.42836956235186, 336.5662654380362, 339.4864475301903, 310.2054708995516, 354.6148277814782, 349.21302592688943, 310.2478696358877, 325.4966098642354, 259.4283907377776, 254.82684489167966, 262.44665110273564, 375.5216106103044, 383.60707802274237, 365.84137693864636, 467.43978640096554, 263.13031175728804, 302.90477148244935, 280.68757056111497, 280.6404291226185, 258.34672746585494, 236.4120680391648, 281.292896777692, 264.83544364765925, 367.976751511483, 420.9688850797615, 253.53329783271892, 70.97521811450505, 317.667810578748, 382.74701025643174, 352.48199939749253, 283.01698615927364, 175.00770220742166, 246.97781561042865, 179.25788616224744, 151.4929726848908, 338.78371532532793, 338.8662349962225, 510.1944175168308, 403.7795423870629, 417.505608721958, 419.09530014743484, 207.69287894132458, 264.4076951636146, 346.41947482958375, 348.5511560237848, 376.6423765037418, 345.60136853180154, 361.2261731970312, 386.11945978108656, 334.3413162163725, 296.6882717521354, 451.2625699274266, 393.5637399977065, 131.795024784603, 165.65021190010282, 90.68578596834882, 125.49626697660503, 361.20588344550276, 361.12652722612455, 398.9946996313281, 335.2697383842148, 361.6173544891618, 199.0630668521245, 268.45164851897937, 330.9721722927786, 462.7304558652035, 349.33706042658036, 322.9785004459028, 324.4099871957549, 348.7347141473808, 362.3945560466189, 309.4698112191623, 357.11927958248015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8493785465737034, "mean_inference_ms": 2.4558893522461607, "mean_action_processing_ms": 0.3470624324324166, "mean_env_wait_ms": 0.3116274523040633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007129549980163574, "StateBufferConnector_ms": 0.0038851499557495117, "ViewRequirementAgentConnector_ms": 0.1344996690750122}, "num_episodes": 18, "episode_return_max": 2065.207083882092, "episode_return_min": 1146.364713665203, "episode_return_mean": 1688.0024145759935, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.74946667249105, "num_env_steps_trained_throughput_per_sec": 272.74946667249105, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 13921.517, "restore_workers_time_ms": 0.012, "training_step_time_ms": 13921.476, "sample_time_ms": 1870.416, "learn_time_ms": 12029.324, "learn_throughput": 332.521, "synch_weights_time_ms": 19.544}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "8abce_00000", "date": "2024-08-16_11-26-14", "timestamp": 1723787774, "time_this_iter_s": 14.67431902885437, "time_total_s": 286.16589879989624, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 286.16589879989624, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 55.60476190476191, "ram_util_percent": 72.87142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3797656352873202, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.808227955853498, "policy_loss": -0.0033029982375434386, "vf_loss": 9.810584073848826, "vf_explained_var": -0.07451114616696797, "kl": 0.00946904487878748, "entropy": 1.3984698065374264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.550313123697957, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.70117417391015, "policy_loss": -0.0060728366329043946, "vf_loss": 9.705659386972902, "vf_explained_var": -0.01025145306158318, "kl": 0.007938053794658133, "entropy": 1.396945927382777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 2065.207083882092, "episode_reward_min": 1220.7872089583475, "episode_reward_mean": 1710.5310209863278, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 302.52971539799177, "predator_policy": 70.97521811450505}, "policy_reward_max": {"prey_policy": 741.7376742065509, "predator_policy": 561.0386488074661}, "policy_reward_mean": {"prey_policy": 528.4806023723563, "predator_policy": 326.7849081208075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1220.7872089583475, 1862.8004661966322, 2021.7792695447642, 1429.1462424475533, 1944.5338176966543, 1645.7004028807912, 1795.1890606903953, 1647.5131434213797, 1442.9803841249197, 1455.0712488915347, 1402.4893116680123, 1790.427982102391, 1847.8999142124208, 1973.1827445102595, 1343.9444951280525, 1562.6976314636995, 2065.207083882092, 1744.080351035646, 1533.0033520216004, 1694.0663494986372, 1830.2901691359739, 1395.1028254096593, 1677.9851771786161, 1720.2990445129624, 1732.8283939887049, 1726.6990769653269, 1730.7609533183168, 1607.8323877729706, 1807.5568588639053, 1765.7100849092085, 1607.5761862501197, 1822.2705818987722, 1684.3909970912323, 1826.537562297801, 1663.7912038643267, 1623.893223439907, 1616.5229874208749, 1911.263913113355, 1888.0070219290117, 1898.6199401525514, 1857.4865209578256, 1735.4994101644686, 2010.5928629174707, 1926.4813029298186, 1437.8057704278904, 1687.2122444583133, 1666.6432868694571, 1711.245844418697, 1896.9558956998824, 1638.2480245972909, 1703.2457268721562, 1888.844649525285, 1796.1029688341594, 1767.0636011919778, 1844.9563046668063, 1443.2731760871272, 1736.9954977878642, 1843.042263819829, 1436.398844038521, 1757.0158372530818, 1871.1982007901079, 1436.6392420382867, 1338.713521425337, 1868.5531458695064, 2053.316438902253, 1826.416692776779, 1583.6906466385594, 1694.1971540667134, 1745.617569872704, 1830.4923344583028, 1741.3552126144386, 1837.9500555844877, 1456.3227236384125, 1230.1441227404266, 1659.820424641707, 1894.546919026727, 1724.4783536782152, 1571.3101662867473, 1870.2451019988787, 1781.8199504871204, 1669.2320362144437, 1590.055345275658, 1607.0390526890646, 1646.4604518153428, 1367.9133525187333, 1778.4279080797628, 2062.9279395405433, 1824.129140539334, 2027.018195705696, 1611.1967112672373, 1852.936424244016, 1805.7108992806377, 1619.5869159997496, 1827.100452857258, 1675.6820555558159, 1774.0103247073155, 1741.9285381622826, 1406.4767817652466, 1718.7971639238024, 1684.0953475478136], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [465.2153272996127, 415.90852927115117, 496.0362752549318, 524.100450925719, 496.0588107652257, 554.1623949866491, 578.1878195191209, 526.0230238646253, 457.9623344235839, 489.0196104476929, 552.7303356553494, 492.6462751599646, 451.7269325438547, 545.4439743533331, 412.31665851608375, 509.3184891073124, 494.1620751972943, 428.68225044143156, 479.39899797111104, 602.4419762517477, 455.26414626850976, 450.4709169684844, 569.0495877335761, 594.3018730094467, 520.9284595661666, 474.5967768951028, 519.9592556137454, 544.6695505606225, 567.6904872156261, 342.2957103705139, 453.3760107642365, 468.2936272942379, 635.8322911983938, 496.66136476830286, 535.2041539897863, 606.0752111960629, 563.8384075937889, 436.8823190873376, 524.0603783014117, 487.61111231268194, 595.1151503484958, 520.3043789093967, 490.02002472561946, 465.07208733087043, 512.3802418238465, 450.3444169566207, 565.3234241803739, 606.3625241468264, 494.7486841199584, 574.6269833719956, 641.5503080634321, 681.0954677015509, 450.2818099343408, 462.58965098146774, 604.1651001919265, 349.99924608928796, 529.5805513772341, 580.7410246822358, 523.8389288011141, 586.7468750747067, 741.7376742065509, 526.9307681702608, 588.6050391041839, 487.04442057444294, 540.124437705463, 497.6487958388198, 571.77405958478, 565.7597789197954, 635.5219016804592, 694.3685883291356, 507.70391895556105, 592.4840897546138, 532.2558835978275, 509.76879616804644, 489.1753447047738, 567.7281538535319, 656.9600218046539, 575.0305082342536, 652.5560372981136, 481.05390526698864, 556.349910151361, 494.58574666632046, 536.5388131509887, 514.2262145146861, 524.1398090276365, 572.4721691544245, 513.4814415676723, 658.7805189164583, 649.9528745126682, 451.12021985449326, 370.95978180968285, 518.3553314251081, 477.19513460504703, 513.3954392961822, 510.96034821080764, 535.4651975268604, 577.442805517777, 660.0521946193293, 539.9952993856805, 513.3277246095993, 620.5198351224252, 565.4523957553148, 587.5090852512869, 542.2068756409507, 435.24856410363765, 527.5732413909094, 580.2392168712039, 620.7893010810357, 671.1760160948731, 612.4522888881988, 514.0459499917204, 434.46843059038684, 665.2564821948616, 525.6106751676538, 526.5491555928468, 527.5474716357375, 523.7375142293131, 588.1528138619841, 484.4249123337699, 572.176104084133, 692.6579475105157, 543.0412677228279, 502.80861811272655, 511.8451061077099, 563.752500969587, 444.2101616086108, 561.6472328279935, 629.2559627199621, 588.8684141669551, 550.4740648314062, 593.7256404824519, 396.0901434249358, 593.8823522170077, 517.7077203166123, 491.70264007803115, 507.52388313531384, 578.6064512176351, 444.76737361952735, 481.7217209975687, 601.4249804826171, 521.4713729794523, 588.8542516664797, 502.1966474726563, 490.9270981866964, 601.0270268119776, 557.8504601417274, 711.4323543974812, 302.52971539799177, 569.3487726512767, 368.13924131880265, 599.297930011228, 560.9845509999566, 572.3576311583813, 591.4403011785471, 523.4490099588063, 448.43733551618374, 488.6022885959826, 569.5752971111118, 662.0110838193543, 472.4203790261082, 570.8436163507499, 387.2591496696938, 415.92287309700913, 507.5433813770067, 425.6684061846796, 455.8191509991317, 440.49992744004027, 466.8791289661883, 360.9990108562296, 621.2176031543305, 470.199407735632, 487.5735505118572, 477.82011928415693, 516.4884314245782, 626.4794045722649, 567.7948355755846, 449.4440673804863, 492.08778251949224, 561.5885740791585, 656.4956150881471, 462.01946835389396, 505.2300468949539, 443.7489966492055, 603.7866248038658, 452.4529918154606, 532.8752889561089, 528.5028735639204, 574.4375087322356, 540.7872113034047, 572.9268352977775, 449.4810119297644, 537.526572605877, 475.02648915405024, 557.5781545246291, 517.3295881148538, 421.09281768714607, 404.42015934641825, 461.1625248636513, 627.0064714495664, 440.3813815754673], "policy_predator_policy_reward": [178.44640474887424, 161.216947638709, 404.87456816409536, 437.78917185188607, 474.4079640676653, 497.1500997252232, 169.39598785085673, 155.53941121295063, 561.0386488074661, 436.5132240179115, 301.581487603064, 298.742304462415, 393.108124146894, 404.9100296463123, 424.5695291731044, 301.3084666248781, 211.92237092913004, 308.213687557067, 185.7749868851273, 187.45528778354898, 244.52011968659252, 252.23412874442474, 369.56780644257935, 257.5087149167892, 487.0855135380574, 365.2891642130936, 418.9108709852549, 489.643067350638, 257.9726470155553, 175.98565052635942, 340.9351533996549, 300.0928400055693, 481.2515400753274, 451.46188784007103, 326.77758358237867, 276.02340226741944, 279.1767556112679, 253.10586972920555, 306.33119968383147, 376.06365920071204, 393.26628122983965, 321.6043586482439, 206.9874233574541, 233.02328999571534, 331.9988156878103, 383.26170271033976, 252.55600510105882, 296.05709108470273, 364.00792082723956, 299.44480566951006, 76.69343808034509, 327.35986311999807, 431.1371212785984, 386.7523711239077, 282.4702627975692, 371.19777869418675, 278.08318129714434, 419.15210150728973, 337.30808687879767, 317.81619415458954, 205.14200353815622, 133.76574033515232, 331.9545535106818, 414.66656870946395, 367.5538159619877, 279.06394758496145, 332.7047979947556, 356.2989257984712, 145.50980641383347, 188.39090744089938, 329.4769017355444, 194.22831299418897, 234.48217986446, 340.01612779054176, 446.3351251106915, 408.02528944435693, 316.96619221559195, 339.05029967451236, 343.5686739038657, 421.4413236835829, 441.908181231615, 364.64268290852937, 380.92915536157614, 303.8052271372168, 443.405424612221, 470.57546012318875, 383.6493293030711, 370.5700131426172, 218.6534239156627, 118.0792521450658, 422.4687616611731, 375.42836956235186, 336.5662654380362, 339.4864475301903, 310.2054708995516, 354.6148277814782, 349.21302592688943, 310.2478696358877, 325.4966098642354, 259.4283907377776, 254.82684489167966, 262.44665110273564, 375.5216106103044, 383.60707802274237, 365.84137693864636, 467.43978640096554, 263.13031175728804, 302.90477148244935, 280.68757056111497, 280.6404291226185, 258.34672746585494, 236.4120680391648, 281.292896777692, 264.83544364765925, 367.976751511483, 420.9688850797615, 253.53329783271892, 70.97521811450505, 317.667810578748, 382.74701025643174, 352.48199939749253, 283.01698615927364, 175.00770220742166, 246.97781561042865, 179.25788616224744, 151.4929726848908, 338.78371532532793, 338.8662349962225, 510.1944175168308, 403.7795423870629, 417.505608721958, 419.09530014743484, 207.69287894132458, 264.4076951636146, 346.41947482958375, 348.5511560237848, 376.6423765037418, 345.60136853180154, 361.2261731970312, 386.11945978108656, 334.3413162163725, 296.6882717521354, 451.2625699274266, 393.5637399977065, 131.795024784603, 165.65021190010282, 90.68578596834882, 125.49626697660503, 361.20588344550276, 361.12652722612455, 398.9946996313281, 335.2697383842148, 361.6173544891618, 199.0630668521245, 268.45164851897937, 330.9721722927786, 462.7304558652035, 349.33706042658036, 322.9785004459028, 324.4099871957549, 348.7347141473808, 362.3945560466189, 309.4698112191623, 357.11927958248015, 344.28787733145214, 381.26361817380047, 358.1538411371697, 380.92755427194476, 182.58495984366203, 203.111778664512, 389.0764541367423, 431.5784956955325, 538.4301608637903, 530.1892279680211, 343.8391715093787, 286.0157288821056, 557.7297116388218, 527.7566341668937, 253.1610406408643, 139.95148145906631, 422.52214415592016, 463.1647648392468, 343.9137331542345, 414.26154467333305, 243.1115136040212, 391.14712162415725, 367.537463136589, 356.62260742451133, 314.3584361677563, 247.60957278687795, 357.0197541707439, 429.98298600092994, 305.36749896801604, 403.9563955155882, 208.9576873797708, 259.09668858347624, 440.55109519724544, 412.66338451648545, 338.5376573658203, 278.16983715695926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8480157244408091, "mean_inference_ms": 2.46173083064032, "mean_action_processing_ms": 0.3460072234695083, "mean_env_wait_ms": 0.3120486175521762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006764888763427734, "StateBufferConnector_ms": 0.003949999809265137, "ViewRequirementAgentConnector_ms": 0.13415169715881348}, "num_episodes": 18, "episode_return_max": 2065.207083882092, "episode_return_min": 1220.7872089583475, "episode_return_mean": 1710.5310209863278, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.5524179800144, "num_env_steps_trained_throughput_per_sec": 274.5524179800144, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 14153.134, "restore_workers_time_ms": 0.012, "training_step_time_ms": 14153.093, "sample_time_ms": 1869.885, "learn_time_ms": 12261.428, "learn_throughput": 326.226, "synch_weights_time_ms": 19.642}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "8abce_00000", "date": "2024-08-16_11-26-29", "timestamp": 1723787789, "time_this_iter_s": 14.579838991165161, "time_total_s": 300.7457377910614, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433fc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 300.7457377910614, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 59.85, "ram_util_percent": 72.36500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6320150353448102, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.66274891151953, "policy_loss": 0.0010376425881293558, "vf_loss": 9.660291139915506, "vf_explained_var": -0.029076879775082623, "kl": 0.014201418114892467, "entropy": 1.3865151247650227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8436498223158417, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.460374396187918, "policy_loss": -0.0058531487501034185, "vf_loss": 9.46439066538735, "vf_explained_var": -0.012807449020405925, "kl": 0.00918435912152764, "entropy": 1.3889607543667788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 2062.9279395405433, "episode_reward_min": 966.0356688614609, "episode_reward_mean": 1707.2011180017666, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 302.52971539799177, "predator_policy": 70.97521811450505}, "policy_reward_max": {"prey_policy": 741.7376742065509, "predator_policy": 580.5777939133742}, "policy_reward_mean": {"prey_policy": 527.529375758994, "predator_policy": 326.0711832418895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1607.8323877729706, 1807.5568588639053, 1765.7100849092085, 1607.5761862501197, 1822.2705818987722, 1684.3909970912323, 1826.537562297801, 1663.7912038643267, 1623.893223439907, 1616.5229874208749, 1911.263913113355, 1888.0070219290117, 1898.6199401525514, 1857.4865209578256, 1735.4994101644686, 2010.5928629174707, 1926.4813029298186, 1437.8057704278904, 1687.2122444583133, 1666.6432868694571, 1711.245844418697, 1896.9558956998824, 1638.2480245972909, 1703.2457268721562, 1888.844649525285, 1796.1029688341594, 1767.0636011919778, 1844.9563046668063, 1443.2731760871272, 1736.9954977878642, 1843.042263819829, 1436.398844038521, 1757.0158372530818, 1871.1982007901079, 1436.6392420382867, 1338.713521425337, 1868.5531458695064, 2053.316438902253, 1826.416692776779, 1583.6906466385594, 1694.1971540667134, 1745.617569872704, 1830.4923344583028, 1741.3552126144386, 1837.9500555844877, 1456.3227236384125, 1230.1441227404266, 1659.820424641707, 1894.546919026727, 1724.4783536782152, 1571.3101662867473, 1870.2451019988787, 1781.8199504871204, 1669.2320362144437, 1590.055345275658, 1607.0390526890646, 1646.4604518153428, 1367.9133525187333, 1778.4279080797628, 2062.9279395405433, 1824.129140539334, 2027.018195705696, 1611.1967112672373, 1852.936424244016, 1805.7108992806377, 1619.5869159997496, 1827.100452857258, 1675.6820555558159, 1774.0103247073155, 1741.9285381622826, 1406.4767817652466, 1718.7971639238024, 1684.0953475478136, 1658.1977103571166, 1890.2688448161757, 1692.1737468698084, 1535.115143055011, 1818.1340133040403, 1624.4967399496056, 1551.8646530475671, 1941.604593911679, 992.2637094545248, 1944.8411478144824, 1493.2208225177576, 966.0356688614609, 1635.9211528159378, 1612.9649883036316, 1572.4881564609814, 1927.5309663232879, 1470.9118653933824, 1563.3205633993532, 1956.74512906582, 1819.7177735193409, 1944.186653945428, 1689.7324200963308, 1897.7390780392655, 1942.320590522318, 1695.3266351177044, 1468.087761502119, 1598.2652739651471], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [604.1651001919265, 349.99924608928796, 529.5805513772341, 580.7410246822358, 523.8389288011141, 586.7468750747067, 741.7376742065509, 526.9307681702608, 588.6050391041839, 487.04442057444294, 540.124437705463, 497.6487958388198, 571.77405958478, 565.7597789197954, 635.5219016804592, 694.3685883291356, 507.70391895556105, 592.4840897546138, 532.2558835978275, 509.76879616804644, 489.1753447047738, 567.7281538535319, 656.9600218046539, 575.0305082342536, 652.5560372981136, 481.05390526698864, 556.349910151361, 494.58574666632046, 536.5388131509887, 514.2262145146861, 524.1398090276365, 572.4721691544245, 513.4814415676723, 658.7805189164583, 649.9528745126682, 451.12021985449326, 370.95978180968285, 518.3553314251081, 477.19513460504703, 513.3954392961822, 510.96034821080764, 535.4651975268604, 577.442805517777, 660.0521946193293, 539.9952993856805, 513.3277246095993, 620.5198351224252, 565.4523957553148, 587.5090852512869, 542.2068756409507, 435.24856410363765, 527.5732413909094, 580.2392168712039, 620.7893010810357, 671.1760160948731, 612.4522888881988, 514.0459499917204, 434.46843059038684, 665.2564821948616, 525.6106751676538, 526.5491555928468, 527.5474716357375, 523.7375142293131, 588.1528138619841, 484.4249123337699, 572.176104084133, 692.6579475105157, 543.0412677228279, 502.80861811272655, 511.8451061077099, 563.752500969587, 444.2101616086108, 561.6472328279935, 629.2559627199621, 588.8684141669551, 550.4740648314062, 593.7256404824519, 396.0901434249358, 593.8823522170077, 517.7077203166123, 491.70264007803115, 507.52388313531384, 578.6064512176351, 444.76737361952735, 481.7217209975687, 601.4249804826171, 521.4713729794523, 588.8542516664797, 502.1966474726563, 490.9270981866964, 601.0270268119776, 557.8504601417274, 711.4323543974812, 302.52971539799177, 569.3487726512767, 368.13924131880265, 599.297930011228, 560.9845509999566, 572.3576311583813, 591.4403011785471, 523.4490099588063, 448.43733551618374, 488.6022885959826, 569.5752971111118, 662.0110838193543, 472.4203790261082, 570.8436163507499, 387.2591496696938, 415.92287309700913, 507.5433813770067, 425.6684061846796, 455.8191509991317, 440.49992744004027, 466.8791289661883, 360.9990108562296, 621.2176031543305, 470.199407735632, 487.5735505118572, 477.82011928415693, 516.4884314245782, 626.4794045722649, 567.7948355755846, 449.4440673804863, 492.08778251949224, 561.5885740791585, 656.4956150881471, 462.01946835389396, 505.2300468949539, 443.7489966492055, 603.7866248038658, 452.4529918154606, 532.8752889561089, 528.5028735639204, 574.4375087322356, 540.7872113034047, 572.9268352977775, 449.4810119297644, 537.526572605877, 475.02648915405024, 557.5781545246291, 517.3295881148538, 421.09281768714607, 404.42015934641825, 461.1625248636513, 627.0064714495664, 440.3813815754673, 449.25845767667795, 419.08591378681535, 453.86623072876614, 576.8457556427148, 502.68795079873047, 521.3145283864138, 526.963164465207, 468.433182632449, 609.3682554708879, 665.0733806163037, 566.2024228679727, 599.9878075648091, 425.99385356856044, 470.58564381008165, 533.5611456515053, 589.8811637231561, 304.7828131261341, 487.3344733882594, 507.98489226811284, 428.4605729756945, 437.4506988195992, 685.5205046100294, 333.4847740429558, 443.109907610122, 567.6137221899077, 483.29807395381715, 577.4140540228594, 490.9178701730163, 625.6933088857072, 560.6575787929806, 530.3266217971371, 513.5373586366632, 592.2140787759506, 579.6397137795633, 488.1533318011798, 415.5117185882725, 507.36177150649803, 464.75380211744454, 629.1391021411695, 489.97831653169925, 620.4952439319126, 453.0447790426101, 434.88007390130184, 508.9982958292983, 485.45308717903583, 474.5724697099459, 398.2554704455769, 625.6910952769337, 517.9032601720041, 567.4006083404648, 568.6610972752799, 536.6897557234729, 352.93186299240097, 469.74899484008444], "policy_predator_policy_reward": [282.4702627975692, 371.19777869418675, 278.08318129714434, 419.15210150728973, 337.30808687879767, 317.81619415458954, 205.14200353815622, 133.76574033515232, 331.9545535106818, 414.66656870946395, 367.5538159619877, 279.06394758496145, 332.7047979947556, 356.2989257984712, 145.50980641383347, 188.39090744089938, 329.4769017355444, 194.22831299418897, 234.48217986446, 340.01612779054176, 446.3351251106915, 408.02528944435693, 316.96619221559195, 339.05029967451236, 343.5686739038657, 421.4413236835829, 441.908181231615, 364.64268290852937, 380.92915536157614, 303.8052271372168, 443.405424612221, 470.57546012318875, 383.6493293030711, 370.5700131426172, 218.6534239156627, 118.0792521450658, 422.4687616611731, 375.42836956235186, 336.5662654380362, 339.4864475301903, 310.2054708995516, 354.6148277814782, 349.21302592688943, 310.2478696358877, 325.4966098642354, 259.4283907377776, 254.82684489167966, 262.44665110273564, 375.5216106103044, 383.60707802274237, 365.84137693864636, 467.43978640096554, 263.13031175728804, 302.90477148244935, 280.68757056111497, 280.6404291226185, 258.34672746585494, 236.4120680391648, 281.292896777692, 264.83544364765925, 367.976751511483, 420.9688850797615, 253.53329783271892, 70.97521811450505, 317.667810578748, 382.74701025643174, 352.48199939749253, 283.01698615927364, 175.00770220742166, 246.97781561042865, 179.25788616224744, 151.4929726848908, 338.78371532532793, 338.8662349962225, 510.1944175168308, 403.7795423870629, 417.505608721958, 419.09530014743484, 207.69287894132458, 264.4076951636146, 346.41947482958375, 348.5511560237848, 376.6423765037418, 345.60136853180154, 361.2261731970312, 386.11945978108656, 334.3413162163725, 296.6882717521354, 451.2625699274266, 393.5637399977065, 131.795024784603, 165.65021190010282, 90.68578596834882, 125.49626697660503, 361.20588344550276, 361.12652722612455, 398.9946996313281, 335.2697383842148, 361.6173544891618, 199.0630668521245, 268.45164851897937, 330.9721722927786, 462.7304558652035, 349.33706042658036, 322.9785004459028, 324.4099871957549, 348.7347141473808, 362.3945560466189, 309.4698112191623, 357.11927958248015, 344.28787733145214, 381.26361817380047, 358.1538411371697, 380.92755427194476, 182.58495984366203, 203.111778664512, 389.0764541367423, 431.5784956955325, 538.4301608637903, 530.1892279680211, 343.8391715093787, 286.0157288821056, 557.7297116388218, 527.7566341668937, 253.1610406408643, 139.95148145906631, 422.52214415592016, 463.1647648392468, 343.9137331542345, 414.26154467333305, 243.1115136040212, 391.14712162415725, 367.537463136589, 356.62260742451133, 314.3584361677563, 247.60957278687795, 357.0197541707439, 429.98298600092994, 305.36749896801604, 403.9563955155882, 208.9576873797708, 259.09668858347624, 440.55109519724544, 412.66338451648545, 338.5376573658203, 278.16983715695926, 246.59679618089723, 543.2565427127266, 492.1527140005944, 367.4041444441013, 401.83466810899773, 266.3365995756655, 281.59104867793906, 258.12774727941587, 302.414770226693, 241.27760699015602, 136.47472876184145, 321.83178075498034, 372.2486474033292, 283.036508265597, 425.74628777579875, 392.4159967612184, 103.15868888081273, 96.98773405931931, 427.8178886573017, 580.5777939133742, 177.52881607009567, 192.7208030180351, 77.95100670494834, 111.48998050343464, 313.1839843331258, 271.825372339085, 285.7269841162567, 258.90607999149944, 230.82614458680536, 155.31112419548558, 448.5160402354445, 435.15094565404405, 180.16193875549894, 118.8961340823704, 326.50489305207043, 333.1506199578306, 491.84971859302743, 492.7798368488494, 285.62082997423244, 414.9795248722399, 437.3825611476234, 433.2640698232814, 392.29978320899323, 353.55426715673855, 441.3708663977586, 496.34265475252494, 435.6807727041075, 482.69325209570167, 326.3520458379568, 283.6707207672797, 190.96778479834177, 171.76912370502643, 345.9675051830578, 429.6169109496036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8482164052478766, "mean_inference_ms": 2.470459418208873, "mean_action_processing_ms": 0.34611550312823924, "mean_env_wait_ms": 0.3136961170306838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008259892463684082, "StateBufferConnector_ms": 0.004379630088806152, "ViewRequirementAgentConnector_ms": 0.14150726795196533}, "num_episodes": 27, "episode_return_max": 2062.9279395405433, "episode_return_min": 966.0356688614609, "episode_return_mean": 1707.2011180017666, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.6670325507369, "num_env_steps_trained_throughput_per_sec": 238.6670325507369, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 14130.268, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14130.223, "sample_time_ms": 1938.822, "learn_time_ms": 12171.628, "learn_throughput": 328.633, "synch_weights_time_ms": 17.617}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "8abce_00000", "date": "2024-08-16_11-26-45", "timestamp": 1723787805, "time_this_iter_s": 16.809388637542725, "time_total_s": 317.5551264286041, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4337160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 317.5551264286041, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 87.25, "ram_util_percent": 80.64166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6262585750332585, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.613868897554106, "policy_loss": 0.0011332188306681851, "vf_loss": 9.61097941524768, "vf_explained_var": -0.052269057937400054, "kl": 0.017562586046389973, "entropy": 1.421949834609158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8044710643392392, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.521677291204059, "policy_loss": -0.006839347347646715, "vf_loss": 9.526228173573811, "vf_explained_var": -0.021951239828079467, "kl": 0.011442236655328064, "entropy": 1.358066305912361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 2062.9279395405433, "episode_reward_min": 966.0356688614609, "episode_reward_mean": 1674.5361425312897, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 290.25747971595075, "predator_policy": 48.55676365626258}, "policy_reward_max": {"prey_policy": 711.4323543974812, "predator_policy": 580.5777939133742}, "policy_reward_mean": {"prey_policy": 516.906630323789, "predator_policy": 320.36144094185596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1687.2122444583133, 1666.6432868694571, 1711.245844418697, 1896.9558956998824, 1638.2480245972909, 1703.2457268721562, 1888.844649525285, 1796.1029688341594, 1767.0636011919778, 1844.9563046668063, 1443.2731760871272, 1736.9954977878642, 1843.042263819829, 1436.398844038521, 1757.0158372530818, 1871.1982007901079, 1436.6392420382867, 1338.713521425337, 1868.5531458695064, 2053.316438902253, 1826.416692776779, 1583.6906466385594, 1694.1971540667134, 1745.617569872704, 1830.4923344583028, 1741.3552126144386, 1837.9500555844877, 1456.3227236384125, 1230.1441227404266, 1659.820424641707, 1894.546919026727, 1724.4783536782152, 1571.3101662867473, 1870.2451019988787, 1781.8199504871204, 1669.2320362144437, 1590.055345275658, 1607.0390526890646, 1646.4604518153428, 1367.9133525187333, 1778.4279080797628, 2062.9279395405433, 1824.129140539334, 2027.018195705696, 1611.1967112672373, 1852.936424244016, 1805.7108992806377, 1619.5869159997496, 1827.100452857258, 1675.6820555558159, 1774.0103247073155, 1741.9285381622826, 1406.4767817652466, 1718.7971639238024, 1684.0953475478136, 1658.1977103571166, 1890.2688448161757, 1692.1737468698084, 1535.115143055011, 1818.1340133040403, 1624.4967399496056, 1551.8646530475671, 1941.604593911679, 992.2637094545248, 1944.8411478144824, 1493.2208225177576, 966.0356688614609, 1635.9211528159378, 1612.9649883036316, 1572.4881564609814, 1927.5309663232879, 1470.9118653933824, 1563.3205633993532, 1956.74512906582, 1819.7177735193409, 1944.186653945428, 1689.7324200963308, 1897.7390780392655, 1942.320590522318, 1695.3266351177044, 1468.087761502119, 1598.2652739651471, 1761.7671142057934, 1526.3002657834625, 1244.4261208537189, 1420.0427040686689, 1834.6214203837883, 1280.0066141074294, 971.2205704650896, 1449.3234704126946, 1978.1643450107583, 1798.642076333226, 1461.4241234283309, 1599.5742367910846, 1776.184459257424, 1806.7639758984571, 1262.0243331007666, 1759.4699514702497, 1974.7200458092248, 1520.6654419736121], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [370.95978180968285, 518.3553314251081, 477.19513460504703, 513.3954392961822, 510.96034821080764, 535.4651975268604, 577.442805517777, 660.0521946193293, 539.9952993856805, 513.3277246095993, 620.5198351224252, 565.4523957553148, 587.5090852512869, 542.2068756409507, 435.24856410363765, 527.5732413909094, 580.2392168712039, 620.7893010810357, 671.1760160948731, 612.4522888881988, 514.0459499917204, 434.46843059038684, 665.2564821948616, 525.6106751676538, 526.5491555928468, 527.5474716357375, 523.7375142293131, 588.1528138619841, 484.4249123337699, 572.176104084133, 692.6579475105157, 543.0412677228279, 502.80861811272655, 511.8451061077099, 563.752500969587, 444.2101616086108, 561.6472328279935, 629.2559627199621, 588.8684141669551, 550.4740648314062, 593.7256404824519, 396.0901434249358, 593.8823522170077, 517.7077203166123, 491.70264007803115, 507.52388313531384, 578.6064512176351, 444.76737361952735, 481.7217209975687, 601.4249804826171, 521.4713729794523, 588.8542516664797, 502.1966474726563, 490.9270981866964, 601.0270268119776, 557.8504601417274, 711.4323543974812, 302.52971539799177, 569.3487726512767, 368.13924131880265, 599.297930011228, 560.9845509999566, 572.3576311583813, 591.4403011785471, 523.4490099588063, 448.43733551618374, 488.6022885959826, 569.5752971111118, 662.0110838193543, 472.4203790261082, 570.8436163507499, 387.2591496696938, 415.92287309700913, 507.5433813770067, 425.6684061846796, 455.8191509991317, 440.49992744004027, 466.8791289661883, 360.9990108562296, 621.2176031543305, 470.199407735632, 487.5735505118572, 477.82011928415693, 516.4884314245782, 626.4794045722649, 567.7948355755846, 449.4440673804863, 492.08778251949224, 561.5885740791585, 656.4956150881471, 462.01946835389396, 505.2300468949539, 443.7489966492055, 603.7866248038658, 452.4529918154606, 532.8752889561089, 528.5028735639204, 574.4375087322356, 540.7872113034047, 572.9268352977775, 449.4810119297644, 537.526572605877, 475.02648915405024, 557.5781545246291, 517.3295881148538, 421.09281768714607, 404.42015934641825, 461.1625248636513, 627.0064714495664, 440.3813815754673, 449.25845767667795, 419.08591378681535, 453.86623072876614, 576.8457556427148, 502.68795079873047, 521.3145283864138, 526.963164465207, 468.433182632449, 609.3682554708879, 665.0733806163037, 566.2024228679727, 599.9878075648091, 425.99385356856044, 470.58564381008165, 533.5611456515053, 589.8811637231561, 304.7828131261341, 487.3344733882594, 507.98489226811284, 428.4605729756945, 437.4506988195992, 685.5205046100294, 333.4847740429558, 443.109907610122, 567.6137221899077, 483.29807395381715, 577.4140540228594, 490.9178701730163, 625.6933088857072, 560.6575787929806, 530.3266217971371, 513.5373586366632, 592.2140787759506, 579.6397137795633, 488.1533318011798, 415.5117185882725, 507.36177150649803, 464.75380211744454, 629.1391021411695, 489.97831653169925, 620.4952439319126, 453.0447790426101, 434.88007390130184, 508.9982958292983, 485.45308717903583, 474.5724697099459, 398.2554704455769, 625.6910952769337, 517.9032601720041, 567.4006083404648, 568.6610972752799, 536.6897557234729, 352.93186299240097, 469.74899484008444, 617.8973185642759, 555.5744471714795, 518.4445466918088, 526.8825579584734, 417.73531312962564, 290.25747971595075, 464.13503269219433, 512.1995607421086, 504.06539955910836, 463.69839573094197, 529.2924253627208, 491.2861152614233, 411.1076240939567, 440.5070554842045, 415.0717153472268, 509.68180522041087, 451.1206626579143, 582.2605368529084, 447.38203046958154, 557.5623791709412, 299.1968507534732, 561.6835202595179, 586.7916569227478, 526.0485450790725, 552.4266834139703, 555.9649585269435, 529.8206211020434, 553.3386982321849, 395.37487370951186, 500.3553860223184, 643.9693240713094, 502.5243099775954, 463.5198168869738, 577.4191530847547, 495.0700165607885, 486.7356639640047], "policy_predator_policy_reward": [422.4687616611731, 375.42836956235186, 336.5662654380362, 339.4864475301903, 310.2054708995516, 354.6148277814782, 349.21302592688943, 310.2478696358877, 325.4966098642354, 259.4283907377776, 254.82684489167966, 262.44665110273564, 375.5216106103044, 383.60707802274237, 365.84137693864636, 467.43978640096554, 263.13031175728804, 302.90477148244935, 280.68757056111497, 280.6404291226185, 258.34672746585494, 236.4120680391648, 281.292896777692, 264.83544364765925, 367.976751511483, 420.9688850797615, 253.53329783271892, 70.97521811450505, 317.667810578748, 382.74701025643174, 352.48199939749253, 283.01698615927364, 175.00770220742166, 246.97781561042865, 179.25788616224744, 151.4929726848908, 338.78371532532793, 338.8662349962225, 510.1944175168308, 403.7795423870629, 417.505608721958, 419.09530014743484, 207.69287894132458, 264.4076951636146, 346.41947482958375, 348.5511560237848, 376.6423765037418, 345.60136853180154, 361.2261731970312, 386.11945978108656, 334.3413162163725, 296.6882717521354, 451.2625699274266, 393.5637399977065, 131.795024784603, 165.65021190010282, 90.68578596834882, 125.49626697660503, 361.20588344550276, 361.12652722612455, 398.9946996313281, 335.2697383842148, 361.6173544891618, 199.0630668521245, 268.45164851897937, 330.9721722927786, 462.7304558652035, 349.33706042658036, 322.9785004459028, 324.4099871957549, 348.7347141473808, 362.3945560466189, 309.4698112191623, 357.11927958248015, 344.28787733145214, 381.26361817380047, 358.1538411371697, 380.92755427194476, 182.58495984366203, 203.111778664512, 389.0764541367423, 431.5784956955325, 538.4301608637903, 530.1892279680211, 343.8391715093787, 286.0157288821056, 557.7297116388218, 527.7566341668937, 253.1610406408643, 139.95148145906631, 422.52214415592016, 463.1647648392468, 343.9137331542345, 414.26154467333305, 243.1115136040212, 391.14712162415725, 367.537463136589, 356.62260742451133, 314.3584361677563, 247.60957278687795, 357.0197541707439, 429.98298600092994, 305.36749896801604, 403.9563955155882, 208.9576873797708, 259.09668858347624, 440.55109519724544, 412.66338451648545, 338.5376573658203, 278.16983715695926, 246.59679618089723, 543.2565427127266, 492.1527140005944, 367.4041444441013, 401.83466810899773, 266.3365995756655, 281.59104867793906, 258.12774727941587, 302.414770226693, 241.27760699015602, 136.47472876184145, 321.83178075498034, 372.2486474033292, 283.036508265597, 425.74628777579875, 392.4159967612184, 103.15868888081273, 96.98773405931931, 427.8178886573017, 580.5777939133742, 177.52881607009567, 192.7208030180351, 77.95100670494834, 111.48998050343464, 313.1839843331258, 271.825372339085, 285.7269841162567, 258.90607999149944, 230.82614458680536, 155.31112419548558, 448.5160402354445, 435.15094565404405, 180.16193875549894, 118.8961340823704, 326.50489305207043, 333.1506199578306, 491.84971859302743, 492.7798368488494, 285.62082997423244, 414.9795248722399, 437.3825611476234, 433.2640698232814, 392.29978320899323, 353.55426715673855, 441.3708663977586, 496.34265475252494, 435.6807727041075, 482.69325209570167, 326.3520458379568, 283.6707207672797, 190.96778479834177, 171.76912370502643, 345.9675051830578, 429.6169109496036, 319.14947938273815, 269.14586908730064, 236.25535467907056, 244.71780645410985, 238.02025707169662, 298.4130709364454, 227.73147794483296, 215.97663268953383, 394.62047780826657, 472.23714728547145, 149.270512418737, 110.1575610645485, 71.04912723066634, 48.55676365626258, 267.4425326761322, 257.12741716892594, 448.8365275255905, 495.9466179743452, 425.1625811232062, 368.5350855694983, 326.5523834121273, 273.9913690032126, 161.21959055521683, 325.5144442340481, 330.9597141240442, 336.83310319246704, 302.9081239538254, 420.69653261040327, 181.3115182073833, 184.98255516155317, 301.7809658371516, 311.1953515841946, 438.86754856604654, 494.9135272714496, 259.5888626865126, 279.2708987623068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8435720506950939, "mean_inference_ms": 2.468372624665911, "mean_action_processing_ms": 0.3437136764997161, "mean_env_wait_ms": 0.31201818669217674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007988691329956055, "StateBufferConnector_ms": 0.004122257232666016, "ViewRequirementAgentConnector_ms": 0.12700915336608887}, "num_episodes": 18, "episode_return_max": 2062.9279395405433, "episode_return_min": 966.0356688614609, "episode_return_mean": 1674.5361425312897, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.7438091178476, "num_env_steps_trained_throughput_per_sec": 289.7438091178476, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 14064.796, "restore_workers_time_ms": 0.012, "training_step_time_ms": 14064.751, "sample_time_ms": 1834.457, "learn_time_ms": 12211.198, "learn_throughput": 327.568, "synch_weights_time_ms": 16.883}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "8abce_00000", "date": "2024-08-16_11-26-59", "timestamp": 1723787819, "time_this_iter_s": 13.855217933654785, "time_total_s": 331.4103443622589, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a436b700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 331.4103443622589, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 57.179999999999986, "ram_util_percent": 82.63000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7517000712572581, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.42378790113661, "policy_loss": -0.00517303230778053, "vf_loss": 9.427226666041783, "vf_explained_var": -0.051761164267857866, "kl": 0.017342676987204122, "entropy": 1.4240859166024222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8355209458284276, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.577331218013057, "policy_loss": -0.0041330718787672815, "vf_loss": 9.579711980668325, "vf_explained_var": -0.009423429120785344, "kl": 0.008761545568393873, "entropy": 1.3385337754532143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 2124.6604913226406, "episode_reward_min": 966.0356688614609, "episode_reward_mean": 1673.952959191939, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 245.893680318196, "predator_policy": 48.55676365626258}, "policy_reward_max": {"prey_policy": 722.9458244762018, "predator_policy": 580.5777939133742}, "policy_reward_mean": {"prey_policy": 508.8460892164451, "predator_policy": 328.1303903795246}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1868.5531458695064, 2053.316438902253, 1826.416692776779, 1583.6906466385594, 1694.1971540667134, 1745.617569872704, 1830.4923344583028, 1741.3552126144386, 1837.9500555844877, 1456.3227236384125, 1230.1441227404266, 1659.820424641707, 1894.546919026727, 1724.4783536782152, 1571.3101662867473, 1870.2451019988787, 1781.8199504871204, 1669.2320362144437, 1590.055345275658, 1607.0390526890646, 1646.4604518153428, 1367.9133525187333, 1778.4279080797628, 2062.9279395405433, 1824.129140539334, 2027.018195705696, 1611.1967112672373, 1852.936424244016, 1805.7108992806377, 1619.5869159997496, 1827.100452857258, 1675.6820555558159, 1774.0103247073155, 1741.9285381622826, 1406.4767817652466, 1718.7971639238024, 1684.0953475478136, 1658.1977103571166, 1890.2688448161757, 1692.1737468698084, 1535.115143055011, 1818.1340133040403, 1624.4967399496056, 1551.8646530475671, 1941.604593911679, 992.2637094545248, 1944.8411478144824, 1493.2208225177576, 966.0356688614609, 1635.9211528159378, 1612.9649883036316, 1572.4881564609814, 1927.5309663232879, 1470.9118653933824, 1563.3205633993532, 1956.74512906582, 1819.7177735193409, 1944.186653945428, 1689.7324200963308, 1897.7390780392655, 1942.320590522318, 1695.3266351177044, 1468.087761502119, 1598.2652739651471, 1761.7671142057934, 1526.3002657834625, 1244.4261208537189, 1420.0427040686689, 1834.6214203837883, 1280.0066141074294, 971.2205704650896, 1449.3234704126946, 1978.1643450107583, 1798.642076333226, 1461.4241234283309, 1599.5742367910846, 1776.184459257424, 1806.7639758984571, 1262.0243331007666, 1759.4699514702497, 1974.7200458092248, 1520.6654419736121, 1697.303685878677, 1623.9537966571313, 1627.8604515520008, 1556.8299790737578, 1593.2638230487123, 1538.6587885938297, 1462.8376191949199, 1451.4076742972031, 1987.3518829197674, 2124.6604913226406, 1973.4768811384943, 1738.4702630561371, 1675.617928758472, 2056.018212652018, 1528.125364247072, 1668.6909553762207, 1813.22994916382, 1287.7190495082605], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [561.6472328279935, 629.2559627199621, 588.8684141669551, 550.4740648314062, 593.7256404824519, 396.0901434249358, 593.8823522170077, 517.7077203166123, 491.70264007803115, 507.52388313531384, 578.6064512176351, 444.76737361952735, 481.7217209975687, 601.4249804826171, 521.4713729794523, 588.8542516664797, 502.1966474726563, 490.9270981866964, 601.0270268119776, 557.8504601417274, 711.4323543974812, 302.52971539799177, 569.3487726512767, 368.13924131880265, 599.297930011228, 560.9845509999566, 572.3576311583813, 591.4403011785471, 523.4490099588063, 448.43733551618374, 488.6022885959826, 569.5752971111118, 662.0110838193543, 472.4203790261082, 570.8436163507499, 387.2591496696938, 415.92287309700913, 507.5433813770067, 425.6684061846796, 455.8191509991317, 440.49992744004027, 466.8791289661883, 360.9990108562296, 621.2176031543305, 470.199407735632, 487.5735505118572, 477.82011928415693, 516.4884314245782, 626.4794045722649, 567.7948355755846, 449.4440673804863, 492.08778251949224, 561.5885740791585, 656.4956150881471, 462.01946835389396, 505.2300468949539, 443.7489966492055, 603.7866248038658, 452.4529918154606, 532.8752889561089, 528.5028735639204, 574.4375087322356, 540.7872113034047, 572.9268352977775, 449.4810119297644, 537.526572605877, 475.02648915405024, 557.5781545246291, 517.3295881148538, 421.09281768714607, 404.42015934641825, 461.1625248636513, 627.0064714495664, 440.3813815754673, 449.25845767667795, 419.08591378681535, 453.86623072876614, 576.8457556427148, 502.68795079873047, 521.3145283864138, 526.963164465207, 468.433182632449, 609.3682554708879, 665.0733806163037, 566.2024228679727, 599.9878075648091, 425.99385356856044, 470.58564381008165, 533.5611456515053, 589.8811637231561, 304.7828131261341, 487.3344733882594, 507.98489226811284, 428.4605729756945, 437.4506988195992, 685.5205046100294, 333.4847740429558, 443.109907610122, 567.6137221899077, 483.29807395381715, 577.4140540228594, 490.9178701730163, 625.6933088857072, 560.6575787929806, 530.3266217971371, 513.5373586366632, 592.2140787759506, 579.6397137795633, 488.1533318011798, 415.5117185882725, 507.36177150649803, 464.75380211744454, 629.1391021411695, 489.97831653169925, 620.4952439319126, 453.0447790426101, 434.88007390130184, 508.9982958292983, 485.45308717903583, 474.5724697099459, 398.2554704455769, 625.6910952769337, 517.9032601720041, 567.4006083404648, 568.6610972752799, 536.6897557234729, 352.93186299240097, 469.74899484008444, 617.8973185642759, 555.5744471714795, 518.4445466918088, 526.8825579584734, 417.73531312962564, 290.25747971595075, 464.13503269219433, 512.1995607421086, 504.06539955910836, 463.69839573094197, 529.2924253627208, 491.2861152614233, 411.1076240939567, 440.5070554842045, 415.0717153472268, 509.68180522041087, 451.1206626579143, 582.2605368529084, 447.38203046958154, 557.5623791709412, 299.1968507534732, 561.6835202595179, 586.7916569227478, 526.0485450790725, 552.4266834139703, 555.9649585269435, 529.8206211020434, 553.3386982321849, 395.37487370951186, 500.3553860223184, 643.9693240713094, 502.5243099775954, 463.5198168869738, 577.4191530847547, 495.0700165607885, 486.7356639640047, 412.0291747311688, 377.6803788522886, 528.1975884174566, 388.67305177068914, 450.0751959923078, 485.0114080393677, 670.5796981663041, 427.2868994642472, 532.1763119648875, 559.8944637112037, 245.893680318196, 432.94975064143665, 590.9248276600681, 478.5548444862927, 619.409529835279, 344.70701603865336, 573.2425556463774, 403.1540472885987, 722.9458244762018, 431.0614009154324, 506.49695003405327, 678.4049466452601, 679.6133369733066, 553.794086252704, 535.2339466723599, 432.197945821295, 633.9262110854049, 541.614499050213, 496.0865537896459, 460.54870031234435, 510.6836134757518, 484.2515652209461, 457.9355774758695, 372.3641769786938, 596.1110501356279, 374.7821591115832], "policy_predator_policy_reward": [338.78371532532793, 338.8662349962225, 510.1944175168308, 403.7795423870629, 417.505608721958, 419.09530014743484, 207.69287894132458, 264.4076951636146, 346.41947482958375, 348.5511560237848, 376.6423765037418, 345.60136853180154, 361.2261731970312, 386.11945978108656, 334.3413162163725, 296.6882717521354, 451.2625699274266, 393.5637399977065, 131.795024784603, 165.65021190010282, 90.68578596834882, 125.49626697660503, 361.20588344550276, 361.12652722612455, 398.9946996313281, 335.2697383842148, 361.6173544891618, 199.0630668521245, 268.45164851897937, 330.9721722927786, 462.7304558652035, 349.33706042658036, 322.9785004459028, 324.4099871957549, 348.7347141473808, 362.3945560466189, 309.4698112191623, 357.11927958248015, 344.28787733145214, 381.26361817380047, 358.1538411371697, 380.92755427194476, 182.58495984366203, 203.111778664512, 389.0764541367423, 431.5784956955325, 538.4301608637903, 530.1892279680211, 343.8391715093787, 286.0157288821056, 557.7297116388218, 527.7566341668937, 253.1610406408643, 139.95148145906631, 422.52214415592016, 463.1647648392468, 343.9137331542345, 414.26154467333305, 243.1115136040212, 391.14712162415725, 367.537463136589, 356.62260742451133, 314.3584361677563, 247.60957278687795, 357.0197541707439, 429.98298600092994, 305.36749896801604, 403.9563955155882, 208.9576873797708, 259.09668858347624, 440.55109519724544, 412.66338451648545, 338.5376573658203, 278.16983715695926, 246.59679618089723, 543.2565427127266, 492.1527140005944, 367.4041444441013, 401.83466810899773, 266.3365995756655, 281.59104867793906, 258.12774727941587, 302.414770226693, 241.27760699015602, 136.47472876184145, 321.83178075498034, 372.2486474033292, 283.036508265597, 425.74628777579875, 392.4159967612184, 103.15868888081273, 96.98773405931931, 427.8178886573017, 580.5777939133742, 177.52881607009567, 192.7208030180351, 77.95100670494834, 111.48998050343464, 313.1839843331258, 271.825372339085, 285.7269841162567, 258.90607999149944, 230.82614458680536, 155.31112419548558, 448.5160402354445, 435.15094565404405, 180.16193875549894, 118.8961340823704, 326.50489305207043, 333.1506199578306, 491.84971859302743, 492.7798368488494, 285.62082997423244, 414.9795248722399, 437.3825611476234, 433.2640698232814, 392.29978320899323, 353.55426715673855, 441.3708663977586, 496.34265475252494, 435.6807727041075, 482.69325209570167, 326.3520458379568, 283.6707207672797, 190.96778479834177, 171.76912370502643, 345.9675051830578, 429.6169109496036, 319.14947938273815, 269.14586908730064, 236.25535467907056, 244.71780645410985, 238.02025707169662, 298.4130709364454, 227.73147794483296, 215.97663268953383, 394.62047780826657, 472.23714728547145, 149.270512418737, 110.1575610645485, 71.04912723066634, 48.55676365626258, 267.4425326761322, 257.12741716892594, 448.8365275255905, 495.9466179743452, 425.1625811232062, 368.5350855694983, 326.5523834121273, 273.9913690032126, 161.21959055521683, 325.5144442340481, 330.9597141240442, 336.83310319246704, 302.9081239538254, 420.69653261040327, 181.3115182073833, 184.98255516155317, 301.7809658371516, 311.1953515841946, 438.86754856604654, 494.9135272714496, 259.5888626865126, 279.2708987623068, 446.6837091690143, 460.91042312620453, 362.6551734621509, 344.427983006836, 399.692294106257, 293.0815534140668, 213.28490722313106, 245.67847422007708, 275.7023729850596, 225.4906743875622, 410.4631765457692, 449.35218108842815, 197.08951200121567, 196.268435047344, 223.7722593031209, 263.5188691201495, 477.2144578812176, 533.7408221035738, 487.84457150662394, 482.80869442438296, 476.97340058092124, 311.60158387825874, 322.3873900133764, 182.67544981674982, 294.6442999891451, 413.5417362756733, 456.85704062197954, 423.62046189441844, 269.26061318120554, 302.22949696387724, 272.3499814941014, 401.40579518541836, 468.30044414356087, 514.6297505656975, 237.01312830880647, 79.81271195224338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8427875589958296, "mean_inference_ms": 2.476339297071265, "mean_action_processing_ms": 0.35345071951013723, "mean_env_wait_ms": 0.31158903726104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008505940437316895, "StateBufferConnector_ms": 0.0039424896240234375, "ViewRequirementAgentConnector_ms": 0.16891396045684814}, "num_episodes": 18, "episode_return_max": 2124.6604913226406, "episode_return_min": 966.0356688614609, "episode_return_mean": 1673.952959191939, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.76522037430726, "num_env_steps_trained_throughput_per_sec": 267.76522037430726, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 14312.454, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14312.405, "sample_time_ms": 2010.391, "learn_time_ms": 12282.54, "learn_throughput": 325.666, "synch_weights_time_ms": 17.037}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "8abce_00000", "date": "2024-08-16_11-27-14", "timestamp": 1723787834, "time_this_iter_s": 15.034300088882446, "time_total_s": 346.44464445114136, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 346.44464445114136, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 61.276190476190486, "ram_util_percent": 82.44285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7070570814152244, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.42989076029056, "policy_loss": -0.002460877494467669, "vf_loss": 9.431312834018122, "vf_explained_var": -0.03227264064329642, "kl": 0.010387921378832578, "entropy": 1.401628098096797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0059577523400542, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.45948082101408, "policy_loss": -0.0019413261930581439, "vf_loss": 9.459928638216049, "vf_explained_var": -0.018043009787009505, "kl": 0.007467554175701241, "entropy": 1.3381502680677586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 2124.6604913226406, "episode_reward_min": 872.2152560435788, "episode_reward_mean": 1637.0522457173722, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 245.893680318196, "predator_policy": 21.015193025933254}, "policy_reward_max": {"prey_policy": 737.2255607696367, "predator_policy": 580.5777939133742}, "policy_reward_mean": {"prey_policy": 504.0449264648923, "predator_policy": 314.48119639379394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1590.055345275658, 1607.0390526890646, 1646.4604518153428, 1367.9133525187333, 1778.4279080797628, 2062.9279395405433, 1824.129140539334, 2027.018195705696, 1611.1967112672373, 1852.936424244016, 1805.7108992806377, 1619.5869159997496, 1827.100452857258, 1675.6820555558159, 1774.0103247073155, 1741.9285381622826, 1406.4767817652466, 1718.7971639238024, 1684.0953475478136, 1658.1977103571166, 1890.2688448161757, 1692.1737468698084, 1535.115143055011, 1818.1340133040403, 1624.4967399496056, 1551.8646530475671, 1941.604593911679, 992.2637094545248, 1944.8411478144824, 1493.2208225177576, 966.0356688614609, 1635.9211528159378, 1612.9649883036316, 1572.4881564609814, 1927.5309663232879, 1470.9118653933824, 1563.3205633993532, 1956.74512906582, 1819.7177735193409, 1944.186653945428, 1689.7324200963308, 1897.7390780392655, 1942.320590522318, 1695.3266351177044, 1468.087761502119, 1598.2652739651471, 1761.7671142057934, 1526.3002657834625, 1244.4261208537189, 1420.0427040686689, 1834.6214203837883, 1280.0066141074294, 971.2205704650896, 1449.3234704126946, 1978.1643450107583, 1798.642076333226, 1461.4241234283309, 1599.5742367910846, 1776.184459257424, 1806.7639758984571, 1262.0243331007666, 1759.4699514702497, 1974.7200458092248, 1520.6654419736121, 1697.303685878677, 1623.9537966571313, 1627.8604515520008, 1556.8299790737578, 1593.2638230487123, 1538.6587885938297, 1462.8376191949199, 1451.4076742972031, 1987.3518829197674, 2124.6604913226406, 1973.4768811384943, 1738.4702630561371, 1675.617928758472, 2056.018212652018, 1528.125364247072, 1668.6909553762207, 1813.22994916382, 1287.7190495082605, 872.2152560435788, 1535.950234747619, 1314.8999664491037, 1482.166921440514, 1608.3354179785895, 1410.1136000200063, 1779.4389174491207, 1766.5148331967966, 970.3483371957772, 1660.8819742484543, 1988.0848449959087, 1859.1696912413274, 1466.021928464795, 1726.874480125564, 1218.9685665587174, 1282.5371254219513, 1680.5543904952856, 1726.3612159666218], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [415.92287309700913, 507.5433813770067, 425.6684061846796, 455.8191509991317, 440.49992744004027, 466.8791289661883, 360.9990108562296, 621.2176031543305, 470.199407735632, 487.5735505118572, 477.82011928415693, 516.4884314245782, 626.4794045722649, 567.7948355755846, 449.4440673804863, 492.08778251949224, 561.5885740791585, 656.4956150881471, 462.01946835389396, 505.2300468949539, 443.7489966492055, 603.7866248038658, 452.4529918154606, 532.8752889561089, 528.5028735639204, 574.4375087322356, 540.7872113034047, 572.9268352977775, 449.4810119297644, 537.526572605877, 475.02648915405024, 557.5781545246291, 517.3295881148538, 421.09281768714607, 404.42015934641825, 461.1625248636513, 627.0064714495664, 440.3813815754673, 449.25845767667795, 419.08591378681535, 453.86623072876614, 576.8457556427148, 502.68795079873047, 521.3145283864138, 526.963164465207, 468.433182632449, 609.3682554708879, 665.0733806163037, 566.2024228679727, 599.9878075648091, 425.99385356856044, 470.58564381008165, 533.5611456515053, 589.8811637231561, 304.7828131261341, 487.3344733882594, 507.98489226811284, 428.4605729756945, 437.4506988195992, 685.5205046100294, 333.4847740429558, 443.109907610122, 567.6137221899077, 483.29807395381715, 577.4140540228594, 490.9178701730163, 625.6933088857072, 560.6575787929806, 530.3266217971371, 513.5373586366632, 592.2140787759506, 579.6397137795633, 488.1533318011798, 415.5117185882725, 507.36177150649803, 464.75380211744454, 629.1391021411695, 489.97831653169925, 620.4952439319126, 453.0447790426101, 434.88007390130184, 508.9982958292983, 485.45308717903583, 474.5724697099459, 398.2554704455769, 625.6910952769337, 517.9032601720041, 567.4006083404648, 568.6610972752799, 536.6897557234729, 352.93186299240097, 469.74899484008444, 617.8973185642759, 555.5744471714795, 518.4445466918088, 526.8825579584734, 417.73531312962564, 290.25747971595075, 464.13503269219433, 512.1995607421086, 504.06539955910836, 463.69839573094197, 529.2924253627208, 491.2861152614233, 411.1076240939567, 440.5070554842045, 415.0717153472268, 509.68180522041087, 451.1206626579143, 582.2605368529084, 447.38203046958154, 557.5623791709412, 299.1968507534732, 561.6835202595179, 586.7916569227478, 526.0485450790725, 552.4266834139703, 555.9649585269435, 529.8206211020434, 553.3386982321849, 395.37487370951186, 500.3553860223184, 643.9693240713094, 502.5243099775954, 463.5198168869738, 577.4191530847547, 495.0700165607885, 486.7356639640047, 412.0291747311688, 377.6803788522886, 528.1975884174566, 388.67305177068914, 450.0751959923078, 485.0114080393677, 670.5796981663041, 427.2868994642472, 532.1763119648875, 559.8944637112037, 245.893680318196, 432.94975064143665, 590.9248276600681, 478.5548444862927, 619.409529835279, 344.70701603865336, 573.2425556463774, 403.1540472885987, 722.9458244762018, 431.0614009154324, 506.49695003405327, 678.4049466452601, 679.6133369733066, 553.794086252704, 535.2339466723599, 432.197945821295, 633.9262110854049, 541.614499050213, 496.0865537896459, 460.54870031234435, 510.6836134757518, 484.2515652209461, 457.9355774758695, 372.3641769786938, 596.1110501356279, 374.7821591115832, 347.04241587518777, 387.53795556770604, 459.17376684640584, 578.4305753965463, 516.3372016020364, 484.86661946053647, 642.614728969445, 533.9134871506984, 666.7934831026073, 365.2250732251097, 436.1180064307072, 417.9406566231831, 652.8227614174423, 470.4750809772744, 474.732105191823, 550.2852067946678, 323.9388811587617, 575.9636003478752, 646.5906718344827, 529.2077856615591, 497.3452765252976, 436.4286271182536, 651.8350600948552, 499.0160465950754, 431.27941836933786, 629.2368425335552, 442.8693053856408, 590.7889433842744, 312.1325981029329, 522.8448086835365, 367.47460429954606, 737.2255607696367, 541.7496777618273, 496.74191912798625, 551.8116173610498, 468.8311748812407], "policy_predator_policy_reward": [309.4698112191623, 357.11927958248015, 344.28787733145214, 381.26361817380047, 358.1538411371697, 380.92755427194476, 182.58495984366203, 203.111778664512, 389.0764541367423, 431.5784956955325, 538.4301608637903, 530.1892279680211, 343.8391715093787, 286.0157288821056, 557.7297116388218, 527.7566341668937, 253.1610406408643, 139.95148145906631, 422.52214415592016, 463.1647648392468, 343.9137331542345, 414.26154467333305, 243.1115136040212, 391.14712162415725, 367.537463136589, 356.62260742451133, 314.3584361677563, 247.60957278687795, 357.0197541707439, 429.98298600092994, 305.36749896801604, 403.9563955155882, 208.9576873797708, 259.09668858347624, 440.55109519724544, 412.66338451648545, 338.5376573658203, 278.16983715695926, 246.59679618089723, 543.2565427127266, 492.1527140005944, 367.4041444441013, 401.83466810899773, 266.3365995756655, 281.59104867793906, 258.12774727941587, 302.414770226693, 241.27760699015602, 136.47472876184145, 321.83178075498034, 372.2486474033292, 283.036508265597, 425.74628777579875, 392.4159967612184, 103.15868888081273, 96.98773405931931, 427.8178886573017, 580.5777939133742, 177.52881607009567, 192.7208030180351, 77.95100670494834, 111.48998050343464, 313.1839843331258, 271.825372339085, 285.7269841162567, 258.90607999149944, 230.82614458680536, 155.31112419548558, 448.5160402354445, 435.15094565404405, 180.16193875549894, 118.8961340823704, 326.50489305207043, 333.1506199578306, 491.84971859302743, 492.7798368488494, 285.62082997423244, 414.9795248722399, 437.3825611476234, 433.2640698232814, 392.29978320899323, 353.55426715673855, 441.3708663977586, 496.34265475252494, 435.6807727041075, 482.69325209570167, 326.3520458379568, 283.6707207672797, 190.96778479834177, 171.76912370502643, 345.9675051830578, 429.6169109496036, 319.14947938273815, 269.14586908730064, 236.25535467907056, 244.71780645410985, 238.02025707169662, 298.4130709364454, 227.73147794483296, 215.97663268953383, 394.62047780826657, 472.23714728547145, 149.270512418737, 110.1575610645485, 71.04912723066634, 48.55676365626258, 267.4425326761322, 257.12741716892594, 448.8365275255905, 495.9466179743452, 425.1625811232062, 368.5350855694983, 326.5523834121273, 273.9913690032126, 161.21959055521683, 325.5144442340481, 330.9597141240442, 336.83310319246704, 302.9081239538254, 420.69653261040327, 181.3115182073833, 184.98255516155317, 301.7809658371516, 311.1953515841946, 438.86754856604654, 494.9135272714496, 259.5888626865126, 279.2708987623068, 446.6837091690143, 460.91042312620453, 362.6551734621509, 344.427983006836, 399.692294106257, 293.0815534140668, 213.28490722313106, 245.67847422007708, 275.7023729850596, 225.4906743875622, 410.4631765457692, 449.35218108842815, 197.08951200121567, 196.268435047344, 223.7722593031209, 263.5188691201495, 477.2144578812176, 533.7408221035738, 487.84457150662394, 482.80869442438296, 476.97340058092124, 311.60158387825874, 322.3873900133764, 182.67544981674982, 294.6442999891451, 413.5417362756733, 456.85704062197954, 423.62046189441844, 269.26061318120554, 302.22949696387724, 272.3499814941014, 401.40579518541836, 468.30044414356087, 514.6297505656975, 237.01312830880647, 79.81271195224338, 98.93622889860629, 38.698655702079265, 178.16760491144558, 320.17828759322157, 190.93269341197475, 122.76345197455629, 133.45200808224007, 172.18669723813002, 342.56907305161894, 233.74778859925394, 225.89926710850963, 330.1556698576072, 318.6138987867211, 337.5271762676839, 398.29051651429444, 343.2070046960117, 21.015193025933254, 49.43066266320735, 204.66918513247973, 280.4143316199346, 495.0596681977647, 559.2512731545941, 273.9653641004611, 434.3532204509363, 244.53378249651163, 160.97188506539052, 414.9178668837325, 278.29836447191553, 206.62192096593765, 177.3692388063111, 111.33964508564105, 66.49731526712698, 313.5286675869743, 328.5341260184964, 375.8142026696516, 329.90422105467894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8439040280105917, "mean_inference_ms": 2.490416419747183, "mean_action_processing_ms": 0.364266220655897, "mean_env_wait_ms": 0.3116895568353528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008891820907592773, "StateBufferConnector_ms": 0.003966927528381348, "ViewRequirementAgentConnector_ms": 0.16902732849121094}, "num_episodes": 18, "episode_return_max": 2124.6604913226406, "episode_return_min": 872.2152560435788, "episode_return_mean": 1637.0522457173722, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.91725355123464, "num_env_steps_trained_throughput_per_sec": 284.91725355123464, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 14373.104, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14373.053, "sample_time_ms": 2116.405, "learn_time_ms": 12236.187, "learn_throughput": 326.899, "synch_weights_time_ms": 17.358}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "8abce_00000", "date": "2024-08-16_11-27-29", "timestamp": 1723787849, "time_this_iter_s": 14.12085223197937, "time_total_s": 360.5654966831207, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433e0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 360.5654966831207, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 59.504761904761914, "ram_util_percent": 82.47619047619048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4509160723556918, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.751863656220612, "policy_loss": -0.003828633768070075, "vf_loss": 9.754247521092651, "vf_explained_var": -0.027323477261911623, "kl": 0.014447643415202677, "entropy": 1.3866920676180925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1827435188507907, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.40535020979624, "policy_loss": -0.0073001447387493, "vf_loss": 9.410412678390584, "vf_explained_var": -0.005055031479981841, "kl": 0.011188382385901922, "entropy": 1.3322817179891797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 2124.6604913226406, "episode_reward_min": 872.2152560435788, "episode_reward_mean": 1605.3099731053842, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 245.893680318196, "predator_policy": 21.015193025933254}, "policy_reward_max": {"prey_policy": 747.7641796547312, "predator_policy": 580.5777939133742}, "policy_reward_mean": {"prey_policy": 511.9728178831349, "predator_policy": 290.68216866955737}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1535.115143055011, 1818.1340133040403, 1624.4967399496056, 1551.8646530475671, 1941.604593911679, 992.2637094545248, 1944.8411478144824, 1493.2208225177576, 966.0356688614609, 1635.9211528159378, 1612.9649883036316, 1572.4881564609814, 1927.5309663232879, 1470.9118653933824, 1563.3205633993532, 1956.74512906582, 1819.7177735193409, 1944.186653945428, 1689.7324200963308, 1897.7390780392655, 1942.320590522318, 1695.3266351177044, 1468.087761502119, 1598.2652739651471, 1761.7671142057934, 1526.3002657834625, 1244.4261208537189, 1420.0427040686689, 1834.6214203837883, 1280.0066141074294, 971.2205704650896, 1449.3234704126946, 1978.1643450107583, 1798.642076333226, 1461.4241234283309, 1599.5742367910846, 1776.184459257424, 1806.7639758984571, 1262.0243331007666, 1759.4699514702497, 1974.7200458092248, 1520.6654419736121, 1697.303685878677, 1623.9537966571313, 1627.8604515520008, 1556.8299790737578, 1593.2638230487123, 1538.6587885938297, 1462.8376191949199, 1451.4076742972031, 1987.3518829197674, 2124.6604913226406, 1973.4768811384943, 1738.4702630561371, 1675.617928758472, 2056.018212652018, 1528.125364247072, 1668.6909553762207, 1813.22994916382, 1287.7190495082605, 872.2152560435788, 1535.950234747619, 1314.8999664491037, 1482.166921440514, 1608.3354179785895, 1410.1136000200063, 1779.4389174491207, 1766.5148331967966, 970.3483371957772, 1660.8819742484543, 1988.0848449959087, 1859.1696912413274, 1466.021928464795, 1726.874480125564, 1218.9685665587174, 1282.5371254219513, 1680.5543904952856, 1726.3612159666218, 1472.7903200195913, 1565.433509770096, 1659.4143750408937, 1533.1468318406353, 1674.522258812912, 1414.7454477326407, 1960.8585912353458, 1605.4876667694573, 1897.094140585729, 1672.250130584996, 1399.131392784717, 1695.6146224071827, 1462.7953071562908, 1219.365856563801, 1008.7835595415555, 1841.2845519773014, 1787.3177132576166, 1603.1592973921554, 1708.8977176043647, 1604.9452594974273, 1176.8886857147352, 1723.9788060301755], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [526.963164465207, 468.433182632449, 609.3682554708879, 665.0733806163037, 566.2024228679727, 599.9878075648091, 425.99385356856044, 470.58564381008165, 533.5611456515053, 589.8811637231561, 304.7828131261341, 487.3344733882594, 507.98489226811284, 428.4605729756945, 437.4506988195992, 685.5205046100294, 333.4847740429558, 443.109907610122, 567.6137221899077, 483.29807395381715, 577.4140540228594, 490.9178701730163, 625.6933088857072, 560.6575787929806, 530.3266217971371, 513.5373586366632, 592.2140787759506, 579.6397137795633, 488.1533318011798, 415.5117185882725, 507.36177150649803, 464.75380211744454, 629.1391021411695, 489.97831653169925, 620.4952439319126, 453.0447790426101, 434.88007390130184, 508.9982958292983, 485.45308717903583, 474.5724697099459, 398.2554704455769, 625.6910952769337, 517.9032601720041, 567.4006083404648, 568.6610972752799, 536.6897557234729, 352.93186299240097, 469.74899484008444, 617.8973185642759, 555.5744471714795, 518.4445466918088, 526.8825579584734, 417.73531312962564, 290.25747971595075, 464.13503269219433, 512.1995607421086, 504.06539955910836, 463.69839573094197, 529.2924253627208, 491.2861152614233, 411.1076240939567, 440.5070554842045, 415.0717153472268, 509.68180522041087, 451.1206626579143, 582.2605368529084, 447.38203046958154, 557.5623791709412, 299.1968507534732, 561.6835202595179, 586.7916569227478, 526.0485450790725, 552.4266834139703, 555.9649585269435, 529.8206211020434, 553.3386982321849, 395.37487370951186, 500.3553860223184, 643.9693240713094, 502.5243099775954, 463.5198168869738, 577.4191530847547, 495.0700165607885, 486.7356639640047, 412.0291747311688, 377.6803788522886, 528.1975884174566, 388.67305177068914, 450.0751959923078, 485.0114080393677, 670.5796981663041, 427.2868994642472, 532.1763119648875, 559.8944637112037, 245.893680318196, 432.94975064143665, 590.9248276600681, 478.5548444862927, 619.409529835279, 344.70701603865336, 573.2425556463774, 403.1540472885987, 722.9458244762018, 431.0614009154324, 506.49695003405327, 678.4049466452601, 679.6133369733066, 553.794086252704, 535.2339466723599, 432.197945821295, 633.9262110854049, 541.614499050213, 496.0865537896459, 460.54870031234435, 510.6836134757518, 484.2515652209461, 457.9355774758695, 372.3641769786938, 596.1110501356279, 374.7821591115832, 347.04241587518777, 387.53795556770604, 459.17376684640584, 578.4305753965463, 516.3372016020364, 484.86661946053647, 642.614728969445, 533.9134871506984, 666.7934831026073, 365.2250732251097, 436.1180064307072, 417.9406566231831, 652.8227614174423, 470.4750809772744, 474.732105191823, 550.2852067946678, 323.9388811587617, 575.9636003478752, 646.5906718344827, 529.2077856615591, 497.3452765252976, 436.4286271182536, 651.8350600948552, 499.0160465950754, 431.27941836933786, 629.2368425335552, 442.8693053856408, 590.7889433842744, 312.1325981029329, 522.8448086835365, 367.47460429954606, 737.2255607696367, 541.7496777618273, 496.74191912798625, 551.8116173610498, 468.8311748812407, 550.9330425438443, 515.6485279919978, 660.9175847939894, 608.2187267963844, 413.5537563634557, 450.90939430435265, 444.44055741089585, 646.0364007474254, 582.667767763682, 621.0805475203717, 525.2939411917714, 567.7475270072163, 473.65530962404785, 588.8932970472206, 715.2710755205313, 584.9011955984594, 587.6571867613875, 504.0269795469423, 542.6017904812893, 747.7641796547312, 454.4183959527503, 703.6079948679135, 653.2947673142402, 583.0950118157925, 417.204826853507, 445.1156919563429, 423.1715798220186, 438.1682930982961, 383.1632333456257, 377.6595066821567, 507.47945579132085, 621.1826051523491, 559.4810215911991, 610.90437712656, 635.7470745406368, 457.2867516940829, 560.3895477452234, 635.3026255787634, 571.1753341155779, 354.25315939307154, 476.7500164328867, 354.6298479586382, 458.00735329232407, 603.2241477455966], "policy_predator_policy_reward": [281.59104867793906, 258.12774727941587, 302.414770226693, 241.27760699015602, 136.47472876184145, 321.83178075498034, 372.2486474033292, 283.036508265597, 425.74628777579875, 392.4159967612184, 103.15868888081273, 96.98773405931931, 427.8178886573017, 580.5777939133742, 177.52881607009567, 192.7208030180351, 77.95100670494834, 111.48998050343464, 313.1839843331258, 271.825372339085, 285.7269841162567, 258.90607999149944, 230.82614458680536, 155.31112419548558, 448.5160402354445, 435.15094565404405, 180.16193875549894, 118.8961340823704, 326.50489305207043, 333.1506199578306, 491.84971859302743, 492.7798368488494, 285.62082997423244, 414.9795248722399, 437.3825611476234, 433.2640698232814, 392.29978320899323, 353.55426715673855, 441.3708663977586, 496.34265475252494, 435.6807727041075, 482.69325209570167, 326.3520458379568, 283.6707207672797, 190.96778479834177, 171.76912370502643, 345.9675051830578, 429.6169109496036, 319.14947938273815, 269.14586908730064, 236.25535467907056, 244.71780645410985, 238.02025707169662, 298.4130709364454, 227.73147794483296, 215.97663268953383, 394.62047780826657, 472.23714728547145, 149.270512418737, 110.1575610645485, 71.04912723066634, 48.55676365626258, 267.4425326761322, 257.12741716892594, 448.8365275255905, 495.9466179743452, 425.1625811232062, 368.5350855694983, 326.5523834121273, 273.9913690032126, 161.21959055521683, 325.5144442340481, 330.9597141240442, 336.83310319246704, 302.9081239538254, 420.69653261040327, 181.3115182073833, 184.98255516155317, 301.7809658371516, 311.1953515841946, 438.86754856604654, 494.9135272714496, 259.5888626865126, 279.2708987623068, 446.6837091690143, 460.91042312620453, 362.6551734621509, 344.427983006836, 399.692294106257, 293.0815534140668, 213.28490722313106, 245.67847422007708, 275.7023729850596, 225.4906743875622, 410.4631765457692, 449.35218108842815, 197.08951200121567, 196.268435047344, 223.7722593031209, 263.5188691201495, 477.2144578812176, 533.7408221035738, 487.84457150662394, 482.80869442438296, 476.97340058092124, 311.60158387825874, 322.3873900133764, 182.67544981674982, 294.6442999891451, 413.5417362756733, 456.85704062197954, 423.62046189441844, 269.26061318120554, 302.22949696387724, 272.3499814941014, 401.40579518541836, 468.30044414356087, 514.6297505656975, 237.01312830880647, 79.81271195224338, 98.93622889860629, 38.698655702079265, 178.16760491144558, 320.17828759322157, 190.93269341197475, 122.76345197455629, 133.45200808224007, 172.18669723813002, 342.56907305161894, 233.74778859925394, 225.89926710850963, 330.1556698576072, 318.6138987867211, 337.5271762676839, 398.29051651429444, 343.2070046960117, 21.015193025933254, 49.43066266320735, 204.66918513247973, 280.4143316199346, 495.0596681977647, 559.2512731545941, 273.9653641004611, 434.3532204509363, 244.53378249651163, 160.97188506539052, 414.9178668837325, 278.29836447191553, 206.62192096593765, 177.3692388063111, 111.33964508564105, 66.49731526712698, 313.5286675869743, 328.5341260184964, 375.8142026696516, 329.90422105467894, 210.9148625107562, 195.29388697299385, 165.04166987973997, 131.25552829998108, 454.6939039730737, 340.2573204000125, 169.71262925627624, 272.9572444260359, 210.45593654635474, 260.31800698250356, 269.5777999097235, 52.12617962392952, 529.6866409490422, 368.62334361503633, 178.32440853827504, 126.99098711219237, 470.06437352158076, 335.3456007558189, 110.8391258660424, 271.0450345829317, 124.85711184051318, 116.24789012353892, 265.84585858571563, 193.37898469143445, 300.76872563338264, 299.7060627130564, 230.90778072945542, 127.11820291403092, 121.85828645189697, 126.1025330618758, 393.22025213614205, 319.40223889749046, 323.626604732631, 293.30570980722837, 32.168854310726, 477.95661684670984, 270.65120580410365, 242.55433847627438, 310.4328357435466, 369.0839302452287, 177.49302629011768, 168.0157950330937, 330.59647774894796, 332.15082724330637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8514865050773764, "mean_inference_ms": 2.5234025397997657, "mean_action_processing_ms": 0.3791340606703328, "mean_env_wait_ms": 0.31398265231928385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009806632995605469, "StateBufferConnector_ms": 0.0037459135055541992, "ViewRequirementAgentConnector_ms": 0.16915655136108398}, "num_episodes": 22, "episode_return_max": 2124.6604913226406, "episode_return_min": 872.2152560435788, "episode_return_mean": 1605.3099731053842, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.88047593306914, "num_env_steps_trained_throughput_per_sec": 273.88047593306914, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 14487.897, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14487.845, "sample_time_ms": 2271.219, "learn_time_ms": 12195.502, "learn_throughput": 327.99, "synch_weights_time_ms": 18.038}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "8abce_00000", "date": "2024-08-16_11-27-43", "timestamp": 1723787863, "time_this_iter_s": 14.633726119995117, "time_total_s": 375.19922280311584, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a436b700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 375.19922280311584, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 60.769999999999996, "ram_util_percent": 82.63499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5810171580503858, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.723150052469244, "policy_loss": -0.003775251127789339, "vf_loss": 9.725844782370109, "vf_explained_var": -0.029244714628451716, "kl": 0.010805152290394741, "entropy": 1.3685831281243177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.416090440308606, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.182422771655693, "policy_loss": -0.007087373875189947, "vf_loss": 9.18766610382726, "vf_explained_var": -0.011190366555774022, "kl": 0.009220151651376386, "entropy": 1.3200357672398684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 2124.6604913226406, "episode_reward_min": 872.2152560435788, "episode_reward_mean": 1558.194838472585, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 245.893680318196, "predator_policy": 20.95198977383889}, "policy_reward_max": {"prey_policy": 747.7641796547312, "predator_policy": 559.2512731545941}, "policy_reward_mean": {"prey_policy": 512.8758077608364, "predator_policy": 266.2216114754559}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1598.2652739651471, 1761.7671142057934, 1526.3002657834625, 1244.4261208537189, 1420.0427040686689, 1834.6214203837883, 1280.0066141074294, 971.2205704650896, 1449.3234704126946, 1978.1643450107583, 1798.642076333226, 1461.4241234283309, 1599.5742367910846, 1776.184459257424, 1806.7639758984571, 1262.0243331007666, 1759.4699514702497, 1974.7200458092248, 1520.6654419736121, 1697.303685878677, 1623.9537966571313, 1627.8604515520008, 1556.8299790737578, 1593.2638230487123, 1538.6587885938297, 1462.8376191949199, 1451.4076742972031, 1987.3518829197674, 2124.6604913226406, 1973.4768811384943, 1738.4702630561371, 1675.617928758472, 2056.018212652018, 1528.125364247072, 1668.6909553762207, 1813.22994916382, 1287.7190495082605, 872.2152560435788, 1535.950234747619, 1314.8999664491037, 1482.166921440514, 1608.3354179785895, 1410.1136000200063, 1779.4389174491207, 1766.5148331967966, 970.3483371957772, 1660.8819742484543, 1988.0848449959087, 1859.1696912413274, 1466.021928464795, 1726.874480125564, 1218.9685665587174, 1282.5371254219513, 1680.5543904952856, 1726.3612159666218, 1472.7903200195913, 1565.433509770096, 1659.4143750408937, 1533.1468318406353, 1674.522258812912, 1414.7454477326407, 1960.8585912353458, 1605.4876667694573, 1897.094140585729, 1672.250130584996, 1399.131392784717, 1695.6146224071827, 1462.7953071562908, 1219.365856563801, 1008.7835595415555, 1841.2845519773014, 1787.3177132576166, 1603.1592973921554, 1708.8977176043647, 1604.9452594974273, 1176.8886857147352, 1723.9788060301755, 1395.875068027707, 1407.693389238035, 934.8644627765199, 1356.7478646701, 1431.3443209388683, 1569.9712829631342, 1503.1902273908377, 1022.044487786711, 1892.299963414127, 1666.2980542096059, 1372.6084638050236, 1816.5011911781162, 1302.4759727122653, 1133.6092117140113, 1589.2292714044597, 1576.7075207945056, 1665.978555034928, 1140.2088367508682, 1516.9653593761716, 1551.6702679821672, 1195.1793148432, 1765.8739355125874, 1545.7197406171217], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [352.93186299240097, 469.74899484008444, 617.8973185642759, 555.5744471714795, 518.4445466918088, 526.8825579584734, 417.73531312962564, 290.25747971595075, 464.13503269219433, 512.1995607421086, 504.06539955910836, 463.69839573094197, 529.2924253627208, 491.2861152614233, 411.1076240939567, 440.5070554842045, 415.0717153472268, 509.68180522041087, 451.1206626579143, 582.2605368529084, 447.38203046958154, 557.5623791709412, 299.1968507534732, 561.6835202595179, 586.7916569227478, 526.0485450790725, 552.4266834139703, 555.9649585269435, 529.8206211020434, 553.3386982321849, 395.37487370951186, 500.3553860223184, 643.9693240713094, 502.5243099775954, 463.5198168869738, 577.4191530847547, 495.0700165607885, 486.7356639640047, 412.0291747311688, 377.6803788522886, 528.1975884174566, 388.67305177068914, 450.0751959923078, 485.0114080393677, 670.5796981663041, 427.2868994642472, 532.1763119648875, 559.8944637112037, 245.893680318196, 432.94975064143665, 590.9248276600681, 478.5548444862927, 619.409529835279, 344.70701603865336, 573.2425556463774, 403.1540472885987, 722.9458244762018, 431.0614009154324, 506.49695003405327, 678.4049466452601, 679.6133369733066, 553.794086252704, 535.2339466723599, 432.197945821295, 633.9262110854049, 541.614499050213, 496.0865537896459, 460.54870031234435, 510.6836134757518, 484.2515652209461, 457.9355774758695, 372.3641769786938, 596.1110501356279, 374.7821591115832, 347.04241587518777, 387.53795556770604, 459.17376684640584, 578.4305753965463, 516.3372016020364, 484.86661946053647, 642.614728969445, 533.9134871506984, 666.7934831026073, 365.2250732251097, 436.1180064307072, 417.9406566231831, 652.8227614174423, 470.4750809772744, 474.732105191823, 550.2852067946678, 323.9388811587617, 575.9636003478752, 646.5906718344827, 529.2077856615591, 497.3452765252976, 436.4286271182536, 651.8350600948552, 499.0160465950754, 431.27941836933786, 629.2368425335552, 442.8693053856408, 590.7889433842744, 312.1325981029329, 522.8448086835365, 367.47460429954606, 737.2255607696367, 541.7496777618273, 496.74191912798625, 551.8116173610498, 468.8311748812407, 550.9330425438443, 515.6485279919978, 660.9175847939894, 608.2187267963844, 413.5537563634557, 450.90939430435265, 444.44055741089585, 646.0364007474254, 582.667767763682, 621.0805475203717, 525.2939411917714, 567.7475270072163, 473.65530962404785, 588.8932970472206, 715.2710755205313, 584.9011955984594, 587.6571867613875, 504.0269795469423, 542.6017904812893, 747.7641796547312, 454.4183959527503, 703.6079948679135, 653.2947673142402, 583.0950118157925, 417.204826853507, 445.1156919563429, 423.1715798220186, 438.1682930982961, 383.1632333456257, 377.6595066821567, 507.47945579132085, 621.1826051523491, 559.4810215911991, 610.90437712656, 635.7470745406368, 457.2867516940829, 560.3895477452234, 635.3026255787634, 571.1753341155779, 354.25315939307154, 476.7500164328867, 354.6298479586382, 458.00735329232407, 603.2241477455966, 470.31396392936347, 405.1660621257616, 525.1506582516241, 382.0505426828829, 421.1284441069008, 320.48699283674944, 468.7734923256931, 531.2414980444901, 709.0797334267162, 466.528434860247, 633.3263932577444, 601.0034873212337, 602.0523716537625, 492.1172547882244, 329.4518185160701, 611.609434448526, 461.3442770971136, 506.5340702787078, 608.5273221128493, 662.746042872581, 572.9469478253151, 501.5024396626468, 483.63568776720365, 635.2271675903517, 440.25764350824346, 582.5829281022886, 631.339550369047, 342.1529191823415, 636.0464122901186, 619.3679473620421, 676.725949335462, 437.3933928709141, 428.57747405737365, 728.2292505282902, 496.07472944962666, 434.9106952070489, 465.7356885625097, 615.4335337011278, 577.4143734462228, 580.2449184548359, 384.6262129220987, 538.075353745077, 481.96649052043006, 684.3563292016722, 391.00753764695486, 398.5684250273782], "policy_predator_policy_reward": [345.9675051830578, 429.6169109496036, 319.14947938273815, 269.14586908730064, 236.25535467907056, 244.71780645410985, 238.02025707169662, 298.4130709364454, 227.73147794483296, 215.97663268953383, 394.62047780826657, 472.23714728547145, 149.270512418737, 110.1575610645485, 71.04912723066634, 48.55676365626258, 267.4425326761322, 257.12741716892594, 448.8365275255905, 495.9466179743452, 425.1625811232062, 368.5350855694983, 326.5523834121273, 273.9913690032126, 161.21959055521683, 325.5144442340481, 330.9597141240442, 336.83310319246704, 302.9081239538254, 420.69653261040327, 181.3115182073833, 184.98255516155317, 301.7809658371516, 311.1953515841946, 438.86754856604654, 494.9135272714496, 259.5888626865126, 279.2708987623068, 446.6837091690143, 460.91042312620453, 362.6551734621509, 344.427983006836, 399.692294106257, 293.0815534140668, 213.28490722313106, 245.67847422007708, 275.7023729850596, 225.4906743875622, 410.4631765457692, 449.35218108842815, 197.08951200121567, 196.268435047344, 223.7722593031209, 263.5188691201495, 477.2144578812176, 533.7408221035738, 487.84457150662394, 482.80869442438296, 476.97340058092124, 311.60158387825874, 322.3873900133764, 182.67544981674982, 294.6442999891451, 413.5417362756733, 456.85704062197954, 423.62046189441844, 269.26061318120554, 302.22949696387724, 272.3499814941014, 401.40579518541836, 468.30044414356087, 514.6297505656975, 237.01312830880647, 79.81271195224338, 98.93622889860629, 38.698655702079265, 178.16760491144558, 320.17828759322157, 190.93269341197475, 122.76345197455629, 133.45200808224007, 172.18669723813002, 342.56907305161894, 233.74778859925394, 225.89926710850963, 330.1556698576072, 318.6138987867211, 337.5271762676839, 398.29051651429444, 343.2070046960117, 21.015193025933254, 49.43066266320735, 204.66918513247973, 280.4143316199346, 495.0596681977647, 559.2512731545941, 273.9653641004611, 434.3532204509363, 244.53378249651163, 160.97188506539052, 414.9178668837325, 278.29836447191553, 206.62192096593765, 177.3692388063111, 111.33964508564105, 66.49731526712698, 313.5286675869743, 328.5341260184964, 375.8142026696516, 329.90422105467894, 210.9148625107562, 195.29388697299385, 165.04166987973997, 131.25552829998108, 454.6939039730737, 340.2573204000125, 169.71262925627624, 272.9572444260359, 210.45593654635474, 260.31800698250356, 269.5777999097235, 52.12617962392952, 529.6866409490422, 368.62334361503633, 178.32440853827504, 126.99098711219237, 470.06437352158076, 335.3456007558189, 110.8391258660424, 271.0450345829317, 124.85711184051318, 116.24789012353892, 265.84585858571563, 193.37898469143445, 300.76872563338264, 299.7060627130564, 230.90778072945542, 127.11820291403092, 121.85828645189697, 126.1025330618758, 393.22025213614205, 319.40223889749046, 323.626604732631, 293.30570980722837, 32.168854310726, 477.95661684670984, 270.65120580410365, 242.55433847627438, 310.4328357435466, 369.0839302452287, 177.49302629011768, 168.0157950330937, 330.59647774894796, 332.15082724330637, 248.14131490792872, 272.25372706465265, 229.62525154223937, 270.86693676128874, 143.13478730744595, 50.11423852542304, 229.7199789029505, 127.01289539696484, 186.80774623839542, 68.92840641351053, 155.45268632747485, 180.18871605668076, 158.34197491076787, 250.6786260380823, 60.03124504827578, 20.95198977383889, 476.20453222618306, 448.21708381212244, 155.87362988874796, 239.15105933542773, 140.00958504656018, 158.1494912705012, 341.9696872478914, 355.66864857267126, 132.34736395507423, 147.28803714665784, 97.29846586236577, 62.81827630025775, 146.32091491758754, 187.49399683471196, 242.33777897104565, 220.25039961708146, 263.3117875777427, 245.86004287152025, 103.32411392975693, 105.89929816443573, 225.87618413792535, 209.91995297461006, 148.01011794749706, 246.0008581336116, 212.51814633990497, 59.95960183611879, 353.4924191631823, 246.05869662730075, 338.03652464670984, 418.1072532960787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8629485433462825, "mean_inference_ms": 2.564180567093485, "mean_action_processing_ms": 0.39421860475042964, "mean_env_wait_ms": 0.3167851210142954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008525371551513672, "StateBufferConnector_ms": 0.003587007522583008, "ViewRequirementAgentConnector_ms": 0.16364026069641113}, "num_episodes": 23, "episode_return_max": 2124.6604913226406, "episode_return_min": 872.2152560435788, "episode_return_mean": 1558.194838472585, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.8149474198251, "num_env_steps_trained_throughput_per_sec": 292.8149474198251, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 14301.305, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14301.25, "sample_time_ms": 2431.184, "learn_time_ms": 11849.079, "learn_throughput": 337.579, "synch_weights_time_ms": 18.029}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "8abce_00000", "date": "2024-08-16_11-27-57", "timestamp": 1723787877, "time_this_iter_s": 13.671738147735596, "time_total_s": 388.87096095085144, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 388.87096095085144, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 57.78000000000001, "ram_util_percent": 82.05499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5496793761770562, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.81394381346526, "policy_loss": -0.0011426607632230986, "vf_loss": 9.814115127684579, "vf_explained_var": -0.022216569431244382, "kl": 0.009713271598207639, "entropy": 1.3874779018775496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0915209304088007, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.317268637500742, "policy_loss": -0.006897707467051173, "vf_loss": 9.322181814688223, "vf_explained_var": -0.02064903170343429, "kl": 0.009922715923716479, "entropy": 1.3005115481280776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 2124.6604913226406, "episode_reward_min": 872.2152560435788, "episode_reward_mean": 1556.5344131730587, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 245.893680318196, "predator_policy": 20.95198977383889}, "policy_reward_max": {"prey_policy": 771.1775536079689, "predator_policy": 559.2512731545941}, "policy_reward_mean": {"prey_policy": 522.7161731130394, "predator_policy": 255.55103347348984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1520.6654419736121, 1697.303685878677, 1623.9537966571313, 1627.8604515520008, 1556.8299790737578, 1593.2638230487123, 1538.6587885938297, 1462.8376191949199, 1451.4076742972031, 1987.3518829197674, 2124.6604913226406, 1973.4768811384943, 1738.4702630561371, 1675.617928758472, 2056.018212652018, 1528.125364247072, 1668.6909553762207, 1813.22994916382, 1287.7190495082605, 872.2152560435788, 1535.950234747619, 1314.8999664491037, 1482.166921440514, 1608.3354179785895, 1410.1136000200063, 1779.4389174491207, 1766.5148331967966, 970.3483371957772, 1660.8819742484543, 1988.0848449959087, 1859.1696912413274, 1466.021928464795, 1726.874480125564, 1218.9685665587174, 1282.5371254219513, 1680.5543904952856, 1726.3612159666218, 1472.7903200195913, 1565.433509770096, 1659.4143750408937, 1533.1468318406353, 1674.522258812912, 1414.7454477326407, 1960.8585912353458, 1605.4876667694573, 1897.094140585729, 1672.250130584996, 1399.131392784717, 1695.6146224071827, 1462.7953071562908, 1219.365856563801, 1008.7835595415555, 1841.2845519773014, 1787.3177132576166, 1603.1592973921554, 1708.8977176043647, 1604.9452594974273, 1176.8886857147352, 1723.9788060301755, 1395.875068027707, 1407.693389238035, 934.8644627765199, 1356.7478646701, 1431.3443209388683, 1569.9712829631342, 1503.1902273908377, 1022.044487786711, 1892.299963414127, 1666.2980542096059, 1372.6084638050236, 1816.5011911781162, 1302.4759727122653, 1133.6092117140113, 1589.2292714044597, 1576.7075207945056, 1665.978555034928, 1140.2088367508682, 1516.9653593761716, 1551.6702679821672, 1195.1793148432, 1765.8739355125874, 1545.7197406171217, 1503.885815413579, 1602.0099842851384, 1493.2707307408994, 1698.8541433353766, 1512.1206421582697, 1602.8319173052466, 1837.9393786293829, 1495.5345873825818, 1587.6535521910018, 1686.4020468364483, 1177.2233555728662, 1735.3910558975579, 1626.1678703007678, 1575.6820883487399, 1601.1185867752858, 1548.0528410269924, 1507.0177398243588, 1545.7422353681807], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [495.0700165607885, 486.7356639640047, 412.0291747311688, 377.6803788522886, 528.1975884174566, 388.67305177068914, 450.0751959923078, 485.0114080393677, 670.5796981663041, 427.2868994642472, 532.1763119648875, 559.8944637112037, 245.893680318196, 432.94975064143665, 590.9248276600681, 478.5548444862927, 619.409529835279, 344.70701603865336, 573.2425556463774, 403.1540472885987, 722.9458244762018, 431.0614009154324, 506.49695003405327, 678.4049466452601, 679.6133369733066, 553.794086252704, 535.2339466723599, 432.197945821295, 633.9262110854049, 541.614499050213, 496.0865537896459, 460.54870031234435, 510.6836134757518, 484.2515652209461, 457.9355774758695, 372.3641769786938, 596.1110501356279, 374.7821591115832, 347.04241587518777, 387.53795556770604, 459.17376684640584, 578.4305753965463, 516.3372016020364, 484.86661946053647, 642.614728969445, 533.9134871506984, 666.7934831026073, 365.2250732251097, 436.1180064307072, 417.9406566231831, 652.8227614174423, 470.4750809772744, 474.732105191823, 550.2852067946678, 323.9388811587617, 575.9636003478752, 646.5906718344827, 529.2077856615591, 497.3452765252976, 436.4286271182536, 651.8350600948552, 499.0160465950754, 431.27941836933786, 629.2368425335552, 442.8693053856408, 590.7889433842744, 312.1325981029329, 522.8448086835365, 367.47460429954606, 737.2255607696367, 541.7496777618273, 496.74191912798625, 551.8116173610498, 468.8311748812407, 550.9330425438443, 515.6485279919978, 660.9175847939894, 608.2187267963844, 413.5537563634557, 450.90939430435265, 444.44055741089585, 646.0364007474254, 582.667767763682, 621.0805475203717, 525.2939411917714, 567.7475270072163, 473.65530962404785, 588.8932970472206, 715.2710755205313, 584.9011955984594, 587.6571867613875, 504.0269795469423, 542.6017904812893, 747.7641796547312, 454.4183959527503, 703.6079948679135, 653.2947673142402, 583.0950118157925, 417.204826853507, 445.1156919563429, 423.1715798220186, 438.1682930982961, 383.1632333456257, 377.6595066821567, 507.47945579132085, 621.1826051523491, 559.4810215911991, 610.90437712656, 635.7470745406368, 457.2867516940829, 560.3895477452234, 635.3026255787634, 571.1753341155779, 354.25315939307154, 476.7500164328867, 354.6298479586382, 458.00735329232407, 603.2241477455966, 470.31396392936347, 405.1660621257616, 525.1506582516241, 382.0505426828829, 421.1284441069008, 320.48699283674944, 468.7734923256931, 531.2414980444901, 709.0797334267162, 466.528434860247, 633.3263932577444, 601.0034873212337, 602.0523716537625, 492.1172547882244, 329.4518185160701, 611.609434448526, 461.3442770971136, 506.5340702787078, 608.5273221128493, 662.746042872581, 572.9469478253151, 501.5024396626468, 483.63568776720365, 635.2271675903517, 440.25764350824346, 582.5829281022886, 631.339550369047, 342.1529191823415, 636.0464122901186, 619.3679473620421, 676.725949335462, 437.3933928709141, 428.57747405737365, 728.2292505282902, 496.07472944962666, 434.9106952070489, 465.7356885625097, 615.4335337011278, 577.4143734462228, 580.2449184548359, 384.6262129220987, 538.075353745077, 481.96649052043006, 684.3563292016722, 391.00753764695486, 398.5684250273782, 512.1858229281461, 402.4407996916249, 365.135990101914, 665.075139275501, 583.8300802608579, 626.4346854650491, 486.71516889241144, 771.1775536079689, 538.1658240423752, 446.82879967186693, 624.9222195637208, 464.04160771498823, 502.63739039046607, 507.04944312103714, 618.9544127634274, 495.5921787253128, 449.8028965207585, 644.3638083600515, 558.0841211973361, 604.5967002818359, 432.9033062021883, 451.368789860316, 664.0598286411392, 605.688920089729, 505.0301170553764, 651.4284422202379, 586.6886716718677, 585.4554180645712, 539.1775841723212, 617.9097891171177, 594.5856369657105, 542.5884009063859, 515.6782052924906, 540.4513334667239, 408.0327893782826, 636.2688525116259], "policy_predator_policy_reward": [259.5888626865126, 279.2708987623068, 446.6837091690143, 460.91042312620453, 362.6551734621509, 344.427983006836, 399.692294106257, 293.0815534140668, 213.28490722313106, 245.67847422007708, 275.7023729850596, 225.4906743875622, 410.4631765457692, 449.35218108842815, 197.08951200121567, 196.268435047344, 223.7722593031209, 263.5188691201495, 477.2144578812176, 533.7408221035738, 487.84457150662394, 482.80869442438296, 476.97340058092124, 311.60158387825874, 322.3873900133764, 182.67544981674982, 294.6442999891451, 413.5417362756733, 456.85704062197954, 423.62046189441844, 269.26061318120554, 302.22949696387724, 272.3499814941014, 401.40579518541836, 468.30044414356087, 514.6297505656975, 237.01312830880647, 79.81271195224338, 98.93622889860629, 38.698655702079265, 178.16760491144558, 320.17828759322157, 190.93269341197475, 122.76345197455629, 133.45200808224007, 172.18669723813002, 342.56907305161894, 233.74778859925394, 225.89926710850963, 330.1556698576072, 318.6138987867211, 337.5271762676839, 398.29051651429444, 343.2070046960117, 21.015193025933254, 49.43066266320735, 204.66918513247973, 280.4143316199346, 495.0596681977647, 559.2512731545941, 273.9653641004611, 434.3532204509363, 244.53378249651163, 160.97188506539052, 414.9178668837325, 278.29836447191553, 206.62192096593765, 177.3692388063111, 111.33964508564105, 66.49731526712698, 313.5286675869743, 328.5341260184964, 375.8142026696516, 329.90422105467894, 210.9148625107562, 195.29388697299385, 165.04166987973997, 131.25552829998108, 454.6939039730737, 340.2573204000125, 169.71262925627624, 272.9572444260359, 210.45593654635474, 260.31800698250356, 269.5777999097235, 52.12617962392952, 529.6866409490422, 368.62334361503633, 178.32440853827504, 126.99098711219237, 470.06437352158076, 335.3456007558189, 110.8391258660424, 271.0450345829317, 124.85711184051318, 116.24789012353892, 265.84585858571563, 193.37898469143445, 300.76872563338264, 299.7060627130564, 230.90778072945542, 127.11820291403092, 121.85828645189697, 126.1025330618758, 393.22025213614205, 319.40223889749046, 323.626604732631, 293.30570980722837, 32.168854310726, 477.95661684670984, 270.65120580410365, 242.55433847627438, 310.4328357435466, 369.0839302452287, 177.49302629011768, 168.0157950330937, 330.59647774894796, 332.15082724330637, 248.14131490792872, 272.25372706465265, 229.62525154223937, 270.86693676128874, 143.13478730744595, 50.11423852542304, 229.7199789029505, 127.01289539696484, 186.80774623839542, 68.92840641351053, 155.45268632747485, 180.18871605668076, 158.34197491076787, 250.6786260380823, 60.03124504827578, 20.95198977383889, 476.20453222618306, 448.21708381212244, 155.87362988874796, 239.15105933542773, 140.00958504656018, 158.1494912705012, 341.9696872478914, 355.66864857267126, 132.34736395507423, 147.28803714665784, 97.29846586236577, 62.81827630025775, 146.32091491758754, 187.49399683471196, 242.33777897104565, 220.25039961708146, 263.3117875777427, 245.86004287152025, 103.32411392975693, 105.89929816443573, 225.87618413792535, 209.91995297461006, 148.01011794749706, 246.0008581336116, 212.51814633990497, 59.95960183611879, 353.4924191631823, 246.05869662730075, 338.03652464670984, 418.1072532960787, 298.8856699172023, 290.3735228766072, 318.52462521391647, 253.27422969381004, 201.949072041055, 81.05689297393751, 151.16998508585675, 289.79143574913945, 187.84379110308058, 339.28222734094675, 372.0307105904609, 141.8373794360768, 426.490717348256, 401.7618277696229, 100.20316323046366, 280.78483266337884, 267.9778655687713, 225.5089817414193, 242.89072909958264, 280.8304962576935, 129.5270144845617, 163.42424502580153, 199.39053966091225, 266.2517675057784, 214.7460766457929, 254.9632343793591, 203.15048445930717, 200.38751415299333, 253.0959305399133, 190.93528294593227, 204.4880676660378, 206.3907354888577, 262.00628947029423, 188.88191159484956, 239.78828295485346, 261.65231052342074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8720361268945696, "mean_inference_ms": 2.597095918175528, "mean_action_processing_ms": 0.4061887161352763, "mean_env_wait_ms": 0.3193093149835326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007831335067749023, "StateBufferConnector_ms": 0.0035207271575927734, "ViewRequirementAgentConnector_ms": 0.15761029720306396}, "num_episodes": 18, "episode_return_max": 2124.6604913226406, "episode_return_min": 872.2152560435788, "episode_return_mean": 1556.5344131730587, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.4057916666703, "num_env_steps_trained_throughput_per_sec": 294.4057916666703, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 14262.101, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14262.048, "sample_time_ms": 2375.428, "learn_time_ms": 11866.162, "learn_throughput": 337.093, "synch_weights_time_ms": 17.712}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "8abce_00000", "date": "2024-08-16_11-28-11", "timestamp": 1723787891, "time_this_iter_s": 13.627315998077393, "time_total_s": 402.49827694892883, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 402.49827694892883, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 59.363157894736844, "ram_util_percent": 81.58947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6366297150257403, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.773816715724884, "policy_loss": -0.0024434299205760004, "vf_loss": 9.775540148013484, "vf_explained_var": -0.021907241697664614, "kl": 0.007199834195242186, "entropy": 1.41513447187565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.070016079005741, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.40407810867148, "policy_loss": -0.008098344920109465, "vf_loss": 9.410664388363955, "vf_explained_var": -0.024854357343502144, "kl": 0.007560450647045462, "entropy": 1.2889772374793966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 1988.0848449959087, "episode_reward_min": 872.2152560435788, "episode_reward_mean": 1554.012791487475, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 312.1325981029329, "predator_policy": 20.95198977383889}, "policy_reward_max": {"prey_policy": 771.1775536079689, "predator_policy": 559.2512731545941}, "policy_reward_mean": {"prey_policy": 532.0314715707725, "predator_policy": 244.97492417296507}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1287.7190495082605, 872.2152560435788, 1535.950234747619, 1314.8999664491037, 1482.166921440514, 1608.3354179785895, 1410.1136000200063, 1779.4389174491207, 1766.5148331967966, 970.3483371957772, 1660.8819742484543, 1988.0848449959087, 1859.1696912413274, 1466.021928464795, 1726.874480125564, 1218.9685665587174, 1282.5371254219513, 1680.5543904952856, 1726.3612159666218, 1472.7903200195913, 1565.433509770096, 1659.4143750408937, 1533.1468318406353, 1674.522258812912, 1414.7454477326407, 1960.8585912353458, 1605.4876667694573, 1897.094140585729, 1672.250130584996, 1399.131392784717, 1695.6146224071827, 1462.7953071562908, 1219.365856563801, 1008.7835595415555, 1841.2845519773014, 1787.3177132576166, 1603.1592973921554, 1708.8977176043647, 1604.9452594974273, 1176.8886857147352, 1723.9788060301755, 1395.875068027707, 1407.693389238035, 934.8644627765199, 1356.7478646701, 1431.3443209388683, 1569.9712829631342, 1503.1902273908377, 1022.044487786711, 1892.299963414127, 1666.2980542096059, 1372.6084638050236, 1816.5011911781162, 1302.4759727122653, 1133.6092117140113, 1589.2292714044597, 1576.7075207945056, 1665.978555034928, 1140.2088367508682, 1516.9653593761716, 1551.6702679821672, 1195.1793148432, 1765.8739355125874, 1545.7197406171217, 1503.885815413579, 1602.0099842851384, 1493.2707307408994, 1698.8541433353766, 1512.1206421582697, 1602.8319173052466, 1837.9393786293829, 1495.5345873825818, 1587.6535521910018, 1686.4020468364483, 1177.2233555728662, 1735.3910558975579, 1626.1678703007678, 1575.6820883487399, 1601.1185867752858, 1548.0528410269924, 1507.0177398243588, 1545.7422353681807, 1610.393655289049, 1663.21267102021, 1701.3970242594319, 1786.105687380652, 1724.1532010809808, 1636.5920977853534, 1775.3151699976663, 1529.803389267623, 1704.7989980517164, 1894.0270983388198, 1748.9710332060363, 1654.8438464601932, 1506.7178356909656, 1877.3350494334388, 1794.9734578077787, 1428.483376969731, 1588.4574635567399, 1760.679964749785], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [596.1110501356279, 374.7821591115832, 347.04241587518777, 387.53795556770604, 459.17376684640584, 578.4305753965463, 516.3372016020364, 484.86661946053647, 642.614728969445, 533.9134871506984, 666.7934831026073, 365.2250732251097, 436.1180064307072, 417.9406566231831, 652.8227614174423, 470.4750809772744, 474.732105191823, 550.2852067946678, 323.9388811587617, 575.9636003478752, 646.5906718344827, 529.2077856615591, 497.3452765252976, 436.4286271182536, 651.8350600948552, 499.0160465950754, 431.27941836933786, 629.2368425335552, 442.8693053856408, 590.7889433842744, 312.1325981029329, 522.8448086835365, 367.47460429954606, 737.2255607696367, 541.7496777618273, 496.74191912798625, 551.8116173610498, 468.8311748812407, 550.9330425438443, 515.6485279919978, 660.9175847939894, 608.2187267963844, 413.5537563634557, 450.90939430435265, 444.44055741089585, 646.0364007474254, 582.667767763682, 621.0805475203717, 525.2939411917714, 567.7475270072163, 473.65530962404785, 588.8932970472206, 715.2710755205313, 584.9011955984594, 587.6571867613875, 504.0269795469423, 542.6017904812893, 747.7641796547312, 454.4183959527503, 703.6079948679135, 653.2947673142402, 583.0950118157925, 417.204826853507, 445.1156919563429, 423.1715798220186, 438.1682930982961, 383.1632333456257, 377.6595066821567, 507.47945579132085, 621.1826051523491, 559.4810215911991, 610.90437712656, 635.7470745406368, 457.2867516940829, 560.3895477452234, 635.3026255787634, 571.1753341155779, 354.25315939307154, 476.7500164328867, 354.6298479586382, 458.00735329232407, 603.2241477455966, 470.31396392936347, 405.1660621257616, 525.1506582516241, 382.0505426828829, 421.1284441069008, 320.48699283674944, 468.7734923256931, 531.2414980444901, 709.0797334267162, 466.528434860247, 633.3263932577444, 601.0034873212337, 602.0523716537625, 492.1172547882244, 329.4518185160701, 611.609434448526, 461.3442770971136, 506.5340702787078, 608.5273221128493, 662.746042872581, 572.9469478253151, 501.5024396626468, 483.63568776720365, 635.2271675903517, 440.25764350824346, 582.5829281022886, 631.339550369047, 342.1529191823415, 636.0464122901186, 619.3679473620421, 676.725949335462, 437.3933928709141, 428.57747405737365, 728.2292505282902, 496.07472944962666, 434.9106952070489, 465.7356885625097, 615.4335337011278, 577.4143734462228, 580.2449184548359, 384.6262129220987, 538.075353745077, 481.96649052043006, 684.3563292016722, 391.00753764695486, 398.5684250273782, 512.1858229281461, 402.4407996916249, 365.135990101914, 665.075139275501, 583.8300802608579, 626.4346854650491, 486.71516889241144, 771.1775536079689, 538.1658240423752, 446.82879967186693, 624.9222195637208, 464.04160771498823, 502.63739039046607, 507.04944312103714, 618.9544127634274, 495.5921787253128, 449.8028965207585, 644.3638083600515, 558.0841211973361, 604.5967002818359, 432.9033062021883, 451.368789860316, 664.0598286411392, 605.688920089729, 505.0301170553764, 651.4284422202379, 586.6886716718677, 585.4554180645712, 539.1775841723212, 617.9097891171177, 594.5856369657105, 542.5884009063859, 515.6782052924906, 540.4513334667239, 408.0327893782826, 636.2688525116259, 624.3208064628043, 474.88919707195697, 695.7104015356053, 549.7633680406365, 612.5176641079281, 518.9497980531836, 615.3648765239572, 630.3103534383193, 566.7208004421593, 648.0400785622109, 494.92028888596394, 447.06905950534355, 568.4964400275305, 478.0603055383245, 548.8308254633224, 545.0664921430416, 635.912748871644, 565.617774711266, 525.7769841384765, 556.8226749256949, 543.0596031023517, 411.5673146607206, 564.6491153664107, 459.81512982739423, 481.8872585109204, 492.0359324230202, 530.8447908210421, 577.2704791106228, 485.3421462831533, 690.6987496372152, 447.79351479058425, 484.21170361570023, 516.5453091899725, 506.05058751839175, 616.2548338091265, 751.2777231597425], "policy_predator_policy_reward": [237.01312830880647, 79.81271195224338, 98.93622889860629, 38.698655702079265, 178.16760491144558, 320.17828759322157, 190.93269341197475, 122.76345197455629, 133.45200808224007, 172.18669723813002, 342.56907305161894, 233.74778859925394, 225.89926710850963, 330.1556698576072, 318.6138987867211, 337.5271762676839, 398.29051651429444, 343.2070046960117, 21.015193025933254, 49.43066266320735, 204.66918513247973, 280.4143316199346, 495.0596681977647, 559.2512731545941, 273.9653641004611, 434.3532204509363, 244.53378249651163, 160.97188506539052, 414.9178668837325, 278.29836447191553, 206.62192096593765, 177.3692388063111, 111.33964508564105, 66.49731526712698, 313.5286675869743, 328.5341260184964, 375.8142026696516, 329.90422105467894, 210.9148625107562, 195.29388697299385, 165.04166987973997, 131.25552829998108, 454.6939039730737, 340.2573204000125, 169.71262925627624, 272.9572444260359, 210.45593654635474, 260.31800698250356, 269.5777999097235, 52.12617962392952, 529.6866409490422, 368.62334361503633, 178.32440853827504, 126.99098711219237, 470.06437352158076, 335.3456007558189, 110.8391258660424, 271.0450345829317, 124.85711184051318, 116.24789012353892, 265.84585858571563, 193.37898469143445, 300.76872563338264, 299.7060627130564, 230.90778072945542, 127.11820291403092, 121.85828645189697, 126.1025330618758, 393.22025213614205, 319.40223889749046, 323.626604732631, 293.30570980722837, 32.168854310726, 477.95661684670984, 270.65120580410365, 242.55433847627438, 310.4328357435466, 369.0839302452287, 177.49302629011768, 168.0157950330937, 330.59647774894796, 332.15082724330637, 248.14131490792872, 272.25372706465265, 229.62525154223937, 270.86693676128874, 143.13478730744595, 50.11423852542304, 229.7199789029505, 127.01289539696484, 186.80774623839542, 68.92840641351053, 155.45268632747485, 180.18871605668076, 158.34197491076787, 250.6786260380823, 60.03124504827578, 20.95198977383889, 476.20453222618306, 448.21708381212244, 155.87362988874796, 239.15105933542773, 140.00958504656018, 158.1494912705012, 341.9696872478914, 355.66864857267126, 132.34736395507423, 147.28803714665784, 97.29846586236577, 62.81827630025775, 146.32091491758754, 187.49399683471196, 242.33777897104565, 220.25039961708146, 263.3117875777427, 245.86004287152025, 103.32411392975693, 105.89929816443573, 225.87618413792535, 209.91995297461006, 148.01011794749706, 246.0008581336116, 212.51814633990497, 59.95960183611879, 353.4924191631823, 246.05869662730075, 338.03652464670984, 418.1072532960787, 298.8856699172023, 290.3735228766072, 318.52462521391647, 253.27422969381004, 201.949072041055, 81.05689297393751, 151.16998508585675, 289.79143574913945, 187.84379110308058, 339.28222734094675, 372.0307105904609, 141.8373794360768, 426.490717348256, 401.7618277696229, 100.20316323046366, 280.78483266337884, 267.9778655687713, 225.5089817414193, 242.89072909958264, 280.8304962576935, 129.5270144845617, 163.42424502580153, 199.39053966091225, 266.2517675057784, 214.7460766457929, 254.9632343793591, 203.15048445930717, 200.38751415299333, 253.0959305399133, 190.93528294593227, 204.4880676660378, 206.3907354888577, 262.00628947029423, 188.88191159484956, 239.78828295485346, 261.65231052342074, 216.414764697045, 294.76888705724053, 195.03545776486948, 222.70344367909934, 281.02799813405016, 288.9015639642715, 291.7248229444985, 248.705634473878, 172.05358688707636, 337.33873518953385, 334.15471291037403, 360.44803648367105, 402.32565056156477, 326.4327738702461, 272.92344621989565, 162.98262544136472, 173.67888952336241, 329.5895849454442, 432.3510454604047, 379.0763938142458, 372.4033014899392, 421.9408139530269, 326.1504023055024, 304.2291989608858, 158.31911521266625, 374.47552954435645, 377.7659736000232, 391.4538059017509, 340.3459354021445, 278.5866264852672, 275.25579854221667, 221.22236002122963, 269.9954769620887, 295.86608988628655, 181.66989243415554, 211.47751534676186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8783409069408639, "mean_inference_ms": 2.619754577178648, "mean_action_processing_ms": 0.40742237106471696, "mean_env_wait_ms": 0.3212726004371559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007163286209106445, "StateBufferConnector_ms": 0.0034027099609375, "ViewRequirementAgentConnector_ms": 0.1108628511428833}, "num_episodes": 18, "episode_return_max": 1988.0848449959087, "episode_return_min": 872.2152560435788, "episode_return_mean": 1554.012791487475, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.8070248639355, "num_env_steps_trained_throughput_per_sec": 304.8070248639355, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 14375.257, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14375.204, "sample_time_ms": 2389.276, "learn_time_ms": 11966.206, "learn_throughput": 334.275, "synch_weights_time_ms": 17.065}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "8abce_00000", "date": "2024-08-16_11-28-24", "timestamp": 1723787904, "time_this_iter_s": 13.172229290008545, "time_total_s": 415.6705062389374, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a436b700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 415.6705062389374, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 60.88947368421053, "ram_util_percent": 81.72105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5683090307409802, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.839991240022044, "policy_loss": -0.0029329888297185774, "vf_loss": 9.842051929897732, "vf_explained_var": -0.012542404951872648, "kl": 0.00872292984372467, "entropy": 1.4225815388260694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0990372232343786, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.390950613677816, "policy_loss": -0.00857993160059094, "vf_loss": 9.396987022924675, "vf_explained_var": -0.03520972012842774, "kl": 0.012717532258701147, "entropy": 1.2887485463783224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 1975.405730948797, "episode_reward_min": 934.8644627765199, "episode_reward_mean": 1590.1250492122015, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 320.48699283674944, "predator_policy": 20.95198977383889}, "policy_reward_max": {"prey_policy": 771.1775536079689, "predator_policy": 633.1392466972856}, "policy_reward_mean": {"prey_policy": 535.7010249332878, "predator_policy": 259.361499672813}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1726.3612159666218, 1472.7903200195913, 1565.433509770096, 1659.4143750408937, 1533.1468318406353, 1674.522258812912, 1414.7454477326407, 1960.8585912353458, 1605.4876667694573, 1897.094140585729, 1672.250130584996, 1399.131392784717, 1695.6146224071827, 1462.7953071562908, 1219.365856563801, 1008.7835595415555, 1841.2845519773014, 1787.3177132576166, 1603.1592973921554, 1708.8977176043647, 1604.9452594974273, 1176.8886857147352, 1723.9788060301755, 1395.875068027707, 1407.693389238035, 934.8644627765199, 1356.7478646701, 1431.3443209388683, 1569.9712829631342, 1503.1902273908377, 1022.044487786711, 1892.299963414127, 1666.2980542096059, 1372.6084638050236, 1816.5011911781162, 1302.4759727122653, 1133.6092117140113, 1589.2292714044597, 1576.7075207945056, 1665.978555034928, 1140.2088367508682, 1516.9653593761716, 1551.6702679821672, 1195.1793148432, 1765.8739355125874, 1545.7197406171217, 1503.885815413579, 1602.0099842851384, 1493.2707307408994, 1698.8541433353766, 1512.1206421582697, 1602.8319173052466, 1837.9393786293829, 1495.5345873825818, 1587.6535521910018, 1686.4020468364483, 1177.2233555728662, 1735.3910558975579, 1626.1678703007678, 1575.6820883487399, 1601.1185867752858, 1548.0528410269924, 1507.0177398243588, 1545.7422353681807, 1610.393655289049, 1663.21267102021, 1701.3970242594319, 1786.105687380652, 1724.1532010809808, 1636.5920977853534, 1775.3151699976663, 1529.803389267623, 1704.7989980517164, 1894.0270983388198, 1748.9710332060363, 1654.8438464601932, 1506.7178356909656, 1877.3350494334388, 1794.9734578077787, 1428.483376969731, 1588.4574635567399, 1760.679964749785, 1699.9254515007553, 1596.7088482074616, 1515.8299842662882, 1778.3161877122736, 1831.9649770851222, 1768.6538466660786, 1164.0907108693389, 1739.5419251407395, 1507.595625627924, 1840.8340136097806, 1374.4417907672132, 1904.8320123294766, 1870.3676723727074, 1975.405730948797, 1488.2687685878702, 1773.6047779003077, 1788.3963616376209, 1903.2426228242527], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [551.8116173610498, 468.8311748812407, 550.9330425438443, 515.6485279919978, 660.9175847939894, 608.2187267963844, 413.5537563634557, 450.90939430435265, 444.44055741089585, 646.0364007474254, 582.667767763682, 621.0805475203717, 525.2939411917714, 567.7475270072163, 473.65530962404785, 588.8932970472206, 715.2710755205313, 584.9011955984594, 587.6571867613875, 504.0269795469423, 542.6017904812893, 747.7641796547312, 454.4183959527503, 703.6079948679135, 653.2947673142402, 583.0950118157925, 417.204826853507, 445.1156919563429, 423.1715798220186, 438.1682930982961, 383.1632333456257, 377.6595066821567, 507.47945579132085, 621.1826051523491, 559.4810215911991, 610.90437712656, 635.7470745406368, 457.2867516940829, 560.3895477452234, 635.3026255787634, 571.1753341155779, 354.25315939307154, 476.7500164328867, 354.6298479586382, 458.00735329232407, 603.2241477455966, 470.31396392936347, 405.1660621257616, 525.1506582516241, 382.0505426828829, 421.1284441069008, 320.48699283674944, 468.7734923256931, 531.2414980444901, 709.0797334267162, 466.528434860247, 633.3263932577444, 601.0034873212337, 602.0523716537625, 492.1172547882244, 329.4518185160701, 611.609434448526, 461.3442770971136, 506.5340702787078, 608.5273221128493, 662.746042872581, 572.9469478253151, 501.5024396626468, 483.63568776720365, 635.2271675903517, 440.25764350824346, 582.5829281022886, 631.339550369047, 342.1529191823415, 636.0464122901186, 619.3679473620421, 676.725949335462, 437.3933928709141, 428.57747405737365, 728.2292505282902, 496.07472944962666, 434.9106952070489, 465.7356885625097, 615.4335337011278, 577.4143734462228, 580.2449184548359, 384.6262129220987, 538.075353745077, 481.96649052043006, 684.3563292016722, 391.00753764695486, 398.5684250273782, 512.1858229281461, 402.4407996916249, 365.135990101914, 665.075139275501, 583.8300802608579, 626.4346854650491, 486.71516889241144, 771.1775536079689, 538.1658240423752, 446.82879967186693, 624.9222195637208, 464.04160771498823, 502.63739039046607, 507.04944312103714, 618.9544127634274, 495.5921787253128, 449.8028965207585, 644.3638083600515, 558.0841211973361, 604.5967002818359, 432.9033062021883, 451.368789860316, 664.0598286411392, 605.688920089729, 505.0301170553764, 651.4284422202379, 586.6886716718677, 585.4554180645712, 539.1775841723212, 617.9097891171177, 594.5856369657105, 542.5884009063859, 515.6782052924906, 540.4513334667239, 408.0327893782826, 636.2688525116259, 624.3208064628043, 474.88919707195697, 695.7104015356053, 549.7633680406365, 612.5176641079281, 518.9497980531836, 615.3648765239572, 630.3103534383193, 566.7208004421593, 648.0400785622109, 494.92028888596394, 447.06905950534355, 568.4964400275305, 478.0603055383245, 548.8308254633224, 545.0664921430416, 635.912748871644, 565.617774711266, 525.7769841384765, 556.8226749256949, 543.0596031023517, 411.5673146607206, 564.6491153664107, 459.81512982739423, 481.8872585109204, 492.0359324230202, 530.8447908210421, 577.2704791106228, 485.3421462831533, 690.6987496372152, 447.79351479058425, 484.21170361570023, 516.5453091899725, 506.05058751839175, 616.2548338091265, 751.2777231597425, 624.9382005387746, 498.10557340451743, 473.76479431144696, 741.770504655329, 484.4152906786773, 551.3942209011542, 512.7710040587707, 526.3948229327472, 631.5952708068432, 637.5899309642842, 565.8860314839669, 594.0040327731872, 525.1047929465298, 413.60948169849655, 558.748900207268, 479.93584682289776, 414.4790251524971, 440.1719850927805, 511.0618895741143, 532.3879805305252, 385.9885436860708, 502.66633181540107, 648.3440757287299, 491.3887418211092, 546.8441110309685, 615.6576775279314, 471.8556701590702, 461.80281619723155, 437.6035992112106, 564.362074001709, 632.970786195924, 496.8118391989263, 485.9547467459149, 547.1653574971361, 408.7415740353231, 505.49510974861306], "policy_predator_policy_reward": [375.8142026696516, 329.90422105467894, 210.9148625107562, 195.29388697299385, 165.04166987973997, 131.25552829998108, 454.6939039730737, 340.2573204000125, 169.71262925627624, 272.9572444260359, 210.45593654635474, 260.31800698250356, 269.5777999097235, 52.12617962392952, 529.6866409490422, 368.62334361503633, 178.32440853827504, 126.99098711219237, 470.06437352158076, 335.3456007558189, 110.8391258660424, 271.0450345829317, 124.85711184051318, 116.24789012353892, 265.84585858571563, 193.37898469143445, 300.76872563338264, 299.7060627130564, 230.90778072945542, 127.11820291403092, 121.85828645189697, 126.1025330618758, 393.22025213614205, 319.40223889749046, 323.626604732631, 293.30570980722837, 32.168854310726, 477.95661684670984, 270.65120580410365, 242.55433847627438, 310.4328357435466, 369.0839302452287, 177.49302629011768, 168.0157950330937, 330.59647774894796, 332.15082724330637, 248.14131490792872, 272.25372706465265, 229.62525154223937, 270.86693676128874, 143.13478730744595, 50.11423852542304, 229.7199789029505, 127.01289539696484, 186.80774623839542, 68.92840641351053, 155.45268632747485, 180.18871605668076, 158.34197491076787, 250.6786260380823, 60.03124504827578, 20.95198977383889, 476.20453222618306, 448.21708381212244, 155.87362988874796, 239.15105933542773, 140.00958504656018, 158.1494912705012, 341.9696872478914, 355.66864857267126, 132.34736395507423, 147.28803714665784, 97.29846586236577, 62.81827630025775, 146.32091491758754, 187.49399683471196, 242.33777897104565, 220.25039961708146, 263.3117875777427, 245.86004287152025, 103.32411392975693, 105.89929816443573, 225.87618413792535, 209.91995297461006, 148.01011794749706, 246.0008581336116, 212.51814633990497, 59.95960183611879, 353.4924191631823, 246.05869662730075, 338.03652464670984, 418.1072532960787, 298.8856699172023, 290.3735228766072, 318.52462521391647, 253.27422969381004, 201.949072041055, 81.05689297393751, 151.16998508585675, 289.79143574913945, 187.84379110308058, 339.28222734094675, 372.0307105904609, 141.8373794360768, 426.490717348256, 401.7618277696229, 100.20316323046366, 280.78483266337884, 267.9778655687713, 225.5089817414193, 242.89072909958264, 280.8304962576935, 129.5270144845617, 163.42424502580153, 199.39053966091225, 266.2517675057784, 214.7460766457929, 254.9632343793591, 203.15048445930717, 200.38751415299333, 253.0959305399133, 190.93528294593227, 204.4880676660378, 206.3907354888577, 262.00628947029423, 188.88191159484956, 239.78828295485346, 261.65231052342074, 216.414764697045, 294.76888705724053, 195.03545776486948, 222.70344367909934, 281.02799813405016, 288.9015639642715, 291.7248229444985, 248.705634473878, 172.05358688707636, 337.33873518953385, 334.15471291037403, 360.44803648367105, 402.32565056156477, 326.4327738702461, 272.92344621989565, 162.98262544136472, 173.67888952336241, 329.5895849454442, 432.3510454604047, 379.0763938142458, 372.4033014899392, 421.9408139530269, 326.1504023055024, 304.2291989608858, 158.31911521266625, 374.47552954435645, 377.7659736000232, 391.4538059017509, 340.3459354021445, 278.5866264852672, 275.25579854221667, 221.22236002122963, 269.9954769620887, 295.86608988628655, 181.66989243415554, 211.47751534676186, 340.2966480224098, 236.58502953505368, 87.702812410271, 293.47073683041697, 189.53686577679198, 290.4836069096651, 309.22804464145884, 429.92231607930023, 369.37665641725397, 193.4031188967395, 501.10651831619293, 107.65726409273016, 129.23737610762532, 96.13906011668874, 357.44228317366276, 343.4148949369127, 449.39778799882487, 203.54682738382203, 367.2184462631232, 430.16569724201895, 171.4637913368101, 314.32312392893067, 278.8050261283021, 486.29416865133584, 257.85968394797266, 450.0061998658349, 541.8614423627014, 499.8858022297947, 196.42256430986396, 289.8805310650889, 309.9335924749919, 333.88856003046476, 448.40377197378086, 306.8724854207881, 633.1392466972856, 355.866692343031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8825752592974784, "mean_inference_ms": 2.634913725355854, "mean_action_processing_ms": 0.4068438358317945, "mean_env_wait_ms": 0.3224206627303216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006674408912658691, "StateBufferConnector_ms": 0.0033823251724243164, "ViewRequirementAgentConnector_ms": 0.11036515235900879}, "num_episodes": 18, "episode_return_max": 1975.405730948797, "episode_return_min": 934.8644627765199, "episode_return_mean": 1590.1250492122015, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.7567492971678, "num_env_steps_trained_throughput_per_sec": 290.7567492971678, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 14284.431, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14284.376, "sample_time_ms": 2382.166, "learn_time_ms": 11883.142, "learn_throughput": 336.611, "synch_weights_time_ms": 16.322}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "8abce_00000", "date": "2024-08-16_11-28-38", "timestamp": 1723787918, "time_this_iter_s": 13.798314094543457, "time_total_s": 429.46882033348083, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a439b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 429.46882033348083, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 65.72, "ram_util_percent": 82.19000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6087211938289108, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.678294362971391, "policy_loss": -0.0008977056158184217, "vf_loss": 9.678128101712181, "vf_explained_var": -0.014839113547057702, "kl": 0.010639448804925442, "entropy": 1.4330417860121953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6163138493343636, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.652849174176575, "policy_loss": -0.0033891023183487867, "vf_loss": 9.654917916797457, "vf_explained_var": -0.020089333839517422, "kl": 0.006601904471677693, "entropy": 1.3039989820863835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 2040.6854181757299, "episode_reward_min": 1022.044487786711, "episode_reward_mean": 1671.2052677152274, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 322.2389987576378, "predator_policy": 20.95198977383889}, "policy_reward_max": {"prey_policy": 771.1775536079689, "predator_policy": 633.1392466972856}, "policy_reward_mean": {"prey_policy": 536.564158592505, "predator_policy": 299.03847526510873}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1431.3443209388683, 1569.9712829631342, 1503.1902273908377, 1022.044487786711, 1892.299963414127, 1666.2980542096059, 1372.6084638050236, 1816.5011911781162, 1302.4759727122653, 1133.6092117140113, 1589.2292714044597, 1576.7075207945056, 1665.978555034928, 1140.2088367508682, 1516.9653593761716, 1551.6702679821672, 1195.1793148432, 1765.8739355125874, 1545.7197406171217, 1503.885815413579, 1602.0099842851384, 1493.2707307408994, 1698.8541433353766, 1512.1206421582697, 1602.8319173052466, 1837.9393786293829, 1495.5345873825818, 1587.6535521910018, 1686.4020468364483, 1177.2233555728662, 1735.3910558975579, 1626.1678703007678, 1575.6820883487399, 1601.1185867752858, 1548.0528410269924, 1507.0177398243588, 1545.7422353681807, 1610.393655289049, 1663.21267102021, 1701.3970242594319, 1786.105687380652, 1724.1532010809808, 1636.5920977853534, 1775.3151699976663, 1529.803389267623, 1704.7989980517164, 1894.0270983388198, 1748.9710332060363, 1654.8438464601932, 1506.7178356909656, 1877.3350494334388, 1794.9734578077787, 1428.483376969731, 1588.4574635567399, 1760.679964749785, 1699.9254515007553, 1596.7088482074616, 1515.8299842662882, 1778.3161877122736, 1831.9649770851222, 1768.6538466660786, 1164.0907108693389, 1739.5419251407395, 1507.595625627924, 1840.8340136097806, 1374.4417907672132, 1904.8320123294766, 1870.3676723727074, 1975.405730948797, 1488.2687685878702, 1773.6047779003077, 1788.3963616376209, 1903.2426228242527, 1788.2064751206528, 1966.382998604034, 1959.3330391102324, 1813.857420488916, 1847.8451192563775, 1784.7145804731476, 1775.7887436552176, 1689.841871555551, 1938.2139943692257, 1662.9744596723579, 1610.5340936386065, 2016.727958431375, 1863.9901405585294, 1860.6753647826745, 1997.9242178808968, 1248.7238976353285, 1936.2329484863906, 1968.7447575101448, 1620.0758697503627, 1950.2695394568118, 2027.317519509578, 2040.6854181757299, 1707.750043533048, 1951.3913540631245, 1799.2953773917013, 1906.2049963612546, 1883.767693829884], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [709.0797334267162, 466.528434860247, 633.3263932577444, 601.0034873212337, 602.0523716537625, 492.1172547882244, 329.4518185160701, 611.609434448526, 461.3442770971136, 506.5340702787078, 608.5273221128493, 662.746042872581, 572.9469478253151, 501.5024396626468, 483.63568776720365, 635.2271675903517, 440.25764350824346, 582.5829281022886, 631.339550369047, 342.1529191823415, 636.0464122901186, 619.3679473620421, 676.725949335462, 437.3933928709141, 428.57747405737365, 728.2292505282902, 496.07472944962666, 434.9106952070489, 465.7356885625097, 615.4335337011278, 577.4143734462228, 580.2449184548359, 384.6262129220987, 538.075353745077, 481.96649052043006, 684.3563292016722, 391.00753764695486, 398.5684250273782, 512.1858229281461, 402.4407996916249, 365.135990101914, 665.075139275501, 583.8300802608579, 626.4346854650491, 486.71516889241144, 771.1775536079689, 538.1658240423752, 446.82879967186693, 624.9222195637208, 464.04160771498823, 502.63739039046607, 507.04944312103714, 618.9544127634274, 495.5921787253128, 449.8028965207585, 644.3638083600515, 558.0841211973361, 604.5967002818359, 432.9033062021883, 451.368789860316, 664.0598286411392, 605.688920089729, 505.0301170553764, 651.4284422202379, 586.6886716718677, 585.4554180645712, 539.1775841723212, 617.9097891171177, 594.5856369657105, 542.5884009063859, 515.6782052924906, 540.4513334667239, 408.0327893782826, 636.2688525116259, 624.3208064628043, 474.88919707195697, 695.7104015356053, 549.7633680406365, 612.5176641079281, 518.9497980531836, 615.3648765239572, 630.3103534383193, 566.7208004421593, 648.0400785622109, 494.92028888596394, 447.06905950534355, 568.4964400275305, 478.0603055383245, 548.8308254633224, 545.0664921430416, 635.912748871644, 565.617774711266, 525.7769841384765, 556.8226749256949, 543.0596031023517, 411.5673146607206, 564.6491153664107, 459.81512982739423, 481.8872585109204, 492.0359324230202, 530.8447908210421, 577.2704791106228, 485.3421462831533, 690.6987496372152, 447.79351479058425, 484.21170361570023, 516.5453091899725, 506.05058751839175, 616.2548338091265, 751.2777231597425, 624.9382005387746, 498.10557340451743, 473.76479431144696, 741.770504655329, 484.4152906786773, 551.3942209011542, 512.7710040587707, 526.3948229327472, 631.5952708068432, 637.5899309642842, 565.8860314839669, 594.0040327731872, 525.1047929465298, 413.60948169849655, 558.748900207268, 479.93584682289776, 414.4790251524971, 440.1719850927805, 511.0618895741143, 532.3879805305252, 385.9885436860708, 502.66633181540107, 648.3440757287299, 491.3887418211092, 546.8441110309685, 615.6576775279314, 471.8556701590702, 461.80281619723155, 437.6035992112106, 564.362074001709, 632.970786195924, 496.8118391989263, 485.9547467459149, 547.1653574971361, 408.7415740353231, 505.49510974861306, 474.8367425721816, 627.7007019734115, 527.5590036114855, 461.4247172294806, 634.4004060402375, 390.9322865430324, 548.8777103553892, 683.9936962005424, 465.837989950753, 475.0715710560537, 443.4050859533264, 529.2911364605233, 494.222367964805, 503.04520711705703, 595.7267522254625, 556.2829128854268, 429.94198690060085, 616.2153639436283, 501.87557829287664, 558.9599519750259, 414.38374002267125, 572.1272990909813, 460.63413069837503, 483.62151080317784, 477.3855537061726, 496.45232654847683, 571.323709224444, 568.8597880566823, 609.813055760995, 483.04043822354384, 490.6355562725962, 322.2389987576378, 530.988218272098, 620.6656569198195, 450.8929719056255, 542.4826120926588, 524.3846812843948, 574.0679565616146, 623.1213675000489, 627.3849073192346, 648.1140554585689, 472.3134470430854, 406.35021309169827, 596.7471432853034, 449.2521971050958, 436.5669738283458, 615.4075223908234, 496.3301783551455, 642.9327029600595, 563.8616324704176, 567.7829185427005, 518.140509033186, 515.6922327830961, 440.91521230597357], "policy_predator_policy_reward": [186.80774623839542, 68.92840641351053, 155.45268632747485, 180.18871605668076, 158.34197491076787, 250.6786260380823, 60.03124504827578, 20.95198977383889, 476.20453222618306, 448.21708381212244, 155.87362988874796, 239.15105933542773, 140.00958504656018, 158.1494912705012, 341.9696872478914, 355.66864857267126, 132.34736395507423, 147.28803714665784, 97.29846586236577, 62.81827630025775, 146.32091491758754, 187.49399683471196, 242.33777897104565, 220.25039961708146, 263.3117875777427, 245.86004287152025, 103.32411392975693, 105.89929816443573, 225.87618413792535, 209.91995297461006, 148.01011794749706, 246.0008581336116, 212.51814633990497, 59.95960183611879, 353.4924191631823, 246.05869662730075, 338.03652464670984, 418.1072532960787, 298.8856699172023, 290.3735228766072, 318.52462521391647, 253.27422969381004, 201.949072041055, 81.05689297393751, 151.16998508585675, 289.79143574913945, 187.84379110308058, 339.28222734094675, 372.0307105904609, 141.8373794360768, 426.490717348256, 401.7618277696229, 100.20316323046366, 280.78483266337884, 267.9778655687713, 225.5089817414193, 242.89072909958264, 280.8304962576935, 129.5270144845617, 163.42424502580153, 199.39053966091225, 266.2517675057784, 214.7460766457929, 254.9632343793591, 203.15048445930717, 200.38751415299333, 253.0959305399133, 190.93528294593227, 204.4880676660378, 206.3907354888577, 262.00628947029423, 188.88191159484956, 239.78828295485346, 261.65231052342074, 216.414764697045, 294.76888705724053, 195.03545776486948, 222.70344367909934, 281.02799813405016, 288.9015639642715, 291.7248229444985, 248.705634473878, 172.05358688707636, 337.33873518953385, 334.15471291037403, 360.44803648367105, 402.32565056156477, 326.4327738702461, 272.92344621989565, 162.98262544136472, 173.67888952336241, 329.5895849454442, 432.3510454604047, 379.0763938142458, 372.4033014899392, 421.9408139530269, 326.1504023055024, 304.2291989608858, 158.31911521266625, 374.47552954435645, 377.7659736000232, 391.4538059017509, 340.3459354021445, 278.5866264852672, 275.25579854221667, 221.22236002122963, 269.9954769620887, 295.86608988628655, 181.66989243415554, 211.47751534676186, 340.2966480224098, 236.58502953505368, 87.702812410271, 293.47073683041697, 189.53686577679198, 290.4836069096651, 309.22804464145884, 429.92231607930023, 369.37665641725397, 193.4031188967395, 501.10651831619293, 107.65726409273016, 129.23737610762532, 96.13906011668874, 357.44228317366276, 343.4148949369127, 449.39778799882487, 203.54682738382203, 367.2184462631232, 430.16569724201895, 171.4637913368101, 314.32312392893067, 278.8050261283021, 486.29416865133584, 257.85968394797266, 450.0061998658349, 541.8614423627014, 499.8858022297947, 196.42256430986396, 289.8805310650889, 309.9335924749919, 333.88856003046476, 448.40377197378086, 306.8724854207881, 633.1392466972856, 355.866692343031, 298.62927737206167, 387.0397532030004, 448.16226589899316, 529.2370118640747, 470.2117828651148, 463.7885636618501, 282.74602986541544, 298.23998406756857, 572.5234702327388, 334.41208801683285, 350.8107286192287, 461.2076294400686, 383.4912001211463, 395.02996845220946, 262.5680784288939, 275.26412801576646, 341.0884912461699, 550.968152278825, 303.17548527931046, 298.9634441251459, 328.98939607678125, 295.03365844817233, 487.1602362939119, 585.3120806359141, 482.87300984471904, 407.279250459163, 269.5630802368064, 450.9287872647431, 442.409556445011, 462.66116745134997, 258.333467292854, 177.51587531224172, 420.33434740418915, 364.2447258902836, 555.2777068567792, 420.09146665508064, 274.6875621802181, 246.935669724136, 344.6844610237945, 355.07880361373424, 445.0665274014536, 461.8234896064688, 584.3460927204497, 453.24196907827786, 398.79011129036195, 423.14076130924457, 422.77385453817607, 416.87979877897925, 233.8557280842223, 358.6453138770052, 480.3904301738546, 339.89113861151327, 400.3654455899356, 526.7948031508786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8832053525167011, "mean_inference_ms": 2.6362426083628225, "mean_action_processing_ms": 0.40453596718094587, "mean_env_wait_ms": 0.32209099044038575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006798982620239258, "StateBufferConnector_ms": 0.0034270286560058594, "ViewRequirementAgentConnector_ms": 0.1202157735824585}, "num_episodes": 27, "episode_return_max": 2040.6854181757299, "episode_return_min": 1022.044487786711, "episode_return_mean": 1671.2052677152274, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.5547678755215, "num_env_steps_trained_throughput_per_sec": 286.5547678755215, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 14223.414, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14223.35, "sample_time_ms": 2444.329, "learn_time_ms": 11759.166, "learn_throughput": 340.16, "synch_weights_time_ms": 16.82}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "8abce_00000", "date": "2024-08-16_11-28-52", "timestamp": 1723787932, "time_this_iter_s": 14.055693864822388, "time_total_s": 443.5245141983032, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43a13a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 443.5245141983032, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 62.019999999999996, "ram_util_percent": 82.32499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5115937170370546, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.768164003463019, "policy_loss": 0.00028556919774957117, "vf_loss": 9.766417285878822, "vf_explained_var": -0.0001741950789456645, "kl": 0.014611484347902126, "entropy": 1.4527896479954796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.595484750217231, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.753445649525476, "policy_loss": -0.008779895195500955, "vf_loss": 9.75982333692924, "vf_explained_var": -0.016916092520668394, "kl": 0.0120110813304132, "entropy": 1.2686177264445673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 2040.6854181757299, "episode_reward_min": 1164.0907108693389, "episode_reward_mean": 1734.0194024903863, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 292.98806320784405, "predator_policy": 81.05689297393751}, "policy_reward_max": {"prey_policy": 771.1775536079689, "predator_policy": 633.1392466972856}, "policy_reward_mean": {"prey_policy": 528.6990516001148, "predator_policy": 338.3106496450785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1545.7197406171217, 1503.885815413579, 1602.0099842851384, 1493.2707307408994, 1698.8541433353766, 1512.1206421582697, 1602.8319173052466, 1837.9393786293829, 1495.5345873825818, 1587.6535521910018, 1686.4020468364483, 1177.2233555728662, 1735.3910558975579, 1626.1678703007678, 1575.6820883487399, 1601.1185867752858, 1548.0528410269924, 1507.0177398243588, 1545.7422353681807, 1610.393655289049, 1663.21267102021, 1701.3970242594319, 1786.105687380652, 1724.1532010809808, 1636.5920977853534, 1775.3151699976663, 1529.803389267623, 1704.7989980517164, 1894.0270983388198, 1748.9710332060363, 1654.8438464601932, 1506.7178356909656, 1877.3350494334388, 1794.9734578077787, 1428.483376969731, 1588.4574635567399, 1760.679964749785, 1699.9254515007553, 1596.7088482074616, 1515.8299842662882, 1778.3161877122736, 1831.9649770851222, 1768.6538466660786, 1164.0907108693389, 1739.5419251407395, 1507.595625627924, 1840.8340136097806, 1374.4417907672132, 1904.8320123294766, 1870.3676723727074, 1975.405730948797, 1488.2687685878702, 1773.6047779003077, 1788.3963616376209, 1903.2426228242527, 1788.2064751206528, 1966.382998604034, 1959.3330391102324, 1813.857420488916, 1847.8451192563775, 1784.7145804731476, 1775.7887436552176, 1689.841871555551, 1938.2139943692257, 1662.9744596723579, 1610.5340936386065, 2016.727958431375, 1863.9901405585294, 1860.6753647826745, 1997.9242178808968, 1248.7238976353285, 1936.2329484863906, 1968.7447575101448, 1620.0758697503627, 1950.2695394568118, 2027.317519509578, 2040.6854181757299, 1707.750043533048, 1951.3913540631245, 1799.2953773917013, 1906.2049963612546, 1883.767693829884, 1827.8308911091883, 1876.307351321153, 1748.3814113558678, 1859.3701152644535, 1989.6456532987022, 1824.6650653218978, 1649.7605869306303, 2025.9793819171643, 2026.6326828998388, 2005.1421833244694, 1606.8828813928671, 1775.284161135419, 1782.00201204797, 1923.6625711746854, 1782.0699499713355, 1595.81330673087, 1950.8913729649341, 1743.248137166042], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [391.00753764695486, 398.5684250273782, 512.1858229281461, 402.4407996916249, 365.135990101914, 665.075139275501, 583.8300802608579, 626.4346854650491, 486.71516889241144, 771.1775536079689, 538.1658240423752, 446.82879967186693, 624.9222195637208, 464.04160771498823, 502.63739039046607, 507.04944312103714, 618.9544127634274, 495.5921787253128, 449.8028965207585, 644.3638083600515, 558.0841211973361, 604.5967002818359, 432.9033062021883, 451.368789860316, 664.0598286411392, 605.688920089729, 505.0301170553764, 651.4284422202379, 586.6886716718677, 585.4554180645712, 539.1775841723212, 617.9097891171177, 594.5856369657105, 542.5884009063859, 515.6782052924906, 540.4513334667239, 408.0327893782826, 636.2688525116259, 624.3208064628043, 474.88919707195697, 695.7104015356053, 549.7633680406365, 612.5176641079281, 518.9497980531836, 615.3648765239572, 630.3103534383193, 566.7208004421593, 648.0400785622109, 494.92028888596394, 447.06905950534355, 568.4964400275305, 478.0603055383245, 548.8308254633224, 545.0664921430416, 635.912748871644, 565.617774711266, 525.7769841384765, 556.8226749256949, 543.0596031023517, 411.5673146607206, 564.6491153664107, 459.81512982739423, 481.8872585109204, 492.0359324230202, 530.8447908210421, 577.2704791106228, 485.3421462831533, 690.6987496372152, 447.79351479058425, 484.21170361570023, 516.5453091899725, 506.05058751839175, 616.2548338091265, 751.2777231597425, 624.9382005387746, 498.10557340451743, 473.76479431144696, 741.770504655329, 484.4152906786773, 551.3942209011542, 512.7710040587707, 526.3948229327472, 631.5952708068432, 637.5899309642842, 565.8860314839669, 594.0040327731872, 525.1047929465298, 413.60948169849655, 558.748900207268, 479.93584682289776, 414.4790251524971, 440.1719850927805, 511.0618895741143, 532.3879805305252, 385.9885436860708, 502.66633181540107, 648.3440757287299, 491.3887418211092, 546.8441110309685, 615.6576775279314, 471.8556701590702, 461.80281619723155, 437.6035992112106, 564.362074001709, 632.970786195924, 496.8118391989263, 485.9547467459149, 547.1653574971361, 408.7415740353231, 505.49510974861306, 474.8367425721816, 627.7007019734115, 527.5590036114855, 461.4247172294806, 634.4004060402375, 390.9322865430324, 548.8777103553892, 683.9936962005424, 465.837989950753, 475.0715710560537, 443.4050859533264, 529.2911364605233, 494.222367964805, 503.04520711705703, 595.7267522254625, 556.2829128854268, 429.94198690060085, 616.2153639436283, 501.87557829287664, 558.9599519750259, 414.38374002267125, 572.1272990909813, 460.63413069837503, 483.62151080317784, 477.3855537061726, 496.45232654847683, 571.323709224444, 568.8597880566823, 609.813055760995, 483.04043822354384, 490.6355562725962, 322.2389987576378, 530.988218272098, 620.6656569198195, 450.8929719056255, 542.4826120926588, 524.3846812843948, 574.0679565616146, 623.1213675000489, 627.3849073192346, 648.1140554585689, 472.3134470430854, 406.35021309169827, 596.7471432853034, 449.2521971050958, 436.5669738283458, 615.4075223908234, 496.3301783551455, 642.9327029600595, 563.8616324704176, 567.7829185427005, 518.140509033186, 515.6922327830961, 440.91521230597357, 526.3964134125122, 440.4305982533186, 624.533473971833, 503.25873431148096, 698.5474212052555, 543.6639324884436, 637.3954263446728, 577.5636923822934, 442.46230449172674, 526.013957253235, 508.3921952665427, 457.41572273101076, 605.9652603433385, 303.5407528106165, 507.08076142726793, 443.459286935225, 465.517079672043, 474.56347508049936, 556.0482276721832, 633.6310168171495, 462.6120304815985, 468.74026045754306, 559.1454478805335, 512.1644377644393, 423.7203588581043, 484.0050291483432, 542.5326453034551, 536.9309128631987, 430.46952647088614, 292.98806320784405, 527.6290145834682, 457.38699270417914, 396.4954622472069, 537.0205336337195, 433.26256506111685, 545.1402642817284], "policy_predator_policy_reward": [338.03652464670984, 418.1072532960787, 298.8856699172023, 290.3735228766072, 318.52462521391647, 253.27422969381004, 201.949072041055, 81.05689297393751, 151.16998508585675, 289.79143574913945, 187.84379110308058, 339.28222734094675, 372.0307105904609, 141.8373794360768, 426.490717348256, 401.7618277696229, 100.20316323046366, 280.78483266337884, 267.9778655687713, 225.5089817414193, 242.89072909958264, 280.8304962576935, 129.5270144845617, 163.42424502580153, 199.39053966091225, 266.2517675057784, 214.7460766457929, 254.9632343793591, 203.15048445930717, 200.38751415299333, 253.0959305399133, 190.93528294593227, 204.4880676660378, 206.3907354888577, 262.00628947029423, 188.88191159484956, 239.78828295485346, 261.65231052342074, 216.414764697045, 294.76888705724053, 195.03545776486948, 222.70344367909934, 281.02799813405016, 288.9015639642715, 291.7248229444985, 248.705634473878, 172.05358688707636, 337.33873518953385, 334.15471291037403, 360.44803648367105, 402.32565056156477, 326.4327738702461, 272.92344621989565, 162.98262544136472, 173.67888952336241, 329.5895849454442, 432.3510454604047, 379.0763938142458, 372.4033014899392, 421.9408139530269, 326.1504023055024, 304.2291989608858, 158.31911521266625, 374.47552954435645, 377.7659736000232, 391.4538059017509, 340.3459354021445, 278.5866264852672, 275.25579854221667, 221.22236002122963, 269.9954769620887, 295.86608988628655, 181.66989243415554, 211.47751534676186, 340.2966480224098, 236.58502953505368, 87.702812410271, 293.47073683041697, 189.53686577679198, 290.4836069096651, 309.22804464145884, 429.92231607930023, 369.37665641725397, 193.4031188967395, 501.10651831619293, 107.65726409273016, 129.23737610762532, 96.13906011668874, 357.44228317366276, 343.4148949369127, 449.39778799882487, 203.54682738382203, 367.2184462631232, 430.16569724201895, 171.4637913368101, 314.32312392893067, 278.8050261283021, 486.29416865133584, 257.85968394797266, 450.0061998658349, 541.8614423627014, 499.8858022297947, 196.42256430986396, 289.8805310650889, 309.9335924749919, 333.88856003046476, 448.40377197378086, 306.8724854207881, 633.1392466972856, 355.866692343031, 298.62927737206167, 387.0397532030004, 448.16226589899316, 529.2370118640747, 470.2117828651148, 463.7885636618501, 282.74602986541544, 298.23998406756857, 572.5234702327388, 334.41208801683285, 350.8107286192287, 461.2076294400686, 383.4912001211463, 395.02996845220946, 262.5680784288939, 275.26412801576646, 341.0884912461699, 550.968152278825, 303.17548527931046, 298.9634441251459, 328.98939607678125, 295.03365844817233, 487.1602362939119, 585.3120806359141, 482.87300984471904, 407.279250459163, 269.5630802368064, 450.9287872647431, 442.409556445011, 462.66116745134997, 258.333467292854, 177.51587531224172, 420.33434740418915, 364.2447258902836, 555.2777068567792, 420.09146665508064, 274.6875621802181, 246.935669724136, 344.6844610237945, 355.07880361373424, 445.0665274014536, 461.8234896064688, 584.3460927204497, 453.24196907827786, 398.79011129036195, 423.14076130924457, 422.77385453817607, 416.87979877897925, 233.8557280842223, 358.6453138770052, 480.3904301738546, 339.89113861151327, 400.3654455899356, 526.7948031508786, 464.31801116993273, 396.68586827342625, 396.28903015860055, 352.22611287924025, 311.73108140806323, 194.43897625410574, 436.0115400692256, 208.3994564682608, 548.5530169618655, 472.61637459187403, 442.38295636933793, 416.474190955008, 438.60093017546177, 301.6536436012142, 549.5013388963665, 525.9379946583057, 514.3374708752712, 572.2146572720259, 433.47887160295204, 381.9840672321858, 336.1682088634252, 339.3623815903011, 367.49501407770686, 336.4792614127424, 394.0447242133439, 480.23189982817655, 419.9588165664828, 424.2401964415483, 522.5622377588533, 536.0501225337509, 362.52324012610023, 248.27405931712045, 510.0506034139777, 507.3247736700266, 350.8733237836792, 413.97198403951757]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8819836510495926, "mean_inference_ms": 2.6413286425621876, "mean_action_processing_ms": 0.4036883053909394, "mean_env_wait_ms": 0.32185385118735543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006546497344970703, "StateBufferConnector_ms": 0.010739326477050781, "ViewRequirementAgentConnector_ms": 0.12599170207977295}, "num_episodes": 18, "episode_return_max": 2040.6854181757299, "episode_return_min": 1164.0907108693389, "episode_return_mean": 1734.0194024903863, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.62166637026894, "num_env_steps_trained_throughput_per_sec": 282.62166637026894, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 13962.759, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13962.699, "sample_time_ms": 2514.412, "learn_time_ms": 11427.433, "learn_throughput": 350.035, "synch_weights_time_ms": 18.307}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "8abce_00000", "date": "2024-08-16_11-29-06", "timestamp": 1723787946, "time_this_iter_s": 14.19342589378357, "time_total_s": 457.7179400920868, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 457.7179400920868, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 60.125, "ram_util_percent": 82.115}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5256732200661665, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.665646020192948, "policy_loss": -0.002978430259677153, "vf_loss": 9.667755199109436, "vf_explained_var": -0.013739178735743124, "kl": 0.008692467826271031, "entropy": 1.4299288223029445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7557904340287365, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.54369027980421, "policy_loss": -0.00597364510503159, "vf_loss": 9.547878635245025, "vf_explained_var": -0.01810033501140655, "kl": 0.008926416965370889, "entropy": 1.2325179392067844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 2040.6854181757299, "episode_reward_min": 1164.0907108693389, "episode_reward_mean": 1763.3001436131758, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 292.98806320784405, "predator_policy": 87.702812410271}, "policy_reward_max": {"prey_policy": 751.2777231597425, "predator_policy": 633.1392466972856}, "policy_reward_mean": {"prey_policy": 521.5848707940421, "predator_policy": 360.06520101254597}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1545.7422353681807, 1610.393655289049, 1663.21267102021, 1701.3970242594319, 1786.105687380652, 1724.1532010809808, 1636.5920977853534, 1775.3151699976663, 1529.803389267623, 1704.7989980517164, 1894.0270983388198, 1748.9710332060363, 1654.8438464601932, 1506.7178356909656, 1877.3350494334388, 1794.9734578077787, 1428.483376969731, 1588.4574635567399, 1760.679964749785, 1699.9254515007553, 1596.7088482074616, 1515.8299842662882, 1778.3161877122736, 1831.9649770851222, 1768.6538466660786, 1164.0907108693389, 1739.5419251407395, 1507.595625627924, 1840.8340136097806, 1374.4417907672132, 1904.8320123294766, 1870.3676723727074, 1975.405730948797, 1488.2687685878702, 1773.6047779003077, 1788.3963616376209, 1903.2426228242527, 1788.2064751206528, 1966.382998604034, 1959.3330391102324, 1813.857420488916, 1847.8451192563775, 1784.7145804731476, 1775.7887436552176, 1689.841871555551, 1938.2139943692257, 1662.9744596723579, 1610.5340936386065, 2016.727958431375, 1863.9901405585294, 1860.6753647826745, 1997.9242178808968, 1248.7238976353285, 1936.2329484863906, 1968.7447575101448, 1620.0758697503627, 1950.2695394568118, 2027.317519509578, 2040.6854181757299, 1707.750043533048, 1951.3913540631245, 1799.2953773917013, 1906.2049963612546, 1883.767693829884, 1827.8308911091883, 1876.307351321153, 1748.3814113558678, 1859.3701152644535, 1989.6456532987022, 1824.6650653218978, 1649.7605869306303, 2025.9793819171643, 2026.6326828998388, 2005.1421833244694, 1606.8828813928671, 1775.284161135419, 1782.00201204797, 1923.6625711746854, 1782.0699499713355, 1595.81330673087, 1950.8913729649341, 1743.248137166042, 1919.2842385748083, 1793.5280291297531, 1757.1069037340826, 1928.5252628463913, 1176.6355568402905, 1427.147374858633, 1784.9670010816803, 1810.9828187207638, 1944.850685862949, 1883.8473189804656, 1680.8178105904633, 1404.0504125839352, 1853.692657417645, 1692.4476927285368, 1727.8123293436854, 1706.0594179634602, 1773.3785562379412, 1999.8161214250965], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [408.0327893782826, 636.2688525116259, 624.3208064628043, 474.88919707195697, 695.7104015356053, 549.7633680406365, 612.5176641079281, 518.9497980531836, 615.3648765239572, 630.3103534383193, 566.7208004421593, 648.0400785622109, 494.92028888596394, 447.06905950534355, 568.4964400275305, 478.0603055383245, 548.8308254633224, 545.0664921430416, 635.912748871644, 565.617774711266, 525.7769841384765, 556.8226749256949, 543.0596031023517, 411.5673146607206, 564.6491153664107, 459.81512982739423, 481.8872585109204, 492.0359324230202, 530.8447908210421, 577.2704791106228, 485.3421462831533, 690.6987496372152, 447.79351479058425, 484.21170361570023, 516.5453091899725, 506.05058751839175, 616.2548338091265, 751.2777231597425, 624.9382005387746, 498.10557340451743, 473.76479431144696, 741.770504655329, 484.4152906786773, 551.3942209011542, 512.7710040587707, 526.3948229327472, 631.5952708068432, 637.5899309642842, 565.8860314839669, 594.0040327731872, 525.1047929465298, 413.60948169849655, 558.748900207268, 479.93584682289776, 414.4790251524971, 440.1719850927805, 511.0618895741143, 532.3879805305252, 385.9885436860708, 502.66633181540107, 648.3440757287299, 491.3887418211092, 546.8441110309685, 615.6576775279314, 471.8556701590702, 461.80281619723155, 437.6035992112106, 564.362074001709, 632.970786195924, 496.8118391989263, 485.9547467459149, 547.1653574971361, 408.7415740353231, 505.49510974861306, 474.8367425721816, 627.7007019734115, 527.5590036114855, 461.4247172294806, 634.4004060402375, 390.9322865430324, 548.8777103553892, 683.9936962005424, 465.837989950753, 475.0715710560537, 443.4050859533264, 529.2911364605233, 494.222367964805, 503.04520711705703, 595.7267522254625, 556.2829128854268, 429.94198690060085, 616.2153639436283, 501.87557829287664, 558.9599519750259, 414.38374002267125, 572.1272990909813, 460.63413069837503, 483.62151080317784, 477.3855537061726, 496.45232654847683, 571.323709224444, 568.8597880566823, 609.813055760995, 483.04043822354384, 490.6355562725962, 322.2389987576378, 530.988218272098, 620.6656569198195, 450.8929719056255, 542.4826120926588, 524.3846812843948, 574.0679565616146, 623.1213675000489, 627.3849073192346, 648.1140554585689, 472.3134470430854, 406.35021309169827, 596.7471432853034, 449.2521971050958, 436.5669738283458, 615.4075223908234, 496.3301783551455, 642.9327029600595, 563.8616324704176, 567.7829185427005, 518.140509033186, 515.6922327830961, 440.91521230597357, 526.3964134125122, 440.4305982533186, 624.533473971833, 503.25873431148096, 698.5474212052555, 543.6639324884436, 637.3954263446728, 577.5636923822934, 442.46230449172674, 526.013957253235, 508.3921952665427, 457.41572273101076, 605.9652603433385, 303.5407528106165, 507.08076142726793, 443.459286935225, 465.517079672043, 474.56347508049936, 556.0482276721832, 633.6310168171495, 462.6120304815985, 468.74026045754306, 559.1454478805335, 512.1644377644393, 423.7203588581043, 484.0050291483432, 542.5326453034551, 536.9309128631987, 430.46952647088614, 292.98806320784405, 527.6290145834682, 457.38699270417914, 396.4954622472069, 537.0205336337195, 433.26256506111685, 545.1402642817284, 379.4214242461257, 479.06665909215985, 423.5218382867167, 537.0145032474023, 561.0602552225412, 471.0344014617406, 603.1687596582626, 739.609571263006, 387.5032038320275, 406.2813327073494, 505.60073318051667, 346.57817640052457, 397.0317993989227, 468.48536876990624, 492.03913159623943, 557.986673313508, 505.405631642022, 564.6686213466419, 470.3501586120821, 423.2294792457135, 538.6606607689721, 498.5488153464151, 552.2731375815771, 582.4414218592266, 597.7173684622086, 447.5537396392487, 596.0813079388074, 419.97572598322773, 614.0667961377881, 485.0389303863374, 465.58921930322964, 424.4158386200189, 530.0140793742459, 504.17691889518113, 452.4635132955454, 639.7136916472041], "policy_predator_policy_reward": [239.78828295485346, 261.65231052342074, 216.414764697045, 294.76888705724053, 195.03545776486948, 222.70344367909934, 281.02799813405016, 288.9015639642715, 291.7248229444985, 248.705634473878, 172.05358688707636, 337.33873518953385, 334.15471291037403, 360.44803648367105, 402.32565056156477, 326.4327738702461, 272.92344621989565, 162.98262544136472, 173.67888952336241, 329.5895849454442, 432.3510454604047, 379.0763938142458, 372.4033014899392, 421.9408139530269, 326.1504023055024, 304.2291989608858, 158.31911521266625, 374.47552954435645, 377.7659736000232, 391.4538059017509, 340.3459354021445, 278.5866264852672, 275.25579854221667, 221.22236002122963, 269.9954769620887, 295.86608988628655, 181.66989243415554, 211.47751534676186, 340.2966480224098, 236.58502953505368, 87.702812410271, 293.47073683041697, 189.53686577679198, 290.4836069096651, 309.22804464145884, 429.92231607930023, 369.37665641725397, 193.4031188967395, 501.10651831619293, 107.65726409273016, 129.23737610762532, 96.13906011668874, 357.44228317366276, 343.4148949369127, 449.39778799882487, 203.54682738382203, 367.2184462631232, 430.16569724201895, 171.4637913368101, 314.32312392893067, 278.8050261283021, 486.29416865133584, 257.85968394797266, 450.0061998658349, 541.8614423627014, 499.8858022297947, 196.42256430986396, 289.8805310650889, 309.9335924749919, 333.88856003046476, 448.40377197378086, 306.8724854207881, 633.1392466972856, 355.866692343031, 298.62927737206167, 387.0397532030004, 448.16226589899316, 529.2370118640747, 470.2117828651148, 463.7885636618501, 282.74602986541544, 298.23998406756857, 572.5234702327388, 334.41208801683285, 350.8107286192287, 461.2076294400686, 383.4912001211463, 395.02996845220946, 262.5680784288939, 275.26412801576646, 341.0884912461699, 550.968152278825, 303.17548527931046, 298.9634441251459, 328.98939607678125, 295.03365844817233, 487.1602362939119, 585.3120806359141, 482.87300984471904, 407.279250459163, 269.5630802368064, 450.9287872647431, 442.409556445011, 462.66116745134997, 258.333467292854, 177.51587531224172, 420.33434740418915, 364.2447258902836, 555.2777068567792, 420.09146665508064, 274.6875621802181, 246.935669724136, 344.6844610237945, 355.07880361373424, 445.0665274014536, 461.8234896064688, 584.3460927204497, 453.24196907827786, 398.79011129036195, 423.14076130924457, 422.77385453817607, 416.87979877897925, 233.8557280842223, 358.6453138770052, 480.3904301738546, 339.89113861151327, 400.3654455899356, 526.7948031508786, 464.31801116993273, 396.68586827342625, 396.28903015860055, 352.22611287924025, 311.73108140806323, 194.43897625410574, 436.0115400692256, 208.3994564682608, 548.5530169618655, 472.61637459187403, 442.38295636933793, 416.474190955008, 438.60093017546177, 301.6536436012142, 549.5013388963665, 525.9379946583057, 514.3374708752712, 572.2146572720259, 433.47887160295204, 381.9840672321858, 336.1682088634252, 339.3623815903011, 367.49501407770686, 336.4792614127424, 394.0447242133439, 480.23189982817655, 419.9588165664828, 424.2401964415483, 522.5622377588533, 536.0501225337509, 362.52324012610023, 248.27405931712045, 510.0506034139777, 507.3247736700266, 350.8733237836792, 413.97198403951757, 536.7467552081616, 524.0494000283592, 438.66500793133264, 394.32667966429995, 524.0155861887376, 200.99666086106103, 313.98272668753765, 271.764205237586, 176.9642870480327, 205.88673325287996, 367.77992471760825, 207.18854055998384, 549.6676781862327, 369.78215472661896, 512.6052852385717, 248.3517285724461, 387.05844561227184, 487.71798726201604, 518.4001783830402, 471.86750273963037, 354.0796488490863, 289.52868562599093, 99.6435662006847, 169.6922869424469, 351.5810086165736, 456.840540699616, 366.3332531852878, 310.0574056212149, 336.83991139870875, 291.86669142085145, 358.2288083955226, 457.8255516446901, 328.79670444517836, 410.39085352333615, 411.90017754701904, 495.7387389353301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8820716861748744, "mean_inference_ms": 2.6460735785702654, "mean_action_processing_ms": 0.4029784556136343, "mean_env_wait_ms": 0.3219511322137304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005259990692138672, "StateBufferConnector_ms": 0.010779142379760742, "ViewRequirementAgentConnector_ms": 0.14001548290252686}, "num_episodes": 18, "episode_return_max": 2040.6854181757299, "episode_return_min": 1164.0907108693389, "episode_return_mean": 1763.3001436131758, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.2631555693701, "num_env_steps_trained_throughput_per_sec": 296.2631555693701, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 13932.38, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13932.32, "sample_time_ms": 2578.381, "learn_time_ms": 11332.339, "learn_throughput": 352.972, "synch_weights_time_ms": 19.12}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "8abce_00000", "date": "2024-08-16_11-29-20", "timestamp": 1723787960, "time_this_iter_s": 13.563846111297607, "time_total_s": 471.2817862033844, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4337e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 471.2817862033844, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 60.321052631578944, "ram_util_percent": 81.85263157894735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5996877142361232, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.672317078504612, "policy_loss": -0.0019024099235634797, "vf_loss": 9.672478400336372, "vf_explained_var": -0.00898704863099194, "kl": 0.017410570080267668, "entropy": 1.4146756524131412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3445067582937775, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.828055198608883, "policy_loss": -0.004442982031180272, "vf_loss": 9.830923462418651, "vf_explained_var": -0.0018255007330071989, "kl": 0.007873640765466271, "entropy": 1.2315279540561495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 2040.6854181757299, "episode_reward_min": 1164.0907108693389, "episode_reward_mean": 1768.3114272346802, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 261.91324078772743, "predator_policy": 87.702812410271}, "policy_reward_max": {"prey_policy": 751.2777231597425, "predator_policy": 633.1392466972856}, "policy_reward_mean": {"prey_policy": 509.0929135958072, "predator_policy": 375.0628000215329}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1760.679964749785, 1699.9254515007553, 1596.7088482074616, 1515.8299842662882, 1778.3161877122736, 1831.9649770851222, 1768.6538466660786, 1164.0907108693389, 1739.5419251407395, 1507.595625627924, 1840.8340136097806, 1374.4417907672132, 1904.8320123294766, 1870.3676723727074, 1975.405730948797, 1488.2687685878702, 1773.6047779003077, 1788.3963616376209, 1903.2426228242527, 1788.2064751206528, 1966.382998604034, 1959.3330391102324, 1813.857420488916, 1847.8451192563775, 1784.7145804731476, 1775.7887436552176, 1689.841871555551, 1938.2139943692257, 1662.9744596723579, 1610.5340936386065, 2016.727958431375, 1863.9901405585294, 1860.6753647826745, 1997.9242178808968, 1248.7238976353285, 1936.2329484863906, 1968.7447575101448, 1620.0758697503627, 1950.2695394568118, 2027.317519509578, 2040.6854181757299, 1707.750043533048, 1951.3913540631245, 1799.2953773917013, 1906.2049963612546, 1883.767693829884, 1827.8308911091883, 1876.307351321153, 1748.3814113558678, 1859.3701152644535, 1989.6456532987022, 1824.6650653218978, 1649.7605869306303, 2025.9793819171643, 2026.6326828998388, 2005.1421833244694, 1606.8828813928671, 1775.284161135419, 1782.00201204797, 1923.6625711746854, 1782.0699499713355, 1595.81330673087, 1950.8913729649341, 1743.248137166042, 1919.2842385748083, 1793.5280291297531, 1757.1069037340826, 1928.5252628463913, 1176.6355568402905, 1427.147374858633, 1784.9670010816803, 1810.9828187207638, 1944.850685862949, 1883.8473189804656, 1680.8178105904633, 1404.0504125839352, 1853.692657417645, 1692.4476927285368, 1727.8123293436854, 1706.0594179634602, 1773.3785562379412, 1999.8161214250965, 1891.115066760101, 1518.0046053185276, 1407.3540956404968, 1541.3766883471137, 1668.2947924397893, 1786.6663499164074, 1932.8724071503743, 1647.0218911761415, 1758.851768014726, 1284.5302371895334, 1628.8230484437333, 1825.931639081604, 2018.7115307149559, 1538.0657238032134, 1662.7195629417465, 1665.8956153353406, 2019.9328958092942, 1876.2837350318835], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [616.2548338091265, 751.2777231597425, 624.9382005387746, 498.10557340451743, 473.76479431144696, 741.770504655329, 484.4152906786773, 551.3942209011542, 512.7710040587707, 526.3948229327472, 631.5952708068432, 637.5899309642842, 565.8860314839669, 594.0040327731872, 525.1047929465298, 413.60948169849655, 558.748900207268, 479.93584682289776, 414.4790251524971, 440.1719850927805, 511.0618895741143, 532.3879805305252, 385.9885436860708, 502.66633181540107, 648.3440757287299, 491.3887418211092, 546.8441110309685, 615.6576775279314, 471.8556701590702, 461.80281619723155, 437.6035992112106, 564.362074001709, 632.970786195924, 496.8118391989263, 485.9547467459149, 547.1653574971361, 408.7415740353231, 505.49510974861306, 474.8367425721816, 627.7007019734115, 527.5590036114855, 461.4247172294806, 634.4004060402375, 390.9322865430324, 548.8777103553892, 683.9936962005424, 465.837989950753, 475.0715710560537, 443.4050859533264, 529.2911364605233, 494.222367964805, 503.04520711705703, 595.7267522254625, 556.2829128854268, 429.94198690060085, 616.2153639436283, 501.87557829287664, 558.9599519750259, 414.38374002267125, 572.1272990909813, 460.63413069837503, 483.62151080317784, 477.3855537061726, 496.45232654847683, 571.323709224444, 568.8597880566823, 609.813055760995, 483.04043822354384, 490.6355562725962, 322.2389987576378, 530.988218272098, 620.6656569198195, 450.8929719056255, 542.4826120926588, 524.3846812843948, 574.0679565616146, 623.1213675000489, 627.3849073192346, 648.1140554585689, 472.3134470430854, 406.35021309169827, 596.7471432853034, 449.2521971050958, 436.5669738283458, 615.4075223908234, 496.3301783551455, 642.9327029600595, 563.8616324704176, 567.7829185427005, 518.140509033186, 515.6922327830961, 440.91521230597357, 526.3964134125122, 440.4305982533186, 624.533473971833, 503.25873431148096, 698.5474212052555, 543.6639324884436, 637.3954263446728, 577.5636923822934, 442.46230449172674, 526.013957253235, 508.3921952665427, 457.41572273101076, 605.9652603433385, 303.5407528106165, 507.08076142726793, 443.459286935225, 465.517079672043, 474.56347508049936, 556.0482276721832, 633.6310168171495, 462.6120304815985, 468.74026045754306, 559.1454478805335, 512.1644377644393, 423.7203588581043, 484.0050291483432, 542.5326453034551, 536.9309128631987, 430.46952647088614, 292.98806320784405, 527.6290145834682, 457.38699270417914, 396.4954622472069, 537.0205336337195, 433.26256506111685, 545.1402642817284, 379.4214242461257, 479.06665909215985, 423.5218382867167, 537.0145032474023, 561.0602552225412, 471.0344014617406, 603.1687596582626, 739.609571263006, 387.5032038320275, 406.2813327073494, 505.60073318051667, 346.57817640052457, 397.0317993989227, 468.48536876990624, 492.03913159623943, 557.986673313508, 505.405631642022, 564.6686213466419, 470.3501586120821, 423.2294792457135, 538.6606607689721, 498.5488153464151, 552.2731375815771, 582.4414218592266, 597.7173684622086, 447.5537396392487, 596.0813079388074, 419.97572598322773, 614.0667961377881, 485.0389303863374, 465.58921930322964, 424.4158386200189, 530.0140793742459, 504.17691889518113, 452.4635132955454, 639.7136916472041, 489.26111599973353, 472.0547871030176, 427.2756191993993, 261.91324078772743, 476.35548994710274, 296.96913402395677, 378.7637359721612, 391.7381882864055, 472.4170240806847, 531.59052585151, 522.4104971426926, 482.73476652686156, 337.7316375316376, 457.2115482794537, 521.6708514218502, 521.6760865127467, 378.5186636628502, 490.3338295331231, 409.19529410585614, 500.42341182206695, 362.1425130661825, 374.7644985842682, 573.7947984086848, 519.2684382652494, 569.7217414731841, 571.0370255237985, 364.05276485287106, 610.8822605993946, 502.65702831029034, 523.1518494386046, 457.2857768714309, 496.320796218797, 548.9903992509315, 443.5075787732649, 653.3685722475677, 649.6512858744284], "policy_predator_policy_reward": [181.66989243415554, 211.47751534676186, 340.2966480224098, 236.58502953505368, 87.702812410271, 293.47073683041697, 189.53686577679198, 290.4836069096651, 309.22804464145884, 429.92231607930023, 369.37665641725397, 193.4031188967395, 501.10651831619293, 107.65726409273016, 129.23737610762532, 96.13906011668874, 357.44228317366276, 343.4148949369127, 449.39778799882487, 203.54682738382203, 367.2184462631232, 430.16569724201895, 171.4637913368101, 314.32312392893067, 278.8050261283021, 486.29416865133584, 257.85968394797266, 450.0061998658349, 541.8614423627014, 499.8858022297947, 196.42256430986396, 289.8805310650889, 309.9335924749919, 333.88856003046476, 448.40377197378086, 306.8724854207881, 633.1392466972856, 355.866692343031, 298.62927737206167, 387.0397532030004, 448.16226589899316, 529.2370118640747, 470.2117828651148, 463.7885636618501, 282.74602986541544, 298.23998406756857, 572.5234702327388, 334.41208801683285, 350.8107286192287, 461.2076294400686, 383.4912001211463, 395.02996845220946, 262.5680784288939, 275.26412801576646, 341.0884912461699, 550.968152278825, 303.17548527931046, 298.9634441251459, 328.98939607678125, 295.03365844817233, 487.1602362939119, 585.3120806359141, 482.87300984471904, 407.279250459163, 269.5630802368064, 450.9287872647431, 442.409556445011, 462.66116745134997, 258.333467292854, 177.51587531224172, 420.33434740418915, 364.2447258902836, 555.2777068567792, 420.09146665508064, 274.6875621802181, 246.935669724136, 344.6844610237945, 355.07880361373424, 445.0665274014536, 461.8234896064688, 584.3460927204497, 453.24196907827786, 398.79011129036195, 423.14076130924457, 422.77385453817607, 416.87979877897925, 233.8557280842223, 358.6453138770052, 480.3904301738546, 339.89113861151327, 400.3654455899356, 526.7948031508786, 464.31801116993273, 396.68586827342625, 396.28903015860055, 352.22611287924025, 311.73108140806323, 194.43897625410574, 436.0115400692256, 208.3994564682608, 548.5530169618655, 472.61637459187403, 442.38295636933793, 416.474190955008, 438.60093017546177, 301.6536436012142, 549.5013388963665, 525.9379946583057, 514.3374708752712, 572.2146572720259, 433.47887160295204, 381.9840672321858, 336.1682088634252, 339.3623815903011, 367.49501407770686, 336.4792614127424, 394.0447242133439, 480.23189982817655, 419.9588165664828, 424.2401964415483, 522.5622377588533, 536.0501225337509, 362.52324012610023, 248.27405931712045, 510.0506034139777, 507.3247736700266, 350.8733237836792, 413.97198403951757, 536.7467552081616, 524.0494000283592, 438.66500793133264, 394.32667966429995, 524.0155861887376, 200.99666086106103, 313.98272668753765, 271.764205237586, 176.9642870480327, 205.88673325287996, 367.77992471760825, 207.18854055998384, 549.6676781862327, 369.78215472661896, 512.6052852385717, 248.3517285724461, 387.05844561227184, 487.71798726201604, 518.4001783830402, 471.86750273963037, 354.0796488490863, 289.52868562599093, 99.6435662006847, 169.6922869424469, 351.5810086165736, 456.840540699616, 366.3332531852878, 310.0574056212149, 336.83991139870875, 291.86669142085145, 358.2288083955226, 457.8255516446901, 328.79670444517836, 410.39085352333615, 411.90017754701904, 495.7387389353301, 545.8945194455961, 383.90464421175267, 492.1770190406375, 336.6387262907636, 290.8736192400738, 343.155852429362, 321.32047776224607, 449.5542863263014, 394.69979165545425, 269.58745085213985, 335.4626640737193, 446.05842217313415, 568.0644969443971, 569.8647243948866, 378.86066963631333, 224.81428360523162, 481.42576111568223, 408.5735137030691, 225.7335497018241, 149.1779815597863, 456.42055029210746, 435.4954865011745, 440.6076733837839, 292.2607290238855, 468.77220480346034, 409.18055891451326, 326.78275267891956, 236.34794567202908, 275.2565595470908, 361.6541256457606, 361.1650100802911, 351.12403216482153, 516.0700139598318, 511.3649038252668, 299.92894811600127, 273.33492879388575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.883562015796684, "mean_inference_ms": 2.6537066765032504, "mean_action_processing_ms": 0.40289287065672147, "mean_env_wait_ms": 0.322510494805479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005313277244567871, "StateBufferConnector_ms": 0.010806918144226074, "ViewRequirementAgentConnector_ms": 0.14348602294921875}, "num_episodes": 18, "episode_return_max": 2040.6854181757299, "episode_return_min": 1164.0907108693389, "episode_return_mean": 1768.3114272346802, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.04713958093805, "num_env_steps_trained_throughput_per_sec": 293.04713958093805, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 13803.502, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13803.441, "sample_time_ms": 2463.687, "learn_time_ms": 11317.327, "learn_throughput": 353.44, "synch_weights_time_ms": 19.807}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "8abce_00000", "date": "2024-08-16_11-29-33", "timestamp": 1723787973, "time_this_iter_s": 13.702965021133423, "time_total_s": 484.9847512245178, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 484.9847512245178, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 61.735, "ram_util_percent": 82.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4823219520547402, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.748474950639029, "policy_loss": -0.0019051539031640877, "vf_loss": 9.749343897804382, "vf_explained_var": -0.006941141180260472, "kl": 0.010361939514833973, "entropy": 1.3926924429242573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4259376865373086, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.720194851406037, "policy_loss": -0.003661053965025872, "vf_loss": 9.722239334368831, "vf_explained_var": -0.020079898235028384, "kl": 0.00808294882437039, "entropy": 1.2109930952390036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 2041.5017248379238, "episode_reward_min": 1176.6355568402905, "episode_reward_mean": 1785.4345427526466, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 244.21250025375943, "predator_policy": 99.6435662006847}, "policy_reward_max": {"prey_policy": 739.609571263006, "predator_policy": 594.0255228230129}, "policy_reward_mean": {"prey_policy": 498.4220286907397, "predator_policy": 394.29524268558373}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1813.857420488916, 1847.8451192563775, 1784.7145804731476, 1775.7887436552176, 1689.841871555551, 1938.2139943692257, 1662.9744596723579, 1610.5340936386065, 2016.727958431375, 1863.9901405585294, 1860.6753647826745, 1997.9242178808968, 1248.7238976353285, 1936.2329484863906, 1968.7447575101448, 1620.0758697503627, 1950.2695394568118, 2027.317519509578, 2040.6854181757299, 1707.750043533048, 1951.3913540631245, 1799.2953773917013, 1906.2049963612546, 1883.767693829884, 1827.8308911091883, 1876.307351321153, 1748.3814113558678, 1859.3701152644535, 1989.6456532987022, 1824.6650653218978, 1649.7605869306303, 2025.9793819171643, 2026.6326828998388, 2005.1421833244694, 1606.8828813928671, 1775.284161135419, 1782.00201204797, 1923.6625711746854, 1782.0699499713355, 1595.81330673087, 1950.8913729649341, 1743.248137166042, 1919.2842385748083, 1793.5280291297531, 1757.1069037340826, 1928.5252628463913, 1176.6355568402905, 1427.147374858633, 1784.9670010816803, 1810.9828187207638, 1944.850685862949, 1883.8473189804656, 1680.8178105904633, 1404.0504125839352, 1853.692657417645, 1692.4476927285368, 1727.8123293436854, 1706.0594179634602, 1773.3785562379412, 1999.8161214250965, 1891.115066760101, 1518.0046053185276, 1407.3540956404968, 1541.3766883471137, 1668.2947924397893, 1786.6663499164074, 1932.8724071503743, 1647.0218911761415, 1758.851768014726, 1284.5302371895334, 1628.8230484437333, 1825.931639081604, 2018.7115307149559, 1538.0657238032134, 1662.7195629417465, 1665.8956153353406, 2019.9328958092942, 1876.2837350318835, 1556.4699835879155, 1905.13374788684, 1969.169846252461, 1751.4047096652364, 2041.5017248379238, 1585.8401517314371, 1637.346572204466, 1848.308402994399, 2001.9828343884315, 1933.147598120678, 2013.5867206022024, 1726.5712839690952, 1970.6576287174234, 1574.710040909187, 1722.8132156957013, 1867.5060027483883, 1703.2157391195458, 1629.804792873975, 1570.9635056921086, 1829.5993775486488, 1985.9460636798447, 1883.2553942094783], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [548.8777103553892, 683.9936962005424, 465.837989950753, 475.0715710560537, 443.4050859533264, 529.2911364605233, 494.222367964805, 503.04520711705703, 595.7267522254625, 556.2829128854268, 429.94198690060085, 616.2153639436283, 501.87557829287664, 558.9599519750259, 414.38374002267125, 572.1272990909813, 460.63413069837503, 483.62151080317784, 477.3855537061726, 496.45232654847683, 571.323709224444, 568.8597880566823, 609.813055760995, 483.04043822354384, 490.6355562725962, 322.2389987576378, 530.988218272098, 620.6656569198195, 450.8929719056255, 542.4826120926588, 524.3846812843948, 574.0679565616146, 623.1213675000489, 627.3849073192346, 648.1140554585689, 472.3134470430854, 406.35021309169827, 596.7471432853034, 449.2521971050958, 436.5669738283458, 615.4075223908234, 496.3301783551455, 642.9327029600595, 563.8616324704176, 567.7829185427005, 518.140509033186, 515.6922327830961, 440.91521230597357, 526.3964134125122, 440.4305982533186, 624.533473971833, 503.25873431148096, 698.5474212052555, 543.6639324884436, 637.3954263446728, 577.5636923822934, 442.46230449172674, 526.013957253235, 508.3921952665427, 457.41572273101076, 605.9652603433385, 303.5407528106165, 507.08076142726793, 443.459286935225, 465.517079672043, 474.56347508049936, 556.0482276721832, 633.6310168171495, 462.6120304815985, 468.74026045754306, 559.1454478805335, 512.1644377644393, 423.7203588581043, 484.0050291483432, 542.5326453034551, 536.9309128631987, 430.46952647088614, 292.98806320784405, 527.6290145834682, 457.38699270417914, 396.4954622472069, 537.0205336337195, 433.26256506111685, 545.1402642817284, 379.4214242461257, 479.06665909215985, 423.5218382867167, 537.0145032474023, 561.0602552225412, 471.0344014617406, 603.1687596582626, 739.609571263006, 387.5032038320275, 406.2813327073494, 505.60073318051667, 346.57817640052457, 397.0317993989227, 468.48536876990624, 492.03913159623943, 557.986673313508, 505.405631642022, 564.6686213466419, 470.3501586120821, 423.2294792457135, 538.6606607689721, 498.5488153464151, 552.2731375815771, 582.4414218592266, 597.7173684622086, 447.5537396392487, 596.0813079388074, 419.97572598322773, 614.0667961377881, 485.0389303863374, 465.58921930322964, 424.4158386200189, 530.0140793742459, 504.17691889518113, 452.4635132955454, 639.7136916472041, 489.26111599973353, 472.0547871030176, 427.2756191993993, 261.91324078772743, 476.35548994710274, 296.96913402395677, 378.7637359721612, 391.7381882864055, 472.4170240806847, 531.59052585151, 522.4104971426926, 482.73476652686156, 337.7316375316376, 457.2115482794537, 521.6708514218502, 521.6760865127467, 378.5186636628502, 490.3338295331231, 409.19529410585614, 500.42341182206695, 362.1425130661825, 374.7644985842682, 573.7947984086848, 519.2684382652494, 569.7217414731841, 571.0370255237985, 364.05276485287106, 610.8822605993946, 502.65702831029034, 523.1518494386046, 457.2857768714309, 496.320796218797, 548.9903992509315, 443.5075787732649, 653.3685722475677, 649.6512858744284, 533.9849615748409, 463.00394803386575, 448.2732001047914, 586.7756268689033, 633.6727679025481, 415.488895100469, 460.25572145486314, 496.20058846457516, 444.530381627709, 508.85815179335066, 342.5789079679682, 582.4383981950901, 536.1420041290111, 244.21250025375943, 526.626598357628, 478.5587593579643, 519.0829966363366, 420.67912089324847, 591.7347970742768, 430.18148389780504, 500.70933763852094, 569.4417392483673, 564.5831000798865, 525.6246554370254, 441.37109986831086, 506.455981862, 417.5043542495061, 348.70449272051223, 494.0709167176339, 553.1717712551238, 477.8712722159798, 546.874374951856, 580.5555885228958, 379.49796881584297, 365.8029482234801, 501.1817188813711, 483.89195642778736, 404.04910237938697, 395.58786951939555, 308.61733747817783, 630.4167771820088, 524.7151960415167, 642.9984157979176, 445.01428285777735], "policy_predator_policy_reward": [282.74602986541544, 298.23998406756857, 572.5234702327388, 334.41208801683285, 350.8107286192287, 461.2076294400686, 383.4912001211463, 395.02996845220946, 262.5680784288939, 275.26412801576646, 341.0884912461699, 550.968152278825, 303.17548527931046, 298.9634441251459, 328.98939607678125, 295.03365844817233, 487.1602362939119, 585.3120806359141, 482.87300984471904, 407.279250459163, 269.5630802368064, 450.9287872647431, 442.409556445011, 462.66116745134997, 258.333467292854, 177.51587531224172, 420.33434740418915, 364.2447258902836, 555.2777068567792, 420.09146665508064, 274.6875621802181, 246.935669724136, 344.6844610237945, 355.07880361373424, 445.0665274014536, 461.8234896064688, 584.3460927204497, 453.24196907827786, 398.79011129036195, 423.14076130924457, 422.77385453817607, 416.87979877897925, 233.8557280842223, 358.6453138770052, 480.3904301738546, 339.89113861151327, 400.3654455899356, 526.7948031508786, 464.31801116993273, 396.68586827342625, 396.28903015860055, 352.22611287924025, 311.73108140806323, 194.43897625410574, 436.0115400692256, 208.3994564682608, 548.5530169618655, 472.61637459187403, 442.38295636933793, 416.474190955008, 438.60093017546177, 301.6536436012142, 549.5013388963665, 525.9379946583057, 514.3374708752712, 572.2146572720259, 433.47887160295204, 381.9840672321858, 336.1682088634252, 339.3623815903011, 367.49501407770686, 336.4792614127424, 394.0447242133439, 480.23189982817655, 419.9588165664828, 424.2401964415483, 522.5622377588533, 536.0501225337509, 362.52324012610023, 248.27405931712045, 510.0506034139777, 507.3247736700266, 350.8733237836792, 413.97198403951757, 536.7467552081616, 524.0494000283592, 438.66500793133264, 394.32667966429995, 524.0155861887376, 200.99666086106103, 313.98272668753765, 271.764205237586, 176.9642870480327, 205.88673325287996, 367.77992471760825, 207.18854055998384, 549.6676781862327, 369.78215472661896, 512.6052852385717, 248.3517285724461, 387.05844561227184, 487.71798726201604, 518.4001783830402, 471.86750273963037, 354.0796488490863, 289.52868562599093, 99.6435662006847, 169.6922869424469, 351.5810086165736, 456.840540699616, 366.3332531852878, 310.0574056212149, 336.83991139870875, 291.86669142085145, 358.2288083955226, 457.8255516446901, 328.79670444517836, 410.39085352333615, 411.90017754701904, 495.7387389353301, 545.8945194455961, 383.90464421175267, 492.1770190406375, 336.6387262907636, 290.8736192400738, 343.155852429362, 321.32047776224607, 449.5542863263014, 394.69979165545425, 269.58745085213985, 335.4626640737193, 446.05842217313415, 568.0644969443971, 569.8647243948866, 378.86066963631333, 224.81428360523162, 481.42576111568223, 408.5735137030691, 225.7335497018241, 149.1779815597863, 456.42055029210746, 435.4954865011745, 440.6076733837839, 292.2607290238855, 468.77220480346034, 409.18055891451326, 326.78275267891956, 236.34794567202908, 275.2565595470908, 361.6541256457606, 361.1650100802911, 351.12403216482153, 516.0700139598318, 511.3649038252668, 299.92894811600127, 273.33492879388575, 261.69684459782115, 297.78422938138846, 422.14075989379944, 447.94416101934564, 513.0980970883393, 406.91008616110514, 349.06246770902794, 445.8859320367677, 577.3084725152453, 510.8047189016176, 325.4808335441903, 335.3420120241904, 441.6402169676966, 415.3518508539992, 453.41970945955364, 389.70333581925485, 594.0255228230129, 468.19519403583246, 330.4632609553623, 580.7680561932332, 477.8603181423883, 465.5753255729267, 258.54644277843397, 377.8170856737484, 538.4408807013223, 484.3896662857914, 393.717541906512, 414.7836520326551, 365.33073394585966, 310.23979377708156, 491.01372426632054, 351.74663131423307, 443.8894807867225, 299.2727009940844, 364.48816395865816, 398.3319618104646, 468.195224637764, 214.8272222471691, 592.4661100031824, 532.9280605478931, 419.3419798419293, 411.47211061439043, 421.8955243720411, 373.34717118174217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8873398410255384, "mean_inference_ms": 2.6666313920161233, "mean_action_processing_ms": 0.40280911790063106, "mean_env_wait_ms": 0.32387727029163443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007096648216247559, "StateBufferConnector_ms": 0.011436104774475098, "ViewRequirementAgentConnector_ms": 0.16426491737365723}, "num_episodes": 22, "episode_return_max": 2041.5017248379238, "episode_return_min": 1176.6355568402905, "episode_return_mean": 1785.4345427526466, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.5380000272763, "num_env_steps_trained_throughput_per_sec": 288.5380000272763, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 13785.885, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13785.824, "sample_time_ms": 2423.447, "learn_time_ms": 11340.092, "learn_throughput": 352.731, "synch_weights_time_ms": 20.205}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "8abce_00000", "date": "2024-08-16_11-29-47", "timestamp": 1723787987, "time_this_iter_s": 13.960692882537842, "time_total_s": 498.94544410705566, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a439bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 498.94544410705566, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 63.995000000000005, "ram_util_percent": 82.345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6181755908109523, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.660767544640436, "policy_loss": -0.0008533795366664885, "vf_loss": 9.660622135041253, "vf_explained_var": 0.0016311869419441021, "kl": 0.009988121143582471, "entropy": 1.3929369263548068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5233793497558623, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.69436256469242, "policy_loss": -0.005915165036207154, "vf_loss": 9.698041538965134, "vf_explained_var": 0.009684406607239335, "kl": 0.011180969839240858, "entropy": 1.184851548406813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 2075.340367849899, "episode_reward_min": 1176.6355568402905, "episode_reward_mean": 1783.9235493391236, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 244.21250025375943, "predator_policy": 99.6435662006847}, "policy_reward_max": {"prey_policy": 739.609571263006, "predator_policy": 597.8287201268122}, "policy_reward_mean": {"prey_policy": 487.8561155789402, "predator_policy": 404.10565909062194}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1883.767693829884, 1827.8308911091883, 1876.307351321153, 1748.3814113558678, 1859.3701152644535, 1989.6456532987022, 1824.6650653218978, 1649.7605869306303, 2025.9793819171643, 2026.6326828998388, 2005.1421833244694, 1606.8828813928671, 1775.284161135419, 1782.00201204797, 1923.6625711746854, 1782.0699499713355, 1595.81330673087, 1950.8913729649341, 1743.248137166042, 1919.2842385748083, 1793.5280291297531, 1757.1069037340826, 1928.5252628463913, 1176.6355568402905, 1427.147374858633, 1784.9670010816803, 1810.9828187207638, 1944.850685862949, 1883.8473189804656, 1680.8178105904633, 1404.0504125839352, 1853.692657417645, 1692.4476927285368, 1727.8123293436854, 1706.0594179634602, 1773.3785562379412, 1999.8161214250965, 1891.115066760101, 1518.0046053185276, 1407.3540956404968, 1541.3766883471137, 1668.2947924397893, 1786.6663499164074, 1932.8724071503743, 1647.0218911761415, 1758.851768014726, 1284.5302371895334, 1628.8230484437333, 1825.931639081604, 2018.7115307149559, 1538.0657238032134, 1662.7195629417465, 1665.8956153353406, 2019.9328958092942, 1876.2837350318835, 1556.4699835879155, 1905.13374788684, 1969.169846252461, 1751.4047096652364, 2041.5017248379238, 1585.8401517314371, 1637.346572204466, 1848.308402994399, 2001.9828343884315, 1933.147598120678, 2013.5867206022024, 1726.5712839690952, 1970.6576287174234, 1574.710040909187, 1722.8132156957013, 1867.5060027483883, 1703.2157391195458, 1629.804792873975, 1570.9635056921086, 1829.5993775486488, 1985.9460636798447, 1883.2553942094783, 2004.9403884604017, 1754.0448181354984, 1919.784655447344, 1713.5538500786447, 1752.6294913830125, 1651.2213621858825, 1798.3403447411188, 1718.5855919455375, 1684.1981632389302, 1753.9338212100236, 1999.063389061579, 1902.2456163410977, 1852.074378941085, 1967.730195300548, 1689.3382955674485, 1769.587651287106, 1767.763028219139, 1851.0630439507254, 1820.5261017673681, 1853.7070465637803, 1583.4926015374617, 2075.340367849899, 1985.516142070465], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [515.6922327830961, 440.91521230597357, 526.3964134125122, 440.4305982533186, 624.533473971833, 503.25873431148096, 698.5474212052555, 543.6639324884436, 637.3954263446728, 577.5636923822934, 442.46230449172674, 526.013957253235, 508.3921952665427, 457.41572273101076, 605.9652603433385, 303.5407528106165, 507.08076142726793, 443.459286935225, 465.517079672043, 474.56347508049936, 556.0482276721832, 633.6310168171495, 462.6120304815985, 468.74026045754306, 559.1454478805335, 512.1644377644393, 423.7203588581043, 484.0050291483432, 542.5326453034551, 536.9309128631987, 430.46952647088614, 292.98806320784405, 527.6290145834682, 457.38699270417914, 396.4954622472069, 537.0205336337195, 433.26256506111685, 545.1402642817284, 379.4214242461257, 479.06665909215985, 423.5218382867167, 537.0145032474023, 561.0602552225412, 471.0344014617406, 603.1687596582626, 739.609571263006, 387.5032038320275, 406.2813327073494, 505.60073318051667, 346.57817640052457, 397.0317993989227, 468.48536876990624, 492.03913159623943, 557.986673313508, 505.405631642022, 564.6686213466419, 470.3501586120821, 423.2294792457135, 538.6606607689721, 498.5488153464151, 552.2731375815771, 582.4414218592266, 597.7173684622086, 447.5537396392487, 596.0813079388074, 419.97572598322773, 614.0667961377881, 485.0389303863374, 465.58921930322964, 424.4158386200189, 530.0140793742459, 504.17691889518113, 452.4635132955454, 639.7136916472041, 489.26111599973353, 472.0547871030176, 427.2756191993993, 261.91324078772743, 476.35548994710274, 296.96913402395677, 378.7637359721612, 391.7381882864055, 472.4170240806847, 531.59052585151, 522.4104971426926, 482.73476652686156, 337.7316375316376, 457.2115482794537, 521.6708514218502, 521.6760865127467, 378.5186636628502, 490.3338295331231, 409.19529410585614, 500.42341182206695, 362.1425130661825, 374.7644985842682, 573.7947984086848, 519.2684382652494, 569.7217414731841, 571.0370255237985, 364.05276485287106, 610.8822605993946, 502.65702831029034, 523.1518494386046, 457.2857768714309, 496.320796218797, 548.9903992509315, 443.5075787732649, 653.3685722475677, 649.6512858744284, 533.9849615748409, 463.00394803386575, 448.2732001047914, 586.7756268689033, 633.6727679025481, 415.488895100469, 460.25572145486314, 496.20058846457516, 444.530381627709, 508.85815179335066, 342.5789079679682, 582.4383981950901, 536.1420041290111, 244.21250025375943, 526.626598357628, 478.5587593579643, 519.0829966363366, 420.67912089324847, 591.7347970742768, 430.18148389780504, 500.70933763852094, 569.4417392483673, 564.5831000798865, 525.6246554370254, 441.37109986831086, 506.455981862, 417.5043542495061, 348.70449272051223, 494.0709167176339, 553.1717712551238, 477.8712722159798, 546.874374951856, 580.5555885228958, 379.49796881584297, 365.8029482234801, 501.1817188813711, 483.89195642778736, 404.04910237938697, 395.58786951939555, 308.61733747817783, 630.4167771820088, 524.7151960415167, 642.9984157979176, 445.01428285777735, 460.0159109031815, 610.6025458023544, 560.142906200211, 557.9856672961057, 531.0533249908004, 420.1966824197659, 472.09677447322804, 348.8425436729935, 381.1044764329113, 479.32631028102276, 444.2177691413406, 421.3958082318866, 459.1091692889285, 580.3990438559784, 590.3881480484297, 454.49659861509093, 546.667627123013, 465.22985742617715, 463.79818201756484, 470.48768083475204, 441.7539310829356, 492.2140680562593, 549.1454059445144, 501.0781517792568, 641.9409384162914, 395.15460992503074, 478.26192154517895, 409.95121767698714, 365.2797082065036, 408.3180226973508, 472.25643968023786, 472.0889148915653, 552.2044798026977, 332.50756494408677, 485.53416933055587, 607.1763988506966, 491.14381481560474, 553.6801942675944, 624.879523179225, 396.0472661960584, 391.4032664838228, 334.6230755218508, 567.6646466685869, 614.5265383236828, 458.7235382755735, 392.75382788936355], "policy_predator_policy_reward": [400.3654455899356, 526.7948031508786, 464.31801116993273, 396.68586827342625, 396.28903015860055, 352.22611287924025, 311.73108140806323, 194.43897625410574, 436.0115400692256, 208.3994564682608, 548.5530169618655, 472.61637459187403, 442.38295636933793, 416.474190955008, 438.60093017546177, 301.6536436012142, 549.5013388963665, 525.9379946583057, 514.3374708752712, 572.2146572720259, 433.47887160295204, 381.9840672321858, 336.1682088634252, 339.3623815903011, 367.49501407770686, 336.4792614127424, 394.0447242133439, 480.23189982817655, 419.9588165664828, 424.2401964415483, 522.5622377588533, 536.0501225337509, 362.52324012610023, 248.27405931712045, 510.0506034139777, 507.3247736700266, 350.8733237836792, 413.97198403951757, 536.7467552081616, 524.0494000283592, 438.66500793133264, 394.32667966429995, 524.0155861887376, 200.99666086106103, 313.98272668753765, 271.764205237586, 176.9642870480327, 205.88673325287996, 367.77992471760825, 207.18854055998384, 549.6676781862327, 369.78215472661896, 512.6052852385717, 248.3517285724461, 387.05844561227184, 487.71798726201604, 518.4001783830402, 471.86750273963037, 354.0796488490863, 289.52868562599093, 99.6435662006847, 169.6922869424469, 351.5810086165736, 456.840540699616, 366.3332531852878, 310.0574056212149, 336.83991139870875, 291.86669142085145, 358.2288083955226, 457.8255516446901, 328.79670444517836, 410.39085352333615, 411.90017754701904, 495.7387389353301, 545.8945194455961, 383.90464421175267, 492.1770190406375, 336.6387262907636, 290.8736192400738, 343.155852429362, 321.32047776224607, 449.5542863263014, 394.69979165545425, 269.58745085213985, 335.4626640737193, 446.05842217313415, 568.0644969443971, 569.8647243948866, 378.86066963631333, 224.81428360523162, 481.42576111568223, 408.5735137030691, 225.7335497018241, 149.1779815597863, 456.42055029210746, 435.4954865011745, 440.6076733837839, 292.2607290238855, 468.77220480346034, 409.18055891451326, 326.78275267891956, 236.34794567202908, 275.2565595470908, 361.6541256457606, 361.1650100802911, 351.12403216482153, 516.0700139598318, 511.3649038252668, 299.92894811600127, 273.33492879388575, 261.69684459782115, 297.78422938138846, 422.14075989379944, 447.94416101934564, 513.0980970883393, 406.91008616110514, 349.06246770902794, 445.8859320367677, 577.3084725152453, 510.8047189016176, 325.4808335441903, 335.3420120241904, 441.6402169676966, 415.3518508539992, 453.41970945955364, 389.70333581925485, 594.0255228230129, 468.19519403583246, 330.4632609553623, 580.7680561932332, 477.8603181423883, 465.5753255729267, 258.54644277843397, 377.8170856737484, 538.4408807013223, 484.3896662857914, 393.717541906512, 414.7836520326551, 365.33073394585966, 310.23979377708156, 491.01372426632054, 351.74663131423307, 443.8894807867225, 299.2727009940844, 364.48816395865816, 398.3319618104646, 468.195224637764, 214.8272222471691, 592.4661100031824, 532.9280605478931, 419.3419798419293, 411.47211061439043, 421.8955243720411, 373.34717118174217, 484.3553886632206, 449.96654309164535, 378.81601188284014, 257.10023275634177, 370.705927909965, 597.8287201268122, 356.60503164716255, 536.0095002852595, 421.9396385413929, 470.2590661276849, 469.9467146893426, 315.6610701233121, 297.29384023376906, 461.5382913624451, 369.1166297435132, 304.5842155385044, 364.541698272008, 307.75898041773235, 364.45738151656667, 455.19057684114, 554.5935999186328, 510.50179000374897, 548.5619580195188, 303.46010059780787, 424.66721259822856, 390.31161800153393, 570.3680137361141, 509.1490423422673, 529.0785158508436, 386.66204881275064, 261.93795743642846, 563.3043392788773, 446.7862454068256, 436.2647380655277, 371.5429541419851, 386.80952162748986, 312.6845432991355, 463.0175493850335, 427.47933759000887, 405.30091959848977, 423.50751379592674, 433.95874573585996, 424.74071710954087, 468.4084657480891, 556.9992053417873, 577.0395705637414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8885992578546151, "mean_inference_ms": 2.6765031283534366, "mean_action_processing_ms": 0.4029406110054841, "mean_env_wait_ms": 0.32446618885143413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057642459869384766, "StateBufferConnector_ms": 0.011523127555847168, "ViewRequirementAgentConnector_ms": 0.1525055170059204}, "num_episodes": 23, "episode_return_max": 2075.340367849899, "episode_return_min": 1176.6355568402905, "episode_return_mean": 1783.9235493391236, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.0363267680721, "num_env_steps_trained_throughput_per_sec": 290.0363267680721, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 13704.532, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13704.47, "sample_time_ms": 2257.473, "learn_time_ms": 11424.975, "learn_throughput": 350.11, "synch_weights_time_ms": 19.953}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "8abce_00000", "date": "2024-08-16_11-30-01", "timestamp": 1723788001, "time_this_iter_s": 13.880166292190552, "time_total_s": 512.8256103992462, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a439be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 512.8256103992462, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 62.06315789473683, "ram_util_percent": 82.27368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6724755314292101, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.668373052405302, "policy_loss": -0.0025875841385670124, "vf_loss": 9.669679454016308, "vf_explained_var": -0.0029404934121187404, "kl": 0.012811834730950487, "entropy": 1.3950752655034342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5025556549508736, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.759781231955877, "policy_loss": -0.003202013648238289, "vf_loss": 9.76184520317764, "vf_explained_var": 0.003691196567797787, "kl": 0.005690171792358281, "entropy": 1.1789351040724094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 2075.340367849899, "episode_reward_min": 1110.4981411703973, "episode_reward_mean": 1771.3002927912466, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 244.21250025375943, "predator_policy": 96.58331063404076}, "policy_reward_max": {"prey_policy": 739.609571263006, "predator_policy": 597.8287201268122}, "policy_reward_mean": {"prey_policy": 484.2400616768068, "predator_policy": 401.4100847188167}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1743.248137166042, 1919.2842385748083, 1793.5280291297531, 1757.1069037340826, 1928.5252628463913, 1176.6355568402905, 1427.147374858633, 1784.9670010816803, 1810.9828187207638, 1944.850685862949, 1883.8473189804656, 1680.8178105904633, 1404.0504125839352, 1853.692657417645, 1692.4476927285368, 1727.8123293436854, 1706.0594179634602, 1773.3785562379412, 1999.8161214250965, 1891.115066760101, 1518.0046053185276, 1407.3540956404968, 1541.3766883471137, 1668.2947924397893, 1786.6663499164074, 1932.8724071503743, 1647.0218911761415, 1758.851768014726, 1284.5302371895334, 1628.8230484437333, 1825.931639081604, 2018.7115307149559, 1538.0657238032134, 1662.7195629417465, 1665.8956153353406, 2019.9328958092942, 1876.2837350318835, 1556.4699835879155, 1905.13374788684, 1969.169846252461, 1751.4047096652364, 2041.5017248379238, 1585.8401517314371, 1637.346572204466, 1848.308402994399, 2001.9828343884315, 1933.147598120678, 2013.5867206022024, 1726.5712839690952, 1970.6576287174234, 1574.710040909187, 1722.8132156957013, 1867.5060027483883, 1703.2157391195458, 1629.804792873975, 1570.9635056921086, 1829.5993775486488, 1985.9460636798447, 1883.2553942094783, 2004.9403884604017, 1754.0448181354984, 1919.784655447344, 1713.5538500786447, 1752.6294913830125, 1651.2213621858825, 1798.3403447411188, 1718.5855919455375, 1684.1981632389302, 1753.9338212100236, 1999.063389061579, 1902.2456163410977, 1852.074378941085, 1967.730195300548, 1689.3382955674485, 1769.587651287106, 1767.763028219139, 1851.0630439507254, 1820.5261017673681, 1853.7070465637803, 1583.4926015374617, 2075.340367849899, 1985.516142070465, 1499.818956041206, 1474.1429208387735, 1995.8554562672082, 1834.9726992189803, 1789.2249590181189, 1808.441135342423, 1652.1790667070027, 1888.0465598600492, 1891.0268842759697, 1539.4494053938288, 1729.9472783713852, 1970.091719794737, 1848.2098612556244, 1998.6463374392788, 1984.8608853539592, 1110.4981411703973, 1892.7268911612482, 1963.6244596934166], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [433.26256506111685, 545.1402642817284, 379.4214242461257, 479.06665909215985, 423.5218382867167, 537.0145032474023, 561.0602552225412, 471.0344014617406, 603.1687596582626, 739.609571263006, 387.5032038320275, 406.2813327073494, 505.60073318051667, 346.57817640052457, 397.0317993989227, 468.48536876990624, 492.03913159623943, 557.986673313508, 505.405631642022, 564.6686213466419, 470.3501586120821, 423.2294792457135, 538.6606607689721, 498.5488153464151, 552.2731375815771, 582.4414218592266, 597.7173684622086, 447.5537396392487, 596.0813079388074, 419.97572598322773, 614.0667961377881, 485.0389303863374, 465.58921930322964, 424.4158386200189, 530.0140793742459, 504.17691889518113, 452.4635132955454, 639.7136916472041, 489.26111599973353, 472.0547871030176, 427.2756191993993, 261.91324078772743, 476.35548994710274, 296.96913402395677, 378.7637359721612, 391.7381882864055, 472.4170240806847, 531.59052585151, 522.4104971426926, 482.73476652686156, 337.7316375316376, 457.2115482794537, 521.6708514218502, 521.6760865127467, 378.5186636628502, 490.3338295331231, 409.19529410585614, 500.42341182206695, 362.1425130661825, 374.7644985842682, 573.7947984086848, 519.2684382652494, 569.7217414731841, 571.0370255237985, 364.05276485287106, 610.8822605993946, 502.65702831029034, 523.1518494386046, 457.2857768714309, 496.320796218797, 548.9903992509315, 443.5075787732649, 653.3685722475677, 649.6512858744284, 533.9849615748409, 463.00394803386575, 448.2732001047914, 586.7756268689033, 633.6727679025481, 415.488895100469, 460.25572145486314, 496.20058846457516, 444.530381627709, 508.85815179335066, 342.5789079679682, 582.4383981950901, 536.1420041290111, 244.21250025375943, 526.626598357628, 478.5587593579643, 519.0829966363366, 420.67912089324847, 591.7347970742768, 430.18148389780504, 500.70933763852094, 569.4417392483673, 564.5831000798865, 525.6246554370254, 441.37109986831086, 506.455981862, 417.5043542495061, 348.70449272051223, 494.0709167176339, 553.1717712551238, 477.8712722159798, 546.874374951856, 580.5555885228958, 379.49796881584297, 365.8029482234801, 501.1817188813711, 483.89195642778736, 404.04910237938697, 395.58786951939555, 308.61733747817783, 630.4167771820088, 524.7151960415167, 642.9984157979176, 445.01428285777735, 460.0159109031815, 610.6025458023544, 560.142906200211, 557.9856672961057, 531.0533249908004, 420.1966824197659, 472.09677447322804, 348.8425436729935, 381.1044764329113, 479.32631028102276, 444.2177691413406, 421.3958082318866, 459.1091692889285, 580.3990438559784, 590.3881480484297, 454.49659861509093, 546.667627123013, 465.22985742617715, 463.79818201756484, 470.48768083475204, 441.7539310829356, 492.2140680562593, 549.1454059445144, 501.0781517792568, 641.9409384162914, 395.15460992503074, 478.26192154517895, 409.95121767698714, 365.2797082065036, 408.3180226973508, 472.25643968023786, 472.0889148915653, 552.2044798026977, 332.50756494408677, 485.53416933055587, 607.1763988506966, 491.14381481560474, 553.6801942675944, 624.879523179225, 396.0472661960584, 391.4032664838228, 334.6230755218508, 567.6646466685869, 614.5265383236828, 458.7235382755735, 392.75382788936355, 419.46877470481934, 269.1099548033579, 293.2692311196468, 487.6226896789359, 463.7038010126796, 427.93350917182016, 544.7861283056382, 575.0038533542074, 554.1125143660792, 466.7870122593099, 394.91419323751603, 550.3660963509086, 508.70955413280046, 482.4419783556619, 638.8568062168216, 580.2114140881716, 391.9257982464284, 652.713445271123, 481.17350769284354, 449.68293037138807, 560.6393807288615, 505.2645329782841, 465.0917905077001, 469.40794113881196, 495.30628654736165, 513.7410990070833, 414.2956497479424, 547.431772588244, 531.307434696777, 481.00366374220914, 517.8935763826178, 245.24057868699515, 457.1569683652886, 559.5027632977603, 454.6176861181445, 490.42279586331165], "policy_predator_policy_reward": [350.8733237836792, 413.97198403951757, 536.7467552081616, 524.0494000283592, 438.66500793133264, 394.32667966429995, 524.0155861887376, 200.99666086106103, 313.98272668753765, 271.764205237586, 176.9642870480327, 205.88673325287996, 367.77992471760825, 207.18854055998384, 549.6676781862327, 369.78215472661896, 512.6052852385717, 248.3517285724461, 387.05844561227184, 487.71798726201604, 518.4001783830402, 471.86750273963037, 354.0796488490863, 289.52868562599093, 99.6435662006847, 169.6922869424469, 351.5810086165736, 456.840540699616, 366.3332531852878, 310.0574056212149, 336.83991139870875, 291.86669142085145, 358.2288083955226, 457.8255516446901, 328.79670444517836, 410.39085352333615, 411.90017754701904, 495.7387389353301, 545.8945194455961, 383.90464421175267, 492.1770190406375, 336.6387262907636, 290.8736192400738, 343.155852429362, 321.32047776224607, 449.5542863263014, 394.69979165545425, 269.58745085213985, 335.4626640737193, 446.05842217313415, 568.0644969443971, 569.8647243948866, 378.86066963631333, 224.81428360523162, 481.42576111568223, 408.5735137030691, 225.7335497018241, 149.1779815597863, 456.42055029210746, 435.4954865011745, 440.6076733837839, 292.2607290238855, 468.77220480346034, 409.18055891451326, 326.78275267891956, 236.34794567202908, 275.2565595470908, 361.6541256457606, 361.1650100802911, 351.12403216482153, 516.0700139598318, 511.3649038252668, 299.92894811600127, 273.33492879388575, 261.69684459782115, 297.78422938138846, 422.14075989379944, 447.94416101934564, 513.0980970883393, 406.91008616110514, 349.06246770902794, 445.8859320367677, 577.3084725152453, 510.8047189016176, 325.4808335441903, 335.3420120241904, 441.6402169676966, 415.3518508539992, 453.41970945955364, 389.70333581925485, 594.0255228230129, 468.19519403583246, 330.4632609553623, 580.7680561932332, 477.8603181423883, 465.5753255729267, 258.54644277843397, 377.8170856737484, 538.4408807013223, 484.3896662857914, 393.717541906512, 414.7836520326551, 365.33073394585966, 310.23979377708156, 491.01372426632054, 351.74663131423307, 443.8894807867225, 299.2727009940844, 364.48816395865816, 398.3319618104646, 468.195224637764, 214.8272222471691, 592.4661100031824, 532.9280605478931, 419.3419798419293, 411.47211061439043, 421.8955243720411, 373.34717118174217, 484.3553886632206, 449.96654309164535, 378.81601188284014, 257.10023275634177, 370.705927909965, 597.8287201268122, 356.60503164716255, 536.0095002852595, 421.9396385413929, 470.2590661276849, 469.9467146893426, 315.6610701233121, 297.29384023376906, 461.5382913624451, 369.1166297435132, 304.5842155385044, 364.541698272008, 307.75898041773235, 364.45738151656667, 455.19057684114, 554.5935999186328, 510.50179000374897, 548.5619580195188, 303.46010059780787, 424.66721259822856, 390.31161800153393, 570.3680137361141, 509.1490423422673, 529.0785158508436, 386.66204881275064, 261.93795743642846, 563.3043392788773, 446.7862454068256, 436.2647380655277, 371.5429541419851, 386.80952162748986, 312.6845432991355, 463.0175493850335, 427.47933759000887, 405.30091959848977, 423.50751379592674, 433.95874573585996, 424.74071710954087, 468.4084657480891, 556.9992053417873, 577.0395705637414, 378.18409633164015, 433.0561302013902, 308.80856295654536, 384.44243708364644, 569.7245596608905, 534.4935864218176, 309.32188773861986, 405.86082982051414, 404.8061076032874, 363.51932478944195, 417.6979315335337, 445.4629142204647, 422.1167935936721, 238.91074062486794, 272.2904363316939, 396.6879032233618, 289.1871128760081, 557.2005278824109, 304.05743089999925, 304.53553642959764, 338.24104654567884, 325.8023181185621, 522.0834211615264, 513.5085669866992, 435.4260618014654, 403.73641389971453, 508.74817238703986, 528.1707427160511, 499.7715509212472, 472.7782359937234, 96.58331063404076, 250.7806754667449, 408.1239510938146, 467.94320840438513, 572.6590334059365, 445.9249443060214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.88896353012302, "mean_inference_ms": 2.6785121252521167, "mean_action_processing_ms": 0.4016672524545452, "mean_env_wait_ms": 0.3245216985912888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005795598030090332, "StateBufferConnector_ms": 0.004198908805847168, "ViewRequirementAgentConnector_ms": 0.14458823204040527}, "num_episodes": 18, "episode_return_max": 2075.340367849899, "episode_return_min": 1110.4981411703973, "episode_return_mean": 1771.3002927912466, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.0597500033438, "num_env_steps_trained_throughput_per_sec": 288.0597500033438, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 13727.082, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13727.021, "sample_time_ms": 2112.307, "learn_time_ms": 11592.256, "learn_throughput": 345.058, "synch_weights_time_ms": 20.284}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "8abce_00000", "date": "2024-08-16_11-30-15", "timestamp": 1723788015, "time_this_iter_s": 13.939616918563843, "time_total_s": 526.7652273178101, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a439b9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 526.7652273178101, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 62.90500000000001, "ram_util_percent": 82.545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6145884525208247, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.677932070676611, "policy_loss": -6.846150989452052e-05, "vf_loss": 9.676680911028827, "vf_explained_var": -0.017338791946885448, "kl": 0.013196221438103166, "entropy": 1.4346886446236302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5059097563778912, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.684110896801823, "policy_loss": -0.006313754348318393, "vf_loss": 9.688681705918892, "vf_explained_var": -0.03136054334186372, "kl": 0.008714700616379481, "entropy": 1.1496063429211814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 2079.8349097360556, "episode_reward_min": 1110.4981411703973, "episode_reward_mean": 1774.7094271839762, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 244.21250025375943, "predator_policy": 96.58331063404076}, "policy_reward_max": {"prey_policy": 686.4692911288, "predator_policy": 633.2572639745392}, "policy_reward_mean": {"prey_policy": 480.5334052156686, "predator_policy": 406.8213083763196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1999.8161214250965, 1891.115066760101, 1518.0046053185276, 1407.3540956404968, 1541.3766883471137, 1668.2947924397893, 1786.6663499164074, 1932.8724071503743, 1647.0218911761415, 1758.851768014726, 1284.5302371895334, 1628.8230484437333, 1825.931639081604, 2018.7115307149559, 1538.0657238032134, 1662.7195629417465, 1665.8956153353406, 2019.9328958092942, 1876.2837350318835, 1556.4699835879155, 1905.13374788684, 1969.169846252461, 1751.4047096652364, 2041.5017248379238, 1585.8401517314371, 1637.346572204466, 1848.308402994399, 2001.9828343884315, 1933.147598120678, 2013.5867206022024, 1726.5712839690952, 1970.6576287174234, 1574.710040909187, 1722.8132156957013, 1867.5060027483883, 1703.2157391195458, 1629.804792873975, 1570.9635056921086, 1829.5993775486488, 1985.9460636798447, 1883.2553942094783, 2004.9403884604017, 1754.0448181354984, 1919.784655447344, 1713.5538500786447, 1752.6294913830125, 1651.2213621858825, 1798.3403447411188, 1718.5855919455375, 1684.1981632389302, 1753.9338212100236, 1999.063389061579, 1902.2456163410977, 1852.074378941085, 1967.730195300548, 1689.3382955674485, 1769.587651287106, 1767.763028219139, 1851.0630439507254, 1820.5261017673681, 1853.7070465637803, 1583.4926015374617, 2075.340367849899, 1985.516142070465, 1499.818956041206, 1474.1429208387735, 1995.8554562672082, 1834.9726992189803, 1789.2249590181189, 1808.441135342423, 1652.1790667070027, 1888.0465598600492, 1891.0268842759697, 1539.4494053938288, 1729.9472783713852, 1970.091719794737, 1848.2098612556244, 1998.6463374392788, 1984.8608853539592, 1110.4981411703973, 1892.7268911612482, 1963.6244596934166, 1781.282000968902, 2033.4734684029204, 1456.3857262547551, 1818.3250482064273, 1574.80076118175, 1635.8307614083687, 1549.623088970788, 1735.3339430326648, 1602.0988653212523, 1596.773383583056, 2079.8349097360556, 1907.399678876893, 1811.2167959745707, 1674.2838106385193, 1411.2501028524173, 1820.7974151421663, 1979.4852718271497, 1881.1006115558337], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [452.4635132955454, 639.7136916472041, 489.26111599973353, 472.0547871030176, 427.2756191993993, 261.91324078772743, 476.35548994710274, 296.96913402395677, 378.7637359721612, 391.7381882864055, 472.4170240806847, 531.59052585151, 522.4104971426926, 482.73476652686156, 337.7316375316376, 457.2115482794537, 521.6708514218502, 521.6760865127467, 378.5186636628502, 490.3338295331231, 409.19529410585614, 500.42341182206695, 362.1425130661825, 374.7644985842682, 573.7947984086848, 519.2684382652494, 569.7217414731841, 571.0370255237985, 364.05276485287106, 610.8822605993946, 502.65702831029034, 523.1518494386046, 457.2857768714309, 496.320796218797, 548.9903992509315, 443.5075787732649, 653.3685722475677, 649.6512858744284, 533.9849615748409, 463.00394803386575, 448.2732001047914, 586.7756268689033, 633.6727679025481, 415.488895100469, 460.25572145486314, 496.20058846457516, 444.530381627709, 508.85815179335066, 342.5789079679682, 582.4383981950901, 536.1420041290111, 244.21250025375943, 526.626598357628, 478.5587593579643, 519.0829966363366, 420.67912089324847, 591.7347970742768, 430.18148389780504, 500.70933763852094, 569.4417392483673, 564.5831000798865, 525.6246554370254, 441.37109986831086, 506.455981862, 417.5043542495061, 348.70449272051223, 494.0709167176339, 553.1717712551238, 477.8712722159798, 546.874374951856, 580.5555885228958, 379.49796881584297, 365.8029482234801, 501.1817188813711, 483.89195642778736, 404.04910237938697, 395.58786951939555, 308.61733747817783, 630.4167771820088, 524.7151960415167, 642.9984157979176, 445.01428285777735, 460.0159109031815, 610.6025458023544, 560.142906200211, 557.9856672961057, 531.0533249908004, 420.1966824197659, 472.09677447322804, 348.8425436729935, 381.1044764329113, 479.32631028102276, 444.2177691413406, 421.3958082318866, 459.1091692889285, 580.3990438559784, 590.3881480484297, 454.49659861509093, 546.667627123013, 465.22985742617715, 463.79818201756484, 470.48768083475204, 441.7539310829356, 492.2140680562593, 549.1454059445144, 501.0781517792568, 641.9409384162914, 395.15460992503074, 478.26192154517895, 409.95121767698714, 365.2797082065036, 408.3180226973508, 472.25643968023786, 472.0889148915653, 552.2044798026977, 332.50756494408677, 485.53416933055587, 607.1763988506966, 491.14381481560474, 553.6801942675944, 624.879523179225, 396.0472661960584, 391.4032664838228, 334.6230755218508, 567.6646466685869, 614.5265383236828, 458.7235382755735, 392.75382788936355, 419.46877470481934, 269.1099548033579, 293.2692311196468, 487.6226896789359, 463.7038010126796, 427.93350917182016, 544.7861283056382, 575.0038533542074, 554.1125143660792, 466.7870122593099, 394.91419323751603, 550.3660963509086, 508.70955413280046, 482.4419783556619, 638.8568062168216, 580.2114140881716, 391.9257982464284, 652.713445271123, 481.17350769284354, 449.68293037138807, 560.6393807288615, 505.2645329782841, 465.0917905077001, 469.40794113881196, 495.30628654736165, 513.7410990070833, 414.2956497479424, 547.431772588244, 531.307434696777, 481.00366374220914, 517.8935763826178, 245.24057868699515, 457.1569683652886, 559.5027632977603, 454.6176861181445, 490.42279586331165, 460.7234132347773, 517.652872942277, 444.70927194461433, 461.83124280508105, 370.2709889184378, 438.260725364861, 387.904780007282, 545.6463456205463, 336.87723257906157, 342.1710615790522, 347.8724781799034, 532.4884239998574, 438.99879457243907, 411.6860261897547, 453.7149357581231, 541.7525879471548, 499.48002075288537, 504.7540597921946, 581.6758048754374, 502.46900587691283, 616.5019658624657, 414.50009676927215, 587.6869133164879, 686.4692911288, 490.15533299987516, 456.4362041674596, 526.7643346170034, 419.75665839423135, 437.99357586982484, 386.9148708640606, 568.7197794581579, 516.8925574239111, 508.95197099661675, 514.424337830469, 438.49136445577375, 521.0838928400408], "policy_predator_policy_reward": [411.90017754701904, 495.7387389353301, 545.8945194455961, 383.90464421175267, 492.1770190406375, 336.6387262907636, 290.8736192400738, 343.155852429362, 321.32047776224607, 449.5542863263014, 394.69979165545425, 269.58745085213985, 335.4626640737193, 446.05842217313415, 568.0644969443971, 569.8647243948866, 378.86066963631333, 224.81428360523162, 481.42576111568223, 408.5735137030691, 225.7335497018241, 149.1779815597863, 456.42055029210746, 435.4954865011745, 440.6076733837839, 292.2607290238855, 468.77220480346034, 409.18055891451326, 326.78275267891956, 236.34794567202908, 275.2565595470908, 361.6541256457606, 361.1650100802911, 351.12403216482153, 516.0700139598318, 511.3649038252668, 299.92894811600127, 273.33492879388575, 261.69684459782115, 297.78422938138846, 422.14075989379944, 447.94416101934564, 513.0980970883393, 406.91008616110514, 349.06246770902794, 445.8859320367677, 577.3084725152453, 510.8047189016176, 325.4808335441903, 335.3420120241904, 441.6402169676966, 415.3518508539992, 453.41970945955364, 389.70333581925485, 594.0255228230129, 468.19519403583246, 330.4632609553623, 580.7680561932332, 477.8603181423883, 465.5753255729267, 258.54644277843397, 377.8170856737484, 538.4408807013223, 484.3896662857914, 393.717541906512, 414.7836520326551, 365.33073394585966, 310.23979377708156, 491.01372426632054, 351.74663131423307, 443.8894807867225, 299.2727009940844, 364.48816395865816, 398.3319618104646, 468.195224637764, 214.8272222471691, 592.4661100031824, 532.9280605478931, 419.3419798419293, 411.47211061439043, 421.8955243720411, 373.34717118174217, 484.3553886632206, 449.96654309164535, 378.81601188284014, 257.10023275634177, 370.705927909965, 597.8287201268122, 356.60503164716255, 536.0095002852595, 421.9396385413929, 470.2590661276849, 469.9467146893426, 315.6610701233121, 297.29384023376906, 461.5382913624451, 369.1166297435132, 304.5842155385044, 364.541698272008, 307.75898041773235, 364.45738151656667, 455.19057684114, 554.5935999186328, 510.50179000374897, 548.5619580195188, 303.46010059780787, 424.66721259822856, 390.31161800153393, 570.3680137361141, 509.1490423422673, 529.0785158508436, 386.66204881275064, 261.93795743642846, 563.3043392788773, 446.7862454068256, 436.2647380655277, 371.5429541419851, 386.80952162748986, 312.6845432991355, 463.0175493850335, 427.47933759000887, 405.30091959848977, 423.50751379592674, 433.95874573585996, 424.74071710954087, 468.4084657480891, 556.9992053417873, 577.0395705637414, 378.18409633164015, 433.0561302013902, 308.80856295654536, 384.44243708364644, 569.7245596608905, 534.4935864218176, 309.32188773861986, 405.86082982051414, 404.8061076032874, 363.51932478944195, 417.6979315335337, 445.4629142204647, 422.1167935936721, 238.91074062486794, 272.2904363316939, 396.6879032233618, 289.1871128760081, 557.2005278824109, 304.05743089999925, 304.53553642959764, 338.24104654567884, 325.8023181185621, 522.0834211615264, 513.5085669866992, 435.4260618014654, 403.73641389971453, 508.74817238703986, 528.1707427160511, 499.7715509212472, 472.7782359937234, 96.58331063404076, 250.7806754667449, 408.1239510938146, 467.94320840438513, 572.6590334059365, 445.9249443060214, 500.18954103976546, 302.7161737520841, 633.2572639745392, 493.6756896786834, 422.81889326942945, 225.03511870202695, 517.0634992589635, 367.71042331963616, 469.2610543125725, 426.4914127110638, 315.75508729461296, 439.71477193399585, 304.6127848659172, 394.32548334267847, 427.3137490817398, 312.55267024564574, 464.8678110034003, 132.9969737727737, 231.365175111746, 281.26339771896085, 501.4821523617387, 547.3506947425793, 303.7870976935599, 329.4563767380433, 477.8145953041506, 386.81066350308487, 362.4865429774177, 365.2762746498669, 299.1088932347012, 287.23276288383164, 304.3204333587681, 430.86464490132715, 484.0334922946006, 472.0754707054617, 432.57054162384, 488.9548126361789]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8877572696081072, "mean_inference_ms": 2.6757069687174972, "mean_action_processing_ms": 0.399813910047795, "mean_env_wait_ms": 0.3240207697729385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005753159523010254, "StateBufferConnector_ms": 0.00408780574798584, "ViewRequirementAgentConnector_ms": 0.1299135684967041}, "num_episodes": 18, "episode_return_max": 2079.8349097360556, "episode_return_min": 1110.4981411703973, "episode_return_mean": 1774.7094271839762, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.7283009005224, "num_env_steps_trained_throughput_per_sec": 300.7283009005224, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 13698.518, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13698.457, "sample_time_ms": 2074.794, "learn_time_ms": 11601.406, "learn_throughput": 344.786, "synch_weights_time_ms": 20.007}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "8abce_00000", "date": "2024-08-16_11-30-29", "timestamp": 1723788029, "time_this_iter_s": 13.346434116363525, "time_total_s": 540.1116614341736, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43370d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 540.1116614341736, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 63.43157894736842, "ram_util_percent": 82.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7935341234560367, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.51386903631624, "policy_loss": -0.007913384862150505, "vf_loss": 9.519955690071066, "vf_explained_var": -0.034918209200813656, "kl": 0.018267421230793075, "entropy": 1.382692734652726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2864961522281486, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.800801046058615, "policy_loss": -0.007035187849154075, "vf_loss": 9.806106659722706, "vf_explained_var": -0.010723483467858935, "kl": 0.00864771704275071, "entropy": 1.120163919622936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 2079.8349097360556, "episode_reward_min": 1110.4981411703973, "episode_reward_mean": 1761.9768427913443, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 160.89612446205987, "predator_policy": 96.58331063404076}, "policy_reward_max": {"prey_policy": 686.4692911288, "predator_policy": 724.9017105331576}, "policy_reward_mean": {"prey_policy": 459.4300865914894, "predator_policy": 421.5583348041829}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1751.4047096652364, 2041.5017248379238, 1585.8401517314371, 1637.346572204466, 1848.308402994399, 2001.9828343884315, 1933.147598120678, 2013.5867206022024, 1726.5712839690952, 1970.6576287174234, 1574.710040909187, 1722.8132156957013, 1867.5060027483883, 1703.2157391195458, 1629.804792873975, 1570.9635056921086, 1829.5993775486488, 1985.9460636798447, 1883.2553942094783, 2004.9403884604017, 1754.0448181354984, 1919.784655447344, 1713.5538500786447, 1752.6294913830125, 1651.2213621858825, 1798.3403447411188, 1718.5855919455375, 1684.1981632389302, 1753.9338212100236, 1999.063389061579, 1902.2456163410977, 1852.074378941085, 1967.730195300548, 1689.3382955674485, 1769.587651287106, 1767.763028219139, 1851.0630439507254, 1820.5261017673681, 1853.7070465637803, 1583.4926015374617, 2075.340367849899, 1985.516142070465, 1499.818956041206, 1474.1429208387735, 1995.8554562672082, 1834.9726992189803, 1789.2249590181189, 1808.441135342423, 1652.1790667070027, 1888.0465598600492, 1891.0268842759697, 1539.4494053938288, 1729.9472783713852, 1970.091719794737, 1848.2098612556244, 1998.6463374392788, 1984.8608853539592, 1110.4981411703973, 1892.7268911612482, 1963.6244596934166, 1781.282000968902, 2033.4734684029204, 1456.3857262547551, 1818.3250482064273, 1574.80076118175, 1635.8307614083687, 1549.623088970788, 1735.3339430326648, 1602.0988653212523, 1596.773383583056, 2079.8349097360556, 1907.399678876893, 1811.2167959745707, 1674.2838106385193, 1411.2501028524173, 1820.7974151421663, 1979.4852718271497, 1881.1006115558337, 1683.344580333422, 1172.498167032293, 1693.2122584893775, 1827.3588868657628, 1669.3221266138812, 1945.4191949063254, 1651.4166542437438, 1692.6318504666172, 1695.4437612036274, 1854.7411079587814, 1629.2515638046145, 1524.2361711655342, 1596.1302042222108, 1695.3885005669886, 1558.0992182774037, 1375.6755551794301, 1742.751838198174, 1824.1137301045637, 1649.9040475408158, 1888.6212244363755, 1732.1955329401906, 1728.026738453943], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [460.25572145486314, 496.20058846457516, 444.530381627709, 508.85815179335066, 342.5789079679682, 582.4383981950901, 536.1420041290111, 244.21250025375943, 526.626598357628, 478.5587593579643, 519.0829966363366, 420.67912089324847, 591.7347970742768, 430.18148389780504, 500.70933763852094, 569.4417392483673, 564.5831000798865, 525.6246554370254, 441.37109986831086, 506.455981862, 417.5043542495061, 348.70449272051223, 494.0709167176339, 553.1717712551238, 477.8712722159798, 546.874374951856, 580.5555885228958, 379.49796881584297, 365.8029482234801, 501.1817188813711, 483.89195642778736, 404.04910237938697, 395.58786951939555, 308.61733747817783, 630.4167771820088, 524.7151960415167, 642.9984157979176, 445.01428285777735, 460.0159109031815, 610.6025458023544, 560.142906200211, 557.9856672961057, 531.0533249908004, 420.1966824197659, 472.09677447322804, 348.8425436729935, 381.1044764329113, 479.32631028102276, 444.2177691413406, 421.3958082318866, 459.1091692889285, 580.3990438559784, 590.3881480484297, 454.49659861509093, 546.667627123013, 465.22985742617715, 463.79818201756484, 470.48768083475204, 441.7539310829356, 492.2140680562593, 549.1454059445144, 501.0781517792568, 641.9409384162914, 395.15460992503074, 478.26192154517895, 409.95121767698714, 365.2797082065036, 408.3180226973508, 472.25643968023786, 472.0889148915653, 552.2044798026977, 332.50756494408677, 485.53416933055587, 607.1763988506966, 491.14381481560474, 553.6801942675944, 624.879523179225, 396.0472661960584, 391.4032664838228, 334.6230755218508, 567.6646466685869, 614.5265383236828, 458.7235382755735, 392.75382788936355, 419.46877470481934, 269.1099548033579, 293.2692311196468, 487.6226896789359, 463.7038010126796, 427.93350917182016, 544.7861283056382, 575.0038533542074, 554.1125143660792, 466.7870122593099, 394.91419323751603, 550.3660963509086, 508.70955413280046, 482.4419783556619, 638.8568062168216, 580.2114140881716, 391.9257982464284, 652.713445271123, 481.17350769284354, 449.68293037138807, 560.6393807288615, 505.2645329782841, 465.0917905077001, 469.40794113881196, 495.30628654736165, 513.7410990070833, 414.2956497479424, 547.431772588244, 531.307434696777, 481.00366374220914, 517.8935763826178, 245.24057868699515, 457.1569683652886, 559.5027632977603, 454.6176861181445, 490.42279586331165, 460.7234132347773, 517.652872942277, 444.70927194461433, 461.83124280508105, 370.2709889184378, 438.260725364861, 387.904780007282, 545.6463456205463, 336.87723257906157, 342.1710615790522, 347.8724781799034, 532.4884239998574, 438.99879457243907, 411.6860261897547, 453.7149357581231, 541.7525879471548, 499.48002075288537, 504.7540597921946, 581.6758048754374, 502.46900587691283, 616.5019658624657, 414.50009676927215, 587.6869133164879, 686.4692911288, 490.15533299987516, 456.4362041674596, 526.7643346170034, 419.75665839423135, 437.99357586982484, 386.9148708640606, 568.7197794581579, 516.8925574239111, 508.95197099661675, 514.424337830469, 438.49136445577375, 521.0838928400408, 388.8156080169991, 337.43662077705005, 261.4475062339129, 404.95478847749683, 414.2326142190993, 415.7008739689811, 230.69908792655534, 326.77038137810723, 465.46648865969047, 480.8424344480736, 608.39997424202, 475.2583502123551, 365.34028832981335, 530.6477868434788, 442.0727714412753, 438.19592783559585, 343.2901881502279, 430.0830361890018, 488.70626848359035, 549.0680657347032, 275.57865100094716, 202.1354884488422, 350.4337184652481, 403.64922869587764, 450.7374529212361, 318.6705224425137, 160.89612446205987, 339.9033967067138, 344.9663334133794, 354.0991053212559, 338.1171992438229, 173.5983206271631, 489.3523339649359, 381.5640839052493, 542.2738805825237, 471.75547102870445, 314.6365909200972, 336.035872009446, 419.17970026140773, 408.81924110645423, 352.20239512511625, 512.559041045504, 314.5038917582798, 340.4585502173013], "policy_predator_policy_reward": [349.06246770902794, 445.8859320367677, 577.3084725152453, 510.8047189016176, 325.4808335441903, 335.3420120241904, 441.6402169676966, 415.3518508539992, 453.41970945955364, 389.70333581925485, 594.0255228230129, 468.19519403583246, 330.4632609553623, 580.7680561932332, 477.8603181423883, 465.5753255729267, 258.54644277843397, 377.8170856737484, 538.4408807013223, 484.3896662857914, 393.717541906512, 414.7836520326551, 365.33073394585966, 310.23979377708156, 491.01372426632054, 351.74663131423307, 443.8894807867225, 299.2727009940844, 364.48816395865816, 398.3319618104646, 468.195224637764, 214.8272222471691, 592.4661100031824, 532.9280605478931, 419.3419798419293, 411.47211061439043, 421.8955243720411, 373.34717118174217, 484.3553886632206, 449.96654309164535, 378.81601188284014, 257.10023275634177, 370.705927909965, 597.8287201268122, 356.60503164716255, 536.0095002852595, 421.9396385413929, 470.2590661276849, 469.9467146893426, 315.6610701233121, 297.29384023376906, 461.5382913624451, 369.1166297435132, 304.5842155385044, 364.541698272008, 307.75898041773235, 364.45738151656667, 455.19057684114, 554.5935999186328, 510.50179000374897, 548.5619580195188, 303.46010059780787, 424.66721259822856, 390.31161800153393, 570.3680137361141, 509.1490423422673, 529.0785158508436, 386.66204881275064, 261.93795743642846, 563.3043392788773, 446.7862454068256, 436.2647380655277, 371.5429541419851, 386.80952162748986, 312.6845432991355, 463.0175493850335, 427.47933759000887, 405.30091959848977, 423.50751379592674, 433.95874573585996, 424.74071710954087, 468.4084657480891, 556.9992053417873, 577.0395705637414, 378.18409633164015, 433.0561302013902, 308.80856295654536, 384.44243708364644, 569.7245596608905, 534.4935864218176, 309.32188773861986, 405.86082982051414, 404.8061076032874, 363.51932478944195, 417.6979315335337, 445.4629142204647, 422.1167935936721, 238.91074062486794, 272.2904363316939, 396.6879032233618, 289.1871128760081, 557.2005278824109, 304.05743089999925, 304.53553642959764, 338.24104654567884, 325.8023181185621, 522.0834211615264, 513.5085669866992, 435.4260618014654, 403.73641389971453, 508.74817238703986, 528.1707427160511, 499.7715509212472, 472.7782359937234, 96.58331063404076, 250.7806754667449, 408.1239510938146, 467.94320840438513, 572.6590334059365, 445.9249443060214, 500.18954103976546, 302.7161737520841, 633.2572639745392, 493.6756896786834, 422.81889326942945, 225.03511870202695, 517.0634992589635, 367.71042331963616, 469.2610543125725, 426.4914127110638, 315.75508729461296, 439.71477193399585, 304.6127848659172, 394.32548334267847, 427.3137490817398, 312.55267024564574, 464.8678110034003, 132.9969737727737, 231.365175111746, 281.26339771896085, 501.4821523617387, 547.3506947425793, 303.7870976935599, 329.4563767380433, 477.8145953041506, 386.81066350308487, 362.4865429774177, 365.2762746498669, 299.1088932347012, 287.23276288383164, 304.3204333587681, 430.86464490132715, 484.0334922946006, 472.0754707054617, 432.57054162384, 488.9548126361789, 516.5687385162098, 440.52361302316376, 303.9730510109369, 202.1228213099476, 416.5126964884656, 446.7660738128324, 660.8582870989135, 609.0311304621862, 408.6810035569847, 314.33219994913253, 561.1144266418592, 300.64644381009225, 307.17147200724946, 448.25710706320433, 456.6329117211243, 355.73023946862173, 304.25530718921914, 617.8152296751772, 359.03125482880563, 457.9355189116838, 646.2395377199177, 505.2978866349088, 442.99235642242274, 327.16086758198514, 288.4803529134195, 538.2418759450422, 469.6872688650581, 724.9017105331576, 412.7677120318081, 446.26606751095954, 483.3771247398943, 380.5829105685503, 502.95338803844373, 368.8820322895466, 409.25881624462954, 400.8255622487062, 588.7906073026743, 410.440977308597, 624.9808161204319, 435.6414669480826, 387.18572719135034, 480.24836957821947, 633.7635778532778, 439.30071862508487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.885226348584008, "mean_inference_ms": 2.6696572817213053, "mean_action_processing_ms": 0.39647581769326623, "mean_env_wait_ms": 0.32333887149727447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005868315696716309, "StateBufferConnector_ms": 0.004086732864379883, "ViewRequirementAgentConnector_ms": 0.13767480850219727}, "num_episodes": 22, "episode_return_max": 2079.8349097360556, "episode_return_min": 1110.4981411703973, "episode_return_mean": 1761.9768427913443, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.4172263348048, "num_env_steps_trained_throughput_per_sec": 304.4172263348048, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 13700.198, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13700.137, "sample_time_ms": 2069.191, "learn_time_ms": 11609.18, "learn_throughput": 344.555, "synch_weights_time_ms": 19.662}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "8abce_00000", "date": "2024-08-16_11-30-42", "timestamp": 1723788042, "time_this_iter_s": 13.212769031524658, "time_total_s": 553.3244304656982, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 553.3244304656982, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 61.88421052631579, "ram_util_percent": 81.89473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7809243890185835, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.402619930549903, "policy_loss": -0.0018728506291856763, "vf_loss": 9.403467945825486, "vf_explained_var": -0.011408044926073186, "kl": 0.01024833499521959, "entropy": 1.4396825938628464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3689068251659, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.784543175167508, "policy_loss": -0.007676266747275515, "vf_loss": 9.790181935022748, "vf_explained_var": 0.003484555337794874, "kl": 0.010187522945620631, "entropy": 1.1038169468521442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 2079.8349097360556, "episode_reward_min": 1110.4981411703973, "episode_reward_mean": 1759.6082330154593, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 160.89612446205987, "predator_policy": 96.58331063404076}, "policy_reward_max": {"prey_policy": 686.4692911288, "predator_policy": 724.9017105331576}, "policy_reward_mean": {"prey_policy": 444.9633786200344, "predator_policy": 434.84073788769535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1752.6294913830125, 1651.2213621858825, 1798.3403447411188, 1718.5855919455375, 1684.1981632389302, 1753.9338212100236, 1999.063389061579, 1902.2456163410977, 1852.074378941085, 1967.730195300548, 1689.3382955674485, 1769.587651287106, 1767.763028219139, 1851.0630439507254, 1820.5261017673681, 1853.7070465637803, 1583.4926015374617, 2075.340367849899, 1985.516142070465, 1499.818956041206, 1474.1429208387735, 1995.8554562672082, 1834.9726992189803, 1789.2249590181189, 1808.441135342423, 1652.1790667070027, 1888.0465598600492, 1891.0268842759697, 1539.4494053938288, 1729.9472783713852, 1970.091719794737, 1848.2098612556244, 1998.6463374392788, 1984.8608853539592, 1110.4981411703973, 1892.7268911612482, 1963.6244596934166, 1781.282000968902, 2033.4734684029204, 1456.3857262547551, 1818.3250482064273, 1574.80076118175, 1635.8307614083687, 1549.623088970788, 1735.3339430326648, 1602.0988653212523, 1596.773383583056, 2079.8349097360556, 1907.399678876893, 1811.2167959745707, 1674.2838106385193, 1411.2501028524173, 1820.7974151421663, 1979.4852718271497, 1881.1006115558337, 1683.344580333422, 1172.498167032293, 1693.2122584893775, 1827.3588868657628, 1669.3221266138812, 1945.4191949063254, 1651.4166542437438, 1692.6318504666172, 1695.4437612036274, 1854.7411079587814, 1629.2515638046145, 1524.2361711655342, 1596.1302042222108, 1695.3885005669886, 1558.0992182774037, 1375.6755551794301, 1742.751838198174, 1824.1137301045637, 1649.9040475408158, 1888.6212244363755, 1732.1955329401906, 1728.026738453943, 1870.4348577432677, 1686.3588778168776, 1863.0660016237607, 2033.8182409473188, 1843.0822404679002, 1599.572895681846, 1717.9359829485056, 1633.8165005467129, 1534.84963574059, 1761.187491114833, 1690.7974586726152, 1868.6247587573155, 1851.2454661934357, 1758.1595613561678, 1741.6051977423854, 1912.8677050034776, 2022.2441511855507, 2019.1374783644924, 1676.4075433806802, 1645.3602246009596, 1703.8383294449934, 1984.05002175817, 2015.1638731497053], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [381.1044764329113, 479.32631028102276, 444.2177691413406, 421.3958082318866, 459.1091692889285, 580.3990438559784, 590.3881480484297, 454.49659861509093, 546.667627123013, 465.22985742617715, 463.79818201756484, 470.48768083475204, 441.7539310829356, 492.2140680562593, 549.1454059445144, 501.0781517792568, 641.9409384162914, 395.15460992503074, 478.26192154517895, 409.95121767698714, 365.2797082065036, 408.3180226973508, 472.25643968023786, 472.0889148915653, 552.2044798026977, 332.50756494408677, 485.53416933055587, 607.1763988506966, 491.14381481560474, 553.6801942675944, 624.879523179225, 396.0472661960584, 391.4032664838228, 334.6230755218508, 567.6646466685869, 614.5265383236828, 458.7235382755735, 392.75382788936355, 419.46877470481934, 269.1099548033579, 293.2692311196468, 487.6226896789359, 463.7038010126796, 427.93350917182016, 544.7861283056382, 575.0038533542074, 554.1125143660792, 466.7870122593099, 394.91419323751603, 550.3660963509086, 508.70955413280046, 482.4419783556619, 638.8568062168216, 580.2114140881716, 391.9257982464284, 652.713445271123, 481.17350769284354, 449.68293037138807, 560.6393807288615, 505.2645329782841, 465.0917905077001, 469.40794113881196, 495.30628654736165, 513.7410990070833, 414.2956497479424, 547.431772588244, 531.307434696777, 481.00366374220914, 517.8935763826178, 245.24057868699515, 457.1569683652886, 559.5027632977603, 454.6176861181445, 490.42279586331165, 460.7234132347773, 517.652872942277, 444.70927194461433, 461.83124280508105, 370.2709889184378, 438.260725364861, 387.904780007282, 545.6463456205463, 336.87723257906157, 342.1710615790522, 347.8724781799034, 532.4884239998574, 438.99879457243907, 411.6860261897547, 453.7149357581231, 541.7525879471548, 499.48002075288537, 504.7540597921946, 581.6758048754374, 502.46900587691283, 616.5019658624657, 414.50009676927215, 587.6869133164879, 686.4692911288, 490.15533299987516, 456.4362041674596, 526.7643346170034, 419.75665839423135, 437.99357586982484, 386.9148708640606, 568.7197794581579, 516.8925574239111, 508.95197099661675, 514.424337830469, 438.49136445577375, 521.0838928400408, 388.8156080169991, 337.43662077705005, 261.4475062339129, 404.95478847749683, 414.2326142190993, 415.7008739689811, 230.69908792655534, 326.77038137810723, 465.46648865969047, 480.8424344480736, 608.39997424202, 475.2583502123551, 365.34028832981335, 530.6477868434788, 442.0727714412753, 438.19592783559585, 343.2901881502279, 430.0830361890018, 488.70626848359035, 549.0680657347032, 275.57865100094716, 202.1354884488422, 350.4337184652481, 403.64922869587764, 450.7374529212361, 318.6705224425137, 160.89612446205987, 339.9033967067138, 344.9663334133794, 354.0991053212559, 338.1171992438229, 173.5983206271631, 489.3523339649359, 381.5640839052493, 542.2738805825237, 471.75547102870445, 314.6365909200972, 336.035872009446, 419.17970026140773, 408.81924110645423, 352.20239512511625, 512.559041045504, 314.5038917582798, 340.4585502173013, 531.7683480270485, 659.0113546766779, 669.2758250270314, 439.6610312758573, 302.9731629642289, 521.2397794132019, 630.2607471763935, 362.02960220206273, 359.7041758039647, 530.3096023191852, 293.8218439050829, 455.3070283990852, 350.6224018291739, 200.16319042519294, 327.706461027693, 279.2547834992362, 389.78811136120584, 246.48354875171498, 583.442976383896, 325.825217028109, 510.5737597711767, 208.04863689746765, 551.5554398977426, 447.86630644121095, 269.95189771174404, 290.8733693629972, 382.1479469871574, 455.9604949630691, 484.8124509057281, 538.3443592311282, 203.34307041740033, 526.2299569735123, 533.4736633385337, 270.15733756124393, 428.6833066839662, 425.9445971904781, 215.2778644611153, 353.12933784302925, 496.8585223458946, 399.6462226972651, 404.28114499420144, 494.21608551767844, 604.2724989558257, 419.0620013206468, 534.024437221255, 351.0035287560061], "policy_predator_policy_reward": [421.9396385413929, 470.2590661276849, 469.9467146893426, 315.6610701233121, 297.29384023376906, 461.5382913624451, 369.1166297435132, 304.5842155385044, 364.541698272008, 307.75898041773235, 364.45738151656667, 455.19057684114, 554.5935999186328, 510.50179000374897, 548.5619580195188, 303.46010059780787, 424.66721259822856, 390.31161800153393, 570.3680137361141, 509.1490423422673, 529.0785158508436, 386.66204881275064, 261.93795743642846, 563.3043392788773, 446.7862454068256, 436.2647380655277, 371.5429541419851, 386.80952162748986, 312.6845432991355, 463.0175493850335, 427.47933759000887, 405.30091959848977, 423.50751379592674, 433.95874573585996, 424.74071710954087, 468.4084657480891, 556.9992053417873, 577.0395705637414, 378.18409633164015, 433.0561302013902, 308.80856295654536, 384.44243708364644, 569.7245596608905, 534.4935864218176, 309.32188773861986, 405.86082982051414, 404.8061076032874, 363.51932478944195, 417.6979315335337, 445.4629142204647, 422.1167935936721, 238.91074062486794, 272.2904363316939, 396.6879032233618, 289.1871128760081, 557.2005278824109, 304.05743089999925, 304.53553642959764, 338.24104654567884, 325.8023181185621, 522.0834211615264, 513.5085669866992, 435.4260618014654, 403.73641389971453, 508.74817238703986, 528.1707427160511, 499.7715509212472, 472.7782359937234, 96.58331063404076, 250.7806754667449, 408.1239510938146, 467.94320840438513, 572.6590334059365, 445.9249443060214, 500.18954103976546, 302.7161737520841, 633.2572639745392, 493.6756896786834, 422.81889326942945, 225.03511870202695, 517.0634992589635, 367.71042331963616, 469.2610543125725, 426.4914127110638, 315.75508729461296, 439.71477193399585, 304.6127848659172, 394.32548334267847, 427.3137490817398, 312.55267024564574, 464.8678110034003, 132.9969737727737, 231.365175111746, 281.26339771896085, 501.4821523617387, 547.3506947425793, 303.7870976935599, 329.4563767380433, 477.8145953041506, 386.81066350308487, 362.4865429774177, 365.2762746498669, 299.1088932347012, 287.23276288383164, 304.3204333587681, 430.86464490132715, 484.0334922946006, 472.0754707054617, 432.57054162384, 488.9548126361789, 516.5687385162098, 440.52361302316376, 303.9730510109369, 202.1228213099476, 416.5126964884656, 446.7660738128324, 660.8582870989135, 609.0311304621862, 408.6810035569847, 314.33219994913253, 561.1144266418592, 300.64644381009225, 307.17147200724946, 448.25710706320433, 456.6329117211243, 355.73023946862173, 304.25530718921914, 617.8152296751772, 359.03125482880563, 457.9355189116838, 646.2395377199177, 505.2978866349088, 442.99235642242274, 327.16086758198514, 288.4803529134195, 538.2418759450422, 469.6872688650581, 724.9017105331576, 412.7677120318081, 446.26606751095954, 483.3771247398943, 380.5829105685503, 502.95338803844373, 368.8820322895466, 409.25881624462954, 400.8255622487062, 588.7906073026743, 410.440977308597, 624.9808161204319, 435.6414669480826, 387.18572719135034, 480.24836957821947, 633.7635778532778, 439.30071862508487, 291.4907627537249, 388.1643922858189, 227.69953231779766, 349.7224891961912, 448.7985174525811, 590.0545417937469, 517.0690129957377, 524.4588785731236, 465.4004363031575, 487.6680260415913, 361.75001324845505, 488.694010129223, 620.5128760333833, 546.6375146607547, 593.9927014850073, 432.86255453477827, 479.3918230098136, 419.1861526178569, 435.64219304608434, 416.2771046567427, 374.8160907459063, 597.3589712580662, 396.538610632892, 472.6644017854729, 713.0710402534951, 577.3491588651991, 402.22297544078174, 517.8281439651603, 438.09161396954426, 280.3567736359855, 520.1368368485986, 663.1578407639659, 666.3247645840692, 552.2883857017014, 621.4894541122975, 543.0201203777503, 512.66328631746, 595.3370547590775, 449.20939866247653, 299.6460808953239, 491.20590272598537, 314.13519620712935, 456.2144289909455, 504.50109249075166, 506.0239096084962, 624.1119975639483]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8793788566570678, "mean_inference_ms": 2.6542061213414416, "mean_action_processing_ms": 0.3930512962669929, "mean_env_wait_ms": 0.32129073437336936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004060983657836914, "StateBufferConnector_ms": 0.003444671630859375, "ViewRequirementAgentConnector_ms": 0.13147985935211182}, "num_episodes": 23, "episode_return_max": 2079.8349097360556, "episode_return_min": 1110.4981411703973, "episode_return_mean": 1759.6082330154593, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.2554170874195, "num_env_steps_trained_throughput_per_sec": 299.2554170874195, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 13661.129, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13661.067, "sample_time_ms": 2051.446, "learn_time_ms": 11586.953, "learn_throughput": 345.216, "synch_weights_time_ms": 20.578}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "8abce_00000", "date": "2024-08-16_11-30-55", "timestamp": 1723788055, "time_this_iter_s": 13.422882080078125, "time_total_s": 566.7473125457764, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a439b9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 566.7473125457764, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 61.857894736842105, "ram_util_percent": 81.60526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8271726820046308, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.472713139952806, "policy_loss": -0.0006795421085029683, "vf_loss": 9.471806438385494, "vf_explained_var": -0.015700637884240934, "kl": 0.015862772319557294, "entropy": 1.4080837520342024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7566501909778232, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.550788410126216, "policy_loss": -0.003940577558414252, "vf_loss": 9.553399887791386, "vf_explained_var": -0.021388004191968808, "kl": 0.006645491131794861, "entropy": 1.0924598345050105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 2079.8349097360556, "episode_reward_min": 1022.835511734753, "episode_reward_mean": 1725.824682189767, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 160.89612446205987, "predator_policy": 45.56355923635174}, "policy_reward_max": {"prey_policy": 744.3458003218595, "predator_policy": 724.9017105331576}, "policy_reward_mean": {"prey_policy": 440.90961510173184, "predator_policy": 422.00272599315184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1985.516142070465, 1499.818956041206, 1474.1429208387735, 1995.8554562672082, 1834.9726992189803, 1789.2249590181189, 1808.441135342423, 1652.1790667070027, 1888.0465598600492, 1891.0268842759697, 1539.4494053938288, 1729.9472783713852, 1970.091719794737, 1848.2098612556244, 1998.6463374392788, 1984.8608853539592, 1110.4981411703973, 1892.7268911612482, 1963.6244596934166, 1781.282000968902, 2033.4734684029204, 1456.3857262547551, 1818.3250482064273, 1574.80076118175, 1635.8307614083687, 1549.623088970788, 1735.3339430326648, 1602.0988653212523, 1596.773383583056, 2079.8349097360556, 1907.399678876893, 1811.2167959745707, 1674.2838106385193, 1411.2501028524173, 1820.7974151421663, 1979.4852718271497, 1881.1006115558337, 1683.344580333422, 1172.498167032293, 1693.2122584893775, 1827.3588868657628, 1669.3221266138812, 1945.4191949063254, 1651.4166542437438, 1692.6318504666172, 1695.4437612036274, 1854.7411079587814, 1629.2515638046145, 1524.2361711655342, 1596.1302042222108, 1695.3885005669886, 1558.0992182774037, 1375.6755551794301, 1742.751838198174, 1824.1137301045637, 1649.9040475408158, 1888.6212244363755, 1732.1955329401906, 1728.026738453943, 1870.4348577432677, 1686.3588778168776, 1863.0660016237607, 2033.8182409473188, 1843.0822404679002, 1599.572895681846, 1717.9359829485056, 1633.8165005467129, 1534.84963574059, 1761.187491114833, 1690.7974586726152, 1868.6247587573155, 1851.2454661934357, 1758.1595613561678, 1741.6051977423854, 1912.8677050034776, 2022.2441511855507, 2019.1374783644924, 1676.4075433806802, 1645.3602246009596, 1703.8383294449934, 1984.05002175817, 2015.1638731497053, 1754.3312888009684, 1496.1732820537084, 1625.9181314960817, 1694.2589436331643, 1843.706937830525, 1824.0622651104406, 1991.4256514090382, 1755.7274287140342, 1509.3532417532197, 1704.3222934545647, 1414.2696215295941, 1825.8482892413142, 1022.835511734753, 1662.565217476208, 1077.7137330401051, 1923.4173623583908, 1203.0235808990085, 1783.5326279873716], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [458.7235382755735, 392.75382788936355, 419.46877470481934, 269.1099548033579, 293.2692311196468, 487.6226896789359, 463.7038010126796, 427.93350917182016, 544.7861283056382, 575.0038533542074, 554.1125143660792, 466.7870122593099, 394.91419323751603, 550.3660963509086, 508.70955413280046, 482.4419783556619, 638.8568062168216, 580.2114140881716, 391.9257982464284, 652.713445271123, 481.17350769284354, 449.68293037138807, 560.6393807288615, 505.2645329782841, 465.0917905077001, 469.40794113881196, 495.30628654736165, 513.7410990070833, 414.2956497479424, 547.431772588244, 531.307434696777, 481.00366374220914, 517.8935763826178, 245.24057868699515, 457.1569683652886, 559.5027632977603, 454.6176861181445, 490.42279586331165, 460.7234132347773, 517.652872942277, 444.70927194461433, 461.83124280508105, 370.2709889184378, 438.260725364861, 387.904780007282, 545.6463456205463, 336.87723257906157, 342.1710615790522, 347.8724781799034, 532.4884239998574, 438.99879457243907, 411.6860261897547, 453.7149357581231, 541.7525879471548, 499.48002075288537, 504.7540597921946, 581.6758048754374, 502.46900587691283, 616.5019658624657, 414.50009676927215, 587.6869133164879, 686.4692911288, 490.15533299987516, 456.4362041674596, 526.7643346170034, 419.75665839423135, 437.99357586982484, 386.9148708640606, 568.7197794581579, 516.8925574239111, 508.95197099661675, 514.424337830469, 438.49136445577375, 521.0838928400408, 388.8156080169991, 337.43662077705005, 261.4475062339129, 404.95478847749683, 414.2326142190993, 415.7008739689811, 230.69908792655534, 326.77038137810723, 465.46648865969047, 480.8424344480736, 608.39997424202, 475.2583502123551, 365.34028832981335, 530.6477868434788, 442.0727714412753, 438.19592783559585, 343.2901881502279, 430.0830361890018, 488.70626848359035, 549.0680657347032, 275.57865100094716, 202.1354884488422, 350.4337184652481, 403.64922869587764, 450.7374529212361, 318.6705224425137, 160.89612446205987, 339.9033967067138, 344.9663334133794, 354.0991053212559, 338.1171992438229, 173.5983206271631, 489.3523339649359, 381.5640839052493, 542.2738805825237, 471.75547102870445, 314.6365909200972, 336.035872009446, 419.17970026140773, 408.81924110645423, 352.20239512511625, 512.559041045504, 314.5038917582798, 340.4585502173013, 531.7683480270485, 659.0113546766779, 669.2758250270314, 439.6610312758573, 302.9731629642289, 521.2397794132019, 630.2607471763935, 362.02960220206273, 359.7041758039647, 530.3096023191852, 293.8218439050829, 455.3070283990852, 350.6224018291739, 200.16319042519294, 327.706461027693, 279.2547834992362, 389.78811136120584, 246.48354875171498, 583.442976383896, 325.825217028109, 510.5737597711767, 208.04863689746765, 551.5554398977426, 447.86630644121095, 269.95189771174404, 290.8733693629972, 382.1479469871574, 455.9604949630691, 484.8124509057281, 538.3443592311282, 203.34307041740033, 526.2299569735123, 533.4736633385337, 270.15733756124393, 428.6833066839662, 425.9445971904781, 215.2778644611153, 353.12933784302925, 496.8585223458946, 399.6462226972651, 404.28114499420144, 494.21608551767844, 604.2724989558257, 419.0620013206468, 534.024437221255, 351.0035287560061, 435.94912812340715, 518.9989921075208, 338.6282461535403, 614.4487662428385, 592.9989817594441, 358.5836682410349, 457.18331191609104, 584.5547295980887, 542.2601982532193, 549.8827013646907, 726.5328388255866, 744.3458003218595, 444.97385418210087, 518.2384409156589, 347.68924956955027, 267.2893275592333, 506.9180864475134, 379.36292855541024, 624.5458442171192, 168.46473770830167, 321.4003392919908, 523.8379696518132, 625.3877871227664, 512.1019782330959, 438.62877958273265, 452.16885928471896, 433.19666117272925, 345.21703036991215, 341.54041325401937, 475.9064427072724, 367.6549184212969, 463.306825087928, 343.9197371948577, 324.74998573230835, 352.38551644716176, 481.44916030633726], "policy_predator_policy_reward": [556.9992053417873, 577.0395705637414, 378.18409633164015, 433.0561302013902, 308.80856295654536, 384.44243708364644, 569.7245596608905, 534.4935864218176, 309.32188773861986, 405.86082982051414, 404.8061076032874, 363.51932478944195, 417.6979315335337, 445.4629142204647, 422.1167935936721, 238.91074062486794, 272.2904363316939, 396.6879032233618, 289.1871128760081, 557.2005278824109, 304.05743089999925, 304.53553642959764, 338.24104654567884, 325.8023181185621, 522.0834211615264, 513.5085669866992, 435.4260618014654, 403.73641389971453, 508.74817238703986, 528.1707427160511, 499.7715509212472, 472.7782359937234, 96.58331063404076, 250.7806754667449, 408.1239510938146, 467.94320840438513, 572.6590334059365, 445.9249443060214, 500.18954103976546, 302.7161737520841, 633.2572639745392, 493.6756896786834, 422.81889326942945, 225.03511870202695, 517.0634992589635, 367.71042331963616, 469.2610543125725, 426.4914127110638, 315.75508729461296, 439.71477193399585, 304.6127848659172, 394.32548334267847, 427.3137490817398, 312.55267024564574, 464.8678110034003, 132.9969737727737, 231.365175111746, 281.26339771896085, 501.4821523617387, 547.3506947425793, 303.7870976935599, 329.4563767380433, 477.8145953041506, 386.81066350308487, 362.4865429774177, 365.2762746498669, 299.1088932347012, 287.23276288383164, 304.3204333587681, 430.86464490132715, 484.0334922946006, 472.0754707054617, 432.57054162384, 488.9548126361789, 516.5687385162098, 440.52361302316376, 303.9730510109369, 202.1228213099476, 416.5126964884656, 446.7660738128324, 660.8582870989135, 609.0311304621862, 408.6810035569847, 314.33219994913253, 561.1144266418592, 300.64644381009225, 307.17147200724946, 448.25710706320433, 456.6329117211243, 355.73023946862173, 304.25530718921914, 617.8152296751772, 359.03125482880563, 457.9355189116838, 646.2395377199177, 505.2978866349088, 442.99235642242274, 327.16086758198514, 288.4803529134195, 538.2418759450422, 469.6872688650581, 724.9017105331576, 412.7677120318081, 446.26606751095954, 483.3771247398943, 380.5829105685503, 502.95338803844373, 368.8820322895466, 409.25881624462954, 400.8255622487062, 588.7906073026743, 410.440977308597, 624.9808161204319, 435.6414669480826, 387.18572719135034, 480.24836957821947, 633.7635778532778, 439.30071862508487, 291.4907627537249, 388.1643922858189, 227.69953231779766, 349.7224891961912, 448.7985174525811, 590.0545417937469, 517.0690129957377, 524.4588785731236, 465.4004363031575, 487.6680260415913, 361.75001324845505, 488.694010129223, 620.5128760333833, 546.6375146607547, 593.9927014850073, 432.86255453477827, 479.3918230098136, 419.1861526178569, 435.64219304608434, 416.2771046567427, 374.8160907459063, 597.3589712580662, 396.538610632892, 472.6644017854729, 713.0710402534951, 577.3491588651991, 402.22297544078174, 517.8281439651603, 438.09161396954426, 280.3567736359855, 520.1368368485986, 663.1578407639659, 666.3247645840692, 552.2883857017014, 621.4894541122975, 543.0201203777503, 512.66328631746, 595.3370547590775, 449.20939866247653, 299.6460808953239, 491.20590272598537, 314.13519620712935, 456.2144289909455, 504.50109249075166, 506.0239096084962, 624.1119975639483, 344.12684679827726, 455.25632177176357, 414.1986156899366, 128.89765396739475, 289.10222783192154, 385.233253663681, 371.16776694573207, 281.35313517325375, 282.59683783837636, 468.96720037423796, 137.06009857578044, 216.12352738721245, 476.0210630325948, 552.1922932786862, 618.5603962616796, 522.1884553235728, 337.01577053651744, 286.05645621377835, 390.28995696796716, 521.0217545611775, 344.3878858443206, 224.64342674147028, 356.1300979796268, 332.22842590582576, 86.47431363095028, 45.56355923635174, 430.3312610480649, 453.8202648855017, 131.72838291922463, 128.53849415958956, 518.3912015708075, 574.0644172783583, 299.94722176969395, 234.40663620214974, 519.4316861342194, 430.26626509965297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8780595613430375, "mean_inference_ms": 2.6504314864862373, "mean_action_processing_ms": 0.39143250448359784, "mean_env_wait_ms": 0.32094740878652245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00407719612121582, "StateBufferConnector_ms": 0.0032339096069335938, "ViewRequirementAgentConnector_ms": 0.1277751922607422}, "num_episodes": 18, "episode_return_max": 2079.8349097360556, "episode_return_min": 1022.835511734753, "episode_return_mean": 1725.824682189767, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.58563035666236, "num_env_steps_trained_throughput_per_sec": 283.58563035666236, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 13675.74, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13675.68, "sample_time_ms": 2006.943, "learn_time_ms": 11645.592, "learn_throughput": 343.478, "synch_weights_time_ms": 20.512}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "8abce_00000", "date": "2024-08-16_11-31-09", "timestamp": 1723788069, "time_this_iter_s": 14.149449110031128, "time_total_s": 580.8967616558075, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43b49d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 580.8967616558075, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 63.9, "ram_util_percent": 82.345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5845539194250864, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.642281899124226, "policy_loss": 0.0018749839981042204, "vf_loss": 9.638625013260615, "vf_explained_var": -0.024234723098694334, "kl": 0.017819101341152315, "entropy": 1.4226037453091334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6904723285840302, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.585224661751399, "policy_loss": -0.0077572230978932965, "vf_loss": 9.591166643617015, "vf_explained_var": -0.039443382510432494, "kl": 0.009076178527860744, "entropy": 1.0462285829284204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 2079.8349097360556, "episode_reward_min": 885.201915973272, "episode_reward_mean": 1705.472407077116, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 138.5799675666745, "predator_policy": 13.647296421357288}, "policy_reward_max": {"prey_policy": 744.3458003218595, "predator_policy": 724.9017105331576}, "policy_reward_mean": {"prey_policy": 436.3713991156954, "predator_policy": 416.36480442286285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1963.6244596934166, 1781.282000968902, 2033.4734684029204, 1456.3857262547551, 1818.3250482064273, 1574.80076118175, 1635.8307614083687, 1549.623088970788, 1735.3339430326648, 1602.0988653212523, 1596.773383583056, 2079.8349097360556, 1907.399678876893, 1811.2167959745707, 1674.2838106385193, 1411.2501028524173, 1820.7974151421663, 1979.4852718271497, 1881.1006115558337, 1683.344580333422, 1172.498167032293, 1693.2122584893775, 1827.3588868657628, 1669.3221266138812, 1945.4191949063254, 1651.4166542437438, 1692.6318504666172, 1695.4437612036274, 1854.7411079587814, 1629.2515638046145, 1524.2361711655342, 1596.1302042222108, 1695.3885005669886, 1558.0992182774037, 1375.6755551794301, 1742.751838198174, 1824.1137301045637, 1649.9040475408158, 1888.6212244363755, 1732.1955329401906, 1728.026738453943, 1870.4348577432677, 1686.3588778168776, 1863.0660016237607, 2033.8182409473188, 1843.0822404679002, 1599.572895681846, 1717.9359829485056, 1633.8165005467129, 1534.84963574059, 1761.187491114833, 1690.7974586726152, 1868.6247587573155, 1851.2454661934357, 1758.1595613561678, 1741.6051977423854, 1912.8677050034776, 2022.2441511855507, 2019.1374783644924, 1676.4075433806802, 1645.3602246009596, 1703.8383294449934, 1984.05002175817, 2015.1638731497053, 1754.3312888009684, 1496.1732820537084, 1625.9181314960817, 1694.2589436331643, 1843.706937830525, 1824.0622651104406, 1991.4256514090382, 1755.7274287140342, 1509.3532417532197, 1704.3222934545647, 1414.2696215295941, 1825.8482892413142, 1022.835511734753, 1662.565217476208, 1077.7137330401051, 1923.4173623583908, 1203.0235808990085, 1783.5326279873716, 1957.2364415325032, 1961.2145030165077, 1765.7636917958694, 1848.127992325695, 1893.4023747956214, 1424.3980334706177, 1912.5134286921852, 1218.414714415883, 1474.2278448113004, 1685.1136580336363, 1834.7013920585246, 1837.9688160958833, 1860.6111621119612, 1362.0746649357068, 1765.475251690428, 885.201915973272, 1463.224855003888, 1708.7570475560965], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [454.6176861181445, 490.42279586331165, 460.7234132347773, 517.652872942277, 444.70927194461433, 461.83124280508105, 370.2709889184378, 438.260725364861, 387.904780007282, 545.6463456205463, 336.87723257906157, 342.1710615790522, 347.8724781799034, 532.4884239998574, 438.99879457243907, 411.6860261897547, 453.7149357581231, 541.7525879471548, 499.48002075288537, 504.7540597921946, 581.6758048754374, 502.46900587691283, 616.5019658624657, 414.50009676927215, 587.6869133164879, 686.4692911288, 490.15533299987516, 456.4362041674596, 526.7643346170034, 419.75665839423135, 437.99357586982484, 386.9148708640606, 568.7197794581579, 516.8925574239111, 508.95197099661675, 514.424337830469, 438.49136445577375, 521.0838928400408, 388.8156080169991, 337.43662077705005, 261.4475062339129, 404.95478847749683, 414.2326142190993, 415.7008739689811, 230.69908792655534, 326.77038137810723, 465.46648865969047, 480.8424344480736, 608.39997424202, 475.2583502123551, 365.34028832981335, 530.6477868434788, 442.0727714412753, 438.19592783559585, 343.2901881502279, 430.0830361890018, 488.70626848359035, 549.0680657347032, 275.57865100094716, 202.1354884488422, 350.4337184652481, 403.64922869587764, 450.7374529212361, 318.6705224425137, 160.89612446205987, 339.9033967067138, 344.9663334133794, 354.0991053212559, 338.1171992438229, 173.5983206271631, 489.3523339649359, 381.5640839052493, 542.2738805825237, 471.75547102870445, 314.6365909200972, 336.035872009446, 419.17970026140773, 408.81924110645423, 352.20239512511625, 512.559041045504, 314.5038917582798, 340.4585502173013, 531.7683480270485, 659.0113546766779, 669.2758250270314, 439.6610312758573, 302.9731629642289, 521.2397794132019, 630.2607471763935, 362.02960220206273, 359.7041758039647, 530.3096023191852, 293.8218439050829, 455.3070283990852, 350.6224018291739, 200.16319042519294, 327.706461027693, 279.2547834992362, 389.78811136120584, 246.48354875171498, 583.442976383896, 325.825217028109, 510.5737597711767, 208.04863689746765, 551.5554398977426, 447.86630644121095, 269.95189771174404, 290.8733693629972, 382.1479469871574, 455.9604949630691, 484.8124509057281, 538.3443592311282, 203.34307041740033, 526.2299569735123, 533.4736633385337, 270.15733756124393, 428.6833066839662, 425.9445971904781, 215.2778644611153, 353.12933784302925, 496.8585223458946, 399.6462226972651, 404.28114499420144, 494.21608551767844, 604.2724989558257, 419.0620013206468, 534.024437221255, 351.0035287560061, 435.94912812340715, 518.9989921075208, 338.6282461535403, 614.4487662428385, 592.9989817594441, 358.5836682410349, 457.18331191609104, 584.5547295980887, 542.2601982532193, 549.8827013646907, 726.5328388255866, 744.3458003218595, 444.97385418210087, 518.2384409156589, 347.68924956955027, 267.2893275592333, 506.9180864475134, 379.36292855541024, 624.5458442171192, 168.46473770830167, 321.4003392919908, 523.8379696518132, 625.3877871227664, 512.1019782330959, 438.62877958273265, 452.16885928471896, 433.19666117272925, 345.21703036991215, 341.54041325401937, 475.9064427072724, 367.6549184212969, 463.306825087928, 343.9197371948577, 324.74998573230835, 352.38551644716176, 481.44916030633726, 428.76726291009135, 562.5564523776264, 525.6207107619537, 414.2622999875916, 447.7657220087606, 485.82236242030905, 344.19079531241835, 597.5976566029277, 604.0203807692237, 615.6021968228109, 389.4241582374045, 476.3284992477526, 510.2486486040794, 384.128135279715, 385.23464498270397, 585.873852772826, 138.5799675666745, 510.0853417804672, 492.37200852690495, 537.2063759035765, 402.4141304185485, 435.0185845256501, 484.9094753980734, 461.7186735579685, 636.7121943338494, 563.08395266821, 476.20678379299426, 333.5648828751873, 537.2508148991187, 461.62040827371993, 334.5428136933757, 270.8288178954961, 266.9189761012051, 564.7217154360136, 410.04264450343953, 264.6684588650691], "policy_predator_policy_reward": [572.6590334059365, 445.9249443060214, 500.18954103976546, 302.7161737520841, 633.2572639745392, 493.6756896786834, 422.81889326942945, 225.03511870202695, 517.0634992589635, 367.71042331963616, 469.2610543125725, 426.4914127110638, 315.75508729461296, 439.71477193399585, 304.6127848659172, 394.32548334267847, 427.3137490817398, 312.55267024564574, 464.8678110034003, 132.9969737727737, 231.365175111746, 281.26339771896085, 501.4821523617387, 547.3506947425793, 303.7870976935599, 329.4563767380433, 477.8145953041506, 386.81066350308487, 362.4865429774177, 365.2762746498669, 299.1088932347012, 287.23276288383164, 304.3204333587681, 430.86464490132715, 484.0334922946006, 472.0754707054617, 432.57054162384, 488.9548126361789, 516.5687385162098, 440.52361302316376, 303.9730510109369, 202.1228213099476, 416.5126964884656, 446.7660738128324, 660.8582870989135, 609.0311304621862, 408.6810035569847, 314.33219994913253, 561.1144266418592, 300.64644381009225, 307.17147200724946, 448.25710706320433, 456.6329117211243, 355.73023946862173, 304.25530718921914, 617.8152296751772, 359.03125482880563, 457.9355189116838, 646.2395377199177, 505.2978866349088, 442.99235642242274, 327.16086758198514, 288.4803529134195, 538.2418759450422, 469.6872688650581, 724.9017105331576, 412.7677120318081, 446.26606751095954, 483.3771247398943, 380.5829105685503, 502.95338803844373, 368.8820322895466, 409.25881624462954, 400.8255622487062, 588.7906073026743, 410.440977308597, 624.9808161204319, 435.6414669480826, 387.18572719135034, 480.24836957821947, 633.7635778532778, 439.30071862508487, 291.4907627537249, 388.1643922858189, 227.69953231779766, 349.7224891961912, 448.7985174525811, 590.0545417937469, 517.0690129957377, 524.4588785731236, 465.4004363031575, 487.6680260415913, 361.75001324845505, 488.694010129223, 620.5128760333833, 546.6375146607547, 593.9927014850073, 432.86255453477827, 479.3918230098136, 419.1861526178569, 435.64219304608434, 416.2771046567427, 374.8160907459063, 597.3589712580662, 396.538610632892, 472.6644017854729, 713.0710402534951, 577.3491588651991, 402.22297544078174, 517.8281439651603, 438.09161396954426, 280.3567736359855, 520.1368368485986, 663.1578407639659, 666.3247645840692, 552.2883857017014, 621.4894541122975, 543.0201203777503, 512.66328631746, 595.3370547590775, 449.20939866247653, 299.6460808953239, 491.20590272598537, 314.13519620712935, 456.2144289909455, 504.50109249075166, 506.0239096084962, 624.1119975639483, 344.12684679827726, 455.25632177176357, 414.1986156899366, 128.89765396739475, 289.10222783192154, 385.233253663681, 371.16776694573207, 281.35313517325375, 282.59683783837636, 468.96720037423796, 137.06009857578044, 216.12352738721245, 476.0210630325948, 552.1922932786862, 618.5603962616796, 522.1884553235728, 337.01577053651744, 286.05645621377835, 390.28995696796716, 521.0217545611775, 344.3878858443206, 224.64342674147028, 356.1300979796268, 332.22842590582576, 86.47431363095028, 45.56355923635174, 430.3312610480649, 453.8202648855017, 131.72838291922463, 128.53849415958956, 518.3912015708075, 574.0644172783583, 299.94722176969395, 234.40663620214974, 519.4316861342194, 430.26626509965297, 548.692164627546, 417.22056161723924, 413.5482721547775, 607.7832201121852, 401.3777691537238, 430.79783821307774, 341.5942272979556, 564.7453131123913, 407.7615329787806, 266.0182642248046, 163.39764386236203, 395.2477321230997, 436.969780538112, 581.166864270279, 172.67816940118507, 74.62804725916786, 344.79752300762703, 480.7650124565326, 364.09152810306614, 291.4437455000914, 415.9602451733086, 581.3084319410193, 475.90931924392424, 415.431347895921, 293.0874791796642, 367.72753593023765, 225.3307695581124, 326.97222870941226, 431.46776236007906, 335.1362661575097, 266.1829879630427, 13.647296421357288, 363.96423288464644, 267.6199305820237, 587.8856271274207, 446.1603170601683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8746655139147259, "mean_inference_ms": 2.6412812570461233, "mean_action_processing_ms": 0.3891040288003271, "mean_env_wait_ms": 0.3197658311918945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004032731056213379, "StateBufferConnector_ms": 0.0031796693801879883, "ViewRequirementAgentConnector_ms": 0.12432575225830078}, "num_episodes": 18, "episode_return_max": 2079.8349097360556, "episode_return_min": 885.201915973272, "episode_return_mean": 1705.472407077116, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.66172360611665, "num_env_steps_trained_throughput_per_sec": 298.66172360611665, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 13599.728, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13599.67, "sample_time_ms": 1896.062, "learn_time_ms": 11682.423, "learn_throughput": 342.395, "synch_weights_time_ms": 18.429}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "8abce_00000", "date": "2024-08-16_11-31-23", "timestamp": 1723788083, "time_this_iter_s": 13.443541049957275, "time_total_s": 594.3403027057648, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43b4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 594.3403027057648, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 61.40526315789474, "ram_util_percent": 82.03684210526318}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5822915679247922, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.654395342125463, "policy_loss": -0.0051755973566619175, "vf_loss": 9.658389923559925, "vf_explained_var": -0.036812491328627975, "kl": 0.011809958514305628, "entropy": 1.4438752026154251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7685967492205756, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.502293293059818, "policy_loss": -0.00616599847390144, "vf_loss": 9.506790522923545, "vf_explained_var": -0.0722181980256681, "kl": 0.008343930847770931, "entropy": 0.9689918368266373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 2033.8182409473188, "episode_reward_min": 598.4101233220965, "episode_reward_mean": 1687.9454186477972, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 129.71000000000015, "predator_policy": 13.647296421357288}, "policy_reward_max": {"prey_policy": 744.3458003218595, "predator_policy": 724.9017105331576}, "policy_reward_mean": {"prey_policy": 433.9711375531671, "predator_policy": 410.00157177073163}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1881.1006115558337, 1683.344580333422, 1172.498167032293, 1693.2122584893775, 1827.3588868657628, 1669.3221266138812, 1945.4191949063254, 1651.4166542437438, 1692.6318504666172, 1695.4437612036274, 1854.7411079587814, 1629.2515638046145, 1524.2361711655342, 1596.1302042222108, 1695.3885005669886, 1558.0992182774037, 1375.6755551794301, 1742.751838198174, 1824.1137301045637, 1649.9040475408158, 1888.6212244363755, 1732.1955329401906, 1728.026738453943, 1870.4348577432677, 1686.3588778168776, 1863.0660016237607, 2033.8182409473188, 1843.0822404679002, 1599.572895681846, 1717.9359829485056, 1633.8165005467129, 1534.84963574059, 1761.187491114833, 1690.7974586726152, 1868.6247587573155, 1851.2454661934357, 1758.1595613561678, 1741.6051977423854, 1912.8677050034776, 2022.2441511855507, 2019.1374783644924, 1676.4075433806802, 1645.3602246009596, 1703.8383294449934, 1984.05002175817, 2015.1638731497053, 1754.3312888009684, 1496.1732820537084, 1625.9181314960817, 1694.2589436331643, 1843.706937830525, 1824.0622651104406, 1991.4256514090382, 1755.7274287140342, 1509.3532417532197, 1704.3222934545647, 1414.2696215295941, 1825.8482892413142, 1022.835511734753, 1662.565217476208, 1077.7137330401051, 1923.4173623583908, 1203.0235808990085, 1783.5326279873716, 1957.2364415325032, 1961.2145030165077, 1765.7636917958694, 1848.127992325695, 1893.4023747956214, 1424.3980334706177, 1912.5134286921852, 1218.414714415883, 1474.2278448113004, 1685.1136580336363, 1834.7013920585246, 1837.9688160958833, 1860.6111621119612, 1362.0746649357068, 1765.475251690428, 885.201915973272, 1463.224855003888, 1708.7570475560965, 598.4101233220965, 2004.122344199706, 1891.777785970829, 1827.5179910922584, 1368.4018141385855, 1595.924629910605, 1470.3427152336492, 1329.1481715896743, 1862.2547692463347, 1963.7617033834752, 1295.4514400724017, 1855.4930376961374, 1740.8660333983216, 1995.9973559533605, 1679.6462939594562, 1997.1101340421446, 1658.6161524882598, 1544.278153442878], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [438.49136445577375, 521.0838928400408, 388.8156080169991, 337.43662077705005, 261.4475062339129, 404.95478847749683, 414.2326142190993, 415.7008739689811, 230.69908792655534, 326.77038137810723, 465.46648865969047, 480.8424344480736, 608.39997424202, 475.2583502123551, 365.34028832981335, 530.6477868434788, 442.0727714412753, 438.19592783559585, 343.2901881502279, 430.0830361890018, 488.70626848359035, 549.0680657347032, 275.57865100094716, 202.1354884488422, 350.4337184652481, 403.64922869587764, 450.7374529212361, 318.6705224425137, 160.89612446205987, 339.9033967067138, 344.9663334133794, 354.0991053212559, 338.1171992438229, 173.5983206271631, 489.3523339649359, 381.5640839052493, 542.2738805825237, 471.75547102870445, 314.6365909200972, 336.035872009446, 419.17970026140773, 408.81924110645423, 352.20239512511625, 512.559041045504, 314.5038917582798, 340.4585502173013, 531.7683480270485, 659.0113546766779, 669.2758250270314, 439.6610312758573, 302.9731629642289, 521.2397794132019, 630.2607471763935, 362.02960220206273, 359.7041758039647, 530.3096023191852, 293.8218439050829, 455.3070283990852, 350.6224018291739, 200.16319042519294, 327.706461027693, 279.2547834992362, 389.78811136120584, 246.48354875171498, 583.442976383896, 325.825217028109, 510.5737597711767, 208.04863689746765, 551.5554398977426, 447.86630644121095, 269.95189771174404, 290.8733693629972, 382.1479469871574, 455.9604949630691, 484.8124509057281, 538.3443592311282, 203.34307041740033, 526.2299569735123, 533.4736633385337, 270.15733756124393, 428.6833066839662, 425.9445971904781, 215.2778644611153, 353.12933784302925, 496.8585223458946, 399.6462226972651, 404.28114499420144, 494.21608551767844, 604.2724989558257, 419.0620013206468, 534.024437221255, 351.0035287560061, 435.94912812340715, 518.9989921075208, 338.6282461535403, 614.4487662428385, 592.9989817594441, 358.5836682410349, 457.18331191609104, 584.5547295980887, 542.2601982532193, 549.8827013646907, 726.5328388255866, 744.3458003218595, 444.97385418210087, 518.2384409156589, 347.68924956955027, 267.2893275592333, 506.9180864475134, 379.36292855541024, 624.5458442171192, 168.46473770830167, 321.4003392919908, 523.8379696518132, 625.3877871227664, 512.1019782330959, 438.62877958273265, 452.16885928471896, 433.19666117272925, 345.21703036991215, 341.54041325401937, 475.9064427072724, 367.6549184212969, 463.306825087928, 343.9197371948577, 324.74998573230835, 352.38551644716176, 481.44916030633726, 428.76726291009135, 562.5564523776264, 525.6207107619537, 414.2622999875916, 447.7657220087606, 485.82236242030905, 344.19079531241835, 597.5976566029277, 604.0203807692237, 615.6021968228109, 389.4241582374045, 476.3284992477526, 510.2486486040794, 384.128135279715, 385.23464498270397, 585.873852772826, 138.5799675666745, 510.0853417804672, 492.37200852690495, 537.2063759035765, 402.4141304185485, 435.0185845256501, 484.9094753980734, 461.7186735579685, 636.7121943338494, 563.08395266821, 476.20678379299426, 333.5648828751873, 537.2508148991187, 461.62040827371993, 334.5428136933757, 270.8288178954961, 266.9189761012051, 564.7217154360136, 410.04264450343953, 264.6684588650691, 129.71000000000015, 318.9075597659765, 422.9844524622342, 581.365794841431, 401.79557098416296, 400.98562814970404, 584.7689702316785, 367.6807073558563, 507.620947129861, 317.2763273693356, 435.4632473357878, 453.140749074735, 546.1872448330406, 420.511215342184, 290.7195142516976, 504.8054263291341, 598.9230213321898, 576.9800437102947, 552.7485958783797, 451.0534263116098, 513.352981027714, 507.9977370908578, 561.407595187931, 448.04783141195384, 462.6616181484429, 599.2089842140876, 411.1823923193052, 612.0201826861551, 614.9429851210173, 477.8749758365183, 449.862664746924, 472.62817737272735, 325.7458749350533, 393.3918103517351, 527.3068097347931, 476.83506924059276], "policy_predator_policy_reward": [432.57054162384, 488.9548126361789, 516.5687385162098, 440.52361302316376, 303.9730510109369, 202.1228213099476, 416.5126964884656, 446.7660738128324, 660.8582870989135, 609.0311304621862, 408.6810035569847, 314.33219994913253, 561.1144266418592, 300.64644381009225, 307.17147200724946, 448.25710706320433, 456.6329117211243, 355.73023946862173, 304.25530718921914, 617.8152296751772, 359.03125482880563, 457.9355189116838, 646.2395377199177, 505.2978866349088, 442.99235642242274, 327.16086758198514, 288.4803529134195, 538.2418759450422, 469.6872688650581, 724.9017105331576, 412.7677120318081, 446.26606751095954, 483.3771247398943, 380.5829105685503, 502.95338803844373, 368.8820322895466, 409.25881624462954, 400.8255622487062, 588.7906073026743, 410.440977308597, 624.9808161204319, 435.6414669480826, 387.18572719135034, 480.24836957821947, 633.7635778532778, 439.30071862508487, 291.4907627537249, 388.1643922858189, 227.69953231779766, 349.7224891961912, 448.7985174525811, 590.0545417937469, 517.0690129957377, 524.4588785731236, 465.4004363031575, 487.6680260415913, 361.75001324845505, 488.694010129223, 620.5128760333833, 546.6375146607547, 593.9927014850073, 432.86255453477827, 479.3918230098136, 419.1861526178569, 435.64219304608434, 416.2771046567427, 374.8160907459063, 597.3589712580662, 396.538610632892, 472.6644017854729, 713.0710402534951, 577.3491588651991, 402.22297544078174, 517.8281439651603, 438.09161396954426, 280.3567736359855, 520.1368368485986, 663.1578407639659, 666.3247645840692, 552.2883857017014, 621.4894541122975, 543.0201203777503, 512.66328631746, 595.3370547590775, 449.20939866247653, 299.6460808953239, 491.20590272598537, 314.13519620712935, 456.2144289909455, 504.50109249075166, 506.0239096084962, 624.1119975639483, 344.12684679827726, 455.25632177176357, 414.1986156899366, 128.89765396739475, 289.10222783192154, 385.233253663681, 371.16776694573207, 281.35313517325375, 282.59683783837636, 468.96720037423796, 137.06009857578044, 216.12352738721245, 476.0210630325948, 552.1922932786862, 618.5603962616796, 522.1884553235728, 337.01577053651744, 286.05645621377835, 390.28995696796716, 521.0217545611775, 344.3878858443206, 224.64342674147028, 356.1300979796268, 332.22842590582576, 86.47431363095028, 45.56355923635174, 430.3312610480649, 453.8202648855017, 131.72838291922463, 128.53849415958956, 518.3912015708075, 574.0644172783583, 299.94722176969395, 234.40663620214974, 519.4316861342194, 430.26626509965297, 548.692164627546, 417.22056161723924, 413.5482721547775, 607.7832201121852, 401.3777691537238, 430.79783821307774, 341.5942272979556, 564.7453131123913, 407.7615329787806, 266.0182642248046, 163.39764386236203, 395.2477321230997, 436.969780538112, 581.166864270279, 172.67816940118507, 74.62804725916786, 344.79752300762703, 480.7650124565326, 364.09152810306614, 291.4437455000914, 415.9602451733086, 581.3084319410193, 475.90931924392424, 415.431347895921, 293.0874791796642, 367.72753593023765, 225.3307695581124, 326.97222870941226, 431.46776236007906, 335.1362661575097, 266.1829879630427, 13.647296421357288, 363.96423288464644, 267.6199305820237, 587.8856271274207, 446.1603170601683, 73.52647468997223, 76.26608886614807, 490.2236368943728, 509.54846000166907, 492.6024267201092, 596.394160116852, 548.554172194535, 326.5141413101915, 316.4459129386891, 227.05862670070007, 334.24467466529893, 373.0759588347839, 187.96955582376245, 315.6746992346619, 230.09101696584295, 303.5322140430031, 264.39234638501165, 421.9593578188377, 469.3980755166781, 490.5616056768059, 15.461227499748464, 258.6394944540807, 496.7382704459986, 349.29934065025384, 425.11411770366635, 253.88131333212777, 469.3858238021885, 503.40895714571235, 260.61212986007376, 326.2162031418469, 476.28282320171337, 598.3364687207811, 583.0997671166938, 356.37870008477825, 94.41587052358804, 445.72040394390217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8712852546320373, "mean_inference_ms": 2.632303125687136, "mean_action_processing_ms": 0.38690651818089977, "mean_env_wait_ms": 0.31863323215660977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004064321517944336, "StateBufferConnector_ms": 0.0031843185424804688, "ViewRequirementAgentConnector_ms": 0.12661468982696533}, "num_episodes": 18, "episode_return_max": 2033.8182409473188, "episode_return_min": 598.4101233220965, "episode_return_mean": 1687.9454186477972, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.97120367809373, "num_env_steps_trained_throughput_per_sec": 292.97120367809373, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 13614.9, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13614.841, "sample_time_ms": 1826.72, "learn_time_ms": 11767.638, "learn_throughput": 339.915, "synch_weights_time_ms": 17.671}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "8abce_00000", "date": "2024-08-16_11-31-37", "timestamp": 1723788097, "time_this_iter_s": 13.697424173355103, "time_total_s": 608.0377268791199, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 608.0377268791199, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 62.53684210526316, "ram_util_percent": 81.96315789473682}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6468260436304032, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.5949835666273, "policy_loss": -0.004545698686571861, "vf_loss": 9.598354454646035, "vf_explained_var": -0.04251889668444477, "kl": 0.011748175422870892, "entropy": 1.4026415937792056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9824662156521329, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.511715017046248, "policy_loss": -0.0061797586674974475, "vf_loss": 9.516387287523381, "vf_explained_var": -0.05500098801163769, "kl": 0.007537415678333762, "entropy": 0.9501397492708983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 2036.6139081467993, "episode_reward_min": 598.4101233220965, "episode_reward_mean": 1690.0679975207868, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 129.71000000000015, "predator_policy": 13.647296421357288}, "policy_reward_max": {"prey_policy": 744.3458003218595, "predator_policy": 713.0710402534951}, "policy_reward_mean": {"prey_policy": 457.8764743246263, "predator_policy": 387.15752443576724}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1728.026738453943, 1870.4348577432677, 1686.3588778168776, 1863.0660016237607, 2033.8182409473188, 1843.0822404679002, 1599.572895681846, 1717.9359829485056, 1633.8165005467129, 1534.84963574059, 1761.187491114833, 1690.7974586726152, 1868.6247587573155, 1851.2454661934357, 1758.1595613561678, 1741.6051977423854, 1912.8677050034776, 2022.2441511855507, 2019.1374783644924, 1676.4075433806802, 1645.3602246009596, 1703.8383294449934, 1984.05002175817, 2015.1638731497053, 1754.3312888009684, 1496.1732820537084, 1625.9181314960817, 1694.2589436331643, 1843.706937830525, 1824.0622651104406, 1991.4256514090382, 1755.7274287140342, 1509.3532417532197, 1704.3222934545647, 1414.2696215295941, 1825.8482892413142, 1022.835511734753, 1662.565217476208, 1077.7137330401051, 1923.4173623583908, 1203.0235808990085, 1783.5326279873716, 1957.2364415325032, 1961.2145030165077, 1765.7636917958694, 1848.127992325695, 1893.4023747956214, 1424.3980334706177, 1912.5134286921852, 1218.414714415883, 1474.2278448113004, 1685.1136580336363, 1834.7013920585246, 1837.9688160958833, 1860.6111621119612, 1362.0746649357068, 1765.475251690428, 885.201915973272, 1463.224855003888, 1708.7570475560965, 598.4101233220965, 2004.122344199706, 1891.777785970829, 1827.5179910922584, 1368.4018141385855, 1595.924629910605, 1470.3427152336492, 1329.1481715896743, 1862.2547692463347, 1963.7617033834752, 1295.4514400724017, 1855.4930376961374, 1740.8660333983216, 1995.9973559533605, 1679.6462939594562, 1997.1101340421446, 1658.6161524882598, 1544.278153442878, 1809.1960119001062, 1702.8653440201176, 1812.7974490978922, 1930.0803350205795, 1472.3598172068146, 1639.2493695188969, 2036.6139081467993, 1880.6426765791591, 1636.098669692622, 1945.3775589521347, 1127.1568903269012, 1736.850298131979, 1805.1793469748452, 1438.1460788447469, 1168.104471302645, 1783.1842884643997, 1926.396554742236, 1685.013996225032, 1699.6877246114236, 1658.024327637821, 1798.6291505056734, 1503.460405502085], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [314.5038917582798, 340.4585502173013, 531.7683480270485, 659.0113546766779, 669.2758250270314, 439.6610312758573, 302.9731629642289, 521.2397794132019, 630.2607471763935, 362.02960220206273, 359.7041758039647, 530.3096023191852, 293.8218439050829, 455.3070283990852, 350.6224018291739, 200.16319042519294, 327.706461027693, 279.2547834992362, 389.78811136120584, 246.48354875171498, 583.442976383896, 325.825217028109, 510.5737597711767, 208.04863689746765, 551.5554398977426, 447.86630644121095, 269.95189771174404, 290.8733693629972, 382.1479469871574, 455.9604949630691, 484.8124509057281, 538.3443592311282, 203.34307041740033, 526.2299569735123, 533.4736633385337, 270.15733756124393, 428.6833066839662, 425.9445971904781, 215.2778644611153, 353.12933784302925, 496.8585223458946, 399.6462226972651, 404.28114499420144, 494.21608551767844, 604.2724989558257, 419.0620013206468, 534.024437221255, 351.0035287560061, 435.94912812340715, 518.9989921075208, 338.6282461535403, 614.4487662428385, 592.9989817594441, 358.5836682410349, 457.18331191609104, 584.5547295980887, 542.2601982532193, 549.8827013646907, 726.5328388255866, 744.3458003218595, 444.97385418210087, 518.2384409156589, 347.68924956955027, 267.2893275592333, 506.9180864475134, 379.36292855541024, 624.5458442171192, 168.46473770830167, 321.4003392919908, 523.8379696518132, 625.3877871227664, 512.1019782330959, 438.62877958273265, 452.16885928471896, 433.19666117272925, 345.21703036991215, 341.54041325401937, 475.9064427072724, 367.6549184212969, 463.306825087928, 343.9197371948577, 324.74998573230835, 352.38551644716176, 481.44916030633726, 428.76726291009135, 562.5564523776264, 525.6207107619537, 414.2622999875916, 447.7657220087606, 485.82236242030905, 344.19079531241835, 597.5976566029277, 604.0203807692237, 615.6021968228109, 389.4241582374045, 476.3284992477526, 510.2486486040794, 384.128135279715, 385.23464498270397, 585.873852772826, 138.5799675666745, 510.0853417804672, 492.37200852690495, 537.2063759035765, 402.4141304185485, 435.0185845256501, 484.9094753980734, 461.7186735579685, 636.7121943338494, 563.08395266821, 476.20678379299426, 333.5648828751873, 537.2508148991187, 461.62040827371993, 334.5428136933757, 270.8288178954961, 266.9189761012051, 564.7217154360136, 410.04264450343953, 264.6684588650691, 129.71000000000015, 318.9075597659765, 422.9844524622342, 581.365794841431, 401.79557098416296, 400.98562814970404, 584.7689702316785, 367.6807073558563, 507.620947129861, 317.2763273693356, 435.4632473357878, 453.140749074735, 546.1872448330406, 420.511215342184, 290.7195142516976, 504.8054263291341, 598.9230213321898, 576.9800437102947, 552.7485958783797, 451.0534263116098, 513.352981027714, 507.9977370908578, 561.407595187931, 448.04783141195384, 462.6616181484429, 599.2089842140876, 411.1823923193052, 612.0201826861551, 614.9429851210173, 477.8749758365183, 449.862664746924, 472.62817737272735, 325.7458749350533, 393.3918103517351, 527.3068097347931, 476.83506924059276, 520.7668332813181, 725.0779518744705, 574.786083046922, 419.741181122687, 486.7697566656827, 531.7990003138748, 502.6491105145193, 585.170904732075, 427.16745604789804, 436.6130822087368, 437.8712075541913, 516.0053174419614, 505.72905145965314, 582.8079001055013, 510.0970983858696, 545.9094885007462, 499.80040879746963, 440.6353645971589, 525.0776193416839, 531.915423142074, 488.3884170133743, 225.18127667728885, 539.2641668492371, 724.3165879358285, 511.8635944485153, 568.2389630810204, 535.3016598232573, 342.1790313703398, 516.2997737860085, 284.96417579325146, 546.5144819950721, 620.480351229144, 491.7987088455833, 464.41357881705034, 594.8293097163632, 525.726169903092, 618.6185431386114, 475.3178281659762, 483.7593940637112, 311.6202155110833, 543.4049516393288, 396.0648303550725, 527.9863662627264, 436.31320929873846], "policy_predator_policy_reward": [633.7635778532778, 439.30071862508487, 291.4907627537249, 388.1643922858189, 227.69953231779766, 349.7224891961912, 448.7985174525811, 590.0545417937469, 517.0690129957377, 524.4588785731236, 465.4004363031575, 487.6680260415913, 361.75001324845505, 488.694010129223, 620.5128760333833, 546.6375146607547, 593.9927014850073, 432.86255453477827, 479.3918230098136, 419.1861526178569, 435.64219304608434, 416.2771046567427, 374.8160907459063, 597.3589712580662, 396.538610632892, 472.6644017854729, 713.0710402534951, 577.3491588651991, 402.22297544078174, 517.8281439651603, 438.09161396954426, 280.3567736359855, 520.1368368485986, 663.1578407639659, 666.3247645840692, 552.2883857017014, 621.4894541122975, 543.0201203777503, 512.66328631746, 595.3370547590775, 449.20939866247653, 299.6460808953239, 491.20590272598537, 314.13519620712935, 456.2144289909455, 504.50109249075166, 506.0239096084962, 624.1119975639483, 344.12684679827726, 455.25632177176357, 414.1986156899366, 128.89765396739475, 289.10222783192154, 385.233253663681, 371.16776694573207, 281.35313517325375, 282.59683783837636, 468.96720037423796, 137.06009857578044, 216.12352738721245, 476.0210630325948, 552.1922932786862, 618.5603962616796, 522.1884553235728, 337.01577053651744, 286.05645621377835, 390.28995696796716, 521.0217545611775, 344.3878858443206, 224.64342674147028, 356.1300979796268, 332.22842590582576, 86.47431363095028, 45.56355923635174, 430.3312610480649, 453.8202648855017, 131.72838291922463, 128.53849415958956, 518.3912015708075, 574.0644172783583, 299.94722176969395, 234.40663620214974, 519.4316861342194, 430.26626509965297, 548.692164627546, 417.22056161723924, 413.5482721547775, 607.7832201121852, 401.3777691537238, 430.79783821307774, 341.5942272979556, 564.7453131123913, 407.7615329787806, 266.0182642248046, 163.39764386236203, 395.2477321230997, 436.969780538112, 581.166864270279, 172.67816940118507, 74.62804725916786, 344.79752300762703, 480.7650124565326, 364.09152810306614, 291.4437455000914, 415.9602451733086, 581.3084319410193, 475.90931924392424, 415.431347895921, 293.0874791796642, 367.72753593023765, 225.3307695581124, 326.97222870941226, 431.46776236007906, 335.1362661575097, 266.1829879630427, 13.647296421357288, 363.96423288464644, 267.6199305820237, 587.8856271274207, 446.1603170601683, 73.52647468997223, 76.26608886614807, 490.2236368943728, 509.54846000166907, 492.6024267201092, 596.394160116852, 548.554172194535, 326.5141413101915, 316.4459129386891, 227.05862670070007, 334.24467466529893, 373.0759588347839, 187.96955582376245, 315.6746992346619, 230.09101696584295, 303.5322140430031, 264.39234638501165, 421.9593578188377, 469.3980755166781, 490.5616056768059, 15.461227499748464, 258.6394944540807, 496.7382704459986, 349.29934065025384, 425.11411770366635, 253.88131333212777, 469.3858238021885, 503.40895714571235, 260.61212986007376, 326.2162031418469, 476.28282320171337, 598.3364687207811, 583.0997671166938, 356.37870008477825, 94.41587052358804, 445.72040394390217, 416.8211511454369, 146.53007559888087, 572.9813895859983, 135.35669026451103, 401.82198846256057, 392.4067036557751, 430.69857751632617, 411.5617422576592, 323.66063002487687, 284.9186489253024, 465.17072861159323, 220.20211591115088, 391.03691864521056, 557.0400379364347, 302.61309317385377, 522.0229965186905, 306.89674465760424, 388.76615164038964, 555.3475691510938, 333.0369473172834, 223.8027024591946, 189.7844941770439, 189.5501826449705, 283.71936070194477, 442.1363361007477, 282.94045334456365, 215.4896315516439, 345.17575609950643, 225.85933795242477, 140.98118377096128, 246.9866042680261, 369.2028509721572, 559.0181805866866, 411.1660864929156, 325.55163578143345, 238.906880824144, 448.2098444892754, 157.54150881756155, 411.27797290639876, 451.3667451566294, 521.3734550244988, 337.78591348676986, 363.8777550766435, 175.28307486397762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8670281859762693, "mean_inference_ms": 2.6213211820789364, "mean_action_processing_ms": 0.3843565237563686, "mean_env_wait_ms": 0.31716525818231645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004241466522216797, "StateBufferConnector_ms": 0.0032253265380859375, "ViewRequirementAgentConnector_ms": 0.12179243564605713}, "num_episodes": 22, "episode_return_max": 2036.6139081467993, "episode_return_min": 598.4101233220965, "episode_return_mean": 1690.0679975207868, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.85391802758056, "num_env_steps_trained_throughput_per_sec": 296.85391802758056, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 13597.396, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13597.34, "sample_time_ms": 1772.837, "learn_time_ms": 11803.855, "learn_throughput": 338.872, "synch_weights_time_ms": 17.944}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "8abce_00000", "date": "2024-08-16_11-31-50", "timestamp": 1723788110, "time_this_iter_s": 13.500829935073853, "time_total_s": 621.5385568141937, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 621.5385568141937, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 66.1421052631579, "ram_util_percent": 82.11578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6395138558571931, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.647541825228897, "policy_loss": -0.0037649119056012265, "vf_loss": 9.65042898490946, "vf_explained_var": -0.0321901314473026, "kl": 0.008777803100789272, "entropy": 1.4172891479951364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9717720049398917, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.526000757066031, "policy_loss": -0.0035441217394594953, "vf_loss": 9.528024025064298, "vf_explained_var": -0.004004808266957601, "kl": 0.007604380027911834, "entropy": 0.9456423649712214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 2036.6139081467993, "episode_reward_min": 598.4101233220965, "episode_reward_mean": 1672.2158471099108, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 129.71000000000015, "predator_policy": 13.647296421357288}, "policy_reward_max": {"prey_policy": 744.3458003218595, "predator_policy": 624.1119975639483}, "policy_reward_mean": {"prey_policy": 476.8602862476504, "predator_policy": 359.2476373073051}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2015.1638731497053, 1754.3312888009684, 1496.1732820537084, 1625.9181314960817, 1694.2589436331643, 1843.706937830525, 1824.0622651104406, 1991.4256514090382, 1755.7274287140342, 1509.3532417532197, 1704.3222934545647, 1414.2696215295941, 1825.8482892413142, 1022.835511734753, 1662.565217476208, 1077.7137330401051, 1923.4173623583908, 1203.0235808990085, 1783.5326279873716, 1957.2364415325032, 1961.2145030165077, 1765.7636917958694, 1848.127992325695, 1893.4023747956214, 1424.3980334706177, 1912.5134286921852, 1218.414714415883, 1474.2278448113004, 1685.1136580336363, 1834.7013920585246, 1837.9688160958833, 1860.6111621119612, 1362.0746649357068, 1765.475251690428, 885.201915973272, 1463.224855003888, 1708.7570475560965, 598.4101233220965, 2004.122344199706, 1891.777785970829, 1827.5179910922584, 1368.4018141385855, 1595.924629910605, 1470.3427152336492, 1329.1481715896743, 1862.2547692463347, 1963.7617033834752, 1295.4514400724017, 1855.4930376961374, 1740.8660333983216, 1995.9973559533605, 1679.6462939594562, 1997.1101340421446, 1658.6161524882598, 1544.278153442878, 1809.1960119001062, 1702.8653440201176, 1812.7974490978922, 1930.0803350205795, 1472.3598172068146, 1639.2493695188969, 2036.6139081467993, 1880.6426765791591, 1636.098669692622, 1945.3775589521347, 1127.1568903269012, 1736.850298131979, 1805.1793469748452, 1438.1460788447469, 1168.104471302645, 1783.1842884643997, 1926.396554742236, 1685.013996225032, 1699.6877246114236, 1658.024327637821, 1798.6291505056734, 1503.460405502085, 1894.9323264785758, 1291.156760653393, 1959.5670060063826, 1829.0635235903178, 2004.6143355751117, 1751.6261320745323, 1833.1194034519842, 1629.57684393811, 1643.8292473118686, 1677.4500106286966, 1851.2036184674978, 1367.5026024611523, 1473.402992038549, 1729.281395309929, 1741.4873294196152, 1706.7567157765006, 1839.1861566176144, 1324.930770060245, 1784.7182826633045, 1714.7828004671737, 1603.3002387648012, 1979.5254107855617, 1730.2584159172907], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [534.024437221255, 351.0035287560061, 435.94912812340715, 518.9989921075208, 338.6282461535403, 614.4487662428385, 592.9989817594441, 358.5836682410349, 457.18331191609104, 584.5547295980887, 542.2601982532193, 549.8827013646907, 726.5328388255866, 744.3458003218595, 444.97385418210087, 518.2384409156589, 347.68924956955027, 267.2893275592333, 506.9180864475134, 379.36292855541024, 624.5458442171192, 168.46473770830167, 321.4003392919908, 523.8379696518132, 625.3877871227664, 512.1019782330959, 438.62877958273265, 452.16885928471896, 433.19666117272925, 345.21703036991215, 341.54041325401937, 475.9064427072724, 367.6549184212969, 463.306825087928, 343.9197371948577, 324.74998573230835, 352.38551644716176, 481.44916030633726, 428.76726291009135, 562.5564523776264, 525.6207107619537, 414.2622999875916, 447.7657220087606, 485.82236242030905, 344.19079531241835, 597.5976566029277, 604.0203807692237, 615.6021968228109, 389.4241582374045, 476.3284992477526, 510.2486486040794, 384.128135279715, 385.23464498270397, 585.873852772826, 138.5799675666745, 510.0853417804672, 492.37200852690495, 537.2063759035765, 402.4141304185485, 435.0185845256501, 484.9094753980734, 461.7186735579685, 636.7121943338494, 563.08395266821, 476.20678379299426, 333.5648828751873, 537.2508148991187, 461.62040827371993, 334.5428136933757, 270.8288178954961, 266.9189761012051, 564.7217154360136, 410.04264450343953, 264.6684588650691, 129.71000000000015, 318.9075597659765, 422.9844524622342, 581.365794841431, 401.79557098416296, 400.98562814970404, 584.7689702316785, 367.6807073558563, 507.620947129861, 317.2763273693356, 435.4632473357878, 453.140749074735, 546.1872448330406, 420.511215342184, 290.7195142516976, 504.8054263291341, 598.9230213321898, 576.9800437102947, 552.7485958783797, 451.0534263116098, 513.352981027714, 507.9977370908578, 561.407595187931, 448.04783141195384, 462.6616181484429, 599.2089842140876, 411.1823923193052, 612.0201826861551, 614.9429851210173, 477.8749758365183, 449.862664746924, 472.62817737272735, 325.7458749350533, 393.3918103517351, 527.3068097347931, 476.83506924059276, 520.7668332813181, 725.0779518744705, 574.786083046922, 419.741181122687, 486.7697566656827, 531.7990003138748, 502.6491105145193, 585.170904732075, 427.16745604789804, 436.6130822087368, 437.8712075541913, 516.0053174419614, 505.72905145965314, 582.8079001055013, 510.0970983858696, 545.9094885007462, 499.80040879746963, 440.6353645971589, 525.0776193416839, 531.915423142074, 488.3884170133743, 225.18127667728885, 539.2641668492371, 724.3165879358285, 511.8635944485153, 568.2389630810204, 535.3016598232573, 342.1790313703398, 516.2997737860085, 284.96417579325146, 546.5144819950721, 620.480351229144, 491.7987088455833, 464.41357881705034, 594.8293097163632, 525.726169903092, 618.6185431386114, 475.3178281659762, 483.7593940637112, 311.6202155110833, 543.4049516393288, 396.0648303550725, 527.9863662627264, 436.31320929873846, 645.9315689892062, 550.843647126603, 664.6416107698584, 307.7963993399113, 503.12400768600577, 532.3245384319907, 536.4451936089945, 430.1842836725767, 407.6618359869624, 560.925264930055, 567.5714287896244, 647.4509502536564, 534.1433189949545, 548.228629442212, 418.667559725517, 490.37293503809946, 620.0095919220911, 326.8458355489815, 476.78092248542197, 462.492249237122, 486.9492303104986, 562.4188542457235, 277.2334856078142, 517.6046299863319, 493.98324171778717, 499.8879930720775, 428.85116163437675, 596.5885173419779, 442.99938457164836, 452.2590220592752, 572.5413140520437, 383.75639327870323, 524.5562868314219, 457.55493602110425, 320.02086684758564, 474.8665086587977, 557.8105451728544, 521.4661458613058, 543.7036679083358, 529.50544947155, 414.5309531644439, 613.3235944890065, 417.240972121923, 518.0239908916664, 498.898910451509, 486.0664627970514], "policy_predator_policy_reward": [506.0239096084962, 624.1119975639483, 344.12684679827726, 455.25632177176357, 414.1986156899366, 128.89765396739475, 289.10222783192154, 385.233253663681, 371.16776694573207, 281.35313517325375, 282.59683783837636, 468.96720037423796, 137.06009857578044, 216.12352738721245, 476.0210630325948, 552.1922932786862, 618.5603962616796, 522.1884553235728, 337.01577053651744, 286.05645621377835, 390.28995696796716, 521.0217545611775, 344.3878858443206, 224.64342674147028, 356.1300979796268, 332.22842590582576, 86.47431363095028, 45.56355923635174, 430.3312610480649, 453.8202648855017, 131.72838291922463, 128.53849415958956, 518.3912015708075, 574.0644172783583, 299.94722176969395, 234.40663620214974, 519.4316861342194, 430.26626509965297, 548.692164627546, 417.22056161723924, 413.5482721547775, 607.7832201121852, 401.3777691537238, 430.79783821307774, 341.5942272979556, 564.7453131123913, 407.7615329787806, 266.0182642248046, 163.39764386236203, 395.2477321230997, 436.969780538112, 581.166864270279, 172.67816940118507, 74.62804725916786, 344.79752300762703, 480.7650124565326, 364.09152810306614, 291.4437455000914, 415.9602451733086, 581.3084319410193, 475.90931924392424, 415.431347895921, 293.0874791796642, 367.72753593023765, 225.3307695581124, 326.97222870941226, 431.46776236007906, 335.1362661575097, 266.1829879630427, 13.647296421357288, 363.96423288464644, 267.6199305820237, 587.8856271274207, 446.1603170601683, 73.52647468997223, 76.26608886614807, 490.2236368943728, 509.54846000166907, 492.6024267201092, 596.394160116852, 548.554172194535, 326.5141413101915, 316.4459129386891, 227.05862670070007, 334.24467466529893, 373.0759588347839, 187.96955582376245, 315.6746992346619, 230.09101696584295, 303.5322140430031, 264.39234638501165, 421.9593578188377, 469.3980755166781, 490.5616056768059, 15.461227499748464, 258.6394944540807, 496.7382704459986, 349.29934065025384, 425.11411770366635, 253.88131333212777, 469.3858238021885, 503.40895714571235, 260.61212986007376, 326.2162031418469, 476.28282320171337, 598.3364687207811, 583.0997671166938, 356.37870008477825, 94.41587052358804, 445.72040394390217, 416.8211511454369, 146.53007559888087, 572.9813895859983, 135.35669026451103, 401.82198846256057, 392.4067036557751, 430.69857751632617, 411.5617422576592, 323.66063002487687, 284.9186489253024, 465.17072861159323, 220.20211591115088, 391.03691864521056, 557.0400379364347, 302.61309317385377, 522.0229965186905, 306.89674465760424, 388.76615164038964, 555.3475691510938, 333.0369473172834, 223.8027024591946, 189.7844941770439, 189.5501826449705, 283.71936070194477, 442.1363361007477, 282.94045334456365, 215.4896315516439, 345.17575609950643, 225.85933795242477, 140.98118377096128, 246.9866042680261, 369.2028509721572, 559.0181805866866, 411.1660864929156, 325.55163578143345, 238.906880824144, 448.2098444892754, 157.54150881756155, 411.27797290639876, 451.3667451566294, 521.3734550244988, 337.78591348676986, 363.8777550766435, 175.28307486397762, 256.746215805254, 441.41089455751177, 160.38724211984157, 158.33150842378197, 459.9745825331484, 464.1438773552369, 456.41234962587913, 406.02169668286683, 573.0456834492597, 462.9815512088323, 47.49978370828696, 489.10396932296305, 305.7626196308459, 444.98483538396914, 341.45341558987866, 379.08293358461583, 294.8014062661865, 402.1724135746102, 500.82333410266324, 237.35350480348978, 444.3549742936127, 357.48055961766397, 202.55679503806388, 370.10769182894103, 226.47046185369197, 253.06129539499324, 530.4665400681454, 173.37517626542697, 469.7661972208829, 376.46272556780906, 523.265636873318, 227.19337157243356, 462.89098575240183, 394.18394801268636, 298.86237235084616, 231.1810222030161, 320.13826344245194, 385.30332818669274, 311.43818552749906, 330.13549755978926, 408.3224963193851, 167.12319479196594, 583.8078992785873, 460.4525484933862, 342.50766948077074, 402.7853731879599]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8632480833390292, "mean_inference_ms": 2.610979448628385, "mean_action_processing_ms": 0.38189342077707494, "mean_env_wait_ms": 0.31561038130157115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004786014556884766, "StateBufferConnector_ms": 0.0032712221145629883, "ViewRequirementAgentConnector_ms": 0.11106622219085693}, "num_episodes": 23, "episode_return_max": 2036.6139081467993, "episode_return_min": 598.4101233220965, "episode_return_mean": 1672.2158471099108, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.59631719660234, "num_env_steps_trained_throughput_per_sec": 281.59631719660234, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 13631.569, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13631.514, "sample_time_ms": 1729.714, "learn_time_ms": 11881.798, "learn_throughput": 336.649, "synch_weights_time_ms": 17.389}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "8abce_00000", "date": "2024-08-16_11-32-04", "timestamp": 1723788124, "time_this_iter_s": 14.253538846969604, "time_total_s": 635.7920956611633, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 635.7920956611633, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 59.838095238095256, "ram_util_percent": 82.19047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.664154397447904, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.585750286162845, "policy_loss": -0.005884744268571022, "vf_loss": 9.590573069658229, "vf_explained_var": -0.05381157937503996, "kl": 0.010619649190099037, "entropy": 1.4114441790908732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5927207238617398, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.716725968053101, "policy_loss": -0.002146507473416114, "vf_loss": 9.718015597610878, "vf_explained_var": -0.008285069591784603, "kl": 0.004284408398802363, "entropy": 0.9384354645297641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 2036.6139081467993, "episode_reward_min": 598.4101233220965, "episode_reward_mean": 1698.8832005631912, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 129.71000000000015, "predator_policy": 13.647296421357288}, "policy_reward_max": {"prey_policy": 725.0779518744705, "predator_policy": 626.3790913941788}, "policy_reward_mean": {"prey_policy": 480.5854430421776, "predator_policy": 368.85615723941794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1783.5326279873716, 1957.2364415325032, 1961.2145030165077, 1765.7636917958694, 1848.127992325695, 1893.4023747956214, 1424.3980334706177, 1912.5134286921852, 1218.414714415883, 1474.2278448113004, 1685.1136580336363, 1834.7013920585246, 1837.9688160958833, 1860.6111621119612, 1362.0746649357068, 1765.475251690428, 885.201915973272, 1463.224855003888, 1708.7570475560965, 598.4101233220965, 2004.122344199706, 1891.777785970829, 1827.5179910922584, 1368.4018141385855, 1595.924629910605, 1470.3427152336492, 1329.1481715896743, 1862.2547692463347, 1963.7617033834752, 1295.4514400724017, 1855.4930376961374, 1740.8660333983216, 1995.9973559533605, 1679.6462939594562, 1997.1101340421446, 1658.6161524882598, 1544.278153442878, 1809.1960119001062, 1702.8653440201176, 1812.7974490978922, 1930.0803350205795, 1472.3598172068146, 1639.2493695188969, 2036.6139081467993, 1880.6426765791591, 1636.098669692622, 1945.3775589521347, 1127.1568903269012, 1736.850298131979, 1805.1793469748452, 1438.1460788447469, 1168.104471302645, 1783.1842884643997, 1926.396554742236, 1685.013996225032, 1699.6877246114236, 1658.024327637821, 1798.6291505056734, 1503.460405502085, 1894.9323264785758, 1291.156760653393, 1959.5670060063826, 1829.0635235903178, 2004.6143355751117, 1751.6261320745323, 1833.1194034519842, 1629.57684393811, 1643.8292473118686, 1677.4500106286966, 1851.2036184674978, 1367.5026024611523, 1473.402992038549, 1729.281395309929, 1741.4873294196152, 1706.7567157765006, 1839.1861566176144, 1324.930770060245, 1784.7182826633045, 1714.7828004671737, 1603.3002387648012, 1979.5254107855617, 1730.2584159172907, 1505.6067146228636, 1775.1210732822888, 1672.7560641148534, 1622.0112082163278, 1708.9056127798422, 1756.5107485924948, 1873.4218229303065, 1729.416276293278, 1951.1871191236476, 1818.8131598295456, 1956.7403346898764, 1595.8804049271919, 1975.7836384576065, 1895.1179164551902, 1861.1686487894026, 1713.6179603532125, 1846.214841229652, 1752.578454325258], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [352.38551644716176, 481.44916030633726, 428.76726291009135, 562.5564523776264, 525.6207107619537, 414.2622999875916, 447.7657220087606, 485.82236242030905, 344.19079531241835, 597.5976566029277, 604.0203807692237, 615.6021968228109, 389.4241582374045, 476.3284992477526, 510.2486486040794, 384.128135279715, 385.23464498270397, 585.873852772826, 138.5799675666745, 510.0853417804672, 492.37200852690495, 537.2063759035765, 402.4141304185485, 435.0185845256501, 484.9094753980734, 461.7186735579685, 636.7121943338494, 563.08395266821, 476.20678379299426, 333.5648828751873, 537.2508148991187, 461.62040827371993, 334.5428136933757, 270.8288178954961, 266.9189761012051, 564.7217154360136, 410.04264450343953, 264.6684588650691, 129.71000000000015, 318.9075597659765, 422.9844524622342, 581.365794841431, 401.79557098416296, 400.98562814970404, 584.7689702316785, 367.6807073558563, 507.620947129861, 317.2763273693356, 435.4632473357878, 453.140749074735, 546.1872448330406, 420.511215342184, 290.7195142516976, 504.8054263291341, 598.9230213321898, 576.9800437102947, 552.7485958783797, 451.0534263116098, 513.352981027714, 507.9977370908578, 561.407595187931, 448.04783141195384, 462.6616181484429, 599.2089842140876, 411.1823923193052, 612.0201826861551, 614.9429851210173, 477.8749758365183, 449.862664746924, 472.62817737272735, 325.7458749350533, 393.3918103517351, 527.3068097347931, 476.83506924059276, 520.7668332813181, 725.0779518744705, 574.786083046922, 419.741181122687, 486.7697566656827, 531.7990003138748, 502.6491105145193, 585.170904732075, 427.16745604789804, 436.6130822087368, 437.8712075541913, 516.0053174419614, 505.72905145965314, 582.8079001055013, 510.0970983858696, 545.9094885007462, 499.80040879746963, 440.6353645971589, 525.0776193416839, 531.915423142074, 488.3884170133743, 225.18127667728885, 539.2641668492371, 724.3165879358285, 511.8635944485153, 568.2389630810204, 535.3016598232573, 342.1790313703398, 516.2997737860085, 284.96417579325146, 546.5144819950721, 620.480351229144, 491.7987088455833, 464.41357881705034, 594.8293097163632, 525.726169903092, 618.6185431386114, 475.3178281659762, 483.7593940637112, 311.6202155110833, 543.4049516393288, 396.0648303550725, 527.9863662627264, 436.31320929873846, 645.9315689892062, 550.843647126603, 664.6416107698584, 307.7963993399113, 503.12400768600577, 532.3245384319907, 536.4451936089945, 430.1842836725767, 407.6618359869624, 560.925264930055, 567.5714287896244, 647.4509502536564, 534.1433189949545, 548.228629442212, 418.667559725517, 490.37293503809946, 620.0095919220911, 326.8458355489815, 476.78092248542197, 462.492249237122, 486.9492303104986, 562.4188542457235, 277.2334856078142, 517.6046299863319, 493.98324171778717, 499.8879930720775, 428.85116163437675, 596.5885173419779, 442.99938457164836, 452.2590220592752, 572.5413140520437, 383.75639327870323, 524.5562868314219, 457.55493602110425, 320.02086684758564, 474.8665086587977, 557.8105451728544, 521.4661458613058, 543.7036679083358, 529.50544947155, 414.5309531644439, 613.3235944890065, 417.240972121923, 518.0239908916664, 498.898910451509, 486.0664627970514, 560.6281974756333, 374.26808199921766, 526.4584700492958, 531.2416711012605, 502.4884409186943, 487.9332472982342, 536.8743313271034, 395.43792821614556, 498.1286539724101, 457.73824883366495, 444.17420040589695, 325.3434255469098, 368.7426268778419, 483.06799673286304, 497.9578694949451, 459.9934075492279, 516.4147668236633, 549.9676061998942, 407.3428335610594, 454.67338904648875, 515.4019159852222, 512.3685966738673, 373.49448909209326, 445.5577742002025, 561.0711261112466, 613.1959130939783, 399.82320365679783, 439.08237399656315, 488.13122598730297, 425.67988513592474, 556.6242358603993, 669.4479183793197, 505.7089266131733, 458.8899493952516, 606.2612335598373, 371.31272288072216], "policy_predator_policy_reward": [519.4316861342194, 430.26626509965297, 548.692164627546, 417.22056161723924, 413.5482721547775, 607.7832201121852, 401.3777691537238, 430.79783821307774, 341.5942272979556, 564.7453131123913, 407.7615329787806, 266.0182642248046, 163.39764386236203, 395.2477321230997, 436.969780538112, 581.166864270279, 172.67816940118507, 74.62804725916786, 344.79752300762703, 480.7650124565326, 364.09152810306614, 291.4437455000914, 415.9602451733086, 581.3084319410193, 475.90931924392424, 415.431347895921, 293.0874791796642, 367.72753593023765, 225.3307695581124, 326.97222870941226, 431.46776236007906, 335.1362661575097, 266.1829879630427, 13.647296421357288, 363.96423288464644, 267.6199305820237, 587.8856271274207, 446.1603170601683, 73.52647468997223, 76.26608886614807, 490.2236368943728, 509.54846000166907, 492.6024267201092, 596.394160116852, 548.554172194535, 326.5141413101915, 316.4459129386891, 227.05862670070007, 334.24467466529893, 373.0759588347839, 187.96955582376245, 315.6746992346619, 230.09101696584295, 303.5322140430031, 264.39234638501165, 421.9593578188377, 469.3980755166781, 490.5616056768059, 15.461227499748464, 258.6394944540807, 496.7382704459986, 349.29934065025384, 425.11411770366635, 253.88131333212777, 469.3858238021885, 503.40895714571235, 260.61212986007376, 326.2162031418469, 476.28282320171337, 598.3364687207811, 583.0997671166938, 356.37870008477825, 94.41587052358804, 445.72040394390217, 416.8211511454369, 146.53007559888087, 572.9813895859983, 135.35669026451103, 401.82198846256057, 392.4067036557751, 430.69857751632617, 411.5617422576592, 323.66063002487687, 284.9186489253024, 465.17072861159323, 220.20211591115088, 391.03691864521056, 557.0400379364347, 302.61309317385377, 522.0229965186905, 306.89674465760424, 388.76615164038964, 555.3475691510938, 333.0369473172834, 223.8027024591946, 189.7844941770439, 189.5501826449705, 283.71936070194477, 442.1363361007477, 282.94045334456365, 215.4896315516439, 345.17575609950643, 225.85933795242477, 140.98118377096128, 246.9866042680261, 369.2028509721572, 559.0181805866866, 411.1660864929156, 325.55163578143345, 238.906880824144, 448.2098444892754, 157.54150881756155, 411.27797290639876, 451.3667451566294, 521.3734550244988, 337.78591348676986, 363.8777550766435, 175.28307486397762, 256.746215805254, 441.41089455751177, 160.38724211984157, 158.33150842378197, 459.9745825331484, 464.1438773552369, 456.41234962587913, 406.02169668286683, 573.0456834492597, 462.9815512088323, 47.49978370828696, 489.10396932296305, 305.7626196308459, 444.98483538396914, 341.45341558987866, 379.08293358461583, 294.8014062661865, 402.1724135746102, 500.82333410266324, 237.35350480348978, 444.3549742936127, 357.48055961766397, 202.55679503806388, 370.10769182894103, 226.47046185369197, 253.06129539499324, 530.4665400681454, 173.37517626542697, 469.7661972208829, 376.46272556780906, 523.265636873318, 227.19337157243356, 462.89098575240183, 394.18394801268636, 298.86237235084616, 231.1810222030161, 320.13826344245194, 385.30332818669274, 311.43818552749906, 330.13549755978926, 408.3224963193851, 167.12319479196594, 583.8078992785873, 460.4525484933862, 342.50766948077074, 402.7853731879599, 270.18007303247117, 300.5303621155424, 370.5847641965408, 346.83616793519235, 346.16281683311286, 336.17155906481196, 367.79377407010446, 321.9051746029757, 213.40622959528716, 539.6324803784788, 455.8286430645066, 531.1644795751843, 395.2321079254219, 626.3790913941788, 246.48259316229885, 524.9824060868065, 435.48261346387596, 449.3221326362134, 376.50429855472805, 580.2926386672685, 438.40192180274005, 490.567900228048, 454.81012665985196, 322.01801497504306, 431.79885392897467, 369.71774532340834, 584.6541037633863, 471.55823503844084, 427.555276596431, 519.8022610697423, 127.28317287014013, 360.2626332433532, 397.5837345689725, 484.0322306522553, 504.25384434358557, 270.7506535411135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8602945134376759, "mean_inference_ms": 2.602963667384171, "mean_action_processing_ms": 0.38000234586868403, "mean_env_wait_ms": 0.3142872051361311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005213618278503418, "StateBufferConnector_ms": 0.0032966136932373047, "ViewRequirementAgentConnector_ms": 0.15533149242401123}, "num_episodes": 18, "episode_return_max": 2036.6139081467993, "episode_return_min": 598.4101233220965, "episode_return_mean": 1698.8832005631912, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.90806595861443, "num_env_steps_trained_throughput_per_sec": 302.90806595861443, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 13572.964, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13572.909, "sample_time_ms": 1734.771, "learn_time_ms": 11818.54, "learn_throughput": 338.451, "synch_weights_time_ms": 17.051}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "8abce_00000", "date": "2024-08-16_11-32-18", "timestamp": 1723788138, "time_this_iter_s": 13.215699911117554, "time_total_s": 649.0077955722809, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a439b940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 649.0077955722809, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 59.9, "ram_util_percent": 81.16842105263159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.650656024583433, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.647611719969088, "policy_loss": -0.004882197949059662, "vf_loss": 9.65075266146786, "vf_explained_var": -0.09990264022791827, "kl": 0.017412703176183642, "entropy": 1.407807180995033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6121603954879065, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.621191718086363, "policy_loss": -0.003499765278002809, "vf_loss": 9.624097025835956, "vf_explained_var": -0.03698234539183359, "kl": 0.0059449137022902394, "entropy": 0.9488933464206716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 2036.6139081467993, "episode_reward_min": 598.4101233220965, "episode_reward_mean": 1727.6608221103318, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 129.71000000000015, "predator_policy": 15.461227499748464}, "policy_reward_max": {"prey_policy": 725.0779518744705, "predator_policy": 626.3790913941788}, "policy_reward_mean": {"prey_policy": 488.8180243220224, "predator_policy": 375.01238673314367}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1708.7570475560965, 598.4101233220965, 2004.122344199706, 1891.777785970829, 1827.5179910922584, 1368.4018141385855, 1595.924629910605, 1470.3427152336492, 1329.1481715896743, 1862.2547692463347, 1963.7617033834752, 1295.4514400724017, 1855.4930376961374, 1740.8660333983216, 1995.9973559533605, 1679.6462939594562, 1997.1101340421446, 1658.6161524882598, 1544.278153442878, 1809.1960119001062, 1702.8653440201176, 1812.7974490978922, 1930.0803350205795, 1472.3598172068146, 1639.2493695188969, 2036.6139081467993, 1880.6426765791591, 1636.098669692622, 1945.3775589521347, 1127.1568903269012, 1736.850298131979, 1805.1793469748452, 1438.1460788447469, 1168.104471302645, 1783.1842884643997, 1926.396554742236, 1685.013996225032, 1699.6877246114236, 1658.024327637821, 1798.6291505056734, 1503.460405502085, 1894.9323264785758, 1291.156760653393, 1959.5670060063826, 1829.0635235903178, 2004.6143355751117, 1751.6261320745323, 1833.1194034519842, 1629.57684393811, 1643.8292473118686, 1677.4500106286966, 1851.2036184674978, 1367.5026024611523, 1473.402992038549, 1729.281395309929, 1741.4873294196152, 1706.7567157765006, 1839.1861566176144, 1324.930770060245, 1784.7182826633045, 1714.7828004671737, 1603.3002387648012, 1979.5254107855617, 1730.2584159172907, 1505.6067146228636, 1775.1210732822888, 1672.7560641148534, 1622.0112082163278, 1708.9056127798422, 1756.5107485924948, 1873.4218229303065, 1729.416276293278, 1951.1871191236476, 1818.8131598295456, 1956.7403346898764, 1595.8804049271919, 1975.7836384576065, 1895.1179164551902, 1861.1686487894026, 1713.6179603532125, 1846.214841229652, 1752.578454325258, 1765.6280048043684, 1840.659557258307, 1732.9446395341604, 1978.4602273577486, 1843.074367189798, 1799.1155001633808, 1541.2466272285271, 1758.5765757774395, 1797.6639349585491, 1971.8517815645448, 1772.7579741857683, 1915.593870821698, 2006.479562191935, 1904.8837758913078, 1731.2292547094294, 1703.0304903126719, 1894.4836098819926, 1853.2857696293609], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [410.04264450343953, 264.6684588650691, 129.71000000000015, 318.9075597659765, 422.9844524622342, 581.365794841431, 401.79557098416296, 400.98562814970404, 584.7689702316785, 367.6807073558563, 507.620947129861, 317.2763273693356, 435.4632473357878, 453.140749074735, 546.1872448330406, 420.511215342184, 290.7195142516976, 504.8054263291341, 598.9230213321898, 576.9800437102947, 552.7485958783797, 451.0534263116098, 513.352981027714, 507.9977370908578, 561.407595187931, 448.04783141195384, 462.6616181484429, 599.2089842140876, 411.1823923193052, 612.0201826861551, 614.9429851210173, 477.8749758365183, 449.862664746924, 472.62817737272735, 325.7458749350533, 393.3918103517351, 527.3068097347931, 476.83506924059276, 520.7668332813181, 725.0779518744705, 574.786083046922, 419.741181122687, 486.7697566656827, 531.7990003138748, 502.6491105145193, 585.170904732075, 427.16745604789804, 436.6130822087368, 437.8712075541913, 516.0053174419614, 505.72905145965314, 582.8079001055013, 510.0970983858696, 545.9094885007462, 499.80040879746963, 440.6353645971589, 525.0776193416839, 531.915423142074, 488.3884170133743, 225.18127667728885, 539.2641668492371, 724.3165879358285, 511.8635944485153, 568.2389630810204, 535.3016598232573, 342.1790313703398, 516.2997737860085, 284.96417579325146, 546.5144819950721, 620.480351229144, 491.7987088455833, 464.41357881705034, 594.8293097163632, 525.726169903092, 618.6185431386114, 475.3178281659762, 483.7593940637112, 311.6202155110833, 543.4049516393288, 396.0648303550725, 527.9863662627264, 436.31320929873846, 645.9315689892062, 550.843647126603, 664.6416107698584, 307.7963993399113, 503.12400768600577, 532.3245384319907, 536.4451936089945, 430.1842836725767, 407.6618359869624, 560.925264930055, 567.5714287896244, 647.4509502536564, 534.1433189949545, 548.228629442212, 418.667559725517, 490.37293503809946, 620.0095919220911, 326.8458355489815, 476.78092248542197, 462.492249237122, 486.9492303104986, 562.4188542457235, 277.2334856078142, 517.6046299863319, 493.98324171778717, 499.8879930720775, 428.85116163437675, 596.5885173419779, 442.99938457164836, 452.2590220592752, 572.5413140520437, 383.75639327870323, 524.5562868314219, 457.55493602110425, 320.02086684758564, 474.8665086587977, 557.8105451728544, 521.4661458613058, 543.7036679083358, 529.50544947155, 414.5309531644439, 613.3235944890065, 417.240972121923, 518.0239908916664, 498.898910451509, 486.0664627970514, 560.6281974756333, 374.26808199921766, 526.4584700492958, 531.2416711012605, 502.4884409186943, 487.9332472982342, 536.8743313271034, 395.43792821614556, 498.1286539724101, 457.73824883366495, 444.17420040589695, 325.3434255469098, 368.7426268778419, 483.06799673286304, 497.9578694949451, 459.9934075492279, 516.4147668236633, 549.9676061998942, 407.3428335610594, 454.67338904648875, 515.4019159852222, 512.3685966738673, 373.49448909209326, 445.5577742002025, 561.0711261112466, 613.1959130939783, 399.82320365679783, 439.08237399656315, 488.13122598730297, 425.67988513592474, 556.6242358603993, 669.4479183793197, 505.7089266131733, 458.8899493952516, 606.2612335598373, 371.31272288072216, 565.1356082531067, 534.759211268307, 493.7515501877441, 497.87943539417466, 463.35975810014776, 432.4345440808395, 400.49603394105077, 565.9367119022288, 543.5828489739928, 548.9978516298034, 554.5104863385, 587.1986012018414, 422.48890227803855, 541.2394399079832, 416.8634121166515, 602.5015174987115, 481.7315374966323, 578.830532124886, 512.5687059438312, 650.4846619568601, 410.3565836617681, 440.06958228562667, 451.41140029107464, 596.7379893544438, 472.34838033614716, 505.422472332742, 525.1586324091851, 521.1722864259483, 426.10021204492506, 503.9312913171464, 471.63626968942356, 529.197420813852, 554.675530933326, 389.9962439417489, 416.3901642552656, 536.1948187797339], "policy_predator_policy_reward": [587.8856271274207, 446.1603170601683, 73.52647468997223, 76.26608886614807, 490.2236368943728, 509.54846000166907, 492.6024267201092, 596.394160116852, 548.554172194535, 326.5141413101915, 316.4459129386891, 227.05862670070007, 334.24467466529893, 373.0759588347839, 187.96955582376245, 315.6746992346619, 230.09101696584295, 303.5322140430031, 264.39234638501165, 421.9593578188377, 469.3980755166781, 490.5616056768059, 15.461227499748464, 258.6394944540807, 496.7382704459986, 349.29934065025384, 425.11411770366635, 253.88131333212777, 469.3858238021885, 503.40895714571235, 260.61212986007376, 326.2162031418469, 476.28282320171337, 598.3364687207811, 583.0997671166938, 356.37870008477825, 94.41587052358804, 445.72040394390217, 416.8211511454369, 146.53007559888087, 572.9813895859983, 135.35669026451103, 401.82198846256057, 392.4067036557751, 430.69857751632617, 411.5617422576592, 323.66063002487687, 284.9186489253024, 465.17072861159323, 220.20211591115088, 391.03691864521056, 557.0400379364347, 302.61309317385377, 522.0229965186905, 306.89674465760424, 388.76615164038964, 555.3475691510938, 333.0369473172834, 223.8027024591946, 189.7844941770439, 189.5501826449705, 283.71936070194477, 442.1363361007477, 282.94045334456365, 215.4896315516439, 345.17575609950643, 225.85933795242477, 140.98118377096128, 246.9866042680261, 369.2028509721572, 559.0181805866866, 411.1660864929156, 325.55163578143345, 238.906880824144, 448.2098444892754, 157.54150881756155, 411.27797290639876, 451.3667451566294, 521.3734550244988, 337.78591348676986, 363.8777550766435, 175.28307486397762, 256.746215805254, 441.41089455751177, 160.38724211984157, 158.33150842378197, 459.9745825331484, 464.1438773552369, 456.41234962587913, 406.02169668286683, 573.0456834492597, 462.9815512088323, 47.49978370828696, 489.10396932296305, 305.7626196308459, 444.98483538396914, 341.45341558987866, 379.08293358461583, 294.8014062661865, 402.1724135746102, 500.82333410266324, 237.35350480348978, 444.3549742936127, 357.48055961766397, 202.55679503806388, 370.10769182894103, 226.47046185369197, 253.06129539499324, 530.4665400681454, 173.37517626542697, 469.7661972208829, 376.46272556780906, 523.265636873318, 227.19337157243356, 462.89098575240183, 394.18394801268636, 298.86237235084616, 231.1810222030161, 320.13826344245194, 385.30332818669274, 311.43818552749906, 330.13549755978926, 408.3224963193851, 167.12319479196594, 583.8078992785873, 460.4525484933862, 342.50766948077074, 402.7853731879599, 270.18007303247117, 300.5303621155424, 370.5847641965408, 346.83616793519235, 346.16281683311286, 336.17155906481196, 367.79377407010446, 321.9051746029757, 213.40622959528716, 539.6324803784788, 455.8286430645066, 531.1644795751843, 395.2321079254219, 626.3790913941788, 246.48259316229885, 524.9824060868065, 435.48261346387596, 449.3221326362134, 376.50429855472805, 580.2926386672685, 438.40192180274005, 490.567900228048, 454.81012665985196, 322.01801497504306, 431.79885392897467, 369.71774532340834, 584.6541037633863, 471.55823503844084, 427.555276596431, 519.8022610697423, 127.28317287014013, 360.2626332433532, 397.5837345689725, 484.0322306522553, 504.25384434358557, 270.7506535411135, 351.9985728700387, 313.73461241291733, 367.351294366078, 481.67727731031215, 474.56969052748724, 362.58064682568556, 500.14537676245726, 511.88210475200947, 379.4848379946176, 371.0088285913855, 350.70888044986367, 306.6975321731769, 56.55716219693569, 520.9611228455709, 323.7777723981096, 415.43387376396396, 340.9490114553565, 396.152853881675, 415.33752438532565, 393.4608892785298, 498.75764411215005, 423.57416412622274, 440.48728656656823, 426.9571946096082, 466.3650705698866, 562.3436389531596, 497.8364946220458, 360.7163624341276, 459.97609300861257, 341.2216583387452, 364.95688972713646, 337.23991008225994, 499.2958098620766, 450.51602514484097, 527.2728485596177, 373.42793803474365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8572340578689386, "mean_inference_ms": 2.5951605506436017, "mean_action_processing_ms": 0.3781328890257359, "mean_env_wait_ms": 0.3130137639398254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005647063255310059, "StateBufferConnector_ms": 0.003322601318359375, "ViewRequirementAgentConnector_ms": 0.1592552661895752}, "num_episodes": 18, "episode_return_max": 2036.6139081467993, "episode_return_min": 598.4101233220965, "episode_return_mean": 1727.6608221103318, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.9567703667069, "num_env_steps_trained_throughput_per_sec": 275.9567703667069, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 13633.866, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13633.81, "sample_time_ms": 1697.386, "learn_time_ms": 11917.064, "learn_throughput": 335.653, "synch_weights_time_ms": 16.844}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "8abce_00000", "date": "2024-08-16_11-32-32", "timestamp": 1723788152, "time_this_iter_s": 14.536693096160889, "time_total_s": 663.5444886684418, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a439ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 663.5444886684418, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 65.10999999999999, "ram_util_percent": 80.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7160610121236277, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.62260711811207, "policy_loss": -0.0009023901054182302, "vf_loss": 9.622412740111981, "vf_explained_var": -0.02238412575116233, "kl": 0.01096802654640852, "entropy": 1.3969783398840163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.014464145709598, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.407452688267622, "policy_loss": -0.006373843919145801, "vf_loss": 9.413029474429983, "vf_explained_var": -0.058990038008916945, "kl": 0.007970698901142848, "entropy": 0.9175119720754169, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 2036.6139081467993, "episode_reward_min": 1127.1568903269012, "episode_reward_mean": 1736.5011706437786, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 84.02419166021924, "predator_policy": 47.49978370828696}, "policy_reward_max": {"prey_policy": 746.7769798708842, "predator_policy": 626.3790913941788}, "policy_reward_mean": {"prey_policy": 499.83673865792997, "predator_policy": 368.4138466639592}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1930.0803350205795, 1472.3598172068146, 1639.2493695188969, 2036.6139081467993, 1880.6426765791591, 1636.098669692622, 1945.3775589521347, 1127.1568903269012, 1736.850298131979, 1805.1793469748452, 1438.1460788447469, 1168.104471302645, 1783.1842884643997, 1926.396554742236, 1685.013996225032, 1699.6877246114236, 1658.024327637821, 1798.6291505056734, 1503.460405502085, 1894.9323264785758, 1291.156760653393, 1959.5670060063826, 1829.0635235903178, 2004.6143355751117, 1751.6261320745323, 1833.1194034519842, 1629.57684393811, 1643.8292473118686, 1677.4500106286966, 1851.2036184674978, 1367.5026024611523, 1473.402992038549, 1729.281395309929, 1741.4873294196152, 1706.7567157765006, 1839.1861566176144, 1324.930770060245, 1784.7182826633045, 1714.7828004671737, 1603.3002387648012, 1979.5254107855617, 1730.2584159172907, 1505.6067146228636, 1775.1210732822888, 1672.7560641148534, 1622.0112082163278, 1708.9056127798422, 1756.5107485924948, 1873.4218229303065, 1729.416276293278, 1951.1871191236476, 1818.8131598295456, 1956.7403346898764, 1595.8804049271919, 1975.7836384576065, 1895.1179164551902, 1861.1686487894026, 1713.6179603532125, 1846.214841229652, 1752.578454325258, 1765.6280048043684, 1840.659557258307, 1732.9446395341604, 1978.4602273577486, 1843.074367189798, 1799.1155001633808, 1541.2466272285271, 1758.5765757774395, 1797.6639349585491, 1971.8517815645448, 1772.7579741857683, 1915.593870821698, 2006.479562191935, 1904.8837758913078, 1731.2292547094294, 1703.0304903126719, 1894.4836098819926, 1853.2857696293609, 1350.6142031972563, 1867.1318866486197, 1612.417299982932, 1856.3897829877733, 1807.931684327393, 1621.2362076018799, 1964.7198078279778, 1662.0775639219423, 1635.4087552528665, 1624.899002181917, 1658.1690253500765, 1854.5880110286187, 1762.199098140276, 1761.887342519736, 1824.421317653874, 1192.5134834811463, 1804.6050740279286, 1651.5856526199736, 1511.8753919077544, 1625.3103733103083, 1986.1136896852388, 1960.676701403506], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [502.6491105145193, 585.170904732075, 427.16745604789804, 436.6130822087368, 437.8712075541913, 516.0053174419614, 505.72905145965314, 582.8079001055013, 510.0970983858696, 545.9094885007462, 499.80040879746963, 440.6353645971589, 525.0776193416839, 531.915423142074, 488.3884170133743, 225.18127667728885, 539.2641668492371, 724.3165879358285, 511.8635944485153, 568.2389630810204, 535.3016598232573, 342.1790313703398, 516.2997737860085, 284.96417579325146, 546.5144819950721, 620.480351229144, 491.7987088455833, 464.41357881705034, 594.8293097163632, 525.726169903092, 618.6185431386114, 475.3178281659762, 483.7593940637112, 311.6202155110833, 543.4049516393288, 396.0648303550725, 527.9863662627264, 436.31320929873846, 645.9315689892062, 550.843647126603, 664.6416107698584, 307.7963993399113, 503.12400768600577, 532.3245384319907, 536.4451936089945, 430.1842836725767, 407.6618359869624, 560.925264930055, 567.5714287896244, 647.4509502536564, 534.1433189949545, 548.228629442212, 418.667559725517, 490.37293503809946, 620.0095919220911, 326.8458355489815, 476.78092248542197, 462.492249237122, 486.9492303104986, 562.4188542457235, 277.2334856078142, 517.6046299863319, 493.98324171778717, 499.8879930720775, 428.85116163437675, 596.5885173419779, 442.99938457164836, 452.2590220592752, 572.5413140520437, 383.75639327870323, 524.5562868314219, 457.55493602110425, 320.02086684758564, 474.8665086587977, 557.8105451728544, 521.4661458613058, 543.7036679083358, 529.50544947155, 414.5309531644439, 613.3235944890065, 417.240972121923, 518.0239908916664, 498.898910451509, 486.0664627970514, 560.6281974756333, 374.26808199921766, 526.4584700492958, 531.2416711012605, 502.4884409186943, 487.9332472982342, 536.8743313271034, 395.43792821614556, 498.1286539724101, 457.73824883366495, 444.17420040589695, 325.3434255469098, 368.7426268778419, 483.06799673286304, 497.9578694949451, 459.9934075492279, 516.4147668236633, 549.9676061998942, 407.3428335610594, 454.67338904648875, 515.4019159852222, 512.3685966738673, 373.49448909209326, 445.5577742002025, 561.0711261112466, 613.1959130939783, 399.82320365679783, 439.08237399656315, 488.13122598730297, 425.67988513592474, 556.6242358603993, 669.4479183793197, 505.7089266131733, 458.8899493952516, 606.2612335598373, 371.31272288072216, 565.1356082531067, 534.759211268307, 493.7515501877441, 497.87943539417466, 463.35975810014776, 432.4345440808395, 400.49603394105077, 565.9367119022288, 543.5828489739928, 548.9978516298034, 554.5104863385, 587.1986012018414, 422.48890227803855, 541.2394399079832, 416.8634121166515, 602.5015174987115, 481.7315374966323, 578.830532124886, 512.5687059438312, 650.4846619568601, 410.3565836617681, 440.06958228562667, 451.41140029107464, 596.7379893544438, 472.34838033614716, 505.422472332742, 525.1586324091851, 521.1722864259483, 426.10021204492506, 503.9312913171464, 471.63626968942356, 529.197420813852, 554.675530933326, 389.9962439417489, 416.3901642552656, 536.1948187797339, 453.0137692935068, 424.3197069120333, 547.8427548582081, 551.9731644941538, 571.214833230299, 658.4352770861765, 478.18912335441706, 417.43788039515886, 661.1856492019465, 523.1014311277416, 638.3759291811109, 436.3924140794199, 526.2843275894256, 471.71037432541056, 479.5308793999838, 609.6848481488869, 564.3426642764326, 443.908798528578, 499.6883844535723, 493.3603546440328, 575.0750326811792, 326.19578990667725, 450.5025829096499, 746.7769798708842, 611.5683832256308, 572.5555097105783, 563.1747755498303, 535.4732404879031, 488.32785323929795, 517.9678282250975, 84.02419166021924, 658.7250142685659, 583.0860977540523, 584.8709615414865, 546.459397622495, 516.7843314655372, 441.613245643509, 571.8095125080415, 592.4882104358799, 467.69487440068303, 480.96255339942184, 434.85236053897, 539.2431427345806, 515.2664746094132], "policy_predator_policy_reward": [430.69857751632617, 411.5617422576592, 323.66063002487687, 284.9186489253024, 465.17072861159323, 220.20211591115088, 391.03691864521056, 557.0400379364347, 302.61309317385377, 522.0229965186905, 306.89674465760424, 388.76615164038964, 555.3475691510938, 333.0369473172834, 223.8027024591946, 189.7844941770439, 189.5501826449705, 283.71936070194477, 442.1363361007477, 282.94045334456365, 215.4896315516439, 345.17575609950643, 225.85933795242477, 140.98118377096128, 246.9866042680261, 369.2028509721572, 559.0181805866866, 411.1660864929156, 325.55163578143345, 238.906880824144, 448.2098444892754, 157.54150881756155, 411.27797290639876, 451.3667451566294, 521.3734550244988, 337.78591348676986, 363.8777550766435, 175.28307486397762, 256.746215805254, 441.41089455751177, 160.38724211984157, 158.33150842378197, 459.9745825331484, 464.1438773552369, 456.41234962587913, 406.02169668286683, 573.0456834492597, 462.9815512088323, 47.49978370828696, 489.10396932296305, 305.7626196308459, 444.98483538396914, 341.45341558987866, 379.08293358461583, 294.8014062661865, 402.1724135746102, 500.82333410266324, 237.35350480348978, 444.3549742936127, 357.48055961766397, 202.55679503806388, 370.10769182894103, 226.47046185369197, 253.06129539499324, 530.4665400681454, 173.37517626542697, 469.7661972208829, 376.46272556780906, 523.265636873318, 227.19337157243356, 462.89098575240183, 394.18394801268636, 298.86237235084616, 231.1810222030161, 320.13826344245194, 385.30332818669274, 311.43818552749906, 330.13549755978926, 408.3224963193851, 167.12319479196594, 583.8078992785873, 460.4525484933862, 342.50766948077074, 402.7853731879599, 270.18007303247117, 300.5303621155424, 370.5847641965408, 346.83616793519235, 346.16281683311286, 336.17155906481196, 367.79377407010446, 321.9051746029757, 213.40622959528716, 539.6324803784788, 455.8286430645066, 531.1644795751843, 395.2321079254219, 626.3790913941788, 246.48259316229885, 524.9824060868065, 435.48261346387596, 449.3221326362134, 376.50429855472805, 580.2926386672685, 438.40192180274005, 490.567900228048, 454.81012665985196, 322.01801497504306, 431.79885392897467, 369.71774532340834, 584.6541037633863, 471.55823503844084, 427.555276596431, 519.8022610697423, 127.28317287014013, 360.2626332433532, 397.5837345689725, 484.0322306522553, 504.25384434358557, 270.7506535411135, 351.9985728700387, 313.73461241291733, 367.351294366078, 481.67727731031215, 474.56969052748724, 362.58064682568556, 500.14537676245726, 511.88210475200947, 379.4848379946176, 371.0088285913855, 350.70888044986367, 306.6975321731769, 56.55716219693569, 520.9611228455709, 323.7777723981096, 415.43387376396396, 340.9490114553565, 396.152853881675, 415.33752438532565, 393.4608892785298, 498.75764411215005, 423.57416412622274, 440.48728656656823, 426.9571946096082, 466.3650705698866, 562.3436389531596, 497.8364946220458, 360.7163624341276, 459.97609300861257, 341.2216583387452, 364.95688972713646, 337.23991008225994, 499.2958098620766, 450.51602514484097, 527.2728485596177, 373.42793803474365, 269.2481304444605, 204.03259654725608, 420.298282084516, 347.0176852117431, 62.24260204430341, 320.52458762215394, 474.7023123773651, 486.0604668608321, 185.2019172584002, 438.4426867393045, 108.4673383954707, 438.000525945878, 557.1832444552552, 409.54186145788793, 329.446466943008, 243.41536943006344, 332.8921997192624, 294.26509272859204, 285.5847309310725, 346.2655321532409, 372.93321943478907, 383.96498332743334, 289.7077001151938, 367.6007481328934, 359.9754214091537, 218.09978379491315, 337.3438884820283, 325.8954379999733, 478.49312890516615, 339.6325072843111, 281.3044726958673, 168.45980485649454, 323.47695153445045, 313.17106319793965, 234.1199169061366, 354.2220066258045, 177.54448603245308, 320.9081477237498, 309.46401686908007, 255.66327160466687, 516.0528514810203, 554.2459242658249, 412.48915696124453, 493.67792709826875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8541499676372382, "mean_inference_ms": 2.5873948803509643, "mean_action_processing_ms": 0.3756314977210856, "mean_env_wait_ms": 0.31189565358316784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007079601287841797, "StateBufferConnector_ms": 0.009340167045593262, "ViewRequirementAgentConnector_ms": 0.18176257610321045}, "num_episodes": 22, "episode_return_max": 2036.6139081467993, "episode_return_min": 1127.1568903269012, "episode_return_mean": 1736.5011706437786, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.93800802878036, "num_env_steps_trained_throughput_per_sec": 296.93800802878036, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 13650.844, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13650.789, "sample_time_ms": 1710.46, "learn_time_ms": 11920.88, "learn_throughput": 335.546, "synch_weights_time_ms": 17.055}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "8abce_00000", "date": "2024-08-16_11-32-46", "timestamp": 1723788166, "time_this_iter_s": 13.534538984298706, "time_total_s": 677.0790276527405, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 677.0790276527405, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 62.5, "ram_util_percent": 81.53684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5728547399321562, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.69582266328196, "policy_loss": -0.001436605685631986, "vf_loss": 9.696542487573371, "vf_explained_var": -0.04820995359193711, "kl": 0.007167815723228616, "entropy": 1.3900716053745734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6471512198921234, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.65232541018693, "policy_loss": -0.008632741995505674, "vf_loss": 9.660047906542582, "vf_explained_var": -0.023176717978936653, "kl": 0.009102748169645472, "entropy": 0.93294228419425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 2048.672786117033, "episode_reward_min": 1192.5134834811463, "episode_reward_mean": 1770.3867179689069, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 84.02419166021924, "predator_policy": 47.49978370828696}, "policy_reward_max": {"prey_policy": 746.7769798708842, "predator_policy": 626.3790913941788}, "policy_reward_mean": {"prey_policy": 496.25401268651535, "predator_policy": 388.93934629793796}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2004.6143355751117, 1751.6261320745323, 1833.1194034519842, 1629.57684393811, 1643.8292473118686, 1677.4500106286966, 1851.2036184674978, 1367.5026024611523, 1473.402992038549, 1729.281395309929, 1741.4873294196152, 1706.7567157765006, 1839.1861566176144, 1324.930770060245, 1784.7182826633045, 1714.7828004671737, 1603.3002387648012, 1979.5254107855617, 1730.2584159172907, 1505.6067146228636, 1775.1210732822888, 1672.7560641148534, 1622.0112082163278, 1708.9056127798422, 1756.5107485924948, 1873.4218229303065, 1729.416276293278, 1951.1871191236476, 1818.8131598295456, 1956.7403346898764, 1595.8804049271919, 1975.7836384576065, 1895.1179164551902, 1861.1686487894026, 1713.6179603532125, 1846.214841229652, 1752.578454325258, 1765.6280048043684, 1840.659557258307, 1732.9446395341604, 1978.4602273577486, 1843.074367189798, 1799.1155001633808, 1541.2466272285271, 1758.5765757774395, 1797.6639349585491, 1971.8517815645448, 1772.7579741857683, 1915.593870821698, 2006.479562191935, 1904.8837758913078, 1731.2292547094294, 1703.0304903126719, 1894.4836098819926, 1853.2857696293609, 1350.6142031972563, 1867.1318866486197, 1612.417299982932, 1856.3897829877733, 1807.931684327393, 1621.2362076018799, 1964.7198078279778, 1662.0775639219423, 1635.4087552528665, 1624.899002181917, 1658.1690253500765, 1854.5880110286187, 1762.199098140276, 1761.887342519736, 1824.421317653874, 1192.5134834811463, 1804.6050740279286, 1651.5856526199736, 1511.8753919077544, 1625.3103733103083, 1986.1136896852388, 1960.676701403506, 1730.2793706638608, 1964.5030124325676, 1710.2899752244336, 1602.3092745891756, 1810.1749161385533, 1758.984621343567, 1915.7446506880692, 1848.1631708909254, 2048.672786117033, 1635.3740318677042, 1878.5284543097737, 1813.288960676351, 1874.002286332029, 1899.8082345155353, 1912.7544767701115, 1872.7633394685743, 1954.9848103254408, 1763.5515842983996, 1932.6121388236834, 1582.3422464894293, 1854.3197316178248, 1839.121133385716, 2030.9570106595559], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [407.6618359869624, 560.925264930055, 567.5714287896244, 647.4509502536564, 534.1433189949545, 548.228629442212, 418.667559725517, 490.37293503809946, 620.0095919220911, 326.8458355489815, 476.78092248542197, 462.492249237122, 486.9492303104986, 562.4188542457235, 277.2334856078142, 517.6046299863319, 493.98324171778717, 499.8879930720775, 428.85116163437675, 596.5885173419779, 442.99938457164836, 452.2590220592752, 572.5413140520437, 383.75639327870323, 524.5562868314219, 457.55493602110425, 320.02086684758564, 474.8665086587977, 557.8105451728544, 521.4661458613058, 543.7036679083358, 529.50544947155, 414.5309531644439, 613.3235944890065, 417.240972121923, 518.0239908916664, 498.898910451509, 486.0664627970514, 560.6281974756333, 374.26808199921766, 526.4584700492958, 531.2416711012605, 502.4884409186943, 487.9332472982342, 536.8743313271034, 395.43792821614556, 498.1286539724101, 457.73824883366495, 444.17420040589695, 325.3434255469098, 368.7426268778419, 483.06799673286304, 497.9578694949451, 459.9934075492279, 516.4147668236633, 549.9676061998942, 407.3428335610594, 454.67338904648875, 515.4019159852222, 512.3685966738673, 373.49448909209326, 445.5577742002025, 561.0711261112466, 613.1959130939783, 399.82320365679783, 439.08237399656315, 488.13122598730297, 425.67988513592474, 556.6242358603993, 669.4479183793197, 505.7089266131733, 458.8899493952516, 606.2612335598373, 371.31272288072216, 565.1356082531067, 534.759211268307, 493.7515501877441, 497.87943539417466, 463.35975810014776, 432.4345440808395, 400.49603394105077, 565.9367119022288, 543.5828489739928, 548.9978516298034, 554.5104863385, 587.1986012018414, 422.48890227803855, 541.2394399079832, 416.8634121166515, 602.5015174987115, 481.7315374966323, 578.830532124886, 512.5687059438312, 650.4846619568601, 410.3565836617681, 440.06958228562667, 451.41140029107464, 596.7379893544438, 472.34838033614716, 505.422472332742, 525.1586324091851, 521.1722864259483, 426.10021204492506, 503.9312913171464, 471.63626968942356, 529.197420813852, 554.675530933326, 389.9962439417489, 416.3901642552656, 536.1948187797339, 453.0137692935068, 424.3197069120333, 547.8427548582081, 551.9731644941538, 571.214833230299, 658.4352770861765, 478.18912335441706, 417.43788039515886, 661.1856492019465, 523.1014311277416, 638.3759291811109, 436.3924140794199, 526.2843275894256, 471.71037432541056, 479.5308793999838, 609.6848481488869, 564.3426642764326, 443.908798528578, 499.6883844535723, 493.3603546440328, 575.0750326811792, 326.19578990667725, 450.5025829096499, 746.7769798708842, 611.5683832256308, 572.5555097105783, 563.1747755498303, 535.4732404879031, 488.32785323929795, 517.9678282250975, 84.02419166021924, 658.7250142685659, 583.0860977540523, 584.8709615414865, 546.459397622495, 516.7843314655372, 441.613245643509, 571.8095125080415, 592.4882104358799, 467.69487440068303, 480.96255339942184, 434.85236053897, 539.2431427345806, 515.2664746094132, 429.3961270710207, 444.4328505137636, 510.720800858141, 486.1036391936027, 548.7933301919842, 505.5627259510094, 277.36759598177565, 486.2371647544515, 452.5129320486032, 387.651705122108, 501.6950327828159, 585.3777460535348, 459.09887114830906, 538.252156962247, 493.1056038511912, 448.43124332208765, 529.347256789932, 698.4454468118773, 525.7152185666093, 371.2764552444204, 515.2519219846012, 451.5827103627005, 532.3301444849375, 553.351470195913, 452.6933185217166, 545.2186157602168, 541.8540224691956, 484.15190131169953, 553.208371260974, 442.2829673749962, 416.4722987504047, 379.55664066680225, 538.383983788785, 458.46226428274633, 393.64399805348864, 454.43393069160595, 395.75677305708945, 443.32983434956475, 568.8601332750566, 468.2587040369879, 537.1672228812306, 509.3995251641227, 459.35547685166455, 521.6689253457896, 412.96015799518625, 565.8818577544882], "policy_predator_policy_reward": [573.0456834492597, 462.9815512088323, 47.49978370828696, 489.10396932296305, 305.7626196308459, 444.98483538396914, 341.45341558987866, 379.08293358461583, 294.8014062661865, 402.1724135746102, 500.82333410266324, 237.35350480348978, 444.3549742936127, 357.48055961766397, 202.55679503806388, 370.10769182894103, 226.47046185369197, 253.06129539499324, 530.4665400681454, 173.37517626542697, 469.7661972208829, 376.46272556780906, 523.265636873318, 227.19337157243356, 462.89098575240183, 394.18394801268636, 298.86237235084616, 231.1810222030161, 320.13826344245194, 385.30332818669274, 311.43818552749906, 330.13549755978926, 408.3224963193851, 167.12319479196594, 583.8078992785873, 460.4525484933862, 342.50766948077074, 402.7853731879599, 270.18007303247117, 300.5303621155424, 370.5847641965408, 346.83616793519235, 346.16281683311286, 336.17155906481196, 367.79377407010446, 321.9051746029757, 213.40622959528716, 539.6324803784788, 455.8286430645066, 531.1644795751843, 395.2321079254219, 626.3790913941788, 246.48259316229885, 524.9824060868065, 435.48261346387596, 449.3221326362134, 376.50429855472805, 580.2926386672685, 438.40192180274005, 490.567900228048, 454.81012665985196, 322.01801497504306, 431.79885392897467, 369.71774532340834, 584.6541037633863, 471.55823503844084, 427.555276596431, 519.8022610697423, 127.28317287014013, 360.2626332433532, 397.5837345689725, 484.0322306522553, 504.25384434358557, 270.7506535411135, 351.9985728700387, 313.73461241291733, 367.351294366078, 481.67727731031215, 474.56969052748724, 362.58064682568556, 500.14537676245726, 511.88210475200947, 379.4848379946176, 371.0088285913855, 350.70888044986367, 306.6975321731769, 56.55716219693569, 520.9611228455709, 323.7777723981096, 415.43387376396396, 340.9490114553565, 396.152853881675, 415.33752438532565, 393.4608892785298, 498.75764411215005, 423.57416412622274, 440.48728656656823, 426.9571946096082, 466.3650705698866, 562.3436389531596, 497.8364946220458, 360.7163624341276, 459.97609300861257, 341.2216583387452, 364.95688972713646, 337.23991008225994, 499.2958098620766, 450.51602514484097, 527.2728485596177, 373.42793803474365, 269.2481304444605, 204.03259654725608, 420.298282084516, 347.0176852117431, 62.24260204430341, 320.52458762215394, 474.7023123773651, 486.0604668608321, 185.2019172584002, 438.4426867393045, 108.4673383954707, 438.000525945878, 557.1832444552552, 409.54186145788793, 329.446466943008, 243.41536943006344, 332.8921997192624, 294.26509272859204, 285.5847309310725, 346.2655321532409, 372.93321943478907, 383.96498332743334, 289.7077001151938, 367.6007481328934, 359.9754214091537, 218.09978379491315, 337.3438884820283, 325.8954379999733, 478.49312890516615, 339.6325072843111, 281.3044726958673, 168.45980485649454, 323.47695153445045, 313.17106319793965, 234.1199169061366, 354.2220066258045, 177.54448603245308, 320.9081477237498, 309.46401686908007, 255.66327160466687, 516.0528514810203, 554.2459242658249, 412.48915696124453, 493.67792709826875, 468.5201410285256, 387.93025205055295, 449.25617610226396, 518.4223962785594, 271.87282691144395, 384.06109216999545, 441.12156933491747, 397.58294451803386, 520.3714753814761, 449.6388035863628, 381.7721697692319, 290.1396727379828, 476.721550821516, 441.6720717559943, 372.1716271652629, 534.4546965523847, 426.3355658518558, 394.54451666336723, 387.31008323119937, 351.0722748254756, 521.357217651238, 390.33660431123633, 377.72485629110906, 349.8824897043906, 383.2710297883519, 492.81932226174433, 450.44971950548916, 423.3525912291501, 588.9511203140951, 328.31201782004507, 611.8532647784162, 464.8811352729517, 495.4065475750132, 462.73201467889646, 431.5633011556521, 483.9103543976546, 571.1464208364662, 522.3791105805625, 230.2960076266267, 314.92740155075836, 382.5414267913328, 425.21155678113837, 417.8823966028313, 440.214334585431, 543.5875839371066, 508.5274109727742]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8495633515347123, "mean_inference_ms": 2.5759986378367024, "mean_action_processing_ms": 0.37331925064319554, "mean_env_wait_ms": 0.31003808487196527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007636308670043945, "StateBufferConnector_ms": 0.009346723556518555, "ViewRequirementAgentConnector_ms": 0.20367980003356934}, "num_episodes": 23, "episode_return_max": 2048.672786117033, "episode_return_min": 1192.5134834811463, "episode_return_mean": 1770.3867179689069, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.3118541707366, "num_env_steps_trained_throughput_per_sec": 296.3118541707366, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 13686.789, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13686.732, "sample_time_ms": 1714.093, "learn_time_ms": 11952.969, "learn_throughput": 334.645, "synch_weights_time_ms": 17.216}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "8abce_00000", "date": "2024-08-16_11-32-59", "timestamp": 1723788179, "time_this_iter_s": 13.5637788772583, "time_total_s": 690.6428065299988, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a439bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 690.6428065299988, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 63.89, "ram_util_percent": 81.86499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.701223486251932, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.576872342730326, "policy_loss": -0.003560423493267052, "vf_loss": 9.578917094639369, "vf_explained_var": -0.052075548651357176, "kl": 0.01515663247470584, "entropy": 1.3855299938923467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6369329696136807, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.702809092607447, "policy_loss": -0.004327756655772054, "vf_loss": 9.706498945327033, "vf_explained_var": -0.017656620059694563, "kl": 0.006378701470819858, "entropy": 0.9686130259087476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 2048.672786117033, "episode_reward_min": 1192.5134834811463, "episode_reward_mean": 1808.7119553344085, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 84.02419166021924, "predator_policy": 56.55716219693569}, "policy_reward_max": {"prey_policy": 791.7696716745229, "predator_policy": 626.3790913941788}, "policy_reward_mean": {"prey_policy": 503.3942356071093, "predator_policy": 400.9617420600948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1730.2584159172907, 1505.6067146228636, 1775.1210732822888, 1672.7560641148534, 1622.0112082163278, 1708.9056127798422, 1756.5107485924948, 1873.4218229303065, 1729.416276293278, 1951.1871191236476, 1818.8131598295456, 1956.7403346898764, 1595.8804049271919, 1975.7836384576065, 1895.1179164551902, 1861.1686487894026, 1713.6179603532125, 1846.214841229652, 1752.578454325258, 1765.6280048043684, 1840.659557258307, 1732.9446395341604, 1978.4602273577486, 1843.074367189798, 1799.1155001633808, 1541.2466272285271, 1758.5765757774395, 1797.6639349585491, 1971.8517815645448, 1772.7579741857683, 1915.593870821698, 2006.479562191935, 1904.8837758913078, 1731.2292547094294, 1703.0304903126719, 1894.4836098819926, 1853.2857696293609, 1350.6142031972563, 1867.1318866486197, 1612.417299982932, 1856.3897829877733, 1807.931684327393, 1621.2362076018799, 1964.7198078279778, 1662.0775639219423, 1635.4087552528665, 1624.899002181917, 1658.1690253500765, 1854.5880110286187, 1762.199098140276, 1761.887342519736, 1824.421317653874, 1192.5134834811463, 1804.6050740279286, 1651.5856526199736, 1511.8753919077544, 1625.3103733103083, 1986.1136896852388, 1960.676701403506, 1730.2793706638608, 1964.5030124325676, 1710.2899752244336, 1602.3092745891756, 1810.1749161385533, 1758.984621343567, 1915.7446506880692, 1848.1631708909254, 2048.672786117033, 1635.3740318677042, 1878.5284543097737, 1813.288960676351, 1874.002286332029, 1899.8082345155353, 1912.7544767701115, 1872.7633394685743, 1954.9848103254408, 1763.5515842983996, 1932.6121388236834, 1582.3422464894293, 1854.3197316178248, 1839.121133385716, 2030.9570106595559, 1924.117858194545, 1999.2699275860043, 1949.2373609616313, 1898.2678904428099, 1962.0514724179193, 1693.6738465859507, 1986.8436871363142, 1968.0545823409457, 1660.2531052742768, 1919.5086413241982, 1890.8180424044085, 1992.180681515724, 1903.776858504536, 1943.646019185439, 1937.90233876997, 1993.8477987250308, 1915.3318775290427, 1950.0360334636516], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [498.898910451509, 486.0664627970514, 560.6281974756333, 374.26808199921766, 526.4584700492958, 531.2416711012605, 502.4884409186943, 487.9332472982342, 536.8743313271034, 395.43792821614556, 498.1286539724101, 457.73824883366495, 444.17420040589695, 325.3434255469098, 368.7426268778419, 483.06799673286304, 497.9578694949451, 459.9934075492279, 516.4147668236633, 549.9676061998942, 407.3428335610594, 454.67338904648875, 515.4019159852222, 512.3685966738673, 373.49448909209326, 445.5577742002025, 561.0711261112466, 613.1959130939783, 399.82320365679783, 439.08237399656315, 488.13122598730297, 425.67988513592474, 556.6242358603993, 669.4479183793197, 505.7089266131733, 458.8899493952516, 606.2612335598373, 371.31272288072216, 565.1356082531067, 534.759211268307, 493.7515501877441, 497.87943539417466, 463.35975810014776, 432.4345440808395, 400.49603394105077, 565.9367119022288, 543.5828489739928, 548.9978516298034, 554.5104863385, 587.1986012018414, 422.48890227803855, 541.2394399079832, 416.8634121166515, 602.5015174987115, 481.7315374966323, 578.830532124886, 512.5687059438312, 650.4846619568601, 410.3565836617681, 440.06958228562667, 451.41140029107464, 596.7379893544438, 472.34838033614716, 505.422472332742, 525.1586324091851, 521.1722864259483, 426.10021204492506, 503.9312913171464, 471.63626968942356, 529.197420813852, 554.675530933326, 389.9962439417489, 416.3901642552656, 536.1948187797339, 453.0137692935068, 424.3197069120333, 547.8427548582081, 551.9731644941538, 571.214833230299, 658.4352770861765, 478.18912335441706, 417.43788039515886, 661.1856492019465, 523.1014311277416, 638.3759291811109, 436.3924140794199, 526.2843275894256, 471.71037432541056, 479.5308793999838, 609.6848481488869, 564.3426642764326, 443.908798528578, 499.6883844535723, 493.3603546440328, 575.0750326811792, 326.19578990667725, 450.5025829096499, 746.7769798708842, 611.5683832256308, 572.5555097105783, 563.1747755498303, 535.4732404879031, 488.32785323929795, 517.9678282250975, 84.02419166021924, 658.7250142685659, 583.0860977540523, 584.8709615414865, 546.459397622495, 516.7843314655372, 441.613245643509, 571.8095125080415, 592.4882104358799, 467.69487440068303, 480.96255339942184, 434.85236053897, 539.2431427345806, 515.2664746094132, 429.3961270710207, 444.4328505137636, 510.720800858141, 486.1036391936027, 548.7933301919842, 505.5627259510094, 277.36759598177565, 486.2371647544515, 452.5129320486032, 387.651705122108, 501.6950327828159, 585.3777460535348, 459.09887114830906, 538.252156962247, 493.1056038511912, 448.43124332208765, 529.347256789932, 698.4454468118773, 525.7152185666093, 371.2764552444204, 515.2519219846012, 451.5827103627005, 532.3301444849375, 553.351470195913, 452.6933185217166, 545.2186157602168, 541.8540224691956, 484.15190131169953, 553.208371260974, 442.2829673749962, 416.4722987504047, 379.55664066680225, 538.383983788785, 458.46226428274633, 393.64399805348864, 454.43393069160595, 395.75677305708945, 443.32983434956475, 568.8601332750566, 468.2587040369879, 537.1672228812306, 509.3995251641227, 459.35547685166455, 521.6689253457896, 412.96015799518625, 565.8818577544882, 497.9450054763483, 604.3668680074744, 456.82254539525184, 705.6004162507534, 542.2664045618449, 537.7548133000953, 455.6574788346239, 427.4337330965112, 663.5369087787469, 469.21058147916455, 447.14673963712573, 551.8811831794247, 791.7696716745229, 584.8569149493005, 504.0739521014219, 410.63933562751174, 353.8659044591035, 397.2281532002175, 565.2876164190909, 512.7327581704646, 583.0669164297801, 503.4739967867711, 436.59024497171333, 552.6990076002794, 404.9377231769882, 565.4393214923334, 556.896492626198, 595.25355667858, 478.8361419629224, 636.9466817247277, 576.1568780103073, 558.5045385256726, 554.6564116872881, 555.5073490491652, 507.1552077437473, 550.6747987262692], "policy_predator_policy_reward": [342.50766948077074, 402.7853731879599, 270.18007303247117, 300.5303621155424, 370.5847641965408, 346.83616793519235, 346.16281683311286, 336.17155906481196, 367.79377407010446, 321.9051746029757, 213.40622959528716, 539.6324803784788, 455.8286430645066, 531.1644795751843, 395.2321079254219, 626.3790913941788, 246.48259316229885, 524.9824060868065, 435.48261346387596, 449.3221326362134, 376.50429855472805, 580.2926386672685, 438.40192180274005, 490.567900228048, 454.81012665985196, 322.01801497504306, 431.79885392897467, 369.71774532340834, 584.6541037633863, 471.55823503844084, 427.555276596431, 519.8022610697423, 127.28317287014013, 360.2626332433532, 397.5837345689725, 484.0322306522553, 504.25384434358557, 270.7506535411135, 351.9985728700387, 313.73461241291733, 367.351294366078, 481.67727731031215, 474.56969052748724, 362.58064682568556, 500.14537676245726, 511.88210475200947, 379.4848379946176, 371.0088285913855, 350.70888044986367, 306.6975321731769, 56.55716219693569, 520.9611228455709, 323.7777723981096, 415.43387376396396, 340.9490114553565, 396.152853881675, 415.33752438532565, 393.4608892785298, 498.75764411215005, 423.57416412622274, 440.48728656656823, 426.9571946096082, 466.3650705698866, 562.3436389531596, 497.8364946220458, 360.7163624341276, 459.97609300861257, 341.2216583387452, 364.95688972713646, 337.23991008225994, 499.2958098620766, 450.51602514484097, 527.2728485596177, 373.42793803474365, 269.2481304444605, 204.03259654725608, 420.298282084516, 347.0176852117431, 62.24260204430341, 320.52458762215394, 474.7023123773651, 486.0604668608321, 185.2019172584002, 438.4426867393045, 108.4673383954707, 438.000525945878, 557.1832444552552, 409.54186145788793, 329.446466943008, 243.41536943006344, 332.8921997192624, 294.26509272859204, 285.5847309310725, 346.2655321532409, 372.93321943478907, 383.96498332743334, 289.7077001151938, 367.6007481328934, 359.9754214091537, 218.09978379491315, 337.3438884820283, 325.8954379999733, 478.49312890516615, 339.6325072843111, 281.3044726958673, 168.45980485649454, 323.47695153445045, 313.17106319793965, 234.1199169061366, 354.2220066258045, 177.54448603245308, 320.9081477237498, 309.46401686908007, 255.66327160466687, 516.0528514810203, 554.2459242658249, 412.48915696124453, 493.67792709826875, 468.5201410285256, 387.93025205055295, 449.25617610226396, 518.4223962785594, 271.87282691144395, 384.06109216999545, 441.12156933491747, 397.58294451803386, 520.3714753814761, 449.6388035863628, 381.7721697692319, 290.1396727379828, 476.721550821516, 441.6720717559943, 372.1716271652629, 534.4546965523847, 426.3355658518558, 394.54451666336723, 387.31008323119937, 351.0722748254756, 521.357217651238, 390.33660431123633, 377.72485629110906, 349.8824897043906, 383.2710297883519, 492.81932226174433, 450.44971950548916, 423.3525912291501, 588.9511203140951, 328.31201782004507, 611.8532647784162, 464.8811352729517, 495.4065475750132, 462.73201467889646, 431.5633011556521, 483.9103543976546, 571.1464208364662, 522.3791105805625, 230.2960076266267, 314.92740155075836, 382.5414267913328, 425.21155678113837, 417.8823966028313, 440.214334585431, 543.5875839371066, 508.5274109727742, 491.348058786251, 330.45792592446986, 457.08456093618844, 379.76240500381107, 366.93910812651285, 502.2770349731778, 526.6003032515334, 488.5763752601427, 419.41745519497425, 409.8865269650341, 321.0256179066579, 373.6203058627416, 314.1570600971431, 296.0600404153517, 505.67058585191035, 547.6707087601035, 546.6597231388309, 362.4993244761265, 391.18757891615166, 450.3006878184895, 252.07814892184618, 552.1989802660091, 516.1512110116958, 486.74021793203315, 358.59249528051714, 574.8073185546981, 502.79527775877887, 288.70069212188343, 366.1845877612499, 455.9349273210673, 444.7755560541778, 414.41082613487373, 346.58064637421796, 458.58747041837046, 528.0422529836356, 364.1637740100001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8491914731399632, "mean_inference_ms": 2.57622937446651, "mean_action_processing_ms": 0.3727260578778479, "mean_env_wait_ms": 0.3097983315960626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007390737533569336, "StateBufferConnector_ms": 0.009420633316040039, "ViewRequirementAgentConnector_ms": 0.2092519998550415}, "num_episodes": 18, "episode_return_max": 2048.672786117033, "episode_return_min": 1192.5134834811463, "episode_return_mean": 1808.7119553344085, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 100.43711763730784, "num_env_steps_trained_throughput_per_sec": 100.43711763730784, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 16332.729, "restore_workers_time_ms": 0.016, "training_step_time_ms": 16332.67, "sample_time_ms": 1745.452, "learn_time_ms": 14560.738, "learn_throughput": 274.711, "synch_weights_time_ms": 23.577}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "8abce_00000", "date": "2024-08-16_11-33-39", "timestamp": 1723788219, "time_this_iter_s": 39.98744201660156, "time_total_s": 730.6302485466003, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43a1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 730.6302485466003, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 63.0, "ram_util_percent": 82.08749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7089911232391992, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.60844580483815, "policy_loss": -0.0033892601466042893, "vf_loss": 9.610423655737014, "vf_explained_var": -0.04631862775989311, "kl": 0.014114062576710737, "entropy": 1.3699628033965983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5619646898022403, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.689882509039823, "policy_loss": -0.003425865848031309, "vf_loss": 9.692690062144447, "vf_explained_var": -0.028078951059825837, "kl": 0.006183128405772566, "entropy": 0.8993799106784599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 2103.6068757082057, "episode_reward_min": 792.488296008355, "episode_reward_mean": 1814.4111071661273, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 84.02419166021924, "predator_policy": 56.55716219693569}, "policy_reward_max": {"prey_policy": 791.7696716745229, "predator_policy": 611.8532647784162}, "policy_reward_mean": {"prey_policy": 504.72794033368916, "predator_policy": 402.4776132493745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1752.578454325258, 1765.6280048043684, 1840.659557258307, 1732.9446395341604, 1978.4602273577486, 1843.074367189798, 1799.1155001633808, 1541.2466272285271, 1758.5765757774395, 1797.6639349585491, 1971.8517815645448, 1772.7579741857683, 1915.593870821698, 2006.479562191935, 1904.8837758913078, 1731.2292547094294, 1703.0304903126719, 1894.4836098819926, 1853.2857696293609, 1350.6142031972563, 1867.1318866486197, 1612.417299982932, 1856.3897829877733, 1807.931684327393, 1621.2362076018799, 1964.7198078279778, 1662.0775639219423, 1635.4087552528665, 1624.899002181917, 1658.1690253500765, 1854.5880110286187, 1762.199098140276, 1761.887342519736, 1824.421317653874, 1192.5134834811463, 1804.6050740279286, 1651.5856526199736, 1511.8753919077544, 1625.3103733103083, 1986.1136896852388, 1960.676701403506, 1730.2793706638608, 1964.5030124325676, 1710.2899752244336, 1602.3092745891756, 1810.1749161385533, 1758.984621343567, 1915.7446506880692, 1848.1631708909254, 2048.672786117033, 1635.3740318677042, 1878.5284543097737, 1813.288960676351, 1874.002286332029, 1899.8082345155353, 1912.7544767701115, 1872.7633394685743, 1954.9848103254408, 1763.5515842983996, 1932.6121388236834, 1582.3422464894293, 1854.3197316178248, 1839.121133385716, 2030.9570106595559, 1924.117858194545, 1999.2699275860043, 1949.2373609616313, 1898.2678904428099, 1962.0514724179193, 1693.6738465859507, 1986.8436871363142, 1968.0545823409457, 1660.2531052742768, 1919.5086413241982, 1890.8180424044085, 1992.180681515724, 1903.776858504536, 1943.646019185439, 1937.90233876997, 1993.8477987250308, 1915.3318775290427, 1950.0360334636516, 1966.5834366751828, 1638.269753911487, 1623.180599300328, 2049.023908370465, 1783.559657915987, 2103.6068757082057, 1941.2171084113027, 2040.0028602951925, 1619.627569936198, 1811.2802749271893, 1956.2964170648227, 792.488296008355, 1807.7927321010734, 1686.0382226274792, 1873.9873936195922, 1813.5601613575157, 1953.737128215809, 2098.194747330577], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [606.2612335598373, 371.31272288072216, 565.1356082531067, 534.759211268307, 493.7515501877441, 497.87943539417466, 463.35975810014776, 432.4345440808395, 400.49603394105077, 565.9367119022288, 543.5828489739928, 548.9978516298034, 554.5104863385, 587.1986012018414, 422.48890227803855, 541.2394399079832, 416.8634121166515, 602.5015174987115, 481.7315374966323, 578.830532124886, 512.5687059438312, 650.4846619568601, 410.3565836617681, 440.06958228562667, 451.41140029107464, 596.7379893544438, 472.34838033614716, 505.422472332742, 525.1586324091851, 521.1722864259483, 426.10021204492506, 503.9312913171464, 471.63626968942356, 529.197420813852, 554.675530933326, 389.9962439417489, 416.3901642552656, 536.1948187797339, 453.0137692935068, 424.3197069120333, 547.8427548582081, 551.9731644941538, 571.214833230299, 658.4352770861765, 478.18912335441706, 417.43788039515886, 661.1856492019465, 523.1014311277416, 638.3759291811109, 436.3924140794199, 526.2843275894256, 471.71037432541056, 479.5308793999838, 609.6848481488869, 564.3426642764326, 443.908798528578, 499.6883844535723, 493.3603546440328, 575.0750326811792, 326.19578990667725, 450.5025829096499, 746.7769798708842, 611.5683832256308, 572.5555097105783, 563.1747755498303, 535.4732404879031, 488.32785323929795, 517.9678282250975, 84.02419166021924, 658.7250142685659, 583.0860977540523, 584.8709615414865, 546.459397622495, 516.7843314655372, 441.613245643509, 571.8095125080415, 592.4882104358799, 467.69487440068303, 480.96255339942184, 434.85236053897, 539.2431427345806, 515.2664746094132, 429.3961270710207, 444.4328505137636, 510.720800858141, 486.1036391936027, 548.7933301919842, 505.5627259510094, 277.36759598177565, 486.2371647544515, 452.5129320486032, 387.651705122108, 501.6950327828159, 585.3777460535348, 459.09887114830906, 538.252156962247, 493.1056038511912, 448.43124332208765, 529.347256789932, 698.4454468118773, 525.7152185666093, 371.2764552444204, 515.2519219846012, 451.5827103627005, 532.3301444849375, 553.351470195913, 452.6933185217166, 545.2186157602168, 541.8540224691956, 484.15190131169953, 553.208371260974, 442.2829673749962, 416.4722987504047, 379.55664066680225, 538.383983788785, 458.46226428274633, 393.64399805348864, 454.43393069160595, 395.75677305708945, 443.32983434956475, 568.8601332750566, 468.2587040369879, 537.1672228812306, 509.3995251641227, 459.35547685166455, 521.6689253457896, 412.96015799518625, 565.8818577544882, 497.9450054763483, 604.3668680074744, 456.82254539525184, 705.6004162507534, 542.2664045618449, 537.7548133000953, 455.6574788346239, 427.4337330965112, 663.5369087787469, 469.21058147916455, 447.14673963712573, 551.8811831794247, 791.7696716745229, 584.8569149493005, 504.0739521014219, 410.63933562751174, 353.8659044591035, 397.2281532002175, 565.2876164190909, 512.7327581704646, 583.0669164297801, 503.4739967867711, 436.59024497171333, 552.6990076002794, 404.9377231769882, 565.4393214923334, 556.896492626198, 595.25355667858, 478.8361419629224, 636.9466817247277, 576.1568780103073, 558.5045385256726, 554.6564116872881, 555.5073490491652, 507.1552077437473, 550.6747987262692, 544.8823639350188, 511.5990802863072, 425.15048894008027, 657.0558409842329, 466.5921437598854, 580.756795952354, 479.2061339299138, 475.0605299345846, 467.4001835905874, 548.3808127716729, 657.1922618283046, 395.72275273716696, 459.979323196378, 517.0980159151193, 563.7495236284801, 428.852472171279, 360.83806559434777, 445.1469363040558, 484.8123452277784, 536.5512126331571, 407.7629810701536, 484.7087120016988, 225.0541133800229, 220.6903871151271, 590.3847319274956, 536.7462398746052, 563.2140696310328, 485.47036985912456, 558.4476068171581, 486.58404498934567, 451.8733178302956, 413.3484288741584, 442.556080093033, 473.02514350991567, 657.5209634135216, 591.644772468924], "policy_predator_policy_reward": [504.25384434358557, 270.7506535411135, 351.9985728700387, 313.73461241291733, 367.351294366078, 481.67727731031215, 474.56969052748724, 362.58064682568556, 500.14537676245726, 511.88210475200947, 379.4848379946176, 371.0088285913855, 350.70888044986367, 306.6975321731769, 56.55716219693569, 520.9611228455709, 323.7777723981096, 415.43387376396396, 340.9490114553565, 396.152853881675, 415.33752438532565, 393.4608892785298, 498.75764411215005, 423.57416412622274, 440.48728656656823, 426.9571946096082, 466.3650705698866, 562.3436389531596, 497.8364946220458, 360.7163624341276, 459.97609300861257, 341.2216583387452, 364.95688972713646, 337.23991008225994, 499.2958098620766, 450.51602514484097, 527.2728485596177, 373.42793803474365, 269.2481304444605, 204.03259654725608, 420.298282084516, 347.0176852117431, 62.24260204430341, 320.52458762215394, 474.7023123773651, 486.0604668608321, 185.2019172584002, 438.4426867393045, 108.4673383954707, 438.000525945878, 557.1832444552552, 409.54186145788793, 329.446466943008, 243.41536943006344, 332.8921997192624, 294.26509272859204, 285.5847309310725, 346.2655321532409, 372.93321943478907, 383.96498332743334, 289.7077001151938, 367.6007481328934, 359.9754214091537, 218.09978379491315, 337.3438884820283, 325.8954379999733, 478.49312890516615, 339.6325072843111, 281.3044726958673, 168.45980485649454, 323.47695153445045, 313.17106319793965, 234.1199169061366, 354.2220066258045, 177.54448603245308, 320.9081477237498, 309.46401686908007, 255.66327160466687, 516.0528514810203, 554.2459242658249, 412.48915696124453, 493.67792709826875, 468.5201410285256, 387.93025205055295, 449.25617610226396, 518.4223962785594, 271.87282691144395, 384.06109216999545, 441.12156933491747, 397.58294451803386, 520.3714753814761, 449.6388035863628, 381.7721697692319, 290.1396727379828, 476.721550821516, 441.6720717559943, 372.1716271652629, 534.4546965523847, 426.3355658518558, 394.54451666336723, 387.31008323119937, 351.0722748254756, 521.357217651238, 390.33660431123633, 377.72485629110906, 349.8824897043906, 383.2710297883519, 492.81932226174433, 450.44971950548916, 423.3525912291501, 588.9511203140951, 328.31201782004507, 611.8532647784162, 464.8811352729517, 495.4065475750132, 462.73201467889646, 431.5633011556521, 483.9103543976546, 571.1464208364662, 522.3791105805625, 230.2960076266267, 314.92740155075836, 382.5414267913328, 425.21155678113837, 417.8823966028313, 440.214334585431, 543.5875839371066, 508.5274109727742, 491.348058786251, 330.45792592446986, 457.08456093618844, 379.76240500381107, 366.93910812651285, 502.2770349731778, 526.6003032515334, 488.5763752601427, 419.41745519497425, 409.8865269650341, 321.0256179066579, 373.6203058627416, 314.1570600971431, 296.0600404153517, 505.67058585191035, 547.6707087601035, 546.6597231388309, 362.4993244761265, 391.18757891615166, 450.3006878184895, 252.07814892184618, 552.1989802660091, 516.1512110116958, 486.74021793203315, 358.59249528051714, 574.8073185546981, 502.79527775877887, 288.70069212188343, 366.1845877612499, 455.9349273210673, 444.7755560541778, 414.41082613487373, 346.58064637421796, 458.58747041837046, 528.0422529836356, 364.1637740100001, 466.2064579497348, 443.8955345041237, 319.1348493839184, 236.9285746032544, 171.07635233487179, 404.7553072532182, 588.8572845020658, 505.8999600039017, 441.1532516385324, 326.6254099151939, 492.2530816096672, 558.438779533068, 542.0679213889462, 422.07184791085984, 461.57501198168404, 585.8258525137495, 516.1249964648196, 297.5175715729773, 464.4784515487272, 325.43826551752807, 534.9865381538245, 528.8381858391477, 154.971243699286, 191.77255181391888, 220.81604859263965, 459.8457117063319, 391.588010452201, 245.7657726851194, 467.1489815991927, 361.80676021389576, 377.3276549643195, 571.0107596887449, 578.9953826468696, 459.16052196599054, 454.4942719105175, 394.5347395376128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8601514131348397, "mean_inference_ms": 2.603466510300046, "mean_action_processing_ms": 0.37579939886889535, "mean_env_wait_ms": 0.3133343899779436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008745908737182617, "StateBufferConnector_ms": 0.01028287410736084, "ViewRequirementAgentConnector_ms": 0.2733825445175171}, "num_episodes": 18, "episode_return_max": 2103.6068757082057, "episode_return_min": 792.488296008355, "episode_return_mean": 1814.4111071661273, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 93.64475601085597, "num_env_steps_trained_throughput_per_sec": 93.64475601085597, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 19193.682, "restore_workers_time_ms": 0.016, "training_step_time_ms": 19193.617, "sample_time_ms": 2466.837, "learn_time_ms": 16699.284, "learn_throughput": 239.531, "synch_weights_time_ms": 25.026}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "8abce_00000", "date": "2024-08-16_11-34-22", "timestamp": 1723788262, "time_this_iter_s": 42.76931405067444, "time_total_s": 773.3995625972748, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a416bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 773.3995625972748, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 55.54262295081966, "ram_util_percent": 81.69508196721311}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4782567244358165, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.677047502426873, "policy_loss": -0.0058794914934508224, "vf_loss": 9.681590113059553, "vf_explained_var": -0.05199587572188605, "kl": 0.013369248499748578, "entropy": 1.3362943364829614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6760124775388885, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.57957493413693, "policy_loss": 6.150062289581727e-05, "vf_loss": 9.578801672294658, "vf_explained_var": -0.06844113951637631, "kl": 0.007117734432586153, "entropy": 0.8631462826299919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 2103.6068757082057, "episode_reward_min": 792.488296008355, "episode_reward_mean": 1821.6534563402593, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 84.02419166021924, "predator_policy": 62.24260204430341}, "policy_reward_max": {"prey_policy": 791.7696716745229, "predator_policy": 611.8532647784162}, "policy_reward_mean": {"prey_policy": 510.08265657884266, "predator_policy": 400.7440715912871}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1853.2857696293609, 1350.6142031972563, 1867.1318866486197, 1612.417299982932, 1856.3897829877733, 1807.931684327393, 1621.2362076018799, 1964.7198078279778, 1662.0775639219423, 1635.4087552528665, 1624.899002181917, 1658.1690253500765, 1854.5880110286187, 1762.199098140276, 1761.887342519736, 1824.421317653874, 1192.5134834811463, 1804.6050740279286, 1651.5856526199736, 1511.8753919077544, 1625.3103733103083, 1986.1136896852388, 1960.676701403506, 1730.2793706638608, 1964.5030124325676, 1710.2899752244336, 1602.3092745891756, 1810.1749161385533, 1758.984621343567, 1915.7446506880692, 1848.1631708909254, 2048.672786117033, 1635.3740318677042, 1878.5284543097737, 1813.288960676351, 1874.002286332029, 1899.8082345155353, 1912.7544767701115, 1872.7633394685743, 1954.9848103254408, 1763.5515842983996, 1932.6121388236834, 1582.3422464894293, 1854.3197316178248, 1839.121133385716, 2030.9570106595559, 1924.117858194545, 1999.2699275860043, 1949.2373609616313, 1898.2678904428099, 1962.0514724179193, 1693.6738465859507, 1986.8436871363142, 1968.0545823409457, 1660.2531052742768, 1919.5086413241982, 1890.8180424044085, 1992.180681515724, 1903.776858504536, 1943.646019185439, 1937.90233876997, 1993.8477987250308, 1915.3318775290427, 1950.0360334636516, 1966.5834366751828, 1638.269753911487, 1623.180599300328, 2049.023908370465, 1783.559657915987, 2103.6068757082057, 1941.2171084113027, 2040.0028602951925, 1619.627569936198, 1811.2802749271893, 1956.2964170648227, 792.488296008355, 1807.7927321010734, 1686.0382226274792, 1873.9873936195922, 1813.5601613575157, 1953.737128215809, 2098.194747330577, 1987.2807699207506, 1538.7110706205892, 1999.5331839899122, 1920.4064244705721, 1918.765719519862, 1888.8131515325902, 1950.358130112402, 1813.598690114561, 2059.9147194073216, 1508.6895796093695, 1932.5088686085896, 1861.7361689990857, 1566.192545252585, 1556.3191990193393, 2049.8289188878903, 1898.8324025549525, 2005.6500250774586, 1977.3535578722772], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [416.3901642552656, 536.1948187797339, 453.0137692935068, 424.3197069120333, 547.8427548582081, 551.9731644941538, 571.214833230299, 658.4352770861765, 478.18912335441706, 417.43788039515886, 661.1856492019465, 523.1014311277416, 638.3759291811109, 436.3924140794199, 526.2843275894256, 471.71037432541056, 479.5308793999838, 609.6848481488869, 564.3426642764326, 443.908798528578, 499.6883844535723, 493.3603546440328, 575.0750326811792, 326.19578990667725, 450.5025829096499, 746.7769798708842, 611.5683832256308, 572.5555097105783, 563.1747755498303, 535.4732404879031, 488.32785323929795, 517.9678282250975, 84.02419166021924, 658.7250142685659, 583.0860977540523, 584.8709615414865, 546.459397622495, 516.7843314655372, 441.613245643509, 571.8095125080415, 592.4882104358799, 467.69487440068303, 480.96255339942184, 434.85236053897, 539.2431427345806, 515.2664746094132, 429.3961270710207, 444.4328505137636, 510.720800858141, 486.1036391936027, 548.7933301919842, 505.5627259510094, 277.36759598177565, 486.2371647544515, 452.5129320486032, 387.651705122108, 501.6950327828159, 585.3777460535348, 459.09887114830906, 538.252156962247, 493.1056038511912, 448.43124332208765, 529.347256789932, 698.4454468118773, 525.7152185666093, 371.2764552444204, 515.2519219846012, 451.5827103627005, 532.3301444849375, 553.351470195913, 452.6933185217166, 545.2186157602168, 541.8540224691956, 484.15190131169953, 553.208371260974, 442.2829673749962, 416.4722987504047, 379.55664066680225, 538.383983788785, 458.46226428274633, 393.64399805348864, 454.43393069160595, 395.75677305708945, 443.32983434956475, 568.8601332750566, 468.2587040369879, 537.1672228812306, 509.3995251641227, 459.35547685166455, 521.6689253457896, 412.96015799518625, 565.8818577544882, 497.9450054763483, 604.3668680074744, 456.82254539525184, 705.6004162507534, 542.2664045618449, 537.7548133000953, 455.6574788346239, 427.4337330965112, 663.5369087787469, 469.21058147916455, 447.14673963712573, 551.8811831794247, 791.7696716745229, 584.8569149493005, 504.0739521014219, 410.63933562751174, 353.8659044591035, 397.2281532002175, 565.2876164190909, 512.7327581704646, 583.0669164297801, 503.4739967867711, 436.59024497171333, 552.6990076002794, 404.9377231769882, 565.4393214923334, 556.896492626198, 595.25355667858, 478.8361419629224, 636.9466817247277, 576.1568780103073, 558.5045385256726, 554.6564116872881, 555.5073490491652, 507.1552077437473, 550.6747987262692, 544.8823639350188, 511.5990802863072, 425.15048894008027, 657.0558409842329, 466.5921437598854, 580.756795952354, 479.2061339299138, 475.0605299345846, 467.4001835905874, 548.3808127716729, 657.1922618283046, 395.72275273716696, 459.979323196378, 517.0980159151193, 563.7495236284801, 428.852472171279, 360.83806559434777, 445.1469363040558, 484.8123452277784, 536.5512126331571, 407.7629810701536, 484.7087120016988, 225.0541133800229, 220.6903871151271, 590.3847319274956, 536.7462398746052, 563.2140696310328, 485.47036985912456, 558.4476068171581, 486.58404498934567, 451.8733178302956, 413.3484288741584, 442.556080093033, 473.02514350991567, 657.5209634135216, 591.644772468924, 566.4258710080555, 493.0510677348598, 477.8780595972945, 347.2027210732287, 530.9204904405261, 441.34881147622707, 662.541119106078, 592.5685045197749, 518.2204626873908, 512.1294438279463, 610.454129455022, 668.027141514277, 610.5348138664, 554.7760851586999, 668.0134398003173, 519.4160876920827, 582.9301331446017, 416.37606379562214, 539.0837993518961, 538.3747305772501, 554.5032906255187, 570.8055643709454, 619.6466802904956, 412.4163177413134, 499.7275309817433, 424.8799160780196, 467.5320733352276, 475.2340551883811, 676.9126819766473, 472.56774502745725, 692.6700015048191, 557.9276567750552, 434.1797702028966, 505.7296509711207, 505.320869192586, 521.1560718141734], "policy_predator_policy_reward": [527.2728485596177, 373.42793803474365, 269.2481304444605, 204.03259654725608, 420.298282084516, 347.0176852117431, 62.24260204430341, 320.52458762215394, 474.7023123773651, 486.0604668608321, 185.2019172584002, 438.4426867393045, 108.4673383954707, 438.000525945878, 557.1832444552552, 409.54186145788793, 329.446466943008, 243.41536943006344, 332.8921997192624, 294.26509272859204, 285.5847309310725, 346.2655321532409, 372.93321943478907, 383.96498332743334, 289.7077001151938, 367.6007481328934, 359.9754214091537, 218.09978379491315, 337.3438884820283, 325.8954379999733, 478.49312890516615, 339.6325072843111, 281.3044726958673, 168.45980485649454, 323.47695153445045, 313.17106319793965, 234.1199169061366, 354.2220066258045, 177.54448603245308, 320.9081477237498, 309.46401686908007, 255.66327160466687, 516.0528514810203, 554.2459242658249, 412.48915696124453, 493.67792709826875, 468.5201410285256, 387.93025205055295, 449.25617610226396, 518.4223962785594, 271.87282691144395, 384.06109216999545, 441.12156933491747, 397.58294451803386, 520.3714753814761, 449.6388035863628, 381.7721697692319, 290.1396727379828, 476.721550821516, 441.6720717559943, 372.1716271652629, 534.4546965523847, 426.3355658518558, 394.54451666336723, 387.31008323119937, 351.0722748254756, 521.357217651238, 390.33660431123633, 377.72485629110906, 349.8824897043906, 383.2710297883519, 492.81932226174433, 450.44971950548916, 423.3525912291501, 588.9511203140951, 328.31201782004507, 611.8532647784162, 464.8811352729517, 495.4065475750132, 462.73201467889646, 431.5633011556521, 483.9103543976546, 571.1464208364662, 522.3791105805625, 230.2960076266267, 314.92740155075836, 382.5414267913328, 425.21155678113837, 417.8823966028313, 440.214334585431, 543.5875839371066, 508.5274109727742, 491.348058786251, 330.45792592446986, 457.08456093618844, 379.76240500381107, 366.93910812651285, 502.2770349731778, 526.6003032515334, 488.5763752601427, 419.41745519497425, 409.8865269650341, 321.0256179066579, 373.6203058627416, 314.1570600971431, 296.0600404153517, 505.67058585191035, 547.6707087601035, 546.6597231388309, 362.4993244761265, 391.18757891615166, 450.3006878184895, 252.07814892184618, 552.1989802660091, 516.1512110116958, 486.74021793203315, 358.59249528051714, 574.8073185546981, 502.79527775877887, 288.70069212188343, 366.1845877612499, 455.9349273210673, 444.7755560541778, 414.41082613487373, 346.58064637421796, 458.58747041837046, 528.0422529836356, 364.1637740100001, 466.2064579497348, 443.8955345041237, 319.1348493839184, 236.9285746032544, 171.07635233487179, 404.7553072532182, 588.8572845020658, 505.8999600039017, 441.1532516385324, 326.6254099151939, 492.2530816096672, 558.438779533068, 542.0679213889462, 422.07184791085984, 461.57501198168404, 585.8258525137495, 516.1249964648196, 297.5175715729773, 464.4784515487272, 325.43826551752807, 534.9865381538245, 528.8381858391477, 154.971243699286, 191.77255181391888, 220.81604859263965, 459.8457117063319, 391.588010452201, 245.7657726851194, 467.1489815991927, 361.80676021389576, 377.3276549643195, 571.0107596887449, 578.9953826468696, 459.16052196599054, 454.4942719105175, 394.5347395376128, 444.2920251675414, 483.51180601029466, 360.87067689553186, 352.75961305453563, 479.21033486146115, 548.0535472116964, 396.4736215536267, 268.82317929109604, 413.9290508806109, 474.4867621239166, 219.28343243780367, 391.0484481254883, 392.7099632782322, 392.33726780906716, 379.5794039392652, 246.5897586828953, 515.1793233277459, 545.4291991393525, 342.12394292242766, 89.10710675779492, 404.83236635181845, 402.3676472603051, 426.2413027119254, 403.4318682553514, 337.98287975599914, 303.6022184368256, 343.37548735633726, 270.1775831393945, 410.3679286742417, 489.9805632095441, 372.6456600249385, 275.5890842501361, 569.2893852218969, 496.45121868154393, 459.5107086548063, 491.365908210715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.888575888153309, "mean_inference_ms": 2.674423721515027, "mean_action_processing_ms": 0.38575910002878544, "mean_env_wait_ms": 0.3230591788732305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016022086143493652, "StateBufferConnector_ms": 0.011227846145629883, "ViewRequirementAgentConnector_ms": 0.37158703804016113}, "num_episodes": 18, "episode_return_max": 2103.6068757082057, "episode_return_min": 792.488296008355, "episode_return_mean": 1821.6534563402593, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 94.52405113430105, "num_env_steps_trained_throughput_per_sec": 94.52405113430105, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 22086.101, "restore_workers_time_ms": 0.016, "training_step_time_ms": 22086.035, "sample_time_ms": 3487.481, "learn_time_ms": 18568.756, "learn_throughput": 215.416, "synch_weights_time_ms": 27.408}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "8abce_00000", "date": "2024-08-16_11-35-05", "timestamp": 1723788305, "time_this_iter_s": 42.361493825912476, "time_total_s": 815.7610564231873, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a416bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 815.7610564231873, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 53.97833333333334, "ram_util_percent": 81.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.601395682131172, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.613968048398457, "policy_loss": -0.0010095866342819241, "vf_loss": 9.614225396655854, "vf_explained_var": -0.09147141055455284, "kl": 0.007522408521286627, "entropy": 1.29275269426366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7136208045892614, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.511798692128014, "policy_loss": -0.0035927661509800052, "vf_loss": 9.514686599610345, "vf_explained_var": -0.06350927835419065, "kl": 0.007048627374686152, "entropy": 0.8023241234204126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 2103.6068757082057, "episode_reward_min": 792.488296008355, "episode_reward_mean": 1844.4172782954074, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 220.6903871151271, "predator_policy": 86.11856846739614}, "policy_reward_max": {"prey_policy": 791.7696716745229, "predator_policy": 611.8532647784162}, "policy_reward_mean": {"prey_policy": 516.9126906753185, "predator_policy": 405.29594847238536}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1960.676701403506, 1730.2793706638608, 1964.5030124325676, 1710.2899752244336, 1602.3092745891756, 1810.1749161385533, 1758.984621343567, 1915.7446506880692, 1848.1631708909254, 2048.672786117033, 1635.3740318677042, 1878.5284543097737, 1813.288960676351, 1874.002286332029, 1899.8082345155353, 1912.7544767701115, 1872.7633394685743, 1954.9848103254408, 1763.5515842983996, 1932.6121388236834, 1582.3422464894293, 1854.3197316178248, 1839.121133385716, 2030.9570106595559, 1924.117858194545, 1999.2699275860043, 1949.2373609616313, 1898.2678904428099, 1962.0514724179193, 1693.6738465859507, 1986.8436871363142, 1968.0545823409457, 1660.2531052742768, 1919.5086413241982, 1890.8180424044085, 1992.180681515724, 1903.776858504536, 1943.646019185439, 1937.90233876997, 1993.8477987250308, 1915.3318775290427, 1950.0360334636516, 1966.5834366751828, 1638.269753911487, 1623.180599300328, 2049.023908370465, 1783.559657915987, 2103.6068757082057, 1941.2171084113027, 2040.0028602951925, 1619.627569936198, 1811.2802749271893, 1956.2964170648227, 792.488296008355, 1807.7927321010734, 1686.0382226274792, 1873.9873936195922, 1813.5601613575157, 1953.737128215809, 2098.194747330577, 1987.2807699207506, 1538.7110706205892, 1999.5331839899122, 1920.4064244705721, 1918.765719519862, 1888.8131515325902, 1950.358130112402, 1813.598690114561, 2059.9147194073216, 1508.6895796093695, 1932.5088686085896, 1861.7361689990857, 1566.192545252585, 1556.3191990193393, 2049.8289188878903, 1898.8324025549525, 2005.6500250774586, 1977.3535578722772, 1843.9628099666456, 1520.1534761964388, 1987.6873327946444, 1912.314417354411, 1978.3458611046203, 1857.2841455221678, 1575.9899658904653, 1636.896890357989, 1709.9776708545967, 1998.5467753467033, 1713.203111984268, 1619.4203318714265, 1987.2673187344951, 1756.0414161328606, 1893.097667719989, 1888.8077675223717, 1963.9636296538886, 1851.4198454111925, 2003.2111495175861, 2102.108206690053, 1307.0714953197692, 1658.991332853079], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [539.2431427345806, 515.2664746094132, 429.3961270710207, 444.4328505137636, 510.720800858141, 486.1036391936027, 548.7933301919842, 505.5627259510094, 277.36759598177565, 486.2371647544515, 452.5129320486032, 387.651705122108, 501.6950327828159, 585.3777460535348, 459.09887114830906, 538.252156962247, 493.1056038511912, 448.43124332208765, 529.347256789932, 698.4454468118773, 525.7152185666093, 371.2764552444204, 515.2519219846012, 451.5827103627005, 532.3301444849375, 553.351470195913, 452.6933185217166, 545.2186157602168, 541.8540224691956, 484.15190131169953, 553.208371260974, 442.2829673749962, 416.4722987504047, 379.55664066680225, 538.383983788785, 458.46226428274633, 393.64399805348864, 454.43393069160595, 395.75677305708945, 443.32983434956475, 568.8601332750566, 468.2587040369879, 537.1672228812306, 509.3995251641227, 459.35547685166455, 521.6689253457896, 412.96015799518625, 565.8818577544882, 497.9450054763483, 604.3668680074744, 456.82254539525184, 705.6004162507534, 542.2664045618449, 537.7548133000953, 455.6574788346239, 427.4337330965112, 663.5369087787469, 469.21058147916455, 447.14673963712573, 551.8811831794247, 791.7696716745229, 584.8569149493005, 504.0739521014219, 410.63933562751174, 353.8659044591035, 397.2281532002175, 565.2876164190909, 512.7327581704646, 583.0669164297801, 503.4739967867711, 436.59024497171333, 552.6990076002794, 404.9377231769882, 565.4393214923334, 556.896492626198, 595.25355667858, 478.8361419629224, 636.9466817247277, 576.1568780103073, 558.5045385256726, 554.6564116872881, 555.5073490491652, 507.1552077437473, 550.6747987262692, 544.8823639350188, 511.5990802863072, 425.15048894008027, 657.0558409842329, 466.5921437598854, 580.756795952354, 479.2061339299138, 475.0605299345846, 467.4001835905874, 548.3808127716729, 657.1922618283046, 395.72275273716696, 459.979323196378, 517.0980159151193, 563.7495236284801, 428.852472171279, 360.83806559434777, 445.1469363040558, 484.8123452277784, 536.5512126331571, 407.7629810701536, 484.7087120016988, 225.0541133800229, 220.6903871151271, 590.3847319274956, 536.7462398746052, 563.2140696310328, 485.47036985912456, 558.4476068171581, 486.58404498934567, 451.8733178302956, 413.3484288741584, 442.556080093033, 473.02514350991567, 657.5209634135216, 591.644772468924, 566.4258710080555, 493.0510677348598, 477.8780595972945, 347.2027210732287, 530.9204904405261, 441.34881147622707, 662.541119106078, 592.5685045197749, 518.2204626873908, 512.1294438279463, 610.454129455022, 668.027141514277, 610.5348138664, 554.7760851586999, 668.0134398003173, 519.4160876920827, 582.9301331446017, 416.37606379562214, 539.0837993518961, 538.3747305772501, 554.5032906255187, 570.8055643709454, 619.6466802904956, 412.4163177413134, 499.7275309817433, 424.8799160780196, 467.5320733352276, 475.2340551883811, 676.9126819766473, 472.56774502745725, 692.6700015048191, 557.9276567750552, 434.1797702028966, 505.7296509711207, 505.320869192586, 521.1560718141734, 534.6762830386551, 573.9058108246196, 447.7524806055002, 525.1346893471969, 537.9067160946149, 689.6293112836786, 525.4778647669634, 576.2463545969321, 577.4481846443281, 409.9368745078021, 673.5244470231629, 636.5858263496708, 529.1129334138993, 320.2117370559915, 439.1803808514573, 573.6513824979406, 616.2483292196799, 619.0214231448797, 618.5487708026875, 546.4964478193318, 531.8360704866195, 430.3562995990207, 708.1518138387514, 386.5072148966672, 478.94882480613654, 506.0106240382709, 618.1052186892456, 613.1696886318974, 626.8341776748898, 587.4969575495305, 625.3766608844475, 549.3940776049578, 508.66212727214923, 551.4510273181112, 585.156934059604, 606.7450802967007, 551.1691255516043, 654.3504721440337, 622.0982368567288, 458.74882276122923, 385.57189130595515, 572.5693812750914, 450.49588593493706, 539.6702325906643], "policy_predator_policy_reward": [412.48915696124453, 493.67792709826875, 468.5201410285256, 387.93025205055295, 449.25617610226396, 518.4223962785594, 271.87282691144395, 384.06109216999545, 441.12156933491747, 397.58294451803386, 520.3714753814761, 449.6388035863628, 381.7721697692319, 290.1396727379828, 476.721550821516, 441.6720717559943, 372.1716271652629, 534.4546965523847, 426.3355658518558, 394.54451666336723, 387.31008323119937, 351.0722748254756, 521.357217651238, 390.33660431123633, 377.72485629110906, 349.8824897043906, 383.2710297883519, 492.81932226174433, 450.44971950548916, 423.3525912291501, 588.9511203140951, 328.31201782004507, 611.8532647784162, 464.8811352729517, 495.4065475750132, 462.73201467889646, 431.5633011556521, 483.9103543976546, 571.1464208364662, 522.3791105805625, 230.2960076266267, 314.92740155075836, 382.5414267913328, 425.21155678113837, 417.8823966028313, 440.214334585431, 543.5875839371066, 508.5274109727742, 491.348058786251, 330.45792592446986, 457.08456093618844, 379.76240500381107, 366.93910812651285, 502.2770349731778, 526.6003032515334, 488.5763752601427, 419.41745519497425, 409.8865269650341, 321.0256179066579, 373.6203058627416, 314.1570600971431, 296.0600404153517, 505.67058585191035, 547.6707087601035, 546.6597231388309, 362.4993244761265, 391.18757891615166, 450.3006878184895, 252.07814892184618, 552.1989802660091, 516.1512110116958, 486.74021793203315, 358.59249528051714, 574.8073185546981, 502.79527775877887, 288.70069212188343, 366.1845877612499, 455.9349273210673, 444.7755560541778, 414.41082613487373, 346.58064637421796, 458.58747041837046, 528.0422529836356, 364.1637740100001, 466.2064579497348, 443.8955345041237, 319.1348493839184, 236.9285746032544, 171.07635233487179, 404.7553072532182, 588.8572845020658, 505.8999600039017, 441.1532516385324, 326.6254099151939, 492.2530816096672, 558.438779533068, 542.0679213889462, 422.07184791085984, 461.57501198168404, 585.8258525137495, 516.1249964648196, 297.5175715729773, 464.4784515487272, 325.43826551752807, 534.9865381538245, 528.8381858391477, 154.971243699286, 191.77255181391888, 220.81604859263965, 459.8457117063319, 391.588010452201, 245.7657726851194, 467.1489815991927, 361.80676021389576, 377.3276549643195, 571.0107596887449, 578.9953826468696, 459.16052196599054, 454.4942719105175, 394.5347395376128, 444.2920251675414, 483.51180601029466, 360.87067689553186, 352.75961305453563, 479.21033486146115, 548.0535472116964, 396.4736215536267, 268.82317929109604, 413.9290508806109, 474.4867621239166, 219.28343243780367, 391.0484481254883, 392.7099632782322, 392.33726780906716, 379.5794039392652, 246.5897586828953, 515.1793233277459, 545.4291991393525, 342.12394292242766, 89.10710675779492, 404.83236635181845, 402.3676472603051, 426.2413027119254, 403.4318682553514, 337.98287975599914, 303.6022184368256, 343.37548735633726, 270.1775831393945, 410.3679286742417, 489.9805632095441, 372.6456600249385, 275.5890842501361, 569.2893852218969, 496.45121868154393, 459.5107086548063, 491.365908210715, 410.18589856959204, 325.19481753377744, 461.147737776346, 86.11856846739614, 324.71363561937903, 435.4376697969701, 433.60300010927745, 376.98719788123475, 533.198339411665, 457.7624625408268, 352.73510202339236, 194.43877012594234, 330.2204729005076, 396.44482252006577, 378.80570261844196, 245.2594243901484, 323.3965624854887, 151.31135600454868, 408.72379194235, 424.77776478233164, 415.8783378552217, 335.1324040434059, 229.0987145292895, 295.66258860671843, 560.4717786150201, 441.83609127506725, 185.31848796433118, 339.44802084738484, 361.9170117520741, 316.8495207434956, 248.67224736829797, 465.3647816646721, 447.7851095126067, 456.0653655510205, 255.60917878146847, 403.9086522734188, 395.21925461206575, 402.4722972098826, 562.3399325792012, 458.9212144928954, 98.1050407695095, 250.82518196921365, 262.54382408393934, 406.2813902435397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9405743920062821, "mean_inference_ms": 2.8083565058513056, "mean_action_processing_ms": 0.4058887427149662, "mean_env_wait_ms": 0.34121070721652896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0442347526550293, "StateBufferConnector_ms": 0.012610435485839844, "ViewRequirementAgentConnector_ms": 0.418018102645874}, "num_episodes": 22, "episode_return_max": 2103.6068757082057, "episode_return_min": 792.488296008355, "episode_return_mean": 1844.4172782954074, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 90.1704698700278, "num_env_steps_trained_throughput_per_sec": 90.1704698700278, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 25156.844, "restore_workers_time_ms": 0.017, "training_step_time_ms": 25156.753, "sample_time_ms": 4434.725, "learn_time_ms": 20686.867, "learn_throughput": 193.359, "synch_weights_time_ms": 32.499}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "8abce_00000", "date": "2024-08-16_11-35-49", "timestamp": 1723788349, "time_this_iter_s": 44.47577404975891, "time_total_s": 860.2368304729462, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 860.2368304729462, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 54.147619047619045, "ram_util_percent": 81.12380952380953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7410211548445718, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.540235185370873, "policy_loss": 0.0002213250330733086, "vf_loss": 9.539172526768276, "vf_explained_var": -0.027076328557635112, "kl": 0.0084130313562439, "entropy": 1.3113929563098483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.707358626776902, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.579645763881622, "policy_loss": -0.004950746506447633, "vf_loss": 9.583884802823345, "vf_explained_var": -0.018786637177543034, "kl": 0.007117088777488687, "entropy": 0.8060269578424081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 2103.6068757082057, "episode_reward_min": 792.488296008355, "episode_reward_mean": 1840.0704670561663, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 107.15386224505994, "predator_policy": 86.11856846739614}, "policy_reward_max": {"prey_policy": 791.7696716745229, "predator_policy": 627.192411265851}, "policy_reward_mean": {"prey_policy": 522.0895278148984, "predator_policy": 397.945705713185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2030.9570106595559, 1924.117858194545, 1999.2699275860043, 1949.2373609616313, 1898.2678904428099, 1962.0514724179193, 1693.6738465859507, 1986.8436871363142, 1968.0545823409457, 1660.2531052742768, 1919.5086413241982, 1890.8180424044085, 1992.180681515724, 1903.776858504536, 1943.646019185439, 1937.90233876997, 1993.8477987250308, 1915.3318775290427, 1950.0360334636516, 1966.5834366751828, 1638.269753911487, 1623.180599300328, 2049.023908370465, 1783.559657915987, 2103.6068757082057, 1941.2171084113027, 2040.0028602951925, 1619.627569936198, 1811.2802749271893, 1956.2964170648227, 792.488296008355, 1807.7927321010734, 1686.0382226274792, 1873.9873936195922, 1813.5601613575157, 1953.737128215809, 2098.194747330577, 1987.2807699207506, 1538.7110706205892, 1999.5331839899122, 1920.4064244705721, 1918.765719519862, 1888.8131515325902, 1950.358130112402, 1813.598690114561, 2059.9147194073216, 1508.6895796093695, 1932.5088686085896, 1861.7361689990857, 1566.192545252585, 1556.3191990193393, 2049.8289188878903, 1898.8324025549525, 2005.6500250774586, 1977.3535578722772, 1843.9628099666456, 1520.1534761964388, 1987.6873327946444, 1912.314417354411, 1978.3458611046203, 1857.2841455221678, 1575.9899658904653, 1636.896890357989, 1709.9776708545967, 1998.5467753467033, 1713.203111984268, 1619.4203318714265, 1987.2673187344951, 1756.0414161328606, 1893.097667719989, 1888.8077675223717, 1963.9636296538886, 1851.4198454111925, 2003.2111495175861, 2102.108206690053, 1307.0714953197692, 1658.991332853079, 1954.2804660803636, 1902.3401078895122, 1693.399630715844, 1987.8963684882383, 1931.1803029449186, 1842.2636827089573, 1950.0635182249787, 1861.082870028119, 1665.336889939782, 2029.2441547171848, 1772.5483235344773, 1557.3866289634116, 1993.9645459835695, 1606.217038269132, 2005.6273122669543, 1994.0696827547329, 1527.4282275782346, 1686.0726742538918, 1458.4704436977654, 1965.8879559806294, 1889.9398021497839, 1754.8878954148463, 1698.9802618628446], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [412.96015799518625, 565.8818577544882, 497.9450054763483, 604.3668680074744, 456.82254539525184, 705.6004162507534, 542.2664045618449, 537.7548133000953, 455.6574788346239, 427.4337330965112, 663.5369087787469, 469.21058147916455, 447.14673963712573, 551.8811831794247, 791.7696716745229, 584.8569149493005, 504.0739521014219, 410.63933562751174, 353.8659044591035, 397.2281532002175, 565.2876164190909, 512.7327581704646, 583.0669164297801, 503.4739967867711, 436.59024497171333, 552.6990076002794, 404.9377231769882, 565.4393214923334, 556.896492626198, 595.25355667858, 478.8361419629224, 636.9466817247277, 576.1568780103073, 558.5045385256726, 554.6564116872881, 555.5073490491652, 507.1552077437473, 550.6747987262692, 544.8823639350188, 511.5990802863072, 425.15048894008027, 657.0558409842329, 466.5921437598854, 580.756795952354, 479.2061339299138, 475.0605299345846, 467.4001835905874, 548.3808127716729, 657.1922618283046, 395.72275273716696, 459.979323196378, 517.0980159151193, 563.7495236284801, 428.852472171279, 360.83806559434777, 445.1469363040558, 484.8123452277784, 536.5512126331571, 407.7629810701536, 484.7087120016988, 225.0541133800229, 220.6903871151271, 590.3847319274956, 536.7462398746052, 563.2140696310328, 485.47036985912456, 558.4476068171581, 486.58404498934567, 451.8733178302956, 413.3484288741584, 442.556080093033, 473.02514350991567, 657.5209634135216, 591.644772468924, 566.4258710080555, 493.0510677348598, 477.8780595972945, 347.2027210732287, 530.9204904405261, 441.34881147622707, 662.541119106078, 592.5685045197749, 518.2204626873908, 512.1294438279463, 610.454129455022, 668.027141514277, 610.5348138664, 554.7760851586999, 668.0134398003173, 519.4160876920827, 582.9301331446017, 416.37606379562214, 539.0837993518961, 538.3747305772501, 554.5032906255187, 570.8055643709454, 619.6466802904956, 412.4163177413134, 499.7275309817433, 424.8799160780196, 467.5320733352276, 475.2340551883811, 676.9126819766473, 472.56774502745725, 692.6700015048191, 557.9276567750552, 434.1797702028966, 505.7296509711207, 505.320869192586, 521.1560718141734, 534.6762830386551, 573.9058108246196, 447.7524806055002, 525.1346893471969, 537.9067160946149, 689.6293112836786, 525.4778647669634, 576.2463545969321, 577.4481846443281, 409.9368745078021, 673.5244470231629, 636.5858263496708, 529.1129334138993, 320.2117370559915, 439.1803808514573, 573.6513824979406, 616.2483292196799, 619.0214231448797, 618.5487708026875, 546.4964478193318, 531.8360704866195, 430.3562995990207, 708.1518138387514, 386.5072148966672, 478.94882480613654, 506.0106240382709, 618.1052186892456, 613.1696886318974, 626.8341776748898, 587.4969575495305, 625.3766608844475, 549.3940776049578, 508.66212727214923, 551.4510273181112, 585.156934059604, 606.7450802967007, 551.1691255516043, 654.3504721440337, 622.0982368567288, 458.74882276122923, 385.57189130595515, 572.5693812750914, 450.49588593493706, 539.6702325906643, 676.9184902262765, 529.5296769523455, 408.5377321774488, 468.66437563033264, 462.33250192877864, 686.4874237938677, 559.4806883610974, 622.021524532382, 653.030293911466, 560.9341471587942, 477.69353469550924, 367.36049863378037, 466.80979700574017, 540.0135978057338, 590.6837356355564, 580.1718318357349, 479.80038571880846, 578.2364525270872, 571.1281914588943, 479.48903992882055, 495.21980231217685, 457.0273360603205, 515.6623056848442, 251.45492335798195, 519.7216607029862, 592.899313810502, 504.3873123500339, 263.77603464371157, 563.239826465314, 487.20277473203396, 546.3160290648656, 597.3312421017858, 500.41789686899085, 352.7326526245238, 483.696545871043, 572.2003884083598, 391.040325284146, 107.15386224505994, 705.6278446614617, 560.6552664491129, 692.9062869689224, 558.813286230521, 455.7162803991941, 356.8222493221906, 500.3008927037456, 594.4298441594624], "policy_predator_policy_reward": [543.5875839371066, 508.5274109727742, 491.348058786251, 330.45792592446986, 457.08456093618844, 379.76240500381107, 366.93910812651285, 502.2770349731778, 526.6003032515334, 488.5763752601427, 419.41745519497425, 409.8865269650341, 321.0256179066579, 373.6203058627416, 314.1570600971431, 296.0600404153517, 505.67058585191035, 547.6707087601035, 546.6597231388309, 362.4993244761265, 391.18757891615166, 450.3006878184895, 252.07814892184618, 552.1989802660091, 516.1512110116958, 486.74021793203315, 358.59249528051714, 574.8073185546981, 502.79527775877887, 288.70069212188343, 366.1845877612499, 455.9349273210673, 444.7755560541778, 414.41082613487373, 346.58064637421796, 458.58747041837046, 528.0422529836356, 364.1637740100001, 466.2064579497348, 443.8955345041237, 319.1348493839184, 236.9285746032544, 171.07635233487179, 404.7553072532182, 588.8572845020658, 505.8999600039017, 441.1532516385324, 326.6254099151939, 492.2530816096672, 558.438779533068, 542.0679213889462, 422.07184791085984, 461.57501198168404, 585.8258525137495, 516.1249964648196, 297.5175715729773, 464.4784515487272, 325.43826551752807, 534.9865381538245, 528.8381858391477, 154.971243699286, 191.77255181391888, 220.81604859263965, 459.8457117063319, 391.588010452201, 245.7657726851194, 467.1489815991927, 361.80676021389576, 377.3276549643195, 571.0107596887449, 578.9953826468696, 459.16052196599054, 454.4942719105175, 394.5347395376128, 444.2920251675414, 483.51180601029466, 360.87067689553186, 352.75961305453563, 479.21033486146115, 548.0535472116964, 396.4736215536267, 268.82317929109604, 413.9290508806109, 474.4867621239166, 219.28343243780367, 391.0484481254883, 392.7099632782322, 392.33726780906716, 379.5794039392652, 246.5897586828953, 515.1793233277459, 545.4291991393525, 342.12394292242766, 89.10710675779492, 404.83236635181845, 402.3676472603051, 426.2413027119254, 403.4318682553514, 337.98287975599914, 303.6022184368256, 343.37548735633726, 270.1775831393945, 410.3679286742417, 489.9805632095441, 372.6456600249385, 275.5890842501361, 569.2893852218969, 496.45121868154393, 459.5107086548063, 491.365908210715, 410.18589856959204, 325.19481753377744, 461.147737776346, 86.11856846739614, 324.71363561937903, 435.4376697969701, 433.60300010927745, 376.98719788123475, 533.198339411665, 457.7624625408268, 352.73510202339236, 194.43877012594234, 330.2204729005076, 396.44482252006577, 378.80570261844196, 245.2594243901484, 323.3965624854887, 151.31135600454868, 408.72379194235, 424.77776478233164, 415.8783378552217, 335.1324040434059, 229.0987145292895, 295.66258860671843, 560.4717786150201, 441.83609127506725, 185.31848796433118, 339.44802084738484, 361.9170117520741, 316.8495207434956, 248.67224736829797, 465.3647816646721, 447.7851095126067, 456.0653655510205, 255.60917878146847, 403.9086522734188, 395.21925461206575, 402.4722972098826, 562.3399325792012, 458.9212144928954, 98.1050407695095, 250.82518196921365, 262.54382408393934, 406.2813902435397, 459.0582278462086, 288.77407105553465, 397.9455888158809, 627.192411265851, 342.4494963973753, 202.1302085958211, 411.9448493169313, 394.4493062778263, 364.16317133297355, 353.05269054168656, 491.7755191037605, 505.43413027590674, 478.6502595653701, 464.58986384813477, 344.02086574354234, 346.2064368132844, 368.6631152434791, 238.63693645040667, 450.3229981708692, 528.3039251586022, 428.8197374299767, 391.48144773200244, 413.36734806073275, 376.9020518598531, 432.15322490213737, 449.1903465679467, 480.3427956109431, 357.71089566444425, 502.2330150732675, 452.9516959963385, 386.7593724242006, 463.66303916388046, 296.1696398082003, 378.1080382765201, 344.0156184790234, 286.1601214954665, 573.1814113967985, 387.0948447717628, 295.99211249169826, 403.61273237835644, 302.97503489183623, 335.24519405850316, 381.1760573107785, 561.173308382682, 185.74112644292478, 418.5083985567105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0102442858273173, "mean_inference_ms": 2.9916822088417008, "mean_action_processing_ms": 0.43273246513373365, "mean_env_wait_ms": 0.3662605304348333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04437088966369629, "StateBufferConnector_ms": 0.00805974006652832, "ViewRequirementAgentConnector_ms": 0.6074051856994629}, "num_episodes": 23, "episode_return_max": 2103.6068757082057, "episode_return_min": 792.488296008355, "episode_return_mean": 1840.0704670561663, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 93.46700248095792, "num_env_steps_trained_throughput_per_sec": 93.46700248095792, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 28088.966, "restore_workers_time_ms": 0.018, "training_step_time_ms": 28088.868, "sample_time_ms": 5256.19, "learn_time_ms": 22788.187, "learn_throughput": 175.53, "synch_weights_time_ms": 41.904}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "8abce_00000", "date": "2024-08-16_11-36-32", "timestamp": 1723788392, "time_this_iter_s": 42.94639205932617, "time_total_s": 903.1832225322723, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a439b0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 903.1832225322723, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 53.81147540983606, "ram_util_percent": 80.89180327868854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5155168354038209, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.697657785970698, "policy_loss": -0.004261341478512992, "vf_loss": 9.701174166341307, "vf_explained_var": -0.037986221862217735, "kl": 0.007449615688236864, "entropy": 1.3311621054770455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9088153171949285, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.39231673901674, "policy_loss": -0.0034081006623439924, "vf_loss": 9.395082559030524, "vf_explained_var": -0.012680962224486014, "kl": 0.006422927447950079, "entropy": 0.7832646167152142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 2103.6068757082057, "episode_reward_min": 792.488296008355, "episode_reward_mean": 1826.247240530773, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 107.15386224505994, "predator_policy": 86.11856846739614}, "policy_reward_max": {"prey_policy": 784.1192365009371, "predator_policy": 627.192411265851}, "policy_reward_mean": {"prey_policy": 526.7300879403788, "predator_policy": 386.3935323250079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1950.0360334636516, 1966.5834366751828, 1638.269753911487, 1623.180599300328, 2049.023908370465, 1783.559657915987, 2103.6068757082057, 1941.2171084113027, 2040.0028602951925, 1619.627569936198, 1811.2802749271893, 1956.2964170648227, 792.488296008355, 1807.7927321010734, 1686.0382226274792, 1873.9873936195922, 1813.5601613575157, 1953.737128215809, 2098.194747330577, 1987.2807699207506, 1538.7110706205892, 1999.5331839899122, 1920.4064244705721, 1918.765719519862, 1888.8131515325902, 1950.358130112402, 1813.598690114561, 2059.9147194073216, 1508.6895796093695, 1932.5088686085896, 1861.7361689990857, 1566.192545252585, 1556.3191990193393, 2049.8289188878903, 1898.8324025549525, 2005.6500250774586, 1977.3535578722772, 1843.9628099666456, 1520.1534761964388, 1987.6873327946444, 1912.314417354411, 1978.3458611046203, 1857.2841455221678, 1575.9899658904653, 1636.896890357989, 1709.9776708545967, 1998.5467753467033, 1713.203111984268, 1619.4203318714265, 1987.2673187344951, 1756.0414161328606, 1893.097667719989, 1888.8077675223717, 1963.9636296538886, 1851.4198454111925, 2003.2111495175861, 2102.108206690053, 1307.0714953197692, 1658.991332853079, 1954.2804660803636, 1902.3401078895122, 1693.399630715844, 1987.8963684882383, 1931.1803029449186, 1842.2636827089573, 1950.0635182249787, 1861.082870028119, 1665.336889939782, 2029.2441547171848, 1772.5483235344773, 1557.3866289634116, 1993.9645459835695, 1606.217038269132, 2005.6273122669543, 1994.0696827547329, 1527.4282275782346, 1686.0726742538918, 1458.4704436977654, 1965.8879559806294, 1889.9398021497839, 1754.8878954148463, 1698.9802618628446, 1988.1449997603506, 1975.8653613451133, 1937.7247057604998, 1891.1016643200005, 1594.4866002920387, 1550.3856931922464, 1947.2032631088082, 1924.2509542255232, 1804.7344576963906, 1761.6906020299746, 1733.6626835406837, 1850.7029129528607, 1927.8572859474705, 1835.1862444879757, 1952.6194967404729, 1670.6198957821528, 1814.0051932101487, 2027.1743326262408], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [507.1552077437473, 550.6747987262692, 544.8823639350188, 511.5990802863072, 425.15048894008027, 657.0558409842329, 466.5921437598854, 580.756795952354, 479.2061339299138, 475.0605299345846, 467.4001835905874, 548.3808127716729, 657.1922618283046, 395.72275273716696, 459.979323196378, 517.0980159151193, 563.7495236284801, 428.852472171279, 360.83806559434777, 445.1469363040558, 484.8123452277784, 536.5512126331571, 407.7629810701536, 484.7087120016988, 225.0541133800229, 220.6903871151271, 590.3847319274956, 536.7462398746052, 563.2140696310328, 485.47036985912456, 558.4476068171581, 486.58404498934567, 451.8733178302956, 413.3484288741584, 442.556080093033, 473.02514350991567, 657.5209634135216, 591.644772468924, 566.4258710080555, 493.0510677348598, 477.8780595972945, 347.2027210732287, 530.9204904405261, 441.34881147622707, 662.541119106078, 592.5685045197749, 518.2204626873908, 512.1294438279463, 610.454129455022, 668.027141514277, 610.5348138664, 554.7760851586999, 668.0134398003173, 519.4160876920827, 582.9301331446017, 416.37606379562214, 539.0837993518961, 538.3747305772501, 554.5032906255187, 570.8055643709454, 619.6466802904956, 412.4163177413134, 499.7275309817433, 424.8799160780196, 467.5320733352276, 475.2340551883811, 676.9126819766473, 472.56774502745725, 692.6700015048191, 557.9276567750552, 434.1797702028966, 505.7296509711207, 505.320869192586, 521.1560718141734, 534.6762830386551, 573.9058108246196, 447.7524806055002, 525.1346893471969, 537.9067160946149, 689.6293112836786, 525.4778647669634, 576.2463545969321, 577.4481846443281, 409.9368745078021, 673.5244470231629, 636.5858263496708, 529.1129334138993, 320.2117370559915, 439.1803808514573, 573.6513824979406, 616.2483292196799, 619.0214231448797, 618.5487708026875, 546.4964478193318, 531.8360704866195, 430.3562995990207, 708.1518138387514, 386.5072148966672, 478.94882480613654, 506.0106240382709, 618.1052186892456, 613.1696886318974, 626.8341776748898, 587.4969575495305, 625.3766608844475, 549.3940776049578, 508.66212727214923, 551.4510273181112, 585.156934059604, 606.7450802967007, 551.1691255516043, 654.3504721440337, 622.0982368567288, 458.74882276122923, 385.57189130595515, 572.5693812750914, 450.49588593493706, 539.6702325906643, 676.9184902262765, 529.5296769523455, 408.5377321774488, 468.66437563033264, 462.33250192877864, 686.4874237938677, 559.4806883610974, 622.021524532382, 653.030293911466, 560.9341471587942, 477.69353469550924, 367.36049863378037, 466.80979700574017, 540.0135978057338, 590.6837356355564, 580.1718318357349, 479.80038571880846, 578.2364525270872, 571.1281914588943, 479.48903992882055, 495.21980231217685, 457.0273360603205, 515.6623056848442, 251.45492335798195, 519.7216607029862, 592.899313810502, 504.3873123500339, 263.77603464371157, 563.239826465314, 487.20277473203396, 546.3160290648656, 597.3312421017858, 500.41789686899085, 352.7326526245238, 483.696545871043, 572.2003884083598, 391.040325284146, 107.15386224505994, 705.6278446614617, 560.6552664491129, 692.9062869689224, 558.813286230521, 455.7162803991941, 356.8222493221906, 500.3008927037456, 594.4298441594624, 525.6495724159304, 646.9443003582811, 485.0227404293346, 691.2145198098021, 503.64273278194423, 431.3099576427896, 517.778538302165, 475.57892579132823, 415.8501403048874, 459.8495280938753, 601.3751578217345, 490.8666288486055, 646.4062274433566, 506.370602790283, 626.89531242585, 576.2174843172679, 484.6901043812415, 601.7087026206804, 562.6847154799601, 591.7590485441766, 605.4201375042342, 491.0496361316929, 594.4354833128488, 500.54019149286404, 566.0938503830263, 600.6527339054112, 328.0121220147754, 496.70170845487905, 572.2921007003292, 533.9334395991602, 784.1192365009371, 510.53553893100684, 590.5282234047115, 564.1570833281352, 648.0613975322146, 717.6484623677463], "policy_predator_policy_reward": [528.0422529836356, 364.1637740100001, 466.2064579497348, 443.8955345041237, 319.1348493839184, 236.9285746032544, 171.07635233487179, 404.7553072532182, 588.8572845020658, 505.8999600039017, 441.1532516385324, 326.6254099151939, 492.2530816096672, 558.438779533068, 542.0679213889462, 422.07184791085984, 461.57501198168404, 585.8258525137495, 516.1249964648196, 297.5175715729773, 464.4784515487272, 325.43826551752807, 534.9865381538245, 528.8381858391477, 154.971243699286, 191.77255181391888, 220.81604859263965, 459.8457117063319, 391.588010452201, 245.7657726851194, 467.1489815991927, 361.80676021389576, 377.3276549643195, 571.0107596887449, 578.9953826468696, 459.16052196599054, 454.4942719105175, 394.5347395376128, 444.2920251675414, 483.51180601029466, 360.87067689553186, 352.75961305453563, 479.21033486146115, 548.0535472116964, 396.4736215536267, 268.82317929109604, 413.9290508806109, 474.4867621239166, 219.28343243780367, 391.0484481254883, 392.7099632782322, 392.33726780906716, 379.5794039392652, 246.5897586828953, 515.1793233277459, 545.4291991393525, 342.12394292242766, 89.10710675779492, 404.83236635181845, 402.3676472603051, 426.2413027119254, 403.4318682553514, 337.98287975599914, 303.6022184368256, 343.37548735633726, 270.1775831393945, 410.3679286742417, 489.9805632095441, 372.6456600249385, 275.5890842501361, 569.2893852218969, 496.45121868154393, 459.5107086548063, 491.365908210715, 410.18589856959204, 325.19481753377744, 461.147737776346, 86.11856846739614, 324.71363561937903, 435.4376697969701, 433.60300010927745, 376.98719788123475, 533.198339411665, 457.7624625408268, 352.73510202339236, 194.43877012594234, 330.2204729005076, 396.44482252006577, 378.80570261844196, 245.2594243901484, 323.3965624854887, 151.31135600454868, 408.72379194235, 424.77776478233164, 415.8783378552217, 335.1324040434059, 229.0987145292895, 295.66258860671843, 560.4717786150201, 441.83609127506725, 185.31848796433118, 339.44802084738484, 361.9170117520741, 316.8495207434956, 248.67224736829797, 465.3647816646721, 447.7851095126067, 456.0653655510205, 255.60917878146847, 403.9086522734188, 395.21925461206575, 402.4722972098826, 562.3399325792012, 458.9212144928954, 98.1050407695095, 250.82518196921365, 262.54382408393934, 406.2813902435397, 459.0582278462086, 288.77407105553465, 397.9455888158809, 627.192411265851, 342.4494963973753, 202.1302085958211, 411.9448493169313, 394.4493062778263, 364.16317133297355, 353.05269054168656, 491.7755191037605, 505.43413027590674, 478.6502595653701, 464.58986384813477, 344.02086574354234, 346.2064368132844, 368.6631152434791, 238.63693645040667, 450.3229981708692, 528.3039251586022, 428.8197374299767, 391.48144773200244, 413.36734806073275, 376.9020518598531, 432.15322490213737, 449.1903465679467, 480.3427956109431, 357.71089566444425, 502.2330150732675, 452.9516959963385, 386.7593724242006, 463.66303916388046, 296.1696398082003, 378.1080382765201, 344.0156184790234, 286.1601214954665, 573.1814113967985, 387.0948447717628, 295.99211249169826, 403.61273237835644, 302.97503489183623, 335.24519405850316, 381.1760573107785, 561.173308382682, 185.74112644292478, 418.5083985567105, 447.15898640076125, 368.3921405853784, 411.14430764874487, 388.4837934572317, 491.4705363879546, 511.30147894780936, 395.5914310517747, 502.1527691747328, 233.2652989981369, 485.52163289513965, 225.41743373092964, 232.72647279097708, 302.83282959859605, 491.5936032765726, 385.22693738913057, 335.9112200932755, 349.23134651041255, 369.1043041840551, 377.5535158353517, 229.69332217048594, 160.4355856961582, 476.7573242085949, 346.5389686761786, 409.18826947096966, 431.9757874983815, 329.1349141606503, 572.6064695655543, 437.8659444527688, 397.5613458762299, 448.8326105647532, 168.21163757755986, 207.75348277264888, 272.12164177500335, 387.1982447022985, 298.60244642176315, 362.86202630451703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0747840306557106, "mean_inference_ms": 3.1667177377027462, "mean_action_processing_ms": 0.4581985843188177, "mean_env_wait_ms": 0.38948251062280603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04549586772918701, "StateBufferConnector_ms": 0.008831381797790527, "ViewRequirementAgentConnector_ms": 0.7883709669113159}, "num_episodes": 18, "episode_return_max": 2103.6068757082057, "episode_return_min": 792.488296008355, "episode_return_mean": 1826.247240530773, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 97.10791273497648, "num_env_steps_trained_throughput_per_sec": 97.10791273497648, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 30787.622, "restore_workers_time_ms": 0.019, "training_step_time_ms": 30787.522, "sample_time_ms": 6030.206, "learn_time_ms": 24699.12, "learn_throughput": 161.949, "synch_weights_time_ms": 55.414}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "8abce_00000", "date": "2024-08-16_11-37-14", "timestamp": 1723788434, "time_this_iter_s": 41.34684491157532, "time_total_s": 944.5300674438477, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43f8280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 944.5300674438477, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 54.081355932203394, "ram_util_percent": 81.2322033898305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7249238939354659, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.636117220681811, "policy_loss": -0.0020619992866481424, "vf_loss": 9.637164316732417, "vf_explained_var": -0.06973570045970735, "kl": 0.010149191209361863, "entropy": 1.3261017953277265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.167657575405464, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.409347227389219, "policy_loss": -0.004395855423900737, "vf_loss": 9.413104538185886, "vf_explained_var": -0.04441523517250384, "kl": 0.006385511683490484, "entropy": 0.8246553807346909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 2102.108206690053, "episode_reward_min": 1307.0714953197692, "episode_reward_mean": 1823.50745687994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 107.15386224505994, "predator_policy": 86.11856846739614}, "policy_reward_max": {"prey_policy": 784.1192365009371, "predator_policy": 627.192411265851}, "policy_reward_mean": {"prey_policy": 535.9585671924958, "predator_policy": 375.7951612474743}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2098.194747330577, 1987.2807699207506, 1538.7110706205892, 1999.5331839899122, 1920.4064244705721, 1918.765719519862, 1888.8131515325902, 1950.358130112402, 1813.598690114561, 2059.9147194073216, 1508.6895796093695, 1932.5088686085896, 1861.7361689990857, 1566.192545252585, 1556.3191990193393, 2049.8289188878903, 1898.8324025549525, 2005.6500250774586, 1977.3535578722772, 1843.9628099666456, 1520.1534761964388, 1987.6873327946444, 1912.314417354411, 1978.3458611046203, 1857.2841455221678, 1575.9899658904653, 1636.896890357989, 1709.9776708545967, 1998.5467753467033, 1713.203111984268, 1619.4203318714265, 1987.2673187344951, 1756.0414161328606, 1893.097667719989, 1888.8077675223717, 1963.9636296538886, 1851.4198454111925, 2003.2111495175861, 2102.108206690053, 1307.0714953197692, 1658.991332853079, 1954.2804660803636, 1902.3401078895122, 1693.399630715844, 1987.8963684882383, 1931.1803029449186, 1842.2636827089573, 1950.0635182249787, 1861.082870028119, 1665.336889939782, 2029.2441547171848, 1772.5483235344773, 1557.3866289634116, 1993.9645459835695, 1606.217038269132, 2005.6273122669543, 1994.0696827547329, 1527.4282275782346, 1686.0726742538918, 1458.4704436977654, 1965.8879559806294, 1889.9398021497839, 1754.8878954148463, 1698.9802618628446, 1988.1449997603506, 1975.8653613451133, 1937.7247057604998, 1891.1016643200005, 1594.4866002920387, 1550.3856931922464, 1947.2032631088082, 1924.2509542255232, 1804.7344576963906, 1761.6906020299746, 1733.6626835406837, 1850.7029129528607, 1927.8572859474705, 1835.1862444879757, 1952.6194967404729, 1670.6198957821528, 1814.0051932101487, 2027.1743326262408, 1564.0883177279486, 1812.4804925152491, 2008.3530300180319, 1952.0686866360454, 1836.5800638264916, 1706.202023012874, 1723.3257004739187, 1892.5861042248932, 2018.038429970808, 1470.9820341545687, 1904.8480133030687, 1711.9622885874023, 1626.659457272852, 1648.642514288497, 1999.0294899099413, 1580.283547076313, 1802.1686833183094, 1878.0111885093309], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [657.5209634135216, 591.644772468924, 566.4258710080555, 493.0510677348598, 477.8780595972945, 347.2027210732287, 530.9204904405261, 441.34881147622707, 662.541119106078, 592.5685045197749, 518.2204626873908, 512.1294438279463, 610.454129455022, 668.027141514277, 610.5348138664, 554.7760851586999, 668.0134398003173, 519.4160876920827, 582.9301331446017, 416.37606379562214, 539.0837993518961, 538.3747305772501, 554.5032906255187, 570.8055643709454, 619.6466802904956, 412.4163177413134, 499.7275309817433, 424.8799160780196, 467.5320733352276, 475.2340551883811, 676.9126819766473, 472.56774502745725, 692.6700015048191, 557.9276567750552, 434.1797702028966, 505.7296509711207, 505.320869192586, 521.1560718141734, 534.6762830386551, 573.9058108246196, 447.7524806055002, 525.1346893471969, 537.9067160946149, 689.6293112836786, 525.4778647669634, 576.2463545969321, 577.4481846443281, 409.9368745078021, 673.5244470231629, 636.5858263496708, 529.1129334138993, 320.2117370559915, 439.1803808514573, 573.6513824979406, 616.2483292196799, 619.0214231448797, 618.5487708026875, 546.4964478193318, 531.8360704866195, 430.3562995990207, 708.1518138387514, 386.5072148966672, 478.94882480613654, 506.0106240382709, 618.1052186892456, 613.1696886318974, 626.8341776748898, 587.4969575495305, 625.3766608844475, 549.3940776049578, 508.66212727214923, 551.4510273181112, 585.156934059604, 606.7450802967007, 551.1691255516043, 654.3504721440337, 622.0982368567288, 458.74882276122923, 385.57189130595515, 572.5693812750914, 450.49588593493706, 539.6702325906643, 676.9184902262765, 529.5296769523455, 408.5377321774488, 468.66437563033264, 462.33250192877864, 686.4874237938677, 559.4806883610974, 622.021524532382, 653.030293911466, 560.9341471587942, 477.69353469550924, 367.36049863378037, 466.80979700574017, 540.0135978057338, 590.6837356355564, 580.1718318357349, 479.80038571880846, 578.2364525270872, 571.1281914588943, 479.48903992882055, 495.21980231217685, 457.0273360603205, 515.6623056848442, 251.45492335798195, 519.7216607029862, 592.899313810502, 504.3873123500339, 263.77603464371157, 563.239826465314, 487.20277473203396, 546.3160290648656, 597.3312421017858, 500.41789686899085, 352.7326526245238, 483.696545871043, 572.2003884083598, 391.040325284146, 107.15386224505994, 705.6278446614617, 560.6552664491129, 692.9062869689224, 558.813286230521, 455.7162803991941, 356.8222493221906, 500.3008927037456, 594.4298441594624, 525.6495724159304, 646.9443003582811, 485.0227404293346, 691.2145198098021, 503.64273278194423, 431.3099576427896, 517.778538302165, 475.57892579132823, 415.8501403048874, 459.8495280938753, 601.3751578217345, 490.8666288486055, 646.4062274433566, 506.370602790283, 626.89531242585, 576.2174843172679, 484.6901043812415, 601.7087026206804, 562.6847154799601, 591.7590485441766, 605.4201375042342, 491.0496361316929, 594.4354833128488, 500.54019149286404, 566.0938503830263, 600.6527339054112, 328.0121220147754, 496.70170845487905, 572.2921007003292, 533.9334395991602, 784.1192365009371, 510.53553893100684, 590.5282234047115, 564.1570833281352, 648.0613975322146, 717.6484623677463, 222.18591917043602, 486.41692128935875, 448.7662344703295, 472.3559205911055, 482.86515511102743, 701.2352356789042, 487.909908632107, 574.0213163605036, 494.4607288475708, 569.404320491542, 331.70718207156176, 500.75890697699583, 517.660890262722, 414.1242434813731, 680.9993329448582, 544.0203596778709, 538.6684969942356, 740.7237850778166, 560.5332741925005, 457.82908535796355, 571.594262101511, 680.7252570332826, 637.5941086543075, 569.9863034903237, 686.9569407305904, 453.4227730332556, 409.4985410413963, 484.60119278848856, 606.0316877267484, 595.6452755084703, 508.9113900618062, 442.1004332368056, 642.2865657414139, 570.3255490411482, 559.3975760846704, 603.6942932323166], "policy_predator_policy_reward": [454.4942719105175, 394.5347395376128, 444.2920251675414, 483.51180601029466, 360.87067689553186, 352.75961305453563, 479.21033486146115, 548.0535472116964, 396.4736215536267, 268.82317929109604, 413.9290508806109, 474.4867621239166, 219.28343243780367, 391.0484481254883, 392.7099632782322, 392.33726780906716, 379.5794039392652, 246.5897586828953, 515.1793233277459, 545.4291991393525, 342.12394292242766, 89.10710675779492, 404.83236635181845, 402.3676472603051, 426.2413027119254, 403.4318682553514, 337.98287975599914, 303.6022184368256, 343.37548735633726, 270.1775831393945, 410.3679286742417, 489.9805632095441, 372.6456600249385, 275.5890842501361, 569.2893852218969, 496.45121868154393, 459.5107086548063, 491.365908210715, 410.18589856959204, 325.19481753377744, 461.147737776346, 86.11856846739614, 324.71363561937903, 435.4376697969701, 433.60300010927745, 376.98719788123475, 533.198339411665, 457.7624625408268, 352.73510202339236, 194.43877012594234, 330.2204729005076, 396.44482252006577, 378.80570261844196, 245.2594243901484, 323.3965624854887, 151.31135600454868, 408.72379194235, 424.77776478233164, 415.8783378552217, 335.1324040434059, 229.0987145292895, 295.66258860671843, 560.4717786150201, 441.83609127506725, 185.31848796433118, 339.44802084738484, 361.9170117520741, 316.8495207434956, 248.67224736829797, 465.3647816646721, 447.7851095126067, 456.0653655510205, 255.60917878146847, 403.9086522734188, 395.21925461206575, 402.4722972098826, 562.3399325792012, 458.9212144928954, 98.1050407695095, 250.82518196921365, 262.54382408393934, 406.2813902435397, 459.0582278462086, 288.77407105553465, 397.9455888158809, 627.192411265851, 342.4494963973753, 202.1302085958211, 411.9448493169313, 394.4493062778263, 364.16317133297355, 353.05269054168656, 491.7755191037605, 505.43413027590674, 478.6502595653701, 464.58986384813477, 344.02086574354234, 346.2064368132844, 368.6631152434791, 238.63693645040667, 450.3229981708692, 528.3039251586022, 428.8197374299767, 391.48144773200244, 413.36734806073275, 376.9020518598531, 432.15322490213737, 449.1903465679467, 480.3427956109431, 357.71089566444425, 502.2330150732675, 452.9516959963385, 386.7593724242006, 463.66303916388046, 296.1696398082003, 378.1080382765201, 344.0156184790234, 286.1601214954665, 573.1814113967985, 387.0948447717628, 295.99211249169826, 403.61273237835644, 302.97503489183623, 335.24519405850316, 381.1760573107785, 561.173308382682, 185.74112644292478, 418.5083985567105, 447.15898640076125, 368.3921405853784, 411.14430764874487, 388.4837934572317, 491.4705363879546, 511.30147894780936, 395.5914310517747, 502.1527691747328, 233.2652989981369, 485.52163289513965, 225.41743373092964, 232.72647279097708, 302.83282959859605, 491.5936032765726, 385.22693738913057, 335.9112200932755, 349.23134651041255, 369.1043041840551, 377.5535158353517, 229.69332217048594, 160.4355856961582, 476.7573242085949, 346.5389686761786, 409.18826947096966, 431.9757874983815, 329.1349141606503, 572.6064695655543, 437.8659444527688, 397.5613458762299, 448.8326105647532, 168.21163757755986, 207.75348277264888, 272.12164177500335, 387.1982447022985, 298.60244642176315, 362.86202630451703, 343.98360393668673, 511.5018733314671, 446.3896951775896, 444.9686422762251, 388.06083545546795, 436.1918037726311, 518.1774301050056, 371.96003153843395, 474.00107422509456, 298.71394026228234, 356.876509481446, 516.8594244828687, 429.04404368139126, 362.49652304843477, 256.26261320760443, 411.3037983945586, 366.00282770451383, 372.6433201942407, 227.4866165954293, 225.1330580086765, 329.27218805897803, 323.256306109298, 276.60789503513706, 227.77398140763424, 241.32939502391307, 244.9503484850951, 391.78586989814477, 362.75691056046674, 487.85228877954654, 309.500237895177, 324.1652060001908, 305.10651777750974, 343.42971333458917, 246.1268552011592, 323.49767499301015, 391.4216441993331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1357363871607857, "mean_inference_ms": 3.336045592285267, "mean_action_processing_ms": 0.4834502499269492, "mean_env_wait_ms": 0.4120383473304149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04471468925476074, "StateBufferConnector_ms": 0.008853673934936523, "ViewRequirementAgentConnector_ms": 0.7699060440063477}, "num_episodes": 18, "episode_return_max": 2102.108206690053, "episode_return_min": 1307.0714953197692, "episode_return_mean": 1823.50745687994, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 94.34724868446554, "num_env_steps_trained_throughput_per_sec": 94.34724868446554, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 33706.748, "restore_workers_time_ms": 0.02, "training_step_time_ms": 33706.643, "sample_time_ms": 6681.682, "learn_time_ms": 26958.498, "learn_throughput": 148.376, "synch_weights_time_ms": 63.522}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "8abce_00000", "date": "2024-08-16_11-37-56", "timestamp": 1723788476, "time_this_iter_s": 42.493980884552, "time_total_s": 987.0240483283997, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a416bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 987.0240483283997, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 55.36, "ram_util_percent": 81.645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7531894164110617, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.625412590289242, "policy_loss": -0.0027302948750614646, "vf_loss": 9.627190301279542, "vf_explained_var": -0.07569445113025645, "kl": 0.009525772232988757, "entropy": 1.3343830485192556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.775982984995085, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.60124509448097, "policy_loss": -0.003340049627207456, "vf_loss": 9.604167487129333, "vf_explained_var": -0.06866059823641701, "kl": 0.004176768973936041, "entropy": 0.829100599112334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 2102.108206690053, "episode_reward_min": 1307.0714953197692, "episode_reward_mean": 1824.6556358823925, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 107.15386224505994, "predator_policy": 98.1050407695095}, "policy_reward_max": {"prey_policy": 784.1192365009371, "predator_policy": 627.192411265851}, "policy_reward_mean": {"prey_policy": 536.2175930815633, "predator_policy": 376.11022485963264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1912.314417354411, 1978.3458611046203, 1857.2841455221678, 1575.9899658904653, 1636.896890357989, 1709.9776708545967, 1998.5467753467033, 1713.203111984268, 1619.4203318714265, 1987.2673187344951, 1756.0414161328606, 1893.097667719989, 1888.8077675223717, 1963.9636296538886, 1851.4198454111925, 2003.2111495175861, 2102.108206690053, 1307.0714953197692, 1658.991332853079, 1954.2804660803636, 1902.3401078895122, 1693.399630715844, 1987.8963684882383, 1931.1803029449186, 1842.2636827089573, 1950.0635182249787, 1861.082870028119, 1665.336889939782, 2029.2441547171848, 1772.5483235344773, 1557.3866289634116, 1993.9645459835695, 1606.217038269132, 2005.6273122669543, 1994.0696827547329, 1527.4282275782346, 1686.0726742538918, 1458.4704436977654, 1965.8879559806294, 1889.9398021497839, 1754.8878954148463, 1698.9802618628446, 1988.1449997603506, 1975.8653613451133, 1937.7247057604998, 1891.1016643200005, 1594.4866002920387, 1550.3856931922464, 1947.2032631088082, 1924.2509542255232, 1804.7344576963906, 1761.6906020299746, 1733.6626835406837, 1850.7029129528607, 1927.8572859474705, 1835.1862444879757, 1952.6194967404729, 1670.6198957821528, 1814.0051932101487, 2027.1743326262408, 1564.0883177279486, 1812.4804925152491, 2008.3530300180319, 1952.0686866360454, 1836.5800638264916, 1706.202023012874, 1723.3257004739187, 1892.5861042248932, 2018.038429970808, 1470.9820341545687, 1904.8480133030687, 1711.9622885874023, 1626.659457272852, 1648.642514288497, 1999.0294899099413, 1580.283547076313, 1802.1686833183094, 1878.0111885093309, 1783.944775627896, 1824.8546212377157, 1872.190865448984, 1875.7672374182423, 1924.598435215594, 1948.5431454171594, 1857.3797809871764, 1845.3339057343994, 1947.7129451233413, 1829.8774423355703, 1937.322956398983, 1921.2532603094237, 1930.1599984614127, 1715.1962224867189, 1859.4464885778848, 1755.6854528757024, 1973.0120083295112, 1973.0862108738047, 1994.1654203061453, 1928.9691113916535, 1418.3511928222692, 1882.4579147240324], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [525.4778647669634, 576.2463545969321, 577.4481846443281, 409.9368745078021, 673.5244470231629, 636.5858263496708, 529.1129334138993, 320.2117370559915, 439.1803808514573, 573.6513824979406, 616.2483292196799, 619.0214231448797, 618.5487708026875, 546.4964478193318, 531.8360704866195, 430.3562995990207, 708.1518138387514, 386.5072148966672, 478.94882480613654, 506.0106240382709, 618.1052186892456, 613.1696886318974, 626.8341776748898, 587.4969575495305, 625.3766608844475, 549.3940776049578, 508.66212727214923, 551.4510273181112, 585.156934059604, 606.7450802967007, 551.1691255516043, 654.3504721440337, 622.0982368567288, 458.74882276122923, 385.57189130595515, 572.5693812750914, 450.49588593493706, 539.6702325906643, 676.9184902262765, 529.5296769523455, 408.5377321774488, 468.66437563033264, 462.33250192877864, 686.4874237938677, 559.4806883610974, 622.021524532382, 653.030293911466, 560.9341471587942, 477.69353469550924, 367.36049863378037, 466.80979700574017, 540.0135978057338, 590.6837356355564, 580.1718318357349, 479.80038571880846, 578.2364525270872, 571.1281914588943, 479.48903992882055, 495.21980231217685, 457.0273360603205, 515.6623056848442, 251.45492335798195, 519.7216607029862, 592.899313810502, 504.3873123500339, 263.77603464371157, 563.239826465314, 487.20277473203396, 546.3160290648656, 597.3312421017858, 500.41789686899085, 352.7326526245238, 483.696545871043, 572.2003884083598, 391.040325284146, 107.15386224505994, 705.6278446614617, 560.6552664491129, 692.9062869689224, 558.813286230521, 455.7162803991941, 356.8222493221906, 500.3008927037456, 594.4298441594624, 525.6495724159304, 646.9443003582811, 485.0227404293346, 691.2145198098021, 503.64273278194423, 431.3099576427896, 517.778538302165, 475.57892579132823, 415.8501403048874, 459.8495280938753, 601.3751578217345, 490.8666288486055, 646.4062274433566, 506.370602790283, 626.89531242585, 576.2174843172679, 484.6901043812415, 601.7087026206804, 562.6847154799601, 591.7590485441766, 605.4201375042342, 491.0496361316929, 594.4354833128488, 500.54019149286404, 566.0938503830263, 600.6527339054112, 328.0121220147754, 496.70170845487905, 572.2921007003292, 533.9334395991602, 784.1192365009371, 510.53553893100684, 590.5282234047115, 564.1570833281352, 648.0613975322146, 717.6484623677463, 222.18591917043602, 486.41692128935875, 448.7662344703295, 472.3559205911055, 482.86515511102743, 701.2352356789042, 487.909908632107, 574.0213163605036, 494.4607288475708, 569.404320491542, 331.70718207156176, 500.75890697699583, 517.660890262722, 414.1242434813731, 680.9993329448582, 544.0203596778709, 538.6684969942356, 740.7237850778166, 560.5332741925005, 457.82908535796355, 571.594262101511, 680.7252570332826, 637.5941086543075, 569.9863034903237, 686.9569407305904, 453.4227730332556, 409.4985410413963, 484.60119278848856, 606.0316877267484, 595.6452755084703, 508.9113900618062, 442.1004332368056, 642.2865657414139, 570.3255490411482, 559.3975760846704, 603.6942932323166, 416.55024391134884, 545.7986676253423, 652.690541777435, 481.7406539965883, 516.8294068141361, 507.51079677310236, 540.3411759112608, 523.4562248480822, 551.9871991965509, 645.0699566843044, 540.3820045535646, 552.2218959489712, 583.052114195074, 562.6211136414845, 673.5958334979365, 501.1812565863831, 611.8867358109633, 535.8254574695268, 426.91188072664085, 529.5192058718359, 554.6819460762291, 588.305426135179, 567.614276598597, 488.0286336077048, 460.18959523440594, 552.5178805302875, 488.7126159535686, 577.8942183488005, 447.94817611780206, 550.0937695797377, 516.085848434374, 627.6726361512566, 527.2772668885029, 523.575979963612, 492.4959910137938, 588.6275006957591, 629.3672378654637, 525.5784492560635, 522.694960572611, 612.9038605196268, 387.58532685969953, 540.5364593699145, 607.427976681069, 574.4706584995917], "policy_predator_policy_reward": [433.60300010927745, 376.98719788123475, 533.198339411665, 457.7624625408268, 352.73510202339236, 194.43877012594234, 330.2204729005076, 396.44482252006577, 378.80570261844196, 245.2594243901484, 323.3965624854887, 151.31135600454868, 408.72379194235, 424.77776478233164, 415.8783378552217, 335.1324040434059, 229.0987145292895, 295.66258860671843, 560.4717786150201, 441.83609127506725, 185.31848796433118, 339.44802084738484, 361.9170117520741, 316.8495207434956, 248.67224736829797, 465.3647816646721, 447.7851095126067, 456.0653655510205, 255.60917878146847, 403.9086522734188, 395.21925461206575, 402.4722972098826, 562.3399325792012, 458.9212144928954, 98.1050407695095, 250.82518196921365, 262.54382408393934, 406.2813902435397, 459.0582278462086, 288.77407105553465, 397.9455888158809, 627.192411265851, 342.4494963973753, 202.1302085958211, 411.9448493169313, 394.4493062778263, 364.16317133297355, 353.05269054168656, 491.7755191037605, 505.43413027590674, 478.6502595653701, 464.58986384813477, 344.02086574354234, 346.2064368132844, 368.6631152434791, 238.63693645040667, 450.3229981708692, 528.3039251586022, 428.8197374299767, 391.48144773200244, 413.36734806073275, 376.9020518598531, 432.15322490213737, 449.1903465679467, 480.3427956109431, 357.71089566444425, 502.2330150732675, 452.9516959963385, 386.7593724242006, 463.66303916388046, 296.1696398082003, 378.1080382765201, 344.0156184790234, 286.1601214954665, 573.1814113967985, 387.0948447717628, 295.99211249169826, 403.61273237835644, 302.97503489183623, 335.24519405850316, 381.1760573107785, 561.173308382682, 185.74112644292478, 418.5083985567105, 447.15898640076125, 368.3921405853784, 411.14430764874487, 388.4837934572317, 491.4705363879546, 511.30147894780936, 395.5914310517747, 502.1527691747328, 233.2652989981369, 485.52163289513965, 225.41743373092964, 232.72647279097708, 302.83282959859605, 491.5936032765726, 385.22693738913057, 335.9112200932755, 349.23134651041255, 369.1043041840551, 377.5535158353517, 229.69332217048594, 160.4355856961582, 476.7573242085949, 346.5389686761786, 409.18826947096966, 431.9757874983815, 329.1349141606503, 572.6064695655543, 437.8659444527688, 397.5613458762299, 448.8326105647532, 168.21163757755986, 207.75348277264888, 272.12164177500335, 387.1982447022985, 298.60244642176315, 362.86202630451703, 343.98360393668673, 511.5018733314671, 446.3896951775896, 444.9686422762251, 388.06083545546795, 436.1918037726311, 518.1774301050056, 371.96003153843395, 474.00107422509456, 298.71394026228234, 356.876509481446, 516.8594244828687, 429.04404368139126, 362.49652304843477, 256.26261320760443, 411.3037983945586, 366.00282770451383, 372.6433201942407, 227.4866165954293, 225.1330580086765, 329.27218805897803, 323.256306109298, 276.60789503513706, 227.77398140763424, 241.32939502391307, 244.9503484850951, 391.78586989814477, 362.75691056046674, 487.85228877954654, 309.500237895177, 324.1652060001908, 305.10651777750974, 343.42971333458917, 246.1268552011592, 323.49767499301015, 391.4216441993331, 454.48259567207583, 367.1132684191261, 240.2275152281598, 450.19591023553215, 460.3328922532087, 387.5177696085338, 497.289163527977, 314.6806731309218, 357.42668308533774, 370.114596249403, 350.39944852002174, 505.5397963945987, 379.5201288766567, 332.1864242739594, 349.80817488173045, 320.7486407683506, 338.092856139599, 461.90789570325313, 434.91400219388163, 438.53235354321123, 366.15427992359514, 428.18130426397937, 412.3304344817001, 453.2799156214225, 391.27165619304725, 526.1808665036687, 247.97082552432218, 400.6185626600267, 509.35343085005184, 352.05111203029594, 270.1260639801768, 341.80090430989355, 433.82896317798424, 488.329798299411, 498.73488409040885, 393.2278350738413, 316.56583308701875, 522.6539000975972, 346.1402310902773, 447.23005920913704, 300.52119477669004, 189.7082118159646, 422.92865000836304, 277.6306295350113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2007970800954861, "mean_inference_ms": 3.5217899553720544, "mean_action_processing_ms": 0.5109019590768156, "mean_env_wait_ms": 0.43585289574759123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015533208847045898, "StateBufferConnector_ms": 0.0166168212890625, "ViewRequirementAgentConnector_ms": 0.861611008644104}, "num_episodes": 22, "episode_return_max": 2102.108206690053, "episode_return_min": 1307.0714953197692, "episode_return_mean": 1824.6556358823925, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 97.95158759718952, "num_env_steps_trained_throughput_per_sec": 97.95158759718952, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 36340.896, "restore_workers_time_ms": 0.021, "training_step_time_ms": 36340.789, "sample_time_ms": 7529.648, "learn_time_ms": 28738.309, "learn_throughput": 139.187, "synch_weights_time_ms": 69.778}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "8abce_00000", "date": "2024-08-16_11-38-38", "timestamp": 1723788518, "time_this_iter_s": 40.94684410095215, "time_total_s": 1027.9708924293518, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a55310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1027.9708924293518, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 53.1793103448276, "ram_util_percent": 82.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9180010853305696, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.621935882265605, "policy_loss": -0.00070881149965639, "vf_loss": 9.62175509639518, "vf_explained_var": -0.03832452145833818, "kl": 0.008896044828359173, "entropy": 1.3466986982279985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8200834046438257, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.570167611641859, "policy_loss": -0.0067788028585719605, "vf_loss": 9.57650673477738, "vf_explained_var": -0.052593340507890815, "kl": 0.008794184427013768, "entropy": 0.811751539745028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 2056.4132084567464, "episode_reward_min": 996.7960148480913, "episode_reward_mean": 1822.1059298600924, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 107.15386224505994, "predator_policy": 45.03731939053044}, "policy_reward_max": {"prey_policy": 784.1192365009371, "predator_policy": 627.192411265851}, "policy_reward_mean": {"prey_policy": 529.2750930667465, "predator_policy": 381.77787186329954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1658.991332853079, 1954.2804660803636, 1902.3401078895122, 1693.399630715844, 1987.8963684882383, 1931.1803029449186, 1842.2636827089573, 1950.0635182249787, 1861.082870028119, 1665.336889939782, 2029.2441547171848, 1772.5483235344773, 1557.3866289634116, 1993.9645459835695, 1606.217038269132, 2005.6273122669543, 1994.0696827547329, 1527.4282275782346, 1686.0726742538918, 1458.4704436977654, 1965.8879559806294, 1889.9398021497839, 1754.8878954148463, 1698.9802618628446, 1988.1449997603506, 1975.8653613451133, 1937.7247057604998, 1891.1016643200005, 1594.4866002920387, 1550.3856931922464, 1947.2032631088082, 1924.2509542255232, 1804.7344576963906, 1761.6906020299746, 1733.6626835406837, 1850.7029129528607, 1927.8572859474705, 1835.1862444879757, 1952.6194967404729, 1670.6198957821528, 1814.0051932101487, 2027.1743326262408, 1564.0883177279486, 1812.4804925152491, 2008.3530300180319, 1952.0686866360454, 1836.5800638264916, 1706.202023012874, 1723.3257004739187, 1892.5861042248932, 2018.038429970808, 1470.9820341545687, 1904.8480133030687, 1711.9622885874023, 1626.659457272852, 1648.642514288497, 1999.0294899099413, 1580.283547076313, 1802.1686833183094, 1878.0111885093309, 1783.944775627896, 1824.8546212377157, 1872.190865448984, 1875.7672374182423, 1924.598435215594, 1948.5431454171594, 1857.3797809871764, 1845.3339057343994, 1947.7129451233413, 1829.8774423355703, 1937.322956398983, 1921.2532603094237, 1930.1599984614127, 1715.1962224867189, 1859.4464885778848, 1755.6854528757024, 1973.0120083295112, 1973.0862108738047, 1994.1654203061453, 1928.9691113916535, 1418.3511928222692, 1882.4579147240324, 1860.3754994632777, 1938.2199449901045, 1760.6764098219078, 1697.8010834605755, 996.7960148480913, 1856.7955288916605, 1908.107235367315, 2056.4132084567464, 1676.8107266560046, 1596.8855677901047, 2006.2599982666552, 1870.4873208186245, 1981.3532684911504, 1867.8838074220048, 1987.7469487906471, 1869.8388420401616, 1776.8183378578083, 1790.7273213260014], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [450.49588593493706, 539.6702325906643, 676.9184902262765, 529.5296769523455, 408.5377321774488, 468.66437563033264, 462.33250192877864, 686.4874237938677, 559.4806883610974, 622.021524532382, 653.030293911466, 560.9341471587942, 477.69353469550924, 367.36049863378037, 466.80979700574017, 540.0135978057338, 590.6837356355564, 580.1718318357349, 479.80038571880846, 578.2364525270872, 571.1281914588943, 479.48903992882055, 495.21980231217685, 457.0273360603205, 515.6623056848442, 251.45492335798195, 519.7216607029862, 592.899313810502, 504.3873123500339, 263.77603464371157, 563.239826465314, 487.20277473203396, 546.3160290648656, 597.3312421017858, 500.41789686899085, 352.7326526245238, 483.696545871043, 572.2003884083598, 391.040325284146, 107.15386224505994, 705.6278446614617, 560.6552664491129, 692.9062869689224, 558.813286230521, 455.7162803991941, 356.8222493221906, 500.3008927037456, 594.4298441594624, 525.6495724159304, 646.9443003582811, 485.0227404293346, 691.2145198098021, 503.64273278194423, 431.3099576427896, 517.778538302165, 475.57892579132823, 415.8501403048874, 459.8495280938753, 601.3751578217345, 490.8666288486055, 646.4062274433566, 506.370602790283, 626.89531242585, 576.2174843172679, 484.6901043812415, 601.7087026206804, 562.6847154799601, 591.7590485441766, 605.4201375042342, 491.0496361316929, 594.4354833128488, 500.54019149286404, 566.0938503830263, 600.6527339054112, 328.0121220147754, 496.70170845487905, 572.2921007003292, 533.9334395991602, 784.1192365009371, 510.53553893100684, 590.5282234047115, 564.1570833281352, 648.0613975322146, 717.6484623677463, 222.18591917043602, 486.41692128935875, 448.7662344703295, 472.3559205911055, 482.86515511102743, 701.2352356789042, 487.909908632107, 574.0213163605036, 494.4607288475708, 569.404320491542, 331.70718207156176, 500.75890697699583, 517.660890262722, 414.1242434813731, 680.9993329448582, 544.0203596778709, 538.6684969942356, 740.7237850778166, 560.5332741925005, 457.82908535796355, 571.594262101511, 680.7252570332826, 637.5941086543075, 569.9863034903237, 686.9569407305904, 453.4227730332556, 409.4985410413963, 484.60119278848856, 606.0316877267484, 595.6452755084703, 508.9113900618062, 442.1004332368056, 642.2865657414139, 570.3255490411482, 559.3975760846704, 603.6942932323166, 416.55024391134884, 545.7986676253423, 652.690541777435, 481.7406539965883, 516.8294068141361, 507.51079677310236, 540.3411759112608, 523.4562248480822, 551.9871991965509, 645.0699566843044, 540.3820045535646, 552.2218959489712, 583.052114195074, 562.6211136414845, 673.5958334979365, 501.1812565863831, 611.8867358109633, 535.8254574695268, 426.91188072664085, 529.5192058718359, 554.6819460762291, 588.305426135179, 567.614276598597, 488.0286336077048, 460.18959523440594, 552.5178805302875, 488.7126159535686, 577.8942183488005, 447.94817611780206, 550.0937695797377, 516.085848434374, 627.6726361512566, 527.2772668885029, 523.575979963612, 492.4959910137938, 588.6275006957591, 629.3672378654637, 525.5784492560635, 522.694960572611, 612.9038605196268, 387.58532685969953, 540.5364593699145, 607.427976681069, 574.4706584995917, 476.5826629576981, 585.4478536205805, 456.9946999424761, 617.2682862738006, 497.51791413378123, 544.0396017219568, 494.0897270663718, 436.75137166958814, 364.9603014993299, 340.1473181456656, 561.6897140919665, 401.5122897740842, 591.1538685157416, 574.4196842724343, 591.0202586179189, 489.5459234364782, 525.1448491896733, 357.00334753911363, 411.77662768476137, 647.2983384976658, 558.2425607047267, 486.89521898839513, 453.81851753257257, 592.9295668183245, 508.9496152900931, 584.964659345962, 455.1656196624326, 578.3667581715699, 524.4980438562658, 410.69810090920765, 624.5107391734381, 567.7146923386373, 557.0916290418285, 496.19674771612216, 496.3827598510803, 571.1118132212482], "policy_predator_policy_reward": [262.54382408393934, 406.2813902435397, 459.0582278462086, 288.77407105553465, 397.9455888158809, 627.192411265851, 342.4494963973753, 202.1302085958211, 411.9448493169313, 394.4493062778263, 364.16317133297355, 353.05269054168656, 491.7755191037605, 505.43413027590674, 478.6502595653701, 464.58986384813477, 344.02086574354234, 346.2064368132844, 368.6631152434791, 238.63693645040667, 450.3229981708692, 528.3039251586022, 428.8197374299767, 391.48144773200244, 413.36734806073275, 376.9020518598531, 432.15322490213737, 449.1903465679467, 480.3427956109431, 357.71089566444425, 502.2330150732675, 452.9516959963385, 386.7593724242006, 463.66303916388046, 296.1696398082003, 378.1080382765201, 344.0156184790234, 286.1601214954665, 573.1814113967985, 387.0948447717628, 295.99211249169826, 403.61273237835644, 302.97503489183623, 335.24519405850316, 381.1760573107785, 561.173308382682, 185.74112644292478, 418.5083985567105, 447.15898640076125, 368.3921405853784, 411.14430764874487, 388.4837934572317, 491.4705363879546, 511.30147894780936, 395.5914310517747, 502.1527691747328, 233.2652989981369, 485.52163289513965, 225.41743373092964, 232.72647279097708, 302.83282959859605, 491.5936032765726, 385.22693738913057, 335.9112200932755, 349.23134651041255, 369.1043041840551, 377.5535158353517, 229.69332217048594, 160.4355856961582, 476.7573242085949, 346.5389686761786, 409.18826947096966, 431.9757874983815, 329.1349141606503, 572.6064695655543, 437.8659444527688, 397.5613458762299, 448.8326105647532, 168.21163757755986, 207.75348277264888, 272.12164177500335, 387.1982447022985, 298.60244642176315, 362.86202630451703, 343.98360393668673, 511.5018733314671, 446.3896951775896, 444.9686422762251, 388.06083545546795, 436.1918037726311, 518.1774301050056, 371.96003153843395, 474.00107422509456, 298.71394026228234, 356.876509481446, 516.8594244828687, 429.04404368139126, 362.49652304843477, 256.26261320760443, 411.3037983945586, 366.00282770451383, 372.6433201942407, 227.4866165954293, 225.1330580086765, 329.27218805897803, 323.256306109298, 276.60789503513706, 227.77398140763424, 241.32939502391307, 244.9503484850951, 391.78586989814477, 362.75691056046674, 487.85228877954654, 309.500237895177, 324.1652060001908, 305.10651777750974, 343.42971333458917, 246.1268552011592, 323.49767499301015, 391.4216441993331, 454.48259567207583, 367.1132684191261, 240.2275152281598, 450.19591023553215, 460.3328922532087, 387.5177696085338, 497.289163527977, 314.6806731309218, 357.42668308533774, 370.114596249403, 350.39944852002174, 505.5397963945987, 379.5201288766567, 332.1864242739594, 349.80817488173045, 320.7486407683506, 338.092856139599, 461.90789570325313, 434.91400219388163, 438.53235354321123, 366.15427992359514, 428.18130426397937, 412.3304344817001, 453.2799156214225, 391.27165619304725, 526.1808665036687, 247.97082552432218, 400.6185626600267, 509.35343085005184, 352.05111203029594, 270.1260639801768, 341.80090430989355, 433.82896317798424, 488.329798299411, 498.73488409040885, 393.2278350738413, 316.56583308701875, 522.6539000975972, 346.1402310902773, 447.23005920913704, 300.52119477669004, 189.7082118159646, 422.92865000836304, 277.6306295350113, 463.8867724154237, 334.45821046957593, 492.2760231267211, 371.6809356471054, 424.79084258205506, 294.3280513841132, 392.5405323352806, 374.41945238933613, 45.03731939053044, 246.6510758125663, 491.3248313117831, 402.26869371382634, 335.8317553500354, 406.70192722910474, 478.2043705697389, 497.64265583261306, 322.1041239514523, 472.5584059757644, 178.9449819081866, 358.86561969949105, 504.8372519065097, 456.28496666702404, 392.819888984494, 430.9193474832322, 471.43923784418877, 415.9997560109082, 274.2599754571263, 560.0914541308761, 585.5225868483741, 467.0282171767996, 318.5484567085151, 359.06495381957035, 446.36497916804996, 277.16498193180695, 401.2816476919331, 321.9511005617416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2551533111646618, "mean_inference_ms": 3.6750156838832946, "mean_action_processing_ms": 0.5333324888965544, "mean_env_wait_ms": 0.4566747314788213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022742509841918945, "StateBufferConnector_ms": 0.01886773109436035, "ViewRequirementAgentConnector_ms": 1.0227683782577515}, "num_episodes": 18, "episode_return_max": 2056.4132084567464, "episode_return_min": 996.7960148480913, "episode_return_mean": 1822.1059298600924, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 94.95913297818724, "num_env_steps_trained_throughput_per_sec": 94.95913297818724, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 39206.152, "restore_workers_time_ms": 0.022, "training_step_time_ms": 39206.04, "sample_time_ms": 8541.613, "learn_time_ms": 30589.776, "learn_throughput": 130.763, "synch_weights_time_ms": 71.491}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "8abce_00000", "date": "2024-08-16_11-39-20", "timestamp": 1723788560, "time_this_iter_s": 42.196022033691406, "time_total_s": 1070.1669144630432, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a67b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1070.1669144630432, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 55.58666666666668, "ram_util_percent": 82.27166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.169303809177308, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.540507264616629, "policy_loss": -0.0032412052819771426, "vf_loss": 9.542581038500266, "vf_explained_var": -0.06743421453647512, "kl": 0.011673995481564036, "entropy": 1.2919144873265866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5066779106540025, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.6973847252982, "policy_loss": -0.004164329104657684, "vf_loss": 9.70122792026984, "vf_explained_var": -0.08825298103075178, "kl": 0.006421998295052985, "entropy": 0.8152245367645586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 2067.0781457934077, "episode_reward_min": 996.7960148480913, "episode_reward_mean": 1848.3428818519542, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 222.18591917043602, "predator_policy": 45.03731939053044}, "policy_reward_max": {"prey_policy": 784.1192365009371, "predator_policy": 590.3739858380721}, "policy_reward_mean": {"prey_policy": 531.8474580456473, "predator_policy": 392.3239828803299}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1698.9802618628446, 1988.1449997603506, 1975.8653613451133, 1937.7247057604998, 1891.1016643200005, 1594.4866002920387, 1550.3856931922464, 1947.2032631088082, 1924.2509542255232, 1804.7344576963906, 1761.6906020299746, 1733.6626835406837, 1850.7029129528607, 1927.8572859474705, 1835.1862444879757, 1952.6194967404729, 1670.6198957821528, 1814.0051932101487, 2027.1743326262408, 1564.0883177279486, 1812.4804925152491, 2008.3530300180319, 1952.0686866360454, 1836.5800638264916, 1706.202023012874, 1723.3257004739187, 1892.5861042248932, 2018.038429970808, 1470.9820341545687, 1904.8480133030687, 1711.9622885874023, 1626.659457272852, 1648.642514288497, 1999.0294899099413, 1580.283547076313, 1802.1686833183094, 1878.0111885093309, 1783.944775627896, 1824.8546212377157, 1872.190865448984, 1875.7672374182423, 1924.598435215594, 1948.5431454171594, 1857.3797809871764, 1845.3339057343994, 1947.7129451233413, 1829.8774423355703, 1937.322956398983, 1921.2532603094237, 1930.1599984614127, 1715.1962224867189, 1859.4464885778848, 1755.6854528757024, 1973.0120083295112, 1973.0862108738047, 1994.1654203061453, 1928.9691113916535, 1418.3511928222692, 1882.4579147240324, 1860.3754994632777, 1938.2199449901045, 1760.6764098219078, 1697.8010834605755, 996.7960148480913, 1856.7955288916605, 1908.107235367315, 2056.4132084567464, 1676.8107266560046, 1596.8855677901047, 2006.2599982666552, 1870.4873208186245, 1981.3532684911504, 1867.8838074220048, 1987.7469487906471, 1869.8388420401616, 1776.8183378578083, 1790.7273213260014, 1749.1783256787744, 1949.256475601875, 2029.8438707255293, 2018.6240484982586, 1936.4689973198952, 2067.0781457934077, 2026.2532695163538, 1856.2639481492686, 1990.9061741668384, 1742.628759160835, 1962.6075842161745, 1912.0405354810057, 1966.4557487718066, 1931.4742169778044, 1916.081317777536, 1705.5377304102522, 1836.342887586737, 1784.9508994110047, 1930.7475814986415, 1983.9243329570143, 1995.6017311754529, 2031.8005642858545, 1988.2079094643093], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [500.3008927037456, 594.4298441594624, 525.6495724159304, 646.9443003582811, 485.0227404293346, 691.2145198098021, 503.64273278194423, 431.3099576427896, 517.778538302165, 475.57892579132823, 415.8501403048874, 459.8495280938753, 601.3751578217345, 490.8666288486055, 646.4062274433566, 506.370602790283, 626.89531242585, 576.2174843172679, 484.6901043812415, 601.7087026206804, 562.6847154799601, 591.7590485441766, 605.4201375042342, 491.0496361316929, 594.4354833128488, 500.54019149286404, 566.0938503830263, 600.6527339054112, 328.0121220147754, 496.70170845487905, 572.2921007003292, 533.9334395991602, 784.1192365009371, 510.53553893100684, 590.5282234047115, 564.1570833281352, 648.0613975322146, 717.6484623677463, 222.18591917043602, 486.41692128935875, 448.7662344703295, 472.3559205911055, 482.86515511102743, 701.2352356789042, 487.909908632107, 574.0213163605036, 494.4607288475708, 569.404320491542, 331.70718207156176, 500.75890697699583, 517.660890262722, 414.1242434813731, 680.9993329448582, 544.0203596778709, 538.6684969942356, 740.7237850778166, 560.5332741925005, 457.82908535796355, 571.594262101511, 680.7252570332826, 637.5941086543075, 569.9863034903237, 686.9569407305904, 453.4227730332556, 409.4985410413963, 484.60119278848856, 606.0316877267484, 595.6452755084703, 508.9113900618062, 442.1004332368056, 642.2865657414139, 570.3255490411482, 559.3975760846704, 603.6942932323166, 416.55024391134884, 545.7986676253423, 652.690541777435, 481.7406539965883, 516.8294068141361, 507.51079677310236, 540.3411759112608, 523.4562248480822, 551.9871991965509, 645.0699566843044, 540.3820045535646, 552.2218959489712, 583.052114195074, 562.6211136414845, 673.5958334979365, 501.1812565863831, 611.8867358109633, 535.8254574695268, 426.91188072664085, 529.5192058718359, 554.6819460762291, 588.305426135179, 567.614276598597, 488.0286336077048, 460.18959523440594, 552.5178805302875, 488.7126159535686, 577.8942183488005, 447.94817611780206, 550.0937695797377, 516.085848434374, 627.6726361512566, 527.2772668885029, 523.575979963612, 492.4959910137938, 588.6275006957591, 629.3672378654637, 525.5784492560635, 522.694960572611, 612.9038605196268, 387.58532685969953, 540.5364593699145, 607.427976681069, 574.4706584995917, 476.5826629576981, 585.4478536205805, 456.9946999424761, 617.2682862738006, 497.51791413378123, 544.0396017219568, 494.0897270663718, 436.75137166958814, 364.9603014993299, 340.1473181456656, 561.6897140919665, 401.5122897740842, 591.1538685157416, 574.4196842724343, 591.0202586179189, 489.5459234364782, 525.1448491896733, 357.00334753911363, 411.77662768476137, 647.2983384976658, 558.2425607047267, 486.89521898839513, 453.81851753257257, 592.9295668183245, 508.9496152900931, 584.964659345962, 455.1656196624326, 578.3667581715699, 524.4980438562658, 410.69810090920765, 624.5107391734381, 567.7146923386373, 557.0916290418285, 496.19674771612216, 496.3827598510803, 571.1118132212482, 652.0833573205899, 681.1700328231468, 592.1991964122443, 553.1055162245196, 640.8018414135045, 544.9325644118992, 550.6336572412333, 329.78594855477377, 541.1134014957075, 556.8385719688187, 517.0141161499832, 537.6811051595399, 523.2510477263178, 374.78766121587876, 492.73558161972227, 535.2599936417083, 535.0048127978446, 671.3897697170308, 606.1786061043545, 446.6704971571211, 596.4551351474789, 529.7946385864437, 398.37073093455297, 421.0656243318919, 525.0013022826166, 477.61694907317553, 452.8517228390706, 484.80878739067555, 399.2665445821167, 456.3624243235394, 483.2843376724923, 615.3535358801594, 480.29514441185484, 474.2768324388742, 460.0407976266848, 536.3057575816576, 493.39831158698587, 417.38110732473245, 573.6354875795555, 486.62862780148794, 563.6575291318932, 494.46144580660507, 532.1438184785505, 636.3322087688288, 497.1697781825367, 427.3886219238954], "policy_predator_policy_reward": [185.74112644292478, 418.5083985567105, 447.15898640076125, 368.3921405853784, 411.14430764874487, 388.4837934572317, 491.4705363879546, 511.30147894780936, 395.5914310517747, 502.1527691747328, 233.2652989981369, 485.52163289513965, 225.41743373092964, 232.72647279097708, 302.83282959859605, 491.5936032765726, 385.22693738913057, 335.9112200932755, 349.23134651041255, 369.1043041840551, 377.5535158353517, 229.69332217048594, 160.4355856961582, 476.7573242085949, 346.5389686761786, 409.18826947096966, 431.9757874983815, 329.1349141606503, 572.6064695655543, 437.8659444527688, 397.5613458762299, 448.8326105647532, 168.21163757755986, 207.75348277264888, 272.12164177500335, 387.1982447022985, 298.60244642176315, 362.86202630451703, 343.98360393668673, 511.5018733314671, 446.3896951775896, 444.9686422762251, 388.06083545546795, 436.1918037726311, 518.1774301050056, 371.96003153843395, 474.00107422509456, 298.71394026228234, 356.876509481446, 516.8594244828687, 429.04404368139126, 362.49652304843477, 256.26261320760443, 411.3037983945586, 366.00282770451383, 372.6433201942407, 227.4866165954293, 225.1330580086765, 329.27218805897803, 323.256306109298, 276.60789503513706, 227.77398140763424, 241.32939502391307, 244.9503484850951, 391.78586989814477, 362.75691056046674, 487.85228877954654, 309.500237895177, 324.1652060001908, 305.10651777750974, 343.42971333458917, 246.1268552011592, 323.49767499301015, 391.4216441993331, 454.48259567207583, 367.1132684191261, 240.2275152281598, 450.19591023553215, 460.3328922532087, 387.5177696085338, 497.289163527977, 314.6806731309218, 357.42668308533774, 370.114596249403, 350.39944852002174, 505.5397963945987, 379.5201288766567, 332.1864242739594, 349.80817488173045, 320.7486407683506, 338.092856139599, 461.90789570325313, 434.91400219388163, 438.53235354321123, 366.15427992359514, 428.18130426397937, 412.3304344817001, 453.2799156214225, 391.27165619304725, 526.1808665036687, 247.97082552432218, 400.6185626600267, 509.35343085005184, 352.05111203029594, 270.1260639801768, 341.80090430989355, 433.82896317798424, 488.329798299411, 498.73488409040885, 393.2278350738413, 316.56583308701875, 522.6539000975972, 346.1402310902773, 447.23005920913704, 300.52119477669004, 189.7082118159646, 422.92865000836304, 277.6306295350113, 463.8867724154237, 334.45821046957593, 492.2760231267211, 371.6809356471054, 424.79084258205506, 294.3280513841132, 392.5405323352806, 374.41945238933613, 45.03731939053044, 246.6510758125663, 491.3248313117831, 402.26869371382634, 335.8317553500354, 406.70192722910474, 478.2043705697389, 497.64265583261306, 322.1041239514523, 472.5584059757644, 178.9449819081866, 358.86561969949105, 504.8372519065097, 456.28496666702404, 392.819888984494, 430.9193474832322, 471.43923784418877, 415.9997560109082, 274.2599754571263, 560.0914541308761, 585.5225868483741, 467.0282171767996, 318.5484567085151, 359.06495381957035, 446.36497916804996, 277.16498193180695, 401.2816476919331, 321.9511005617416, 180.66195311546002, 235.26298241957568, 399.0916824507801, 404.8600805143323, 385.897446189869, 458.2120187102533, 548.6696595368271, 589.534783165428, 484.08216665960435, 354.4348571957659, 499.13158697856187, 513.2513375053214, 537.8405747360848, 590.3739858380721, 450.69399866307975, 377.574374224756, 338.9671592493752, 445.5444324025891, 362.7180384446278, 327.0616174547324, 448.79178754565595, 387.5660229365951, 540.2987223192274, 552.3054578953348, 475.68937826177074, 488.14811915424315, 440.0337309085632, 553.7799758394941, 577.9628846861899, 482.48946418569096, 278.690184388802, 328.2096724687989, 565.105951619276, 316.6649591167322, 453.4355752746023, 335.16876892805965, 485.92002619822574, 534.0481363886962, 479.70360998017594, 443.9566075957933, 462.20526858891157, 475.2774876480446, 436.9045246450302, 426.42001239344745, 521.2120756008419, 542.4374337570365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3326057672376583, "mean_inference_ms": 3.8845155048985602, "mean_action_processing_ms": 0.5647866203406425, "mean_env_wait_ms": 0.48524374477380966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06975078582763672, "StateBufferConnector_ms": 0.06442868709564209, "ViewRequirementAgentConnector_ms": 1.1110517978668213}, "num_episodes": 23, "episode_return_max": 2067.0781457934077, "episode_return_min": 996.7960148480913, "episode_return_mean": 1848.3428818519542, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.86265657738292, "num_env_steps_trained_throughput_per_sec": 89.86265657738292, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 42307.46, "restore_workers_time_ms": 0.022, "training_step_time_ms": 42307.346, "sample_time_ms": 9793.649, "learn_time_ms": 32436.34, "learn_throughput": 123.318, "synch_weights_time_ms": 74.116}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "8abce_00000", "date": "2024-08-16_11-40-05", "timestamp": 1723788605, "time_this_iter_s": 44.60203695297241, "time_total_s": 1114.7689514160156, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1114.7689514160156, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 54.176190476190484, "ram_util_percent": 82.05714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.549522690325187, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.448483569029147, "policy_loss": -0.003687036545237615, "vf_loss": 9.450871446397569, "vf_explained_var": -0.17521455716834497, "kl": 0.012991530286992067, "entropy": 1.2931468404159343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3714821445169272, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.72206092965666, "policy_loss": -0.0035404213617935224, "vf_loss": 9.725299788278246, "vf_explained_var": -0.08184490869284938, "kl": 0.006031042393272128, "entropy": 0.7895533969478001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 2070.743139023187, "episode_reward_min": 996.7960148480913, "episode_reward_mean": 1865.402611929412, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 222.18591917043602, "predator_policy": 45.03731939053044}, "policy_reward_max": {"prey_policy": 740.7237850778166, "predator_policy": 590.3739858380721}, "policy_reward_mean": {"prey_policy": 521.4814728069878, "predator_policy": 411.21983315771814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2027.1743326262408, 1564.0883177279486, 1812.4804925152491, 2008.3530300180319, 1952.0686866360454, 1836.5800638264916, 1706.202023012874, 1723.3257004739187, 1892.5861042248932, 2018.038429970808, 1470.9820341545687, 1904.8480133030687, 1711.9622885874023, 1626.659457272852, 1648.642514288497, 1999.0294899099413, 1580.283547076313, 1802.1686833183094, 1878.0111885093309, 1783.944775627896, 1824.8546212377157, 1872.190865448984, 1875.7672374182423, 1924.598435215594, 1948.5431454171594, 1857.3797809871764, 1845.3339057343994, 1947.7129451233413, 1829.8774423355703, 1937.322956398983, 1921.2532603094237, 1930.1599984614127, 1715.1962224867189, 1859.4464885778848, 1755.6854528757024, 1973.0120083295112, 1973.0862108738047, 1994.1654203061453, 1928.9691113916535, 1418.3511928222692, 1882.4579147240324, 1860.3754994632777, 1938.2199449901045, 1760.6764098219078, 1697.8010834605755, 996.7960148480913, 1856.7955288916605, 1908.107235367315, 2056.4132084567464, 1676.8107266560046, 1596.8855677901047, 2006.2599982666552, 1870.4873208186245, 1981.3532684911504, 1867.8838074220048, 1987.7469487906471, 1869.8388420401616, 1776.8183378578083, 1790.7273213260014, 1749.1783256787744, 1949.256475601875, 2029.8438707255293, 2018.6240484982586, 1936.4689973198952, 2067.0781457934077, 2026.2532695163538, 1856.2639481492686, 1990.9061741668384, 1742.628759160835, 1962.6075842161745, 1912.0405354810057, 1966.4557487718066, 1931.4742169778044, 1916.081317777536, 1705.5377304102522, 1836.342887586737, 1784.9508994110047, 1930.7475814986415, 1983.9243329570143, 1995.6017311754529, 2031.8005642858545, 1988.2079094643093, 1816.3855830347159, 1868.552119818714, 1968.8764008065, 2045.1436694251618, 1963.241594013036, 1921.155235232459, 2037.8492819613084, 2046.602002389601, 1945.7909497294788, 2005.4921086510046, 2070.743139023187, 1826.6836924139527, 1543.3565372090532, 1829.3623692839135, 1746.9108675634398, 2011.4228307385358, 2025.7580795687093, 1891.8688231385263], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [648.0613975322146, 717.6484623677463, 222.18591917043602, 486.41692128935875, 448.7662344703295, 472.3559205911055, 482.86515511102743, 701.2352356789042, 487.909908632107, 574.0213163605036, 494.4607288475708, 569.404320491542, 331.70718207156176, 500.75890697699583, 517.660890262722, 414.1242434813731, 680.9993329448582, 544.0203596778709, 538.6684969942356, 740.7237850778166, 560.5332741925005, 457.82908535796355, 571.594262101511, 680.7252570332826, 637.5941086543075, 569.9863034903237, 686.9569407305904, 453.4227730332556, 409.4985410413963, 484.60119278848856, 606.0316877267484, 595.6452755084703, 508.9113900618062, 442.1004332368056, 642.2865657414139, 570.3255490411482, 559.3975760846704, 603.6942932323166, 416.55024391134884, 545.7986676253423, 652.690541777435, 481.7406539965883, 516.8294068141361, 507.51079677310236, 540.3411759112608, 523.4562248480822, 551.9871991965509, 645.0699566843044, 540.3820045535646, 552.2218959489712, 583.052114195074, 562.6211136414845, 673.5958334979365, 501.1812565863831, 611.8867358109633, 535.8254574695268, 426.91188072664085, 529.5192058718359, 554.6819460762291, 588.305426135179, 567.614276598597, 488.0286336077048, 460.18959523440594, 552.5178805302875, 488.7126159535686, 577.8942183488005, 447.94817611780206, 550.0937695797377, 516.085848434374, 627.6726361512566, 527.2772668885029, 523.575979963612, 492.4959910137938, 588.6275006957591, 629.3672378654637, 525.5784492560635, 522.694960572611, 612.9038605196268, 387.58532685969953, 540.5364593699145, 607.427976681069, 574.4706584995917, 476.5826629576981, 585.4478536205805, 456.9946999424761, 617.2682862738006, 497.51791413378123, 544.0396017219568, 494.0897270663718, 436.75137166958814, 364.9603014993299, 340.1473181456656, 561.6897140919665, 401.5122897740842, 591.1538685157416, 574.4196842724343, 591.0202586179189, 489.5459234364782, 525.1448491896733, 357.00334753911363, 411.77662768476137, 647.2983384976658, 558.2425607047267, 486.89521898839513, 453.81851753257257, 592.9295668183245, 508.9496152900931, 584.964659345962, 455.1656196624326, 578.3667581715699, 524.4980438562658, 410.69810090920765, 624.5107391734381, 567.7146923386373, 557.0916290418285, 496.19674771612216, 496.3827598510803, 571.1118132212482, 652.0833573205899, 681.1700328231468, 592.1991964122443, 553.1055162245196, 640.8018414135045, 544.9325644118992, 550.6336572412333, 329.78594855477377, 541.1134014957075, 556.8385719688187, 517.0141161499832, 537.6811051595399, 523.2510477263178, 374.78766121587876, 492.73558161972227, 535.2599936417083, 535.0048127978446, 671.3897697170308, 606.1786061043545, 446.6704971571211, 596.4551351474789, 529.7946385864437, 398.37073093455297, 421.0656243318919, 525.0013022826166, 477.61694907317553, 452.8517228390706, 484.80878739067555, 399.2665445821167, 456.3624243235394, 483.2843376724923, 615.3535358801594, 480.29514441185484, 474.2768324388742, 460.0407976266848, 536.3057575816576, 493.39831158698587, 417.38110732473245, 573.6354875795555, 486.62862780148794, 563.6575291318932, 494.46144580660507, 532.1438184785505, 636.3322087688288, 497.1697781825367, 427.3886219238954, 417.7008013751988, 344.22788089408886, 481.28347458639485, 487.7903604298164, 508.78635786060084, 511.65400283463106, 400.9446627183385, 625.5198011424641, 387.5349674074794, 593.4230042892194, 476.3449836710676, 513.813228815282, 556.0089822886708, 543.666573625063, 452.3887259792005, 529.3994464404814, 453.8741041408753, 527.6911564745386, 493.0171024747513, 483.67770188087104, 581.0549032026546, 553.0328460154194, 469.45424932851154, 460.1370308375822, 227.15357298176679, 528.7060239859546, 500.80802869273725, 544.7780000128091, 459.89500256119, 554.5649445155626, 539.555534385449, 478.4803507460699, 564.2881338221141, 464.16230669478597, 388.0766713207579, 498.92519696639255], "policy_predator_policy_reward": [298.60244642176315, 362.86202630451703, 343.98360393668673, 511.5018733314671, 446.3896951775896, 444.9686422762251, 388.06083545546795, 436.1918037726311, 518.1774301050056, 371.96003153843395, 474.00107422509456, 298.71394026228234, 356.876509481446, 516.8594244828687, 429.04404368139126, 362.49652304843477, 256.26261320760443, 411.3037983945586, 366.00282770451383, 372.6433201942407, 227.4866165954293, 225.1330580086765, 329.27218805897803, 323.256306109298, 276.60789503513706, 227.77398140763424, 241.32939502391307, 244.9503484850951, 391.78586989814477, 362.75691056046674, 487.85228877954654, 309.500237895177, 324.1652060001908, 305.10651777750974, 343.42971333458917, 246.1268552011592, 323.49767499301015, 391.4216441993331, 454.48259567207583, 367.1132684191261, 240.2275152281598, 450.19591023553215, 460.3328922532087, 387.5177696085338, 497.289163527977, 314.6806731309218, 357.42668308533774, 370.114596249403, 350.39944852002174, 505.5397963945987, 379.5201288766567, 332.1864242739594, 349.80817488173045, 320.7486407683506, 338.092856139599, 461.90789570325313, 434.91400219388163, 438.53235354321123, 366.15427992359514, 428.18130426397937, 412.3304344817001, 453.2799156214225, 391.27165619304725, 526.1808665036687, 247.97082552432218, 400.6185626600267, 509.35343085005184, 352.05111203029594, 270.1260639801768, 341.80090430989355, 433.82896317798424, 488.329798299411, 498.73488409040885, 393.2278350738413, 316.56583308701875, 522.6539000975972, 346.1402310902773, 447.23005920913704, 300.52119477669004, 189.7082118159646, 422.92865000836304, 277.6306295350113, 463.8867724154237, 334.45821046957593, 492.2760231267211, 371.6809356471054, 424.79084258205506, 294.3280513841132, 392.5405323352806, 374.41945238933613, 45.03731939053044, 246.6510758125663, 491.3248313117831, 402.26869371382634, 335.8317553500354, 406.70192722910474, 478.2043705697389, 497.64265583261306, 322.1041239514523, 472.5584059757644, 178.9449819081866, 358.86561969949105, 504.8372519065097, 456.28496666702404, 392.819888984494, 430.9193474832322, 471.43923784418877, 415.9997560109082, 274.2599754571263, 560.0914541308761, 585.5225868483741, 467.0282171767996, 318.5484567085151, 359.06495381957035, 446.36497916804996, 277.16498193180695, 401.2816476919331, 321.9511005617416, 180.66195311546002, 235.26298241957568, 399.0916824507801, 404.8600805143323, 385.897446189869, 458.2120187102533, 548.6696595368271, 589.534783165428, 484.08216665960435, 354.4348571957659, 499.13158697856187, 513.2513375053214, 537.8405747360848, 590.3739858380721, 450.69399866307975, 377.574374224756, 338.9671592493752, 445.5444324025891, 362.7180384446278, 327.0616174547324, 448.79178754565595, 387.5660229365951, 540.2987223192274, 552.3054578953348, 475.68937826177074, 488.14811915424315, 440.0337309085632, 553.7799758394941, 577.9628846861899, 482.48946418569096, 278.690184388802, 328.2096724687989, 565.105951619276, 316.6649591167322, 453.4355752746023, 335.16876892805965, 485.92002619822574, 534.0481363886962, 479.70360998017594, 443.9566075957933, 462.20526858891157, 475.2774876480446, 436.9045246450302, 426.42001239344745, 521.2120756008419, 542.4374337570365, 578.9159234522334, 475.540977313194, 455.4738450915824, 444.0044397109232, 453.6460228756289, 494.7900172356384, 485.4831095506553, 533.1960960137043, 453.71493088139226, 528.5686914349437, 473.65846311084806, 457.33855963526105, 459.19520198583535, 478.97852406174127, 534.3170486414795, 530.4967813284378, 468.548511549164, 495.67717756490117, 543.8285879792546, 484.9687163161289, 430.87799969373856, 505.7773901113735, 359.19303897452596, 537.899373273336, 386.77966667770727, 400.7172735636256, 289.56501196655404, 494.2113286118133, 152.65086783152555, 579.8000526551612, 417.1115655950872, 576.2753800119311, 480.44307697029666, 516.8645620815108, 503.22545614151284, 501.64149870986364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.395810421524125, "mean_inference_ms": 4.049882090802507, "mean_action_processing_ms": 0.5894067107324442, "mean_env_wait_ms": 0.5072696293377469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07314300537109375, "StateBufferConnector_ms": 0.06480729579925537, "ViewRequirementAgentConnector_ms": 1.1318931579589844}, "num_episodes": 18, "episode_return_max": 2070.743139023187, "episode_return_min": 996.7960148480913, "episode_return_mean": 1865.402611929412, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 93.0318463811743, "num_env_steps_trained_throughput_per_sec": 93.0318463811743, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 42624.471, "restore_workers_time_ms": 0.024, "training_step_time_ms": 42624.357, "sample_time_ms": 10769.024, "learn_time_ms": 31781.756, "learn_throughput": 125.858, "synch_weights_time_ms": 70.71}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "8abce_00000", "date": "2024-08-16_11-40-48", "timestamp": 1723788648, "time_this_iter_s": 43.07243490219116, "time_total_s": 1157.8413863182068, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a436baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1157.8413863182068, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 53.77540983606558, "ram_util_percent": 81.82459016393445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.464745057827581, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.107249057608307, "policy_loss": -0.001787061880037149, "vf_loss": 9.10724566979383, "vf_explained_var": -0.13488880941476772, "kl": 0.01790421205828162, "entropy": 1.3500605188980304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3203461026073133, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.780154634405065, "policy_loss": -0.003570278747026961, "vf_loss": 9.78334013974225, "vf_explained_var": -0.04591391606936379, "kl": 0.007695459222129716, "entropy": 0.7574156557441388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 2099.2608120977698, "episode_reward_min": 996.7960148480913, "episode_reward_mean": 1893.1580469526223, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 227.15357298176679, "predator_policy": 45.03731939053044}, "policy_reward_max": {"prey_policy": 681.1700328231468, "predator_policy": 668.6367013136266}, "policy_reward_mean": {"prey_policy": 505.0569786759549, "predator_policy": 441.52204480035624}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1878.0111885093309, 1783.944775627896, 1824.8546212377157, 1872.190865448984, 1875.7672374182423, 1924.598435215594, 1948.5431454171594, 1857.3797809871764, 1845.3339057343994, 1947.7129451233413, 1829.8774423355703, 1937.322956398983, 1921.2532603094237, 1930.1599984614127, 1715.1962224867189, 1859.4464885778848, 1755.6854528757024, 1973.0120083295112, 1973.0862108738047, 1994.1654203061453, 1928.9691113916535, 1418.3511928222692, 1882.4579147240324, 1860.3754994632777, 1938.2199449901045, 1760.6764098219078, 1697.8010834605755, 996.7960148480913, 1856.7955288916605, 1908.107235367315, 2056.4132084567464, 1676.8107266560046, 1596.8855677901047, 2006.2599982666552, 1870.4873208186245, 1981.3532684911504, 1867.8838074220048, 1987.7469487906471, 1869.8388420401616, 1776.8183378578083, 1790.7273213260014, 1749.1783256787744, 1949.256475601875, 2029.8438707255293, 2018.6240484982586, 1936.4689973198952, 2067.0781457934077, 2026.2532695163538, 1856.2639481492686, 1990.9061741668384, 1742.628759160835, 1962.6075842161745, 1912.0405354810057, 1966.4557487718066, 1931.4742169778044, 1916.081317777536, 1705.5377304102522, 1836.342887586737, 1784.9508994110047, 1930.7475814986415, 1983.9243329570143, 1995.6017311754529, 2031.8005642858545, 1988.2079094643093, 1816.3855830347159, 1868.552119818714, 1968.8764008065, 2045.1436694251618, 1963.241594013036, 1921.155235232459, 2037.8492819613084, 2046.602002389601, 1945.7909497294788, 2005.4921086510046, 2070.743139023187, 1826.6836924139527, 1543.3565372090532, 1829.3623692839135, 1746.9108675634398, 2011.4228307385358, 2025.7580795687093, 1891.8688231385263, 1878.2625632115169, 2099.2608120977698, 1967.562526842561, 1922.6297771169302, 2060.567042703981, 1996.5249100014203, 1952.361231637068, 2004.5493769934626, 1738.9940078732204, 1923.0239258336092, 1846.3735336636564, 2016.4175398269103, 1918.0817344117827, 1929.9314575882718, 2055.381434700253, 1895.4693762729723, 1879.4147093904041, 1976.210751098719], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [559.3975760846704, 603.6942932323166, 416.55024391134884, 545.7986676253423, 652.690541777435, 481.7406539965883, 516.8294068141361, 507.51079677310236, 540.3411759112608, 523.4562248480822, 551.9871991965509, 645.0699566843044, 540.3820045535646, 552.2218959489712, 583.052114195074, 562.6211136414845, 673.5958334979365, 501.1812565863831, 611.8867358109633, 535.8254574695268, 426.91188072664085, 529.5192058718359, 554.6819460762291, 588.305426135179, 567.614276598597, 488.0286336077048, 460.18959523440594, 552.5178805302875, 488.7126159535686, 577.8942183488005, 447.94817611780206, 550.0937695797377, 516.085848434374, 627.6726361512566, 527.2772668885029, 523.575979963612, 492.4959910137938, 588.6275006957591, 629.3672378654637, 525.5784492560635, 522.694960572611, 612.9038605196268, 387.58532685969953, 540.5364593699145, 607.427976681069, 574.4706584995917, 476.5826629576981, 585.4478536205805, 456.9946999424761, 617.2682862738006, 497.51791413378123, 544.0396017219568, 494.0897270663718, 436.75137166958814, 364.9603014993299, 340.1473181456656, 561.6897140919665, 401.5122897740842, 591.1538685157416, 574.4196842724343, 591.0202586179189, 489.5459234364782, 525.1448491896733, 357.00334753911363, 411.77662768476137, 647.2983384976658, 558.2425607047267, 486.89521898839513, 453.81851753257257, 592.9295668183245, 508.9496152900931, 584.964659345962, 455.1656196624326, 578.3667581715699, 524.4980438562658, 410.69810090920765, 624.5107391734381, 567.7146923386373, 557.0916290418285, 496.19674771612216, 496.3827598510803, 571.1118132212482, 652.0833573205899, 681.1700328231468, 592.1991964122443, 553.1055162245196, 640.8018414135045, 544.9325644118992, 550.6336572412333, 329.78594855477377, 541.1134014957075, 556.8385719688187, 517.0141161499832, 537.6811051595399, 523.2510477263178, 374.78766121587876, 492.73558161972227, 535.2599936417083, 535.0048127978446, 671.3897697170308, 606.1786061043545, 446.6704971571211, 596.4551351474789, 529.7946385864437, 398.37073093455297, 421.0656243318919, 525.0013022826166, 477.61694907317553, 452.8517228390706, 484.80878739067555, 399.2665445821167, 456.3624243235394, 483.2843376724923, 615.3535358801594, 480.29514441185484, 474.2768324388742, 460.0407976266848, 536.3057575816576, 493.39831158698587, 417.38110732473245, 573.6354875795555, 486.62862780148794, 563.6575291318932, 494.46144580660507, 532.1438184785505, 636.3322087688288, 497.1697781825367, 427.3886219238954, 417.7008013751988, 344.22788089408886, 481.28347458639485, 487.7903604298164, 508.78635786060084, 511.65400283463106, 400.9446627183385, 625.5198011424641, 387.5349674074794, 593.4230042892194, 476.3449836710676, 513.813228815282, 556.0089822886708, 543.666573625063, 452.3887259792005, 529.3994464404814, 453.8741041408753, 527.6911564745386, 493.0171024747513, 483.67770188087104, 581.0549032026546, 553.0328460154194, 469.45424932851154, 460.1370308375822, 227.15357298176679, 528.7060239859546, 500.80802869273725, 544.7780000128091, 459.89500256119, 554.5649445155626, 539.555534385449, 478.4803507460699, 564.2881338221141, 464.16230669478597, 388.0766713207579, 498.92519696639255, 484.17063125255333, 566.7774343607143, 528.3282415540101, 619.0405883654997, 469.36036876272897, 374.8793058970737, 302.036996375344, 348.4723571630594, 405.36629263534115, 498.4264800810761, 292.06544051526936, 547.6526098588464, 532.9846365641774, 482.33889286619467, 505.34479066813674, 658.1222174567392, 362.33334874690723, 400.7794455399065, 480.42643835218973, 430.16838125122825, 531.9919184327179, 466.32626663394257, 454.00387164616126, 322.37243701572004, 346.04516681556316, 430.77639913403874, 364.58563236280014, 508.28214473982456, 548.0169118617973, 497.3739541256147, 349.38200795430475, 355.8601646505861, 436.35102237676375, 409.14175370836284, 451.07192385824254, 406.48205798030295], "policy_predator_policy_reward": [323.49767499301015, 391.4216441993331, 454.48259567207583, 367.1132684191261, 240.2275152281598, 450.19591023553215, 460.3328922532087, 387.5177696085338, 497.289163527977, 314.6806731309218, 357.42668308533774, 370.114596249403, 350.39944852002174, 505.5397963945987, 379.5201288766567, 332.1864242739594, 349.80817488173045, 320.7486407683506, 338.092856139599, 461.90789570325313, 434.91400219388163, 438.53235354321123, 366.15427992359514, 428.18130426397937, 412.3304344817001, 453.2799156214225, 391.27165619304725, 526.1808665036687, 247.97082552432218, 400.6185626600267, 509.35343085005184, 352.05111203029594, 270.1260639801768, 341.80090430989355, 433.82896317798424, 488.329798299411, 498.73488409040885, 393.2278350738413, 316.56583308701875, 522.6539000975972, 346.1402310902773, 447.23005920913704, 300.52119477669004, 189.7082118159646, 422.92865000836304, 277.6306295350113, 463.8867724154237, 334.45821046957593, 492.2760231267211, 371.6809356471054, 424.79084258205506, 294.3280513841132, 392.5405323352806, 374.41945238933613, 45.03731939053044, 246.6510758125663, 491.3248313117831, 402.26869371382634, 335.8317553500354, 406.70192722910474, 478.2043705697389, 497.64265583261306, 322.1041239514523, 472.5584059757644, 178.9449819081866, 358.86561969949105, 504.8372519065097, 456.28496666702404, 392.819888984494, 430.9193474832322, 471.43923784418877, 415.9997560109082, 274.2599754571263, 560.0914541308761, 585.5225868483741, 467.0282171767996, 318.5484567085151, 359.06495381957035, 446.36497916804996, 277.16498193180695, 401.2816476919331, 321.9511005617416, 180.66195311546002, 235.26298241957568, 399.0916824507801, 404.8600805143323, 385.897446189869, 458.2120187102533, 548.6696595368271, 589.534783165428, 484.08216665960435, 354.4348571957659, 499.13158697856187, 513.2513375053214, 537.8405747360848, 590.3739858380721, 450.69399866307975, 377.574374224756, 338.9671592493752, 445.5444324025891, 362.7180384446278, 327.0616174547324, 448.79178754565595, 387.5660229365951, 540.2987223192274, 552.3054578953348, 475.68937826177074, 488.14811915424315, 440.0337309085632, 553.7799758394941, 577.9628846861899, 482.48946418569096, 278.690184388802, 328.2096724687989, 565.105951619276, 316.6649591167322, 453.4355752746023, 335.16876892805965, 485.92002619822574, 534.0481363886962, 479.70360998017594, 443.9566075957933, 462.20526858891157, 475.2774876480446, 436.9045246450302, 426.42001239344745, 521.2120756008419, 542.4374337570365, 578.9159234522334, 475.540977313194, 455.4738450915824, 444.0044397109232, 453.6460228756289, 494.7900172356384, 485.4831095506553, 533.1960960137043, 453.71493088139226, 528.5686914349437, 473.65846311084806, 457.33855963526105, 459.19520198583535, 478.97852406174127, 534.3170486414795, 530.4967813284378, 468.548511549164, 495.67717756490117, 543.8285879792546, 484.9687163161289, 430.87799969373856, 505.7773901113735, 359.19303897452596, 537.899373273336, 386.77966667770727, 400.7172735636256, 289.56501196655404, 494.2113286118133, 152.65086783152555, 579.8000526551612, 417.1115655950872, 576.2753800119311, 480.44307697029666, 516.8645620815108, 503.22545614151284, 501.64149870986364, 384.3488862786179, 442.9656113196322, 479.58952855289795, 472.3024536253619, 513.2410288143667, 610.081823368394, 603.6911207310089, 668.4293028475163, 628.2946992564773, 528.4795707310844, 546.5699156100666, 610.2369440172359, 470.53787526700427, 466.4998269396933, 378.5601390244619, 462.5222298441236, 316.32652210978586, 659.5546914766222, 482.6973203338413, 529.7317858963504, 505.8529022451495, 342.2024463518466, 571.4045298514042, 668.6367013136266, 565.3764438843297, 575.8837245778525, 502.7003839003146, 554.3632965853346, 528.7365059215347, 481.25406279130823, 634.7851849228042, 555.4420187452766, 463.7393594705388, 570.1825738347392, 597.1777369849101, 521.4790322752634]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4599891131804037, "mean_inference_ms": 4.216864549251289, "mean_action_processing_ms": 0.6149414901317196, "mean_env_wait_ms": 0.5300090313006557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07477593421936035, "StateBufferConnector_ms": 0.06644630432128906, "ViewRequirementAgentConnector_ms": 1.241598129272461}, "num_episodes": 18, "episode_return_max": 2099.2608120977698, "episode_return_min": 996.7960148480913, "episode_return_mean": 1893.1580469526223, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 96.9120667492285, "num_env_steps_trained_throughput_per_sec": 96.9120667492285, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 42480.462, "restore_workers_time_ms": 0.023, "training_step_time_ms": 42480.355, "sample_time_ms": 10877.989, "learn_time_ms": 31529.506, "learn_throughput": 126.865, "synch_weights_time_ms": 70.175}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "8abce_00000", "date": "2024-08-16_11-41-29", "timestamp": 1723788689, "time_this_iter_s": 41.37076473236084, "time_total_s": 1199.2121510505676, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43f8310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1199.2121510505676, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 53.65344827586207, "ram_util_percent": 81.88620689655173}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9231808491800195, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.384501581343393, "policy_loss": -0.004988173131520549, "vf_loss": 9.388197745974102, "vf_explained_var": -0.1273014418977909, "kl": 0.012919943938752126, "entropy": 1.3061770410134048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4424629078103752, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.697016393066082, "policy_loss": -0.0053595115196590545, "vf_loss": 9.702064123607817, "vf_explained_var": -0.025007013606015968, "kl": 0.006235875263346533, "entropy": 0.7722434518513857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 2134.524504641323, "episode_reward_min": 996.7960148480913, "episode_reward_mean": 1915.4478557085008, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 227.15357298176679, "predator_policy": 45.03731939053044}, "policy_reward_max": {"prey_policy": 694.1748303447642, "predator_policy": 668.6367013136266}, "policy_reward_mean": {"prey_policy": 491.10619637734214, "predator_policy": 466.6177314769083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1882.4579147240324, 1860.3754994632777, 1938.2199449901045, 1760.6764098219078, 1697.8010834605755, 996.7960148480913, 1856.7955288916605, 1908.107235367315, 2056.4132084567464, 1676.8107266560046, 1596.8855677901047, 2006.2599982666552, 1870.4873208186245, 1981.3532684911504, 1867.8838074220048, 1987.7469487906471, 1869.8388420401616, 1776.8183378578083, 1790.7273213260014, 1749.1783256787744, 1949.256475601875, 2029.8438707255293, 2018.6240484982586, 1936.4689973198952, 2067.0781457934077, 2026.2532695163538, 1856.2639481492686, 1990.9061741668384, 1742.628759160835, 1962.6075842161745, 1912.0405354810057, 1966.4557487718066, 1931.4742169778044, 1916.081317777536, 1705.5377304102522, 1836.342887586737, 1784.9508994110047, 1930.7475814986415, 1983.9243329570143, 1995.6017311754529, 2031.8005642858545, 1988.2079094643093, 1816.3855830347159, 1868.552119818714, 1968.8764008065, 2045.1436694251618, 1963.241594013036, 1921.155235232459, 2037.8492819613084, 2046.602002389601, 1945.7909497294788, 2005.4921086510046, 2070.743139023187, 1826.6836924139527, 1543.3565372090532, 1829.3623692839135, 1746.9108675634398, 2011.4228307385358, 2025.7580795687093, 1891.8688231385263, 1878.2625632115169, 2099.2608120977698, 1967.562526842561, 1922.6297771169302, 2060.567042703981, 1996.5249100014203, 1952.361231637068, 2004.5493769934626, 1738.9940078732204, 1923.0239258336092, 1846.3735336636564, 2016.4175398269103, 1918.0817344117827, 1929.9314575882718, 2055.381434700253, 1895.4693762729723, 1879.4147093904041, 1976.210751098719, 1946.8303720104266, 1792.0888864920978, 2004.7751924290487, 1958.5984501488456, 1944.0470623765357, 2026.2413740391373, 1778.606258517635, 1812.2433039904556, 2039.4943342735967, 1940.1195202704998, 1940.1246246199953, 1961.3001378186982, 1969.4419299349659, 2134.524504641323, 1990.4248977135185, 1993.294523678473, 2041.8585432403424, 1920.5982832963537, 2016.0285050558512, 2028.6122466321854, 2004.8696173404792, 1979.7209729563058], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [607.427976681069, 574.4706584995917, 476.5826629576981, 585.4478536205805, 456.9946999424761, 617.2682862738006, 497.51791413378123, 544.0396017219568, 494.0897270663718, 436.75137166958814, 364.9603014993299, 340.1473181456656, 561.6897140919665, 401.5122897740842, 591.1538685157416, 574.4196842724343, 591.0202586179189, 489.5459234364782, 525.1448491896733, 357.00334753911363, 411.77662768476137, 647.2983384976658, 558.2425607047267, 486.89521898839513, 453.81851753257257, 592.9295668183245, 508.9496152900931, 584.964659345962, 455.1656196624326, 578.3667581715699, 524.4980438562658, 410.69810090920765, 624.5107391734381, 567.7146923386373, 557.0916290418285, 496.19674771612216, 496.3827598510803, 571.1118132212482, 652.0833573205899, 681.1700328231468, 592.1991964122443, 553.1055162245196, 640.8018414135045, 544.9325644118992, 550.6336572412333, 329.78594855477377, 541.1134014957075, 556.8385719688187, 517.0141161499832, 537.6811051595399, 523.2510477263178, 374.78766121587876, 492.73558161972227, 535.2599936417083, 535.0048127978446, 671.3897697170308, 606.1786061043545, 446.6704971571211, 596.4551351474789, 529.7946385864437, 398.37073093455297, 421.0656243318919, 525.0013022826166, 477.61694907317553, 452.8517228390706, 484.80878739067555, 399.2665445821167, 456.3624243235394, 483.2843376724923, 615.3535358801594, 480.29514441185484, 474.2768324388742, 460.0407976266848, 536.3057575816576, 493.39831158698587, 417.38110732473245, 573.6354875795555, 486.62862780148794, 563.6575291318932, 494.46144580660507, 532.1438184785505, 636.3322087688288, 497.1697781825367, 427.3886219238954, 417.7008013751988, 344.22788089408886, 481.28347458639485, 487.7903604298164, 508.78635786060084, 511.65400283463106, 400.9446627183385, 625.5198011424641, 387.5349674074794, 593.4230042892194, 476.3449836710676, 513.813228815282, 556.0089822886708, 543.666573625063, 452.3887259792005, 529.3994464404814, 453.8741041408753, 527.6911564745386, 493.0171024747513, 483.67770188087104, 581.0549032026546, 553.0328460154194, 469.45424932851154, 460.1370308375822, 227.15357298176679, 528.7060239859546, 500.80802869273725, 544.7780000128091, 459.89500256119, 554.5649445155626, 539.555534385449, 478.4803507460699, 564.2881338221141, 464.16230669478597, 388.0766713207579, 498.92519696639255, 484.17063125255333, 566.7774343607143, 528.3282415540101, 619.0405883654997, 469.36036876272897, 374.8793058970737, 302.036996375344, 348.4723571630594, 405.36629263534115, 498.4264800810761, 292.06544051526936, 547.6526098588464, 532.9846365641774, 482.33889286619467, 505.34479066813674, 658.1222174567392, 362.33334874690723, 400.7794455399065, 480.42643835218973, 430.16838125122825, 531.9919184327179, 466.32626663394257, 454.00387164616126, 322.37243701572004, 346.04516681556316, 430.77639913403874, 364.58563236280014, 508.28214473982456, 548.0169118617973, 497.3739541256147, 349.38200795430475, 355.8601646505861, 436.35102237676375, 409.14175370836284, 451.07192385824254, 406.48205798030295, 542.0442237194168, 417.6281913718164, 576.0123911133107, 523.5270001158531, 423.99644866023345, 493.97981366335256, 512.4263649146302, 540.3374245339547, 530.5388938089199, 514.43582071385, 510.9972086052959, 501.46602557079007, 492.2881693743207, 393.52813053128983, 281.64572082294137, 348.85543411092186, 463.6319847394002, 458.4657139513828, 427.2645115437498, 470.32711529709064, 481.82468633485905, 474.99158364884215, 363.4331672250679, 418.6440488249677, 432.3369523530636, 462.88470690989595, 480.3354437291645, 694.1748303447642, 430.1129927893524, 455.4355384738383, 493.3195747184171, 431.2084649158256, 619.583058727073, 531.0174689458984, 492.13077462860315, 515.6941642597734, 468.4957633905399, 491.02298870625475, 476.31054188331575, 431.4392990304427, 373.85078915715644, 452.49029181475805, 635.4586566650898, 512.9034565684509], "policy_predator_policy_reward": [422.92865000836304, 277.6306295350113, 463.8867724154237, 334.45821046957593, 492.2760231267211, 371.6809356471054, 424.79084258205506, 294.3280513841132, 392.5405323352806, 374.41945238933613, 45.03731939053044, 246.6510758125663, 491.3248313117831, 402.26869371382634, 335.8317553500354, 406.70192722910474, 478.2043705697389, 497.64265583261306, 322.1041239514523, 472.5584059757644, 178.9449819081866, 358.86561969949105, 504.8372519065097, 456.28496666702404, 392.819888984494, 430.9193474832322, 471.43923784418877, 415.9997560109082, 274.2599754571263, 560.0914541308761, 585.5225868483741, 467.0282171767996, 318.5484567085151, 359.06495381957035, 446.36497916804996, 277.16498193180695, 401.2816476919331, 321.9511005617416, 180.66195311546002, 235.26298241957568, 399.0916824507801, 404.8600805143323, 385.897446189869, 458.2120187102533, 548.6696595368271, 589.534783165428, 484.08216665960435, 354.4348571957659, 499.13158697856187, 513.2513375053214, 537.8405747360848, 590.3739858380721, 450.69399866307975, 377.574374224756, 338.9671592493752, 445.5444324025891, 362.7180384446278, 327.0616174547324, 448.79178754565595, 387.5660229365951, 540.2987223192274, 552.3054578953348, 475.68937826177074, 488.14811915424315, 440.0337309085632, 553.7799758394941, 577.9628846861899, 482.48946418569096, 278.690184388802, 328.2096724687989, 565.105951619276, 316.6649591167322, 453.4355752746023, 335.16876892805965, 485.92002619822574, 534.0481363886962, 479.70360998017594, 443.9566075957933, 462.20526858891157, 475.2774876480446, 436.9045246450302, 426.42001239344745, 521.2120756008419, 542.4374337570365, 578.9159234522334, 475.540977313194, 455.4738450915824, 444.0044397109232, 453.6460228756289, 494.7900172356384, 485.4831095506553, 533.1960960137043, 453.71493088139226, 528.5686914349437, 473.65846311084806, 457.33855963526105, 459.19520198583535, 478.97852406174127, 534.3170486414795, 530.4967813284378, 468.548511549164, 495.67717756490117, 543.8285879792546, 484.9687163161289, 430.87799969373856, 505.7773901113735, 359.19303897452596, 537.899373273336, 386.77966667770727, 400.7172735636256, 289.56501196655404, 494.2113286118133, 152.65086783152555, 579.8000526551612, 417.1115655950872, 576.2753800119311, 480.44307697029666, 516.8645620815108, 503.22545614151284, 501.64149870986364, 384.3488862786179, 442.9656113196322, 479.58952855289795, 472.3024536253619, 513.2410288143667, 610.081823368394, 603.6911207310089, 668.4293028475163, 628.2946992564773, 528.4795707310844, 546.5699156100666, 610.2369440172359, 470.53787526700427, 466.4998269396933, 378.5601390244619, 462.5222298441236, 316.32652210978586, 659.5546914766222, 482.6973203338413, 529.7317858963504, 505.8529022451495, 342.2024463518466, 571.4045298514042, 668.6367013136266, 565.3764438843297, 575.8837245778525, 502.7003839003146, 554.3632965853346, 528.7365059215347, 481.25406279130823, 634.7851849228042, 555.4420187452766, 463.7393594705388, 570.1825738347392, 597.1777369849101, 521.4790322752634, 519.0171269359058, 468.14082998328604, 273.6134489729994, 418.9360462899343, 517.4726157571714, 569.3263143482917, 489.55724466644375, 416.2774160338169, 461.4284032207853, 437.64394463297964, 545.8553371982298, 467.92280266482106, 471.27790615688207, 421.5120524551398, 602.5630365496663, 579.1791125069261, 585.0525836987139, 532.3440518840976, 539.4588641482968, 503.069029281362, 462.0510188050319, 521.257335831261, 599.9564328746475, 579.2664888940164, 526.3086753428953, 547.9115953291114, 485.0528499056846, 474.9613806617105, 558.9331758376369, 545.9431906126898, 577.4241100152781, 491.34237402895286, 441.83723961083433, 449.4207759565359, 399.22362781108717, 513.549716596888, 567.935640163075, 488.5741127959815, 571.7190285556263, 549.1433771627989, 606.9213066745414, 571.6072296940175, 423.0594184440075, 408.29944127875484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.537873275172138, "mean_inference_ms": 4.4240340447876285, "mean_action_processing_ms": 0.6458386681209076, "mean_env_wait_ms": 0.5577165100682882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07068800926208496, "StateBufferConnector_ms": 0.05899226665496826, "ViewRequirementAgentConnector_ms": 1.1177213191986084}, "num_episodes": 22, "episode_return_max": 2134.524504641323, "episode_return_min": 996.7960148480913, "episode_return_mean": 1915.4478557085008, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 93.04363094487394, "num_env_steps_trained_throughput_per_sec": 93.04363094487394, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 42547.794, "restore_workers_time_ms": 0.023, "training_step_time_ms": 42547.686, "sample_time_ms": 10881.018, "learn_time_ms": 31594.357, "learn_throughput": 126.605, "synch_weights_time_ms": 69.634}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "8abce_00000", "date": "2024-08-16_11-42-12", "timestamp": 1723788732, "time_this_iter_s": 43.024765968322754, "time_total_s": 1242.2369170188904, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43a1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1242.2369170188904, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 54.35901639344262, "ram_util_percent": 81.92950819672132}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3592373244030767, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.087925477507254, "policy_loss": -0.004689135283685078, "vf_loss": 9.090945695443128, "vf_explained_var": -0.1876968346890949, "kl": 0.016689061397840415, "entropy": 1.296234408194426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3670861921140125, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.765850929482273, "policy_loss": -0.0032134114858255814, "vf_loss": 9.768753120886586, "vf_explained_var": 0.008319493576332375, "kl": 0.006224687578503916, "entropy": 0.7864330682174239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 2134.524504641323, "episode_reward_min": 1543.3565372090532, "episode_reward_mean": 1943.9464129502576, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 166.48815693394283, "predator_policy": 152.65086783152555}, "policy_reward_max": {"prey_policy": 694.1748303447642, "predator_policy": 668.6367013136266}, "policy_reward_mean": {"prey_policy": 471.0346634580099, "predator_policy": 500.93854301711906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1936.4689973198952, 2067.0781457934077, 2026.2532695163538, 1856.2639481492686, 1990.9061741668384, 1742.628759160835, 1962.6075842161745, 1912.0405354810057, 1966.4557487718066, 1931.4742169778044, 1916.081317777536, 1705.5377304102522, 1836.342887586737, 1784.9508994110047, 1930.7475814986415, 1983.9243329570143, 1995.6017311754529, 2031.8005642858545, 1988.2079094643093, 1816.3855830347159, 1868.552119818714, 1968.8764008065, 2045.1436694251618, 1963.241594013036, 1921.155235232459, 2037.8492819613084, 2046.602002389601, 1945.7909497294788, 2005.4921086510046, 2070.743139023187, 1826.6836924139527, 1543.3565372090532, 1829.3623692839135, 1746.9108675634398, 2011.4228307385358, 2025.7580795687093, 1891.8688231385263, 1878.2625632115169, 2099.2608120977698, 1967.562526842561, 1922.6297771169302, 2060.567042703981, 1996.5249100014203, 1952.361231637068, 2004.5493769934626, 1738.9940078732204, 1923.0239258336092, 1846.3735336636564, 2016.4175398269103, 1918.0817344117827, 1929.9314575882718, 2055.381434700253, 1895.4693762729723, 1879.4147093904041, 1976.210751098719, 1946.8303720104266, 1792.0888864920978, 2004.7751924290487, 1958.5984501488456, 1944.0470623765357, 2026.2413740391373, 1778.606258517635, 1812.2433039904556, 2039.4943342735967, 1940.1195202704998, 1940.1246246199953, 1961.3001378186982, 1969.4419299349659, 2134.524504641323, 1990.4248977135185, 1993.294523678473, 2041.8585432403424, 1920.5982832963537, 2016.0285050558512, 2028.6122466321854, 2004.8696173404792, 1979.7209729563058, 1927.4574517818412, 1961.0958778823258, 1742.815473300364, 1941.3806988935844, 1858.7443493201881, 2018.8673219277869, 1969.8385027034162, 1839.9132999914582, 2019.7695034757112, 2026.6607968824287, 1969.8808263185938, 2057.3198386117965, 1913.966598851184, 2008.281164992924, 1994.3240696388687, 1862.5264078048792, 1945.2301165544677, 1984.4930766909602, 2039.2040983625407, 1999.6268881529224, 2017.6806815189686, 1899.0611099622631, 1981.0752705435523], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [541.1134014957075, 556.8385719688187, 517.0141161499832, 537.6811051595399, 523.2510477263178, 374.78766121587876, 492.73558161972227, 535.2599936417083, 535.0048127978446, 671.3897697170308, 606.1786061043545, 446.6704971571211, 596.4551351474789, 529.7946385864437, 398.37073093455297, 421.0656243318919, 525.0013022826166, 477.61694907317553, 452.8517228390706, 484.80878739067555, 399.2665445821167, 456.3624243235394, 483.2843376724923, 615.3535358801594, 480.29514441185484, 474.2768324388742, 460.0407976266848, 536.3057575816576, 493.39831158698587, 417.38110732473245, 573.6354875795555, 486.62862780148794, 563.6575291318932, 494.46144580660507, 532.1438184785505, 636.3322087688288, 497.1697781825367, 427.3886219238954, 417.7008013751988, 344.22788089408886, 481.28347458639485, 487.7903604298164, 508.78635786060084, 511.65400283463106, 400.9446627183385, 625.5198011424641, 387.5349674074794, 593.4230042892194, 476.3449836710676, 513.813228815282, 556.0089822886708, 543.666573625063, 452.3887259792005, 529.3994464404814, 453.8741041408753, 527.6911564745386, 493.0171024747513, 483.67770188087104, 581.0549032026546, 553.0328460154194, 469.45424932851154, 460.1370308375822, 227.15357298176679, 528.7060239859546, 500.80802869273725, 544.7780000128091, 459.89500256119, 554.5649445155626, 539.555534385449, 478.4803507460699, 564.2881338221141, 464.16230669478597, 388.0766713207579, 498.92519696639255, 484.17063125255333, 566.7774343607143, 528.3282415540101, 619.0405883654997, 469.36036876272897, 374.8793058970737, 302.036996375344, 348.4723571630594, 405.36629263534115, 498.4264800810761, 292.06544051526936, 547.6526098588464, 532.9846365641774, 482.33889286619467, 505.34479066813674, 658.1222174567392, 362.33334874690723, 400.7794455399065, 480.42643835218973, 430.16838125122825, 531.9919184327179, 466.32626663394257, 454.00387164616126, 322.37243701572004, 346.04516681556316, 430.77639913403874, 364.58563236280014, 508.28214473982456, 548.0169118617973, 497.3739541256147, 349.38200795430475, 355.8601646505861, 436.35102237676375, 409.14175370836284, 451.07192385824254, 406.48205798030295, 542.0442237194168, 417.6281913718164, 576.0123911133107, 523.5270001158531, 423.99644866023345, 493.97981366335256, 512.4263649146302, 540.3374245339547, 530.5388938089199, 514.43582071385, 510.9972086052959, 501.46602557079007, 492.2881693743207, 393.52813053128983, 281.64572082294137, 348.85543411092186, 463.6319847394002, 458.4657139513828, 427.2645115437498, 470.32711529709064, 481.82468633485905, 474.99158364884215, 363.4331672250679, 418.6440488249677, 432.3369523530636, 462.88470690989595, 480.3354437291645, 694.1748303447642, 430.1129927893524, 455.4355384738383, 493.3195747184171, 431.2084649158256, 619.583058727073, 531.0174689458984, 492.13077462860315, 515.6941642597734, 468.4957633905399, 491.02298870625475, 476.31054188331575, 431.4392990304427, 373.85078915715644, 452.49029181475805, 635.4586566650898, 512.9034565684509, 629.1695879963953, 620.2635067383194, 602.5324876335627, 482.97434063671693, 166.48815693394283, 332.84496377504826, 469.41805689113875, 403.487396130574, 424.7948969734205, 324.18197101800604, 470.8186167344344, 462.7526456133123, 419.5848757501612, 406.48498197970673, 409.2362532936359, 425.87202225412136, 522.00537270496, 338.5696810088949, 589.0854615946258, 526.7347766694352, 383.6508567044854, 388.39669720142643, 509.2257855493481, 520.2737521791436, 359.88744645803, 371.5901689872421, 440.6440115864057, 470.6346806966535, 472.90129136807616, 337.31808220858875, 360.198386735206, 360.76925485738684, 406.8953455089862, 437.64076309973694, 460.1726760195059, 491.8684662949328, 411.0320326888013, 443.4455379901659, 432.47921324405166, 338.18071375275395, 380.17764319615213, 429.72380636898544, 504.47986469522897, 442.33016839016193, 448.96568022323936, 514.0234686540257], "policy_predator_policy_reward": [484.08216665960435, 354.4348571957659, 499.13158697856187, 513.2513375053214, 537.8405747360848, 590.3739858380721, 450.69399866307975, 377.574374224756, 338.9671592493752, 445.5444324025891, 362.7180384446278, 327.0616174547324, 448.79178754565595, 387.5660229365951, 540.2987223192274, 552.3054578953348, 475.68937826177074, 488.14811915424315, 440.0337309085632, 553.7799758394941, 577.9628846861899, 482.48946418569096, 278.690184388802, 328.2096724687989, 565.105951619276, 316.6649591167322, 453.4355752746023, 335.16876892805965, 485.92002619822574, 534.0481363886962, 479.70360998017594, 443.9566075957933, 462.20526858891157, 475.2774876480446, 436.9045246450302, 426.42001239344745, 521.2120756008419, 542.4374337570365, 578.9159234522334, 475.540977313194, 455.4738450915824, 444.0044397109232, 453.6460228756289, 494.7900172356384, 485.4831095506553, 533.1960960137043, 453.71493088139226, 528.5686914349437, 473.65846311084806, 457.33855963526105, 459.19520198583535, 478.97852406174127, 534.3170486414795, 530.4967813284378, 468.548511549164, 495.67717756490117, 543.8285879792546, 484.9687163161289, 430.87799969373856, 505.7773901113735, 359.19303897452596, 537.899373273336, 386.77966667770727, 400.7172735636256, 289.56501196655404, 494.2113286118133, 152.65086783152555, 579.8000526551612, 417.1115655950872, 576.2753800119311, 480.44307697029666, 516.8645620815108, 503.22545614151284, 501.64149870986364, 384.3488862786179, 442.9656113196322, 479.58952855289795, 472.3024536253619, 513.2410288143667, 610.081823368394, 603.6911207310089, 668.4293028475163, 628.2946992564773, 528.4795707310844, 546.5699156100666, 610.2369440172359, 470.53787526700427, 466.4998269396933, 378.5601390244619, 462.5222298441236, 316.32652210978586, 659.5546914766222, 482.6973203338413, 529.7317858963504, 505.8529022451495, 342.2024463518466, 571.4045298514042, 668.6367013136266, 565.3764438843297, 575.8837245778525, 502.7003839003146, 554.3632965853346, 528.7365059215347, 481.25406279130823, 634.7851849228042, 555.4420187452766, 463.7393594705388, 570.1825738347392, 597.1777369849101, 521.4790322752634, 519.0171269359058, 468.14082998328604, 273.6134489729994, 418.9360462899343, 517.4726157571714, 569.3263143482917, 489.55724466644375, 416.2774160338169, 461.4284032207853, 437.64394463297964, 545.8553371982298, 467.92280266482106, 471.27790615688207, 421.5120524551398, 602.5630365496663, 579.1791125069261, 585.0525836987139, 532.3440518840976, 539.4588641482968, 503.069029281362, 462.0510188050319, 521.257335831261, 599.9564328746475, 579.2664888940164, 526.3086753428953, 547.9115953291114, 485.0528499056846, 474.9613806617105, 558.9331758376369, 545.9431906126898, 577.4241100152781, 491.34237402895286, 441.83723961083433, 449.4207759565359, 399.22362781108717, 513.549716596888, 567.935640163075, 488.5741127959815, 571.7190285556263, 549.1433771627989, 606.9213066745414, 571.6072296940175, 423.0594184440075, 408.29944127875484, 289.57168152660165, 388.45267552052326, 433.1130019052401, 442.47604770680795, 624.164548803957, 619.3178037874155, 477.23318697074717, 591.2420589011247, 513.6053817519113, 596.162099576852, 529.2246847078401, 556.0713748722006, 570.3886059267952, 573.3800390467499, 495.02167641231176, 509.78334803138944, 544.3275069433331, 614.8669428185211, 482.3922525521671, 428.4483060662039, 661.7656322174284, 536.0676401952518, 441.6461049781856, 586.1741959051201, 640.2356156251343, 542.2533677807809, 522.3117246451334, 574.6907480647305, 609.5304490522706, 574.5742470099328, 575.2178257817061, 566.3409404305798, 632.0446018338527, 468.64940611188825, 513.3895254770164, 519.0624088995055, 588.1960841992769, 596.5304434842982, 605.700150276088, 623.2668108800269, 613.4609807760964, 594.3182511777364, 477.88613050660035, 474.36494637027, 542.1164117400964, 475.96970992619003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.605768590417468, "mean_inference_ms": 4.603316806572709, "mean_action_processing_ms": 0.67266402487315, "mean_env_wait_ms": 0.5814018996162218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06350576877593994, "StateBufferConnector_ms": 0.012017250061035156, "ViewRequirementAgentConnector_ms": 1.0318803787231445}, "num_episodes": 23, "episode_return_max": 2134.524504641323, "episode_return_min": 1543.3565372090532, "episode_return_mean": 1943.9464129502576, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 92.5945522696279, "num_env_steps_trained_throughput_per_sec": 92.5945522696279, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 42431.637, "restore_workers_time_ms": 0.024, "training_step_time_ms": 42431.552, "sample_time_ms": 10605.921, "learn_time_ms": 31757.026, "learn_throughput": 125.956, "synch_weights_time_ms": 66.127}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "8abce_00000", "date": "2024-08-16_11-42-56", "timestamp": 1723788776, "time_this_iter_s": 43.24363899230957, "time_total_s": 1285.4805560112, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a55430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1285.4805560112, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 55.221311475409834, "ram_util_percent": 82.27704918032786}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.161199319646472, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.085446047909045, "policy_loss": -0.006520811146834777, "vf_loss": 9.089819011486396, "vf_explained_var": -0.17456004446145718, "kl": 0.021478510164864434, "entropy": 1.3229089060157695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2332104887596513, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.77189958511837, "policy_loss": -0.0024157036551663643, "vf_loss": 9.774009347340417, "vf_explained_var": -0.023140437703914742, "kl": 0.006118405706983108, "entropy": 0.8001694357584394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 2134.524504641323, "episode_reward_min": 1543.3565372090532, "episode_reward_mean": 1952.7938532127257, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 166.48815693394283, "predator_policy": 152.65086783152555}, "policy_reward_max": {"prey_policy": 694.1748303447642, "predator_policy": 682.9503033793883}, "policy_reward_mean": {"prey_policy": 459.4500236638207, "predator_policy": 516.9469029425422}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1988.2079094643093, 1816.3855830347159, 1868.552119818714, 1968.8764008065, 2045.1436694251618, 1963.241594013036, 1921.155235232459, 2037.8492819613084, 2046.602002389601, 1945.7909497294788, 2005.4921086510046, 2070.743139023187, 1826.6836924139527, 1543.3565372090532, 1829.3623692839135, 1746.9108675634398, 2011.4228307385358, 2025.7580795687093, 1891.8688231385263, 1878.2625632115169, 2099.2608120977698, 1967.562526842561, 1922.6297771169302, 2060.567042703981, 1996.5249100014203, 1952.361231637068, 2004.5493769934626, 1738.9940078732204, 1923.0239258336092, 1846.3735336636564, 2016.4175398269103, 1918.0817344117827, 1929.9314575882718, 2055.381434700253, 1895.4693762729723, 1879.4147093904041, 1976.210751098719, 1946.8303720104266, 1792.0888864920978, 2004.7751924290487, 1958.5984501488456, 1944.0470623765357, 2026.2413740391373, 1778.606258517635, 1812.2433039904556, 2039.4943342735967, 1940.1195202704998, 1940.1246246199953, 1961.3001378186982, 1969.4419299349659, 2134.524504641323, 1990.4248977135185, 1993.294523678473, 2041.8585432403424, 1920.5982832963537, 2016.0285050558512, 2028.6122466321854, 2004.8696173404792, 1979.7209729563058, 1927.4574517818412, 1961.0958778823258, 1742.815473300364, 1941.3806988935844, 1858.7443493201881, 2018.8673219277869, 1969.8385027034162, 1839.9132999914582, 2019.7695034757112, 2026.6607968824287, 1969.8808263185938, 2057.3198386117965, 1913.966598851184, 2008.281164992924, 1994.3240696388687, 1862.5264078048792, 1945.2301165544677, 1984.4930766909602, 2039.2040983625407, 1999.6268881529224, 2017.6806815189686, 1899.0611099622631, 1981.0752705435523, 1856.5304325881561, 1950.3842238096943, 1974.8155248083056, 1956.3242488452197, 1981.9683431831777, 1908.3483826177744, 1936.7801458198458, 1896.3864370435074, 2019.132439193326, 2101.762326666191, 2034.506960374457, 1992.5737167637858, 1963.3958489375023, 1993.1373371724699, 1919.9209688035196, 2034.0837856549974, 1957.1820058873352, 1984.675322733416], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [497.1697781825367, 427.3886219238954, 417.7008013751988, 344.22788089408886, 481.28347458639485, 487.7903604298164, 508.78635786060084, 511.65400283463106, 400.9446627183385, 625.5198011424641, 387.5349674074794, 593.4230042892194, 476.3449836710676, 513.813228815282, 556.0089822886708, 543.666573625063, 452.3887259792005, 529.3994464404814, 453.8741041408753, 527.6911564745386, 493.0171024747513, 483.67770188087104, 581.0549032026546, 553.0328460154194, 469.45424932851154, 460.1370308375822, 227.15357298176679, 528.7060239859546, 500.80802869273725, 544.7780000128091, 459.89500256119, 554.5649445155626, 539.555534385449, 478.4803507460699, 564.2881338221141, 464.16230669478597, 388.0766713207579, 498.92519696639255, 484.17063125255333, 566.7774343607143, 528.3282415540101, 619.0405883654997, 469.36036876272897, 374.8793058970737, 302.036996375344, 348.4723571630594, 405.36629263534115, 498.4264800810761, 292.06544051526936, 547.6526098588464, 532.9846365641774, 482.33889286619467, 505.34479066813674, 658.1222174567392, 362.33334874690723, 400.7794455399065, 480.42643835218973, 430.16838125122825, 531.9919184327179, 466.32626663394257, 454.00387164616126, 322.37243701572004, 346.04516681556316, 430.77639913403874, 364.58563236280014, 508.28214473982456, 548.0169118617973, 497.3739541256147, 349.38200795430475, 355.8601646505861, 436.35102237676375, 409.14175370836284, 451.07192385824254, 406.48205798030295, 542.0442237194168, 417.6281913718164, 576.0123911133107, 523.5270001158531, 423.99644866023345, 493.97981366335256, 512.4263649146302, 540.3374245339547, 530.5388938089199, 514.43582071385, 510.9972086052959, 501.46602557079007, 492.2881693743207, 393.52813053128983, 281.64572082294137, 348.85543411092186, 463.6319847394002, 458.4657139513828, 427.2645115437498, 470.32711529709064, 481.82468633485905, 474.99158364884215, 363.4331672250679, 418.6440488249677, 432.3369523530636, 462.88470690989595, 480.3354437291645, 694.1748303447642, 430.1129927893524, 455.4355384738383, 493.3195747184171, 431.2084649158256, 619.583058727073, 531.0174689458984, 492.13077462860315, 515.6941642597734, 468.4957633905399, 491.02298870625475, 476.31054188331575, 431.4392990304427, 373.85078915715644, 452.49029181475805, 635.4586566650898, 512.9034565684509, 629.1695879963953, 620.2635067383194, 602.5324876335627, 482.97434063671693, 166.48815693394283, 332.84496377504826, 469.41805689113875, 403.487396130574, 424.7948969734205, 324.18197101800604, 470.8186167344344, 462.7526456133123, 419.5848757501612, 406.48498197970673, 409.2362532936359, 425.87202225412136, 522.00537270496, 338.5696810088949, 589.0854615946258, 526.7347766694352, 383.6508567044854, 388.39669720142643, 509.2257855493481, 520.2737521791436, 359.88744645803, 371.5901689872421, 440.6440115864057, 470.6346806966535, 472.90129136807616, 337.31808220858875, 360.198386735206, 360.76925485738684, 406.8953455089862, 437.64076309973694, 460.1726760195059, 491.8684662949328, 411.0320326888013, 443.4455379901659, 432.47921324405166, 338.18071375275395, 380.17764319615213, 429.72380636898544, 504.47986469522897, 442.33016839016193, 448.96568022323936, 514.0234686540257, 517.9304205365039, 470.6028331150929, 625.9027415751813, 641.1487311923197, 486.2395634405553, 376.7859049762575, 388.8519683025963, 496.80470942484936, 329.7090356838671, 483.00873031038986, 446.4112436011626, 468.3990022379828, 360.36083103096985, 310.51046510171005, 381.9989622184334, 512.0689664404041, 390.56375565218593, 400.22828222968957, 632.1718498182812, 388.8080362957501, 450.77509760700616, 507.53211216649305, 371.39460125989115, 308.67570020826093, 430.80950893263855, 269.6527291147279, 435.2569252759767, 491.05837963341753, 571.1579080274952, 372.1630628383377, 597.2022191879043, 529.4864229882149, 290.9131902617114, 420.63867440782724, 450.0692782455661, 404.49416415844655], "policy_predator_policy_reward": [521.2120756008419, 542.4374337570365, 578.9159234522334, 475.540977313194, 455.4738450915824, 444.0044397109232, 453.6460228756289, 494.7900172356384, 485.4831095506553, 533.1960960137043, 453.71493088139226, 528.5686914349437, 473.65846311084806, 457.33855963526105, 459.19520198583535, 478.97852406174127, 534.3170486414795, 530.4967813284378, 468.548511549164, 495.67717756490117, 543.8285879792546, 484.9687163161289, 430.87799969373856, 505.7773901113735, 359.19303897452596, 537.899373273336, 386.77966667770727, 400.7172735636256, 289.56501196655404, 494.2113286118133, 152.65086783152555, 579.8000526551612, 417.1115655950872, 576.2753800119311, 480.44307697029666, 516.8645620815108, 503.22545614151284, 501.64149870986364, 384.3488862786179, 442.9656113196322, 479.58952855289795, 472.3024536253619, 513.2410288143667, 610.081823368394, 603.6911207310089, 668.4293028475163, 628.2946992564773, 528.4795707310844, 546.5699156100666, 610.2369440172359, 470.53787526700427, 466.4998269396933, 378.5601390244619, 462.5222298441236, 316.32652210978586, 659.5546914766222, 482.6973203338413, 529.7317858963504, 505.8529022451495, 342.2024463518466, 571.4045298514042, 668.6367013136266, 565.3764438843297, 575.8837245778525, 502.7003839003146, 554.3632965853346, 528.7365059215347, 481.25406279130823, 634.7851849228042, 555.4420187452766, 463.7393594705388, 570.1825738347392, 597.1777369849101, 521.4790322752634, 519.0171269359058, 468.14082998328604, 273.6134489729994, 418.9360462899343, 517.4726157571714, 569.3263143482917, 489.55724466644375, 416.2774160338169, 461.4284032207853, 437.64394463297964, 545.8553371982298, 467.92280266482106, 471.27790615688207, 421.5120524551398, 602.5630365496663, 579.1791125069261, 585.0525836987139, 532.3440518840976, 539.4588641482968, 503.069029281362, 462.0510188050319, 521.257335831261, 599.9564328746475, 579.2664888940164, 526.3086753428953, 547.9115953291114, 485.0528499056846, 474.9613806617105, 558.9331758376369, 545.9431906126898, 577.4241100152781, 491.34237402895286, 441.83723961083433, 449.4207759565359, 399.22362781108717, 513.549716596888, 567.935640163075, 488.5741127959815, 571.7190285556263, 549.1433771627989, 606.9213066745414, 571.6072296940175, 423.0594184440075, 408.29944127875484, 289.57168152660165, 388.45267552052326, 433.1130019052401, 442.47604770680795, 624.164548803957, 619.3178037874155, 477.23318697074717, 591.2420589011247, 513.6053817519113, 596.162099576852, 529.2246847078401, 556.0713748722006, 570.3886059267952, 573.3800390467499, 495.02167641231176, 509.78334803138944, 544.3275069433331, 614.8669428185211, 482.3922525521671, 428.4483060662039, 661.7656322174284, 536.0676401952518, 441.6461049781856, 586.1741959051201, 640.2356156251343, 542.2533677807809, 522.3117246451334, 574.6907480647305, 609.5304490522706, 574.5742470099328, 575.2178257817061, 566.3409404305798, 632.0446018338527, 468.64940611188825, 513.3895254770164, 519.0624088995055, 588.1960841992769, 596.5304434842982, 605.700150276088, 623.2668108800269, 613.4609807760964, 594.3182511777364, 477.88613050660035, 474.36494637027, 542.1164117400964, 475.96970992619003, 430.05427676574027, 437.9429021708171, 300.98472099511537, 382.3480300470775, 546.9361389157701, 564.8539174757242, 546.1070948403047, 524.5604762774691, 665.7061106225962, 503.5444665663222, 507.4183472759625, 486.11978950266735, 648.5145413476987, 617.3943083394686, 430.2300631726131, 572.0884452120567, 620.0981607213299, 608.2422405901175, 551.6419521645554, 529.1404883876028, 575.7416708341563, 500.4580797668023, 677.0000749372726, 635.5033403583633, 682.9503033793883, 579.9833075107493, 507.66165860092326, 559.1603736621526, 509.14018571195606, 467.4598122257288, 402.5515831189076, 504.84356035997183, 654.9292226364045, 590.7009185813907, 559.2787774805943, 570.8331028488091]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6502926196524175, "mean_inference_ms": 4.722747786319416, "mean_action_processing_ms": 0.6903979132157017, "mean_env_wait_ms": 0.5964750728103391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01994144916534424, "StateBufferConnector_ms": 0.010598897933959961, "ViewRequirementAgentConnector_ms": 0.8214809894561768}, "num_episodes": 18, "episode_return_max": 2134.524504641323, "episode_return_min": 1543.3565372090532, "episode_return_mean": 1952.7938532127257, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 30.02957620112785, "num_env_steps_trained_throughput_per_sec": 30.02957620112785, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 51472.253, "restore_workers_time_ms": 0.024, "training_step_time_ms": 51472.165, "sample_time_ms": 10297.685, "learn_time_ms": 41115.731, "learn_throughput": 97.286, "synch_weights_time_ms": 56.247}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "8abce_00000", "date": "2024-08-16_11-45-09", "timestamp": 1723788909, "time_this_iter_s": 133.23895406723022, "time_total_s": 1418.7195100784302, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43f8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1418.7195100784302, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 63.300000000000004, "ram_util_percent": 82.38305084745764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9414940795570454, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.162419697090431, "policy_loss": -0.004416547906363294, "vf_loss": 9.164622011638823, "vf_explained_var": -0.06401622755817635, "kl": 0.014761627827646836, "entropy": 1.3342962650394945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2595741480667755, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.716380536114729, "policy_loss": -0.0014981660575522158, "vf_loss": 9.71767940823994, "vf_explained_var": -0.031975582100096205, "kl": 0.003985747470426485, "entropy": 0.7948547385672413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 2134.524504641323, "episode_reward_min": 1585.2300734628975, "episode_reward_mean": 1960.4556481885488, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 166.48815693394283, "predator_policy": 273.6134489729994}, "policy_reward_max": {"prey_policy": 694.1748303447642, "predator_policy": 704.2997493944719}, "policy_reward_mean": {"prey_policy": 453.58959602251736, "predator_policy": 526.6382280717568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1891.8688231385263, 1878.2625632115169, 2099.2608120977698, 1967.562526842561, 1922.6297771169302, 2060.567042703981, 1996.5249100014203, 1952.361231637068, 2004.5493769934626, 1738.9940078732204, 1923.0239258336092, 1846.3735336636564, 2016.4175398269103, 1918.0817344117827, 1929.9314575882718, 2055.381434700253, 1895.4693762729723, 1879.4147093904041, 1976.210751098719, 1946.8303720104266, 1792.0888864920978, 2004.7751924290487, 1958.5984501488456, 1944.0470623765357, 2026.2413740391373, 1778.606258517635, 1812.2433039904556, 2039.4943342735967, 1940.1195202704998, 1940.1246246199953, 1961.3001378186982, 1969.4419299349659, 2134.524504641323, 1990.4248977135185, 1993.294523678473, 2041.8585432403424, 1920.5982832963537, 2016.0285050558512, 2028.6122466321854, 2004.8696173404792, 1979.7209729563058, 1927.4574517818412, 1961.0958778823258, 1742.815473300364, 1941.3806988935844, 1858.7443493201881, 2018.8673219277869, 1969.8385027034162, 1839.9132999914582, 2019.7695034757112, 2026.6607968824287, 1969.8808263185938, 2057.3198386117965, 1913.966598851184, 2008.281164992924, 1994.3240696388687, 1862.5264078048792, 1945.2301165544677, 1984.4930766909602, 2039.2040983625407, 1999.6268881529224, 2017.6806815189686, 1899.0611099622631, 1981.0752705435523, 1856.5304325881561, 1950.3842238096943, 1974.8155248083056, 1956.3242488452197, 1981.9683431831777, 1908.3483826177744, 1936.7801458198458, 1896.3864370435074, 2019.132439193326, 2101.762326666191, 2034.506960374457, 1992.5737167637858, 1963.3958489375023, 1993.1373371724699, 1919.9209688035196, 2034.0837856549974, 1957.1820058873352, 1984.675322733416, 1985.7310990531248, 2022.1815620787695, 2045.9896102574014, 2035.6863079898176, 2044.0084967115683, 1945.1820279809292, 2041.0073536075572, 1585.2300734628975, 2070.1982157672264, 1999.351780278636, 1960.9745292089751, 1944.4940414114858, 1936.7597755454397, 1874.233350123806, 1985.718301661948, 1926.2194105663075, 2059.1797553675183, 1965.5681768359125], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [388.0766713207579, 498.92519696639255, 484.17063125255333, 566.7774343607143, 528.3282415540101, 619.0405883654997, 469.36036876272897, 374.8793058970737, 302.036996375344, 348.4723571630594, 405.36629263534115, 498.4264800810761, 292.06544051526936, 547.6526098588464, 532.9846365641774, 482.33889286619467, 505.34479066813674, 658.1222174567392, 362.33334874690723, 400.7794455399065, 480.42643835218973, 430.16838125122825, 531.9919184327179, 466.32626663394257, 454.00387164616126, 322.37243701572004, 346.04516681556316, 430.77639913403874, 364.58563236280014, 508.28214473982456, 548.0169118617973, 497.3739541256147, 349.38200795430475, 355.8601646505861, 436.35102237676375, 409.14175370836284, 451.07192385824254, 406.48205798030295, 542.0442237194168, 417.6281913718164, 576.0123911133107, 523.5270001158531, 423.99644866023345, 493.97981366335256, 512.4263649146302, 540.3374245339547, 530.5388938089199, 514.43582071385, 510.9972086052959, 501.46602557079007, 492.2881693743207, 393.52813053128983, 281.64572082294137, 348.85543411092186, 463.6319847394002, 458.4657139513828, 427.2645115437498, 470.32711529709064, 481.82468633485905, 474.99158364884215, 363.4331672250679, 418.6440488249677, 432.3369523530636, 462.88470690989595, 480.3354437291645, 694.1748303447642, 430.1129927893524, 455.4355384738383, 493.3195747184171, 431.2084649158256, 619.583058727073, 531.0174689458984, 492.13077462860315, 515.6941642597734, 468.4957633905399, 491.02298870625475, 476.31054188331575, 431.4392990304427, 373.85078915715644, 452.49029181475805, 635.4586566650898, 512.9034565684509, 629.1695879963953, 620.2635067383194, 602.5324876335627, 482.97434063671693, 166.48815693394283, 332.84496377504826, 469.41805689113875, 403.487396130574, 424.7948969734205, 324.18197101800604, 470.8186167344344, 462.7526456133123, 419.5848757501612, 406.48498197970673, 409.2362532936359, 425.87202225412136, 522.00537270496, 338.5696810088949, 589.0854615946258, 526.7347766694352, 383.6508567044854, 388.39669720142643, 509.2257855493481, 520.2737521791436, 359.88744645803, 371.5901689872421, 440.6440115864057, 470.6346806966535, 472.90129136807616, 337.31808220858875, 360.198386735206, 360.76925485738684, 406.8953455089862, 437.64076309973694, 460.1726760195059, 491.8684662949328, 411.0320326888013, 443.4455379901659, 432.47921324405166, 338.18071375275395, 380.17764319615213, 429.72380636898544, 504.47986469522897, 442.33016839016193, 448.96568022323936, 514.0234686540257, 517.9304205365039, 470.6028331150929, 625.9027415751813, 641.1487311923197, 486.2395634405553, 376.7859049762575, 388.8519683025963, 496.80470942484936, 329.7090356838671, 483.00873031038986, 446.4112436011626, 468.3990022379828, 360.36083103096985, 310.51046510171005, 381.9989622184334, 512.0689664404041, 390.56375565218593, 400.22828222968957, 632.1718498182812, 388.8080362957501, 450.77509760700616, 507.53211216649305, 371.39460125989115, 308.67570020826093, 430.80950893263855, 269.6527291147279, 435.2569252759767, 491.05837963341753, 571.1579080274952, 372.1630628383377, 597.2022191879043, 529.4864229882149, 290.9131902617114, 420.63867440782724, 450.0692782455661, 404.49416415844655, 313.91854655552874, 513.2554550565544, 301.36081648159933, 378.990112500745, 448.4396538353888, 396.4649861139683, 474.5690950409793, 521.1115671756436, 485.26106823046587, 472.18916084556116, 324.06063537083395, 301.34486426449115, 494.9215509359224, 610.3962670823258, 494.5166613012885, 207.41068100727819, 444.04627328910124, 402.3512894327106, 476.3100350358476, 333.31807522235323, 522.2973952240278, 535.3219595377358, 524.0900210857512, 581.8724678543762, 422.2528337489097, 434.0691706670652, 436.8240472980061, 661.6159592547932, 396.6579929478396, 547.7884657115169, 651.8531711991656, 566.2845266606046, 471.86003114860046, 446.6963851529454, 448.61792996418836, 424.95196672329826], "policy_predator_policy_reward": [503.22545614151284, 501.64149870986364, 384.3488862786179, 442.9656113196322, 479.58952855289795, 472.3024536253619, 513.2410288143667, 610.081823368394, 603.6911207310089, 668.4293028475163, 628.2946992564773, 528.4795707310844, 546.5699156100666, 610.2369440172359, 470.53787526700427, 466.4998269396933, 378.5601390244619, 462.5222298441236, 316.32652210978586, 659.5546914766222, 482.6973203338413, 529.7317858963504, 505.8529022451495, 342.2024463518466, 571.4045298514042, 668.6367013136266, 565.3764438843297, 575.8837245778525, 502.7003839003146, 554.3632965853346, 528.7365059215347, 481.25406279130823, 634.7851849228042, 555.4420187452766, 463.7393594705388, 570.1825738347392, 597.1777369849101, 521.4790322752634, 519.0171269359058, 468.14082998328604, 273.6134489729994, 418.9360462899343, 517.4726157571714, 569.3263143482917, 489.55724466644375, 416.2774160338169, 461.4284032207853, 437.64394463297964, 545.8553371982298, 467.92280266482106, 471.27790615688207, 421.5120524551398, 602.5630365496663, 579.1791125069261, 585.0525836987139, 532.3440518840976, 539.4588641482968, 503.069029281362, 462.0510188050319, 521.257335831261, 599.9564328746475, 579.2664888940164, 526.3086753428953, 547.9115953291114, 485.0528499056846, 474.9613806617105, 558.9331758376369, 545.9431906126898, 577.4241100152781, 491.34237402895286, 441.83723961083433, 449.4207759565359, 399.22362781108717, 513.549716596888, 567.935640163075, 488.5741127959815, 571.7190285556263, 549.1433771627989, 606.9213066745414, 571.6072296940175, 423.0594184440075, 408.29944127875484, 289.57168152660165, 388.45267552052326, 433.1130019052401, 442.47604770680795, 624.164548803957, 619.3178037874155, 477.23318697074717, 591.2420589011247, 513.6053817519113, 596.162099576852, 529.2246847078401, 556.0713748722006, 570.3886059267952, 573.3800390467499, 495.02167641231176, 509.78334803138944, 544.3275069433331, 614.8669428185211, 482.3922525521671, 428.4483060662039, 661.7656322174284, 536.0676401952518, 441.6461049781856, 586.1741959051201, 640.2356156251343, 542.2533677807809, 522.3117246451334, 574.6907480647305, 609.5304490522706, 574.5742470099328, 575.2178257817061, 566.3409404305798, 632.0446018338527, 468.64940611188825, 513.3895254770164, 519.0624088995055, 588.1960841992769, 596.5304434842982, 605.700150276088, 623.2668108800269, 613.4609807760964, 594.3182511777364, 477.88613050660035, 474.36494637027, 542.1164117400964, 475.96970992619003, 430.05427676574027, 437.9429021708171, 300.98472099511537, 382.3480300470775, 546.9361389157701, 564.8539174757242, 546.1070948403047, 524.5604762774691, 665.7061106225962, 503.5444665663222, 507.4183472759625, 486.11978950266735, 648.5145413476987, 617.3943083394686, 430.2300631726131, 572.0884452120567, 620.0981607213299, 608.2422405901175, 551.6419521645554, 529.1404883876028, 575.7416708341563, 500.4580797668023, 677.0000749372726, 635.5033403583633, 682.9503033793883, 579.9833075107493, 507.66165860092326, 559.1603736621526, 509.14018571195606, 467.4598122257288, 402.5515831189076, 504.84356035997183, 654.9292226364045, 590.7009185813907, 559.2787774805943, 570.8331028488091, 620.6089762949806, 537.9481211460608, 704.2997493944719, 637.5308837019537, 580.55493147007, 620.5300388379725, 505.0875341171615, 534.9181116560324, 588.5932055856244, 497.9650620499156, 669.1282019298585, 650.6483264157469, 511.4662812501007, 424.2232543392094, 450.61170575122947, 432.6910254031016, 600.4991160160295, 623.3015370293875, 567.8513817466452, 621.8722882737936, 457.76511497337674, 445.59005947383406, 439.8599392783863, 398.67161319297526, 538.205617601122, 542.2321535283418, 379.1409135438357, 396.65243002717256, 510.9349954159996, 530.3368475865896, 334.1856419050263, 373.8960708015098, 535.1452196788774, 605.4781193870941, 516.4818616101022, 575.5164185383231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.696653702659217, "mean_inference_ms": 4.855822490098856, "mean_action_processing_ms": 0.7099617666468646, "mean_env_wait_ms": 0.6136056984795678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030433297157287598, "StateBufferConnector_ms": 0.017594218254089355, "ViewRequirementAgentConnector_ms": 0.8028770685195923}, "num_episodes": 18, "episode_return_max": 2134.524504641323, "episode_return_min": 1585.2300734628975, "episode_return_mean": 1960.4556481885488, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.61754429654623, "num_env_steps_trained_throughput_per_sec": 6.61754429654623, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 107798.507, "restore_workers_time_ms": 0.026, "training_step_time_ms": 107798.418, "sample_time_ms": 10950.274, "learn_time_ms": 96801.203, "learn_throughput": 41.322, "synch_weights_time_ms": 44.518}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "8abce_00000", "date": "2024-08-16_11-55-13", "timestamp": 1723789513, "time_this_iter_s": 604.6090948581696, "time_total_s": 2023.3286049365997, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a19b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2023.3286049365997, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 57.36309523809523, "ram_util_percent": 80.70476190476191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.944730328031318, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.2500648458168, "policy_loss": -0.005557722705367105, "vf_loss": 9.253642016113119, "vf_explained_var": -0.14049533539348177, "kl": 0.013203735428350922, "entropy": 1.3025174839156015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6147319202542936, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.676270326483186, "policy_loss": -0.002252938397346981, "vf_loss": 9.678356135837616, "vf_explained_var": -0.0683794983164974, "kl": 0.006685147250781575, "entropy": 0.8087738835937762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 2134.524504641323, "episode_reward_min": 1481.6976208881113, "episode_reward_mean": 1943.0029605588636, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 166.48815693394283, "predator_policy": 287.82609343698795}, "policy_reward_max": {"prey_policy": 694.1748303447642, "predator_policy": 704.2997493944719}, "policy_reward_mean": {"prey_policy": 454.7438458511982, "predator_policy": 516.7576344282337}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1958.5984501488456, 1944.0470623765357, 2026.2413740391373, 1778.606258517635, 1812.2433039904556, 2039.4943342735967, 1940.1195202704998, 1940.1246246199953, 1961.3001378186982, 1969.4419299349659, 2134.524504641323, 1990.4248977135185, 1993.294523678473, 2041.8585432403424, 1920.5982832963537, 2016.0285050558512, 2028.6122466321854, 2004.8696173404792, 1979.7209729563058, 1927.4574517818412, 1961.0958778823258, 1742.815473300364, 1941.3806988935844, 1858.7443493201881, 2018.8673219277869, 1969.8385027034162, 1839.9132999914582, 2019.7695034757112, 2026.6607968824287, 1969.8808263185938, 2057.3198386117965, 1913.966598851184, 2008.281164992924, 1994.3240696388687, 1862.5264078048792, 1945.2301165544677, 1984.4930766909602, 2039.2040983625407, 1999.6268881529224, 2017.6806815189686, 1899.0611099622631, 1981.0752705435523, 1856.5304325881561, 1950.3842238096943, 1974.8155248083056, 1956.3242488452197, 1981.9683431831777, 1908.3483826177744, 1936.7801458198458, 1896.3864370435074, 2019.132439193326, 2101.762326666191, 2034.506960374457, 1992.5737167637858, 1963.3958489375023, 1993.1373371724699, 1919.9209688035196, 2034.0837856549974, 1957.1820058873352, 1984.675322733416, 1985.7310990531248, 2022.1815620787695, 2045.9896102574014, 2035.6863079898176, 2044.0084967115683, 1945.1820279809292, 2041.0073536075572, 1585.2300734628975, 2070.1982157672264, 1999.351780278636, 1960.9745292089751, 1944.4940414114858, 1936.7597755454397, 1874.233350123806, 1985.718301661948, 1926.2194105663075, 2059.1797553675183, 1965.5681768359125, 1726.2310654819232, 1972.2558013280607, 1745.4297501775764, 2003.4587862038761, 1999.749173797607, 1942.0351590987639, 1481.6976208881113, 1957.2154095019068, 1769.2898363422642, 1655.51056208938, 1968.2035650851353, 1762.5244290473854, 2081.3020061121906, 1970.7399578714433, 2029.6571355539556, 1517.4484387388306, 1812.690788333952, 1817.413212958136, 2019.5153262901163, 1968.4332103444456, 1887.955502183943, 1862.5544849371436], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [512.4263649146302, 540.3374245339547, 530.5388938089199, 514.43582071385, 510.9972086052959, 501.46602557079007, 492.2881693743207, 393.52813053128983, 281.64572082294137, 348.85543411092186, 463.6319847394002, 458.4657139513828, 427.2645115437498, 470.32711529709064, 481.82468633485905, 474.99158364884215, 363.4331672250679, 418.6440488249677, 432.3369523530636, 462.88470690989595, 480.3354437291645, 694.1748303447642, 430.1129927893524, 455.4355384738383, 493.3195747184171, 431.2084649158256, 619.583058727073, 531.0174689458984, 492.13077462860315, 515.6941642597734, 468.4957633905399, 491.02298870625475, 476.31054188331575, 431.4392990304427, 373.85078915715644, 452.49029181475805, 635.4586566650898, 512.9034565684509, 629.1695879963953, 620.2635067383194, 602.5324876335627, 482.97434063671693, 166.48815693394283, 332.84496377504826, 469.41805689113875, 403.487396130574, 424.7948969734205, 324.18197101800604, 470.8186167344344, 462.7526456133123, 419.5848757501612, 406.48498197970673, 409.2362532936359, 425.87202225412136, 522.00537270496, 338.5696810088949, 589.0854615946258, 526.7347766694352, 383.6508567044854, 388.39669720142643, 509.2257855493481, 520.2737521791436, 359.88744645803, 371.5901689872421, 440.6440115864057, 470.6346806966535, 472.90129136807616, 337.31808220858875, 360.198386735206, 360.76925485738684, 406.8953455089862, 437.64076309973694, 460.1726760195059, 491.8684662949328, 411.0320326888013, 443.4455379901659, 432.47921324405166, 338.18071375275395, 380.17764319615213, 429.72380636898544, 504.47986469522897, 442.33016839016193, 448.96568022323936, 514.0234686540257, 517.9304205365039, 470.6028331150929, 625.9027415751813, 641.1487311923197, 486.2395634405553, 376.7859049762575, 388.8519683025963, 496.80470942484936, 329.7090356838671, 483.00873031038986, 446.4112436011626, 468.3990022379828, 360.36083103096985, 310.51046510171005, 381.9989622184334, 512.0689664404041, 390.56375565218593, 400.22828222968957, 632.1718498182812, 388.8080362957501, 450.77509760700616, 507.53211216649305, 371.39460125989115, 308.67570020826093, 430.80950893263855, 269.6527291147279, 435.2569252759767, 491.05837963341753, 571.1579080274952, 372.1630628383377, 597.2022191879043, 529.4864229882149, 290.9131902617114, 420.63867440782724, 450.0692782455661, 404.49416415844655, 313.91854655552874, 513.2554550565544, 301.36081648159933, 378.990112500745, 448.4396538353888, 396.4649861139683, 474.5690950409793, 521.1115671756436, 485.26106823046587, 472.18916084556116, 324.06063537083395, 301.34486426449115, 494.9215509359224, 610.3962670823258, 494.5166613012885, 207.41068100727819, 444.04627328910124, 402.3512894327106, 476.3100350358476, 333.31807522235323, 522.2973952240278, 535.3219595377358, 524.0900210857512, 581.8724678543762, 422.2528337489097, 434.0691706670652, 436.8240472980061, 661.6159592547932, 396.6579929478396, 547.7884657115169, 651.8531711991656, 566.2845266606046, 471.86003114860046, 446.6963851529454, 448.61792996418836, 424.95196672329826, 403.4488300204863, 392.5410103720567, 535.3404559402551, 553.464731755489, 371.6164111055793, 577.2495858166325, 475.4865369808721, 480.4916666510705, 547.5765700093872, 505.37886972318256, 378.486763772741, 483.15558461917897, 278.52290169732174, 593.2335117293078, 490.1958185229646, 433.208974967606, 342.0717899135967, 520.9599051054887, 342.9906579082168, 483.7778050499246, 363.62907214388684, 571.8391485025387, 371.9746709941116, 527.645295866917, 663.9058844223248, 428.0759532538584, 438.54257472809644, 446.4982623275014, 476.00592372191494, 404.59006378144744, 482.90880388838445, 258.9326458155616, 261.83311843360497, 425.25846292680023, 304.73465629703253, 510.7041039414551, 375.2184267194576, 451.9213525772905, 659.5364761772611, 686.7323137008077, 376.88445188354257, 578.28856196396, 470.57383524499903, 536.7459932569215], "policy_predator_policy_reward": [489.55724466644375, 416.2774160338169, 461.4284032207853, 437.64394463297964, 545.8553371982298, 467.92280266482106, 471.27790615688207, 421.5120524551398, 602.5630365496663, 579.1791125069261, 585.0525836987139, 532.3440518840976, 539.4588641482968, 503.069029281362, 462.0510188050319, 521.257335831261, 599.9564328746475, 579.2664888940164, 526.3086753428953, 547.9115953291114, 485.0528499056846, 474.9613806617105, 558.9331758376369, 545.9431906126898, 577.4241100152781, 491.34237402895286, 441.83723961083433, 449.4207759565359, 399.22362781108717, 513.549716596888, 567.935640163075, 488.5741127959815, 571.7190285556263, 549.1433771627989, 606.9213066745414, 571.6072296940175, 423.0594184440075, 408.29944127875484, 289.57168152660165, 388.45267552052326, 433.1130019052401, 442.47604770680795, 624.164548803957, 619.3178037874155, 477.23318697074717, 591.2420589011247, 513.6053817519113, 596.162099576852, 529.2246847078401, 556.0713748722006, 570.3886059267952, 573.3800390467499, 495.02167641231176, 509.78334803138944, 544.3275069433331, 614.8669428185211, 482.3922525521671, 428.4483060662039, 661.7656322174284, 536.0676401952518, 441.6461049781856, 586.1741959051201, 640.2356156251343, 542.2533677807809, 522.3117246451334, 574.6907480647305, 609.5304490522706, 574.5742470099328, 575.2178257817061, 566.3409404305798, 632.0446018338527, 468.64940611188825, 513.3895254770164, 519.0624088995055, 588.1960841992769, 596.5304434842982, 605.700150276088, 623.2668108800269, 613.4609807760964, 594.3182511777364, 477.88613050660035, 474.36494637027, 542.1164117400964, 475.96970992619003, 430.05427676574027, 437.9429021708171, 300.98472099511537, 382.3480300470775, 546.9361389157701, 564.8539174757242, 546.1070948403047, 524.5604762774691, 665.7061106225962, 503.5444665663222, 507.4183472759625, 486.11978950266735, 648.5145413476987, 617.3943083394686, 430.2300631726131, 572.0884452120567, 620.0981607213299, 608.2422405901175, 551.6419521645554, 529.1404883876028, 575.7416708341563, 500.4580797668023, 677.0000749372726, 635.5033403583633, 682.9503033793883, 579.9833075107493, 507.66165860092326, 559.1603736621526, 509.14018571195606, 467.4598122257288, 402.5515831189076, 504.84356035997183, 654.9292226364045, 590.7009185813907, 559.2787774805943, 570.8331028488091, 620.6089762949806, 537.9481211460608, 704.2997493944719, 637.5308837019537, 580.55493147007, 620.5300388379725, 505.0875341171615, 534.9181116560324, 588.5932055856244, 497.9650620499156, 669.1282019298585, 650.6483264157469, 511.4662812501007, 424.2232543392094, 450.61170575122947, 432.6910254031016, 600.4991160160295, 623.3015370293875, 567.8513817466452, 621.8722882737936, 457.76511497337674, 445.59005947383406, 439.8599392783863, 398.67161319297526, 538.205617601122, 542.2321535283418, 379.1409135438357, 396.65243002717256, 510.9349954159996, 530.3368475865896, 334.1856419050263, 373.8960708015098, 535.1452196788774, 605.4781193870941, 516.4818616101022, 575.5164185383231, 442.36373879377675, 487.877486295604, 436.6796707924289, 446.7709428398871, 377.6022158654573, 418.96153738990915, 504.1137295298279, 543.366853042108, 512.9240216097421, 433.8697124552985, 585.2126949880774, 495.1801157187682, 287.82609343698795, 322.11511402449264, 536.7410508063144, 497.0695652050211, 452.96231631954373, 453.29582500363585, 430.9219704527992, 397.8201286784412, 467.53142892570986, 565.2039155129961, 397.5867221537679, 465.31774003259187, 497.16676812126593, 492.1534003147395, 541.8858368901074, 543.8132839257387, 608.0806811423578, 540.9804669082351, 368.93469313939215, 406.672295895494, 604.3367139501397, 521.2624930234063, 499.2132644962732, 502.76118822337963, 607.3013433599365, 585.0742036334314, 319.2933331927684, 302.87108727361056, 435.75988405850313, 497.0226042779393, 396.3168798478353, 458.9177765873893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7512026433734555, "mean_inference_ms": 5.0185117585939745, "mean_action_processing_ms": 0.7349585922547658, "mean_env_wait_ms": 0.6339905985333257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028745055198669434, "StateBufferConnector_ms": 0.05623459815979004, "ViewRequirementAgentConnector_ms": 0.8175909519195557}, "num_episodes": 22, "episode_return_max": 2134.524504641323, "episode_return_min": 1481.6976208881113, "episode_return_mean": 1943.0029605588636, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.44403563842562, "num_env_steps_trained_throughput_per_sec": 83.44403563842562, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 108352.482, "restore_workers_time_ms": 0.025, "training_step_time_ms": 108352.393, "sample_time_ms": 11376.28, "learn_time_ms": 96927.994, "learn_throughput": 41.268, "synch_weights_time_ms": 45.316}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "8abce_00000", "date": "2024-08-16_11-56-02", "timestamp": 1723789562, "time_this_iter_s": 48.02682113647461, "time_total_s": 2071.3554260730743, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43f8af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2071.3554260730743, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 60.670149253731346, "ram_util_percent": 79.19850746268658}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.679450092602659, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.391301369540907, "policy_loss": -0.0011791326019361063, "vf_loss": 9.391156498843399, "vf_explained_var": -0.03657367806586008, "kl": 0.008826833292420995, "entropy": 1.2944760236159834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6251334219776765, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.57423280685667, "policy_loss": -0.00012472339994495823, "vf_loss": 9.574195411722496, "vf_explained_var": -0.04963198165414195, "kl": 0.006485756575422288, "entropy": 0.8257217450116677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 2155.7344316436606, "episode_reward_min": 1142.819134794354, "episode_reward_mean": 1914.9752042545824, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 138.01774663795112, "predator_policy": 157.8248334303992}, "policy_reward_max": {"prey_policy": 700.8180202160064, "predator_policy": 704.2997493944719}, "policy_reward_mean": {"prey_policy": 458.0896229174027, "predator_policy": 499.3979792098885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1979.7209729563058, 1927.4574517818412, 1961.0958778823258, 1742.815473300364, 1941.3806988935844, 1858.7443493201881, 2018.8673219277869, 1969.8385027034162, 1839.9132999914582, 2019.7695034757112, 2026.6607968824287, 1969.8808263185938, 2057.3198386117965, 1913.966598851184, 2008.281164992924, 1994.3240696388687, 1862.5264078048792, 1945.2301165544677, 1984.4930766909602, 2039.2040983625407, 1999.6268881529224, 2017.6806815189686, 1899.0611099622631, 1981.0752705435523, 1856.5304325881561, 1950.3842238096943, 1974.8155248083056, 1956.3242488452197, 1981.9683431831777, 1908.3483826177744, 1936.7801458198458, 1896.3864370435074, 2019.132439193326, 2101.762326666191, 2034.506960374457, 1992.5737167637858, 1963.3958489375023, 1993.1373371724699, 1919.9209688035196, 2034.0837856549974, 1957.1820058873352, 1984.675322733416, 1985.7310990531248, 2022.1815620787695, 2045.9896102574014, 2035.6863079898176, 2044.0084967115683, 1945.1820279809292, 2041.0073536075572, 1585.2300734628975, 2070.1982157672264, 1999.351780278636, 1960.9745292089751, 1944.4940414114858, 1936.7597755454397, 1874.233350123806, 1985.718301661948, 1926.2194105663075, 2059.1797553675183, 1965.5681768359125, 1726.2310654819232, 1972.2558013280607, 1745.4297501775764, 2003.4587862038761, 1999.749173797607, 1942.0351590987639, 1481.6976208881113, 1957.2154095019068, 1769.2898363422642, 1655.51056208938, 1968.2035650851353, 1762.5244290473854, 2081.3020061121906, 1970.7399578714433, 2029.6571355539556, 1517.4484387388306, 1812.690788333952, 1817.413212958136, 2019.5153262901163, 1968.4332103444456, 1887.955502183943, 1862.5544849371436, 1142.819134794354, 1702.7996985522554, 1534.442717704053, 2028.8677474758126, 1738.4897036856175, 1832.0264113143155, 1879.0166990466262, 1918.6268672945346, 2059.327337997443, 1965.6536745877677, 1844.2399978080987, 1737.2985205703123, 1874.4472026277047, 1664.3306348737517, 2148.2269602819306, 2155.7344316436606, 1344.5750407583923, 2126.7297061441263], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [635.4586566650898, 512.9034565684509, 629.1695879963953, 620.2635067383194, 602.5324876335627, 482.97434063671693, 166.48815693394283, 332.84496377504826, 469.41805689113875, 403.487396130574, 424.7948969734205, 324.18197101800604, 470.8186167344344, 462.7526456133123, 419.5848757501612, 406.48498197970673, 409.2362532936359, 425.87202225412136, 522.00537270496, 338.5696810088949, 589.0854615946258, 526.7347766694352, 383.6508567044854, 388.39669720142643, 509.2257855493481, 520.2737521791436, 359.88744645803, 371.5901689872421, 440.6440115864057, 470.6346806966535, 472.90129136807616, 337.31808220858875, 360.198386735206, 360.76925485738684, 406.8953455089862, 437.64076309973694, 460.1726760195059, 491.8684662949328, 411.0320326888013, 443.4455379901659, 432.47921324405166, 338.18071375275395, 380.17764319615213, 429.72380636898544, 504.47986469522897, 442.33016839016193, 448.96568022323936, 514.0234686540257, 517.9304205365039, 470.6028331150929, 625.9027415751813, 641.1487311923197, 486.2395634405553, 376.7859049762575, 388.8519683025963, 496.80470942484936, 329.7090356838671, 483.00873031038986, 446.4112436011626, 468.3990022379828, 360.36083103096985, 310.51046510171005, 381.9989622184334, 512.0689664404041, 390.56375565218593, 400.22828222968957, 632.1718498182812, 388.8080362957501, 450.77509760700616, 507.53211216649305, 371.39460125989115, 308.67570020826093, 430.80950893263855, 269.6527291147279, 435.2569252759767, 491.05837963341753, 571.1579080274952, 372.1630628383377, 597.2022191879043, 529.4864229882149, 290.9131902617114, 420.63867440782724, 450.0692782455661, 404.49416415844655, 313.91854655552874, 513.2554550565544, 301.36081648159933, 378.990112500745, 448.4396538353888, 396.4649861139683, 474.5690950409793, 521.1115671756436, 485.26106823046587, 472.18916084556116, 324.06063537083395, 301.34486426449115, 494.9215509359224, 610.3962670823258, 494.5166613012885, 207.41068100727819, 444.04627328910124, 402.3512894327106, 476.3100350358476, 333.31807522235323, 522.2973952240278, 535.3219595377358, 524.0900210857512, 581.8724678543762, 422.2528337489097, 434.0691706670652, 436.8240472980061, 661.6159592547932, 396.6579929478396, 547.7884657115169, 651.8531711991656, 566.2845266606046, 471.86003114860046, 446.6963851529454, 448.61792996418836, 424.95196672329826, 403.4488300204863, 392.5410103720567, 535.3404559402551, 553.464731755489, 371.6164111055793, 577.2495858166325, 475.4865369808721, 480.4916666510705, 547.5765700093872, 505.37886972318256, 378.486763772741, 483.15558461917897, 278.52290169732174, 593.2335117293078, 490.1958185229646, 433.208974967606, 342.0717899135967, 520.9599051054887, 342.9906579082168, 483.7778050499246, 363.62907214388684, 571.8391485025387, 371.9746709941116, 527.645295866917, 663.9058844223248, 428.0759532538584, 438.54257472809644, 446.4982623275014, 476.00592372191494, 404.59006378144744, 482.90880388838445, 258.9326458155616, 261.83311843360497, 425.25846292680023, 304.73465629703253, 510.7041039414551, 375.2184267194576, 451.9213525772905, 659.5364761772611, 686.7323137008077, 376.88445188354257, 578.28856196396, 470.57383524499903, 536.7459932569215, 377.0723636159128, 358.0438244100905, 582.5578675888462, 614.642556205361, 378.26306049900245, 280.4297002137792, 464.8386096971562, 596.4995585775631, 440.98006966577736, 602.2976064348842, 620.6005767491595, 639.2198515631261, 401.20151081227647, 376.6311510982927, 539.4936935117344, 410.6804712946518, 442.60726244715664, 551.7330987052155, 437.6771918421779, 403.4501338605543, 525.34181426134, 406.91593244312526, 700.8180202160064, 463.1504438711041, 531.1363608550653, 558.3536001402858, 464.07894270003334, 544.2795095668296, 508.4280667942844, 537.346930332159, 446.5510331446752, 614.4901304649936, 591.6544963044352, 138.01774663795112, 431.31595861105154, 605.3019174352708], "policy_predator_policy_reward": [423.0594184440075, 408.29944127875484, 289.57168152660165, 388.45267552052326, 433.1130019052401, 442.47604770680795, 624.164548803957, 619.3178037874155, 477.23318697074717, 591.2420589011247, 513.6053817519113, 596.162099576852, 529.2246847078401, 556.0713748722006, 570.3886059267952, 573.3800390467499, 495.02167641231176, 509.78334803138944, 544.3275069433331, 614.8669428185211, 482.3922525521671, 428.4483060662039, 661.7656322174284, 536.0676401952518, 441.6461049781856, 586.1741959051201, 640.2356156251343, 542.2533677807809, 522.3117246451334, 574.6907480647305, 609.5304490522706, 574.5742470099328, 575.2178257817061, 566.3409404305798, 632.0446018338527, 468.64940611188825, 513.3895254770164, 519.0624088995055, 588.1960841992769, 596.5304434842982, 605.700150276088, 623.2668108800269, 613.4609807760964, 594.3182511777364, 477.88613050660035, 474.36494637027, 542.1164117400964, 475.96970992619003, 430.05427676574027, 437.9429021708171, 300.98472099511537, 382.3480300470775, 546.9361389157701, 564.8539174757242, 546.1070948403047, 524.5604762774691, 665.7061106225962, 503.5444665663222, 507.4183472759625, 486.11978950266735, 648.5145413476987, 617.3943083394686, 430.2300631726131, 572.0884452120567, 620.0981607213299, 608.2422405901175, 551.6419521645554, 529.1404883876028, 575.7416708341563, 500.4580797668023, 677.0000749372726, 635.5033403583633, 682.9503033793883, 579.9833075107493, 507.66165860092326, 559.1603736621526, 509.14018571195606, 467.4598122257288, 402.5515831189076, 504.84356035997183, 654.9292226364045, 590.7009185813907, 559.2787774805943, 570.8331028488091, 620.6089762949806, 537.9481211460608, 704.2997493944719, 637.5308837019537, 580.55493147007, 620.5300388379725, 505.0875341171615, 534.9181116560324, 588.5932055856244, 497.9650620499156, 669.1282019298585, 650.6483264157469, 511.4662812501007, 424.2232543392094, 450.61170575122947, 432.6910254031016, 600.4991160160295, 623.3015370293875, 567.8513817466452, 621.8722882737936, 457.76511497337674, 445.59005947383406, 439.8599392783863, 398.67161319297526, 538.205617601122, 542.2321535283418, 379.1409135438357, 396.65243002717256, 510.9349954159996, 530.3368475865896, 334.1856419050263, 373.8960708015098, 535.1452196788774, 605.4781193870941, 516.4818616101022, 575.5164185383231, 442.36373879377675, 487.877486295604, 436.6796707924289, 446.7709428398871, 377.6022158654573, 418.96153738990915, 504.1137295298279, 543.366853042108, 512.9240216097421, 433.8697124552985, 585.2126949880774, 495.1801157187682, 287.82609343698795, 322.11511402449264, 536.7410508063144, 497.0695652050211, 452.96231631954373, 453.29582500363585, 430.9219704527992, 397.8201286784412, 467.53142892570986, 565.2039155129961, 397.5867221537679, 465.31774003259187, 497.16676812126593, 492.1534003147395, 541.8858368901074, 543.8132839257387, 608.0806811423578, 540.9804669082351, 368.93469313939215, 406.672295895494, 604.3367139501397, 521.2624930234063, 499.2132644962732, 502.76118822337963, 607.3013433599365, 585.0742036334314, 319.2933331927684, 302.87108727361056, 435.75988405850313, 497.0226042779393, 396.3168798478353, 458.9177765873893, 157.8248334303992, 249.87811333795182, 190.4914283116813, 315.1078464463669, 460.82392755891874, 414.92602943235397, 496.1960291315693, 471.3335500695267, 322.42896220647054, 372.783065378488, 294.55877585407075, 277.64720714795857, 532.8155715560974, 568.3684655799611, 550.8478550493664, 417.6048474387812, 565.8963890276577, 499.09058781741265, 599.730585337982, 524.7957635470513, 450.7792341711909, 461.2030169324445, 335.02753154998493, 238.30252493322092, 419.6197160563672, 365.33752557598694, 337.95801147427306, 318.01417113261436, 527.2086824917866, 575.2432806637013, 585.4335153415337, 509.25975269245987, 337.6921214947385, 277.2106763212676, 512.1718011765735, 577.9400289212302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7982848403875955, "mean_inference_ms": 5.149023401945335, "mean_action_processing_ms": 0.7551364317300063, "mean_env_wait_ms": 0.6517433646861239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09849381446838379, "StateBufferConnector_ms": 0.0720130205154419, "ViewRequirementAgentConnector_ms": 1.0121361017227173}, "num_episodes": 18, "episode_return_max": 2155.7344316436606, "episode_return_min": 1142.819134794354, "episode_return_mean": 1914.9752042545824, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.68572154002969, "num_env_steps_trained_throughput_per_sec": 88.68572154002969, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 108779.14, "restore_workers_time_ms": 0.025, "training_step_time_ms": 108779.053, "sample_time_ms": 11627.72, "learn_time_ms": 97104.314, "learn_throughput": 41.193, "synch_weights_time_ms": 44.327}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "8abce_00000", "date": "2024-08-16_11-56-47", "timestamp": 1723789607, "time_this_iter_s": 45.124051332473755, "time_total_s": 2116.479477405548, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4ab2ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2116.479477405548, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 55.38769230769231, "ram_util_percent": 78.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4343490088742876, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.538517283384131, "policy_loss": -0.0029652727063173654, "vf_loss": 9.538830025486215, "vf_explained_var": -0.08482075920180669, "kl": 0.017683656227825455, "entropy": 1.2632641273200826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3824390356818204, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.355925222427127, "policy_loss": -0.00047482263257421514, "vf_loss": 9.356161901181338, "vf_explained_var": -0.020584535188775843, "kl": 0.009526594014445545, "entropy": 0.7895623274581142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 2155.7344316436606, "episode_reward_min": 541.8812825510154, "episode_reward_mean": 1845.598348886913, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 138.01774663795112, "predator_policy": -11.093138930479654}, "policy_reward_max": {"prey_policy": 700.8180202160064, "predator_policy": 704.2997493944719}, "policy_reward_mean": {"prey_policy": 464.12906225568696, "predator_policy": 458.6701121877701}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1981.0752705435523, 1856.5304325881561, 1950.3842238096943, 1974.8155248083056, 1956.3242488452197, 1981.9683431831777, 1908.3483826177744, 1936.7801458198458, 1896.3864370435074, 2019.132439193326, 2101.762326666191, 2034.506960374457, 1992.5737167637858, 1963.3958489375023, 1993.1373371724699, 1919.9209688035196, 2034.0837856549974, 1957.1820058873352, 1984.675322733416, 1985.7310990531248, 2022.1815620787695, 2045.9896102574014, 2035.6863079898176, 2044.0084967115683, 1945.1820279809292, 2041.0073536075572, 1585.2300734628975, 2070.1982157672264, 1999.351780278636, 1960.9745292089751, 1944.4940414114858, 1936.7597755454397, 1874.233350123806, 1985.718301661948, 1926.2194105663075, 2059.1797553675183, 1965.5681768359125, 1726.2310654819232, 1972.2558013280607, 1745.4297501775764, 2003.4587862038761, 1999.749173797607, 1942.0351590987639, 1481.6976208881113, 1957.2154095019068, 1769.2898363422642, 1655.51056208938, 1968.2035650851353, 1762.5244290473854, 2081.3020061121906, 1970.7399578714433, 2029.6571355539556, 1517.4484387388306, 1812.690788333952, 1817.413212958136, 2019.5153262901163, 1968.4332103444456, 1887.955502183943, 1862.5544849371436, 1142.819134794354, 1702.7996985522554, 1534.442717704053, 2028.8677474758126, 1738.4897036856175, 1832.0264113143155, 1879.0166990466262, 1918.6268672945346, 2059.327337997443, 1965.6536745877677, 1844.2399978080987, 1737.2985205703123, 1874.4472026277047, 1664.3306348737517, 2148.2269602819306, 2155.7344316436606, 1344.5750407583923, 2126.7297061441263, 1470.636278252578, 1719.9257366846775, 1043.5471713890693, 2019.6859827028761, 1728.7206412661071, 1964.8791919364473, 2089.0836664111275, 1746.9998895093163, 1818.4147157272605, 1294.9016467366441, 2039.201751602548, 2091.9291306347945, 1458.2766600557677, 1785.88259905282, 1469.7263419499982, 1760.7698055598644, 1861.473224386958, 1622.7608293578785, 1794.4679043507963, 1107.7354335468335, 1702.2163299378649, 541.8812825510154, 1907.057376205666], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [448.96568022323936, 514.0234686540257, 517.9304205365039, 470.6028331150929, 625.9027415751813, 641.1487311923197, 486.2395634405553, 376.7859049762575, 388.8519683025963, 496.80470942484936, 329.7090356838671, 483.00873031038986, 446.4112436011626, 468.3990022379828, 360.36083103096985, 310.51046510171005, 381.9989622184334, 512.0689664404041, 390.56375565218593, 400.22828222968957, 632.1718498182812, 388.8080362957501, 450.77509760700616, 507.53211216649305, 371.39460125989115, 308.67570020826093, 430.80950893263855, 269.6527291147279, 435.2569252759767, 491.05837963341753, 571.1579080274952, 372.1630628383377, 597.2022191879043, 529.4864229882149, 290.9131902617114, 420.63867440782724, 450.0692782455661, 404.49416415844655, 313.91854655552874, 513.2554550565544, 301.36081648159933, 378.990112500745, 448.4396538353888, 396.4649861139683, 474.5690950409793, 521.1115671756436, 485.26106823046587, 472.18916084556116, 324.06063537083395, 301.34486426449115, 494.9215509359224, 610.3962670823258, 494.5166613012885, 207.41068100727819, 444.04627328910124, 402.3512894327106, 476.3100350358476, 333.31807522235323, 522.2973952240278, 535.3219595377358, 524.0900210857512, 581.8724678543762, 422.2528337489097, 434.0691706670652, 436.8240472980061, 661.6159592547932, 396.6579929478396, 547.7884657115169, 651.8531711991656, 566.2845266606046, 471.86003114860046, 446.6963851529454, 448.61792996418836, 424.95196672329826, 403.4488300204863, 392.5410103720567, 535.3404559402551, 553.464731755489, 371.6164111055793, 577.2495858166325, 475.4865369808721, 480.4916666510705, 547.5765700093872, 505.37886972318256, 378.486763772741, 483.15558461917897, 278.52290169732174, 593.2335117293078, 490.1958185229646, 433.208974967606, 342.0717899135967, 520.9599051054887, 342.9906579082168, 483.7778050499246, 363.62907214388684, 571.8391485025387, 371.9746709941116, 527.645295866917, 663.9058844223248, 428.0759532538584, 438.54257472809644, 446.4982623275014, 476.00592372191494, 404.59006378144744, 482.90880388838445, 258.9326458155616, 261.83311843360497, 425.25846292680023, 304.73465629703253, 510.7041039414551, 375.2184267194576, 451.9213525772905, 659.5364761772611, 686.7323137008077, 376.88445188354257, 578.28856196396, 470.57383524499903, 536.7459932569215, 377.0723636159128, 358.0438244100905, 582.5578675888462, 614.642556205361, 378.26306049900245, 280.4297002137792, 464.8386096971562, 596.4995585775631, 440.98006966577736, 602.2976064348842, 620.6005767491595, 639.2198515631261, 401.20151081227647, 376.6311510982927, 539.4936935117344, 410.6804712946518, 442.60726244715664, 551.7330987052155, 437.6771918421779, 403.4501338605543, 525.34181426134, 406.91593244312526, 700.8180202160064, 463.1504438711041, 531.1363608550653, 558.3536001402858, 464.07894270003334, 544.2795095668296, 508.4280667942844, 537.346930332159, 446.5510331446752, 614.4901304649936, 591.6544963044352, 138.01774663795112, 431.31595861105154, 605.3019174352708, 641.2771418707252, 408.35857438388166, 399.01823174895344, 411.48327199733507, 332.6666127738054, 311.7708623045483, 503.2244560566616, 591.2347513803439, 558.5798062376354, 483.15718880519745, 677.4115356087196, 659.3847314536915, 567.5538634801308, 542.833275214485, 397.26945933256667, 432.3019406660928, 482.7571750878605, 483.2940731211255, 367.84787375054674, 487.70443213694176, 575.1840535456556, 433.67892488107185, 537.6326248200452, 494.73001915741105, 617.5452500917768, 427.5866090413103, 398.17634004518476, 325.5692319301224, 417.608655831781, 535.6973554105872, 498.5684084065738, 553.667022953648, 543.2383269123364, 407.07767099452576, 328.58027306093635, 459.62412405194635, 537.4061112987239, 660.102767053053, 392.73693515255223, 225.92324805929854, 440.6538828973701, 406.9062676344561, 287.13529033129726, 226.28158195700385, 478.6496804208587, 588.3767656514736], "policy_predator_policy_reward": [542.1164117400964, 475.96970992619003, 430.05427676574027, 437.9429021708171, 300.98472099511537, 382.3480300470775, 546.9361389157701, 564.8539174757242, 546.1070948403047, 524.5604762774691, 665.7061106225962, 503.5444665663222, 507.4183472759625, 486.11978950266735, 648.5145413476987, 617.3943083394686, 430.2300631726131, 572.0884452120567, 620.0981607213299, 608.2422405901175, 551.6419521645554, 529.1404883876028, 575.7416708341563, 500.4580797668023, 677.0000749372726, 635.5033403583633, 682.9503033793883, 579.9833075107493, 507.66165860092326, 559.1603736621526, 509.14018571195606, 467.4598122257288, 402.5515831189076, 504.84356035997183, 654.9292226364045, 590.7009185813907, 559.2787774805943, 570.8331028488091, 620.6089762949806, 537.9481211460608, 704.2997493944719, 637.5308837019537, 580.55493147007, 620.5300388379725, 505.0875341171615, 534.9181116560324, 588.5932055856244, 497.9650620499156, 669.1282019298585, 650.6483264157469, 511.4662812501007, 424.2232543392094, 450.61170575122947, 432.6910254031016, 600.4991160160295, 623.3015370293875, 567.8513817466452, 621.8722882737936, 457.76511497337674, 445.59005947383406, 439.8599392783863, 398.67161319297526, 538.205617601122, 542.2321535283418, 379.1409135438357, 396.65243002717256, 510.9349954159996, 530.3368475865896, 334.1856419050263, 373.8960708015098, 535.1452196788774, 605.4781193870941, 516.4818616101022, 575.5164185383231, 442.36373879377675, 487.877486295604, 436.6796707924289, 446.7709428398871, 377.6022158654573, 418.96153738990915, 504.1137295298279, 543.366853042108, 512.9240216097421, 433.8697124552985, 585.2126949880774, 495.1801157187682, 287.82609343698795, 322.11511402449264, 536.7410508063144, 497.0695652050211, 452.96231631954373, 453.29582500363585, 430.9219704527992, 397.8201286784412, 467.53142892570986, 565.2039155129961, 397.5867221537679, 465.31774003259187, 497.16676812126593, 492.1534003147395, 541.8858368901074, 543.8132839257387, 608.0806811423578, 540.9804669082351, 368.93469313939215, 406.672295895494, 604.3367139501397, 521.2624930234063, 499.2132644962732, 502.76118822337963, 607.3013433599365, 585.0742036334314, 319.2933331927684, 302.87108727361056, 435.75988405850313, 497.0226042779393, 396.3168798478353, 458.9177765873893, 157.8248334303992, 249.87811333795182, 190.4914283116813, 315.1078464463669, 460.82392755891874, 414.92602943235397, 496.1960291315693, 471.3335500695267, 322.42896220647054, 372.783065378488, 294.55877585407075, 277.64720714795857, 532.8155715560974, 568.3684655799611, 550.8478550493664, 417.6048474387812, 565.8963890276577, 499.09058781741265, 599.730585337982, 524.7957635470513, 450.7792341711909, 461.2030169324445, 335.02753154998493, 238.30252493322092, 419.6197160563672, 365.33752557598694, 337.95801147427306, 318.01417113261436, 527.2086824917866, 575.2432806637013, 585.4335153415337, 509.25975269245987, 337.6921214947385, 277.2106763212676, 512.1718011765735, 577.9400289212302, 227.73832370430063, 193.2622382936691, 472.7495415635243, 436.6746913748651, 189.15428367222705, 209.9554126384887, 444.8910901016985, 480.3356851641748, 376.725429158447, 310.2582170648253, 339.1323879042523, 288.95053696978465, 483.60979953159296, 495.08672818491885, 395.3676093075933, 522.0608802030662, 405.42567956542007, 446.9377879528573, 217.82930145447207, 221.52003939468258, 472.0252631635894, 558.3135100122291, 538.220040690013, 521.3464459673256, 194.98871341176186, 218.15608751091656, 535.5199090203733, 526.6171180571391, 294.7747464585623, 221.64558424906787, 329.85130742217433, 378.68306677746875, 443.9414672398258, 467.2157592402681, 408.29565017892907, 426.26078206606707, 288.73016660807065, 308.2288593909505, 246.67890566419757, 242.39634467078457, 472.42767938503437, 382.2285000210053, 39.55754919319468, -11.093138930479654, 367.54028045058135, 472.4906496827515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8567435800339442, "mean_inference_ms": 5.3192339948738425, "mean_action_processing_ms": 0.7815890595846184, "mean_env_wait_ms": 0.6736872689827057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0954662561416626, "StateBufferConnector_ms": 0.08127641677856445, "ViewRequirementAgentConnector_ms": 0.9454890489578247}, "num_episodes": 23, "episode_return_max": 2155.7344316436606, "episode_return_min": 541.8812825510154, "episode_return_mean": 1845.598348886913, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 93.79611615616936, "num_env_steps_trained_throughput_per_sec": 93.79611615616936, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 108831.371, "restore_workers_time_ms": 0.026, "training_step_time_ms": 108831.284, "sample_time_ms": 11307.925, "learn_time_ms": 97475.559, "learn_throughput": 41.036, "synch_weights_time_ms": 44.789}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "8abce_00000", "date": "2024-08-16_11-57-30", "timestamp": 1723789650, "time_this_iter_s": 42.75491523742676, "time_total_s": 2159.234392642975, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a19b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2159.234392642975, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 56.05333333333333, "ram_util_percent": 77.3583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0605880701983414, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.27651866024764, "policy_loss": -0.0011965285581364124, "vf_loss": 9.27587737179307, "vf_explained_var": -0.05401508218396908, "kl": 0.012252054731058174, "entropy": 1.2898394422556358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8658961742327957, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.575390496329655, "policy_loss": -0.0026886395553235337, "vf_loss": 9.577954725235228, "vf_explained_var": -0.057827039528145364, "kl": 0.004974830190174283, "entropy": 0.8142140182868514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 2155.7344316436606, "episode_reward_min": 541.8812825510154, "episode_reward_mean": 1809.4269561357755, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 138.01774663795112, "predator_policy": -11.093138930479654}, "policy_reward_max": {"prey_policy": 730.9261859675154, "predator_policy": 704.2997493944719}, "policy_reward_mean": {"prey_policy": 473.57647632120273, "predator_policy": 431.1370017466852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1984.675322733416, 1985.7310990531248, 2022.1815620787695, 2045.9896102574014, 2035.6863079898176, 2044.0084967115683, 1945.1820279809292, 2041.0073536075572, 1585.2300734628975, 2070.1982157672264, 1999.351780278636, 1960.9745292089751, 1944.4940414114858, 1936.7597755454397, 1874.233350123806, 1985.718301661948, 1926.2194105663075, 2059.1797553675183, 1965.5681768359125, 1726.2310654819232, 1972.2558013280607, 1745.4297501775764, 2003.4587862038761, 1999.749173797607, 1942.0351590987639, 1481.6976208881113, 1957.2154095019068, 1769.2898363422642, 1655.51056208938, 1968.2035650851353, 1762.5244290473854, 2081.3020061121906, 1970.7399578714433, 2029.6571355539556, 1517.4484387388306, 1812.690788333952, 1817.413212958136, 2019.5153262901163, 1968.4332103444456, 1887.955502183943, 1862.5544849371436, 1142.819134794354, 1702.7996985522554, 1534.442717704053, 2028.8677474758126, 1738.4897036856175, 1832.0264113143155, 1879.0166990466262, 1918.6268672945346, 2059.327337997443, 1965.6536745877677, 1844.2399978080987, 1737.2985205703123, 1874.4472026277047, 1664.3306348737517, 2148.2269602819306, 2155.7344316436606, 1344.5750407583923, 2126.7297061441263, 1470.636278252578, 1719.9257366846775, 1043.5471713890693, 2019.6859827028761, 1728.7206412661071, 1964.8791919364473, 2089.0836664111275, 1746.9998895093163, 1818.4147157272605, 1294.9016467366441, 2039.201751602548, 2091.9291306347945, 1458.2766600557677, 1785.88259905282, 1469.7263419499982, 1760.7698055598644, 1861.473224386958, 1622.7608293578785, 1794.4679043507963, 1107.7354335468335, 1702.2163299378649, 541.8812825510154, 1907.057376205666, 1377.754132391783, 2050.0300810060903, 2032.545374100313, 1584.822852605999, 1793.8810486472812, 1851.1879812262127, 1533.6810946393668, 1757.2954564442757, 1630.2454214547142, 1996.8703924685376, 1821.5779243420288, 1793.1993574693593, 1943.5820348894272, 1523.8342443863476, 1552.1383196551626, 1704.2544848705318, 1821.3714915513785, 2072.8974314501834], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [450.0692782455661, 404.49416415844655, 313.91854655552874, 513.2554550565544, 301.36081648159933, 378.990112500745, 448.4396538353888, 396.4649861139683, 474.5690950409793, 521.1115671756436, 485.26106823046587, 472.18916084556116, 324.06063537083395, 301.34486426449115, 494.9215509359224, 610.3962670823258, 494.5166613012885, 207.41068100727819, 444.04627328910124, 402.3512894327106, 476.3100350358476, 333.31807522235323, 522.2973952240278, 535.3219595377358, 524.0900210857512, 581.8724678543762, 422.2528337489097, 434.0691706670652, 436.8240472980061, 661.6159592547932, 396.6579929478396, 547.7884657115169, 651.8531711991656, 566.2845266606046, 471.86003114860046, 446.6963851529454, 448.61792996418836, 424.95196672329826, 403.4488300204863, 392.5410103720567, 535.3404559402551, 553.464731755489, 371.6164111055793, 577.2495858166325, 475.4865369808721, 480.4916666510705, 547.5765700093872, 505.37886972318256, 378.486763772741, 483.15558461917897, 278.52290169732174, 593.2335117293078, 490.1958185229646, 433.208974967606, 342.0717899135967, 520.9599051054887, 342.9906579082168, 483.7778050499246, 363.62907214388684, 571.8391485025387, 371.9746709941116, 527.645295866917, 663.9058844223248, 428.0759532538584, 438.54257472809644, 446.4982623275014, 476.00592372191494, 404.59006378144744, 482.90880388838445, 258.9326458155616, 261.83311843360497, 425.25846292680023, 304.73465629703253, 510.7041039414551, 375.2184267194576, 451.9213525772905, 659.5364761772611, 686.7323137008077, 376.88445188354257, 578.28856196396, 470.57383524499903, 536.7459932569215, 377.0723636159128, 358.0438244100905, 582.5578675888462, 614.642556205361, 378.26306049900245, 280.4297002137792, 464.8386096971562, 596.4995585775631, 440.98006966577736, 602.2976064348842, 620.6005767491595, 639.2198515631261, 401.20151081227647, 376.6311510982927, 539.4936935117344, 410.6804712946518, 442.60726244715664, 551.7330987052155, 437.6771918421779, 403.4501338605543, 525.34181426134, 406.91593244312526, 700.8180202160064, 463.1504438711041, 531.1363608550653, 558.3536001402858, 464.07894270003334, 544.2795095668296, 508.4280667942844, 537.346930332159, 446.5510331446752, 614.4901304649936, 591.6544963044352, 138.01774663795112, 431.31595861105154, 605.3019174352708, 641.2771418707252, 408.35857438388166, 399.01823174895344, 411.48327199733507, 332.6666127738054, 311.7708623045483, 503.2244560566616, 591.2347513803439, 558.5798062376354, 483.15718880519745, 677.4115356087196, 659.3847314536915, 567.5538634801308, 542.833275214485, 397.26945933256667, 432.3019406660928, 482.7571750878605, 483.2940731211255, 367.84787375054674, 487.70443213694176, 575.1840535456556, 433.67892488107185, 537.6326248200452, 494.73001915741105, 617.5452500917768, 427.5866090413103, 398.17634004518476, 325.5692319301224, 417.608655831781, 535.6973554105872, 498.5684084065738, 553.667022953648, 543.2383269123364, 407.07767099452576, 328.58027306093635, 459.62412405194635, 537.4061112987239, 660.102767053053, 392.73693515255223, 225.92324805929854, 440.6538828973701, 406.9062676344561, 287.13529033129726, 226.28158195700385, 478.6496804208587, 588.3767656514736, 489.99969936200034, 425.7080489839538, 378.87710850417886, 512.4920216246975, 469.86763888671595, 449.23567741640466, 502.0542429873749, 551.6352848377619, 641.8590165610196, 592.3637340640073, 672.0058098915226, 730.9261859675154, 440.6633990647887, 587.9184218341574, 454.2234150226555, 521.5780725953733, 389.886695682692, 528.8756283808219, 289.11487061922276, 589.0386350584208, 447.08965297881355, 376.7121288806738, 575.4583401441351, 532.7052636151244, 418.0695510407421, 332.0465698249642, 447.3044214499066, 513.3970605476766, 486.71177781254613, 344.3760197700161, 553.4344553228212, 616.6091460003336, 604.1777160990648, 593.9803869753414, 463.30558353438187, 483.9928457326827], "policy_predator_policy_reward": [559.2787774805943, 570.8331028488091, 620.6089762949806, 537.9481211460608, 704.2997493944719, 637.5308837019537, 580.55493147007, 620.5300388379725, 505.0875341171615, 534.9181116560324, 588.5932055856244, 497.9650620499156, 669.1282019298585, 650.6483264157469, 511.4662812501007, 424.2232543392094, 450.61170575122947, 432.6910254031016, 600.4991160160295, 623.3015370293875, 567.8513817466452, 621.8722882737936, 457.76511497337674, 445.59005947383406, 439.8599392783863, 398.67161319297526, 538.205617601122, 542.2321535283418, 379.1409135438357, 396.65243002717256, 510.9349954159996, 530.3368475865896, 334.1856419050263, 373.8960708015098, 535.1452196788774, 605.4781193870941, 516.4818616101022, 575.5164185383231, 442.36373879377675, 487.877486295604, 436.6796707924289, 446.7709428398871, 377.6022158654573, 418.96153738990915, 504.1137295298279, 543.366853042108, 512.9240216097421, 433.8697124552985, 585.2126949880774, 495.1801157187682, 287.82609343698795, 322.11511402449264, 536.7410508063144, 497.0695652050211, 452.96231631954373, 453.29582500363585, 430.9219704527992, 397.8201286784412, 467.53142892570986, 565.2039155129961, 397.5867221537679, 465.31774003259187, 497.16676812126593, 492.1534003147395, 541.8858368901074, 543.8132839257387, 608.0806811423578, 540.9804669082351, 368.93469313939215, 406.672295895494, 604.3367139501397, 521.2624930234063, 499.2132644962732, 502.76118822337963, 607.3013433599365, 585.0742036334314, 319.2933331927684, 302.87108727361056, 435.75988405850313, 497.0226042779393, 396.3168798478353, 458.9177765873893, 157.8248334303992, 249.87811333795182, 190.4914283116813, 315.1078464463669, 460.82392755891874, 414.92602943235397, 496.1960291315693, 471.3335500695267, 322.42896220647054, 372.783065378488, 294.55877585407075, 277.64720714795857, 532.8155715560974, 568.3684655799611, 550.8478550493664, 417.6048474387812, 565.8963890276577, 499.09058781741265, 599.730585337982, 524.7957635470513, 450.7792341711909, 461.2030169324445, 335.02753154998493, 238.30252493322092, 419.6197160563672, 365.33752557598694, 337.95801147427306, 318.01417113261436, 527.2086824917866, 575.2432806637013, 585.4335153415337, 509.25975269245987, 337.6921214947385, 277.2106763212676, 512.1718011765735, 577.9400289212302, 227.73832370430063, 193.2622382936691, 472.7495415635243, 436.6746913748651, 189.15428367222705, 209.9554126384887, 444.8910901016985, 480.3356851641748, 376.725429158447, 310.2582170648253, 339.1323879042523, 288.95053696978465, 483.60979953159296, 495.08672818491885, 395.3676093075933, 522.0608802030662, 405.42567956542007, 446.9377879528573, 217.82930145447207, 221.52003939468258, 472.0252631635894, 558.3135100122291, 538.220040690013, 521.3464459673256, 194.98871341176186, 218.15608751091656, 535.5199090203733, 526.6171180571391, 294.7747464585623, 221.64558424906787, 329.85130742217433, 378.68306677746875, 443.9414672398258, 467.2157592402681, 408.29565017892907, 426.26078206606707, 288.73016660807065, 308.2288593909505, 246.67890566419757, 242.39634467078457, 472.42767938503437, 382.2285000210053, 39.55754919319468, -11.093138930479654, 367.54028045058135, 472.4906496827515, 236.49703154408826, 225.54935250174196, 618.5435065072032, 540.1174443700125, 526.2323346147347, 587.2097231824597, 284.01287141052586, 247.12045337033854, 299.0649226326927, 260.59337538956373, 224.0069721024724, 224.24901326470345, 254.32186784580693, 250.77740589461433, 386.1173647247802, 395.37660410146526, 347.60620636329855, 363.87689102790176, 532.9112841906217, 585.8056026002715, 440.87418880197947, 556.9019536805628, 390.09725351649826, 294.93850019360013, 582.1817092248315, 611.2842047988889, 275.24290712260324, 287.8898552661626, 362.4986770820687, 358.55184499053445, 271.365926953351, 262.84495659402734, 228.95315818353401, 394.26023029344015, 533.2263233499954, 592.3726788331228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9019538916197414, "mean_inference_ms": 5.454557205387012, "mean_action_processing_ms": 0.8023053981107097, "mean_env_wait_ms": 0.6902979901846388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09715688228607178, "StateBufferConnector_ms": 0.08267009258270264, "ViewRequirementAgentConnector_ms": 0.97849440574646}, "num_episodes": 18, "episode_return_max": 2155.7344316436606, "episode_return_min": 541.8812825510154, "episode_return_mean": 1809.4269561357755, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 92.68836190586431, "num_env_steps_trained_throughput_per_sec": 92.68836190586431, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 108695.669, "restore_workers_time_ms": 0.026, "training_step_time_ms": 108695.585, "sample_time_ms": 10666.554, "learn_time_ms": 97979.167, "learn_throughput": 40.825, "synch_weights_time_ms": 46.942}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "8abce_00000", "date": "2024-08-16_11-58-13", "timestamp": 1723789693, "time_this_iter_s": 43.18753695487976, "time_total_s": 2202.4219295978546, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a432c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2202.4219295978546, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 57.59354838709677, "ram_util_percent": 77.41451612903224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2748329875645816, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.600058243262074, "policy_loss": -0.008159910396071614, "vf_loss": 9.606502559197644, "vf_explained_var": -0.04127815580241895, "kl": 0.011437433262558739, "entropy": 1.299499900000436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.241945689601242, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.600532329397858, "policy_loss": -0.000407340823027192, "vf_loss": 9.600855221319451, "vf_explained_var": -0.0464236145612424, "kl": 0.0067542555093594745, "entropy": 0.7651453292243695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 2155.7344316436606, "episode_reward_min": 541.8812825510154, "episode_reward_mean": 1730.4067411201113, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 138.01774663795112, "predator_policy": -11.093138930479654}, "policy_reward_max": {"prey_policy": 735.2622520508195, "predator_policy": 659.2174932314107}, "policy_reward_mean": {"prey_policy": 470.17973033941337, "predator_policy": 395.0236402206427}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1965.5681768359125, 1726.2310654819232, 1972.2558013280607, 1745.4297501775764, 2003.4587862038761, 1999.749173797607, 1942.0351590987639, 1481.6976208881113, 1957.2154095019068, 1769.2898363422642, 1655.51056208938, 1968.2035650851353, 1762.5244290473854, 2081.3020061121906, 1970.7399578714433, 2029.6571355539556, 1517.4484387388306, 1812.690788333952, 1817.413212958136, 2019.5153262901163, 1968.4332103444456, 1887.955502183943, 1862.5544849371436, 1142.819134794354, 1702.7996985522554, 1534.442717704053, 2028.8677474758126, 1738.4897036856175, 1832.0264113143155, 1879.0166990466262, 1918.6268672945346, 2059.327337997443, 1965.6536745877677, 1844.2399978080987, 1737.2985205703123, 1874.4472026277047, 1664.3306348737517, 2148.2269602819306, 2155.7344316436606, 1344.5750407583923, 2126.7297061441263, 1470.636278252578, 1719.9257366846775, 1043.5471713890693, 2019.6859827028761, 1728.7206412661071, 1964.8791919364473, 2089.0836664111275, 1746.9998895093163, 1818.4147157272605, 1294.9016467366441, 2039.201751602548, 2091.9291306347945, 1458.2766600557677, 1785.88259905282, 1469.7263419499982, 1760.7698055598644, 1861.473224386958, 1622.7608293578785, 1794.4679043507963, 1107.7354335468335, 1702.2163299378649, 541.8812825510154, 1907.057376205666, 1377.754132391783, 2050.0300810060903, 2032.545374100313, 1584.822852605999, 1793.8810486472812, 1851.1879812262127, 1533.6810946393668, 1757.2954564442757, 1630.2454214547142, 1996.8703924685376, 1821.5779243420288, 1793.1993574693593, 1943.5820348894272, 1523.8342443863476, 1552.1383196551626, 1704.2544848705318, 1821.3714915513785, 2072.8974314501834, 1633.9022202578692, 1615.748506660927, 1852.2437443106735, 960.8928891619095, 2025.9439308184644, 1469.8068730762434, 1855.7070742890965, 1705.4126021106595, 1305.6477629915873, 1002.0156246979973, 2098.9721331155424, 1851.969394353786, 1249.7100424797727, 560.4935704458769, 1539.4181572840146, 846.5603201777596, 2030.0746383522949, 1940.2800276559583], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [448.61792996418836, 424.95196672329826, 403.4488300204863, 392.5410103720567, 535.3404559402551, 553.464731755489, 371.6164111055793, 577.2495858166325, 475.4865369808721, 480.4916666510705, 547.5765700093872, 505.37886972318256, 378.486763772741, 483.15558461917897, 278.52290169732174, 593.2335117293078, 490.1958185229646, 433.208974967606, 342.0717899135967, 520.9599051054887, 342.9906579082168, 483.7778050499246, 363.62907214388684, 571.8391485025387, 371.9746709941116, 527.645295866917, 663.9058844223248, 428.0759532538584, 438.54257472809644, 446.4982623275014, 476.00592372191494, 404.59006378144744, 482.90880388838445, 258.9326458155616, 261.83311843360497, 425.25846292680023, 304.73465629703253, 510.7041039414551, 375.2184267194576, 451.9213525772905, 659.5364761772611, 686.7323137008077, 376.88445188354257, 578.28856196396, 470.57383524499903, 536.7459932569215, 377.0723636159128, 358.0438244100905, 582.5578675888462, 614.642556205361, 378.26306049900245, 280.4297002137792, 464.8386096971562, 596.4995585775631, 440.98006966577736, 602.2976064348842, 620.6005767491595, 639.2198515631261, 401.20151081227647, 376.6311510982927, 539.4936935117344, 410.6804712946518, 442.60726244715664, 551.7330987052155, 437.6771918421779, 403.4501338605543, 525.34181426134, 406.91593244312526, 700.8180202160064, 463.1504438711041, 531.1363608550653, 558.3536001402858, 464.07894270003334, 544.2795095668296, 508.4280667942844, 537.346930332159, 446.5510331446752, 614.4901304649936, 591.6544963044352, 138.01774663795112, 431.31595861105154, 605.3019174352708, 641.2771418707252, 408.35857438388166, 399.01823174895344, 411.48327199733507, 332.6666127738054, 311.7708623045483, 503.2244560566616, 591.2347513803439, 558.5798062376354, 483.15718880519745, 677.4115356087196, 659.3847314536915, 567.5538634801308, 542.833275214485, 397.26945933256667, 432.3019406660928, 482.7571750878605, 483.2940731211255, 367.84787375054674, 487.70443213694176, 575.1840535456556, 433.67892488107185, 537.6326248200452, 494.73001915741105, 617.5452500917768, 427.5866090413103, 398.17634004518476, 325.5692319301224, 417.608655831781, 535.6973554105872, 498.5684084065738, 553.667022953648, 543.2383269123364, 407.07767099452576, 328.58027306093635, 459.62412405194635, 537.4061112987239, 660.102767053053, 392.73693515255223, 225.92324805929854, 440.6538828973701, 406.9062676344561, 287.13529033129726, 226.28158195700385, 478.6496804208587, 588.3767656514736, 489.99969936200034, 425.7080489839538, 378.87710850417886, 512.4920216246975, 469.86763888671595, 449.23567741640466, 502.0542429873749, 551.6352848377619, 641.8590165610196, 592.3637340640073, 672.0058098915226, 730.9261859675154, 440.6633990647887, 587.9184218341574, 454.2234150226555, 521.5780725953733, 389.886695682692, 528.8756283808219, 289.11487061922276, 589.0386350584208, 447.08965297881355, 376.7121288806738, 575.4583401441351, 532.7052636151244, 418.0695510407421, 332.0465698249642, 447.3044214499066, 513.3970605476766, 486.71177781254613, 344.3760197700161, 553.4344553228212, 616.6091460003336, 604.1777160990648, 593.9803869753414, 463.30558353438187, 483.9928457326827, 486.8714669968992, 567.9219583688649, 240.43471183899626, 501.0108766153907, 467.49090638623284, 376.00334916325187, 396.2707553376012, 251.9357164306929, 347.67920636810146, 443.73835009019433, 367.8374074447495, 533.6538934287531, 507.41706049852553, 559.0995211921825, 556.5853290857054, 433.30745245277035, 318.219101593372, 485.6254111569477, 282.5135140475416, 369.94016671246635, 527.0304122345436, 540.5732136754953, 428.36075297913777, 478.7592863270011, 493.20488678082967, 424.84178185553236, 186.3555872005133, 313.78563892627113, 608.6133225518306, 327.25370276999524, 291.9125553959911, 287.04818512518557, 735.2622520508195, 474.2505692710528, 542.2764479047669, 615.8507180578549], "policy_predator_policy_reward": [516.4818616101022, 575.5164185383231, 442.36373879377675, 487.877486295604, 436.6796707924289, 446.7709428398871, 377.6022158654573, 418.96153738990915, 504.1137295298279, 543.366853042108, 512.9240216097421, 433.8697124552985, 585.2126949880774, 495.1801157187682, 287.82609343698795, 322.11511402449264, 536.7410508063144, 497.0695652050211, 452.96231631954373, 453.29582500363585, 430.9219704527992, 397.8201286784412, 467.53142892570986, 565.2039155129961, 397.5867221537679, 465.31774003259187, 497.16676812126593, 492.1534003147395, 541.8858368901074, 543.8132839257387, 608.0806811423578, 540.9804669082351, 368.93469313939215, 406.672295895494, 604.3367139501397, 521.2624930234063, 499.2132644962732, 502.76118822337963, 607.3013433599365, 585.0742036334314, 319.2933331927684, 302.87108727361056, 435.75988405850313, 497.0226042779393, 396.3168798478353, 458.9177765873893, 157.8248334303992, 249.87811333795182, 190.4914283116813, 315.1078464463669, 460.82392755891874, 414.92602943235397, 496.1960291315693, 471.3335500695267, 322.42896220647054, 372.783065378488, 294.55877585407075, 277.64720714795857, 532.8155715560974, 568.3684655799611, 550.8478550493664, 417.6048474387812, 565.8963890276577, 499.09058781741265, 599.730585337982, 524.7957635470513, 450.7792341711909, 461.2030169324445, 335.02753154998493, 238.30252493322092, 419.6197160563672, 365.33752557598694, 337.95801147427306, 318.01417113261436, 527.2086824917866, 575.2432806637013, 585.4335153415337, 509.25975269245987, 337.6921214947385, 277.2106763212676, 512.1718011765735, 577.9400289212302, 227.73832370430063, 193.2622382936691, 472.7495415635243, 436.6746913748651, 189.15428367222705, 209.9554126384887, 444.8910901016985, 480.3356851641748, 376.725429158447, 310.2582170648253, 339.1323879042523, 288.95053696978465, 483.60979953159296, 495.08672818491885, 395.3676093075933, 522.0608802030662, 405.42567956542007, 446.9377879528573, 217.82930145447207, 221.52003939468258, 472.0252631635894, 558.3135100122291, 538.220040690013, 521.3464459673256, 194.98871341176186, 218.15608751091656, 535.5199090203733, 526.6171180571391, 294.7747464585623, 221.64558424906787, 329.85130742217433, 378.68306677746875, 443.9414672398258, 467.2157592402681, 408.29565017892907, 426.26078206606707, 288.73016660807065, 308.2288593909505, 246.67890566419757, 242.39634467078457, 472.42767938503437, 382.2285000210053, 39.55754919319468, -11.093138930479654, 367.54028045058135, 472.4906496827515, 236.49703154408826, 225.54935250174196, 618.5435065072032, 540.1174443700125, 526.2323346147347, 587.2097231824597, 284.01287141052586, 247.12045337033854, 299.0649226326927, 260.59337538956373, 224.0069721024724, 224.24901326470345, 254.32186784580693, 250.77740589461433, 386.1173647247802, 395.37660410146526, 347.60620636329855, 363.87689102790176, 532.9112841906217, 585.8056026002715, 440.87418880197947, 556.9019536805628, 390.09725351649826, 294.93850019360013, 582.1817092248315, 611.2842047988889, 275.24290712260324, 287.8898552661626, 362.4986770820687, 358.55184499053445, 271.365926953351, 262.84495659402734, 228.95315818353401, 394.26023029344015, 533.2263233499954, 592.3726788331228, 243.92486974826386, 335.1839251438416, 462.8796231449694, 411.4232950615707, 518.0588728329247, 490.6906159282663, 138.90763950829609, 173.77877788531958, 659.2174932314107, 575.3088811287631, 299.2930336405086, 269.02253856223365, 401.7398480108716, 387.4506445875182, 354.3903901852307, 361.1294303869559, 256.58716896398533, 245.21608127728138, 175.26758739346838, 174.2943565445206, 505.9631176757595, 525.4053895297448, 455.25552836335595, 489.5938266842923, 167.05211035928443, 164.61126348412677, 23.12485576250732, 37.22748855658573, 254.41885910008213, 349.13227286210457, 121.47424955016626, 146.1253301064172, 403.26792181733975, 417.29389521308224, 399.650988732628, 382.5018729607108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9368312487515658, "mean_inference_ms": 5.557961047904313, "mean_action_processing_ms": 0.8190574179577578, "mean_env_wait_ms": 0.7035342514771947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08515727519989014, "StateBufferConnector_ms": 0.07527744770050049, "ViewRequirementAgentConnector_ms": 0.8183809518814087}, "num_episodes": 18, "episode_return_max": 2155.7344316436606, "episode_return_min": 541.8812825510154, "episode_return_mean": 1730.4067411201113, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.75016364934157, "num_env_steps_trained_throughput_per_sec": 104.75016364934157, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 108214.676, "restore_workers_time_ms": 0.025, "training_step_time_ms": 108214.593, "sample_time_ms": 10301.303, "learn_time_ms": 97860.869, "learn_throughput": 40.874, "synch_weights_time_ms": 49.607}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "8abce_00000", "date": "2024-08-16_11-58-51", "timestamp": 1723789731, "time_this_iter_s": 38.21643304824829, "time_total_s": 2240.638362646103, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4ab21f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2240.638362646103, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 53.67777777777778, "ram_util_percent": 77.52777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.146646361060874, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.252272395482139, "policy_loss": 0.0018554639037964599, "vf_loss": 9.248415449939708, "vf_explained_var": -0.11183122141020639, "kl": 0.01334316368027695, "entropy": 1.2707329514165404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2546757798188577, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.665264553998513, "policy_loss": -0.0038537982168789734, "vf_loss": 9.6690054101288, "vf_explained_var": -0.038338466390730845, "kl": 0.009036785847230444, "entropy": 0.6219624394146853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 2155.7344316436606, "episode_reward_min": 426.8604188393564, "episode_reward_mean": 1673.241862549169, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 133.30568801362534, "predator_policy": -11.093138930479654}, "policy_reward_max": {"prey_policy": 735.2622520508195, "predator_policy": 659.2174932314107}, "policy_reward_mean": {"prey_policy": 466.8454700549577, "predator_policy": 369.775461219627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1862.5544849371436, 1142.819134794354, 1702.7996985522554, 1534.442717704053, 2028.8677474758126, 1738.4897036856175, 1832.0264113143155, 1879.0166990466262, 1918.6268672945346, 2059.327337997443, 1965.6536745877677, 1844.2399978080987, 1737.2985205703123, 1874.4472026277047, 1664.3306348737517, 2148.2269602819306, 2155.7344316436606, 1344.5750407583923, 2126.7297061441263, 1470.636278252578, 1719.9257366846775, 1043.5471713890693, 2019.6859827028761, 1728.7206412661071, 1964.8791919364473, 2089.0836664111275, 1746.9998895093163, 1818.4147157272605, 1294.9016467366441, 2039.201751602548, 2091.9291306347945, 1458.2766600557677, 1785.88259905282, 1469.7263419499982, 1760.7698055598644, 1861.473224386958, 1622.7608293578785, 1794.4679043507963, 1107.7354335468335, 1702.2163299378649, 541.8812825510154, 1907.057376205666, 1377.754132391783, 2050.0300810060903, 2032.545374100313, 1584.822852605999, 1793.8810486472812, 1851.1879812262127, 1533.6810946393668, 1757.2954564442757, 1630.2454214547142, 1996.8703924685376, 1821.5779243420288, 1793.1993574693593, 1943.5820348894272, 1523.8342443863476, 1552.1383196551626, 1704.2544848705318, 1821.3714915513785, 2072.8974314501834, 1633.9022202578692, 1615.748506660927, 1852.2437443106735, 960.8928891619095, 2025.9439308184644, 1469.8068730762434, 1855.7070742890965, 1705.4126021106595, 1305.6477629915873, 1002.0156246979973, 2098.9721331155424, 1851.969394353786, 1249.7100424797727, 560.4935704458769, 1539.4181572840146, 846.5603201777596, 2030.0746383522949, 1940.2800276559583, 1952.4771683829906, 1487.7938622116276, 1684.059412257704, 1165.6658071394172, 1990.1387199745773, 1887.474982847665, 1220.3743949559928, 2075.353274217433, 1960.6423172183524, 1664.849618263486, 1751.540092807976, 1566.6211590401942, 1523.0655922771998, 1603.7468792123545, 426.8604188393564, 1896.3065221648399, 1839.28145543915, 1344.648167342884, 1873.3529744087489, 1587.979621496478, 828.4178771538416, 2007.1867395183958], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [470.57383524499903, 536.7459932569215, 377.0723636159128, 358.0438244100905, 582.5578675888462, 614.642556205361, 378.26306049900245, 280.4297002137792, 464.8386096971562, 596.4995585775631, 440.98006966577736, 602.2976064348842, 620.6005767491595, 639.2198515631261, 401.20151081227647, 376.6311510982927, 539.4936935117344, 410.6804712946518, 442.60726244715664, 551.7330987052155, 437.6771918421779, 403.4501338605543, 525.34181426134, 406.91593244312526, 700.8180202160064, 463.1504438711041, 531.1363608550653, 558.3536001402858, 464.07894270003334, 544.2795095668296, 508.4280667942844, 537.346930332159, 446.5510331446752, 614.4901304649936, 591.6544963044352, 138.01774663795112, 431.31595861105154, 605.3019174352708, 641.2771418707252, 408.35857438388166, 399.01823174895344, 411.48327199733507, 332.6666127738054, 311.7708623045483, 503.2244560566616, 591.2347513803439, 558.5798062376354, 483.15718880519745, 677.4115356087196, 659.3847314536915, 567.5538634801308, 542.833275214485, 397.26945933256667, 432.3019406660928, 482.7571750878605, 483.2940731211255, 367.84787375054674, 487.70443213694176, 575.1840535456556, 433.67892488107185, 537.6326248200452, 494.73001915741105, 617.5452500917768, 427.5866090413103, 398.17634004518476, 325.5692319301224, 417.608655831781, 535.6973554105872, 498.5684084065738, 553.667022953648, 543.2383269123364, 407.07767099452576, 328.58027306093635, 459.62412405194635, 537.4061112987239, 660.102767053053, 392.73693515255223, 225.92324805929854, 440.6538828973701, 406.9062676344561, 287.13529033129726, 226.28158195700385, 478.6496804208587, 588.3767656514736, 489.99969936200034, 425.7080489839538, 378.87710850417886, 512.4920216246975, 469.86763888671595, 449.23567741640466, 502.0542429873749, 551.6352848377619, 641.8590165610196, 592.3637340640073, 672.0058098915226, 730.9261859675154, 440.6633990647887, 587.9184218341574, 454.2234150226555, 521.5780725953733, 389.886695682692, 528.8756283808219, 289.11487061922276, 589.0386350584208, 447.08965297881355, 376.7121288806738, 575.4583401441351, 532.7052636151244, 418.0695510407421, 332.0465698249642, 447.3044214499066, 513.3970605476766, 486.71177781254613, 344.3760197700161, 553.4344553228212, 616.6091460003336, 604.1777160990648, 593.9803869753414, 463.30558353438187, 483.9928457326827, 486.8714669968992, 567.9219583688649, 240.43471183899626, 501.0108766153907, 467.49090638623284, 376.00334916325187, 396.2707553376012, 251.9357164306929, 347.67920636810146, 443.73835009019433, 367.8374074447495, 533.6538934287531, 507.41706049852553, 559.0995211921825, 556.5853290857054, 433.30745245277035, 318.219101593372, 485.6254111569477, 282.5135140475416, 369.94016671246635, 527.0304122345436, 540.5732136754953, 428.36075297913777, 478.7592863270011, 493.20488678082967, 424.84178185553236, 186.3555872005133, 313.78563892627113, 608.6133225518306, 327.25370276999524, 291.9125553959911, 287.04818512518557, 735.2622520508195, 474.2505692710528, 542.2764479047669, 615.8507180578549, 637.3620083127659, 570.7006474609301, 296.1727330164385, 468.00525126421576, 377.3581094118214, 349.8345827045273, 391.4159050376323, 485.870540959129, 533.6794195471807, 356.51735371900645, 467.34008674240056, 427.2582563598748, 345.5025440207915, 489.29243102643426, 588.3122793502071, 570.1467640655218, 477.3563217713513, 413.436775848486, 396.8818819844855, 611.447340430698, 566.3477615945529, 264.2852815132448, 487.830501642984, 359.0004610523664, 460.38218347903677, 625.8130876023727, 332.34321333582733, 432.23861482419045, 133.30568801362534, 261.43691856907117, 375.4150760033696, 494.73817171623824, 420.43464801157154, 500.2153451753245, 339.3095866546402, 363.44037048118656, 586.0447963488261, 696.1291066720152, 335.21288999684845, 408.0144954187586, 369.5536571434369, 295.15760322823064, 556.4359212580248, 544.5998327558365], "policy_predator_policy_reward": [396.3168798478353, 458.9177765873893, 157.8248334303992, 249.87811333795182, 190.4914283116813, 315.1078464463669, 460.82392755891874, 414.92602943235397, 496.1960291315693, 471.3335500695267, 322.42896220647054, 372.783065378488, 294.55877585407075, 277.64720714795857, 532.8155715560974, 568.3684655799611, 550.8478550493664, 417.6048474387812, 565.8963890276577, 499.09058781741265, 599.730585337982, 524.7957635470513, 450.7792341711909, 461.2030169324445, 335.02753154998493, 238.30252493322092, 419.6197160563672, 365.33752557598694, 337.95801147427306, 318.01417113261436, 527.2086824917866, 575.2432806637013, 585.4335153415337, 509.25975269245987, 337.6921214947385, 277.2106763212676, 512.1718011765735, 577.9400289212302, 227.73832370430063, 193.2622382936691, 472.7495415635243, 436.6746913748651, 189.15428367222705, 209.9554126384887, 444.8910901016985, 480.3356851641748, 376.725429158447, 310.2582170648253, 339.1323879042523, 288.95053696978465, 483.60979953159296, 495.08672818491885, 395.3676093075933, 522.0608802030662, 405.42567956542007, 446.9377879528573, 217.82930145447207, 221.52003939468258, 472.0252631635894, 558.3135100122291, 538.220040690013, 521.3464459673256, 194.98871341176186, 218.15608751091656, 535.5199090203733, 526.6171180571391, 294.7747464585623, 221.64558424906787, 329.85130742217433, 378.68306677746875, 443.9414672398258, 467.2157592402681, 408.29565017892907, 426.26078206606707, 288.73016660807065, 308.2288593909505, 246.67890566419757, 242.39634467078457, 472.42767938503437, 382.2285000210053, 39.55754919319468, -11.093138930479654, 367.54028045058135, 472.4906496827515, 236.49703154408826, 225.54935250174196, 618.5435065072032, 540.1174443700125, 526.2323346147347, 587.2097231824597, 284.01287141052586, 247.12045337033854, 299.0649226326927, 260.59337538956373, 224.0069721024724, 224.24901326470345, 254.32186784580693, 250.77740589461433, 386.1173647247802, 395.37660410146526, 347.60620636329855, 363.87689102790176, 532.9112841906217, 585.8056026002715, 440.87418880197947, 556.9019536805628, 390.09725351649826, 294.93850019360013, 582.1817092248315, 611.2842047988889, 275.24290712260324, 287.8898552661626, 362.4986770820687, 358.55184499053445, 271.365926953351, 262.84495659402734, 228.95315818353401, 394.26023029344015, 533.2263233499954, 592.3726788331228, 243.92486974826386, 335.1839251438416, 462.8796231449694, 411.4232950615707, 518.0588728329247, 490.6906159282663, 138.90763950829609, 173.77877788531958, 659.2174932314107, 575.3088811287631, 299.2930336405086, 269.02253856223365, 401.7398480108716, 387.4506445875182, 354.3903901852307, 361.1294303869559, 256.58716896398533, 245.21608127728138, 175.26758739346838, 174.2943565445206, 505.9631176757595, 525.4053895297448, 455.25552836335595, 489.5938266842923, 167.05211035928443, 164.61126348412677, 23.12485576250732, 37.22748855658573, 254.41885910008213, 349.13227286210457, 121.47424955016626, 146.1253301064172, 403.26792181733975, 417.29389521308224, 399.650988732628, 382.5018729607108, 432.6138599090758, 311.80065270021913, 352.17159869075437, 371.44427924022165, 469.9060747990682, 486.96064534228765, 122.72647885657108, 165.65288228608392, 586.5520096542639, 513.3899370541258, 519.9971441069541, 472.87949563843677, 226.7962400795023, 158.78317982926396, 459.7095237861354, 457.18470701557055, 535.215515846077, 534.6337037524368, 298.4169938181515, 358.1034020301526, 455.7094785929802, 465.19757110720235, 361.19770572135377, 358.59249062348954, 193.58628549240092, 243.28403570338995, 455.79932212155427, 383.36572893078295, 27.019072932288832, 5.09873932437165, 482.3038502832246, 543.8494241620078, 454.39184347097154, 464.2396187812844, 312.922108468206, 328.9761017388522, 277.68123744724306, 313.4978339406617, 419.1865839488336, 425.56565213203766, 74.34411817133966, 89.36249861083414, 346.34141819733236, 559.8095673072021]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9783433802475867, "mean_inference_ms": 5.679713952033133, "mean_action_processing_ms": 0.8364738614839071, "mean_env_wait_ms": 0.7186365154503398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08899223804473877, "StateBufferConnector_ms": 0.035189151763916016, "ViewRequirementAgentConnector_ms": 0.7545770406723022}, "num_episodes": 22, "episode_return_max": 2155.7344316436606, "episode_return_min": 426.8604188393564, "episode_return_mean": 1673.241862549169, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 94.72014990804975, "num_env_steps_trained_throughput_per_sec": 94.72014990804975, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 108310.189, "restore_workers_time_ms": 0.026, "training_step_time_ms": 108310.107, "sample_time_ms": 10498.578, "learn_time_ms": 97758.618, "learn_throughput": 40.917, "synch_weights_time_ms": 50.264}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "8abce_00000", "date": "2024-08-16_11-59-34", "timestamp": 1723789774, "time_this_iter_s": 42.27319622039795, "time_total_s": 2282.911558866501, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a55d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2282.911558866501, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 54.51833333333333, "ram_util_percent": 76.815}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6420115685652172, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.43488150046616, "policy_loss": -0.0002499609676845096, "vf_loss": 9.433499974548502, "vf_explained_var": -0.018856948204141445, "kl": 0.010876568907982782, "entropy": 1.2686418030627822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4944336563506453, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.467834147700557, "policy_loss": -0.002273904068750285, "vf_loss": 9.470045483301556, "vf_explained_var": -0.02011420966456176, "kl": 0.005003924464775858, "entropy": 0.6471947431564331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 2128.615589178312, "episode_reward_min": 426.8604188393564, "episode_reward_mean": 1623.2189048911487, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 133.30568801362534, "predator_policy": -11.093138930479654}, "policy_reward_max": {"prey_policy": 735.2622520508195, "predator_policy": 659.2174932314107}, "policy_reward_mean": {"prey_policy": 457.3074530115898, "predator_policy": 354.30199943398475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1728.7206412661071, 1964.8791919364473, 2089.0836664111275, 1746.9998895093163, 1818.4147157272605, 1294.9016467366441, 2039.201751602548, 2091.9291306347945, 1458.2766600557677, 1785.88259905282, 1469.7263419499982, 1760.7698055598644, 1861.473224386958, 1622.7608293578785, 1794.4679043507963, 1107.7354335468335, 1702.2163299378649, 541.8812825510154, 1907.057376205666, 1377.754132391783, 2050.0300810060903, 2032.545374100313, 1584.822852605999, 1793.8810486472812, 1851.1879812262127, 1533.6810946393668, 1757.2954564442757, 1630.2454214547142, 1996.8703924685376, 1821.5779243420288, 1793.1993574693593, 1943.5820348894272, 1523.8342443863476, 1552.1383196551626, 1704.2544848705318, 1821.3714915513785, 2072.8974314501834, 1633.9022202578692, 1615.748506660927, 1852.2437443106735, 960.8928891619095, 2025.9439308184644, 1469.8068730762434, 1855.7070742890965, 1705.4126021106595, 1305.6477629915873, 1002.0156246979973, 2098.9721331155424, 1851.969394353786, 1249.7100424797727, 560.4935704458769, 1539.4181572840146, 846.5603201777596, 2030.0746383522949, 1940.2800276559583, 1952.4771683829906, 1487.7938622116276, 1684.059412257704, 1165.6658071394172, 1990.1387199745773, 1887.474982847665, 1220.3743949559928, 2075.353274217433, 1960.6423172183524, 1664.849618263486, 1751.540092807976, 1566.6211590401942, 1523.0655922771998, 1603.7468792123545, 426.8604188393564, 1896.3065221648399, 1839.28145543915, 1344.648167342884, 1873.3529744087489, 1587.979621496478, 828.4178771538416, 2007.1867395183958, 1474.394893866409, 1470.197418092551, 1814.1875272345676, 2128.615589178312, 1157.2922877816234, 1268.369929358742, 1742.2708278940054, 1359.5173753103581, 1929.4439755729893, 1374.9022886521263, 1296.1412449123159, 1561.4680472386235, 1561.5186050885964, 873.9304639160802, 1871.8793747404175, 1638.6819575657803, 1494.5406697940532, 1132.7619883650914, 1712.6736865666132, 2000.5804163715711, 1866.4791142603358, 1687.185034688803, 1394.673658875087], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [558.5798062376354, 483.15718880519745, 677.4115356087196, 659.3847314536915, 567.5538634801308, 542.833275214485, 397.26945933256667, 432.3019406660928, 482.7571750878605, 483.2940731211255, 367.84787375054674, 487.70443213694176, 575.1840535456556, 433.67892488107185, 537.6326248200452, 494.73001915741105, 617.5452500917768, 427.5866090413103, 398.17634004518476, 325.5692319301224, 417.608655831781, 535.6973554105872, 498.5684084065738, 553.667022953648, 543.2383269123364, 407.07767099452576, 328.58027306093635, 459.62412405194635, 537.4061112987239, 660.102767053053, 392.73693515255223, 225.92324805929854, 440.6538828973701, 406.9062676344561, 287.13529033129726, 226.28158195700385, 478.6496804208587, 588.3767656514736, 489.99969936200034, 425.7080489839538, 378.87710850417886, 512.4920216246975, 469.86763888671595, 449.23567741640466, 502.0542429873749, 551.6352848377619, 641.8590165610196, 592.3637340640073, 672.0058098915226, 730.9261859675154, 440.6633990647887, 587.9184218341574, 454.2234150226555, 521.5780725953733, 389.886695682692, 528.8756283808219, 289.11487061922276, 589.0386350584208, 447.08965297881355, 376.7121288806738, 575.4583401441351, 532.7052636151244, 418.0695510407421, 332.0465698249642, 447.3044214499066, 513.3970605476766, 486.71177781254613, 344.3760197700161, 553.4344553228212, 616.6091460003336, 604.1777160990648, 593.9803869753414, 463.30558353438187, 483.9928457326827, 486.8714669968992, 567.9219583688649, 240.43471183899626, 501.0108766153907, 467.49090638623284, 376.00334916325187, 396.2707553376012, 251.9357164306929, 347.67920636810146, 443.73835009019433, 367.8374074447495, 533.6538934287531, 507.41706049852553, 559.0995211921825, 556.5853290857054, 433.30745245277035, 318.219101593372, 485.6254111569477, 282.5135140475416, 369.94016671246635, 527.0304122345436, 540.5732136754953, 428.36075297913777, 478.7592863270011, 493.20488678082967, 424.84178185553236, 186.3555872005133, 313.78563892627113, 608.6133225518306, 327.25370276999524, 291.9125553959911, 287.04818512518557, 735.2622520508195, 474.2505692710528, 542.2764479047669, 615.8507180578549, 637.3620083127659, 570.7006474609301, 296.1727330164385, 468.00525126421576, 377.3581094118214, 349.8345827045273, 391.4159050376323, 485.870540959129, 533.6794195471807, 356.51735371900645, 467.34008674240056, 427.2582563598748, 345.5025440207915, 489.29243102643426, 588.3122793502071, 570.1467640655218, 477.3563217713513, 413.436775848486, 396.8818819844855, 611.447340430698, 566.3477615945529, 264.2852815132448, 487.830501642984, 359.0004610523664, 460.38218347903677, 625.8130876023727, 332.34321333582733, 432.23861482419045, 133.30568801362534, 261.43691856907117, 375.4150760033696, 494.73817171623824, 420.43464801157154, 500.2153451753245, 339.3095866546402, 363.44037048118656, 586.0447963488261, 696.1291066720152, 335.21288999684845, 408.0144954187586, 369.5536571434369, 295.15760322823064, 556.4359212580248, 544.5998327558365, 485.7939715736015, 487.13895734372585, 392.56218090250655, 434.7203605098358, 453.743542410923, 403.5969463274505, 574.706143016326, 687.1590916200976, 530.1066080583516, 325.7622771421765, 367.6790142449585, 175.7122673090273, 429.808146047256, 425.8458214998969, 566.5728776906071, 420.2600419595574, 481.55175630360486, 389.3571864291198, 398.5251308132382, 337.0950925677953, 235.85088696472437, 560.6872806292629, 505.2633712168367, 490.35305143009526, 629.6752741557115, 506.08647929304067, 337.9796002393992, 303.26645713526466, 580.8842308621356, 446.0650277294734, 448.9747899897537, 516.4745932298533, 508.29799459806816, 431.3912116216903, 523.4097724713498, 237.80996943244742, 442.4029700591457, 357.9006201316452, 558.4466434265514, 412.918599262584, 418.85769746961296, 351.5697094497304, 436.0474779407131, 514.1559962248908, 420.51215909664046, 341.87210708524145], "policy_predator_policy_reward": [376.725429158447, 310.2582170648253, 339.1323879042523, 288.95053696978465, 483.60979953159296, 495.08672818491885, 395.3676093075933, 522.0608802030662, 405.42567956542007, 446.9377879528573, 217.82930145447207, 221.52003939468258, 472.0252631635894, 558.3135100122291, 538.220040690013, 521.3464459673256, 194.98871341176186, 218.15608751091656, 535.5199090203733, 526.6171180571391, 294.7747464585623, 221.64558424906787, 329.85130742217433, 378.68306677746875, 443.9414672398258, 467.2157592402681, 408.29565017892907, 426.26078206606707, 288.73016660807065, 308.2288593909505, 246.67890566419757, 242.39634467078457, 472.42767938503437, 382.2285000210053, 39.55754919319468, -11.093138930479654, 367.54028045058135, 472.4906496827515, 236.49703154408826, 225.54935250174196, 618.5435065072032, 540.1174443700125, 526.2323346147347, 587.2097231824597, 284.01287141052586, 247.12045337033854, 299.0649226326927, 260.59337538956373, 224.0069721024724, 224.24901326470345, 254.32186784580693, 250.77740589461433, 386.1173647247802, 395.37660410146526, 347.60620636329855, 363.87689102790176, 532.9112841906217, 585.8056026002715, 440.87418880197947, 556.9019536805628, 390.09725351649826, 294.93850019360013, 582.1817092248315, 611.2842047988889, 275.24290712260324, 287.8898552661626, 362.4986770820687, 358.55184499053445, 271.365926953351, 262.84495659402734, 228.95315818353401, 394.26023029344015, 533.2263233499954, 592.3726788331228, 243.92486974826386, 335.1839251438416, 462.8796231449694, 411.4232950615707, 518.0588728329247, 490.6906159282663, 138.90763950829609, 173.77877788531958, 659.2174932314107, 575.3088811287631, 299.2930336405086, 269.02253856223365, 401.7398480108716, 387.4506445875182, 354.3903901852307, 361.1294303869559, 256.58716896398533, 245.21608127728138, 175.26758739346838, 174.2943565445206, 505.9631176757595, 525.4053895297448, 455.25552836335595, 489.5938266842923, 167.05211035928443, 164.61126348412677, 23.12485576250732, 37.22748855658573, 254.41885910008213, 349.13227286210457, 121.47424955016626, 146.1253301064172, 403.26792181733975, 417.29389521308224, 399.650988732628, 382.5018729607108, 432.6138599090758, 311.80065270021913, 352.17159869075437, 371.44427924022165, 469.9060747990682, 486.96064534228765, 122.72647885657108, 165.65288228608392, 586.5520096542639, 513.3899370541258, 519.9971441069541, 472.87949563843677, 226.7962400795023, 158.78317982926396, 459.7095237861354, 457.18470701557055, 535.215515846077, 534.6337037524368, 298.4169938181515, 358.1034020301526, 455.7094785929802, 465.19757110720235, 361.19770572135377, 358.59249062348954, 193.58628549240092, 243.28403570338995, 455.79932212155427, 383.36572893078295, 27.019072932288832, 5.09873932437165, 482.3038502832246, 543.8494241620078, 454.39184347097154, 464.2396187812844, 312.922108468206, 328.9761017388522, 277.68123744724306, 313.4978339406617, 419.1865839488336, 425.56565213203766, 74.34411817133966, 89.36249861083414, 346.34141819733236, 559.8095673072021, 243.0331779747971, 258.42878697428415, 360.73281909081453, 282.18205758939564, 493.3727934191379, 463.47424507705597, 445.92668046274906, 420.8236740791379, 155.02681068882652, 146.3965918922691, 349.1576889576653, 375.8209588470896, 433.92247018496477, 452.6943901618879, 225.2015776028721, 147.48287805732284, 538.2520337604005, 520.2829990798638, 308.54355072688156, 330.73851454421185, 265.157003748327, 234.44607357000385, 286.6995574833886, 279.15206710830404, 203.30821206853093, 222.44863957131332, 122.82626656521924, 109.8581399761979, 420.7351929013474, 424.19492324746244, 407.6068715456451, 265.6257028005285, 281.65026418053696, 273.2011993937556, 193.30454579030473, 178.2377006709903, 424.2466632694057, 488.1234331064158, 550.848453369505, 478.3667203129316, 536.064454685533, 559.9872526554602, 389.80146978269363, 347.18009074050724, 341.2207597880949, 291.0686329051092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.009311378761374, "mean_inference_ms": 5.78216500840349, "mean_action_processing_ms": 0.8488437702999697, "mean_env_wait_ms": 0.7311874488736149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020368337631225586, "StateBufferConnector_ms": 0.01917088031768799, "ViewRequirementAgentConnector_ms": 0.5848891735076904}, "num_episodes": 23, "episode_return_max": 2128.615589178312, "episode_return_min": 426.8604188393564, "episode_return_mean": 1623.2189048911487, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 120.78714015451152, "num_env_steps_trained_throughput_per_sec": 120.78714015451152, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 107322.744, "restore_workers_time_ms": 0.027, "training_step_time_ms": 107322.658, "sample_time_ms": 10111.069, "learn_time_ms": 97154.869, "learn_throughput": 41.171, "synch_weights_time_ms": 53.821}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "8abce_00000", "date": "2024-08-16_12-00-07", "timestamp": 1723789807, "time_this_iter_s": 33.19969606399536, "time_total_s": 2316.111254930496, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a67b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2316.111254930496, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 45.885106382978734, "ram_util_percent": 73.31489361702128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9386841433073476, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.329115524493828, "policy_loss": -0.0020249814694382686, "vf_loss": 9.329623610885054, "vf_explained_var": -0.059861023463900126, "kl": 0.010112322617269494, "entropy": 1.2461395226458394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1468907050985506, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.617065819735249, "policy_loss": -0.0017766855427965758, "vf_loss": 9.618792235157477, "vf_explained_var": -0.03817279616360942, "kl": 0.004022769021075573, "entropy": 0.7176940357874311, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 2128.615589178312, "episode_reward_min": 426.8604188393564, "episode_reward_mean": 1632.2274252668185, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 133.30568801362534, "predator_policy": 5.09873932437165}, "policy_reward_max": {"prey_policy": 735.2622520508195, "predator_policy": 659.2174932314107}, "policy_reward_mean": {"prey_policy": 454.88276109311664, "predator_policy": 361.23095154029284}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1907.057376205666, 1377.754132391783, 2050.0300810060903, 2032.545374100313, 1584.822852605999, 1793.8810486472812, 1851.1879812262127, 1533.6810946393668, 1757.2954564442757, 1630.2454214547142, 1996.8703924685376, 1821.5779243420288, 1793.1993574693593, 1943.5820348894272, 1523.8342443863476, 1552.1383196551626, 1704.2544848705318, 1821.3714915513785, 2072.8974314501834, 1633.9022202578692, 1615.748506660927, 1852.2437443106735, 960.8928891619095, 2025.9439308184644, 1469.8068730762434, 1855.7070742890965, 1705.4126021106595, 1305.6477629915873, 1002.0156246979973, 2098.9721331155424, 1851.969394353786, 1249.7100424797727, 560.4935704458769, 1539.4181572840146, 846.5603201777596, 2030.0746383522949, 1940.2800276559583, 1952.4771683829906, 1487.7938622116276, 1684.059412257704, 1165.6658071394172, 1990.1387199745773, 1887.474982847665, 1220.3743949559928, 2075.353274217433, 1960.6423172183524, 1664.849618263486, 1751.540092807976, 1566.6211590401942, 1523.0655922771998, 1603.7468792123545, 426.8604188393564, 1896.3065221648399, 1839.28145543915, 1344.648167342884, 1873.3529744087489, 1587.979621496478, 828.4178771538416, 2007.1867395183958, 1474.394893866409, 1470.197418092551, 1814.1875272345676, 2128.615589178312, 1157.2922877816234, 1268.369929358742, 1742.2708278940054, 1359.5173753103581, 1929.4439755729893, 1374.9022886521263, 1296.1412449123159, 1561.4680472386235, 1561.5186050885964, 873.9304639160802, 1871.8793747404175, 1638.6819575657803, 1494.5406697940532, 1132.7619883650914, 1712.6736865666132, 2000.5804163715711, 1866.4791142603358, 1687.185034688803, 1394.673658875087, 2018.0375679433764, 1763.6975034545094, 1560.4701318858845, 1789.953996676323, 1911.4040090158908, 1849.7235096081758, 1466.906987331182, 1299.7701138494947, 1572.457481971167, 1839.5750186155044, 1517.5666231775651, 2056.758411875544, 2044.5494836388498, 1435.7344176562146, 1127.4188641660073, 2087.062999853039, 1771.288595927069, 1667.7973654952327], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [478.6496804208587, 588.3767656514736, 489.99969936200034, 425.7080489839538, 378.87710850417886, 512.4920216246975, 469.86763888671595, 449.23567741640466, 502.0542429873749, 551.6352848377619, 641.8590165610196, 592.3637340640073, 672.0058098915226, 730.9261859675154, 440.6633990647887, 587.9184218341574, 454.2234150226555, 521.5780725953733, 389.886695682692, 528.8756283808219, 289.11487061922276, 589.0386350584208, 447.08965297881355, 376.7121288806738, 575.4583401441351, 532.7052636151244, 418.0695510407421, 332.0465698249642, 447.3044214499066, 513.3970605476766, 486.71177781254613, 344.3760197700161, 553.4344553228212, 616.6091460003336, 604.1777160990648, 593.9803869753414, 463.30558353438187, 483.9928457326827, 486.8714669968992, 567.9219583688649, 240.43471183899626, 501.0108766153907, 467.49090638623284, 376.00334916325187, 396.2707553376012, 251.9357164306929, 347.67920636810146, 443.73835009019433, 367.8374074447495, 533.6538934287531, 507.41706049852553, 559.0995211921825, 556.5853290857054, 433.30745245277035, 318.219101593372, 485.6254111569477, 282.5135140475416, 369.94016671246635, 527.0304122345436, 540.5732136754953, 428.36075297913777, 478.7592863270011, 493.20488678082967, 424.84178185553236, 186.3555872005133, 313.78563892627113, 608.6133225518306, 327.25370276999524, 291.9125553959911, 287.04818512518557, 735.2622520508195, 474.2505692710528, 542.2764479047669, 615.8507180578549, 637.3620083127659, 570.7006474609301, 296.1727330164385, 468.00525126421576, 377.3581094118214, 349.8345827045273, 391.4159050376323, 485.870540959129, 533.6794195471807, 356.51735371900645, 467.34008674240056, 427.2582563598748, 345.5025440207915, 489.29243102643426, 588.3122793502071, 570.1467640655218, 477.3563217713513, 413.436775848486, 396.8818819844855, 611.447340430698, 566.3477615945529, 264.2852815132448, 487.830501642984, 359.0004610523664, 460.38218347903677, 625.8130876023727, 332.34321333582733, 432.23861482419045, 133.30568801362534, 261.43691856907117, 375.4150760033696, 494.73817171623824, 420.43464801157154, 500.2153451753245, 339.3095866546402, 363.44037048118656, 586.0447963488261, 696.1291066720152, 335.21288999684845, 408.0144954187586, 369.5536571434369, 295.15760322823064, 556.4359212580248, 544.5998327558365, 485.7939715736015, 487.13895734372585, 392.56218090250655, 434.7203605098358, 453.743542410923, 403.5969463274505, 574.706143016326, 687.1590916200976, 530.1066080583516, 325.7622771421765, 367.6790142449585, 175.7122673090273, 429.808146047256, 425.8458214998969, 566.5728776906071, 420.2600419595574, 481.55175630360486, 389.3571864291198, 398.5251308132382, 337.0950925677953, 235.85088696472437, 560.6872806292629, 505.2633712168367, 490.35305143009526, 629.6752741557115, 506.08647929304067, 337.9796002393992, 303.26645713526466, 580.8842308621356, 446.0650277294734, 448.9747899897537, 516.4745932298533, 508.29799459806816, 431.3912116216903, 523.4097724713498, 237.80996943244742, 442.4029700591457, 357.9006201316452, 558.4466434265514, 412.918599262584, 418.85769746961296, 351.5697094497304, 436.0474779407131, 514.1559962248908, 420.51215909664046, 341.87210708524145, 508.9812618929065, 492.2536767196082, 539.5550975782478, 506.83341163249645, 474.0807462429273, 484.9882729908358, 350.165019467063, 486.5420286601441, 466.17197820017367, 372.94240010049265, 481.38186277804056, 379.8511062187819, 416.68116059639607, 589.5664390491297, 428.59460083752145, 405.16249771849766, 498.59080999226114, 211.82212094051263, 417.8437518081689, 439.97424197418786, 406.24660368481744, 458.00425150855983, 610.4474949836409, 566.9185214328595, 505.24793486934317, 652.555372545076, 396.22638159714484, 412.25487972893444, 253.30804258792256, 384.65620661712813, 542.525611183553, 486.6836835668791, 524.5366833939278, 495.0815685477849, 340.73692966912574, 399.0552954039328], "policy_predator_policy_reward": [367.54028045058135, 472.4906496827515, 236.49703154408826, 225.54935250174196, 618.5435065072032, 540.1174443700125, 526.2323346147347, 587.2097231824597, 284.01287141052586, 247.12045337033854, 299.0649226326927, 260.59337538956373, 224.0069721024724, 224.24901326470345, 254.32186784580693, 250.77740589461433, 386.1173647247802, 395.37660410146526, 347.60620636329855, 363.87689102790176, 532.9112841906217, 585.8056026002715, 440.87418880197947, 556.9019536805628, 390.09725351649826, 294.93850019360013, 582.1817092248315, 611.2842047988889, 275.24290712260324, 287.8898552661626, 362.4986770820687, 358.55184499053445, 271.365926953351, 262.84495659402734, 228.95315818353401, 394.26023029344015, 533.2263233499954, 592.3726788331228, 243.92486974826386, 335.1839251438416, 462.8796231449694, 411.4232950615707, 518.0588728329247, 490.6906159282663, 138.90763950829609, 173.77877788531958, 659.2174932314107, 575.3088811287631, 299.2930336405086, 269.02253856223365, 401.7398480108716, 387.4506445875182, 354.3903901852307, 361.1294303869559, 256.58716896398533, 245.21608127728138, 175.26758739346838, 174.2943565445206, 505.9631176757595, 525.4053895297448, 455.25552836335595, 489.5938266842923, 167.05211035928443, 164.61126348412677, 23.12485576250732, 37.22748855658573, 254.41885910008213, 349.13227286210457, 121.47424955016626, 146.1253301064172, 403.26792181733975, 417.29389521308224, 399.650988732628, 382.5018729607108, 432.6138599090758, 311.80065270021913, 352.17159869075437, 371.44427924022165, 469.9060747990682, 486.96064534228765, 122.72647885657108, 165.65288228608392, 586.5520096542639, 513.3899370541258, 519.9971441069541, 472.87949563843677, 226.7962400795023, 158.78317982926396, 459.7095237861354, 457.18470701557055, 535.215515846077, 534.6337037524368, 298.4169938181515, 358.1034020301526, 455.7094785929802, 465.19757110720235, 361.19770572135377, 358.59249062348954, 193.58628549240092, 243.28403570338995, 455.79932212155427, 383.36572893078295, 27.019072932288832, 5.09873932437165, 482.3038502832246, 543.8494241620078, 454.39184347097154, 464.2396187812844, 312.922108468206, 328.9761017388522, 277.68123744724306, 313.4978339406617, 419.1865839488336, 425.56565213203766, 74.34411817133966, 89.36249861083414, 346.34141819733236, 559.8095673072021, 243.0331779747971, 258.42878697428415, 360.73281909081453, 282.18205758939564, 493.3727934191379, 463.47424507705597, 445.92668046274906, 420.8236740791379, 155.02681068882652, 146.3965918922691, 349.1576889576653, 375.8209588470896, 433.92247018496477, 452.6943901618879, 225.2015776028721, 147.48287805732284, 538.2520337604005, 520.2829990798638, 308.54355072688156, 330.73851454421185, 265.157003748327, 234.44607357000385, 286.6995574833886, 279.15206710830404, 203.30821206853093, 222.44863957131332, 122.82626656521924, 109.8581399761979, 420.7351929013474, 424.19492324746244, 407.6068715456451, 265.6257028005285, 281.65026418053696, 273.2011993937556, 193.30454579030473, 178.2377006709903, 424.2466632694057, 488.1234331064158, 550.848453369505, 478.3667203129316, 536.064454685533, 559.9872526554602, 389.80146978269363, 347.18009074050724, 341.2207597880949, 291.0686329051092, 540.1352882636684, 476.66734106719315, 421.33462248624664, 295.9743717575195, 278.6179399688289, 322.7831726832908, 466.1079268115003, 487.13902173761784, 533.7393505481535, 538.5502801670718, 490.724846351778, 497.7656942595735, 241.63337512077243, 219.02601256488535, 231.9540203685851, 234.05899492489135, 439.6797961224843, 422.36475491590704, 481.3571449603419, 500.3998798728091, 314.00608268217167, 339.3096853020156, 479.96304505501996, 399.42935040402347, 453.65101431673037, 433.0951619076978, 307.13596328847245, 320.1171930416622, 222.41837158090848, 267.0362433800474, 524.3409086977458, 533.5127964048606, 350.67188075193434, 400.9984632334261, 485.38138828084243, 442.6237521413328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.034677305759851, "mean_inference_ms": 5.856864952907831, "mean_action_processing_ms": 0.860778189533347, "mean_env_wait_ms": 0.7411032555028167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03348243236541748, "StateBufferConnector_ms": 0.01002192497253418, "ViewRequirementAgentConnector_ms": 0.6014829874038696}, "num_episodes": 18, "episode_return_max": 2128.615589178312, "episode_return_min": 426.8604188393564, "episode_return_mean": 1632.2274252668185, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 122.09868437796011, "num_env_steps_trained_throughput_per_sec": 122.09868437796011, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 106278.878, "restore_workers_time_ms": 0.027, "training_step_time_ms": 106278.789, "sample_time_ms": 10040.594, "learn_time_ms": 96182.531, "learn_throughput": 41.588, "synch_weights_time_ms": 52.765}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "8abce_00000", "date": "2024-08-16_12-00-40", "timestamp": 1723789840, "time_this_iter_s": 32.76813793182373, "time_total_s": 2348.87939286232, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a435f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2348.87939286232, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 46.491489361702136, "ram_util_percent": 75.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1782478200695503, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.207316303253174, "policy_loss": -0.0035580537498746284, "vf_loss": 9.209539184368477, "vf_explained_var": -0.11523434094020299, "kl": 0.008901186282848073, "entropy": 1.2535091698485077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6420737567323225, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.73866104347996, "policy_loss": -0.000712926962866236, "vf_loss": 9.739350239688127, "vf_explained_var": -0.012620341651654118, "kl": 0.0037978660672765264, "entropy": 0.7322279554195505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 2163.0858676765242, "episode_reward_min": 426.8604188393564, "episode_reward_mean": 1652.1644631924237, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 133.30568801362534, "predator_policy": 5.09873932437165}, "policy_reward_max": {"prey_policy": 735.2622520508195, "predator_policy": 659.2174932314107}, "policy_reward_mean": {"prey_policy": 443.38713511271607, "predator_policy": 382.6950964834957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2072.8974314501834, 1633.9022202578692, 1615.748506660927, 1852.2437443106735, 960.8928891619095, 2025.9439308184644, 1469.8068730762434, 1855.7070742890965, 1705.4126021106595, 1305.6477629915873, 1002.0156246979973, 2098.9721331155424, 1851.969394353786, 1249.7100424797727, 560.4935704458769, 1539.4181572840146, 846.5603201777596, 2030.0746383522949, 1940.2800276559583, 1952.4771683829906, 1487.7938622116276, 1684.059412257704, 1165.6658071394172, 1990.1387199745773, 1887.474982847665, 1220.3743949559928, 2075.353274217433, 1960.6423172183524, 1664.849618263486, 1751.540092807976, 1566.6211590401942, 1523.0655922771998, 1603.7468792123545, 426.8604188393564, 1896.3065221648399, 1839.28145543915, 1344.648167342884, 1873.3529744087489, 1587.979621496478, 828.4178771538416, 2007.1867395183958, 1474.394893866409, 1470.197418092551, 1814.1875272345676, 2128.615589178312, 1157.2922877816234, 1268.369929358742, 1742.2708278940054, 1359.5173753103581, 1929.4439755729893, 1374.9022886521263, 1296.1412449123159, 1561.4680472386235, 1561.5186050885964, 873.9304639160802, 1871.8793747404175, 1638.6819575657803, 1494.5406697940532, 1132.7619883650914, 1712.6736865666132, 2000.5804163715711, 1866.4791142603358, 1687.185034688803, 1394.673658875087, 2018.0375679433764, 1763.6975034545094, 1560.4701318858845, 1789.953996676323, 1911.4040090158908, 1849.7235096081758, 1466.906987331182, 1299.7701138494947, 1572.457481971167, 1839.5750186155044, 1517.5666231775651, 2056.758411875544, 2044.5494836388498, 1435.7344176562146, 1127.4188641660073, 2087.062999853039, 1771.288595927069, 1667.7973654952327, 1907.0973133267446, 2052.8249007748764, 1769.0439371407876, 1705.2139972037303, 1019.6339711239002, 2042.090171454927, 1945.5194061685056, 1961.2724163409782, 1832.2075266163838, 1950.1631327884866, 1863.2264444352577, 1984.228030802866, 1907.9575966341195, 2064.9176860917696, 1936.0254991514555, 1877.3189012045889, 1687.206061979049, 2163.0858676765242], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [463.30558353438187, 483.9928457326827, 486.8714669968992, 567.9219583688649, 240.43471183899626, 501.0108766153907, 467.49090638623284, 376.00334916325187, 396.2707553376012, 251.9357164306929, 347.67920636810146, 443.73835009019433, 367.8374074447495, 533.6538934287531, 507.41706049852553, 559.0995211921825, 556.5853290857054, 433.30745245277035, 318.219101593372, 485.6254111569477, 282.5135140475416, 369.94016671246635, 527.0304122345436, 540.5732136754953, 428.36075297913777, 478.7592863270011, 493.20488678082967, 424.84178185553236, 186.3555872005133, 313.78563892627113, 608.6133225518306, 327.25370276999524, 291.9125553959911, 287.04818512518557, 735.2622520508195, 474.2505692710528, 542.2764479047669, 615.8507180578549, 637.3620083127659, 570.7006474609301, 296.1727330164385, 468.00525126421576, 377.3581094118214, 349.8345827045273, 391.4159050376323, 485.870540959129, 533.6794195471807, 356.51735371900645, 467.34008674240056, 427.2582563598748, 345.5025440207915, 489.29243102643426, 588.3122793502071, 570.1467640655218, 477.3563217713513, 413.436775848486, 396.8818819844855, 611.447340430698, 566.3477615945529, 264.2852815132448, 487.830501642984, 359.0004610523664, 460.38218347903677, 625.8130876023727, 332.34321333582733, 432.23861482419045, 133.30568801362534, 261.43691856907117, 375.4150760033696, 494.73817171623824, 420.43464801157154, 500.2153451753245, 339.3095866546402, 363.44037048118656, 586.0447963488261, 696.1291066720152, 335.21288999684845, 408.0144954187586, 369.5536571434369, 295.15760322823064, 556.4359212580248, 544.5998327558365, 485.7939715736015, 487.13895734372585, 392.56218090250655, 434.7203605098358, 453.743542410923, 403.5969463274505, 574.706143016326, 687.1590916200976, 530.1066080583516, 325.7622771421765, 367.6790142449585, 175.7122673090273, 429.808146047256, 425.8458214998969, 566.5728776906071, 420.2600419595574, 481.55175630360486, 389.3571864291198, 398.5251308132382, 337.0950925677953, 235.85088696472437, 560.6872806292629, 505.2633712168367, 490.35305143009526, 629.6752741557115, 506.08647929304067, 337.9796002393992, 303.26645713526466, 580.8842308621356, 446.0650277294734, 448.9747899897537, 516.4745932298533, 508.29799459806816, 431.3912116216903, 523.4097724713498, 237.80996943244742, 442.4029700591457, 357.9006201316452, 558.4466434265514, 412.918599262584, 418.85769746961296, 351.5697094497304, 436.0474779407131, 514.1559962248908, 420.51215909664046, 341.87210708524145, 508.9812618929065, 492.2536767196082, 539.5550975782478, 506.83341163249645, 474.0807462429273, 484.9882729908358, 350.165019467063, 486.5420286601441, 466.17197820017367, 372.94240010049265, 481.38186277804056, 379.8511062187819, 416.68116059639607, 589.5664390491297, 428.59460083752145, 405.16249771849766, 498.59080999226114, 211.82212094051263, 417.8437518081689, 439.97424197418786, 406.24660368481744, 458.00425150855983, 610.4474949836409, 566.9185214328595, 505.24793486934317, 652.555372545076, 396.22638159714484, 412.25487972893444, 253.30804258792256, 384.65620661712813, 542.525611183553, 486.6836835668791, 524.5366833939278, 495.0815685477849, 340.73692966912574, 399.0552954039328, 308.99184041070276, 560.7409205448809, 503.58554317155773, 439.6502263560776, 405.4129505526066, 333.5891116873786, 360.2514104473974, 478.8367032471809, 334.05132739423266, 323.3444954108617, 364.08468726408853, 429.7803642107566, 311.8048349159258, 399.4500198472633, 446.7092736120078, 476.1682726217924, 523.0426374392964, 491.1028810585736, 407.1843556723929, 441.84241302082063, 450.33325440980286, 476.6283499521619, 394.1322284691482, 425.8438590170873, 529.2079802936875, 403.8581271651807, 551.7510028515233, 472.64480524829247, 456.8812720527377, 352.16703120160304, 534.3759420720544, 303.64369313952665, 493.0978251489841, 515.5554777913729, 705.4671739576746, 423.0850561430333], "policy_predator_policy_reward": [533.2263233499954, 592.3726788331228, 243.92486974826386, 335.1839251438416, 462.8796231449694, 411.4232950615707, 518.0588728329247, 490.6906159282663, 138.90763950829609, 173.77877788531958, 659.2174932314107, 575.3088811287631, 299.2930336405086, 269.02253856223365, 401.7398480108716, 387.4506445875182, 354.3903901852307, 361.1294303869559, 256.58716896398533, 245.21608127728138, 175.26758739346838, 174.2943565445206, 505.9631176757595, 525.4053895297448, 455.25552836335595, 489.5938266842923, 167.05211035928443, 164.61126348412677, 23.12485576250732, 37.22748855658573, 254.41885910008213, 349.13227286210457, 121.47424955016626, 146.1253301064172, 403.26792181733975, 417.29389521308224, 399.650988732628, 382.5018729607108, 432.6138599090758, 311.80065270021913, 352.17159869075437, 371.44427924022165, 469.9060747990682, 486.96064534228765, 122.72647885657108, 165.65288228608392, 586.5520096542639, 513.3899370541258, 519.9971441069541, 472.87949563843677, 226.7962400795023, 158.78317982926396, 459.7095237861354, 457.18470701557055, 535.215515846077, 534.6337037524368, 298.4169938181515, 358.1034020301526, 455.7094785929802, 465.19757110720235, 361.19770572135377, 358.59249062348954, 193.58628549240092, 243.28403570338995, 455.79932212155427, 383.36572893078295, 27.019072932288832, 5.09873932437165, 482.3038502832246, 543.8494241620078, 454.39184347097154, 464.2396187812844, 312.922108468206, 328.9761017388522, 277.68123744724306, 313.4978339406617, 419.1865839488336, 425.56565213203766, 74.34411817133966, 89.36249861083414, 346.34141819733236, 559.8095673072021, 243.0331779747971, 258.42878697428415, 360.73281909081453, 282.18205758939564, 493.3727934191379, 463.47424507705597, 445.92668046274906, 420.8236740791379, 155.02681068882652, 146.3965918922691, 349.1576889576653, 375.8209588470896, 433.92247018496477, 452.6943901618879, 225.2015776028721, 147.48287805732284, 538.2520337604005, 520.2829990798638, 308.54355072688156, 330.73851454421185, 265.157003748327, 234.44607357000385, 286.6995574833886, 279.15206710830404, 203.30821206853093, 222.44863957131332, 122.82626656521924, 109.8581399761979, 420.7351929013474, 424.19492324746244, 407.6068715456451, 265.6257028005285, 281.65026418053696, 273.2011993937556, 193.30454579030473, 178.2377006709903, 424.2466632694057, 488.1234331064158, 550.848453369505, 478.3667203129316, 536.064454685533, 559.9872526554602, 389.80146978269363, 347.18009074050724, 341.2207597880949, 291.0686329051092, 540.1352882636684, 476.66734106719315, 421.33462248624664, 295.9743717575195, 278.6179399688289, 322.7831726832908, 466.1079268115003, 487.13902173761784, 533.7393505481535, 538.5502801670718, 490.724846351778, 497.7656942595735, 241.63337512077243, 219.02601256488535, 231.9540203685851, 234.05899492489135, 439.6797961224843, 422.36475491590704, 481.3571449603419, 500.3998798728091, 314.00608268217167, 339.3096853020156, 479.96304505501996, 399.42935040402347, 453.65101431673037, 433.0951619076978, 307.13596328847245, 320.1171930416622, 222.41837158090848, 267.0362433800474, 524.3409086977458, 533.5127964048606, 350.67188075193434, 400.9984632334261, 485.38138828084243, 442.6237521413328, 526.3941225125604, 510.9704298586034, 564.6229459932966, 544.9661852539446, 507.5246830534772, 522.5171918473267, 454.9291387058056, 411.1967448033475, 207.5150660048027, 154.72308231400302, 632.0849516128877, 616.1401683671942, 596.7416313712663, 637.522920034048, 527.6737558491192, 510.7211142580544, 399.89976926778417, 418.1622388507315, 529.9999139483166, 571.1364501469552, 521.355698582079, 414.90914149121465, 559.5480843946058, 604.7038589220226, 444.4387529365805, 530.4527362386727, 508.2164764203739, 532.3054015715829, 559.8283387603602, 567.1488571367568, 511.12522478594855, 528.1740412070585, 368.8616810077863, 309.69107803090594, 513.7906499595905, 520.7429876162219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0558569352136384, "mean_inference_ms": 5.922453410489684, "mean_action_processing_ms": 0.8702040687795989, "mean_env_wait_ms": 0.7496622654614251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04922938346862793, "StateBufferConnector_ms": 0.008530259132385254, "ViewRequirementAgentConnector_ms": 0.5464645624160767}, "num_episodes": 18, "episode_return_max": 2163.0858676765242, "episode_return_min": 426.8604188393564, "episode_return_mean": 1652.1644631924237, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 134.06492080326842, "num_env_steps_trained_throughput_per_sec": 134.06492080326842, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 95942.306, "restore_workers_time_ms": 0.028, "training_step_time_ms": 95942.224, "sample_time_ms": 9895.859, "learn_time_ms": 85990.149, "learn_throughput": 46.517, "synch_weights_time_ms": 53.448}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "8abce_00000", "date": "2024-08-16_12-01-10", "timestamp": 1723789870, "time_this_iter_s": 29.84386897087097, "time_total_s": 2378.723261833191, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a435f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2378.723261833191, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 43.78809523809524, "ram_util_percent": 75.39761904761906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3125569394341223, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.276594865385187, "policy_loss": -0.0024571033064078873, "vf_loss": 9.277595496303821, "vf_explained_var": -0.16980833881115787, "kl": 0.009709947631093022, "entropy": 1.1999364476986032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7548603288159168, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.701937920202024, "policy_loss": -0.002485074439435882, "vf_loss": 9.704402841335883, "vf_explained_var": -0.030479437270492474, "kl": 0.006461917169430387, "entropy": 0.6984208642805695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 2163.0858676765242, "episode_reward_min": 426.8604188393564, "episode_reward_mean": 1710.6732181026962, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 133.30568801362534, "predator_policy": 5.09873932437165}, "policy_reward_max": {"prey_policy": 705.4671739576746, "predator_policy": 637.522920034048}, "policy_reward_mean": {"prey_policy": 446.85523686263116, "predator_policy": 408.48137218871693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1165.6658071394172, 1990.1387199745773, 1887.474982847665, 1220.3743949559928, 2075.353274217433, 1960.6423172183524, 1664.849618263486, 1751.540092807976, 1566.6211590401942, 1523.0655922771998, 1603.7468792123545, 426.8604188393564, 1896.3065221648399, 1839.28145543915, 1344.648167342884, 1873.3529744087489, 1587.979621496478, 828.4178771538416, 2007.1867395183958, 1474.394893866409, 1470.197418092551, 1814.1875272345676, 2128.615589178312, 1157.2922877816234, 1268.369929358742, 1742.2708278940054, 1359.5173753103581, 1929.4439755729893, 1374.9022886521263, 1296.1412449123159, 1561.4680472386235, 1561.5186050885964, 873.9304639160802, 1871.8793747404175, 1638.6819575657803, 1494.5406697940532, 1132.7619883650914, 1712.6736865666132, 2000.5804163715711, 1866.4791142603358, 1687.185034688803, 1394.673658875087, 2018.0375679433764, 1763.6975034545094, 1560.4701318858845, 1789.953996676323, 1911.4040090158908, 1849.7235096081758, 1466.906987331182, 1299.7701138494947, 1572.457481971167, 1839.5750186155044, 1517.5666231775651, 2056.758411875544, 2044.5494836388498, 1435.7344176562146, 1127.4188641660073, 2087.062999853039, 1771.288595927069, 1667.7973654952327, 1907.0973133267446, 2052.8249007748764, 1769.0439371407876, 1705.2139972037303, 1019.6339711239002, 2042.090171454927, 1945.5194061685056, 1961.2724163409782, 1832.2075266163838, 1950.1631327884866, 1863.2264444352577, 1984.228030802866, 1907.9575966341195, 2064.9176860917696, 1936.0254991514555, 1877.3189012045889, 1687.206061979049, 2163.0858676765242, 1210.9419829919157, 2124.120183724039, 1564.1930490346617, 1960.2856307212041, 2070.567756315733, 1607.6502043610928, 2013.8056898714685, 1857.1745950869647, 1931.357893547606, 1792.9869280276873, 2039.0232229998524, 1719.5162693738876, 2027.427327418539, 2098.9871041472866, 1649.7639190458096, 2044.4398410250299, 2053.9777179591265, 1676.0179657955625, 1557.3015532039472, 1895.2819121581529, 1999.0003783559694, 1699.0817524046945], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [391.4159050376323, 485.870540959129, 533.6794195471807, 356.51735371900645, 467.34008674240056, 427.2582563598748, 345.5025440207915, 489.29243102643426, 588.3122793502071, 570.1467640655218, 477.3563217713513, 413.436775848486, 396.8818819844855, 611.447340430698, 566.3477615945529, 264.2852815132448, 487.830501642984, 359.0004610523664, 460.38218347903677, 625.8130876023727, 332.34321333582733, 432.23861482419045, 133.30568801362534, 261.43691856907117, 375.4150760033696, 494.73817171623824, 420.43464801157154, 500.2153451753245, 339.3095866546402, 363.44037048118656, 586.0447963488261, 696.1291066720152, 335.21288999684845, 408.0144954187586, 369.5536571434369, 295.15760322823064, 556.4359212580248, 544.5998327558365, 485.7939715736015, 487.13895734372585, 392.56218090250655, 434.7203605098358, 453.743542410923, 403.5969463274505, 574.706143016326, 687.1590916200976, 530.1066080583516, 325.7622771421765, 367.6790142449585, 175.7122673090273, 429.808146047256, 425.8458214998969, 566.5728776906071, 420.2600419595574, 481.55175630360486, 389.3571864291198, 398.5251308132382, 337.0950925677953, 235.85088696472437, 560.6872806292629, 505.2633712168367, 490.35305143009526, 629.6752741557115, 506.08647929304067, 337.9796002393992, 303.26645713526466, 580.8842308621356, 446.0650277294734, 448.9747899897537, 516.4745932298533, 508.29799459806816, 431.3912116216903, 523.4097724713498, 237.80996943244742, 442.4029700591457, 357.9006201316452, 558.4466434265514, 412.918599262584, 418.85769746961296, 351.5697094497304, 436.0474779407131, 514.1559962248908, 420.51215909664046, 341.87210708524145, 508.9812618929065, 492.2536767196082, 539.5550975782478, 506.83341163249645, 474.0807462429273, 484.9882729908358, 350.165019467063, 486.5420286601441, 466.17197820017367, 372.94240010049265, 481.38186277804056, 379.8511062187819, 416.68116059639607, 589.5664390491297, 428.59460083752145, 405.16249771849766, 498.59080999226114, 211.82212094051263, 417.8437518081689, 439.97424197418786, 406.24660368481744, 458.00425150855983, 610.4474949836409, 566.9185214328595, 505.24793486934317, 652.555372545076, 396.22638159714484, 412.25487972893444, 253.30804258792256, 384.65620661712813, 542.525611183553, 486.6836835668791, 524.5366833939278, 495.0815685477849, 340.73692966912574, 399.0552954039328, 308.99184041070276, 560.7409205448809, 503.58554317155773, 439.6502263560776, 405.4129505526066, 333.5891116873786, 360.2514104473974, 478.8367032471809, 334.05132739423266, 323.3444954108617, 364.08468726408853, 429.7803642107566, 311.8048349159258, 399.4500198472633, 446.7092736120078, 476.1682726217924, 523.0426374392964, 491.1028810585736, 407.1843556723929, 441.84241302082063, 450.33325440980286, 476.6283499521619, 394.1322284691482, 425.8438590170873, 529.2079802936875, 403.8581271651807, 551.7510028515233, 472.64480524829247, 456.8812720527377, 352.16703120160304, 534.3759420720544, 303.64369313952665, 493.0978251489841, 515.5554777913729, 705.4671739576746, 423.0850561430333, 321.57681243749414, 409.99687893648377, 544.5811317157529, 392.68426371070547, 407.08372881626275, 352.8018718981241, 503.0930045268079, 409.1717023684284, 502.68494825452075, 567.0327901282736, 533.2330652298315, 452.4614026599731, 479.99973599366183, 478.76272563834266, 489.81737738344725, 460.21522313623365, 505.34491623795094, 342.7847810389443, 506.5371123215319, 640.2411896257591, 494.65415108945945, 621.7416914685073, 509.7417471317354, 442.76404057141093, 663.6952430244946, 384.5366233025287, 519.8847246963063, 549.8691186539374, 400.7431227618568, 339.7860649688904, 538.342633836806, 445.46935069818267, 371.68698106378525, 461.7083020923116, 424.9469178359292, 418.05919006770205, 285.0109743791471, 441.51079937995814, 409.14007927883296, 430.0063146341889, 381.9711667423364, 424.4925703134809, 470.29000969370173, 379.13109999281585], "policy_predator_policy_reward": [122.72647885657108, 165.65288228608392, 586.5520096542639, 513.3899370541258, 519.9971441069541, 472.87949563843677, 226.7962400795023, 158.78317982926396, 459.7095237861354, 457.18470701557055, 535.215515846077, 534.6337037524368, 298.4169938181515, 358.1034020301526, 455.7094785929802, 465.19757110720235, 361.19770572135377, 358.59249062348954, 193.58628549240092, 243.28403570338995, 455.79932212155427, 383.36572893078295, 27.019072932288832, 5.09873932437165, 482.3038502832246, 543.8494241620078, 454.39184347097154, 464.2396187812844, 312.922108468206, 328.9761017388522, 277.68123744724306, 313.4978339406617, 419.1865839488336, 425.56565213203766, 74.34411817133966, 89.36249861083414, 346.34141819733236, 559.8095673072021, 243.0331779747971, 258.42878697428415, 360.73281909081453, 282.18205758939564, 493.3727934191379, 463.47424507705597, 445.92668046274906, 420.8236740791379, 155.02681068882652, 146.3965918922691, 349.1576889576653, 375.8209588470896, 433.92247018496477, 452.6943901618879, 225.2015776028721, 147.48287805732284, 538.2520337604005, 520.2829990798638, 308.54355072688156, 330.73851454421185, 265.157003748327, 234.44607357000385, 286.6995574833886, 279.15206710830404, 203.30821206853093, 222.44863957131332, 122.82626656521924, 109.8581399761979, 420.7351929013474, 424.19492324746244, 407.6068715456451, 265.6257028005285, 281.65026418053696, 273.2011993937556, 193.30454579030473, 178.2377006709903, 424.2466632694057, 488.1234331064158, 550.848453369505, 478.3667203129316, 536.064454685533, 559.9872526554602, 389.80146978269363, 347.18009074050724, 341.2207597880949, 291.0686329051092, 540.1352882636684, 476.66734106719315, 421.33462248624664, 295.9743717575195, 278.6179399688289, 322.7831726832908, 466.1079268115003, 487.13902173761784, 533.7393505481535, 538.5502801670718, 490.724846351778, 497.7656942595735, 241.63337512077243, 219.02601256488535, 231.9540203685851, 234.05899492489135, 439.6797961224843, 422.36475491590704, 481.3571449603419, 500.3998798728091, 314.00608268217167, 339.3096853020156, 479.96304505501996, 399.42935040402347, 453.65101431673037, 433.0951619076978, 307.13596328847245, 320.1171930416622, 222.41837158090848, 267.0362433800474, 524.3409086977458, 533.5127964048606, 350.67188075193434, 400.9984632334261, 485.38138828084243, 442.6237521413328, 526.3941225125604, 510.9704298586034, 564.6229459932966, 544.9661852539446, 507.5246830534772, 522.5171918473267, 454.9291387058056, 411.1967448033475, 207.5150660048027, 154.72308231400302, 632.0849516128877, 616.1401683671942, 596.7416313712663, 637.522920034048, 527.6737558491192, 510.7211142580544, 399.89976926778417, 418.1622388507315, 529.9999139483166, 571.1364501469552, 521.355698582079, 414.90914149121465, 559.5480843946058, 604.7038589220226, 444.4387529365805, 530.4527362386727, 508.2164764203739, 532.3054015715829, 559.8283387603602, 567.1488571367568, 511.12522478594855, 528.1740412070585, 368.8616810077863, 309.69107803090594, 513.7906499595905, 520.7429876162219, 242.16823186635796, 237.20005975158165, 605.9409861412614, 580.9138021563202, 429.24805683729073, 375.0593914829829, 514.6652523568637, 533.3556714691011, 539.5884255630486, 461.261592369891, 318.26069428194074, 303.6950421893474, 504.47150198039986, 550.5717262590617, 417.26528515001576, 489.8767094172706, 562.5225343918584, 520.7056618788505, 317.67284822258, 328.535777857816, 454.3771457416977, 468.25023470018704, 367.94001237624235, 399.0704692944951, 498.28690624125767, 480.90855485025486, 516.5662218141605, 512.6670389828812, 506.7176477351384, 402.5170835799249, 490.0785670423769, 570.5492894476625, 630.865568648745, 589.7168661542859, 428.17249303367987, 404.83936485825313, 410.5394470814085, 420.2403323634341, 498.7781580160418, 557.3573602290891, 604.3902448130908, 588.146396487061, 433.33595050025957, 416.3246922179177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.074807858772723, "mean_inference_ms": 5.989060939994454, "mean_action_processing_ms": 0.8791331078289493, "mean_env_wait_ms": 0.7576293193439093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.050721168518066406, "StateBufferConnector_ms": 0.039374470710754395, "ViewRequirementAgentConnector_ms": 0.5390218496322632}, "num_episodes": 22, "episode_return_max": 2163.0858676765242, "episode_return_min": 426.8604188393564, "episode_return_mean": 1710.6732181026962, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 133.9257847888482, "num_env_steps_trained_throughput_per_sec": 133.9257847888482, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 38483.651, "restore_workers_time_ms": 0.025, "training_step_time_ms": 38483.573, "sample_time_ms": 8821.858, "learn_time_ms": 29606.474, "learn_throughput": 135.106, "synch_weights_time_ms": 52.57}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "8abce_00000", "date": "2024-08-16_12-01-40", "timestamp": 1723789900, "time_this_iter_s": 29.877852201461792, "time_total_s": 2408.6011140346527, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43f8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2408.6011140346527, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 44.226190476190474, "ram_util_percent": 75.47142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1478698008274906, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.434625079139831, "policy_loss": -0.006577585478160511, "vf_loss": 9.43939521930836, "vf_explained_var": -0.024177978688446934, "kl": 0.012049647584852375, "entropy": 1.1685096244963389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6454873230564533, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.536559007533643, "policy_loss": -0.0016235760112524662, "vf_loss": 9.538160313500299, "vf_explained_var": -0.043699031405978736, "kl": 0.0071402532517774574, "entropy": 0.7853936190643008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 2163.0858676765242, "episode_reward_min": 873.9304639160802, "episode_reward_mean": 1748.470662909965, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 175.7122673090273, "predator_policy": 109.8581399761979}, "policy_reward_max": {"prey_policy": 705.4671739576746, "predator_policy": 651.9419784160889}, "policy_reward_mean": {"prey_policy": 454.02476176381356, "predator_policy": 420.2105696911691}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2007.1867395183958, 1474.394893866409, 1470.197418092551, 1814.1875272345676, 2128.615589178312, 1157.2922877816234, 1268.369929358742, 1742.2708278940054, 1359.5173753103581, 1929.4439755729893, 1374.9022886521263, 1296.1412449123159, 1561.4680472386235, 1561.5186050885964, 873.9304639160802, 1871.8793747404175, 1638.6819575657803, 1494.5406697940532, 1132.7619883650914, 1712.6736865666132, 2000.5804163715711, 1866.4791142603358, 1687.185034688803, 1394.673658875087, 2018.0375679433764, 1763.6975034545094, 1560.4701318858845, 1789.953996676323, 1911.4040090158908, 1849.7235096081758, 1466.906987331182, 1299.7701138494947, 1572.457481971167, 1839.5750186155044, 1517.5666231775651, 2056.758411875544, 2044.5494836388498, 1435.7344176562146, 1127.4188641660073, 2087.062999853039, 1771.288595927069, 1667.7973654952327, 1907.0973133267446, 2052.8249007748764, 1769.0439371407876, 1705.2139972037303, 1019.6339711239002, 2042.090171454927, 1945.5194061685056, 1961.2724163409782, 1832.2075266163838, 1950.1631327884866, 1863.2264444352577, 1984.228030802866, 1907.9575966341195, 2064.9176860917696, 1936.0254991514555, 1877.3189012045889, 1687.206061979049, 2163.0858676765242, 1210.9419829919157, 2124.120183724039, 1564.1930490346617, 1960.2856307212041, 2070.567756315733, 1607.6502043610928, 2013.8056898714685, 1857.1745950869647, 1931.357893547606, 1792.9869280276873, 2039.0232229998524, 1719.5162693738876, 2027.427327418539, 2098.9871041472866, 1649.7639190458096, 2044.4398410250299, 2053.9777179591265, 1676.0179657955625, 1557.3015532039472, 1895.2819121581529, 1999.0003783559694, 1699.0817524046945, 1603.3179298116463, 1158.4009926000501, 2074.8305106477533, 1552.3923042404674, 1782.082386003845, 2144.7081220964624, 1865.8000047952353, 1921.0531980970638, 1849.8352499562293, 1663.0288419878864, 1862.6152304131558, 1427.6766477331794, 1995.1717738803238, 1723.5768618393317, 2097.57496786821, 1535.0378016337177, 1970.7092832239307, 1758.2522486983885], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [556.4359212580248, 544.5998327558365, 485.7939715736015, 487.13895734372585, 392.56218090250655, 434.7203605098358, 453.743542410923, 403.5969463274505, 574.706143016326, 687.1590916200976, 530.1066080583516, 325.7622771421765, 367.6790142449585, 175.7122673090273, 429.808146047256, 425.8458214998969, 566.5728776906071, 420.2600419595574, 481.55175630360486, 389.3571864291198, 398.5251308132382, 337.0950925677953, 235.85088696472437, 560.6872806292629, 505.2633712168367, 490.35305143009526, 629.6752741557115, 506.08647929304067, 337.9796002393992, 303.26645713526466, 580.8842308621356, 446.0650277294734, 448.9747899897537, 516.4745932298533, 508.29799459806816, 431.3912116216903, 523.4097724713498, 237.80996943244742, 442.4029700591457, 357.9006201316452, 558.4466434265514, 412.918599262584, 418.85769746961296, 351.5697094497304, 436.0474779407131, 514.1559962248908, 420.51215909664046, 341.87210708524145, 508.9812618929065, 492.2536767196082, 539.5550975782478, 506.83341163249645, 474.0807462429273, 484.9882729908358, 350.165019467063, 486.5420286601441, 466.17197820017367, 372.94240010049265, 481.38186277804056, 379.8511062187819, 416.68116059639607, 589.5664390491297, 428.59460083752145, 405.16249771849766, 498.59080999226114, 211.82212094051263, 417.8437518081689, 439.97424197418786, 406.24660368481744, 458.00425150855983, 610.4474949836409, 566.9185214328595, 505.24793486934317, 652.555372545076, 396.22638159714484, 412.25487972893444, 253.30804258792256, 384.65620661712813, 542.525611183553, 486.6836835668791, 524.5366833939278, 495.0815685477849, 340.73692966912574, 399.0552954039328, 308.99184041070276, 560.7409205448809, 503.58554317155773, 439.6502263560776, 405.4129505526066, 333.5891116873786, 360.2514104473974, 478.8367032471809, 334.05132739423266, 323.3444954108617, 364.08468726408853, 429.7803642107566, 311.8048349159258, 399.4500198472633, 446.7092736120078, 476.1682726217924, 523.0426374392964, 491.1028810585736, 407.1843556723929, 441.84241302082063, 450.33325440980286, 476.6283499521619, 394.1322284691482, 425.8438590170873, 529.2079802936875, 403.8581271651807, 551.7510028515233, 472.64480524829247, 456.8812720527377, 352.16703120160304, 534.3759420720544, 303.64369313952665, 493.0978251489841, 515.5554777913729, 705.4671739576746, 423.0850561430333, 321.57681243749414, 409.99687893648377, 544.5811317157529, 392.68426371070547, 407.08372881626275, 352.8018718981241, 503.0930045268079, 409.1717023684284, 502.68494825452075, 567.0327901282736, 533.2330652298315, 452.4614026599731, 479.99973599366183, 478.76272563834266, 489.81737738344725, 460.21522313623365, 505.34491623795094, 342.7847810389443, 506.5371123215319, 640.2411896257591, 494.65415108945945, 621.7416914685073, 509.7417471317354, 442.76404057141093, 663.6952430244946, 384.5366233025287, 519.8847246963063, 549.8691186539374, 400.7431227618568, 339.7860649688904, 538.342633836806, 445.46935069818267, 371.68698106378525, 461.7083020923116, 424.9469178359292, 418.05919006770205, 285.0109743791471, 441.51079937995814, 409.14007927883296, 430.0063146341889, 381.9711667423364, 424.4925703134809, 470.29000969370173, 379.13109999281585, 555.3900969294856, 541.3415000513118, 183.95373146506563, 485.2418947472895, 631.014956905442, 626.1903871390323, 363.94476053116904, 381.0420182055827, 519.530203715927, 579.289465608315, 493.9485101174114, 594.69194781496, 528.5709251085557, 500.69390678675825, 368.41272349751864, 507.79731949736987, 634.7207523489628, 448.50367983682656, 517.9299363200156, 377.66237136147527, 450.4193207277214, 259.69619809132007, 515.2837407693811, 407.0860551003043, 410.8166453148865, 546.4200697251804, 666.287915417236, 501.1590407841557, 481.7773132262162, 587.4426720112134, 513.8433660757868, 433.5648236283581, 446.91265814626576, 357.542676380365, 297.29898816240103, 379.5897680281493], "policy_predator_policy_reward": [346.34141819733236, 559.8095673072021, 243.0331779747971, 258.42878697428415, 360.73281909081453, 282.18205758939564, 493.3727934191379, 463.47424507705597, 445.92668046274906, 420.8236740791379, 155.02681068882652, 146.3965918922691, 349.1576889576653, 375.8209588470896, 433.92247018496477, 452.6943901618879, 225.2015776028721, 147.48287805732284, 538.2520337604005, 520.2829990798638, 308.54355072688156, 330.73851454421185, 265.157003748327, 234.44607357000385, 286.6995574833886, 279.15206710830404, 203.30821206853093, 222.44863957131332, 122.82626656521924, 109.8581399761979, 420.7351929013474, 424.19492324746244, 407.6068715456451, 265.6257028005285, 281.65026418053696, 273.2011993937556, 193.30454579030473, 178.2377006709903, 424.2466632694057, 488.1234331064158, 550.848453369505, 478.3667203129316, 536.064454685533, 559.9872526554602, 389.80146978269363, 347.18009074050724, 341.2207597880949, 291.0686329051092, 540.1352882636684, 476.66734106719315, 421.33462248624664, 295.9743717575195, 278.6179399688289, 322.7831726832908, 466.1079268115003, 487.13902173761784, 533.7393505481535, 538.5502801670718, 490.724846351778, 497.7656942595735, 241.63337512077243, 219.02601256488535, 231.9540203685851, 234.05899492489135, 439.6797961224843, 422.36475491590704, 481.3571449603419, 500.3998798728091, 314.00608268217167, 339.3096853020156, 479.96304505501996, 399.42935040402347, 453.65101431673037, 433.0951619076978, 307.13596328847245, 320.1171930416622, 222.41837158090848, 267.0362433800474, 524.3409086977458, 533.5127964048606, 350.67188075193434, 400.9984632334261, 485.38138828084243, 442.6237521413328, 526.3941225125604, 510.9704298586034, 564.6229459932966, 544.9661852539446, 507.5246830534772, 522.5171918473267, 454.9291387058056, 411.1967448033475, 207.5150660048027, 154.72308231400302, 632.0849516128877, 616.1401683671942, 596.7416313712663, 637.522920034048, 527.6737558491192, 510.7211142580544, 399.89976926778417, 418.1622388507315, 529.9999139483166, 571.1364501469552, 521.355698582079, 414.90914149121465, 559.5480843946058, 604.7038589220226, 444.4387529365805, 530.4527362386727, 508.2164764203739, 532.3054015715829, 559.8283387603602, 567.1488571367568, 511.12522478594855, 528.1740412070585, 368.8616810077863, 309.69107803090594, 513.7906499595905, 520.7429876162219, 242.16823186635796, 237.20005975158165, 605.9409861412614, 580.9138021563202, 429.24805683729073, 375.0593914829829, 514.6652523568637, 533.3556714691011, 539.5884255630486, 461.261592369891, 318.26069428194074, 303.6950421893474, 504.47150198039986, 550.5717262590617, 417.26528515001576, 489.8767094172706, 562.5225343918584, 520.7056618788505, 317.67284822258, 328.535777857816, 454.3771457416977, 468.25023470018704, 367.94001237624235, 399.0704692944951, 498.28690624125767, 480.90855485025486, 516.5662218141605, 512.6670389828812, 506.7176477351384, 402.5170835799249, 490.0785670423769, 570.5492894476625, 630.865568648745, 589.7168661542859, 428.17249303367987, 404.83936485825313, 410.5394470814085, 420.2403323634341, 498.7781580160418, 557.3573602290891, 604.3902448130908, 588.146396487061, 433.33595050025957, 416.3246922179177, 269.8739381831499, 236.71239464769903, 276.8437705122393, 212.36159587545475, 387.1833944080717, 430.44177219520196, 395.78094695982537, 411.62457854389163, 360.36590635954184, 322.89681032006166, 545.3564541089941, 510.7112100551012, 430.1007589711345, 406.4344139287876, 515.2364206112214, 529.606734490954, 394.6522016345704, 371.95861613586857, 360.14272165363354, 407.29381265276277, 595.7206153102314, 556.7790962838818, 321.93925637277044, 183.3675954907249, 516.4444018360631, 521.4906570041912, 285.3673397113838, 270.7625659265557, 473.0660264352945, 555.2889561954858, 300.81165128122643, 286.8179606483464, 651.9419784160889, 514.3119702812103, 599.7668361747212, 481.5966563331144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0855649594638614, "mean_inference_ms": 6.016774881553645, "mean_action_processing_ms": 0.8842363889570448, "mean_env_wait_ms": 0.7621619169631996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046952128410339355, "StateBufferConnector_ms": 0.03928732872009277, "ViewRequirementAgentConnector_ms": 0.4833439588546753}, "num_episodes": 18, "episode_return_max": 2163.0858676765242, "episode_return_min": 873.9304639160802, "episode_return_mean": 1748.470662909965, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 130.08885348975122, "num_env_steps_trained_throughput_per_sec": 130.08885348975122, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 36764.84, "restore_workers_time_ms": 0.025, "training_step_time_ms": 36764.764, "sample_time_ms": 8144.491, "learn_time_ms": 28573.849, "learn_throughput": 139.988, "synch_weights_time_ms": 44.05}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "8abce_00000", "date": "2024-08-16_12-02-10", "timestamp": 1723789930, "time_this_iter_s": 30.756716012954712, "time_total_s": 2439.3578300476074, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43b4b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2439.3578300476074, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 43.73409090909091, "ram_util_percent": 75.18636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.571949760371415, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.295694696335566, "policy_loss": -0.003143057848139612, "vf_loss": 9.296825663248699, "vf_explained_var": -0.07390798869587126, "kl": 0.01341383486609584, "entropy": 1.2007338120193078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9415314487363926, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.581275980308574, "policy_loss": 0.0012463918551999741, "vf_loss": 9.580012242756192, "vf_explained_var": -0.05347152800156326, "kl": 0.005557293359729377, "entropy": 0.7725848822051256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 2163.0858676765242, "episode_reward_min": 1019.6339711239002, "episode_reward_mean": 1811.5946333456855, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 183.95373146506563, "predator_policy": 154.72308231400302}, "policy_reward_max": {"prey_policy": 705.4671739576746, "predator_policy": 651.9419784160889}, "policy_reward_mean": {"prey_policy": 461.4283086099832, "predator_policy": 444.3690080628598}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1394.673658875087, 2018.0375679433764, 1763.6975034545094, 1560.4701318858845, 1789.953996676323, 1911.4040090158908, 1849.7235096081758, 1466.906987331182, 1299.7701138494947, 1572.457481971167, 1839.5750186155044, 1517.5666231775651, 2056.758411875544, 2044.5494836388498, 1435.7344176562146, 1127.4188641660073, 2087.062999853039, 1771.288595927069, 1667.7973654952327, 1907.0973133267446, 2052.8249007748764, 1769.0439371407876, 1705.2139972037303, 1019.6339711239002, 2042.090171454927, 1945.5194061685056, 1961.2724163409782, 1832.2075266163838, 1950.1631327884866, 1863.2264444352577, 1984.228030802866, 1907.9575966341195, 2064.9176860917696, 1936.0254991514555, 1877.3189012045889, 1687.206061979049, 2163.0858676765242, 1210.9419829919157, 2124.120183724039, 1564.1930490346617, 1960.2856307212041, 2070.567756315733, 1607.6502043610928, 2013.8056898714685, 1857.1745950869647, 1931.357893547606, 1792.9869280276873, 2039.0232229998524, 1719.5162693738876, 2027.427327418539, 2098.9871041472866, 1649.7639190458096, 2044.4398410250299, 2053.9777179591265, 1676.0179657955625, 1557.3015532039472, 1895.2819121581529, 1999.0003783559694, 1699.0817524046945, 1603.3179298116463, 1158.4009926000501, 2074.8305106477533, 1552.3923042404674, 1782.082386003845, 2144.7081220964624, 1865.8000047952353, 1921.0531980970638, 1849.8352499562293, 1663.0288419878864, 1862.6152304131558, 1427.6766477331794, 1995.1717738803238, 1723.5768618393317, 2097.57496786821, 1535.0378016337177, 1970.7092832239307, 1758.2522486983885, 1435.8813116710892, 1876.3751692093024, 2025.5228138504892, 1732.150343180987, 1897.4559288681376, 2142.2238790167676, 1717.0711203991423, 2085.3877150562002, 2105.8397826106075, 2039.153649420654, 1872.5921749711488, 2038.263824996904, 1905.9462879905923, 2036.4043382235645, 1704.885378188043, 1822.164962402054, 1901.021367152249, 1416.7117798673025, 1913.7345066925147, 1830.962031123667, 1781.5059134014089, 1610.4178985105084, 1844.944322737062], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [420.51215909664046, 341.87210708524145, 508.9812618929065, 492.2536767196082, 539.5550975782478, 506.83341163249645, 474.0807462429273, 484.9882729908358, 350.165019467063, 486.5420286601441, 466.17197820017367, 372.94240010049265, 481.38186277804056, 379.8511062187819, 416.68116059639607, 589.5664390491297, 428.59460083752145, 405.16249771849766, 498.59080999226114, 211.82212094051263, 417.8437518081689, 439.97424197418786, 406.24660368481744, 458.00425150855983, 610.4474949836409, 566.9185214328595, 505.24793486934317, 652.555372545076, 396.22638159714484, 412.25487972893444, 253.30804258792256, 384.65620661712813, 542.525611183553, 486.6836835668791, 524.5366833939278, 495.0815685477849, 340.73692966912574, 399.0552954039328, 308.99184041070276, 560.7409205448809, 503.58554317155773, 439.6502263560776, 405.4129505526066, 333.5891116873786, 360.2514104473974, 478.8367032471809, 334.05132739423266, 323.3444954108617, 364.08468726408853, 429.7803642107566, 311.8048349159258, 399.4500198472633, 446.7092736120078, 476.1682726217924, 523.0426374392964, 491.1028810585736, 407.1843556723929, 441.84241302082063, 450.33325440980286, 476.6283499521619, 394.1322284691482, 425.8438590170873, 529.2079802936875, 403.8581271651807, 551.7510028515233, 472.64480524829247, 456.8812720527377, 352.16703120160304, 534.3759420720544, 303.64369313952665, 493.0978251489841, 515.5554777913729, 705.4671739576746, 423.0850561430333, 321.57681243749414, 409.99687893648377, 544.5811317157529, 392.68426371070547, 407.08372881626275, 352.8018718981241, 503.0930045268079, 409.1717023684284, 502.68494825452075, 567.0327901282736, 533.2330652298315, 452.4614026599731, 479.99973599366183, 478.76272563834266, 489.81737738344725, 460.21522313623365, 505.34491623795094, 342.7847810389443, 506.5371123215319, 640.2411896257591, 494.65415108945945, 621.7416914685073, 509.7417471317354, 442.76404057141093, 663.6952430244946, 384.5366233025287, 519.8847246963063, 549.8691186539374, 400.7431227618568, 339.7860649688904, 538.342633836806, 445.46935069818267, 371.68698106378525, 461.7083020923116, 424.9469178359292, 418.05919006770205, 285.0109743791471, 441.51079937995814, 409.14007927883296, 430.0063146341889, 381.9711667423364, 424.4925703134809, 470.29000969370173, 379.13109999281585, 555.3900969294856, 541.3415000513118, 183.95373146506563, 485.2418947472895, 631.014956905442, 626.1903871390323, 363.94476053116904, 381.0420182055827, 519.530203715927, 579.289465608315, 493.9485101174114, 594.69194781496, 528.5709251085557, 500.69390678675825, 368.41272349751864, 507.79731949736987, 634.7207523489628, 448.50367983682656, 517.9299363200156, 377.66237136147527, 450.4193207277214, 259.69619809132007, 515.2837407693811, 407.0860551003043, 410.8166453148865, 546.4200697251804, 666.287915417236, 501.1590407841557, 481.7773132262162, 587.4426720112134, 513.8433660757868, 433.5648236283581, 446.91265814626576, 357.542676380365, 297.29898816240103, 379.5897680281493, 375.1982389482964, 440.6061850621143, 512.0631767539525, 477.78786284786247, 574.8412794467177, 395.60377245655474, 421.8203145510468, 582.7970371186861, 420.9046397983249, 374.46204238646936, 499.7822616417044, 384.23728186165033, 454.5821978032767, 644.7679376105751, 414.1785725005903, 419.6542469421073, 541.702586904639, 598.2006324590483, 529.0042289797559, 489.42978531062795, 427.05106594047726, 377.107418656204, 676.9888763570599, 683.3224549926744, 552.8517104688673, 507.9170606332425, 366.93595316716113, 424.0234363351619, 379.3811650770908, 462.1105969258553, 468.61699818510954, 465.0515259001368, 496.8670829479326, 500.6250687905024, 422.784046869538, 359.6938015740157, 535.8197163811643, 610.8431779316473, 387.4339447371656, 544.1235221862416, 452.06768236717676, 623.2920837231195, 391.6491487706471, 636.1879987610831, 390.53547251605863, 409.3069504024787], "policy_predator_policy_reward": [341.2207597880949, 291.0686329051092, 540.1352882636684, 476.66734106719315, 421.33462248624664, 295.9743717575195, 278.6179399688289, 322.7831726832908, 466.1079268115003, 487.13902173761784, 533.7393505481535, 538.5502801670718, 490.724846351778, 497.7656942595735, 241.63337512077243, 219.02601256488535, 231.9540203685851, 234.05899492489135, 439.6797961224843, 422.36475491590704, 481.3571449603419, 500.3998798728091, 314.00608268217167, 339.3096853020156, 479.96304505501996, 399.42935040402347, 453.65101431673037, 433.0951619076978, 307.13596328847245, 320.1171930416622, 222.41837158090848, 267.0362433800474, 524.3409086977458, 533.5127964048606, 350.67188075193434, 400.9984632334261, 485.38138828084243, 442.6237521413328, 526.3941225125604, 510.9704298586034, 564.6229459932966, 544.9661852539446, 507.5246830534772, 522.5171918473267, 454.9291387058056, 411.1967448033475, 207.5150660048027, 154.72308231400302, 632.0849516128877, 616.1401683671942, 596.7416313712663, 637.522920034048, 527.6737558491192, 510.7211142580544, 399.89976926778417, 418.1622388507315, 529.9999139483166, 571.1364501469552, 521.355698582079, 414.90914149121465, 559.5480843946058, 604.7038589220226, 444.4387529365805, 530.4527362386727, 508.2164764203739, 532.3054015715829, 559.8283387603602, 567.1488571367568, 511.12522478594855, 528.1740412070585, 368.8616810077863, 309.69107803090594, 513.7906499595905, 520.7429876162219, 242.16823186635796, 237.20005975158165, 605.9409861412614, 580.9138021563202, 429.24805683729073, 375.0593914829829, 514.6652523568637, 533.3556714691011, 539.5884255630486, 461.261592369891, 318.26069428194074, 303.6950421893474, 504.47150198039986, 550.5717262590617, 417.26528515001576, 489.8767094172706, 562.5225343918584, 520.7056618788505, 317.67284822258, 328.535777857816, 454.3771457416977, 468.25023470018704, 367.94001237624235, 399.0704692944951, 498.28690624125767, 480.90855485025486, 516.5662218141605, 512.6670389828812, 506.7176477351384, 402.5170835799249, 490.0785670423769, 570.5492894476625, 630.865568648745, 589.7168661542859, 428.17249303367987, 404.83936485825313, 410.5394470814085, 420.2403323634341, 498.7781580160418, 557.3573602290891, 604.3902448130908, 588.146396487061, 433.33595050025957, 416.3246922179177, 269.8739381831499, 236.71239464769903, 276.8437705122393, 212.36159587545475, 387.1833944080717, 430.44177219520196, 395.78094695982537, 411.62457854389163, 360.36590635954184, 322.89681032006166, 545.3564541089941, 510.7112100551012, 430.1007589711345, 406.4344139287876, 515.2364206112214, 529.606734490954, 394.6522016345704, 371.95861613586857, 360.14272165363354, 407.29381265276277, 595.7206153102314, 556.7790962838818, 321.93925637277044, 183.3675954907249, 516.4444018360631, 521.4906570041912, 285.3673397113838, 270.7625659265557, 473.0660264352945, 555.2889561954858, 300.81165128122643, 286.8179606483464, 651.9419784160889, 514.3119702812103, 599.7668361747212, 481.5966563331144, 289.1653362065056, 330.9115514541727, 394.9056771631543, 491.61845244433454, 491.16271321593416, 563.915048731286, 365.4536686735358, 362.07932283771873, 564.3601734734737, 537.7290732098677, 637.8573096073512, 620.3470259060624, 253.95494656327713, 363.7660384220138, 619.388182643617, 632.1667129698868, 476.4320786124784, 489.50448463444786, 519.1712944046166, 501.548340725653, 492.0394928564477, 576.3941975180222, 324.33951870944895, 353.6129749377256, 407.18704501653826, 437.9904718719451, 603.7829184473484, 641.662030273891, 442.56597738976365, 420.8276387953303, 468.24139099203086, 420.255047324777, 436.31640291993523, 467.2128124938804, 310.96430576421784, 323.2696256595324, 331.12427580432166, 435.947336575386, 453.349188231395, 446.0553759688674, 317.7845647985478, 388.3615825125624, 313.70228912581064, 268.878461852965, 517.6118196601452, 527.4900801583804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.094588551707493, "mean_inference_ms": 6.044129695279363, "mean_action_processing_ms": 0.8892575025784971, "mean_env_wait_ms": 0.7657829179643444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04615962505340576, "StateBufferConnector_ms": 0.04258930683135986, "ViewRequirementAgentConnector_ms": 0.4340665340423584}, "num_episodes": 23, "episode_return_max": 2163.0858676765242, "episode_return_min": 1019.6339711239002, "episode_return_mean": 1811.5946333456855, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.24391459466227, "num_env_steps_trained_throughput_per_sec": 137.24391459466227, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 35169.049, "restore_workers_time_ms": 0.024, "training_step_time_ms": 35168.975, "sample_time_ms": 7409.752, "learn_time_ms": 27716.582, "learn_throughput": 144.318, "synch_weights_time_ms": 40.372}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "8abce_00000", "date": "2024-08-16_12-02-40", "timestamp": 1723789960, "time_this_iter_s": 29.153597831726074, "time_total_s": 2468.5114278793335, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4ab28b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2468.5114278793335, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 43.03414634146342, "ram_util_percent": 74.91219512195123}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.562332139002583, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.55387088180219, "policy_loss": -0.004511900748761874, "vf_loss": 9.556475442553323, "vf_explained_var": -0.011298311261272936, "kl": 0.012715546047388672, "entropy": 1.1193628612018767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5065566243002655, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.528699115470603, "policy_loss": -0.0019338835445947195, "vf_loss": 9.530610229855492, "vf_explained_var": -0.0004854369731176467, "kl": 0.007282303269993418, "entropy": 0.8324071230081024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 2163.0858676765242, "episode_reward_min": 457.26077524534224, "episode_reward_mean": 1771.406429064253, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 181.0639241118567, "predator_policy": 6.343825711484704}, "policy_reward_max": {"prey_policy": 705.4671739576746, "predator_policy": 651.9419784160889}, "policy_reward_mean": {"prey_policy": 459.5771396624668, "predator_policy": 426.12607486965976}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1667.7973654952327, 1907.0973133267446, 2052.8249007748764, 1769.0439371407876, 1705.2139972037303, 1019.6339711239002, 2042.090171454927, 1945.5194061685056, 1961.2724163409782, 1832.2075266163838, 1950.1631327884866, 1863.2264444352577, 1984.228030802866, 1907.9575966341195, 2064.9176860917696, 1936.0254991514555, 1877.3189012045889, 1687.206061979049, 2163.0858676765242, 1210.9419829919157, 2124.120183724039, 1564.1930490346617, 1960.2856307212041, 2070.567756315733, 1607.6502043610928, 2013.8056898714685, 1857.1745950869647, 1931.357893547606, 1792.9869280276873, 2039.0232229998524, 1719.5162693738876, 2027.427327418539, 2098.9871041472866, 1649.7639190458096, 2044.4398410250299, 2053.9777179591265, 1676.0179657955625, 1557.3015532039472, 1895.2819121581529, 1999.0003783559694, 1699.0817524046945, 1603.3179298116463, 1158.4009926000501, 2074.8305106477533, 1552.3923042404674, 1782.082386003845, 2144.7081220964624, 1865.8000047952353, 1921.0531980970638, 1849.8352499562293, 1663.0288419878864, 1862.6152304131558, 1427.6766477331794, 1995.1717738803238, 1723.5768618393317, 2097.57496786821, 1535.0378016337177, 1970.7092832239307, 1758.2522486983885, 1435.8813116710892, 1876.3751692093024, 2025.5228138504892, 1732.150343180987, 1897.4559288681376, 2142.2238790167676, 1717.0711203991423, 2085.3877150562002, 2105.8397826106075, 2039.153649420654, 1872.5921749711488, 2038.263824996904, 1905.9462879905923, 2036.4043382235645, 1704.885378188043, 1822.164962402054, 1901.021367152249, 1416.7117798673025, 1913.7345066925147, 1830.962031123667, 1781.5059134014089, 1610.4178985105084, 1844.944322737062, 1528.848060687964, 1990.548554339219, 1744.6267073768959, 1129.8270446427825, 1624.246238017768, 1747.3234390185542, 1538.4917958084866, 1887.8218478025972, 1227.1947523399483, 1576.8963155973597, 1643.9474864568751, 647.8418137072607, 1311.9096899163278, 784.3589522475173, 457.26077524534224, 1663.2029386036288, 1880.770761903673, 2103.1117736654064], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [340.73692966912574, 399.0552954039328, 308.99184041070276, 560.7409205448809, 503.58554317155773, 439.6502263560776, 405.4129505526066, 333.5891116873786, 360.2514104473974, 478.8367032471809, 334.05132739423266, 323.3444954108617, 364.08468726408853, 429.7803642107566, 311.8048349159258, 399.4500198472633, 446.7092736120078, 476.1682726217924, 523.0426374392964, 491.1028810585736, 407.1843556723929, 441.84241302082063, 450.33325440980286, 476.6283499521619, 394.1322284691482, 425.8438590170873, 529.2079802936875, 403.8581271651807, 551.7510028515233, 472.64480524829247, 456.8812720527377, 352.16703120160304, 534.3759420720544, 303.64369313952665, 493.0978251489841, 515.5554777913729, 705.4671739576746, 423.0850561430333, 321.57681243749414, 409.99687893648377, 544.5811317157529, 392.68426371070547, 407.08372881626275, 352.8018718981241, 503.0930045268079, 409.1717023684284, 502.68494825452075, 567.0327901282736, 533.2330652298315, 452.4614026599731, 479.99973599366183, 478.76272563834266, 489.81737738344725, 460.21522313623365, 505.34491623795094, 342.7847810389443, 506.5371123215319, 640.2411896257591, 494.65415108945945, 621.7416914685073, 509.7417471317354, 442.76404057141093, 663.6952430244946, 384.5366233025287, 519.8847246963063, 549.8691186539374, 400.7431227618568, 339.7860649688904, 538.342633836806, 445.46935069818267, 371.68698106378525, 461.7083020923116, 424.9469178359292, 418.05919006770205, 285.0109743791471, 441.51079937995814, 409.14007927883296, 430.0063146341889, 381.9711667423364, 424.4925703134809, 470.29000969370173, 379.13109999281585, 555.3900969294856, 541.3415000513118, 183.95373146506563, 485.2418947472895, 631.014956905442, 626.1903871390323, 363.94476053116904, 381.0420182055827, 519.530203715927, 579.289465608315, 493.9485101174114, 594.69194781496, 528.5709251085557, 500.69390678675825, 368.41272349751864, 507.79731949736987, 634.7207523489628, 448.50367983682656, 517.9299363200156, 377.66237136147527, 450.4193207277214, 259.69619809132007, 515.2837407693811, 407.0860551003043, 410.8166453148865, 546.4200697251804, 666.287915417236, 501.1590407841557, 481.7773132262162, 587.4426720112134, 513.8433660757868, 433.5648236283581, 446.91265814626576, 357.542676380365, 297.29898816240103, 379.5897680281493, 375.1982389482964, 440.6061850621143, 512.0631767539525, 477.78786284786247, 574.8412794467177, 395.60377245655474, 421.8203145510468, 582.7970371186861, 420.9046397983249, 374.46204238646936, 499.7822616417044, 384.23728186165033, 454.5821978032767, 644.7679376105751, 414.1785725005903, 419.6542469421073, 541.702586904639, 598.2006324590483, 529.0042289797559, 489.42978531062795, 427.05106594047726, 377.107418656204, 676.9888763570599, 683.3224549926744, 552.8517104688673, 507.9170606332425, 366.93595316716113, 424.0234363351619, 379.3811650770908, 462.1105969258553, 468.61699818510954, 465.0515259001368, 496.8670829479326, 500.6250687905024, 422.784046869538, 359.6938015740157, 535.8197163811643, 610.8431779316473, 387.4339447371656, 544.1235221862416, 452.06768236717676, 623.2920837231195, 391.6491487706471, 636.1879987610831, 390.53547251605863, 409.3069504024787, 540.5038338969428, 560.7714784973691, 507.14774081813243, 394.6193991064908, 496.01179016644613, 436.21365651732555, 199.31973744460547, 521.0175735148782, 525.5655440558135, 328.31954979005104, 542.2096821331507, 394.86136816149593, 599.2733567010864, 491.30488307459257, 451.3384587671154, 490.78912461223047, 578.5366966552974, 293.1347647035382, 430.1694770518052, 481.4830238984383, 617.4295119993476, 328.9998979710935, 288.286692610433, 288.7891898436176, 454.25280549555845, 437.08978629688767, 197.47704411954416, 411.93973329114505, 257.06001165503096, 181.0639241118567, 320.67064285850154, 490.54706732904447, 620.6082325720071, 704.3442581787847, 666.5642803480147, 511.1119800768916], "policy_predator_policy_reward": [485.38138828084243, 442.6237521413328, 526.3941225125604, 510.9704298586034, 564.6229459932966, 544.9661852539446, 507.5246830534772, 522.5171918473267, 454.9291387058056, 411.1967448033475, 207.5150660048027, 154.72308231400302, 632.0849516128877, 616.1401683671942, 596.7416313712663, 637.522920034048, 527.6737558491192, 510.7211142580544, 399.89976926778417, 418.1622388507315, 529.9999139483166, 571.1364501469552, 521.355698582079, 414.90914149121465, 559.5480843946058, 604.7038589220226, 444.4387529365805, 530.4527362386727, 508.2164764203739, 532.3054015715829, 559.8283387603602, 567.1488571367568, 511.12522478594855, 528.1740412070585, 368.8616810077863, 309.69107803090594, 513.7906499595905, 520.7429876162219, 242.16823186635796, 237.20005975158165, 605.9409861412614, 580.9138021563202, 429.24805683729073, 375.0593914829829, 514.6652523568637, 533.3556714691011, 539.5884255630486, 461.261592369891, 318.26069428194074, 303.6950421893474, 504.47150198039986, 550.5717262590617, 417.26528515001576, 489.8767094172706, 562.5225343918584, 520.7056618788505, 317.67284822258, 328.535777857816, 454.3771457416977, 468.25023470018704, 367.94001237624235, 399.0704692944951, 498.28690624125767, 480.90855485025486, 516.5662218141605, 512.6670389828812, 506.7176477351384, 402.5170835799249, 490.0785670423769, 570.5492894476625, 630.865568648745, 589.7168661542859, 428.17249303367987, 404.83936485825313, 410.5394470814085, 420.2403323634341, 498.7781580160418, 557.3573602290891, 604.3902448130908, 588.146396487061, 433.33595050025957, 416.3246922179177, 269.8739381831499, 236.71239464769903, 276.8437705122393, 212.36159587545475, 387.1833944080717, 430.44177219520196, 395.78094695982537, 411.62457854389163, 360.36590635954184, 322.89681032006166, 545.3564541089941, 510.7112100551012, 430.1007589711345, 406.4344139287876, 515.2364206112214, 529.606734490954, 394.6522016345704, 371.95861613586857, 360.14272165363354, 407.29381265276277, 595.7206153102314, 556.7790962838818, 321.93925637277044, 183.3675954907249, 516.4444018360631, 521.4906570041912, 285.3673397113838, 270.7625659265557, 473.0660264352945, 555.2889561954858, 300.81165128122643, 286.8179606483464, 651.9419784160889, 514.3119702812103, 599.7668361747212, 481.5966563331144, 289.1653362065056, 330.9115514541727, 394.9056771631543, 491.61845244433454, 491.16271321593416, 563.915048731286, 365.4536686735358, 362.07932283771873, 564.3601734734737, 537.7290732098677, 637.8573096073512, 620.3470259060624, 253.95494656327713, 363.7660384220138, 619.388182643617, 632.1667129698868, 476.4320786124784, 489.50448463444786, 519.1712944046166, 501.548340725653, 492.0394928564477, 576.3941975180222, 324.33951870944895, 353.6129749377256, 407.18704501653826, 437.9904718719451, 603.7829184473484, 641.662030273891, 442.56597738976365, 420.8276387953303, 468.24139099203086, 420.255047324777, 436.31640291993523, 467.2128124938804, 310.96430576421784, 323.2696256595324, 331.12427580432166, 435.947336575386, 453.349188231395, 446.0553759688674, 317.7845647985478, 388.3615825125624, 313.70228912581064, 268.878461852965, 517.6118196601452, 527.4900801583804, 197.04578758681265, 230.5269607068415, 538.0478786184244, 550.7335357961722, 439.1772440520923, 373.22401664103177, 185.4897078018286, 224.00002588147078, 405.81974938796776, 364.54139478393546, 409.7455805829727, 400.5068081409374, 185.92190238885152, 261.99165364395395, 483.24940706257865, 462.444857360673, 148.4619524186824, 207.06133856243144, 315.0585967037257, 350.1852179433901, 342.93884843104803, 354.5792280553882, 33.63872039978276, 37.12721085342745, 188.80834708684898, 231.75875103703146, 74.47709863718084, 100.4650761996474, 6.343825711484704, 12.793013766970475, 384.4726554926787, 467.51257292340523, 291.4846607006365, 264.33361045224746, 461.00383959639584, 464.43167364410186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.099591151267656, "mean_inference_ms": 6.05765428276756, "mean_action_processing_ms": 0.8912102685752014, "mean_env_wait_ms": 0.7677589041503845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031197547912597656, "StateBufferConnector_ms": 0.04261517524719238, "ViewRequirementAgentConnector_ms": 0.4346883296966553}, "num_episodes": 18, "episode_return_max": 2163.0858676765242, "episode_return_min": 457.26077524534224, "episode_return_mean": 1771.406429064253, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.78820172691924, "num_env_steps_trained_throughput_per_sec": 125.78820172691924, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 34084.428, "restore_workers_time_ms": 0.023, "training_step_time_ms": 34084.356, "sample_time_ms": 7098.063, "learn_time_ms": 26945.489, "learn_throughput": 148.448, "synch_weights_time_ms": 38.964}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "8abce_00000", "date": "2024-08-16_12-03-11", "timestamp": 1723789991, "time_this_iter_s": 31.806597232818604, "time_total_s": 2500.318025112152, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a14ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2500.318025112152, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 44.995555555555555, "ram_util_percent": 74.52888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.474054203273127, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.312883946756838, "policy_loss": -0.0019267112644951023, "vf_loss": 9.313438622913663, "vf_explained_var": -0.11018698593926808, "kl": 0.009147010844959872, "entropy": 1.080981415857083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3418575700944064, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.576250815013099, "policy_loss": -0.002901591735315465, "vf_loss": 9.579127483771591, "vf_explained_var": -0.02574092597557754, "kl": 0.007973945121323, "entropy": 0.8075484495314341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 2270.993182182292, "episode_reward_min": 457.26077524534224, "episode_reward_mean": 1729.3472896302615, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 181.0639241118567, "predator_policy": 6.343825711484704}, "policy_reward_max": {"prey_policy": 704.3442581787847, "predator_policy": 651.9419784160889}, "policy_reward_mean": {"prey_policy": 469.78161481765505, "predator_policy": 394.89202999747584}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1960.2856307212041, 2070.567756315733, 1607.6502043610928, 2013.8056898714685, 1857.1745950869647, 1931.357893547606, 1792.9869280276873, 2039.0232229998524, 1719.5162693738876, 2027.427327418539, 2098.9871041472866, 1649.7639190458096, 2044.4398410250299, 2053.9777179591265, 1676.0179657955625, 1557.3015532039472, 1895.2819121581529, 1999.0003783559694, 1699.0817524046945, 1603.3179298116463, 1158.4009926000501, 2074.8305106477533, 1552.3923042404674, 1782.082386003845, 2144.7081220964624, 1865.8000047952353, 1921.0531980970638, 1849.8352499562293, 1663.0288419878864, 1862.6152304131558, 1427.6766477331794, 1995.1717738803238, 1723.5768618393317, 2097.57496786821, 1535.0378016337177, 1970.7092832239307, 1758.2522486983885, 1435.8813116710892, 1876.3751692093024, 2025.5228138504892, 1732.150343180987, 1897.4559288681376, 2142.2238790167676, 1717.0711203991423, 2085.3877150562002, 2105.8397826106075, 2039.153649420654, 1872.5921749711488, 2038.263824996904, 1905.9462879905923, 2036.4043382235645, 1704.885378188043, 1822.164962402054, 1901.021367152249, 1416.7117798673025, 1913.7345066925147, 1830.962031123667, 1781.5059134014089, 1610.4178985105084, 1844.944322737062, 1528.848060687964, 1990.548554339219, 1744.6267073768959, 1129.8270446427825, 1624.246238017768, 1747.3234390185542, 1538.4917958084866, 1887.8218478025972, 1227.1947523399483, 1576.8963155973597, 1643.9474864568751, 647.8418137072607, 1311.9096899163278, 784.3589522475173, 457.26077524534224, 1663.2029386036288, 1880.770761903673, 2103.1117736654064, 1371.9114605737593, 1978.7072323789362, 2270.993182182292, 1628.4178784541812, 1250.9999327745963, 1865.4113955834812, 1479.0153445010724, 1998.9161768882684, 851.4304876753675, 930.0976274438806, 1625.287077113674, 1898.0736629985647, 1200.9367750606777, 1703.1878579145118, 1174.9894812920827, 2162.396565768021, 1969.8815625436391, 2103.4931321823065, 1154.639654062302, 1989.4147481416126, 1533.4335781792186, 1888.5366850492176], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [503.0930045268079, 409.1717023684284, 502.68494825452075, 567.0327901282736, 533.2330652298315, 452.4614026599731, 479.99973599366183, 478.76272563834266, 489.81737738344725, 460.21522313623365, 505.34491623795094, 342.7847810389443, 506.5371123215319, 640.2411896257591, 494.65415108945945, 621.7416914685073, 509.7417471317354, 442.76404057141093, 663.6952430244946, 384.5366233025287, 519.8847246963063, 549.8691186539374, 400.7431227618568, 339.7860649688904, 538.342633836806, 445.46935069818267, 371.68698106378525, 461.7083020923116, 424.9469178359292, 418.05919006770205, 285.0109743791471, 441.51079937995814, 409.14007927883296, 430.0063146341889, 381.9711667423364, 424.4925703134809, 470.29000969370173, 379.13109999281585, 555.3900969294856, 541.3415000513118, 183.95373146506563, 485.2418947472895, 631.014956905442, 626.1903871390323, 363.94476053116904, 381.0420182055827, 519.530203715927, 579.289465608315, 493.9485101174114, 594.69194781496, 528.5709251085557, 500.69390678675825, 368.41272349751864, 507.79731949736987, 634.7207523489628, 448.50367983682656, 517.9299363200156, 377.66237136147527, 450.4193207277214, 259.69619809132007, 515.2837407693811, 407.0860551003043, 410.8166453148865, 546.4200697251804, 666.287915417236, 501.1590407841557, 481.7773132262162, 587.4426720112134, 513.8433660757868, 433.5648236283581, 446.91265814626576, 357.542676380365, 297.29898816240103, 379.5897680281493, 375.1982389482964, 440.6061850621143, 512.0631767539525, 477.78786284786247, 574.8412794467177, 395.60377245655474, 421.8203145510468, 582.7970371186861, 420.9046397983249, 374.46204238646936, 499.7822616417044, 384.23728186165033, 454.5821978032767, 644.7679376105751, 414.1785725005903, 419.6542469421073, 541.702586904639, 598.2006324590483, 529.0042289797559, 489.42978531062795, 427.05106594047726, 377.107418656204, 676.9888763570599, 683.3224549926744, 552.8517104688673, 507.9170606332425, 366.93595316716113, 424.0234363351619, 379.3811650770908, 462.1105969258553, 468.61699818510954, 465.0515259001368, 496.8670829479326, 500.6250687905024, 422.784046869538, 359.6938015740157, 535.8197163811643, 610.8431779316473, 387.4339447371656, 544.1235221862416, 452.06768236717676, 623.2920837231195, 391.6491487706471, 636.1879987610831, 390.53547251605863, 409.3069504024787, 540.5038338969428, 560.7714784973691, 507.14774081813243, 394.6193991064908, 496.01179016644613, 436.21365651732555, 199.31973744460547, 521.0175735148782, 525.5655440558135, 328.31954979005104, 542.2096821331507, 394.86136816149593, 599.2733567010864, 491.30488307459257, 451.3384587671154, 490.78912461223047, 578.5366966552974, 293.1347647035382, 430.1694770518052, 481.4830238984383, 617.4295119993476, 328.9998979710935, 288.286692610433, 288.7891898436176, 454.25280549555845, 437.08978629688767, 197.47704411954416, 411.93973329114505, 257.06001165503096, 181.0639241118567, 320.67064285850154, 490.54706732904447, 620.6082325720071, 704.3442581787847, 666.5642803480147, 511.1119800768916, 518.1231948312991, 645.003205381612, 502.1454283456439, 495.613710335567, 674.3729204251322, 515.9555786051919, 618.8078045014885, 425.62432047350785, 457.90245532933034, 551.2446041916154, 506.34057495982665, 572.1669796320605, 273.87715974733914, 380.08280910852756, 357.96288449404625, 624.8870235892142, 391.4923473954448, 361.35253823604467, 403.63771364805746, 359.8430187776262, 694.5652094767287, 411.3250023099158, 479.48411737090953, 476.68622796466707, 218.5403615576261, 531.5369400052539, 398.61576519769517, 202.9950962479125, 399.7300234375032, 312.8940375774183, 416.57718864689235, 693.5103614818289, 638.9310886284114, 601.4668372651944, 624.8623046609592, 397.73555167626193, 541.1159349924939, 277.4953480358016, 454.4756683566502, 466.9855104994025, 442.7899177090088, 516.2488388023843, 671.4358212943471, 531.2698662213608], "policy_predator_policy_reward": [514.6652523568637, 533.3556714691011, 539.5884255630486, 461.261592369891, 318.26069428194074, 303.6950421893474, 504.47150198039986, 550.5717262590617, 417.26528515001576, 489.8767094172706, 562.5225343918584, 520.7056618788505, 317.67284822258, 328.535777857816, 454.3771457416977, 468.25023470018704, 367.94001237624235, 399.0704692944951, 498.28690624125767, 480.90855485025486, 516.5662218141605, 512.6670389828812, 506.7176477351384, 402.5170835799249, 490.0785670423769, 570.5492894476625, 630.865568648745, 589.7168661542859, 428.17249303367987, 404.83936485825313, 410.5394470814085, 420.2403323634341, 498.7781580160418, 557.3573602290891, 604.3902448130908, 588.146396487061, 433.33595050025957, 416.3246922179177, 269.8739381831499, 236.71239464769903, 276.8437705122393, 212.36159587545475, 387.1833944080717, 430.44177219520196, 395.78094695982537, 411.62457854389163, 360.36590635954184, 322.89681032006166, 545.3564541089941, 510.7112100551012, 430.1007589711345, 406.4344139287876, 515.2364206112214, 529.606734490954, 394.6522016345704, 371.95861613586857, 360.14272165363354, 407.29381265276277, 595.7206153102314, 556.7790962838818, 321.93925637277044, 183.3675954907249, 516.4444018360631, 521.4906570041912, 285.3673397113838, 270.7625659265557, 473.0660264352945, 555.2889561954858, 300.81165128122643, 286.8179606483464, 651.9419784160889, 514.3119702812103, 599.7668361747212, 481.5966563331144, 289.1653362065056, 330.9115514541727, 394.9056771631543, 491.61845244433454, 491.16271321593416, 563.915048731286, 365.4536686735358, 362.07932283771873, 564.3601734734737, 537.7290732098677, 637.8573096073512, 620.3470259060624, 253.95494656327713, 363.7660384220138, 619.388182643617, 632.1667129698868, 476.4320786124784, 489.50448463444786, 519.1712944046166, 501.548340725653, 492.0394928564477, 576.3941975180222, 324.33951870944895, 353.6129749377256, 407.18704501653826, 437.9904718719451, 603.7829184473484, 641.662030273891, 442.56597738976365, 420.8276387953303, 468.24139099203086, 420.255047324777, 436.31640291993523, 467.2128124938804, 310.96430576421784, 323.2696256595324, 331.12427580432166, 435.947336575386, 453.349188231395, 446.0553759688674, 317.7845647985478, 388.3615825125624, 313.70228912581064, 268.878461852965, 517.6118196601452, 527.4900801583804, 197.04578758681265, 230.5269607068415, 538.0478786184244, 550.7335357961722, 439.1772440520923, 373.22401664103177, 185.4897078018286, 224.00002588147078, 405.81974938796776, 364.54139478393546, 409.7455805829727, 400.5068081409374, 185.92190238885152, 261.99165364395395, 483.24940706257865, 462.444857360673, 148.4619524186824, 207.06133856243144, 315.0585967037257, 350.1852179433901, 342.93884843104803, 354.5792280553882, 33.63872039978276, 37.12721085342745, 188.80834708684898, 231.75875103703146, 74.47709863718084, 100.4650761996474, 6.343825711484704, 12.793013766970475, 384.4726554926787, 467.51257292340523, 291.4846607006365, 264.33361045224746, 461.00383959639584, 464.43167364410186, 94.653731910777, 114.13132845007067, 467.04368198895327, 513.904411708771, 527.2511989422338, 553.4134842097351, 261.3239375549566, 322.6618159242277, 146.21226567001997, 95.64060758363071, 357.2196505460237, 429.6841904455681, 439.1740135031765, 385.8813621420304, 602.3660646231878, 413.70020418182145, 48.13761105257619, 50.447990991301864, 88.68225619743521, 77.93463882076233, 235.9665351140406, 283.4303302129869, 505.5759241263227, 436.3273935366672, 259.5140586743144, 191.3454148234845, 547.2894990525384, 554.2874974163666, 227.67318569456614, 234.69223458259444, 523.9293996979526, 528.3796159413473, 371.69859542975854, 357.785041220275, 465.35895353673584, 615.5363223083502, 169.68476950750812, 166.34360152649913, 542.1479790115269, 525.8055902740298, 287.6310094891101, 286.7638121787148, 332.1270063234828, 353.70399121002816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1033670732622114, "mean_inference_ms": 6.077506958214367, "mean_action_processing_ms": 0.8932271381090311, "mean_env_wait_ms": 0.770009220327262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013996124267578125, "StateBufferConnector_ms": 0.0506511926651001, "ViewRequirementAgentConnector_ms": 0.4506412744522095}, "num_episodes": 22, "episode_return_max": 2270.993182182292, "episode_return_min": 457.26077524534224, "episode_return_mean": 1729.3472896302615, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.21081059401686, "num_env_steps_trained_throughput_per_sec": 137.21081059401686, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 32684.113, "restore_workers_time_ms": 0.023, "training_step_time_ms": 32684.043, "sample_time_ms": 6853.493, "learn_time_ms": 25793.151, "learn_throughput": 155.08, "synch_weights_time_ms": 35.505}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "8abce_00000", "date": "2024-08-16_12-03-41", "timestamp": 1723790021, "time_this_iter_s": 29.160328149795532, "time_total_s": 2529.4783532619476, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4ab2c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2529.4783532619476, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 43.05365853658537, "ram_util_percent": 73.89024390243902}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0625486723329653, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.58570321653255, "policy_loss": -0.0018109523370324896, "vf_loss": 9.586192816779727, "vf_explained_var": -0.07815324291981086, "kl": 0.008808942441521684, "entropy": 1.0398346440186577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0726421224377143, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.455887856559148, "policy_loss": -0.0008120711476458285, "vf_loss": 9.456683157360743, "vf_explained_var": -0.013028357520936028, "kl": 0.005357386319056732, "entropy": 0.7957428907275831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 2270.993182182292, "episode_reward_min": 457.26077524534224, "episode_reward_mean": 1729.607339193685, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 181.0639241118567, "predator_policy": 6.343825711484704}, "policy_reward_max": {"prey_policy": 704.3442581787847, "predator_policy": 651.9419784160889}, "policy_reward_mean": {"prey_policy": 482.40805544507754, "predator_policy": 382.395614151765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1699.0817524046945, 1603.3179298116463, 1158.4009926000501, 2074.8305106477533, 1552.3923042404674, 1782.082386003845, 2144.7081220964624, 1865.8000047952353, 1921.0531980970638, 1849.8352499562293, 1663.0288419878864, 1862.6152304131558, 1427.6766477331794, 1995.1717738803238, 1723.5768618393317, 2097.57496786821, 1535.0378016337177, 1970.7092832239307, 1758.2522486983885, 1435.8813116710892, 1876.3751692093024, 2025.5228138504892, 1732.150343180987, 1897.4559288681376, 2142.2238790167676, 1717.0711203991423, 2085.3877150562002, 2105.8397826106075, 2039.153649420654, 1872.5921749711488, 2038.263824996904, 1905.9462879905923, 2036.4043382235645, 1704.885378188043, 1822.164962402054, 1901.021367152249, 1416.7117798673025, 1913.7345066925147, 1830.962031123667, 1781.5059134014089, 1610.4178985105084, 1844.944322737062, 1528.848060687964, 1990.548554339219, 1744.6267073768959, 1129.8270446427825, 1624.246238017768, 1747.3234390185542, 1538.4917958084866, 1887.8218478025972, 1227.1947523399483, 1576.8963155973597, 1643.9474864568751, 647.8418137072607, 1311.9096899163278, 784.3589522475173, 457.26077524534224, 1663.2029386036288, 1880.770761903673, 2103.1117736654064, 1371.9114605737593, 1978.7072323789362, 2270.993182182292, 1628.4178784541812, 1250.9999327745963, 1865.4113955834812, 1479.0153445010724, 1998.9161768882684, 851.4304876753675, 930.0976274438806, 1625.287077113674, 1898.0736629985647, 1200.9367750606777, 1703.1878579145118, 1174.9894812920827, 2162.396565768021, 1969.8815625436391, 2103.4931321823065, 1154.639654062302, 1989.4147481416126, 1533.4335781792186, 1888.5366850492176, 1883.201055012181, 2099.284227338255, 1792.281388168056, 1861.6290304173035, 1915.1865720509643, 1694.4805915454065, 1956.2890964283283, 2001.355470087533, 2040.433114963246, 1894.0330087267887, 1991.948093669291, 2147.7731864644893, 1962.2903646069983, 1379.2914720435729, 1349.2198213108245, 2016.5685322278973, 2033.9395406719852, 2001.366300024121], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [470.29000969370173, 379.13109999281585, 555.3900969294856, 541.3415000513118, 183.95373146506563, 485.2418947472895, 631.014956905442, 626.1903871390323, 363.94476053116904, 381.0420182055827, 519.530203715927, 579.289465608315, 493.9485101174114, 594.69194781496, 528.5709251085557, 500.69390678675825, 368.41272349751864, 507.79731949736987, 634.7207523489628, 448.50367983682656, 517.9299363200156, 377.66237136147527, 450.4193207277214, 259.69619809132007, 515.2837407693811, 407.0860551003043, 410.8166453148865, 546.4200697251804, 666.287915417236, 501.1590407841557, 481.7773132262162, 587.4426720112134, 513.8433660757868, 433.5648236283581, 446.91265814626576, 357.542676380365, 297.29898816240103, 379.5897680281493, 375.1982389482964, 440.6061850621143, 512.0631767539525, 477.78786284786247, 574.8412794467177, 395.60377245655474, 421.8203145510468, 582.7970371186861, 420.9046397983249, 374.46204238646936, 499.7822616417044, 384.23728186165033, 454.5821978032767, 644.7679376105751, 414.1785725005903, 419.6542469421073, 541.702586904639, 598.2006324590483, 529.0042289797559, 489.42978531062795, 427.05106594047726, 377.107418656204, 676.9888763570599, 683.3224549926744, 552.8517104688673, 507.9170606332425, 366.93595316716113, 424.0234363351619, 379.3811650770908, 462.1105969258553, 468.61699818510954, 465.0515259001368, 496.8670829479326, 500.6250687905024, 422.784046869538, 359.6938015740157, 535.8197163811643, 610.8431779316473, 387.4339447371656, 544.1235221862416, 452.06768236717676, 623.2920837231195, 391.6491487706471, 636.1879987610831, 390.53547251605863, 409.3069504024787, 540.5038338969428, 560.7714784973691, 507.14774081813243, 394.6193991064908, 496.01179016644613, 436.21365651732555, 199.31973744460547, 521.0175735148782, 525.5655440558135, 328.31954979005104, 542.2096821331507, 394.86136816149593, 599.2733567010864, 491.30488307459257, 451.3384587671154, 490.78912461223047, 578.5366966552974, 293.1347647035382, 430.1694770518052, 481.4830238984383, 617.4295119993476, 328.9998979710935, 288.286692610433, 288.7891898436176, 454.25280549555845, 437.08978629688767, 197.47704411954416, 411.93973329114505, 257.06001165503096, 181.0639241118567, 320.67064285850154, 490.54706732904447, 620.6082325720071, 704.3442581787847, 666.5642803480147, 511.1119800768916, 518.1231948312991, 645.003205381612, 502.1454283456439, 495.613710335567, 674.3729204251322, 515.9555786051919, 618.8078045014885, 425.62432047350785, 457.90245532933034, 551.2446041916154, 506.34057495982665, 572.1669796320605, 273.87715974733914, 380.08280910852756, 357.96288449404625, 624.8870235892142, 391.4923473954448, 361.35253823604467, 403.63771364805746, 359.8430187776262, 694.5652094767287, 411.3250023099158, 479.48411737090953, 476.68622796466707, 218.5403615576261, 531.5369400052539, 398.61576519769517, 202.9950962479125, 399.7300234375032, 312.8940375774183, 416.57718864689235, 693.5103614818289, 638.9310886284114, 601.4668372651944, 624.8623046609592, 397.73555167626193, 541.1159349924939, 277.4953480358016, 454.4756683566502, 466.9855104994025, 442.7899177090088, 516.2488388023843, 671.4358212943471, 531.2698662213608, 597.9179022494117, 508.03653138534594, 492.93942221161706, 578.8074596094675, 453.06801386673857, 527.9095690118556, 443.0599065662207, 618.3366117417871, 584.5048109019347, 416.2024300335594, 628.9568195985975, 595.4128302984751, 465.1855868690403, 472.8533115164151, 691.2141410125661, 607.0837202316206, 569.4018119093341, 579.6502304198809, 623.2558251466411, 530.1652397879732, 530.2873798270887, 522.9041620469634, 651.2198749054247, 423.66429093668927, 625.0750702389252, 496.5440061986026, 590.4455444127934, 434.0559612972411, 453.4122116848523, 529.9292301953112, 539.0098182690527, 538.2905953082914, 305.9963620493964, 490.19668723970494, 608.856360384362, 632.5801786568085], "policy_predator_policy_reward": [433.33595050025957, 416.3246922179177, 269.8739381831499, 236.71239464769903, 276.8437705122393, 212.36159587545475, 387.1833944080717, 430.44177219520196, 395.78094695982537, 411.62457854389163, 360.36590635954184, 322.89681032006166, 545.3564541089941, 510.7112100551012, 430.1007589711345, 406.4344139287876, 515.2364206112214, 529.606734490954, 394.6522016345704, 371.95861613586857, 360.14272165363354, 407.29381265276277, 595.7206153102314, 556.7790962838818, 321.93925637277044, 183.3675954907249, 516.4444018360631, 521.4906570041912, 285.3673397113838, 270.7625659265557, 473.0660264352945, 555.2889561954858, 300.81165128122643, 286.8179606483464, 651.9419784160889, 514.3119702812103, 599.7668361747212, 481.5966563331144, 289.1653362065056, 330.9115514541727, 394.9056771631543, 491.61845244433454, 491.16271321593416, 563.915048731286, 365.4536686735358, 362.07932283771873, 564.3601734734737, 537.7290732098677, 637.8573096073512, 620.3470259060624, 253.95494656327713, 363.7660384220138, 619.388182643617, 632.1667129698868, 476.4320786124784, 489.50448463444786, 519.1712944046166, 501.548340725653, 492.0394928564477, 576.3941975180222, 324.33951870944895, 353.6129749377256, 407.18704501653826, 437.9904718719451, 603.7829184473484, 641.662030273891, 442.56597738976365, 420.8276387953303, 468.24139099203086, 420.255047324777, 436.31640291993523, 467.2128124938804, 310.96430576421784, 323.2696256595324, 331.12427580432166, 435.947336575386, 453.349188231395, 446.0553759688674, 317.7845647985478, 388.3615825125624, 313.70228912581064, 268.878461852965, 517.6118196601452, 527.4900801583804, 197.04578758681265, 230.5269607068415, 538.0478786184244, 550.7335357961722, 439.1772440520923, 373.22401664103177, 185.4897078018286, 224.00002588147078, 405.81974938796776, 364.54139478393546, 409.7455805829727, 400.5068081409374, 185.92190238885152, 261.99165364395395, 483.24940706257865, 462.444857360673, 148.4619524186824, 207.06133856243144, 315.0585967037257, 350.1852179433901, 342.93884843104803, 354.5792280553882, 33.63872039978276, 37.12721085342745, 188.80834708684898, 231.75875103703146, 74.47709863718084, 100.4650761996474, 6.343825711484704, 12.793013766970475, 384.4726554926787, 467.51257292340523, 291.4846607006365, 264.33361045224746, 461.00383959639584, 464.43167364410186, 94.653731910777, 114.13132845007067, 467.04368198895327, 513.904411708771, 527.2511989422338, 553.4134842097351, 261.3239375549566, 322.6618159242277, 146.21226567001997, 95.64060758363071, 357.2196505460237, 429.6841904455681, 439.1740135031765, 385.8813621420304, 602.3660646231878, 413.70020418182145, 48.13761105257619, 50.447990991301864, 88.68225619743521, 77.93463882076233, 235.9665351140406, 283.4303302129869, 505.5759241263227, 436.3273935366672, 259.5140586743144, 191.3454148234845, 547.2894990525384, 554.2874974163666, 227.67318569456614, 234.69223458259444, 523.9293996979526, 528.3796159413473, 371.69859542975854, 357.785041220275, 465.35895353673584, 615.5363223083502, 169.68476950750812, 166.34360152649913, 542.1479790115269, 525.8055902740298, 287.6310094891101, 286.7638121787148, 332.1270063234828, 353.70399121002816, 349.3944644012424, 427.85215697618077, 485.1983749253124, 542.3389705918588, 411.52100779682405, 399.78279749263726, 412.0517174745625, 388.1807946347326, 511.4575530185554, 403.021778096913, 208.1619375665998, 261.949004081736, 517.6494613025559, 500.60073674031804, 375.5982272224708, 327.4593816208745, 469.0635336883088, 422.3175389457247, 418.5430174439334, 322.0689263482398, 440.91640788656974, 497.8401439086719, 531.7352008597857, 541.1538197625925, 368.2240835847295, 472.4472045847414, 184.37710785508256, 170.41285847845373, 181.24675980053013, 184.63161963013115, 501.50171504558665, 437.7664036049675, 631.823666763369, 605.9228246195128, 403.24421375214223, 356.68554723081377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1092185828864034, "mean_inference_ms": 6.087398086746775, "mean_action_processing_ms": 0.8949881109047177, "mean_env_wait_ms": 0.7720857898255663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016830921173095703, "StateBufferConnector_ms": 0.019881248474121094, "ViewRequirementAgentConnector_ms": 0.44818997383117676}, "num_episodes": 18, "episode_return_max": 2270.993182182292, "episode_return_min": 457.26077524534224, "episode_return_mean": 1729.607339193685, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.5672189149322, "num_env_steps_trained_throughput_per_sec": 139.5672189149322, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 31731.506, "restore_workers_time_ms": 0.023, "training_step_time_ms": 31731.437, "sample_time_ms": 6602.167, "learn_time_ms": 25097.343, "learn_throughput": 159.379, "synch_weights_time_ms": 29.941}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "8abce_00000", "date": "2024-08-16_12-04-09", "timestamp": 1723790049, "time_this_iter_s": 28.667279958724976, "time_total_s": 2558.1456332206726, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a67700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2558.1456332206726, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 44.31249999999999, "ram_util_percent": 73.6325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.648379930459633, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.500113457472867, "policy_loss": -0.003442253866331484, "vf_loss": 9.502473637414356, "vf_explained_var": 0.010730286533870394, "kl": 0.007213786717068902, "entropy": 1.0499894715175426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0911877593981525, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.435189579151295, "policy_loss": -0.00038528625050155573, "vf_loss": 9.435548668311387, "vf_explained_var": -0.043689127920796635, "kl": 0.008381853804930341, "entropy": 0.737651542191783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 2270.993182182292, "episode_reward_min": 457.26077524534224, "episode_reward_mean": 1706.805189500566, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 181.0639241118567, "predator_policy": 6.343825711484704}, "policy_reward_max": {"prey_policy": 727.975037316516, "predator_policy": 641.662030273891}, "policy_reward_mean": {"prey_policy": 491.4462620107353, "predator_policy": 361.9563327395478}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1897.4559288681376, 2142.2238790167676, 1717.0711203991423, 2085.3877150562002, 2105.8397826106075, 2039.153649420654, 1872.5921749711488, 2038.263824996904, 1905.9462879905923, 2036.4043382235645, 1704.885378188043, 1822.164962402054, 1901.021367152249, 1416.7117798673025, 1913.7345066925147, 1830.962031123667, 1781.5059134014089, 1610.4178985105084, 1844.944322737062, 1528.848060687964, 1990.548554339219, 1744.6267073768959, 1129.8270446427825, 1624.246238017768, 1747.3234390185542, 1538.4917958084866, 1887.8218478025972, 1227.1947523399483, 1576.8963155973597, 1643.9474864568751, 647.8418137072607, 1311.9096899163278, 784.3589522475173, 457.26077524534224, 1663.2029386036288, 1880.770761903673, 2103.1117736654064, 1371.9114605737593, 1978.7072323789362, 2270.993182182292, 1628.4178784541812, 1250.9999327745963, 1865.4113955834812, 1479.0153445010724, 1998.9161768882684, 851.4304876753675, 930.0976274438806, 1625.287077113674, 1898.0736629985647, 1200.9367750606777, 1703.1878579145118, 1174.9894812920827, 2162.396565768021, 1969.8815625436391, 2103.4931321823065, 1154.639654062302, 1989.4147481416126, 1533.4335781792186, 1888.5366850492176, 1883.201055012181, 2099.284227338255, 1792.281388168056, 1861.6290304173035, 1915.1865720509643, 1694.4805915454065, 1956.2890964283283, 2001.355470087533, 2040.433114963246, 1894.0330087267887, 1991.948093669291, 2147.7731864644893, 1962.2903646069983, 1379.2914720435729, 1349.2198213108245, 2016.5685322278973, 2033.9395406719852, 2001.366300024121, 1088.3166211459081, 1875.5620953195319, 1671.5901298532408, 742.4731570466823, 1762.050848140649, 752.1811432318046, 1964.047732457384, 1590.5196350483934, 1694.5141881381026, 1918.3923240089873, 1574.3711797839655, 1860.21756193464, 1885.190881710728, 1796.847505402121, 1906.368387920389, 1879.7724793794578, 1920.8989691530542, 1786.8802201244948, 1344.2156960241418, 1870.8881439073098, 1832.911459837891, 1892.5543816500476, 1864.0960353126313], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [420.9046397983249, 374.46204238646936, 499.7822616417044, 384.23728186165033, 454.5821978032767, 644.7679376105751, 414.1785725005903, 419.6542469421073, 541.702586904639, 598.2006324590483, 529.0042289797559, 489.42978531062795, 427.05106594047726, 377.107418656204, 676.9888763570599, 683.3224549926744, 552.8517104688673, 507.9170606332425, 366.93595316716113, 424.0234363351619, 379.3811650770908, 462.1105969258553, 468.61699818510954, 465.0515259001368, 496.8670829479326, 500.6250687905024, 422.784046869538, 359.6938015740157, 535.8197163811643, 610.8431779316473, 387.4339447371656, 544.1235221862416, 452.06768236717676, 623.2920837231195, 391.6491487706471, 636.1879987610831, 390.53547251605863, 409.3069504024787, 540.5038338969428, 560.7714784973691, 507.14774081813243, 394.6193991064908, 496.01179016644613, 436.21365651732555, 199.31973744460547, 521.0175735148782, 525.5655440558135, 328.31954979005104, 542.2096821331507, 394.86136816149593, 599.2733567010864, 491.30488307459257, 451.3384587671154, 490.78912461223047, 578.5366966552974, 293.1347647035382, 430.1694770518052, 481.4830238984383, 617.4295119993476, 328.9998979710935, 288.286692610433, 288.7891898436176, 454.25280549555845, 437.08978629688767, 197.47704411954416, 411.93973329114505, 257.06001165503096, 181.0639241118567, 320.67064285850154, 490.54706732904447, 620.6082325720071, 704.3442581787847, 666.5642803480147, 511.1119800768916, 518.1231948312991, 645.003205381612, 502.1454283456439, 495.613710335567, 674.3729204251322, 515.9555786051919, 618.8078045014885, 425.62432047350785, 457.90245532933034, 551.2446041916154, 506.34057495982665, 572.1669796320605, 273.87715974733914, 380.08280910852756, 357.96288449404625, 624.8870235892142, 391.4923473954448, 361.35253823604467, 403.63771364805746, 359.8430187776262, 694.5652094767287, 411.3250023099158, 479.48411737090953, 476.68622796466707, 218.5403615576261, 531.5369400052539, 398.61576519769517, 202.9950962479125, 399.7300234375032, 312.8940375774183, 416.57718864689235, 693.5103614818289, 638.9310886284114, 601.4668372651944, 624.8623046609592, 397.73555167626193, 541.1159349924939, 277.4953480358016, 454.4756683566502, 466.9855104994025, 442.7899177090088, 516.2488388023843, 671.4358212943471, 531.2698662213608, 597.9179022494117, 508.03653138534594, 492.93942221161706, 578.8074596094675, 453.06801386673857, 527.9095690118556, 443.0599065662207, 618.3366117417871, 584.5048109019347, 416.2024300335594, 628.9568195985975, 595.4128302984751, 465.1855868690403, 472.8533115164151, 691.2141410125661, 607.0837202316206, 569.4018119093341, 579.6502304198809, 623.2558251466411, 530.1652397879732, 530.2873798270887, 522.9041620469634, 651.2198749054247, 423.66429093668927, 625.0750702389252, 496.5440061986026, 590.4455444127934, 434.0559612972411, 453.4122116848523, 529.9292301953112, 539.0098182690527, 538.2905953082914, 305.9963620493964, 490.19668723970494, 608.856360384362, 632.5801786568085, 461.1337466974875, 356.0917149640345, 533.0426434155572, 535.4879304046543, 640.9200768644841, 653.4987279965018, 396.7480036295035, 249.82927349858716, 689.2155359786786, 655.8561427904489, 276.0334216309814, 329.11027764136776, 510.9367422057607, 624.7171785033905, 600.4273549253619, 223.6466627985666, 708.3340088868708, 522.6352144823126, 673.0148051692266, 350.9083997693596, 510.4295911135486, 313.0424180398448, 619.8952684250222, 297.1701686837944, 526.071730223339, 532.9676514415685, 668.497067748294, 616.7972370782517, 541.0154224678959, 375.2327759825152, 437.9435076014141, 494.1516589500272, 727.975037316516, 481.96287033175815, 629.2856965152962, 416.2770170802784, 338.0882000869548, 600.9104308963616, 589.7399258291736, 514.9550364738219, 639.3414666019022, 662.8422599997301, 473.0438752765074, 384.50959356283886, 465.6625421037957, 683.3963174971336], "policy_predator_policy_reward": [564.3601734734737, 537.7290732098677, 637.8573096073512, 620.3470259060624, 253.95494656327713, 363.7660384220138, 619.388182643617, 632.1667129698868, 476.4320786124784, 489.50448463444786, 519.1712944046166, 501.548340725653, 492.0394928564477, 576.3941975180222, 324.33951870944895, 353.6129749377256, 407.18704501653826, 437.9904718719451, 603.7829184473484, 641.662030273891, 442.56597738976365, 420.8276387953303, 468.24139099203086, 420.255047324777, 436.31640291993523, 467.2128124938804, 310.96430576421784, 323.2696256595324, 331.12427580432166, 435.947336575386, 453.349188231395, 446.0553759688674, 317.7845647985478, 388.3615825125624, 313.70228912581064, 268.878461852965, 517.6118196601452, 527.4900801583804, 197.04578758681265, 230.5269607068415, 538.0478786184244, 550.7335357961722, 439.1772440520923, 373.22401664103177, 185.4897078018286, 224.00002588147078, 405.81974938796776, 364.54139478393546, 409.7455805829727, 400.5068081409374, 185.92190238885152, 261.99165364395395, 483.24940706257865, 462.444857360673, 148.4619524186824, 207.06133856243144, 315.0585967037257, 350.1852179433901, 342.93884843104803, 354.5792280553882, 33.63872039978276, 37.12721085342745, 188.80834708684898, 231.75875103703146, 74.47709863718084, 100.4650761996474, 6.343825711484704, 12.793013766970475, 384.4726554926787, 467.51257292340523, 291.4846607006365, 264.33361045224746, 461.00383959639584, 464.43167364410186, 94.653731910777, 114.13132845007067, 467.04368198895327, 513.904411708771, 527.2511989422338, 553.4134842097351, 261.3239375549566, 322.6618159242277, 146.21226567001997, 95.64060758363071, 357.2196505460237, 429.6841904455681, 439.1740135031765, 385.8813621420304, 602.3660646231878, 413.70020418182145, 48.13761105257619, 50.447990991301864, 88.68225619743521, 77.93463882076233, 235.9665351140406, 283.4303302129869, 505.5759241263227, 436.3273935366672, 259.5140586743144, 191.3454148234845, 547.2894990525384, 554.2874974163666, 227.67318569456614, 234.69223458259444, 523.9293996979526, 528.3796159413473, 371.69859542975854, 357.785041220275, 465.35895353673584, 615.5363223083502, 169.68476950750812, 166.34360152649913, 542.1479790115269, 525.8055902740298, 287.6310094891101, 286.7638121787148, 332.1270063234828, 353.70399121002816, 349.3944644012424, 427.85215697618077, 485.1983749253124, 542.3389705918588, 411.52100779682405, 399.78279749263726, 412.0517174745625, 388.1807946347326, 511.4575530185554, 403.021778096913, 208.1619375665998, 261.949004081736, 517.6494613025559, 500.60073674031804, 375.5982272224708, 327.4593816208745, 469.0635336883088, 422.3175389457247, 418.5430174439334, 322.0689263482398, 440.91640788656974, 497.8401439086719, 531.7352008597857, 541.1538197625925, 368.2240835847295, 472.4472045847414, 184.37710785508256, 170.41285847845373, 181.24675980053013, 184.63161963013115, 501.50171504558665, 437.7664036049675, 631.823666763369, 605.9228246195128, 403.24421375214223, 356.68554723081377, 140.54032617445282, 130.55083330993443, 376.54239842237723, 430.48912307694206, 187.667209548796, 189.5041154434556, 48.00290703859113, 47.892972880000954, 224.52095017361853, 192.4582191979029, 76.13079504423091, 70.90664891522441, 430.8903247015406, 397.5034870466895, 373.47137724951773, 392.97424007494635, 241.1174578115144, 222.4275069574033, 423.8803085201489, 470.58881055025154, 369.5654142039082, 381.3337564266643, 413.91198815374173, 529.2401366720821, 380.3569200381304, 445.7945800076922, 263.65300673543464, 247.90019384014047, 579.5885815095631, 410.53160796041516, 446.659193206168, 501.0181196218492, 323.26986005028874, 387.69120145449534, 359.81319276191545, 381.50431376700374, 205.2518820224675, 199.96518301835636, 339.8409949933158, 426.35218661099617, 302.3017452775378, 228.4259879587195, 518.0713146343039, 516.9295981763947, 374.53838269948574, 340.4987930122154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1133531617742385, "mean_inference_ms": 6.1053574227328875, "mean_action_processing_ms": 0.8962848049017235, "mean_env_wait_ms": 0.7738059174787177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016314148902893066, "StateBufferConnector_ms": 0.019902467727661133, "ViewRequirementAgentConnector_ms": 0.47999870777130127}, "num_episodes": 23, "episode_return_max": 2270.993182182292, "episode_return_min": 457.26077524534224, "episode_return_mean": 1706.805189500566, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.8572724851421, "num_env_steps_trained_throughput_per_sec": 137.8572724851421, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 30410.091, "restore_workers_time_ms": 0.022, "training_step_time_ms": 30410.024, "sample_time_ms": 5931.647, "learn_time_ms": 24447.91, "learn_throughput": 163.613, "synch_weights_time_ms": 28.436}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "8abce_00000", "date": "2024-08-16_12-04-38", "timestamp": 1723790078, "time_this_iter_s": 29.022950172424316, "time_total_s": 2587.168583393097, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a435faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2587.168583393097, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 43.52439024390244, "ram_util_percent": 73.6951219512195}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.372598312582288, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.364287344614665, "policy_loss": -0.003605850800137632, "vf_loss": 9.366373552594865, "vf_explained_var": 0.02903561516413613, "kl": 0.010131008734738038, "entropy": 1.0109566254275186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.117031353444019, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.552742988344223, "policy_loss": 0.001230442581609601, "vf_loss": 9.551491112179226, "vf_explained_var": 0.059169261449228516, "kl": 0.00685303573184302, "entropy": 0.7602686536375177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 2270.993182182292, "episode_reward_min": 457.26077524534224, "episode_reward_mean": 1699.7817100366165, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 181.0639241118567, "predator_policy": 6.343825711484704}, "policy_reward_max": {"prey_policy": 727.975037316516, "predator_policy": 631.823666763369}, "policy_reward_mean": {"prey_policy": 496.10931999204195, "predator_policy": 353.78153502626634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1844.944322737062, 1528.848060687964, 1990.548554339219, 1744.6267073768959, 1129.8270446427825, 1624.246238017768, 1747.3234390185542, 1538.4917958084866, 1887.8218478025972, 1227.1947523399483, 1576.8963155973597, 1643.9474864568751, 647.8418137072607, 1311.9096899163278, 784.3589522475173, 457.26077524534224, 1663.2029386036288, 1880.770761903673, 2103.1117736654064, 1371.9114605737593, 1978.7072323789362, 2270.993182182292, 1628.4178784541812, 1250.9999327745963, 1865.4113955834812, 1479.0153445010724, 1998.9161768882684, 851.4304876753675, 930.0976274438806, 1625.287077113674, 1898.0736629985647, 1200.9367750606777, 1703.1878579145118, 1174.9894812920827, 2162.396565768021, 1969.8815625436391, 2103.4931321823065, 1154.639654062302, 1989.4147481416126, 1533.4335781792186, 1888.5366850492176, 1883.201055012181, 2099.284227338255, 1792.281388168056, 1861.6290304173035, 1915.1865720509643, 1694.4805915454065, 1956.2890964283283, 2001.355470087533, 2040.433114963246, 1894.0330087267887, 1991.948093669291, 2147.7731864644893, 1962.2903646069983, 1379.2914720435729, 1349.2198213108245, 2016.5685322278973, 2033.9395406719852, 2001.366300024121, 1088.3166211459081, 1875.5620953195319, 1671.5901298532408, 742.4731570466823, 1762.050848140649, 752.1811432318046, 1964.047732457384, 1590.5196350483934, 1694.5141881381026, 1918.3923240089873, 1574.3711797839655, 1860.21756193464, 1885.190881710728, 1796.847505402121, 1906.368387920389, 1879.7724793794578, 1920.8989691530542, 1786.8802201244948, 1344.2156960241418, 1870.8881439073098, 1832.911459837891, 1892.5543816500476, 1864.0960353126313, 2109.262189644586, 1813.7041716131293, 1697.1007384607788, 1885.0941307801002, 1675.6915591507666, 1772.092883251643, 1844.1894962347812, 2072.1097871481625, 1471.1986600972452, 1861.52312589314, 1948.8199304822472, 2007.2961334249737, 1777.6311683236263, 2029.2919527606052, 1767.0887509501465, 1914.3709499191978, 1592.053378629522, 1880.875585731859], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [390.53547251605863, 409.3069504024787, 540.5038338969428, 560.7714784973691, 507.14774081813243, 394.6193991064908, 496.01179016644613, 436.21365651732555, 199.31973744460547, 521.0175735148782, 525.5655440558135, 328.31954979005104, 542.2096821331507, 394.86136816149593, 599.2733567010864, 491.30488307459257, 451.3384587671154, 490.78912461223047, 578.5366966552974, 293.1347647035382, 430.1694770518052, 481.4830238984383, 617.4295119993476, 328.9998979710935, 288.286692610433, 288.7891898436176, 454.25280549555845, 437.08978629688767, 197.47704411954416, 411.93973329114505, 257.06001165503096, 181.0639241118567, 320.67064285850154, 490.54706732904447, 620.6082325720071, 704.3442581787847, 666.5642803480147, 511.1119800768916, 518.1231948312991, 645.003205381612, 502.1454283456439, 495.613710335567, 674.3729204251322, 515.9555786051919, 618.8078045014885, 425.62432047350785, 457.90245532933034, 551.2446041916154, 506.34057495982665, 572.1669796320605, 273.87715974733914, 380.08280910852756, 357.96288449404625, 624.8870235892142, 391.4923473954448, 361.35253823604467, 403.63771364805746, 359.8430187776262, 694.5652094767287, 411.3250023099158, 479.48411737090953, 476.68622796466707, 218.5403615576261, 531.5369400052539, 398.61576519769517, 202.9950962479125, 399.7300234375032, 312.8940375774183, 416.57718864689235, 693.5103614818289, 638.9310886284114, 601.4668372651944, 624.8623046609592, 397.73555167626193, 541.1159349924939, 277.4953480358016, 454.4756683566502, 466.9855104994025, 442.7899177090088, 516.2488388023843, 671.4358212943471, 531.2698662213608, 597.9179022494117, 508.03653138534594, 492.93942221161706, 578.8074596094675, 453.06801386673857, 527.9095690118556, 443.0599065662207, 618.3366117417871, 584.5048109019347, 416.2024300335594, 628.9568195985975, 595.4128302984751, 465.1855868690403, 472.8533115164151, 691.2141410125661, 607.0837202316206, 569.4018119093341, 579.6502304198809, 623.2558251466411, 530.1652397879732, 530.2873798270887, 522.9041620469634, 651.2198749054247, 423.66429093668927, 625.0750702389252, 496.5440061986026, 590.4455444127934, 434.0559612972411, 453.4122116848523, 529.9292301953112, 539.0098182690527, 538.2905953082914, 305.9963620493964, 490.19668723970494, 608.856360384362, 632.5801786568085, 461.1337466974875, 356.0917149640345, 533.0426434155572, 535.4879304046543, 640.9200768644841, 653.4987279965018, 396.7480036295035, 249.82927349858716, 689.2155359786786, 655.8561427904489, 276.0334216309814, 329.11027764136776, 510.9367422057607, 624.7171785033905, 600.4273549253619, 223.6466627985666, 708.3340088868708, 522.6352144823126, 673.0148051692266, 350.9083997693596, 510.4295911135486, 313.0424180398448, 619.8952684250222, 297.1701686837944, 526.071730223339, 532.9676514415685, 668.497067748294, 616.7972370782517, 541.0154224678959, 375.2327759825152, 437.9435076014141, 494.1516589500272, 727.975037316516, 481.96287033175815, 629.2856965152962, 416.2770170802784, 338.0882000869548, 600.9104308963616, 589.7399258291736, 514.9550364738219, 639.3414666019022, 662.8422599997301, 473.0438752765074, 384.50959356283886, 465.6625421037957, 683.3963174971336, 677.8214400252909, 328.74866463624863, 580.3793611294869, 383.46803986696233, 481.1260351352257, 560.5196956841683, 492.1349948384242, 450.07920853510916, 465.84567428867337, 586.3499595225757, 558.5519493285914, 662.2383577342883, 628.3279441275494, 529.5309326770744, 432.4759096288752, 566.8858151526987, 360.20235667451783, 425.3000695354254, 591.0369412805071, 367.85769399122745, 447.6625381119851, 602.5680745327462, 377.56870034820423, 619.5356711898409, 540.9250791500151, 500.0513773947286, 522.3602924046787, 517.2951703781964, 540.2690354477958, 577.3730456046819, 314.15108980754, 440.69984638977553, 464.79724603443924, 696.2656319638352, 555.5490679996351, 610.3106375883461], "policy_predator_policy_reward": [517.6118196601452, 527.4900801583804, 197.04578758681265, 230.5269607068415, 538.0478786184244, 550.7335357961722, 439.1772440520923, 373.22401664103177, 185.4897078018286, 224.00002588147078, 405.81974938796776, 364.54139478393546, 409.7455805829727, 400.5068081409374, 185.92190238885152, 261.99165364395395, 483.24940706257865, 462.444857360673, 148.4619524186824, 207.06133856243144, 315.0585967037257, 350.1852179433901, 342.93884843104803, 354.5792280553882, 33.63872039978276, 37.12721085342745, 188.80834708684898, 231.75875103703146, 74.47709863718084, 100.4650761996474, 6.343825711484704, 12.793013766970475, 384.4726554926787, 467.51257292340523, 291.4846607006365, 264.33361045224746, 461.00383959639584, 464.43167364410186, 94.653731910777, 114.13132845007067, 467.04368198895327, 513.904411708771, 527.2511989422338, 553.4134842097351, 261.3239375549566, 322.6618159242277, 146.21226567001997, 95.64060758363071, 357.2196505460237, 429.6841904455681, 439.1740135031765, 385.8813621420304, 602.3660646231878, 413.70020418182145, 48.13761105257619, 50.447990991301864, 88.68225619743521, 77.93463882076233, 235.9665351140406, 283.4303302129869, 505.5759241263227, 436.3273935366672, 259.5140586743144, 191.3454148234845, 547.2894990525384, 554.2874974163666, 227.67318569456614, 234.69223458259444, 523.9293996979526, 528.3796159413473, 371.69859542975854, 357.785041220275, 465.35895353673584, 615.5363223083502, 169.68476950750812, 166.34360152649913, 542.1479790115269, 525.8055902740298, 287.6310094891101, 286.7638121787148, 332.1270063234828, 353.70399121002816, 349.3944644012424, 427.85215697618077, 485.1983749253124, 542.3389705918588, 411.52100779682405, 399.78279749263726, 412.0517174745625, 388.1807946347326, 511.4575530185554, 403.021778096913, 208.1619375665998, 261.949004081736, 517.6494613025559, 500.60073674031804, 375.5982272224708, 327.4593816208745, 469.0635336883088, 422.3175389457247, 418.5430174439334, 322.0689263482398, 440.91640788656974, 497.8401439086719, 531.7352008597857, 541.1538197625925, 368.2240835847295, 472.4472045847414, 184.37710785508256, 170.41285847845373, 181.24675980053013, 184.63161963013115, 501.50171504558665, 437.7664036049675, 631.823666763369, 605.9228246195128, 403.24421375214223, 356.68554723081377, 140.54032617445282, 130.55083330993443, 376.54239842237723, 430.48912307694206, 187.667209548796, 189.5041154434556, 48.00290703859113, 47.892972880000954, 224.52095017361853, 192.4582191979029, 76.13079504423091, 70.90664891522441, 430.8903247015406, 397.5034870466895, 373.47137724951773, 392.97424007494635, 241.1174578115144, 222.4275069574033, 423.8803085201489, 470.58881055025154, 369.5654142039082, 381.3337564266643, 413.91198815374173, 529.2401366720821, 380.3569200381304, 445.7945800076922, 263.65300673543464, 247.90019384014047, 579.5885815095631, 410.53160796041516, 446.659193206168, 501.0181196218492, 323.26986005028874, 387.69120145449534, 359.81319276191545, 381.50431376700374, 205.2518820224675, 199.96518301835636, 339.8409949933158, 426.35218661099617, 302.3017452775378, 228.4259879587195, 518.0713146343039, 516.9295981763947, 374.53838269948574, 340.4987930122154, 563.9197620258396, 538.772322957204, 407.04673498324274, 442.8100356334385, 281.39580066014173, 374.0592069812461, 482.3906169275283, 460.4893104790373, 314.5030987530401, 308.9928265864775, 236.85283872189984, 314.4497374668638, 305.11240780997514, 381.2182116201812, 567.6120016119319, 505.13606075465395, 374.88247785322557, 310.8137560340765, 452.78176980260537, 449.8467208187971, 483.8223015444767, 414.76701629303903, 476.5194477107884, 533.672314176141, 373.20512175577744, 363.44959002310645, 437.0615677175779, 552.5749222601515, 327.35863391071604, 322.0880359869514, 557.7876077953542, 601.732405926528, 220.97846565087303, 210.01203498037398, 358.8616436509365, 356.1542364929409]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1187623536110807, "mean_inference_ms": 6.11713711975075, "mean_action_processing_ms": 0.8984598403976696, "mean_env_wait_ms": 0.7759417090860868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0166168212890625, "StateBufferConnector_ms": 0.016595125198364258, "ViewRequirementAgentConnector_ms": 0.4934178590774536}, "num_episodes": 18, "episode_return_max": 2270.993182182292, "episode_return_min": 457.26077524534224, "episode_return_mean": 1699.7817100366165, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 136.24272321408307, "num_env_steps_trained_throughput_per_sec": 136.24272321408307, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 30034.413, "restore_workers_time_ms": 0.02, "training_step_time_ms": 30034.351, "sample_time_ms": 5655.971, "learn_time_ms": 24347.233, "learn_throughput": 164.29, "synch_weights_time_ms": 29.211}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "8abce_00000", "date": "2024-08-16_12-05-08", "timestamp": 1723790108, "time_this_iter_s": 29.44342803955078, "time_total_s": 2616.6120114326477, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a289d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2616.6120114326477, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 43.07857142857143, "ram_util_percent": 73.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7025377230669454, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.479774777851407, "policy_loss": -0.0023733755415946086, "vf_loss": 9.480800659946663, "vf_explained_var": -0.02381295085584045, "kl": 0.008983157327578999, "entropy": 1.0360098736626762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.85356206252146, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.50447579287978, "policy_loss": 0.0008173754145563753, "vf_loss": 9.503623363959095, "vf_explained_var": 0.006211109672273909, "kl": 0.011214027791991425, "entropy": 0.6948197368906919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 2270.993182182292, "episode_reward_min": 742.4731570466823, "episode_reward_mean": 1759.3680891617032, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 202.9950962479125, "predator_policy": 47.892972880000954}, "policy_reward_max": {"prey_policy": 771.6356645295928, "predator_policy": 631.823666763369}, "policy_reward_mean": {"prey_policy": 510.87100613142024, "predator_policy": 368.81303844943136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2103.1117736654064, 1371.9114605737593, 1978.7072323789362, 2270.993182182292, 1628.4178784541812, 1250.9999327745963, 1865.4113955834812, 1479.0153445010724, 1998.9161768882684, 851.4304876753675, 930.0976274438806, 1625.287077113674, 1898.0736629985647, 1200.9367750606777, 1703.1878579145118, 1174.9894812920827, 2162.396565768021, 1969.8815625436391, 2103.4931321823065, 1154.639654062302, 1989.4147481416126, 1533.4335781792186, 1888.5366850492176, 1883.201055012181, 2099.284227338255, 1792.281388168056, 1861.6290304173035, 1915.1865720509643, 1694.4805915454065, 1956.2890964283283, 2001.355470087533, 2040.433114963246, 1894.0330087267887, 1991.948093669291, 2147.7731864644893, 1962.2903646069983, 1379.2914720435729, 1349.2198213108245, 2016.5685322278973, 2033.9395406719852, 2001.366300024121, 1088.3166211459081, 1875.5620953195319, 1671.5901298532408, 742.4731570466823, 1762.050848140649, 752.1811432318046, 1964.047732457384, 1590.5196350483934, 1694.5141881381026, 1918.3923240089873, 1574.3711797839655, 1860.21756193464, 1885.190881710728, 1796.847505402121, 1906.368387920389, 1879.7724793794578, 1920.8989691530542, 1786.8802201244948, 1344.2156960241418, 1870.8881439073098, 1832.911459837891, 1892.5543816500476, 1864.0960353126313, 2109.262189644586, 1813.7041716131293, 1697.1007384607788, 1885.0941307801002, 1675.6915591507666, 1772.092883251643, 1844.1894962347812, 2072.1097871481625, 1471.1986600972452, 1861.52312589314, 1948.8199304822472, 2007.2961334249737, 1777.6311683236263, 2029.2919527606052, 1767.0887509501465, 1914.3709499191978, 1592.053378629522, 1880.875585731859, 1952.0505555132258, 1923.2437430137452, 949.1155512288084, 2121.1204865738, 2055.437939716226, 2041.3009365300832, 1645.1121047009603, 1769.3493168076166, 1778.8974429874102, 1910.7232286618078, 1207.105266317709, 1877.849962815186, 1883.2944649327997, 2073.3010944019725, 1902.0757311452462, 1766.4672499374194, 1672.6922894630384, 1659.5620442108714], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [666.5642803480147, 511.1119800768916, 518.1231948312991, 645.003205381612, 502.1454283456439, 495.613710335567, 674.3729204251322, 515.9555786051919, 618.8078045014885, 425.62432047350785, 457.90245532933034, 551.2446041916154, 506.34057495982665, 572.1669796320605, 273.87715974733914, 380.08280910852756, 357.96288449404625, 624.8870235892142, 391.4923473954448, 361.35253823604467, 403.63771364805746, 359.8430187776262, 694.5652094767287, 411.3250023099158, 479.48411737090953, 476.68622796466707, 218.5403615576261, 531.5369400052539, 398.61576519769517, 202.9950962479125, 399.7300234375032, 312.8940375774183, 416.57718864689235, 693.5103614818289, 638.9310886284114, 601.4668372651944, 624.8623046609592, 397.73555167626193, 541.1159349924939, 277.4953480358016, 454.4756683566502, 466.9855104994025, 442.7899177090088, 516.2488388023843, 671.4358212943471, 531.2698662213608, 597.9179022494117, 508.03653138534594, 492.93942221161706, 578.8074596094675, 453.06801386673857, 527.9095690118556, 443.0599065662207, 618.3366117417871, 584.5048109019347, 416.2024300335594, 628.9568195985975, 595.4128302984751, 465.1855868690403, 472.8533115164151, 691.2141410125661, 607.0837202316206, 569.4018119093341, 579.6502304198809, 623.2558251466411, 530.1652397879732, 530.2873798270887, 522.9041620469634, 651.2198749054247, 423.66429093668927, 625.0750702389252, 496.5440061986026, 590.4455444127934, 434.0559612972411, 453.4122116848523, 529.9292301953112, 539.0098182690527, 538.2905953082914, 305.9963620493964, 490.19668723970494, 608.856360384362, 632.5801786568085, 461.1337466974875, 356.0917149640345, 533.0426434155572, 535.4879304046543, 640.9200768644841, 653.4987279965018, 396.7480036295035, 249.82927349858716, 689.2155359786786, 655.8561427904489, 276.0334216309814, 329.11027764136776, 510.9367422057607, 624.7171785033905, 600.4273549253619, 223.6466627985666, 708.3340088868708, 522.6352144823126, 673.0148051692266, 350.9083997693596, 510.4295911135486, 313.0424180398448, 619.8952684250222, 297.1701686837944, 526.071730223339, 532.9676514415685, 668.497067748294, 616.7972370782517, 541.0154224678959, 375.2327759825152, 437.9435076014141, 494.1516589500272, 727.975037316516, 481.96287033175815, 629.2856965152962, 416.2770170802784, 338.0882000869548, 600.9104308963616, 589.7399258291736, 514.9550364738219, 639.3414666019022, 662.8422599997301, 473.0438752765074, 384.50959356283886, 465.6625421037957, 683.3963174971336, 677.8214400252909, 328.74866463624863, 580.3793611294869, 383.46803986696233, 481.1260351352257, 560.5196956841683, 492.1349948384242, 450.07920853510916, 465.84567428867337, 586.3499595225757, 558.5519493285914, 662.2383577342883, 628.3279441275494, 529.5309326770744, 432.4759096288752, 566.8858151526987, 360.20235667451783, 425.3000695354254, 591.0369412805071, 367.85769399122745, 447.6625381119851, 602.5680745327462, 377.56870034820423, 619.5356711898409, 540.9250791500151, 500.0513773947286, 522.3602924046787, 517.2951703781964, 540.2690354477958, 577.3730456046819, 314.15108980754, 440.69984638977553, 464.79724603443924, 696.2656319638352, 555.5490679996351, 610.3106375883461, 604.304126580035, 449.5274576416128, 516.5482824310689, 568.0863368145887, 245.62135735509864, 469.9158810631224, 536.3167252861741, 596.1655754290314, 601.6476738641221, 730.4281196902195, 503.12778668553693, 558.1843565377645, 306.13385917287127, 467.3593162405671, 482.5533764397418, 443.93442541929477, 456.2069437127307, 463.5906233256284, 648.0467376807703, 767.3959126850764, 359.91578580763087, 447.13476780437446, 525.6636121366525, 453.39113620612324, 458.6270806250601, 495.25603237097147, 527.1832751101318, 443.4014409696107, 426.89960830445216, 452.29336512187285, 648.0681185557839, 522.5824399859616, 399.9470271120601, 771.6356645295928, 749.5478424162175, 516.6875175823054], "policy_predator_policy_reward": [461.00383959639584, 464.43167364410186, 94.653731910777, 114.13132845007067, 467.04368198895327, 513.904411708771, 527.2511989422338, 553.4134842097351, 261.3239375549566, 322.6618159242277, 146.21226567001997, 95.64060758363071, 357.2196505460237, 429.6841904455681, 439.1740135031765, 385.8813621420304, 602.3660646231878, 413.70020418182145, 48.13761105257619, 50.447990991301864, 88.68225619743521, 77.93463882076233, 235.9665351140406, 283.4303302129869, 505.5759241263227, 436.3273935366672, 259.5140586743144, 191.3454148234845, 547.2894990525384, 554.2874974163666, 227.67318569456614, 234.69223458259444, 523.9293996979526, 528.3796159413473, 371.69859542975854, 357.785041220275, 465.35895353673584, 615.5363223083502, 169.68476950750812, 166.34360152649913, 542.1479790115269, 525.8055902740298, 287.6310094891101, 286.7638121787148, 332.1270063234828, 353.70399121002816, 349.3944644012424, 427.85215697618077, 485.1983749253124, 542.3389705918588, 411.52100779682405, 399.78279749263726, 412.0517174745625, 388.1807946347326, 511.4575530185554, 403.021778096913, 208.1619375665998, 261.949004081736, 517.6494613025559, 500.60073674031804, 375.5982272224708, 327.4593816208745, 469.0635336883088, 422.3175389457247, 418.5430174439334, 322.0689263482398, 440.91640788656974, 497.8401439086719, 531.7352008597857, 541.1538197625925, 368.2240835847295, 472.4472045847414, 184.37710785508256, 170.41285847845373, 181.24675980053013, 184.63161963013115, 501.50171504558665, 437.7664036049675, 631.823666763369, 605.9228246195128, 403.24421375214223, 356.68554723081377, 140.54032617445282, 130.55083330993443, 376.54239842237723, 430.48912307694206, 187.667209548796, 189.5041154434556, 48.00290703859113, 47.892972880000954, 224.52095017361853, 192.4582191979029, 76.13079504423091, 70.90664891522441, 430.8903247015406, 397.5034870466895, 373.47137724951773, 392.97424007494635, 241.1174578115144, 222.4275069574033, 423.8803085201489, 470.58881055025154, 369.5654142039082, 381.3337564266643, 413.91198815374173, 529.2401366720821, 380.3569200381304, 445.7945800076922, 263.65300673543464, 247.90019384014047, 579.5885815095631, 410.53160796041516, 446.659193206168, 501.0181196218492, 323.26986005028874, 387.69120145449534, 359.81319276191545, 381.50431376700374, 205.2518820224675, 199.96518301835636, 339.8409949933158, 426.35218661099617, 302.3017452775378, 228.4259879587195, 518.0713146343039, 516.9295981763947, 374.53838269948574, 340.4987930122154, 563.9197620258396, 538.772322957204, 407.04673498324274, 442.8100356334385, 281.39580066014173, 374.0592069812461, 482.3906169275283, 460.4893104790373, 314.5030987530401, 308.9928265864775, 236.85283872189984, 314.4497374668638, 305.11240780997514, 381.2182116201812, 567.6120016119319, 505.13606075465395, 374.88247785322557, 310.8137560340765, 452.78176980260537, 449.8467208187971, 483.8223015444767, 414.76701629303903, 476.5194477107884, 533.672314176141, 373.20512175577744, 363.44959002310645, 437.0615677175779, 552.5749222601515, 327.35863391071604, 322.0880359869514, 557.7876077953542, 601.732405926528, 220.97846565087303, 210.01203498037398, 358.8616436509365, 356.1542364929409, 419.17596052564534, 479.0430107659321, 427.4808433525255, 411.1282804155667, 120.70418913952864, 112.87412367106005, 503.76670374226205, 484.8714821163315, 389.9891699828613, 333.37297617902783, 475.77266426561715, 504.21612904116455, 454.97539099988495, 416.6435382876397, 402.53985541652315, 440.3216595320567, 435.98963353893913, 423.11024241011114, 252.04666826873185, 243.23391002722911, 153.25248320801435, 246.80222949768842, 455.2373059189873, 443.55790855342474, 509.9723439055514, 419.43900803121596, 529.6116812029393, 573.1046971192942, 508.07097387090204, 514.8117838480205, 288.7924990212493, 307.02419237442166, 251.28224027529737, 249.82735754608922, 128.12196662997542, 265.2047175823722]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.122701724550181, "mean_inference_ms": 6.130656623369386, "mean_action_processing_ms": 0.8999064371469586, "mean_env_wait_ms": 0.7777903013662629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02605140209197998, "StateBufferConnector_ms": 0.016339421272277832, "ViewRequirementAgentConnector_ms": 0.5026503801345825}, "num_episodes": 18, "episode_return_max": 2270.993182182292, "episode_return_min": 742.4731570466823, "episode_return_mean": 1759.3680891617032, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 138.79041126708503, "num_env_steps_trained_throughput_per_sec": 138.79041126708503, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 29640.415, "restore_workers_time_ms": 0.02, "training_step_time_ms": 29640.356, "sample_time_ms": 5447.872, "learn_time_ms": 24159.601, "learn_throughput": 165.566, "synch_weights_time_ms": 31.083}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "8abce_00000", "date": "2024-08-16_12-05-37", "timestamp": 1723790137, "time_this_iter_s": 28.833897829055786, "time_total_s": 2645.4459092617035, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a67dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2645.4459092617035, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 41.9609756097561, "ram_util_percent": 73.85853658536585}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.085865722068403, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.56087439653104, "policy_loss": 0.0009514804654779336, "vf_loss": 9.558088009950346, "vf_explained_var": -0.04301990087700899, "kl": 0.012232688672918955, "entropy": 1.026469299055281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.268727586824427, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.456449701924804, "policy_loss": -0.0014171877745341845, "vf_loss": 9.457842886889422, "vf_explained_var": -0.004050034915328657, "kl": 0.007677086940683491, "entropy": 0.685511836267653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 2147.7731864644893, "episode_reward_min": 742.4731570466823, "episode_reward_mean": 1804.5813270283245, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 223.6466627985666, "predator_policy": 47.892972880000954}, "policy_reward_max": {"prey_policy": 824.9673284750883, "predator_policy": 631.823666763369}, "policy_reward_mean": {"prey_policy": 519.8994503184902, "predator_policy": 382.3912131956723}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1888.5366850492176, 1883.201055012181, 2099.284227338255, 1792.281388168056, 1861.6290304173035, 1915.1865720509643, 1694.4805915454065, 1956.2890964283283, 2001.355470087533, 2040.433114963246, 1894.0330087267887, 1991.948093669291, 2147.7731864644893, 1962.2903646069983, 1379.2914720435729, 1349.2198213108245, 2016.5685322278973, 2033.9395406719852, 2001.366300024121, 1088.3166211459081, 1875.5620953195319, 1671.5901298532408, 742.4731570466823, 1762.050848140649, 752.1811432318046, 1964.047732457384, 1590.5196350483934, 1694.5141881381026, 1918.3923240089873, 1574.3711797839655, 1860.21756193464, 1885.190881710728, 1796.847505402121, 1906.368387920389, 1879.7724793794578, 1920.8989691530542, 1786.8802201244948, 1344.2156960241418, 1870.8881439073098, 1832.911459837891, 1892.5543816500476, 1864.0960353126313, 2109.262189644586, 1813.7041716131293, 1697.1007384607788, 1885.0941307801002, 1675.6915591507666, 1772.092883251643, 1844.1894962347812, 2072.1097871481625, 1471.1986600972452, 1861.52312589314, 1948.8199304822472, 2007.2961334249737, 1777.6311683236263, 2029.2919527606052, 1767.0887509501465, 1914.3709499191978, 1592.053378629522, 1880.875585731859, 1952.0505555132258, 1923.2437430137452, 949.1155512288084, 2121.1204865738, 2055.437939716226, 2041.3009365300832, 1645.1121047009603, 1769.3493168076166, 1778.8974429874102, 1910.7232286618078, 1207.105266317709, 1877.849962815186, 1883.2944649327997, 2073.3010944019725, 1902.0757311452462, 1766.4672499374194, 1672.6922894630384, 1659.5620442108714, 1646.6524151457854, 1864.6689125978276, 1963.253720820186, 1914.6864091369512, 1982.4084219489207, 1606.4741612125367, 1566.63052986944, 1963.9461782532321, 2114.8149246646553, 1984.5361844500349, 1597.5275966414597, 2005.1806352150552, 2070.8851755572373, 1932.1414887556864, 1799.7820996541163, 1753.3841228382748, 1961.9898004425847, 1775.7005939175958, 1906.4173870446662, 1958.8185547940743, 1608.2179458713565, 1787.9531152083705], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [671.4358212943471, 531.2698662213608, 597.9179022494117, 508.03653138534594, 492.93942221161706, 578.8074596094675, 453.06801386673857, 527.9095690118556, 443.0599065662207, 618.3366117417871, 584.5048109019347, 416.2024300335594, 628.9568195985975, 595.4128302984751, 465.1855868690403, 472.8533115164151, 691.2141410125661, 607.0837202316206, 569.4018119093341, 579.6502304198809, 623.2558251466411, 530.1652397879732, 530.2873798270887, 522.9041620469634, 651.2198749054247, 423.66429093668927, 625.0750702389252, 496.5440061986026, 590.4455444127934, 434.0559612972411, 453.4122116848523, 529.9292301953112, 539.0098182690527, 538.2905953082914, 305.9963620493964, 490.19668723970494, 608.856360384362, 632.5801786568085, 461.1337466974875, 356.0917149640345, 533.0426434155572, 535.4879304046543, 640.9200768644841, 653.4987279965018, 396.7480036295035, 249.82927349858716, 689.2155359786786, 655.8561427904489, 276.0334216309814, 329.11027764136776, 510.9367422057607, 624.7171785033905, 600.4273549253619, 223.6466627985666, 708.3340088868708, 522.6352144823126, 673.0148051692266, 350.9083997693596, 510.4295911135486, 313.0424180398448, 619.8952684250222, 297.1701686837944, 526.071730223339, 532.9676514415685, 668.497067748294, 616.7972370782517, 541.0154224678959, 375.2327759825152, 437.9435076014141, 494.1516589500272, 727.975037316516, 481.96287033175815, 629.2856965152962, 416.2770170802784, 338.0882000869548, 600.9104308963616, 589.7399258291736, 514.9550364738219, 639.3414666019022, 662.8422599997301, 473.0438752765074, 384.50959356283886, 465.6625421037957, 683.3963174971336, 677.8214400252909, 328.74866463624863, 580.3793611294869, 383.46803986696233, 481.1260351352257, 560.5196956841683, 492.1349948384242, 450.07920853510916, 465.84567428867337, 586.3499595225757, 558.5519493285914, 662.2383577342883, 628.3279441275494, 529.5309326770744, 432.4759096288752, 566.8858151526987, 360.20235667451783, 425.3000695354254, 591.0369412805071, 367.85769399122745, 447.6625381119851, 602.5680745327462, 377.56870034820423, 619.5356711898409, 540.9250791500151, 500.0513773947286, 522.3602924046787, 517.2951703781964, 540.2690354477958, 577.3730456046819, 314.15108980754, 440.69984638977553, 464.79724603443924, 696.2656319638352, 555.5490679996351, 610.3106375883461, 604.304126580035, 449.5274576416128, 516.5482824310689, 568.0863368145887, 245.62135735509864, 469.9158810631224, 536.3167252861741, 596.1655754290314, 601.6476738641221, 730.4281196902195, 503.12778668553693, 558.1843565377645, 306.13385917287127, 467.3593162405671, 482.5533764397418, 443.93442541929477, 456.2069437127307, 463.5906233256284, 648.0467376807703, 767.3959126850764, 359.91578580763087, 447.13476780437446, 525.6636121366525, 453.39113620612324, 458.6270806250601, 495.25603237097147, 527.1832751101318, 443.4014409696107, 426.89960830445216, 452.29336512187285, 648.0681185557839, 522.5824399859616, 399.9470271120601, 771.6356645295928, 749.5478424162175, 516.6875175823054, 506.2232524830618, 451.64658051767964, 548.4548618258998, 445.73477680103395, 612.0128052887374, 505.07660894955353, 475.08157359501223, 399.36219021382493, 532.1111367197891, 512.6416365254416, 531.491827442567, 621.8714174055337, 390.33571626716844, 454.79484726281805, 577.6998902403925, 532.1366880552407, 428.7390482136577, 572.6648929894396, 526.8206402888076, 430.9131248243343, 434.41908160633767, 518.114802993701, 585.0850591809493, 539.3351164276911, 778.623555041807, 575.4344926199886, 417.6158956801351, 497.5587992590241, 593.1354846024843, 475.8598307506243, 540.1125025872442, 392.61850247997177, 436.3284133390208, 824.9673284750883, 585.3125224202981, 594.939441667401, 515.6994173594148, 525.1424187397478, 459.52326876515457, 473.4136483919867, 349.46271577848455, 568.9644057342529, 542.4521025935862, 538.4363793439998], "policy_predator_policy_reward": [332.1270063234828, 353.70399121002816, 349.3944644012424, 427.85215697618077, 485.1983749253124, 542.3389705918588, 411.52100779682405, 399.78279749263726, 412.0517174745625, 388.1807946347326, 511.4575530185554, 403.021778096913, 208.1619375665998, 261.949004081736, 517.6494613025559, 500.60073674031804, 375.5982272224708, 327.4593816208745, 469.0635336883088, 422.3175389457247, 418.5430174439334, 322.0689263482398, 440.91640788656974, 497.8401439086719, 531.7352008597857, 541.1538197625925, 368.2240835847295, 472.4472045847414, 184.37710785508256, 170.41285847845373, 181.24675980053013, 184.63161963013115, 501.50171504558665, 437.7664036049675, 631.823666763369, 605.9228246195128, 403.24421375214223, 356.68554723081377, 140.54032617445282, 130.55083330993443, 376.54239842237723, 430.48912307694206, 187.667209548796, 189.5041154434556, 48.00290703859113, 47.892972880000954, 224.52095017361853, 192.4582191979029, 76.13079504423091, 70.90664891522441, 430.8903247015406, 397.5034870466895, 373.47137724951773, 392.97424007494635, 241.1174578115144, 222.4275069574033, 423.8803085201489, 470.58881055025154, 369.5654142039082, 381.3337564266643, 413.91198815374173, 529.2401366720821, 380.3569200381304, 445.7945800076922, 263.65300673543464, 247.90019384014047, 579.5885815095631, 410.53160796041516, 446.659193206168, 501.0181196218492, 323.26986005028874, 387.69120145449534, 359.81319276191545, 381.50431376700374, 205.2518820224675, 199.96518301835636, 339.8409949933158, 426.35218661099617, 302.3017452775378, 228.4259879587195, 518.0713146343039, 516.9295981763947, 374.53838269948574, 340.4987930122154, 563.9197620258396, 538.772322957204, 407.04673498324274, 442.8100356334385, 281.39580066014173, 374.0592069812461, 482.3906169275283, 460.4893104790373, 314.5030987530401, 308.9928265864775, 236.85283872189984, 314.4497374668638, 305.11240780997514, 381.2182116201812, 567.6120016119319, 505.13606075465395, 374.88247785322557, 310.8137560340765, 452.78176980260537, 449.8467208187971, 483.8223015444767, 414.76701629303903, 476.5194477107884, 533.672314176141, 373.20512175577744, 363.44959002310645, 437.0615677175779, 552.5749222601515, 327.35863391071604, 322.0880359869514, 557.7876077953542, 601.732405926528, 220.97846565087303, 210.01203498037398, 358.8616436509365, 356.1542364929409, 419.17596052564534, 479.0430107659321, 427.4808433525255, 411.1282804155667, 120.70418913952864, 112.87412367106005, 503.76670374226205, 484.8714821163315, 389.9891699828613, 333.37297617902783, 475.77266426561715, 504.21612904116455, 454.97539099988495, 416.6435382876397, 402.53985541652315, 440.3216595320567, 435.98963353893913, 423.11024241011114, 252.04666826873185, 243.23391002722911, 153.25248320801435, 246.80222949768842, 455.2373059189873, 443.55790855342474, 509.9723439055514, 419.43900803121596, 529.6116812029393, 573.1046971192942, 508.07097387090204, 514.8117838480205, 288.7924990212493, 307.02419237442166, 251.28224027529737, 249.82735754608922, 128.12196662997542, 265.2047175823722, 372.81504307911183, 315.9675390659305, 448.1629307137848, 422.31634325711013, 399.6212583370976, 446.543048244802, 504.0069383408063, 536.2357069873074, 477.1912609401469, 460.46438776354444, 215.15084497075947, 237.9600713936764, 352.2560322821042, 369.2439340573468, 436.6141443607383, 417.49545559686266, 567.3716326862711, 546.0393507752848, 525.3625217555066, 501.439897581385, 323.2021534658457, 321.79155857557623, 428.33271881084175, 452.42774079557154, 349.3831563595891, 367.4439715358536, 550.0229659097333, 466.94382790679373, 416.98692454345695, 313.79985975754903, 391.9525047188652, 428.7006130521906, 376.9540305972453, 323.7400280312342, 297.641357639017, 297.8072721908818, 448.7751620609156, 416.8003888845886, 561.3510880677783, 464.53054956915275, 388.59361210413556, 301.1972122544773, 375.9135443489556, 331.15108892183116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1303035580689365, "mean_inference_ms": 6.156092099319944, "mean_action_processing_ms": 0.9027491650806755, "mean_env_wait_ms": 0.7809108736670208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02607285976409912, "StateBufferConnector_ms": 0.009184598922729492, "ViewRequirementAgentConnector_ms": 0.8460484743118286}, "num_episodes": 22, "episode_return_max": 2147.7731864644893, "episode_return_min": 742.4731570466823, "episode_return_mean": 1804.5813270283245, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 136.34934937117606, "num_env_steps_trained_throughput_per_sec": 136.34934937117606, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 29590.425, "restore_workers_time_ms": 0.02, "training_step_time_ms": 29590.368, "sample_time_ms": 5695.644, "learn_time_ms": 23859.796, "learn_throughput": 167.646, "synch_weights_time_ms": 33.016}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "8abce_00000", "date": "2024-08-16_12-06-06", "timestamp": 1723790166, "time_this_iter_s": 29.368404865264893, "time_total_s": 2674.8143141269684, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a433faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2674.8143141269684, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 45.24615384615385, "ram_util_percent": 74.16410256410255}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.273457499770891, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.59824954946205, "policy_loss": -0.0015951088265018173, "vf_loss": 9.598498787955632, "vf_explained_var": -0.010916828699212856, "kl": 0.008972722609526104, "entropy": 0.9694827208758662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1955175826473843, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.534544609715699, "policy_loss": -0.0012620549146381635, "vf_loss": 9.535792346732327, "vf_explained_var": -0.04845067540173808, "kl": 0.0045818713836663005, "entropy": 0.6767311570505616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 2181.108594437973, "episode_reward_min": 742.4731570466823, "episode_reward_mean": 1763.711967968734, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 154.97897385317498, "predator_policy": 47.892972880000954}, "policy_reward_max": {"prey_policy": 824.9673284750883, "predator_policy": 668.8160453468885}, "policy_reward_mean": {"prey_policy": 514.478452427119, "predator_policy": 367.3775315572477}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2001.366300024121, 1088.3166211459081, 1875.5620953195319, 1671.5901298532408, 742.4731570466823, 1762.050848140649, 752.1811432318046, 1964.047732457384, 1590.5196350483934, 1694.5141881381026, 1918.3923240089873, 1574.3711797839655, 1860.21756193464, 1885.190881710728, 1796.847505402121, 1906.368387920389, 1879.7724793794578, 1920.8989691530542, 1786.8802201244948, 1344.2156960241418, 1870.8881439073098, 1832.911459837891, 1892.5543816500476, 1864.0960353126313, 2109.262189644586, 1813.7041716131293, 1697.1007384607788, 1885.0941307801002, 1675.6915591507666, 1772.092883251643, 1844.1894962347812, 2072.1097871481625, 1471.1986600972452, 1861.52312589314, 1948.8199304822472, 2007.2961334249737, 1777.6311683236263, 2029.2919527606052, 1767.0887509501465, 1914.3709499191978, 1592.053378629522, 1880.875585731859, 1952.0505555132258, 1923.2437430137452, 949.1155512288084, 2121.1204865738, 2055.437939716226, 2041.3009365300832, 1645.1121047009603, 1769.3493168076166, 1778.8974429874102, 1910.7232286618078, 1207.105266317709, 1877.849962815186, 1883.2944649327997, 2073.3010944019725, 1902.0757311452462, 1766.4672499374194, 1672.6922894630384, 1659.5620442108714, 1646.6524151457854, 1864.6689125978276, 1963.253720820186, 1914.6864091369512, 1982.4084219489207, 1606.4741612125367, 1566.63052986944, 1963.9461782532321, 2114.8149246646553, 1984.5361844500349, 1597.5275966414597, 2005.1806352150552, 2070.8851755572373, 1932.1414887556864, 1799.7820996541163, 1753.3841228382748, 1961.9898004425847, 1775.7005939175958, 1906.4173870446662, 1958.8185547940743, 1608.2179458713565, 1787.9531152083705, 1475.782609370971, 1799.2355282784547, 1787.4904148916276, 1610.4778831325393, 995.9600794716652, 2098.83667888107, 1581.3736379152704, 1688.549034914523, 2052.8483668472563, 1347.2722741291534, 1731.7530343554367, 1262.8538706242418, 951.2720176613132, 2012.5397294491079, 1984.4565653676107, 1376.7395780250652, 2181.108594437973, 1882.2554470699038], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [608.856360384362, 632.5801786568085, 461.1337466974875, 356.0917149640345, 533.0426434155572, 535.4879304046543, 640.9200768644841, 653.4987279965018, 396.7480036295035, 249.82927349858716, 689.2155359786786, 655.8561427904489, 276.0334216309814, 329.11027764136776, 510.9367422057607, 624.7171785033905, 600.4273549253619, 223.6466627985666, 708.3340088868708, 522.6352144823126, 673.0148051692266, 350.9083997693596, 510.4295911135486, 313.0424180398448, 619.8952684250222, 297.1701686837944, 526.071730223339, 532.9676514415685, 668.497067748294, 616.7972370782517, 541.0154224678959, 375.2327759825152, 437.9435076014141, 494.1516589500272, 727.975037316516, 481.96287033175815, 629.2856965152962, 416.2770170802784, 338.0882000869548, 600.9104308963616, 589.7399258291736, 514.9550364738219, 639.3414666019022, 662.8422599997301, 473.0438752765074, 384.50959356283886, 465.6625421037957, 683.3963174971336, 677.8214400252909, 328.74866463624863, 580.3793611294869, 383.46803986696233, 481.1260351352257, 560.5196956841683, 492.1349948384242, 450.07920853510916, 465.84567428867337, 586.3499595225757, 558.5519493285914, 662.2383577342883, 628.3279441275494, 529.5309326770744, 432.4759096288752, 566.8858151526987, 360.20235667451783, 425.3000695354254, 591.0369412805071, 367.85769399122745, 447.6625381119851, 602.5680745327462, 377.56870034820423, 619.5356711898409, 540.9250791500151, 500.0513773947286, 522.3602924046787, 517.2951703781964, 540.2690354477958, 577.3730456046819, 314.15108980754, 440.69984638977553, 464.79724603443924, 696.2656319638352, 555.5490679996351, 610.3106375883461, 604.304126580035, 449.5274576416128, 516.5482824310689, 568.0863368145887, 245.62135735509864, 469.9158810631224, 536.3167252861741, 596.1655754290314, 601.6476738641221, 730.4281196902195, 503.12778668553693, 558.1843565377645, 306.13385917287127, 467.3593162405671, 482.5533764397418, 443.93442541929477, 456.2069437127307, 463.5906233256284, 648.0467376807703, 767.3959126850764, 359.91578580763087, 447.13476780437446, 525.6636121366525, 453.39113620612324, 458.6270806250601, 495.25603237097147, 527.1832751101318, 443.4014409696107, 426.89960830445216, 452.29336512187285, 648.0681185557839, 522.5824399859616, 399.9470271120601, 771.6356645295928, 749.5478424162175, 516.6875175823054, 506.2232524830618, 451.64658051767964, 548.4548618258998, 445.73477680103395, 612.0128052887374, 505.07660894955353, 475.08157359501223, 399.36219021382493, 532.1111367197891, 512.6416365254416, 531.491827442567, 621.8714174055337, 390.33571626716844, 454.79484726281805, 577.6998902403925, 532.1366880552407, 428.7390482136577, 572.6648929894396, 526.8206402888076, 430.9131248243343, 434.41908160633767, 518.114802993701, 585.0850591809493, 539.3351164276911, 778.623555041807, 575.4344926199886, 417.6158956801351, 497.5587992590241, 593.1354846024843, 475.8598307506243, 540.1125025872442, 392.61850247997177, 436.3284133390208, 824.9673284750883, 585.3125224202981, 594.939441667401, 515.6994173594148, 525.1424187397478, 459.52326876515457, 473.4136483919867, 349.46271577848455, 568.9644057342529, 542.4521025935862, 538.4363793439998, 316.98401584166913, 547.8250077248256, 516.4229136760684, 461.66024591701665, 512.831849879891, 561.8059796182795, 685.9618634188937, 470.2082330348704, 154.97897385317498, 580.440344283149, 536.673637778707, 544.2030537530294, 374.47226926287294, 819.5139427296689, 602.8085805705399, 564.9219602992498, 439.722914101122, 622.4194881828627, 358.67106228606775, 558.6315456514087, 582.7759258039378, 522.5354264285477, 469.0619150547418, 441.4303115044874, 274.30167626855024, 253.21195887610796, 682.2005703186442, 635.6290579130398, 786.1898535430747, 586.3264733727412, 573.2116905737178, 410.87851336154534, 567.1119379078626, 277.05243548660525, 463.723316524461, 476.700533418879], "policy_predator_policy_reward": [403.24421375214223, 356.68554723081377, 140.54032617445282, 130.55083330993443, 376.54239842237723, 430.48912307694206, 187.667209548796, 189.5041154434556, 48.00290703859113, 47.892972880000954, 224.52095017361853, 192.4582191979029, 76.13079504423091, 70.90664891522441, 430.8903247015406, 397.5034870466895, 373.47137724951773, 392.97424007494635, 241.1174578115144, 222.4275069574033, 423.8803085201489, 470.58881055025154, 369.5654142039082, 381.3337564266643, 413.91198815374173, 529.2401366720821, 380.3569200381304, 445.7945800076922, 263.65300673543464, 247.90019384014047, 579.5885815095631, 410.53160796041516, 446.659193206168, 501.0181196218492, 323.26986005028874, 387.69120145449534, 359.81319276191545, 381.50431376700374, 205.2518820224675, 199.96518301835636, 339.8409949933158, 426.35218661099617, 302.3017452775378, 228.4259879587195, 518.0713146343039, 516.9295981763947, 374.53838269948574, 340.4987930122154, 563.9197620258396, 538.772322957204, 407.04673498324274, 442.8100356334385, 281.39580066014173, 374.0592069812461, 482.3906169275283, 460.4893104790373, 314.5030987530401, 308.9928265864775, 236.85283872189984, 314.4497374668638, 305.11240780997514, 381.2182116201812, 567.6120016119319, 505.13606075465395, 374.88247785322557, 310.8137560340765, 452.78176980260537, 449.8467208187971, 483.8223015444767, 414.76701629303903, 476.5194477107884, 533.672314176141, 373.20512175577744, 363.44959002310645, 437.0615677175779, 552.5749222601515, 327.35863391071604, 322.0880359869514, 557.7876077953542, 601.732405926528, 220.97846565087303, 210.01203498037398, 358.8616436509365, 356.1542364929409, 419.17596052564534, 479.0430107659321, 427.4808433525255, 411.1282804155667, 120.70418913952864, 112.87412367106005, 503.76670374226205, 484.8714821163315, 389.9891699828613, 333.37297617902783, 475.77266426561715, 504.21612904116455, 454.97539099988495, 416.6435382876397, 402.53985541652315, 440.3216595320567, 435.98963353893913, 423.11024241011114, 252.04666826873185, 243.23391002722911, 153.25248320801435, 246.80222949768842, 455.2373059189873, 443.55790855342474, 509.9723439055514, 419.43900803121596, 529.6116812029393, 573.1046971192942, 508.07097387090204, 514.8117838480205, 288.7924990212493, 307.02419237442166, 251.28224027529737, 249.82735754608922, 128.12196662997542, 265.2047175823722, 372.81504307911183, 315.9675390659305, 448.1629307137848, 422.31634325711013, 399.6212583370976, 446.543048244802, 504.0069383408063, 536.2357069873074, 477.1912609401469, 460.46438776354444, 215.15084497075947, 237.9600713936764, 352.2560322821042, 369.2439340573468, 436.6141443607383, 417.49545559686266, 567.3716326862711, 546.0393507752848, 525.3625217555066, 501.439897581385, 323.2021534658457, 321.79155857557623, 428.33271881084175, 452.42774079557154, 349.3831563595891, 367.4439715358536, 550.0229659097333, 466.94382790679373, 416.98692454345695, 313.79985975754903, 391.9525047188652, 428.7006130521906, 376.9540305972453, 323.7400280312342, 297.641357639017, 297.8072721908818, 448.7751620609156, 416.8003888845886, 561.3510880677783, 464.53054956915275, 388.59361210413556, 301.1972122544773, 375.9135443489556, 331.15108892183116, 341.4654375412932, 269.508148263187, 393.04907449607987, 428.1032941892894, 383.4902484742021, 329.3623369192533, 258.8175599573, 195.49022672147592, 122.47219875645533, 138.06856257888694, 517.5859419746383, 500.37404537469666, 200.13029865001033, 187.25712727272156, 227.53191276238798, 293.28658128234747, 511.1331620832022, 479.57280248006737, 234.76376901197364, 195.2058971797034, 303.97367298372967, 322.46800913922345, 184.3830343654965, 167.9786096995154, 209.27997434449009, 214.4784081721643, 312.1384862272598, 382.57161499016297, 311.75879784476734, 300.1814406070242, 185.2786317494198, 207.37074234038752, 668.1281756966172, 668.8160453468885, 467.3608545608622, 474.47074256570517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1403246420756727, "mean_inference_ms": 6.189877443267402, "mean_action_processing_ms": 0.9071234751929385, "mean_env_wait_ms": 0.7847456375376717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026349663734436035, "StateBufferConnector_ms": 0.01968204975128174, "ViewRequirementAgentConnector_ms": 0.9677469730377197}, "num_episodes": 18, "episode_return_max": 2181.108594437973, "episode_return_min": 742.4731570466823, "episode_return_mean": 1763.711967968734, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.747695824058735, "num_env_steps_trained_throughput_per_sec": 4.747695824058735, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 110855.093, "restore_workers_time_ms": 0.022, "training_step_time_ms": 110855.031, "sample_time_ms": 6167.485, "learn_time_ms": 104652.551, "learn_throughput": 38.222, "synch_weights_time_ms": 32.89}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "8abce_00000", "date": "2024-08-16_12-20-09", "timestamp": 1723791009, "time_this_iter_s": 842.547278881073, "time_total_s": 3517.3615930080414, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a28af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3517.3615930080414, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 42.748000000000005, "ram_util_percent": 74.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.548977172816241, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.476398126915019, "policy_loss": -0.0025638785827954216, "vf_loss": 9.477262598370748, "vf_explained_var": -0.021255465727003795, "kl": 0.011329610706004214, "entropy": 0.9428901428898806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5752368565274293, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.361806374504452, "policy_loss": 0.0026682251474263257, "vf_loss": 9.359123108878968, "vf_explained_var": -0.03403177857398987, "kl": 0.009626276037857285, "entropy": 0.677057994831176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 2181.108594437973, "episode_reward_min": 805.0315649568125, "episode_reward_mean": 1735.4889547266337, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 154.97897385317498, "predator_policy": 32.25632121727412}, "policy_reward_max": {"prey_policy": 890.2219250120827, "predator_policy": 668.8160453468885}, "policy_reward_mean": {"prey_policy": 513.4034383688154, "predator_policy": 354.3410389945017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1864.0960353126313, 2109.262189644586, 1813.7041716131293, 1697.1007384607788, 1885.0941307801002, 1675.6915591507666, 1772.092883251643, 1844.1894962347812, 2072.1097871481625, 1471.1986600972452, 1861.52312589314, 1948.8199304822472, 2007.2961334249737, 1777.6311683236263, 2029.2919527606052, 1767.0887509501465, 1914.3709499191978, 1592.053378629522, 1880.875585731859, 1952.0505555132258, 1923.2437430137452, 949.1155512288084, 2121.1204865738, 2055.437939716226, 2041.3009365300832, 1645.1121047009603, 1769.3493168076166, 1778.8974429874102, 1910.7232286618078, 1207.105266317709, 1877.849962815186, 1883.2944649327997, 2073.3010944019725, 1902.0757311452462, 1766.4672499374194, 1672.6922894630384, 1659.5620442108714, 1646.6524151457854, 1864.6689125978276, 1963.253720820186, 1914.6864091369512, 1982.4084219489207, 1606.4741612125367, 1566.63052986944, 1963.9461782532321, 2114.8149246646553, 1984.5361844500349, 1597.5275966414597, 2005.1806352150552, 2070.8851755572373, 1932.1414887556864, 1799.7820996541163, 1753.3841228382748, 1961.9898004425847, 1775.7005939175958, 1906.4173870446662, 1958.8185547940743, 1608.2179458713565, 1787.9531152083705, 1475.782609370971, 1799.2355282784547, 1787.4904148916276, 1610.4778831325393, 995.9600794716652, 2098.83667888107, 1581.3736379152704, 1688.549034914523, 2052.8483668472563, 1347.2722741291534, 1731.7530343554367, 1262.8538706242418, 951.2720176613132, 2012.5397294491079, 1984.4565653676107, 1376.7395780250652, 2181.108594437973, 1882.2554470699038, 2177.973652361182, 1500.1154030689079, 1944.237374761169, 2015.4000854418512, 1004.1341998625489, 1687.0318034110119, 1563.9945281502369, 1850.2402976726084, 1723.011332562704, 1609.1918826894564, 1191.8433392342736, 1327.1100731253212, 1996.7504037926103, 1788.3647217733667, 924.0168089145, 1815.1934863509039, 1701.1718986560852, 1027.9720756779864, 805.0315649568125, 1321.3224396072424, 1344.3487026892954, 1689.7332609024731, 1781.6403813705456], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [465.6625421037957, 683.3963174971336, 677.8214400252909, 328.74866463624863, 580.3793611294869, 383.46803986696233, 481.1260351352257, 560.5196956841683, 492.1349948384242, 450.07920853510916, 465.84567428867337, 586.3499595225757, 558.5519493285914, 662.2383577342883, 628.3279441275494, 529.5309326770744, 432.4759096288752, 566.8858151526987, 360.20235667451783, 425.3000695354254, 591.0369412805071, 367.85769399122745, 447.6625381119851, 602.5680745327462, 377.56870034820423, 619.5356711898409, 540.9250791500151, 500.0513773947286, 522.3602924046787, 517.2951703781964, 540.2690354477958, 577.3730456046819, 314.15108980754, 440.69984638977553, 464.79724603443924, 696.2656319638352, 555.5490679996351, 610.3106375883461, 604.304126580035, 449.5274576416128, 516.5482824310689, 568.0863368145887, 245.62135735509864, 469.9158810631224, 536.3167252861741, 596.1655754290314, 601.6476738641221, 730.4281196902195, 503.12778668553693, 558.1843565377645, 306.13385917287127, 467.3593162405671, 482.5533764397418, 443.93442541929477, 456.2069437127307, 463.5906233256284, 648.0467376807703, 767.3959126850764, 359.91578580763087, 447.13476780437446, 525.6636121366525, 453.39113620612324, 458.6270806250601, 495.25603237097147, 527.1832751101318, 443.4014409696107, 426.89960830445216, 452.29336512187285, 648.0681185557839, 522.5824399859616, 399.9470271120601, 771.6356645295928, 749.5478424162175, 516.6875175823054, 506.2232524830618, 451.64658051767964, 548.4548618258998, 445.73477680103395, 612.0128052887374, 505.07660894955353, 475.08157359501223, 399.36219021382493, 532.1111367197891, 512.6416365254416, 531.491827442567, 621.8714174055337, 390.33571626716844, 454.79484726281805, 577.6998902403925, 532.1366880552407, 428.7390482136577, 572.6648929894396, 526.8206402888076, 430.9131248243343, 434.41908160633767, 518.114802993701, 585.0850591809493, 539.3351164276911, 778.623555041807, 575.4344926199886, 417.6158956801351, 497.5587992590241, 593.1354846024843, 475.8598307506243, 540.1125025872442, 392.61850247997177, 436.3284133390208, 824.9673284750883, 585.3125224202981, 594.939441667401, 515.6994173594148, 525.1424187397478, 459.52326876515457, 473.4136483919867, 349.46271577848455, 568.9644057342529, 542.4521025935862, 538.4363793439998, 316.98401584166913, 547.8250077248256, 516.4229136760684, 461.66024591701665, 512.831849879891, 561.8059796182795, 685.9618634188937, 470.2082330348704, 154.97897385317498, 580.440344283149, 536.673637778707, 544.2030537530294, 374.47226926287294, 819.5139427296689, 602.8085805705399, 564.9219602992498, 439.722914101122, 622.4194881828627, 358.67106228606775, 558.6315456514087, 582.7759258039378, 522.5354264285477, 469.0619150547418, 441.4303115044874, 274.30167626855024, 253.21195887610796, 682.2005703186442, 635.6290579130398, 786.1898535430747, 586.3264733727412, 573.2116905737178, 410.87851336154534, 567.1119379078626, 277.05243548660525, 463.723316524461, 476.700533418879, 426.5242743181411, 805.4639986372883, 707.9834732508538, 511.5298424107443, 631.2775954632076, 653.7921247198132, 596.9660975679282, 603.6908344297652, 547.8178383106226, 310.7542625042091, 643.8708669895954, 568.4493810419373, 359.24514029403747, 601.3088297399966, 465.7537276596347, 478.70561309127896, 572.6222173642036, 312.4178813772863, 530.8405236275955, 604.4636904458869, 189.46925253936715, 890.2219250120827, 415.9657179355518, 467.2362382551136, 450.50248102380493, 682.9800713756231, 388.1335917712767, 672.7101167744918, 275.39813662868147, 406.5973677899146, 695.6889182803953, 617.8238583001845, 498.95277676973257, 327.867472492029, 401.4654793475786, 443.48862004096503, 218.42312073889877, 494.61553905732563, 357.6889621029804, 513.6469826722998, 221.81727307513873, 692.1083718495765, 574.8092585978849, 442.1579901214436, 507.5011158635318, 629.4186457003347], "policy_predator_policy_reward": [374.53838269948574, 340.4987930122154, 563.9197620258396, 538.772322957204, 407.04673498324274, 442.8100356334385, 281.39580066014173, 374.0592069812461, 482.3906169275283, 460.4893104790373, 314.5030987530401, 308.9928265864775, 236.85283872189984, 314.4497374668638, 305.11240780997514, 381.2182116201812, 567.6120016119319, 505.13606075465395, 374.88247785322557, 310.8137560340765, 452.78176980260537, 449.8467208187971, 483.8223015444767, 414.76701629303903, 476.5194477107884, 533.672314176141, 373.20512175577744, 363.44959002310645, 437.0615677175779, 552.5749222601515, 327.35863391071604, 322.0880359869514, 557.7876077953542, 601.732405926528, 220.97846565087303, 210.01203498037398, 358.8616436509365, 356.1542364929409, 419.17596052564534, 479.0430107659321, 427.4808433525255, 411.1282804155667, 120.70418913952864, 112.87412367106005, 503.76670374226205, 484.8714821163315, 389.9891699828613, 333.37297617902783, 475.77266426561715, 504.21612904116455, 454.97539099988495, 416.6435382876397, 402.53985541652315, 440.3216595320567, 435.98963353893913, 423.11024241011114, 252.04666826873185, 243.23391002722911, 153.25248320801435, 246.80222949768842, 455.2373059189873, 443.55790855342474, 509.9723439055514, 419.43900803121596, 529.6116812029393, 573.1046971192942, 508.07097387090204, 514.8117838480205, 288.7924990212493, 307.02419237442166, 251.28224027529737, 249.82735754608922, 128.12196662997542, 265.2047175823722, 372.81504307911183, 315.9675390659305, 448.1629307137848, 422.31634325711013, 399.6212583370976, 446.543048244802, 504.0069383408063, 536.2357069873074, 477.1912609401469, 460.46438776354444, 215.15084497075947, 237.9600713936764, 352.2560322821042, 369.2439340573468, 436.6141443607383, 417.49545559686266, 567.3716326862711, 546.0393507752848, 525.3625217555066, 501.439897581385, 323.2021534658457, 321.79155857557623, 428.33271881084175, 452.42774079557154, 349.3831563595891, 367.4439715358536, 550.0229659097333, 466.94382790679373, 416.98692454345695, 313.79985975754903, 391.9525047188652, 428.7006130521906, 376.9540305972453, 323.7400280312342, 297.641357639017, 297.8072721908818, 448.7751620609156, 416.8003888845886, 561.3510880677783, 464.53054956915275, 388.59361210413556, 301.1972122544773, 375.9135443489556, 331.15108892183116, 341.4654375412932, 269.508148263187, 393.04907449607987, 428.1032941892894, 383.4902484742021, 329.3623369192533, 258.8175599573, 195.49022672147592, 122.47219875645533, 138.06856257888694, 517.5859419746383, 500.37404537469666, 200.13029865001033, 187.25712727272156, 227.53191276238798, 293.28658128234747, 511.1331620832022, 479.57280248006737, 234.76376901197364, 195.2058971797034, 303.97367298372967, 322.46800913922345, 184.3830343654965, 167.9786096995154, 209.27997434449009, 214.4784081721643, 312.1384862272598, 382.57161499016297, 311.75879784476734, 300.1814406070242, 185.2786317494198, 207.37074234038752, 668.1281756966172, 668.8160453468885, 467.3608545608622, 474.47074256570517, 524.2415420267789, 421.7438373789686, 112.26008935385617, 168.3419980534519, 311.1700947316877, 347.99755984645935, 412.92072188036127, 401.8224315637976, 92.7655283201419, 52.79657072757562, 200.68051077033178, 274.0310446091473, 308.15773596158203, 295.28282215462275, 430.8583773696298, 474.9225795520653, 421.49011070995664, 416.4811231112569, 237.61993345868277, 236.2677351572927, 79.89584046555115, 32.25632121727412, 224.93088061739388, 218.97723631726458, 420.1703748944611, 443.09747649872014, 340.88254324718866, 386.6384699804065, 129.40295720252334, 112.61834729338175, 256.31055654717125, 245.370153223156, 412.00863821870814, 462.3430111756174, 111.22539736744257, 71.79257892199942, 43.86873338238062, 48.12417177820766, 252.82666782725164, 197.15982700471173, 237.32821867510862, 193.0948390894691, 289.127514103713, 383.6384980794323, 283.37078650356364, 361.34983330311564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1496304026274733, "mean_inference_ms": 6.22010948802677, "mean_action_processing_ms": 0.9108288406028942, "mean_env_wait_ms": 0.788194796803127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018372058868408203, "StateBufferConnector_ms": 0.018944621086120605, "ViewRequirementAgentConnector_ms": 0.8871893882751465}, "num_episodes": 23, "episode_return_max": 2181.108594437973, "episode_return_min": 805.0315649568125, "episode_return_mean": 1735.4889547266337, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.3202039092616, "num_env_steps_trained_throughput_per_sec": 287.3202039092616, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 109172.446, "restore_workers_time_ms": 0.021, "training_step_time_ms": 109172.386, "sample_time_ms": 5828.39, "learn_time_ms": 103304.547, "learn_throughput": 38.72, "synch_weights_time_ms": 37.551}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "8abce_00000", "date": "2024-08-16_12-20-23", "timestamp": 1723791023, "time_this_iter_s": 13.92948603630066, "time_total_s": 3531.291079044342, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a28a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3531.291079044342, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 59.58, "ram_util_percent": 78.97500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5931390003552512, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.479428731322919, "policy_loss": -0.003407861947121404, "vf_loss": 9.481439788253219, "vf_explained_var": 0.031608729671548916, "kl": 0.00931198742608585, "entropy": 0.9354983457497188, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6337836525112235, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.296820136478969, "policy_loss": -0.0030988813207913487, "vf_loss": 9.299909084057681, "vf_explained_var": 0.022892937584528848, "kl": 0.006351302585773808, "entropy": 0.6588898881717965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 2181.108594437973, "episode_reward_min": 805.0315649568125, "episode_reward_mean": 1731.8422834879852, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 154.97897385317498, "predator_policy": 32.25632121727412}, "policy_reward_max": {"prey_policy": 890.2219250120827, "predator_policy": 668.8160453468885}, "policy_reward_mean": {"prey_policy": 516.7294610694499, "predator_policy": 349.19168067454274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1880.875585731859, 1952.0505555132258, 1923.2437430137452, 949.1155512288084, 2121.1204865738, 2055.437939716226, 2041.3009365300832, 1645.1121047009603, 1769.3493168076166, 1778.8974429874102, 1910.7232286618078, 1207.105266317709, 1877.849962815186, 1883.2944649327997, 2073.3010944019725, 1902.0757311452462, 1766.4672499374194, 1672.6922894630384, 1659.5620442108714, 1646.6524151457854, 1864.6689125978276, 1963.253720820186, 1914.6864091369512, 1982.4084219489207, 1606.4741612125367, 1566.63052986944, 1963.9461782532321, 2114.8149246646553, 1984.5361844500349, 1597.5275966414597, 2005.1806352150552, 2070.8851755572373, 1932.1414887556864, 1799.7820996541163, 1753.3841228382748, 1961.9898004425847, 1775.7005939175958, 1906.4173870446662, 1958.8185547940743, 1608.2179458713565, 1787.9531152083705, 1475.782609370971, 1799.2355282784547, 1787.4904148916276, 1610.4778831325393, 995.9600794716652, 2098.83667888107, 1581.3736379152704, 1688.549034914523, 2052.8483668472563, 1347.2722741291534, 1731.7530343554367, 1262.8538706242418, 951.2720176613132, 2012.5397294491079, 1984.4565653676107, 1376.7395780250652, 2181.108594437973, 1882.2554470699038, 2177.973652361182, 1500.1154030689079, 1944.237374761169, 2015.4000854418512, 1004.1341998625489, 1687.0318034110119, 1563.9945281502369, 1850.2402976726084, 1723.011332562704, 1609.1918826894564, 1191.8433392342736, 1327.1100731253212, 1996.7504037926103, 1788.3647217733667, 924.0168089145, 1815.1934863509039, 1701.1718986560852, 1027.9720756779864, 805.0315649568125, 1321.3224396072424, 1344.3487026892954, 1689.7332609024731, 1781.6403813705456, 2097.6407683589146, 1835.103098168735, 1639.9086659302966, 1938.3702261700446, 1174.3878009180683, 2128.3801158002943, 2062.154568293323, 1993.2926077939053, 1989.8946637890913, 1968.815624360488, 1971.4107373434829, 1896.6051705793495, 1549.4750101159182, 1023.9431808371497, 1880.4797787778366, 1918.17638018674, 1747.6343181629372, 1922.2752026258045], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [555.5490679996351, 610.3106375883461, 604.304126580035, 449.5274576416128, 516.5482824310689, 568.0863368145887, 245.62135735509864, 469.9158810631224, 536.3167252861741, 596.1655754290314, 601.6476738641221, 730.4281196902195, 503.12778668553693, 558.1843565377645, 306.13385917287127, 467.3593162405671, 482.5533764397418, 443.93442541929477, 456.2069437127307, 463.5906233256284, 648.0467376807703, 767.3959126850764, 359.91578580763087, 447.13476780437446, 525.6636121366525, 453.39113620612324, 458.6270806250601, 495.25603237097147, 527.1832751101318, 443.4014409696107, 426.89960830445216, 452.29336512187285, 648.0681185557839, 522.5824399859616, 399.9470271120601, 771.6356645295928, 749.5478424162175, 516.6875175823054, 506.2232524830618, 451.64658051767964, 548.4548618258998, 445.73477680103395, 612.0128052887374, 505.07660894955353, 475.08157359501223, 399.36219021382493, 532.1111367197891, 512.6416365254416, 531.491827442567, 621.8714174055337, 390.33571626716844, 454.79484726281805, 577.6998902403925, 532.1366880552407, 428.7390482136577, 572.6648929894396, 526.8206402888076, 430.9131248243343, 434.41908160633767, 518.114802993701, 585.0850591809493, 539.3351164276911, 778.623555041807, 575.4344926199886, 417.6158956801351, 497.5587992590241, 593.1354846024843, 475.8598307506243, 540.1125025872442, 392.61850247997177, 436.3284133390208, 824.9673284750883, 585.3125224202981, 594.939441667401, 515.6994173594148, 525.1424187397478, 459.52326876515457, 473.4136483919867, 349.46271577848455, 568.9644057342529, 542.4521025935862, 538.4363793439998, 316.98401584166913, 547.8250077248256, 516.4229136760684, 461.66024591701665, 512.831849879891, 561.8059796182795, 685.9618634188937, 470.2082330348704, 154.97897385317498, 580.440344283149, 536.673637778707, 544.2030537530294, 374.47226926287294, 819.5139427296689, 602.8085805705399, 564.9219602992498, 439.722914101122, 622.4194881828627, 358.67106228606775, 558.6315456514087, 582.7759258039378, 522.5354264285477, 469.0619150547418, 441.4303115044874, 274.30167626855024, 253.21195887610796, 682.2005703186442, 635.6290579130398, 786.1898535430747, 586.3264733727412, 573.2116905737178, 410.87851336154534, 567.1119379078626, 277.05243548660525, 463.723316524461, 476.700533418879, 426.5242743181411, 805.4639986372883, 707.9834732508538, 511.5298424107443, 631.2775954632076, 653.7921247198132, 596.9660975679282, 603.6908344297652, 547.8178383106226, 310.7542625042091, 643.8708669895954, 568.4493810419373, 359.24514029403747, 601.3088297399966, 465.7537276596347, 478.70561309127896, 572.6222173642036, 312.4178813772863, 530.8405236275955, 604.4636904458869, 189.46925253936715, 890.2219250120827, 415.9657179355518, 467.2362382551136, 450.50248102380493, 682.9800713756231, 388.1335917712767, 672.7101167744918, 275.39813662868147, 406.5973677899146, 695.6889182803953, 617.8238583001845, 498.95277676973257, 327.867472492029, 401.4654793475786, 443.48862004096503, 218.42312073889877, 494.61553905732563, 357.6889621029804, 513.6469826722998, 221.81727307513873, 692.1083718495765, 574.8092585978849, 442.1579901214436, 507.5011158635318, 629.4186457003347, 610.0811423218785, 461.4429509662047, 691.4798492177295, 765.9393640717911, 473.73333828030786, 476.31915683772115, 454.8387632883743, 428.63200123296247, 341.61684956282716, 406.74950034677084, 395.5442620852273, 560.7220790895348, 620.718582250532, 446.5385536927579, 564.544334578725, 507.2681461945971, 515.1821413797145, 514.2637129169715, 461.674112015113, 426.51425583404506, 483.74065867087796, 656.4224145532783, 771.4489830386561, 761.2191747543502, 603.0479904143023, 395.1670328478662, 392.1775713708177, 180.34810380362498, 692.8262449042098, 661.2288271344119, 558.4167129608531, 545.8391165694059, 640.4418063158099, 602.2705603239663, 486.1718703121535, 550.0970781408346], "policy_predator_policy_reward": [358.8616436509365, 356.1542364929409, 419.17596052564534, 479.0430107659321, 427.4808433525255, 411.1282804155667, 120.70418913952864, 112.87412367106005, 503.76670374226205, 484.8714821163315, 389.9891699828613, 333.37297617902783, 475.77266426561715, 504.21612904116455, 454.97539099988495, 416.6435382876397, 402.53985541652315, 440.3216595320567, 435.98963353893913, 423.11024241011114, 252.04666826873185, 243.23391002722911, 153.25248320801435, 246.80222949768842, 455.2373059189873, 443.55790855342474, 509.9723439055514, 419.43900803121596, 529.6116812029393, 573.1046971192942, 508.07097387090204, 514.8117838480205, 288.7924990212493, 307.02419237442166, 251.28224027529737, 249.82735754608922, 128.12196662997542, 265.2047175823722, 372.81504307911183, 315.9675390659305, 448.1629307137848, 422.31634325711013, 399.6212583370976, 446.543048244802, 504.0069383408063, 536.2357069873074, 477.1912609401469, 460.46438776354444, 215.15084497075947, 237.9600713936764, 352.2560322821042, 369.2439340573468, 436.6141443607383, 417.49545559686266, 567.3716326862711, 546.0393507752848, 525.3625217555066, 501.439897581385, 323.2021534658457, 321.79155857557623, 428.33271881084175, 452.42774079557154, 349.3831563595891, 367.4439715358536, 550.0229659097333, 466.94382790679373, 416.98692454345695, 313.79985975754903, 391.9525047188652, 428.7006130521906, 376.9540305972453, 323.7400280312342, 297.641357639017, 297.8072721908818, 448.7751620609156, 416.8003888845886, 561.3510880677783, 464.53054956915275, 388.59361210413556, 301.1972122544773, 375.9135443489556, 331.15108892183116, 341.4654375412932, 269.508148263187, 393.04907449607987, 428.1032941892894, 383.4902484742021, 329.3623369192533, 258.8175599573, 195.49022672147592, 122.47219875645533, 138.06856257888694, 517.5859419746383, 500.37404537469666, 200.13029865001033, 187.25712727272156, 227.53191276238798, 293.28658128234747, 511.1331620832022, 479.57280248006737, 234.76376901197364, 195.2058971797034, 303.97367298372967, 322.46800913922345, 184.3830343654965, 167.9786096995154, 209.27997434449009, 214.4784081721643, 312.1384862272598, 382.57161499016297, 311.75879784476734, 300.1814406070242, 185.2786317494198, 207.37074234038752, 668.1281756966172, 668.8160453468885, 467.3608545608622, 474.47074256570517, 524.2415420267789, 421.7438373789686, 112.26008935385617, 168.3419980534519, 311.1700947316877, 347.99755984645935, 412.92072188036127, 401.8224315637976, 92.7655283201419, 52.79657072757562, 200.68051077033178, 274.0310446091473, 308.15773596158203, 295.28282215462275, 430.8583773696298, 474.9225795520653, 421.49011070995664, 416.4811231112569, 237.61993345868277, 236.2677351572927, 79.89584046555115, 32.25632121727412, 224.93088061739388, 218.97723631726458, 420.1703748944611, 443.09747649872014, 340.88254324718866, 386.6384699804065, 129.40295720252334, 112.61834729338175, 256.31055654717125, 245.370153223156, 412.00863821870814, 462.3430111756174, 111.22539736744257, 71.79257892199942, 43.86873338238062, 48.12417177820766, 252.82666782725164, 197.15982700471173, 237.32821867510862, 193.0948390894691, 289.127514103713, 383.6384980794323, 283.37078650356364, 361.34983330311564, 539.2760662642628, 486.84060880656926, 169.8885576553845, 207.79532722382672, 355.8128781802428, 334.04329263202186, 549.1198924270241, 505.77956922168363, 206.6874615227851, 219.3339894856872, 539.0615387743235, 633.0522358512101, 572.1052080154114, 422.79222433462127, 486.45596255404166, 435.02416446654024, 510.5232170317141, 449.9255924606941, 564.4034506696437, 516.2238058416823, 440.63013557978053, 390.61752853954937, 222.9167339361298, 141.02027885021405, 251.58190823442857, 299.6780786193236, 210.20699168065204, 241.21051398205444, 258.71562463674746, 267.7090821024708, 410.7373695137787, 403.18318114270136, 256.9370796763425, 247.98487184682094, 439.7048109419788, 446.3014432308401]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1532602126173335, "mean_inference_ms": 6.234932532573448, "mean_action_processing_ms": 0.9124481507012745, "mean_env_wait_ms": 0.789640506721756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017073988914489746, "StateBufferConnector_ms": 0.01870870590209961, "ViewRequirementAgentConnector_ms": 0.8273835182189941}, "num_episodes": 18, "episode_return_max": 2181.108594437973, "episode_return_min": 805.0315649568125, "episode_return_mean": 1731.8422834879852, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.36191335690563, "num_env_steps_trained_throughput_per_sec": 317.36191335690563, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 107518.318, "restore_workers_time_ms": 0.021, "training_step_time_ms": 107518.258, "sample_time_ms": 5517.331, "learn_time_ms": 101961.227, "learn_throughput": 39.231, "synch_weights_time_ms": 37.792}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "8abce_00000", "date": "2024-08-16_12-20-36", "timestamp": 1723791036, "time_this_iter_s": 12.62623906135559, "time_total_s": 3543.9173181056976, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a43370d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3543.9173181056976, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 50.36666666666666, "ram_util_percent": 78.25555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9331141606840507, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.546677203405471, "policy_loss": -0.000984963462885134, "vf_loss": 9.546312715136816, "vf_explained_var": 0.00579181363973668, "kl": 0.008996449079060175, "entropy": 0.891108507233322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3071309174810137, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.264739391791126, "policy_loss": -0.002404712680628691, "vf_loss": 9.267135795714363, "vf_explained_var": 0.04981152891481995, "kl": 0.005306358448417008, "entropy": 0.6890643166486549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 2181.108594437973, "episode_reward_min": 805.0315649568125, "episode_reward_mean": 1727.3092431715843, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 154.97897385317498, "predator_policy": 32.25632121727412}, "policy_reward_max": {"prey_policy": 890.2219250120827, "predator_policy": 668.8160453468885}, "policy_reward_mean": {"prey_policy": 520.1631415833243, "predator_policy": 343.491480002468}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1914.6864091369512, 1982.4084219489207, 1606.4741612125367, 1566.63052986944, 1963.9461782532321, 2114.8149246646553, 1984.5361844500349, 1597.5275966414597, 2005.1806352150552, 2070.8851755572373, 1932.1414887556864, 1799.7820996541163, 1753.3841228382748, 1961.9898004425847, 1775.7005939175958, 1906.4173870446662, 1958.8185547940743, 1608.2179458713565, 1787.9531152083705, 1475.782609370971, 1799.2355282784547, 1787.4904148916276, 1610.4778831325393, 995.9600794716652, 2098.83667888107, 1581.3736379152704, 1688.549034914523, 2052.8483668472563, 1347.2722741291534, 1731.7530343554367, 1262.8538706242418, 951.2720176613132, 2012.5397294491079, 1984.4565653676107, 1376.7395780250652, 2181.108594437973, 1882.2554470699038, 2177.973652361182, 1500.1154030689079, 1944.237374761169, 2015.4000854418512, 1004.1341998625489, 1687.0318034110119, 1563.9945281502369, 1850.2402976726084, 1723.011332562704, 1609.1918826894564, 1191.8433392342736, 1327.1100731253212, 1996.7504037926103, 1788.3647217733667, 924.0168089145, 1815.1934863509039, 1701.1718986560852, 1027.9720756779864, 805.0315649568125, 1321.3224396072424, 1344.3487026892954, 1689.7332609024731, 1781.6403813705456, 2097.6407683589146, 1835.103098168735, 1639.9086659302966, 1938.3702261700446, 1174.3878009180683, 2128.3801158002943, 2062.154568293323, 1993.2926077939053, 1989.8946637890913, 1968.815624360488, 1971.4107373434829, 1896.6051705793495, 1549.4750101159182, 1023.9431808371497, 1880.4797787778366, 1918.17638018674, 1747.6343181629372, 1922.2752026258045, 1701.4073889785911, 2025.365376870182, 1702.0421076620937, 1929.7861943041803, 1862.8234567845686, 1790.131961139524, 1981.3573314798343, 1776.098682098997, 1363.4067407348862, 1692.2154353419023, 1835.4165832575525, 1529.6813549123958, 1531.6023274172842, 1100.3128396396544, 1897.3275048618684, 1897.372347978523, 2019.8591832756035, 2049.1928295326065, 1597.9802310021623, 2148.872106869918, 2067.5610493130953, 1591.032978158122], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [475.08157359501223, 399.36219021382493, 532.1111367197891, 512.6416365254416, 531.491827442567, 621.8714174055337, 390.33571626716844, 454.79484726281805, 577.6998902403925, 532.1366880552407, 428.7390482136577, 572.6648929894396, 526.8206402888076, 430.9131248243343, 434.41908160633767, 518.114802993701, 585.0850591809493, 539.3351164276911, 778.623555041807, 575.4344926199886, 417.6158956801351, 497.5587992590241, 593.1354846024843, 475.8598307506243, 540.1125025872442, 392.61850247997177, 436.3284133390208, 824.9673284750883, 585.3125224202981, 594.939441667401, 515.6994173594148, 525.1424187397478, 459.52326876515457, 473.4136483919867, 349.46271577848455, 568.9644057342529, 542.4521025935862, 538.4363793439998, 316.98401584166913, 547.8250077248256, 516.4229136760684, 461.66024591701665, 512.831849879891, 561.8059796182795, 685.9618634188937, 470.2082330348704, 154.97897385317498, 580.440344283149, 536.673637778707, 544.2030537530294, 374.47226926287294, 819.5139427296689, 602.8085805705399, 564.9219602992498, 439.722914101122, 622.4194881828627, 358.67106228606775, 558.6315456514087, 582.7759258039378, 522.5354264285477, 469.0619150547418, 441.4303115044874, 274.30167626855024, 253.21195887610796, 682.2005703186442, 635.6290579130398, 786.1898535430747, 586.3264733727412, 573.2116905737178, 410.87851336154534, 567.1119379078626, 277.05243548660525, 463.723316524461, 476.700533418879, 426.5242743181411, 805.4639986372883, 707.9834732508538, 511.5298424107443, 631.2775954632076, 653.7921247198132, 596.9660975679282, 603.6908344297652, 547.8178383106226, 310.7542625042091, 643.8708669895954, 568.4493810419373, 359.24514029403747, 601.3088297399966, 465.7537276596347, 478.70561309127896, 572.6222173642036, 312.4178813772863, 530.8405236275955, 604.4636904458869, 189.46925253936715, 890.2219250120827, 415.9657179355518, 467.2362382551136, 450.50248102380493, 682.9800713756231, 388.1335917712767, 672.7101167744918, 275.39813662868147, 406.5973677899146, 695.6889182803953, 617.8238583001845, 498.95277676973257, 327.867472492029, 401.4654793475786, 443.48862004096503, 218.42312073889877, 494.61553905732563, 357.6889621029804, 513.6469826722998, 221.81727307513873, 692.1083718495765, 574.8092585978849, 442.1579901214436, 507.5011158635318, 629.4186457003347, 610.0811423218785, 461.4429509662047, 691.4798492177295, 765.9393640717911, 473.73333828030786, 476.31915683772115, 454.8387632883743, 428.63200123296247, 341.61684956282716, 406.74950034677084, 395.5442620852273, 560.7220790895348, 620.718582250532, 446.5385536927579, 564.544334578725, 507.2681461945971, 515.1821413797145, 514.2637129169715, 461.674112015113, 426.51425583404506, 483.74065867087796, 656.4224145532783, 771.4489830386561, 761.2191747543502, 603.0479904143023, 395.1670328478662, 392.1775713708177, 180.34810380362498, 692.8262449042098, 661.2288271344119, 558.4167129608531, 545.8391165694059, 640.4418063158099, 602.2705603239663, 486.1718703121535, 550.0970781408346, 527.9380905902636, 415.02013211551974, 724.3209277328264, 655.1386694428344, 507.89936525241984, 657.8816711659616, 661.4445532963979, 587.5802043977815, 480.25444234173915, 493.38795206701104, 534.3587117211923, 579.0876198494041, 552.1194122521782, 485.4579096486435, 530.6666743003587, 415.4360495123056, 412.45814816100903, 643.283735922957, 417.3904647295054, 536.7721657650931, 569.3568297641773, 582.4587956783524, 616.0471444763904, 479.13141451111505, 338.1212673210968, 671.9432105655166, 367.46121501211746, 361.59196677262213, 629.9943083267244, 615.1081855539026, 499.0955999787298, 616.3182554180225, 485.8292905463623, 578.7818092421405, 598.6946283047982, 608.4031378837312, 419.4458037115135, 435.4718167188768, 682.714761279194, 443.1736829388115, 586.9144917878468, 594.8084269646705, 376.41161470058654, 559.8997251999988], "policy_predator_policy_reward": [504.0069383408063, 536.2357069873074, 477.1912609401469, 460.46438776354444, 215.15084497075947, 237.9600713936764, 352.2560322821042, 369.2439340573468, 436.6141443607383, 417.49545559686266, 567.3716326862711, 546.0393507752848, 525.3625217555066, 501.439897581385, 323.2021534658457, 321.79155857557623, 428.33271881084175, 452.42774079557154, 349.3831563595891, 367.4439715358536, 550.0229659097333, 466.94382790679373, 416.98692454345695, 313.79985975754903, 391.9525047188652, 428.7006130521906, 376.9540305972453, 323.7400280312342, 297.641357639017, 297.8072721908818, 448.7751620609156, 416.8003888845886, 561.3510880677783, 464.53054956915275, 388.59361210413556, 301.1972122544773, 375.9135443489556, 331.15108892183116, 341.4654375412932, 269.508148263187, 393.04907449607987, 428.1032941892894, 383.4902484742021, 329.3623369192533, 258.8175599573, 195.49022672147592, 122.47219875645533, 138.06856257888694, 517.5859419746383, 500.37404537469666, 200.13029865001033, 187.25712727272156, 227.53191276238798, 293.28658128234747, 511.1331620832022, 479.57280248006737, 234.76376901197364, 195.2058971797034, 303.97367298372967, 322.46800913922345, 184.3830343654965, 167.9786096995154, 209.27997434449009, 214.4784081721643, 312.1384862272598, 382.57161499016297, 311.75879784476734, 300.1814406070242, 185.2786317494198, 207.37074234038752, 668.1281756966172, 668.8160453468885, 467.3608545608622, 474.47074256570517, 524.2415420267789, 421.7438373789686, 112.26008935385617, 168.3419980534519, 311.1700947316877, 347.99755984645935, 412.92072188036127, 401.8224315637976, 92.7655283201419, 52.79657072757562, 200.68051077033178, 274.0310446091473, 308.15773596158203, 295.28282215462275, 430.8583773696298, 474.9225795520653, 421.49011070995664, 416.4811231112569, 237.61993345868277, 236.2677351572927, 79.89584046555115, 32.25632121727412, 224.93088061739388, 218.97723631726458, 420.1703748944611, 443.09747649872014, 340.88254324718866, 386.6384699804065, 129.40295720252334, 112.61834729338175, 256.31055654717125, 245.370153223156, 412.00863821870814, 462.3430111756174, 111.22539736744257, 71.79257892199942, 43.86873338238062, 48.12417177820766, 252.82666782725164, 197.15982700471173, 237.32821867510862, 193.0948390894691, 289.127514103713, 383.6384980794323, 283.37078650356364, 361.34983330311564, 539.2760662642628, 486.84060880656926, 169.8885576553845, 207.79532722382672, 355.8128781802428, 334.04329263202186, 549.1198924270241, 505.77956922168363, 206.6874615227851, 219.3339894856872, 539.0615387743235, 633.0522358512101, 572.1052080154114, 422.79222433462127, 486.45596255404166, 435.02416446654024, 510.5232170317141, 449.9255924606941, 564.4034506696437, 516.2238058416823, 440.63013557978053, 390.61752853954937, 222.9167339361298, 141.02027885021405, 251.58190823442857, 299.6780786193236, 210.20699168065204, 241.21051398205444, 258.71562463674746, 267.7090821024708, 410.7373695137787, 403.18318114270136, 256.9370796763425, 247.98487184682094, 439.7048109419788, 446.3014432308401, 398.0379405206433, 360.4112257521672, 315.6262812880686, 330.27949840645033, 307.11538186036927, 229.14568938334534, 254.69665035576753, 426.06478625423205, 423.42139910252234, 465.7596632732978, 337.0960476287524, 339.58958194017686, 438.86917781011556, 504.9108317688969, 400.4512161537525, 429.54474213257873, 152.79898391506043, 154.86587273586076, 366.87539552592295, 371.1774093213784, 337.4218322205213, 346.1791255945014, 208.7324671852035, 225.77032873968642, 198.79647456356082, 322.7413749671078, 161.37147659157552, 209.88818126333805, 341.8360390733957, 310.3889719078442, 422.7799128235581, 359.1785797582116, 495.5554534915373, 459.6926299955647, 427.01665041940726, 415.078412924671, 360.3077623399279, 382.7548482318457, 509.76824814819895, 513.2154145037136, 457.57737625653203, 428.2607543040459, 323.6160418831174, 331.1055963744197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1517237579500965, "mean_inference_ms": 6.2437593009124495, "mean_action_processing_ms": 0.9125971150671189, "mean_env_wait_ms": 0.7892611993827592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00622248649597168, "StateBufferConnector_ms": 0.01769113540649414, "ViewRequirementAgentConnector_ms": 0.7271244525909424}, "num_episodes": 22, "episode_return_max": 2181.108594437973, "episode_return_min": 805.0315649568125, "episode_return_mean": 1727.3092431715843, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.03184533046925, "num_env_steps_trained_throughput_per_sec": 329.03184533046925, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 105554.057, "restore_workers_time_ms": 0.021, "training_step_time_ms": 105553.999, "sample_time_ms": 5173.777, "learn_time_ms": 100341.297, "learn_throughput": 39.864, "synch_weights_time_ms": 37.022}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "8abce_00000", "date": "2024-08-16_12-20-48", "timestamp": 1723791048, "time_this_iter_s": 12.162674188613892, "time_total_s": 3556.0799922943115, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4ab2700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3556.0799922943115, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 42.01666666666667, "ram_util_percent": 76.0111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.452208032841405, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.580985591525124, "policy_loss": -0.0011926660664064229, "vf_loss": 9.581153520452913, "vf_explained_var": -0.00293290170412215, "kl": 0.006831867706526835, "entropy": 0.823095786508429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5404152044543515, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.321649597309253, "policy_loss": -0.0011479103196136377, "vf_loss": 9.322785259428478, "vf_explained_var": 0.003105154806974704, "kl": 0.007835964730688826, "entropy": 0.6774598134257807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 2181.108594437973, "episode_reward_min": 580.9223786041291, "episode_reward_mean": 1715.2841900058536, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 154.97897385317498, "predator_policy": 28.453174062597334}, "policy_reward_max": {"prey_policy": 890.2219250120827, "predator_policy": 668.8160453468885}, "policy_reward_mean": {"prey_policy": 522.2930568132923, "predator_policy": 335.3490381896346}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1787.9531152083705, 1475.782609370971, 1799.2355282784547, 1787.4904148916276, 1610.4778831325393, 995.9600794716652, 2098.83667888107, 1581.3736379152704, 1688.549034914523, 2052.8483668472563, 1347.2722741291534, 1731.7530343554367, 1262.8538706242418, 951.2720176613132, 2012.5397294491079, 1984.4565653676107, 1376.7395780250652, 2181.108594437973, 1882.2554470699038, 2177.973652361182, 1500.1154030689079, 1944.237374761169, 2015.4000854418512, 1004.1341998625489, 1687.0318034110119, 1563.9945281502369, 1850.2402976726084, 1723.011332562704, 1609.1918826894564, 1191.8433392342736, 1327.1100731253212, 1996.7504037926103, 1788.3647217733667, 924.0168089145, 1815.1934863509039, 1701.1718986560852, 1027.9720756779864, 805.0315649568125, 1321.3224396072424, 1344.3487026892954, 1689.7332609024731, 1781.6403813705456, 2097.6407683589146, 1835.103098168735, 1639.9086659302966, 1938.3702261700446, 1174.3878009180683, 2128.3801158002943, 2062.154568293323, 1993.2926077939053, 1989.8946637890913, 1968.815624360488, 1971.4107373434829, 1896.6051705793495, 1549.4750101159182, 1023.9431808371497, 1880.4797787778366, 1918.17638018674, 1747.6343181629372, 1922.2752026258045, 1701.4073889785911, 2025.365376870182, 1702.0421076620937, 1929.7861943041803, 1862.8234567845686, 1790.131961139524, 1981.3573314798343, 1776.098682098997, 1363.4067407348862, 1692.2154353419023, 1835.4165832575525, 1529.6813549123958, 1531.6023274172842, 1100.3128396396544, 1897.3275048618684, 1897.372347978523, 2019.8591832756035, 2049.1928295326065, 1597.9802310021623, 2148.872106869918, 2067.5610493130953, 1591.032978158122, 1777.5940816009536, 1877.1659973167436, 2075.386422065473, 1865.4107597776322, 1530.956548943478, 2138.4986524433584, 580.9223786041291, 1557.476241390523, 1458.7470500973232, 1904.1286793972026, 2108.6717247950382, 1801.6420568203885, 1948.0345805524705, 1881.8625678425058, 2071.2533312385153, 1997.1184881645052, 1946.7651028651453, 1779.4022297793865], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [542.4521025935862, 538.4363793439998, 316.98401584166913, 547.8250077248256, 516.4229136760684, 461.66024591701665, 512.831849879891, 561.8059796182795, 685.9618634188937, 470.2082330348704, 154.97897385317498, 580.440344283149, 536.673637778707, 544.2030537530294, 374.47226926287294, 819.5139427296689, 602.8085805705399, 564.9219602992498, 439.722914101122, 622.4194881828627, 358.67106228606775, 558.6315456514087, 582.7759258039378, 522.5354264285477, 469.0619150547418, 441.4303115044874, 274.30167626855024, 253.21195887610796, 682.2005703186442, 635.6290579130398, 786.1898535430747, 586.3264733727412, 573.2116905737178, 410.87851336154534, 567.1119379078626, 277.05243548660525, 463.723316524461, 476.700533418879, 426.5242743181411, 805.4639986372883, 707.9834732508538, 511.5298424107443, 631.2775954632076, 653.7921247198132, 596.9660975679282, 603.6908344297652, 547.8178383106226, 310.7542625042091, 643.8708669895954, 568.4493810419373, 359.24514029403747, 601.3088297399966, 465.7537276596347, 478.70561309127896, 572.6222173642036, 312.4178813772863, 530.8405236275955, 604.4636904458869, 189.46925253936715, 890.2219250120827, 415.9657179355518, 467.2362382551136, 450.50248102380493, 682.9800713756231, 388.1335917712767, 672.7101167744918, 275.39813662868147, 406.5973677899146, 695.6889182803953, 617.8238583001845, 498.95277676973257, 327.867472492029, 401.4654793475786, 443.48862004096503, 218.42312073889877, 494.61553905732563, 357.6889621029804, 513.6469826722998, 221.81727307513873, 692.1083718495765, 574.8092585978849, 442.1579901214436, 507.5011158635318, 629.4186457003347, 610.0811423218785, 461.4429509662047, 691.4798492177295, 765.9393640717911, 473.73333828030786, 476.31915683772115, 454.8387632883743, 428.63200123296247, 341.61684956282716, 406.74950034677084, 395.5442620852273, 560.7220790895348, 620.718582250532, 446.5385536927579, 564.544334578725, 507.2681461945971, 515.1821413797145, 514.2637129169715, 461.674112015113, 426.51425583404506, 483.74065867087796, 656.4224145532783, 771.4489830386561, 761.2191747543502, 603.0479904143023, 395.1670328478662, 392.1775713708177, 180.34810380362498, 692.8262449042098, 661.2288271344119, 558.4167129608531, 545.8391165694059, 640.4418063158099, 602.2705603239663, 486.1718703121535, 550.0970781408346, 527.9380905902636, 415.02013211551974, 724.3209277328264, 655.1386694428344, 507.89936525241984, 657.8816711659616, 661.4445532963979, 587.5802043977815, 480.25444234173915, 493.38795206701104, 534.3587117211923, 579.0876198494041, 552.1194122521782, 485.4579096486435, 530.6666743003587, 415.4360495123056, 412.45814816100903, 643.283735922957, 417.3904647295054, 536.7721657650931, 569.3568297641773, 582.4587956783524, 616.0471444763904, 479.13141451111505, 338.1212673210968, 671.9432105655166, 367.46121501211746, 361.59196677262213, 629.9943083267244, 615.1081855539026, 499.0955999787298, 616.3182554180225, 485.8292905463623, 578.7818092421405, 598.6946283047982, 608.4031378837312, 419.4458037115135, 435.4718167188768, 682.714761279194, 443.1736829388115, 586.9144917878468, 594.8084269646705, 376.41161470058654, 559.8997251999988, 415.33271612344106, 556.811143855824, 406.80019149999555, 500.0213018876224, 679.2833555681923, 556.7664138586655, 601.7524247432816, 625.0838856331817, 320.4301595500295, 659.7384947774652, 691.1168254287214, 567.2210779669717, 189.11, 333.9773971993648, 343.096143583154, 573.3844936158914, 295.7109254412459, 553.1660227976299, 494.20054030271285, 485.7296050159243, 593.9683202184857, 550.0717574154304, 679.6626719811322, 527.1717713994583, 589.9845709453865, 565.4290250127602, 417.4692042144024, 468.8137456018987, 517.517685824628, 621.2015973199448, 639.8799703245138, 543.926953487902, 683.6066332543296, 525.9719166381007, 725.3559890836307, 595.5494483671072], "policy_predator_policy_reward": [375.9135443489556, 331.15108892183116, 341.4654375412932, 269.508148263187, 393.04907449607987, 428.1032941892894, 383.4902484742021, 329.3623369192533, 258.8175599573, 195.49022672147592, 122.47219875645533, 138.06856257888694, 517.5859419746383, 500.37404537469666, 200.13029865001033, 187.25712727272156, 227.53191276238798, 293.28658128234747, 511.1331620832022, 479.57280248006737, 234.76376901197364, 195.2058971797034, 303.97367298372967, 322.46800913922345, 184.3830343654965, 167.9786096995154, 209.27997434449009, 214.4784081721643, 312.1384862272598, 382.57161499016297, 311.75879784476734, 300.1814406070242, 185.2786317494198, 207.37074234038752, 668.1281756966172, 668.8160453468885, 467.3608545608622, 474.47074256570517, 524.2415420267789, 421.7438373789686, 112.26008935385617, 168.3419980534519, 311.1700947316877, 347.99755984645935, 412.92072188036127, 401.8224315637976, 92.7655283201419, 52.79657072757562, 200.68051077033178, 274.0310446091473, 308.15773596158203, 295.28282215462275, 430.8583773696298, 474.9225795520653, 421.49011070995664, 416.4811231112569, 237.61993345868277, 236.2677351572927, 79.89584046555115, 32.25632121727412, 224.93088061739388, 218.97723631726458, 420.1703748944611, 443.09747649872014, 340.88254324718866, 386.6384699804065, 129.40295720252334, 112.61834729338175, 256.31055654717125, 245.370153223156, 412.00863821870814, 462.3430111756174, 111.22539736744257, 71.79257892199942, 43.86873338238062, 48.12417177820766, 252.82666782725164, 197.15982700471173, 237.32821867510862, 193.0948390894691, 289.127514103713, 383.6384980794323, 283.37078650356364, 361.34983330311564, 539.2760662642628, 486.84060880656926, 169.8885576553845, 207.79532722382672, 355.8128781802428, 334.04329263202186, 549.1198924270241, 505.77956922168363, 206.6874615227851, 219.3339894856872, 539.0615387743235, 633.0522358512101, 572.1052080154114, 422.79222433462127, 486.45596255404166, 435.02416446654024, 510.5232170317141, 449.9255924606941, 564.4034506696437, 516.2238058416823, 440.63013557978053, 390.61752853954937, 222.9167339361298, 141.02027885021405, 251.58190823442857, 299.6780786193236, 210.20699168065204, 241.21051398205444, 258.71562463674746, 267.7090821024708, 410.7373695137787, 403.18318114270136, 256.9370796763425, 247.98487184682094, 439.7048109419788, 446.3014432308401, 398.0379405206433, 360.4112257521672, 315.6262812880686, 330.27949840645033, 307.11538186036927, 229.14568938334534, 254.69665035576753, 426.06478625423205, 423.42139910252234, 465.7596632732978, 337.0960476287524, 339.58958194017686, 438.86917781011556, 504.9108317688969, 400.4512161537525, 429.54474213257873, 152.79898391506043, 154.86587273586076, 366.87539552592295, 371.1774093213784, 337.4218322205213, 346.1791255945014, 208.7324671852035, 225.77032873968642, 198.79647456356082, 322.7413749671078, 161.37147659157552, 209.88818126333805, 341.8360390733957, 310.3889719078442, 422.7799128235581, 359.1785797582116, 495.5554534915373, 459.6926299955647, 427.01665041940726, 415.078412924671, 360.3077623399279, 382.7548482318457, 509.76824814819895, 513.2154145037136, 457.57737625653203, 428.2607543040459, 323.6160418831174, 331.1055963744197, 432.04392788729297, 373.40629373439975, 497.4506281281021, 472.8938758010241, 457.8343716461065, 381.5022809925098, 393.594375478171, 244.98007392299868, 236.74569950770072, 314.04219510828085, 434.58534514738903, 445.57540390027674, 29.3818073421671, 28.453174062597334, 279.94347446582816, 361.0521297256498, 298.5218891504102, 311.34821270803656, 492.22625786935436, 431.97227620920853, 481.3541843015043, 483.2774628596225, 263.2225265023858, 331.5850869374128, 313.1591610143626, 479.4618235799599, 510.7143458910694, 484.86527213513034, 472.44075745899767, 460.09329063494187, 364.28441347714045, 449.0271508749525, 360.7753070979098, 376.41124587481056, 282.4598857050457, 176.03690662359622]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1482737389548987, "mean_inference_ms": 6.2286044994135565, "mean_action_processing_ms": 0.9108183631236202, "mean_env_wait_ms": 0.7875875270386089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052144527435302734, "StateBufferConnector_ms": 0.016047358512878418, "ViewRequirementAgentConnector_ms": 0.3552907705307007}, "num_episodes": 18, "episode_return_max": 2181.108594437973, "episode_return_min": 580.9223786041291, "episode_return_mean": 1715.2841900058536, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.0271084688006, "num_env_steps_trained_throughput_per_sec": 315.0271084688006, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 103908.567, "restore_workers_time_ms": 0.02, "training_step_time_ms": 103908.51, "sample_time_ms": 4862.166, "learn_time_ms": 99008.325, "learn_throughput": 40.401, "synch_weights_time_ms": 36.102}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "8abce_00000", "date": "2024-08-16_12-21-00", "timestamp": 1723791060, "time_this_iter_s": 12.703656911849976, "time_total_s": 3568.7836492061615, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a55550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3568.7836492061615, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 41.52222222222222, "ram_util_percent": 76.01666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.037458958102282, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.522697173729144, "policy_loss": 9.413578476086653e-05, "vf_loss": 9.521406381092374, "vf_explained_var": 0.007367798260280064, "kl": 0.007977739345002136, "entropy": 0.8234439971270384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.017326349713815, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.424860694421032, "policy_loss": -0.0021698206339139867, "vf_loss": 9.427017971825977, "vf_explained_var": 0.002424935247532274, "kl": 0.008043652715682076, "entropy": 0.6990010319878815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 2172.255679927674, "episode_reward_min": 580.9223786041291, "episode_reward_mean": 1701.3965807785762, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 87.14000000000013, "predator_policy": 25.832261073942888}, "policy_reward_max": {"prey_policy": 890.2219250120827, "predator_policy": 633.0522358512101}, "policy_reward_mean": {"prey_policy": 522.6284728534497, "predator_policy": 328.0698175358385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1004.1341998625489, 1687.0318034110119, 1563.9945281502369, 1850.2402976726084, 1723.011332562704, 1609.1918826894564, 1191.8433392342736, 1327.1100731253212, 1996.7504037926103, 1788.3647217733667, 924.0168089145, 1815.1934863509039, 1701.1718986560852, 1027.9720756779864, 805.0315649568125, 1321.3224396072424, 1344.3487026892954, 1689.7332609024731, 1781.6403813705456, 2097.6407683589146, 1835.103098168735, 1639.9086659302966, 1938.3702261700446, 1174.3878009180683, 2128.3801158002943, 2062.154568293323, 1993.2926077939053, 1989.8946637890913, 1968.815624360488, 1971.4107373434829, 1896.6051705793495, 1549.4750101159182, 1023.9431808371497, 1880.4797787778366, 1918.17638018674, 1747.6343181629372, 1922.2752026258045, 1701.4073889785911, 2025.365376870182, 1702.0421076620937, 1929.7861943041803, 1862.8234567845686, 1790.131961139524, 1981.3573314798343, 1776.098682098997, 1363.4067407348862, 1692.2154353419023, 1835.4165832575525, 1529.6813549123958, 1531.6023274172842, 1100.3128396396544, 1897.3275048618684, 1897.372347978523, 2019.8591832756035, 2049.1928295326065, 1597.9802310021623, 2148.872106869918, 2067.5610493130953, 1591.032978158122, 1777.5940816009536, 1877.1659973167436, 2075.386422065473, 1865.4107597776322, 1530.956548943478, 2138.4986524433584, 580.9223786041291, 1557.476241390523, 1458.7470500973232, 1904.1286793972026, 2108.6717247950382, 1801.6420568203885, 1948.0345805524705, 1881.8625678425058, 2071.2533312385153, 1997.1184881645052, 1946.7651028651453, 1779.4022297793865, 1636.142329418901, 785.5995419583373, 1627.746510208703, 1671.3654446358341, 1471.5302775020132, 1875.7303187653804, 1591.8026306338527, 1544.479244068517, 1974.4097890898854, 1462.138050307711, 2019.992523296379, 1898.9104127777593, 1955.7157466013925, 1422.8062339059588, 1572.922945785598, 1428.40697171056, 1704.1491335501833, 2172.255679927674, 1085.8663446413573, 1739.8030206272254, 1479.1248058421997, 1727.6906540102136, 2009.1354436712754], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [547.8178383106226, 310.7542625042091, 643.8708669895954, 568.4493810419373, 359.24514029403747, 601.3088297399966, 465.7537276596347, 478.70561309127896, 572.6222173642036, 312.4178813772863, 530.8405236275955, 604.4636904458869, 189.46925253936715, 890.2219250120827, 415.9657179355518, 467.2362382551136, 450.50248102380493, 682.9800713756231, 388.1335917712767, 672.7101167744918, 275.39813662868147, 406.5973677899146, 695.6889182803953, 617.8238583001845, 498.95277676973257, 327.867472492029, 401.4654793475786, 443.48862004096503, 218.42312073889877, 494.61553905732563, 357.6889621029804, 513.6469826722998, 221.81727307513873, 692.1083718495765, 574.8092585978849, 442.1579901214436, 507.5011158635318, 629.4186457003347, 610.0811423218785, 461.4429509662047, 691.4798492177295, 765.9393640717911, 473.73333828030786, 476.31915683772115, 454.8387632883743, 428.63200123296247, 341.61684956282716, 406.74950034677084, 395.5442620852273, 560.7220790895348, 620.718582250532, 446.5385536927579, 564.544334578725, 507.2681461945971, 515.1821413797145, 514.2637129169715, 461.674112015113, 426.51425583404506, 483.74065867087796, 656.4224145532783, 771.4489830386561, 761.2191747543502, 603.0479904143023, 395.1670328478662, 392.1775713708177, 180.34810380362498, 692.8262449042098, 661.2288271344119, 558.4167129608531, 545.8391165694059, 640.4418063158099, 602.2705603239663, 486.1718703121535, 550.0970781408346, 527.9380905902636, 415.02013211551974, 724.3209277328264, 655.1386694428344, 507.89936525241984, 657.8816711659616, 661.4445532963979, 587.5802043977815, 480.25444234173915, 493.38795206701104, 534.3587117211923, 579.0876198494041, 552.1194122521782, 485.4579096486435, 530.6666743003587, 415.4360495123056, 412.45814816100903, 643.283735922957, 417.3904647295054, 536.7721657650931, 569.3568297641773, 582.4587956783524, 616.0471444763904, 479.13141451111505, 338.1212673210968, 671.9432105655166, 367.46121501211746, 361.59196677262213, 629.9943083267244, 615.1081855539026, 499.0955999787298, 616.3182554180225, 485.8292905463623, 578.7818092421405, 598.6946283047982, 608.4031378837312, 419.4458037115135, 435.4718167188768, 682.714761279194, 443.1736829388115, 586.9144917878468, 594.8084269646705, 376.41161470058654, 559.8997251999988, 415.33271612344106, 556.811143855824, 406.80019149999555, 500.0213018876224, 679.2833555681923, 556.7664138586655, 601.7524247432816, 625.0838856331817, 320.4301595500295, 659.7384947774652, 691.1168254287214, 567.2210779669717, 189.11, 333.9773971993648, 343.096143583154, 573.3844936158914, 295.7109254412459, 553.1660227976299, 494.20054030271285, 485.7296050159243, 593.9683202184857, 550.0717574154304, 679.6626719811322, 527.1717713994583, 589.9845709453865, 565.4290250127602, 417.4692042144024, 468.8137456018987, 517.517685824628, 621.2015973199448, 639.8799703245138, 543.926953487902, 683.6066332543296, 525.9719166381007, 725.3559890836307, 595.5494483671072, 527.1842745945228, 649.1822284957638, 399.77301667920443, 322.8473476171911, 410.7256147220726, 397.1481425994575, 548.7599993082458, 547.7706110075172, 741.8395246819883, 445.22435226622275, 498.6076060319986, 560.4476268988599, 448.01792880162833, 414.0550768503805, 596.4014231222058, 610.8315301417537, 754.6858713343007, 757.4797146792433, 87.14000000000013, 486.1209617110909, 514.8390163699235, 600.7800371849867, 566.0325603964011, 492.68582449709425, 610.7843216266809, 665.4237061115499, 694.7888517804149, 380.3909221466805, 312.4147581893229, 796.0363676164748, 480.5728221386953, 660.7638444414556, 620.8669856483626, 581.8024623189708, 535.5885592590165, 571.6326020854524, 465.46987733137735, 447.3451787345064, 615.8228124904472, 511.5600134015412, 506.1810251736369, 419.59537363685666, 365.6575721572062, 496.4860791926236, 652.1081144098385, 548.826869103936], "policy_predator_policy_reward": [92.7655283201419, 52.79657072757562, 200.68051077033178, 274.0310446091473, 308.15773596158203, 295.28282215462275, 430.8583773696298, 474.9225795520653, 421.49011070995664, 416.4811231112569, 237.61993345868277, 236.2677351572927, 79.89584046555115, 32.25632121727412, 224.93088061739388, 218.97723631726458, 420.1703748944611, 443.09747649872014, 340.88254324718866, 386.6384699804065, 129.40295720252334, 112.61834729338175, 256.31055654717125, 245.370153223156, 412.00863821870814, 462.3430111756174, 111.22539736744257, 71.79257892199942, 43.86873338238062, 48.12417177820766, 252.82666782725164, 197.15982700471173, 237.32821867510862, 193.0948390894691, 289.127514103713, 383.6384980794323, 283.37078650356364, 361.34983330311564, 539.2760662642628, 486.84060880656926, 169.8885576553845, 207.79532722382672, 355.8128781802428, 334.04329263202186, 549.1198924270241, 505.77956922168363, 206.6874615227851, 219.3339894856872, 539.0615387743235, 633.0522358512101, 572.1052080154114, 422.79222433462127, 486.45596255404166, 435.02416446654024, 510.5232170317141, 449.9255924606941, 564.4034506696437, 516.2238058416823, 440.63013557978053, 390.61752853954937, 222.9167339361298, 141.02027885021405, 251.58190823442857, 299.6780786193236, 210.20699168065204, 241.21051398205444, 258.71562463674746, 267.7090821024708, 410.7373695137787, 403.18318114270136, 256.9370796763425, 247.98487184682094, 439.7048109419788, 446.3014432308401, 398.0379405206433, 360.4112257521672, 315.6262812880686, 330.27949840645033, 307.11538186036927, 229.14568938334534, 254.69665035576753, 426.06478625423205, 423.42139910252234, 465.7596632732978, 337.0960476287524, 339.58958194017686, 438.86917781011556, 504.9108317688969, 400.4512161537525, 429.54474213257873, 152.79898391506043, 154.86587273586076, 366.87539552592295, 371.1774093213784, 337.4218322205213, 346.1791255945014, 208.7324671852035, 225.77032873968642, 198.79647456356082, 322.7413749671078, 161.37147659157552, 209.88818126333805, 341.8360390733957, 310.3889719078442, 422.7799128235581, 359.1785797582116, 495.5554534915373, 459.6926299955647, 427.01665041940726, 415.078412924671, 360.3077623399279, 382.7548482318457, 509.76824814819895, 513.2154145037136, 457.57737625653203, 428.2607543040459, 323.6160418831174, 331.1055963744197, 432.04392788729297, 373.40629373439975, 497.4506281281021, 472.8938758010241, 457.8343716461065, 381.5022809925098, 393.594375478171, 244.98007392299868, 236.74569950770072, 314.04219510828085, 434.58534514738903, 445.57540390027674, 29.3818073421671, 28.453174062597334, 279.94347446582816, 361.0521297256498, 298.5218891504102, 311.34821270803656, 492.22625786935436, 431.97227620920853, 481.3541843015043, 483.2774628596225, 263.2225265023858, 331.5850869374128, 313.1591610143626, 479.4618235799599, 510.7143458910694, 484.86527213513034, 472.44075745899767, 460.09329063494187, 364.28441347714045, 449.0271508749525, 360.7753070979098, 376.41124587481056, 282.4598857050457, 176.03690662359622, 301.50505743380387, 158.27076889481253, 25.832261073942888, 37.14691658799911, 381.7555083856544, 438.1172445015176, 279.20971195987875, 295.62512236018864, 117.32456757193631, 167.14183298186862, 406.26505074234177, 410.4100350921758, 354.2854838764539, 375.4441411053935, 214.1215762727648, 123.12471453179369, 235.1057423357342, 227.1384607406081, 473.66993083101227, 415.2071577656085, 457.32533114709963, 447.0481385943713, 426.3240851894622, 413.8679426948003, 370.75135964144164, 308.75635922172097, 192.19096693716367, 155.43549304169724, 240.76110650255274, 223.7107134772474, 148.16240724788761, 138.90789788252073, 235.0404520243301, 266.4392335585234, 532.5100926290739, 532.5244259541374, 71.17148178054943, 101.87980679492414, 354.1101174111486, 258.31007732408847, 274.4277991337803, 278.92060789792265, 463.4898698513484, 402.05713280903643, 405.10755860737027, 403.092901550133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1342334274321733, "mean_inference_ms": 6.189850472794149, "mean_action_processing_ms": 0.9041081675345711, "mean_env_wait_ms": 0.7817607337976845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004550337791442871, "StateBufferConnector_ms": 0.004674553871154785, "ViewRequirementAgentConnector_ms": 0.16818416118621826}, "num_episodes": 23, "episode_return_max": 2172.255679927674, "episode_return_min": 580.9223786041291, "episode_return_mean": 1701.3965807785762, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.45047456505574, "num_env_steps_trained_throughput_per_sec": 320.45047456505574, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 102290.807, "restore_workers_time_ms": 0.02, "training_step_time_ms": 102290.751, "sample_time_ms": 4542.532, "learn_time_ms": 97710.83, "learn_throughput": 40.937, "synch_weights_time_ms": 35.555}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "8abce_00000", "date": "2024-08-16_12-21-13", "timestamp": 1723791073, "time_this_iter_s": 12.49030089378357, "time_total_s": 3581.273950099945, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a435fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3581.273950099945, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 41.49411764705883, "ram_util_percent": 75.90588235294116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.054748092284278, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.378619661280718, "policy_loss": 0.000556777872480255, "vf_loss": 9.376553158533005, "vf_explained_var": 0.05450698982470881, "kl": 0.010064734455164596, "entropy": 0.8427801246996279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3654237672765417, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.529466827836616, "policy_loss": -0.0005376486775401251, "vf_loss": 9.529996903737386, "vf_explained_var": 0.018387944326198922, "kl": 0.0048300027805323505, "entropy": 0.7304007059682613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 2172.255679927674, "episode_reward_min": 469.0239158316132, "episode_reward_mean": 1733.7512337473297, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 87.14000000000013, "predator_policy": 0.9524221409068243}, "policy_reward_max": {"prey_policy": 796.0363676164748, "predator_policy": 633.0522358512101}, "policy_reward_mean": {"prey_policy": 523.8164329285905, "predator_policy": 343.0591839450745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1781.6403813705456, 2097.6407683589146, 1835.103098168735, 1639.9086659302966, 1938.3702261700446, 1174.3878009180683, 2128.3801158002943, 2062.154568293323, 1993.2926077939053, 1989.8946637890913, 1968.815624360488, 1971.4107373434829, 1896.6051705793495, 1549.4750101159182, 1023.9431808371497, 1880.4797787778366, 1918.17638018674, 1747.6343181629372, 1922.2752026258045, 1701.4073889785911, 2025.365376870182, 1702.0421076620937, 1929.7861943041803, 1862.8234567845686, 1790.131961139524, 1981.3573314798343, 1776.098682098997, 1363.4067407348862, 1692.2154353419023, 1835.4165832575525, 1529.6813549123958, 1531.6023274172842, 1100.3128396396544, 1897.3275048618684, 1897.372347978523, 2019.8591832756035, 2049.1928295326065, 1597.9802310021623, 2148.872106869918, 2067.5610493130953, 1591.032978158122, 1777.5940816009536, 1877.1659973167436, 2075.386422065473, 1865.4107597776322, 1530.956548943478, 2138.4986524433584, 580.9223786041291, 1557.476241390523, 1458.7470500973232, 1904.1286793972026, 2108.6717247950382, 1801.6420568203885, 1948.0345805524705, 1881.8625678425058, 2071.2533312385153, 1997.1184881645052, 1946.7651028651453, 1779.4022297793865, 1636.142329418901, 785.5995419583373, 1627.746510208703, 1671.3654446358341, 1471.5302775020132, 1875.7303187653804, 1591.8026306338527, 1544.479244068517, 1974.4097890898854, 1462.138050307711, 2019.992523296379, 1898.9104127777593, 1955.7157466013925, 1422.8062339059588, 1572.922945785598, 1428.40697171056, 1704.1491335501833, 2172.255679927674, 1085.8663446413573, 1739.8030206272254, 1479.1248058421997, 1727.6906540102136, 2009.1354436712754, 469.0239158316132, 1327.6766945396087, 1805.4166238252824, 1668.8422110255106, 1941.7887954546652, 2001.4217983974024, 939.2369500429792, 1600.5181501629509, 2079.862569638259, 1940.0658601550417, 1816.2267151121914, 2147.5139262828343, 1824.5099978804133, 1934.8942838817686, 1661.579933972282, 576.9968155119207, 1880.9289273120546, 1989.4239478780414], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [507.5011158635318, 629.4186457003347, 610.0811423218785, 461.4429509662047, 691.4798492177295, 765.9393640717911, 473.73333828030786, 476.31915683772115, 454.8387632883743, 428.63200123296247, 341.61684956282716, 406.74950034677084, 395.5442620852273, 560.7220790895348, 620.718582250532, 446.5385536927579, 564.544334578725, 507.2681461945971, 515.1821413797145, 514.2637129169715, 461.674112015113, 426.51425583404506, 483.74065867087796, 656.4224145532783, 771.4489830386561, 761.2191747543502, 603.0479904143023, 395.1670328478662, 392.1775713708177, 180.34810380362498, 692.8262449042098, 661.2288271344119, 558.4167129608531, 545.8391165694059, 640.4418063158099, 602.2705603239663, 486.1718703121535, 550.0970781408346, 527.9380905902636, 415.02013211551974, 724.3209277328264, 655.1386694428344, 507.89936525241984, 657.8816711659616, 661.4445532963979, 587.5802043977815, 480.25444234173915, 493.38795206701104, 534.3587117211923, 579.0876198494041, 552.1194122521782, 485.4579096486435, 530.6666743003587, 415.4360495123056, 412.45814816100903, 643.283735922957, 417.3904647295054, 536.7721657650931, 569.3568297641773, 582.4587956783524, 616.0471444763904, 479.13141451111505, 338.1212673210968, 671.9432105655166, 367.46121501211746, 361.59196677262213, 629.9943083267244, 615.1081855539026, 499.0955999787298, 616.3182554180225, 485.8292905463623, 578.7818092421405, 598.6946283047982, 608.4031378837312, 419.4458037115135, 435.4718167188768, 682.714761279194, 443.1736829388115, 586.9144917878468, 594.8084269646705, 376.41161470058654, 559.8997251999988, 415.33271612344106, 556.811143855824, 406.80019149999555, 500.0213018876224, 679.2833555681923, 556.7664138586655, 601.7524247432816, 625.0838856331817, 320.4301595500295, 659.7384947774652, 691.1168254287214, 567.2210779669717, 189.11, 333.9773971993648, 343.096143583154, 573.3844936158914, 295.7109254412459, 553.1660227976299, 494.20054030271285, 485.7296050159243, 593.9683202184857, 550.0717574154304, 679.6626719811322, 527.1717713994583, 589.9845709453865, 565.4290250127602, 417.4692042144024, 468.8137456018987, 517.517685824628, 621.2015973199448, 639.8799703245138, 543.926953487902, 683.6066332543296, 525.9719166381007, 725.3559890836307, 595.5494483671072, 527.1842745945228, 649.1822284957638, 399.77301667920443, 322.8473476171911, 410.7256147220726, 397.1481425994575, 548.7599993082458, 547.7706110075172, 741.8395246819883, 445.22435226622275, 498.6076060319986, 560.4476268988599, 448.01792880162833, 414.0550768503805, 596.4014231222058, 610.8315301417537, 754.6858713343007, 757.4797146792433, 87.14000000000013, 486.1209617110909, 514.8390163699235, 600.7800371849867, 566.0325603964011, 492.68582449709425, 610.7843216266809, 665.4237061115499, 694.7888517804149, 380.3909221466805, 312.4147581893229, 796.0363676164748, 480.5728221386953, 660.7638444414556, 620.8669856483626, 581.8024623189708, 535.5885592590165, 571.6326020854524, 465.46987733137735, 447.3451787345064, 615.8228124904472, 511.5600134015412, 506.1810251736369, 419.59537363685666, 365.6575721572062, 496.4860791926236, 652.1081144098385, 548.826869103936, 247.3048076150665, 190.1, 528.5166340995672, 535.1563242465556, 439.8075162688717, 533.199767517859, 726.3757870530337, 432.7738771734795, 675.0336761288187, 615.6488936270492, 499.9932301653515, 520.8059576526229, 269.0097620337525, 460.3589805069948, 439.60537778251455, 695.6146709558983, 422.78903238901665, 533.1232824039754, 535.5047272029906, 489.77840359624633, 449.63993491797487, 393.62362083032593, 562.9250843609645, 511.5494009305136, 474.31257094401525, 483.2669672491978, 651.4288292357654, 412.06722213067496, 497.67100170147137, 462.029030895031, 258.83552927904753, 287.0763643158299, 613.8779432636146, 615.4709022579152, 543.7668331349112, 565.5695661598777], "policy_predator_policy_reward": [283.37078650356364, 361.34983330311564, 539.2760662642628, 486.84060880656926, 169.8885576553845, 207.79532722382672, 355.8128781802428, 334.04329263202186, 549.1198924270241, 505.77956922168363, 206.6874615227851, 219.3339894856872, 539.0615387743235, 633.0522358512101, 572.1052080154114, 422.79222433462127, 486.45596255404166, 435.02416446654024, 510.5232170317141, 449.9255924606941, 564.4034506696437, 516.2238058416823, 440.63013557978053, 390.61752853954937, 222.9167339361298, 141.02027885021405, 251.58190823442857, 299.6780786193236, 210.20699168065204, 241.21051398205444, 258.71562463674746, 267.7090821024708, 410.7373695137787, 403.18318114270136, 256.9370796763425, 247.98487184682094, 439.7048109419788, 446.3014432308401, 398.0379405206433, 360.4112257521672, 315.6262812880686, 330.27949840645033, 307.11538186036927, 229.14568938334534, 254.69665035576753, 426.06478625423205, 423.42139910252234, 465.7596632732978, 337.0960476287524, 339.58958194017686, 438.86917781011556, 504.9108317688969, 400.4512161537525, 429.54474213257873, 152.79898391506043, 154.86587273586076, 366.87539552592295, 371.1774093213784, 337.4218322205213, 346.1791255945014, 208.7324671852035, 225.77032873968642, 198.79647456356082, 322.7413749671078, 161.37147659157552, 209.88818126333805, 341.8360390733957, 310.3889719078442, 422.7799128235581, 359.1785797582116, 495.5554534915373, 459.6926299955647, 427.01665041940726, 415.078412924671, 360.3077623399279, 382.7548482318457, 509.76824814819895, 513.2154145037136, 457.57737625653203, 428.2607543040459, 323.6160418831174, 331.1055963744197, 432.04392788729297, 373.40629373439975, 497.4506281281021, 472.8938758010241, 457.8343716461065, 381.5022809925098, 393.594375478171, 244.98007392299868, 236.74569950770072, 314.04219510828085, 434.58534514738903, 445.57540390027674, 29.3818073421671, 28.453174062597334, 279.94347446582816, 361.0521297256498, 298.5218891504102, 311.34821270803656, 492.22625786935436, 431.97227620920853, 481.3541843015043, 483.2774628596225, 263.2225265023858, 331.5850869374128, 313.1591610143626, 479.4618235799599, 510.7143458910694, 484.86527213513034, 472.44075745899767, 460.09329063494187, 364.28441347714045, 449.0271508749525, 360.7753070979098, 376.41124587481056, 282.4598857050457, 176.03690662359622, 301.50505743380387, 158.27076889481253, 25.832261073942888, 37.14691658799911, 381.7555083856544, 438.1172445015176, 279.20971195987875, 295.62512236018864, 117.32456757193631, 167.14183298186862, 406.26505074234177, 410.4100350921758, 354.2854838764539, 375.4441411053935, 214.1215762727648, 123.12471453179369, 235.1057423357342, 227.1384607406081, 473.66993083101227, 415.2071577656085, 457.32533114709963, 447.0481385943713, 426.3240851894622, 413.8679426948003, 370.75135964144164, 308.75635922172097, 192.19096693716367, 155.43549304169724, 240.76110650255274, 223.7107134772474, 148.16240724788761, 138.90789788252073, 235.0404520243301, 266.4392335585234, 532.5100926290739, 532.5244259541374, 71.17148178054943, 101.87980679492414, 354.1101174111486, 258.31007732408847, 274.4277991337803, 278.92060789792265, 463.4898698513484, 402.05713280903643, 405.10755860737027, 403.092901550133, 1.161710140738938, 30.45739807580776, 139.46719286143062, 124.53654333205536, 412.40541253355696, 420.003927504995, 285.72252620966276, 223.97002058933396, 358.1753666200906, 292.93085907870835, 518.5792523197543, 462.0433582596747, 94.58606058221629, 115.28214692001602, 243.62371917363694, 221.67438225090197, 552.9226310237565, 571.0276238215159, 470.31066506457825, 444.47206429122895, 476.44789583682905, 496.5152635270578, 539.3610899723958, 533.6783510189579, 448.761137046523, 418.1693226406753, 427.0456748402171, 444.35255767511046, 418.9389405027527, 282.9409608730258, 0.9524221409068243, 30.13249977613666, 314.5822014928938, 336.9978802976307, 410.5090513539876, 469.5784972292642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1226991588987367, "mean_inference_ms": 6.157716978781308, "mean_action_processing_ms": 0.8999296367126349, "mean_env_wait_ms": 0.7778927141195844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004885673522949219, "StateBufferConnector_ms": 0.004057526588439941, "ViewRequirementAgentConnector_ms": 0.16193068027496338}, "num_episodes": 18, "episode_return_max": 2172.255679927674, "episode_return_min": 469.0239158316132, "episode_return_mean": 1733.7512337473297, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.4662646760831, "num_env_steps_trained_throughput_per_sec": 311.4662646760831, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 100673.503, "restore_workers_time_ms": 0.019, "training_step_time_ms": 100673.449, "sample_time_ms": 4228.647, "learn_time_ms": 96407.624, "learn_throughput": 41.49, "synch_weights_time_ms": 35.451}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "8abce_00000", "date": "2024-08-16_12-21-26", "timestamp": 1723791086, "time_this_iter_s": 12.863979816436768, "time_total_s": 3594.137929916382, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a74d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3594.137929916382, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 39.85, "ram_util_percent": 75.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.652656562429256, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.289876410570095, "policy_loss": -0.0014542697534635268, "vf_loss": 9.290665913132763, "vf_explained_var": -0.005240109704789661, "kl": 0.004431787347976382, "entropy": 0.8360058781646547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.969285525972881, "cur_kl_coeff": 0.00078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.426951934673168, "policy_loss": -0.001464070576223392, "vf_loss": 9.42841232239254, "vf_explained_var": 0.03801201632413915, "kl": 0.004719368577033458, "entropy": 0.7609802415131262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 2188.5294785763926, "episode_reward_min": 469.0239158316132, "episode_reward_mean": 1721.1049821463844, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 87.14000000000013, "predator_policy": 0.9524221409068243}, "policy_reward_max": {"prey_policy": 801.8041091942581, "predator_policy": 571.0276238215159}, "policy_reward_mean": {"prey_policy": 521.1838997165544, "predator_policy": 339.36859135663803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1922.2752026258045, 1701.4073889785911, 2025.365376870182, 1702.0421076620937, 1929.7861943041803, 1862.8234567845686, 1790.131961139524, 1981.3573314798343, 1776.098682098997, 1363.4067407348862, 1692.2154353419023, 1835.4165832575525, 1529.6813549123958, 1531.6023274172842, 1100.3128396396544, 1897.3275048618684, 1897.372347978523, 2019.8591832756035, 2049.1928295326065, 1597.9802310021623, 2148.872106869918, 2067.5610493130953, 1591.032978158122, 1777.5940816009536, 1877.1659973167436, 2075.386422065473, 1865.4107597776322, 1530.956548943478, 2138.4986524433584, 580.9223786041291, 1557.476241390523, 1458.7470500973232, 1904.1286793972026, 2108.6717247950382, 1801.6420568203885, 1948.0345805524705, 1881.8625678425058, 2071.2533312385153, 1997.1184881645052, 1946.7651028651453, 1779.4022297793865, 1636.142329418901, 785.5995419583373, 1627.746510208703, 1671.3654446358341, 1471.5302775020132, 1875.7303187653804, 1591.8026306338527, 1544.479244068517, 1974.4097890898854, 1462.138050307711, 2019.992523296379, 1898.9104127777593, 1955.7157466013925, 1422.8062339059588, 1572.922945785598, 1428.40697171056, 1704.1491335501833, 2172.255679927674, 1085.8663446413573, 1739.8030206272254, 1479.1248058421997, 1727.6906540102136, 2009.1354436712754, 469.0239158316132, 1327.6766945396087, 1805.4166238252824, 1668.8422110255106, 1941.7887954546652, 2001.4217983974024, 939.2369500429792, 1600.5181501629509, 2079.862569638259, 1940.0658601550417, 1816.2267151121914, 2147.5139262828343, 1824.5099978804133, 1934.8942838817686, 1661.579933972282, 576.9968155119207, 1880.9289273120546, 1989.4239478780414, 1279.6968250168752, 886.4043725901532, 1730.4409200605298, 1987.042018128025, 1501.6131428164945, 2042.4899207873166, 2109.6691077422524, 1464.723112897752, 2188.5294785763926, 1517.027658188105, 1645.7280266740684, 1809.6047151806179, 1805.952811608663, 2117.590670118885, 1904.6322476483438, 1752.6627866464582, 1870.5417872085864, 1718.338334973089], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [486.1718703121535, 550.0970781408346, 527.9380905902636, 415.02013211551974, 724.3209277328264, 655.1386694428344, 507.89936525241984, 657.8816711659616, 661.4445532963979, 587.5802043977815, 480.25444234173915, 493.38795206701104, 534.3587117211923, 579.0876198494041, 552.1194122521782, 485.4579096486435, 530.6666743003587, 415.4360495123056, 412.45814816100903, 643.283735922957, 417.3904647295054, 536.7721657650931, 569.3568297641773, 582.4587956783524, 616.0471444763904, 479.13141451111505, 338.1212673210968, 671.9432105655166, 367.46121501211746, 361.59196677262213, 629.9943083267244, 615.1081855539026, 499.0955999787298, 616.3182554180225, 485.8292905463623, 578.7818092421405, 598.6946283047982, 608.4031378837312, 419.4458037115135, 435.4718167188768, 682.714761279194, 443.1736829388115, 586.9144917878468, 594.8084269646705, 376.41161470058654, 559.8997251999988, 415.33271612344106, 556.811143855824, 406.80019149999555, 500.0213018876224, 679.2833555681923, 556.7664138586655, 601.7524247432816, 625.0838856331817, 320.4301595500295, 659.7384947774652, 691.1168254287214, 567.2210779669717, 189.11, 333.9773971993648, 343.096143583154, 573.3844936158914, 295.7109254412459, 553.1660227976299, 494.20054030271285, 485.7296050159243, 593.9683202184857, 550.0717574154304, 679.6626719811322, 527.1717713994583, 589.9845709453865, 565.4290250127602, 417.4692042144024, 468.8137456018987, 517.517685824628, 621.2015973199448, 639.8799703245138, 543.926953487902, 683.6066332543296, 525.9719166381007, 725.3559890836307, 595.5494483671072, 527.1842745945228, 649.1822284957638, 399.77301667920443, 322.8473476171911, 410.7256147220726, 397.1481425994575, 548.7599993082458, 547.7706110075172, 741.8395246819883, 445.22435226622275, 498.6076060319986, 560.4476268988599, 448.01792880162833, 414.0550768503805, 596.4014231222058, 610.8315301417537, 754.6858713343007, 757.4797146792433, 87.14000000000013, 486.1209617110909, 514.8390163699235, 600.7800371849867, 566.0325603964011, 492.68582449709425, 610.7843216266809, 665.4237061115499, 694.7888517804149, 380.3909221466805, 312.4147581893229, 796.0363676164748, 480.5728221386953, 660.7638444414556, 620.8669856483626, 581.8024623189708, 535.5885592590165, 571.6326020854524, 465.46987733137735, 447.3451787345064, 615.8228124904472, 511.5600134015412, 506.1810251736369, 419.59537363685666, 365.6575721572062, 496.4860791926236, 652.1081144098385, 548.826869103936, 247.3048076150665, 190.1, 528.5166340995672, 535.1563242465556, 439.8075162688717, 533.199767517859, 726.3757870530337, 432.7738771734795, 675.0336761288187, 615.6488936270492, 499.9932301653515, 520.8059576526229, 269.0097620337525, 460.3589805069948, 439.60537778251455, 695.6146709558983, 422.78903238901665, 533.1232824039754, 535.5047272029906, 489.77840359624633, 449.63993491797487, 393.62362083032593, 562.9250843609645, 511.5494009305136, 474.31257094401525, 483.2669672491978, 651.4288292357654, 412.06722213067496, 497.67100170147137, 462.029030895031, 258.83552927904753, 287.0763643158299, 613.8779432636146, 615.4709022579152, 543.7668331349112, 565.5695661598777, 741.3744566455731, 253.626931601813, 411.01091205623567, 283.5351527138543, 416.47224456100236, 629.3109857213776, 594.2067381323452, 500.1358219509915, 455.27219766799175, 567.5921669262507, 505.7306022047086, 493.7181552763831, 801.8041091942581, 584.8052049903525, 406.42973495744536, 391.7513317094128, 434.26175578097195, 714.6036420133278, 641.1534622347407, 773.6522449648822, 281.66274024063466, 437.7861736956982, 481.4087765795874, 447.20266384330654, 512.8505677980478, 616.4785550459424, 632.1589839665171, 470.20313866922754, 570.9689705249261, 524.49207625517, 394.0423955398736, 500.75108846055616, 452.73431335744004, 631.4727852216269, 554.2544287849795, 569.8959036954016], "policy_predator_policy_reward": [439.7048109419788, 446.3014432308401, 398.0379405206433, 360.4112257521672, 315.6262812880686, 330.27949840645033, 307.11538186036927, 229.14568938334534, 254.69665035576753, 426.06478625423205, 423.42139910252234, 465.7596632732978, 337.0960476287524, 339.58958194017686, 438.86917781011556, 504.9108317688969, 400.4512161537525, 429.54474213257873, 152.79898391506043, 154.86587273586076, 366.87539552592295, 371.1774093213784, 337.4218322205213, 346.1791255945014, 208.7324671852035, 225.77032873968642, 198.79647456356082, 322.7413749671078, 161.37147659157552, 209.88818126333805, 341.8360390733957, 310.3889719078442, 422.7799128235581, 359.1785797582116, 495.5554534915373, 459.6926299955647, 427.01665041940726, 415.078412924671, 360.3077623399279, 382.7548482318457, 509.76824814819895, 513.2154145037136, 457.57737625653203, 428.2607543040459, 323.6160418831174, 331.1055963744197, 432.04392788729297, 373.40629373439975, 497.4506281281021, 472.8938758010241, 457.8343716461065, 381.5022809925098, 393.594375478171, 244.98007392299868, 236.74569950770072, 314.04219510828085, 434.58534514738903, 445.57540390027674, 29.3818073421671, 28.453174062597334, 279.94347446582816, 361.0521297256498, 298.5218891504102, 311.34821270803656, 492.22625786935436, 431.97227620920853, 481.3541843015043, 483.2774628596225, 263.2225265023858, 331.5850869374128, 313.1591610143626, 479.4618235799599, 510.7143458910694, 484.86527213513034, 472.44075745899767, 460.09329063494187, 364.28441347714045, 449.0271508749525, 360.7753070979098, 376.41124587481056, 282.4598857050457, 176.03690662359622, 301.50505743380387, 158.27076889481253, 25.832261073942888, 37.14691658799911, 381.7555083856544, 438.1172445015176, 279.20971195987875, 295.62512236018864, 117.32456757193631, 167.14183298186862, 406.26505074234177, 410.4100350921758, 354.2854838764539, 375.4441411053935, 214.1215762727648, 123.12471453179369, 235.1057423357342, 227.1384607406081, 473.66993083101227, 415.2071577656085, 457.32533114709963, 447.0481385943713, 426.3240851894622, 413.8679426948003, 370.75135964144164, 308.75635922172097, 192.19096693716367, 155.43549304169724, 240.76110650255274, 223.7107134772474, 148.16240724788761, 138.90789788252073, 235.0404520243301, 266.4392335585234, 532.5100926290739, 532.5244259541374, 71.17148178054943, 101.87980679492414, 354.1101174111486, 258.31007732408847, 274.4277991337803, 278.92060789792265, 463.4898698513484, 402.05713280903643, 405.10755860737027, 403.092901550133, 1.161710140738938, 30.45739807580776, 139.46719286143062, 124.53654333205536, 412.40541253355696, 420.003927504995, 285.72252620966276, 223.97002058933396, 358.1753666200906, 292.93085907870835, 518.5792523197543, 462.0433582596747, 94.58606058221629, 115.28214692001602, 243.62371917363694, 221.67438225090197, 552.9226310237565, 571.0276238215159, 470.31066506457825, 444.47206429122895, 476.44789583682905, 496.5152635270578, 539.3610899723958, 533.6783510189579, 448.761137046523, 418.1693226406753, 427.0456748402171, 444.35255767511046, 418.9389405027527, 282.9409608730258, 0.9524221409068243, 30.13249977613666, 314.5822014928938, 336.9978802976307, 410.5090513539876, 469.5784972292642, 155.6351278320471, 129.06030893744068, 92.04170809927088, 99.81659972079247, 350.6619048311911, 333.9957849469586, 391.2871904975464, 501.4122675471419, 227.04916697444895, 251.69961124779994, 510.5189153713164, 532.5222479349109, 329.26753442042, 393.7922591372172, 367.96521189603897, 298.576834334854, 498.74731484099163, 540.9167659411017, 41.84717774331475, 60.37477324516769, 497.5782531545224, 428.7008595832128, 467.32044424331207, 413.6728305144058, 351.13667211353794, 325.4870166511368, 489.26188025757733, 525.9666672255636, 365.6951884134497, 443.476012454801, 459.4786808027448, 398.390621843289, 477.8865921639872, 308.4480964655359, 323.3237971845244, 270.86420530818543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1111567633801527, "mean_inference_ms": 6.126156996650231, "mean_action_processing_ms": 0.894973434756306, "mean_env_wait_ms": 0.7735698687215862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054242610931396484, "StateBufferConnector_ms": 0.005266308784484863, "ViewRequirementAgentConnector_ms": 0.15663790702819824}, "num_episodes": 18, "episode_return_max": 2188.5294785763926, "episode_return_min": 469.0239158316132, "episode_return_mean": 1721.1049821463844, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.0606849506831, "num_env_steps_trained_throughput_per_sec": 328.0606849506831, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 98956.853, "restore_workers_time_ms": 0.019, "training_step_time_ms": 98956.799, "sample_time_ms": 3888.674, "learn_time_ms": 95037.339, "learn_throughput": 42.089, "synch_weights_time_ms": 29.263}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "8abce_00000", "date": "2024-08-16_12-21-38", "timestamp": 1723791098, "time_this_iter_s": 12.199924945831299, "time_total_s": 3606.337854862213, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a74f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3606.337854862213, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 42.37777777777777, "ram_util_percent": 75.63333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.1338244985966455, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.32975605555943, "policy_loss": -0.001967554656473338, "vf_loss": 9.331000789763435, "vf_explained_var": 0.008186387763452277, "kl": 0.0096375598256918, "entropy": 0.8353141183575625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.757255472266485, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.412795344862358, "policy_loss": -8.105933912610881e-05, "vf_loss": 9.412872926520292, "vf_explained_var": 0.050619828164892855, "kl": 0.008904773126071297, "entropy": 0.7330921961516931, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 2188.5294785763926, "episode_reward_min": 469.0239158316132, "episode_reward_mean": 1724.7528039556114, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 87.14000000000013, "predator_policy": 0.9524221409068243}, "policy_reward_max": {"prey_policy": 801.8041091942581, "predator_policy": 632.1244389221507}, "policy_reward_mean": {"prey_policy": 516.0982387833229, "predator_policy": 346.27816319448283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1591.032978158122, 1777.5940816009536, 1877.1659973167436, 2075.386422065473, 1865.4107597776322, 1530.956548943478, 2138.4986524433584, 580.9223786041291, 1557.476241390523, 1458.7470500973232, 1904.1286793972026, 2108.6717247950382, 1801.6420568203885, 1948.0345805524705, 1881.8625678425058, 2071.2533312385153, 1997.1184881645052, 1946.7651028651453, 1779.4022297793865, 1636.142329418901, 785.5995419583373, 1627.746510208703, 1671.3654446358341, 1471.5302775020132, 1875.7303187653804, 1591.8026306338527, 1544.479244068517, 1974.4097890898854, 1462.138050307711, 2019.992523296379, 1898.9104127777593, 1955.7157466013925, 1422.8062339059588, 1572.922945785598, 1428.40697171056, 1704.1491335501833, 2172.255679927674, 1085.8663446413573, 1739.8030206272254, 1479.1248058421997, 1727.6906540102136, 2009.1354436712754, 469.0239158316132, 1327.6766945396087, 1805.4166238252824, 1668.8422110255106, 1941.7887954546652, 2001.4217983974024, 939.2369500429792, 1600.5181501629509, 2079.862569638259, 1940.0658601550417, 1816.2267151121914, 2147.5139262828343, 1824.5099978804133, 1934.8942838817686, 1661.579933972282, 576.9968155119207, 1880.9289273120546, 1989.4239478780414, 1279.6968250168752, 886.4043725901532, 1730.4409200605298, 1987.042018128025, 1501.6131428164945, 2042.4899207873166, 2109.6691077422524, 1464.723112897752, 2188.5294785763926, 1517.027658188105, 1645.7280266740684, 1809.6047151806179, 1805.952811608663, 2117.590670118885, 1904.6322476483438, 1752.6627866464582, 1870.5417872085864, 1718.338334973089, 1891.168905169877, 1677.318235704445, 1757.7506470029043, 1756.015483479339, 1606.6980520424322, 2175.592467055335, 2038.3578890503522, 1896.25052781351, 1444.4960964039728, 2060.2178937250997, 1827.8556780193371, 1448.3433301576708, 1964.5340461797216, 1484.2321568666891, 1993.7579214586906, 2022.259145687996, 1898.520071132871, 1638.7815646478318, 1660.3784292026178, 1557.3789128640979, 1959.7873332550678, 2027.1756300840327], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [376.41161470058654, 559.8997251999988, 415.33271612344106, 556.811143855824, 406.80019149999555, 500.0213018876224, 679.2833555681923, 556.7664138586655, 601.7524247432816, 625.0838856331817, 320.4301595500295, 659.7384947774652, 691.1168254287214, 567.2210779669717, 189.11, 333.9773971993648, 343.096143583154, 573.3844936158914, 295.7109254412459, 553.1660227976299, 494.20054030271285, 485.7296050159243, 593.9683202184857, 550.0717574154304, 679.6626719811322, 527.1717713994583, 589.9845709453865, 565.4290250127602, 417.4692042144024, 468.8137456018987, 517.517685824628, 621.2015973199448, 639.8799703245138, 543.926953487902, 683.6066332543296, 525.9719166381007, 725.3559890836307, 595.5494483671072, 527.1842745945228, 649.1822284957638, 399.77301667920443, 322.8473476171911, 410.7256147220726, 397.1481425994575, 548.7599993082458, 547.7706110075172, 741.8395246819883, 445.22435226622275, 498.6076060319986, 560.4476268988599, 448.01792880162833, 414.0550768503805, 596.4014231222058, 610.8315301417537, 754.6858713343007, 757.4797146792433, 87.14000000000013, 486.1209617110909, 514.8390163699235, 600.7800371849867, 566.0325603964011, 492.68582449709425, 610.7843216266809, 665.4237061115499, 694.7888517804149, 380.3909221466805, 312.4147581893229, 796.0363676164748, 480.5728221386953, 660.7638444414556, 620.8669856483626, 581.8024623189708, 535.5885592590165, 571.6326020854524, 465.46987733137735, 447.3451787345064, 615.8228124904472, 511.5600134015412, 506.1810251736369, 419.59537363685666, 365.6575721572062, 496.4860791926236, 652.1081144098385, 548.826869103936, 247.3048076150665, 190.1, 528.5166340995672, 535.1563242465556, 439.8075162688717, 533.199767517859, 726.3757870530337, 432.7738771734795, 675.0336761288187, 615.6488936270492, 499.9932301653515, 520.8059576526229, 269.0097620337525, 460.3589805069948, 439.60537778251455, 695.6146709558983, 422.78903238901665, 533.1232824039754, 535.5047272029906, 489.77840359624633, 449.63993491797487, 393.62362083032593, 562.9250843609645, 511.5494009305136, 474.31257094401525, 483.2669672491978, 651.4288292357654, 412.06722213067496, 497.67100170147137, 462.029030895031, 258.83552927904753, 287.0763643158299, 613.8779432636146, 615.4709022579152, 543.7668331349112, 565.5695661598777, 741.3744566455731, 253.626931601813, 411.01091205623567, 283.5351527138543, 416.47224456100236, 629.3109857213776, 594.2067381323452, 500.1358219509915, 455.27219766799175, 567.5921669262507, 505.7306022047086, 493.7181552763831, 801.8041091942581, 584.8052049903525, 406.42973495744536, 391.7513317094128, 434.26175578097195, 714.6036420133278, 641.1534622347407, 773.6522449648822, 281.66274024063466, 437.7861736956982, 481.4087765795874, 447.20266384330654, 512.8505677980478, 616.4785550459424, 632.1589839665171, 470.20313866922754, 570.9689705249261, 524.49207625517, 394.0423955398736, 500.75108846055616, 452.73431335744004, 631.4727852216269, 554.2544287849795, 569.8959036954016, 494.6742651909321, 505.0271377757501, 679.4920083576765, 566.4896438068843, 553.2131504363243, 558.596181255996, 535.4915132194778, 406.86310468823166, 429.0352475558779, 483.5430030784643, 635.6117729517546, 346.10794712180154, 581.8485915690771, 705.9541195227846, 341.74208284256713, 536.1963266463442, 598.8278643723543, 447.7767327300851, 516.0940466906496, 586.2203565093605, 424.2789460308887, 485.01490083372727, 484.53736209513414, 275.4816436010742, 663.7954124885844, 513.6925373924354, 600.285996854423, 243.0552675693588, 504.2268348505978, 630.2547437480404, 580.440847652765, 521.6667346509004, 436.944306358148, 450.55543827882684, 565.1423286489755, 569.2097813432664, 412.2059504151149, 569.6703525989836, 562.0869286410605, 498.21753393327737, 462.934856739905, 543.783551121718, 486.69526662812723, 624.9170860310935], "policy_predator_policy_reward": [323.6160418831174, 331.1055963744197, 432.04392788729297, 373.40629373439975, 497.4506281281021, 472.8938758010241, 457.8343716461065, 381.5022809925098, 393.594375478171, 244.98007392299868, 236.74569950770072, 314.04219510828085, 434.58534514738903, 445.57540390027674, 29.3818073421671, 28.453174062597334, 279.94347446582816, 361.0521297256498, 298.5218891504102, 311.34821270803656, 492.22625786935436, 431.97227620920853, 481.3541843015043, 483.2774628596225, 263.2225265023858, 331.5850869374128, 313.1591610143626, 479.4618235799599, 510.7143458910694, 484.86527213513034, 472.44075745899767, 460.09329063494187, 364.28441347714045, 449.0271508749525, 360.7753070979098, 376.41124587481056, 282.4598857050457, 176.03690662359622, 301.50505743380387, 158.27076889481253, 25.832261073942888, 37.14691658799911, 381.7555083856544, 438.1172445015176, 279.20971195987875, 295.62512236018864, 117.32456757193631, 167.14183298186862, 406.26505074234177, 410.4100350921758, 354.2854838764539, 375.4441411053935, 214.1215762727648, 123.12471453179369, 235.1057423357342, 227.1384607406081, 473.66993083101227, 415.2071577656085, 457.32533114709963, 447.0481385943713, 426.3240851894622, 413.8679426948003, 370.75135964144164, 308.75635922172097, 192.19096693716367, 155.43549304169724, 240.76110650255274, 223.7107134772474, 148.16240724788761, 138.90789788252073, 235.0404520243301, 266.4392335585234, 532.5100926290739, 532.5244259541374, 71.17148178054943, 101.87980679492414, 354.1101174111486, 258.31007732408847, 274.4277991337803, 278.92060789792265, 463.4898698513484, 402.05713280903643, 405.10755860737027, 403.092901550133, 1.161710140738938, 30.45739807580776, 139.46719286143062, 124.53654333205536, 412.40541253355696, 420.003927504995, 285.72252620966276, 223.97002058933396, 358.1753666200906, 292.93085907870835, 518.5792523197543, 462.0433582596747, 94.58606058221629, 115.28214692001602, 243.62371917363694, 221.67438225090197, 552.9226310237565, 571.0276238215159, 470.31066506457825, 444.47206429122895, 476.44789583682905, 496.5152635270578, 539.3610899723958, 533.6783510189579, 448.761137046523, 418.1693226406753, 427.0456748402171, 444.35255767511046, 418.9389405027527, 282.9409608730258, 0.9524221409068243, 30.13249977613666, 314.5822014928938, 336.9978802976307, 410.5090513539876, 469.5784972292642, 155.6351278320471, 129.06030893744068, 92.04170809927088, 99.81659972079247, 350.6619048311911, 333.9957849469586, 391.2871904975464, 501.4122675471419, 227.04916697444895, 251.69961124779994, 510.5189153713164, 532.5222479349109, 329.26753442042, 393.7922591372172, 367.96521189603897, 298.576834334854, 498.74731484099163, 540.9167659411017, 41.84717774331475, 60.37477324516769, 497.5782531545224, 428.7008595832128, 467.32044424331207, 413.6728305144058, 351.13667211353794, 325.4870166511368, 489.26188025757733, 525.9666672255636, 365.6951884134497, 443.476012454801, 459.4786808027448, 398.390621843289, 477.8865921639872, 308.4480964655359, 323.3237971845244, 270.86420530818543, 482.9083528771522, 408.5591493260434, 194.70671096781854, 236.62987257206498, 316.59473106299004, 329.34658424759294, 397.11168801788614, 416.54917755374396, 349.15586100117304, 344.963940406918, 561.7483080596267, 632.1244389221507, 365.01468611110886, 385.5404918473841, 524.6380288267399, 493.67408949786085, 221.40301388702343, 176.48848541451233, 456.9591653445054, 500.94432518058323, 460.3369750716808, 458.22485608304095, 296.587449977197, 391.73687448426836, 374.8927963824644, 412.1532999162384, 313.0259705407291, 327.8649219021812, 420.1791387075836, 439.09720415247295, 442.39763767290543, 477.75392571142504, 519.5918843808587, 491.4284421150392, 251.40175521816136, 253.02769943743002, 346.40795744215046, 332.0941687463698, 266.859828739709, 230.2146215500519, 504.0442812277156, 449.02464416572957, 472.6176460855497, 442.94563133925874]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.100738146091558, "mean_inference_ms": 6.090506788040532, "mean_action_processing_ms": 0.889092395458459, "mean_env_wait_ms": 0.7688505872718626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007417798042297363, "StateBufferConnector_ms": 0.005368828773498535, "ViewRequirementAgentConnector_ms": 0.1341918706893921}, "num_episodes": 22, "episode_return_max": 2188.5294785763926, "episode_return_min": 469.0239158316132, "episode_return_mean": 1724.7528039556114, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.03777436091406, "num_env_steps_trained_throughput_per_sec": 281.03777436091406, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 97498.106, "restore_workers_time_ms": 0.019, "training_step_time_ms": 97498.052, "sample_time_ms": 3651.552, "learn_time_ms": 93817.859, "learn_throughput": 42.636, "synch_weights_time_ms": 27.15}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "8abce_00000", "date": "2024-08-16_12-21-52", "timestamp": 1723791112, "time_this_iter_s": 14.246505975723267, "time_total_s": 3620.5843608379364, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a679d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3620.5843608379364, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 42.30526315789474, "ram_util_percent": 74.91578947368423}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5494965615411282, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.418964889062146, "policy_loss": -0.0021004757267378627, "vf_loss": 9.420518274155874, "vf_explained_var": 0.025159820299299935, "kl": 0.007294399336564928, "entropy": 0.7809255545416837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5571232727122686, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.33845712671835, "policy_loss": -2.856664236378733e-05, "vf_loss": 9.338483221568758, "vf_explained_var": 0.006504571437835694, "kl": 0.006365726820132475, "entropy": 0.7639392702037064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 2188.5294785763926, "episode_reward_min": 469.0239158316132, "episode_reward_mean": 1722.2879251831428, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 87.14000000000013, "predator_policy": 0.9524221409068243}, "policy_reward_max": {"prey_policy": 801.8041091942581, "predator_policy": 632.1244389221507}, "policy_reward_mean": {"prey_policy": 516.8905142677608, "predator_policy": 344.25344832381074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1779.4022297793865, 1636.142329418901, 785.5995419583373, 1627.746510208703, 1671.3654446358341, 1471.5302775020132, 1875.7303187653804, 1591.8026306338527, 1544.479244068517, 1974.4097890898854, 1462.138050307711, 2019.992523296379, 1898.9104127777593, 1955.7157466013925, 1422.8062339059588, 1572.922945785598, 1428.40697171056, 1704.1491335501833, 2172.255679927674, 1085.8663446413573, 1739.8030206272254, 1479.1248058421997, 1727.6906540102136, 2009.1354436712754, 469.0239158316132, 1327.6766945396087, 1805.4166238252824, 1668.8422110255106, 1941.7887954546652, 2001.4217983974024, 939.2369500429792, 1600.5181501629509, 2079.862569638259, 1940.0658601550417, 1816.2267151121914, 2147.5139262828343, 1824.5099978804133, 1934.8942838817686, 1661.579933972282, 576.9968155119207, 1880.9289273120546, 1989.4239478780414, 1279.6968250168752, 886.4043725901532, 1730.4409200605298, 1987.042018128025, 1501.6131428164945, 2042.4899207873166, 2109.6691077422524, 1464.723112897752, 2188.5294785763926, 1517.027658188105, 1645.7280266740684, 1809.6047151806179, 1805.952811608663, 2117.590670118885, 1904.6322476483438, 1752.6627866464582, 1870.5417872085864, 1718.338334973089, 1891.168905169877, 1677.318235704445, 1757.7506470029043, 1756.015483479339, 1606.6980520424322, 2175.592467055335, 2038.3578890503522, 1896.25052781351, 1444.4960964039728, 2060.2178937250997, 1827.8556780193371, 1448.3433301576708, 1964.5340461797216, 1484.2321568666891, 1993.7579214586906, 2022.259145687996, 1898.520071132871, 1638.7815646478318, 1660.3784292026178, 1557.3789128640979, 1959.7873332550678, 2027.1756300840327, 1653.9526517346842, 1880.910422703823, 1287.6827389248735, 1852.6938247003498, 1927.5987784251522, 2090.246080235921, 1781.4405043779352, 1649.5340713844114, 1468.7790470315274, 1867.6558118796236, 1408.3122791640592, 1540.6021995813946, 1987.4245013487516, 1964.408267021277, 1907.6811807799595, 1977.6601799250154, 2138.1961931746323, 1481.401032433276], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [725.3559890836307, 595.5494483671072, 527.1842745945228, 649.1822284957638, 399.77301667920443, 322.8473476171911, 410.7256147220726, 397.1481425994575, 548.7599993082458, 547.7706110075172, 741.8395246819883, 445.22435226622275, 498.6076060319986, 560.4476268988599, 448.01792880162833, 414.0550768503805, 596.4014231222058, 610.8315301417537, 754.6858713343007, 757.4797146792433, 87.14000000000013, 486.1209617110909, 514.8390163699235, 600.7800371849867, 566.0325603964011, 492.68582449709425, 610.7843216266809, 665.4237061115499, 694.7888517804149, 380.3909221466805, 312.4147581893229, 796.0363676164748, 480.5728221386953, 660.7638444414556, 620.8669856483626, 581.8024623189708, 535.5885592590165, 571.6326020854524, 465.46987733137735, 447.3451787345064, 615.8228124904472, 511.5600134015412, 506.1810251736369, 419.59537363685666, 365.6575721572062, 496.4860791926236, 652.1081144098385, 548.826869103936, 247.3048076150665, 190.1, 528.5166340995672, 535.1563242465556, 439.8075162688717, 533.199767517859, 726.3757870530337, 432.7738771734795, 675.0336761288187, 615.6488936270492, 499.9932301653515, 520.8059576526229, 269.0097620337525, 460.3589805069948, 439.60537778251455, 695.6146709558983, 422.78903238901665, 533.1232824039754, 535.5047272029906, 489.77840359624633, 449.63993491797487, 393.62362083032593, 562.9250843609645, 511.5494009305136, 474.31257094401525, 483.2669672491978, 651.4288292357654, 412.06722213067496, 497.67100170147137, 462.029030895031, 258.83552927904753, 287.0763643158299, 613.8779432636146, 615.4709022579152, 543.7668331349112, 565.5695661598777, 741.3744566455731, 253.626931601813, 411.01091205623567, 283.5351527138543, 416.47224456100236, 629.3109857213776, 594.2067381323452, 500.1358219509915, 455.27219766799175, 567.5921669262507, 505.7306022047086, 493.7181552763831, 801.8041091942581, 584.8052049903525, 406.42973495744536, 391.7513317094128, 434.26175578097195, 714.6036420133278, 641.1534622347407, 773.6522449648822, 281.66274024063466, 437.7861736956982, 481.4087765795874, 447.20266384330654, 512.8505677980478, 616.4785550459424, 632.1589839665171, 470.20313866922754, 570.9689705249261, 524.49207625517, 394.0423955398736, 500.75108846055616, 452.73431335744004, 631.4727852216269, 554.2544287849795, 569.8959036954016, 494.6742651909321, 505.0271377757501, 679.4920083576765, 566.4896438068843, 553.2131504363243, 558.596181255996, 535.4915132194778, 406.86310468823166, 429.0352475558779, 483.5430030784643, 635.6117729517546, 346.10794712180154, 581.8485915690771, 705.9541195227846, 341.74208284256713, 536.1963266463442, 598.8278643723543, 447.7767327300851, 516.0940466906496, 586.2203565093605, 424.2789460308887, 485.01490083372727, 484.53736209513414, 275.4816436010742, 663.7954124885844, 513.6925373924354, 600.285996854423, 243.0552675693588, 504.2268348505978, 630.2547437480404, 580.440847652765, 521.6667346509004, 436.944306358148, 450.55543827882684, 565.1423286489755, 569.2097813432664, 412.2059504151149, 569.6703525989836, 562.0869286410605, 498.21753393327737, 462.934856739905, 543.783551121718, 486.69526662812723, 624.9170860310935, 394.16039727767355, 569.392220946303, 624.9911190413598, 640.4778930210679, 411.971097639888, 537.9453267763909, 310.3201740511609, 537.8537839015709, 423.95262594826363, 557.1633236029002, 683.8070497647642, 588.9372306805249, 365.15710564847654, 441.5423218324995, 540.8614422570892, 518.7597085855039, 484.5578668400116, 503.59412567186877, 744.5362472282037, 601.6920548421529, 369.2430743417988, 383.02342245206387, 331.428341757964, 553.7157865706035, 590.356839332518, 371.9773593133396, 719.9087037268516, 600.3902836061709, 688.2403574820103, 600.3980866617322, 528.9278836676075, 662.9446736077568, 531.0665157705325, 406.2307856361673, 490.7003424377781, 557.9498073532694], "policy_predator_policy_reward": [282.4598857050457, 176.03690662359622, 301.50505743380387, 158.27076889481253, 25.832261073942888, 37.14691658799911, 381.7555083856544, 438.1172445015176, 279.20971195987875, 295.62512236018864, 117.32456757193631, 167.14183298186862, 406.26505074234177, 410.4100350921758, 354.2854838764539, 375.4441411053935, 214.1215762727648, 123.12471453179369, 235.1057423357342, 227.1384607406081, 473.66993083101227, 415.2071577656085, 457.32533114709963, 447.0481385943713, 426.3240851894622, 413.8679426948003, 370.75135964144164, 308.75635922172097, 192.19096693716367, 155.43549304169724, 240.76110650255274, 223.7107134772474, 148.16240724788761, 138.90789788252073, 235.0404520243301, 266.4392335585234, 532.5100926290739, 532.5244259541374, 71.17148178054943, 101.87980679492414, 354.1101174111486, 258.31007732408847, 274.4277991337803, 278.92060789792265, 463.4898698513484, 402.05713280903643, 405.10755860737027, 403.092901550133, 1.161710140738938, 30.45739807580776, 139.46719286143062, 124.53654333205536, 412.40541253355696, 420.003927504995, 285.72252620966276, 223.97002058933396, 358.1753666200906, 292.93085907870835, 518.5792523197543, 462.0433582596747, 94.58606058221629, 115.28214692001602, 243.62371917363694, 221.67438225090197, 552.9226310237565, 571.0276238215159, 470.31066506457825, 444.47206429122895, 476.44789583682905, 496.5152635270578, 539.3610899723958, 533.6783510189579, 448.761137046523, 418.1693226406753, 427.0456748402171, 444.35255767511046, 418.9389405027527, 282.9409608730258, 0.9524221409068243, 30.13249977613666, 314.5822014928938, 336.9978802976307, 410.5090513539876, 469.5784972292642, 155.6351278320471, 129.06030893744068, 92.04170809927088, 99.81659972079247, 350.6619048311911, 333.9957849469586, 391.2871904975464, 501.4122675471419, 227.04916697444895, 251.69961124779994, 510.5189153713164, 532.5222479349109, 329.26753442042, 393.7922591372172, 367.96521189603897, 298.576834334854, 498.74731484099163, 540.9167659411017, 41.84717774331475, 60.37477324516769, 497.5782531545224, 428.7008595832128, 467.32044424331207, 413.6728305144058, 351.13667211353794, 325.4870166511368, 489.26188025757733, 525.9666672255636, 365.6951884134497, 443.476012454801, 459.4786808027448, 398.390621843289, 477.8865921639872, 308.4480964655359, 323.3237971845244, 270.86420530818543, 482.9083528771522, 408.5591493260434, 194.70671096781854, 236.62987257206498, 316.59473106299004, 329.34658424759294, 397.11168801788614, 416.54917755374396, 349.15586100117304, 344.963940406918, 561.7483080596267, 632.1244389221507, 365.01468611110886, 385.5404918473841, 524.6380288267399, 493.67408949786085, 221.40301388702343, 176.48848541451233, 456.9591653445054, 500.94432518058323, 460.3369750716808, 458.22485608304095, 296.587449977197, 391.73687448426836, 374.8927963824644, 412.1532999162384, 313.0259705407291, 327.8649219021812, 420.1791387075836, 439.09720415247295, 442.39763767290543, 477.75392571142504, 519.5918843808587, 491.4284421150392, 251.40175521816136, 253.02769943743002, 346.40795744215046, 332.0941687463698, 266.859828739709, 230.2146215500519, 504.0442812277156, 449.02464416572957, 472.6176460855497, 442.94563133925874, 399.8647690005418, 290.535264510163, 334.0675792807361, 281.37383136065927, 193.4319784772778, 144.33433603131533, 493.3117556856464, 511.20811106197107, 485.73984562024395, 460.7429832537427, 392.214969118673, 425.28683067195277, 493.36842592886615, 481.37265096808864, 277.6661683843862, 312.24675215743224, 238.89687780361297, 241.73017671603645, 274.1635905335538, 247.26391927571248, 334.151613209758, 321.8941691604379, 304.964548612716, 350.4935226401088, 490.95092700225115, 534.1393757006418, 311.08731866717375, 333.021961021073, 299.5592331767722, 319.48350345944704, 358.13460852499406, 427.6530141246593, 593.809781579831, 607.0891101881036, 182.7257921757533, 250.02509046647708]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0915026505440735, "mean_inference_ms": 6.061036837883408, "mean_action_processing_ms": 0.8842324087306805, "mean_env_wait_ms": 0.7650304560026132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007763504981994629, "StateBufferConnector_ms": 0.0053746700286865234, "ViewRequirementAgentConnector_ms": 0.11944079399108887}, "num_episodes": 18, "episode_return_max": 2188.5294785763926, "episode_return_min": 469.0239158316132, "episode_return_mean": 1722.2879251831428, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.6447743769214, "num_env_steps_trained_throughput_per_sec": 337.6447743769214, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 95749.141, "restore_workers_time_ms": 0.018, "training_step_time_ms": 95749.091, "sample_time_ms": 3050.149, "learn_time_ms": 92673.369, "learn_throughput": 43.162, "synch_weights_time_ms": 24.242}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "8abce_00000", "date": "2024-08-16_12-22-04", "timestamp": 1723791124, "time_this_iter_s": 11.881483793258667, "time_total_s": 3632.465844631195, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a435fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3632.465844631195, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 37.95882352941176, "ram_util_percent": 74.84117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.432129431843127, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.377352019718716, "policy_loss": -0.0029543657047999285, "vf_loss": 9.379721435163386, "vf_explained_var": 0.04892759155974817, "kl": 0.007799437079058534, "entropy": 0.7267271797493021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.360387771880185, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.401839308259348, "policy_loss": -0.00481989644356959, "vf_loss": 9.406651477712803, "vf_explained_var": 0.07617689945079663, "kl": 0.019798848320245872, "entropy": 0.8148270135203367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 2207.99663123306, "episode_reward_min": 469.0239158316132, "episode_reward_mean": 1766.159319147616, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 190.1, "predator_policy": 0.9524221409068243}, "policy_reward_max": {"prey_policy": 801.8041091942581, "predator_policy": 632.1244389221507}, "policy_reward_mean": {"prey_policy": 519.7579557323971, "predator_policy": 363.32170384141085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2009.1354436712754, 469.0239158316132, 1327.6766945396087, 1805.4166238252824, 1668.8422110255106, 1941.7887954546652, 2001.4217983974024, 939.2369500429792, 1600.5181501629509, 2079.862569638259, 1940.0658601550417, 1816.2267151121914, 2147.5139262828343, 1824.5099978804133, 1934.8942838817686, 1661.579933972282, 576.9968155119207, 1880.9289273120546, 1989.4239478780414, 1279.6968250168752, 886.4043725901532, 1730.4409200605298, 1987.042018128025, 1501.6131428164945, 2042.4899207873166, 2109.6691077422524, 1464.723112897752, 2188.5294785763926, 1517.027658188105, 1645.7280266740684, 1809.6047151806179, 1805.952811608663, 2117.590670118885, 1904.6322476483438, 1752.6627866464582, 1870.5417872085864, 1718.338334973089, 1891.168905169877, 1677.318235704445, 1757.7506470029043, 1756.015483479339, 1606.6980520424322, 2175.592467055335, 2038.3578890503522, 1896.25052781351, 1444.4960964039728, 2060.2178937250997, 1827.8556780193371, 1448.3433301576708, 1964.5340461797216, 1484.2321568666891, 1993.7579214586906, 2022.259145687996, 1898.520071132871, 1638.7815646478318, 1660.3784292026178, 1557.3789128640979, 1959.7873332550678, 2027.1756300840327, 1653.9526517346842, 1880.910422703823, 1287.6827389248735, 1852.6938247003498, 1927.5987784251522, 2090.246080235921, 1781.4405043779352, 1649.5340713844114, 1468.7790470315274, 1867.6558118796236, 1408.3122791640592, 1540.6021995813946, 1987.4245013487516, 1964.408267021277, 1907.6811807799595, 1977.6601799250154, 2138.1961931746323, 1481.401032433276, 1682.5725156621315, 1559.7810289933645, 1875.974450200092, 2053.9954185579572, 1909.9945603685871, 1547.0412073795646, 1710.7766824142134, 1883.443548437584, 2005.3591620682892, 1960.760647876571, 1994.7925121814756, 1818.4639068452595, 1683.2405696606666, 2207.99663123306, 1840.3344442850453, 1369.0883325293032, 1916.3501855612603, 1997.136218988859, 1467.317674490316, 1979.6519756553419, 1792.8666826529038, 1841.0573435158185, 1917.1345359346674], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [652.1081144098385, 548.826869103936, 247.3048076150665, 190.1, 528.5166340995672, 535.1563242465556, 439.8075162688717, 533.199767517859, 726.3757870530337, 432.7738771734795, 675.0336761288187, 615.6488936270492, 499.9932301653515, 520.8059576526229, 269.0097620337525, 460.3589805069948, 439.60537778251455, 695.6146709558983, 422.78903238901665, 533.1232824039754, 535.5047272029906, 489.77840359624633, 449.63993491797487, 393.62362083032593, 562.9250843609645, 511.5494009305136, 474.31257094401525, 483.2669672491978, 651.4288292357654, 412.06722213067496, 497.67100170147137, 462.029030895031, 258.83552927904753, 287.0763643158299, 613.8779432636146, 615.4709022579152, 543.7668331349112, 565.5695661598777, 741.3744566455731, 253.626931601813, 411.01091205623567, 283.5351527138543, 416.47224456100236, 629.3109857213776, 594.2067381323452, 500.1358219509915, 455.27219766799175, 567.5921669262507, 505.7306022047086, 493.7181552763831, 801.8041091942581, 584.8052049903525, 406.42973495744536, 391.7513317094128, 434.26175578097195, 714.6036420133278, 641.1534622347407, 773.6522449648822, 281.66274024063466, 437.7861736956982, 481.4087765795874, 447.20266384330654, 512.8505677980478, 616.4785550459424, 632.1589839665171, 470.20313866922754, 570.9689705249261, 524.49207625517, 394.0423955398736, 500.75108846055616, 452.73431335744004, 631.4727852216269, 554.2544287849795, 569.8959036954016, 494.6742651909321, 505.0271377757501, 679.4920083576765, 566.4896438068843, 553.2131504363243, 558.596181255996, 535.4915132194778, 406.86310468823166, 429.0352475558779, 483.5430030784643, 635.6117729517546, 346.10794712180154, 581.8485915690771, 705.9541195227846, 341.74208284256713, 536.1963266463442, 598.8278643723543, 447.7767327300851, 516.0940466906496, 586.2203565093605, 424.2789460308887, 485.01490083372727, 484.53736209513414, 275.4816436010742, 663.7954124885844, 513.6925373924354, 600.285996854423, 243.0552675693588, 504.2268348505978, 630.2547437480404, 580.440847652765, 521.6667346509004, 436.944306358148, 450.55543827882684, 565.1423286489755, 569.2097813432664, 412.2059504151149, 569.6703525989836, 562.0869286410605, 498.21753393327737, 462.934856739905, 543.783551121718, 486.69526662812723, 624.9170860310935, 394.16039727767355, 569.392220946303, 624.9911190413598, 640.4778930210679, 411.971097639888, 537.9453267763909, 310.3201740511609, 537.8537839015709, 423.95262594826363, 557.1633236029002, 683.8070497647642, 588.9372306805249, 365.15710564847654, 441.5423218324995, 540.8614422570892, 518.7597085855039, 484.5578668400116, 503.59412567186877, 744.5362472282037, 601.6920548421529, 369.2430743417988, 383.02342245206387, 331.428341757964, 553.7157865706035, 590.356839332518, 371.9773593133396, 719.9087037268516, 600.3902836061709, 688.2403574820103, 600.3980866617322, 528.9278836676075, 662.9446736077568, 531.0665157705325, 406.2307856361673, 490.7003424377781, 557.9498073532694, 469.9782722781633, 497.40614532728495, 481.841796673442, 486.68041687427865, 534.3320618476317, 461.94531289549997, 790.7791425623184, 429.65800384453814, 652.0810317788112, 632.4375346551207, 616.4539118918027, 565.1319857044396, 549.6350026035201, 667.1549669513812, 520.501910327631, 489.4700145754857, 535.7860543442083, 527.9957703365384, 422.1182762006294, 411.1031375894216, 574.3013385739247, 444.17538779029786, 490.60571668948006, 436.5914448345709, 399.89687641398064, 538.3512982980136, 797.433588847442, 365.2622340809875, 549.7748986917401, 537.0869232133236, 657.6288408074305, 436.0452195666782, 685.238720240089, 406.0785011806089, 736.6760400369874, 595.0395597867172, 429.4558946679018, 545.6513842376958, 530.7195836340675, 379.7844934674065, 548.3908679133364, 677.7599811674963, 502.9441887637292, 668.192857236542, 570.0120373038807, 766.5695291448545], "policy_predator_policy_reward": [405.10755860737027, 403.092901550133, 1.161710140738938, 30.45739807580776, 139.46719286143062, 124.53654333205536, 412.40541253355696, 420.003927504995, 285.72252620966276, 223.97002058933396, 358.1753666200906, 292.93085907870835, 518.5792523197543, 462.0433582596747, 94.58606058221629, 115.28214692001602, 243.62371917363694, 221.67438225090197, 552.9226310237565, 571.0276238215159, 470.31066506457825, 444.47206429122895, 476.44789583682905, 496.5152635270578, 539.3610899723958, 533.6783510189579, 448.761137046523, 418.1693226406753, 427.0456748402171, 444.35255767511046, 418.9389405027527, 282.9409608730258, 0.9524221409068243, 30.13249977613666, 314.5822014928938, 336.9978802976307, 410.5090513539876, 469.5784972292642, 155.6351278320471, 129.06030893744068, 92.04170809927088, 99.81659972079247, 350.6619048311911, 333.9957849469586, 391.2871904975464, 501.4122675471419, 227.04916697444895, 251.69961124779994, 510.5189153713164, 532.5222479349109, 329.26753442042, 393.7922591372172, 367.96521189603897, 298.576834334854, 498.74731484099163, 540.9167659411017, 41.84717774331475, 60.37477324516769, 497.5782531545224, 428.7008595832128, 467.32044424331207, 413.6728305144058, 351.13667211353794, 325.4870166511368, 489.26188025757733, 525.9666672255636, 365.6951884134497, 443.476012454801, 459.4786808027448, 398.390621843289, 477.8865921639872, 308.4480964655359, 323.3237971845244, 270.86420530818543, 482.9083528771522, 408.5591493260434, 194.70671096781854, 236.62987257206498, 316.59473106299004, 329.34658424759294, 397.11168801788614, 416.54917755374396, 349.15586100117304, 344.963940406918, 561.7483080596267, 632.1244389221507, 365.01468611110886, 385.5404918473841, 524.6380288267399, 493.67408949786085, 221.40301388702343, 176.48848541451233, 456.9591653445054, 500.94432518058323, 460.3369750716808, 458.22485608304095, 296.587449977197, 391.73687448426836, 374.8927963824644, 412.1532999162384, 313.0259705407291, 327.8649219021812, 420.1791387075836, 439.09720415247295, 442.39763767290543, 477.75392571142504, 519.5918843808587, 491.4284421150392, 251.40175521816136, 253.02769943743002, 346.40795744215046, 332.0941687463698, 266.859828739709, 230.2146215500519, 504.0442812277156, 449.02464416572957, 472.6176460855497, 442.94563133925874, 399.8647690005418, 290.535264510163, 334.0675792807361, 281.37383136065927, 193.4319784772778, 144.33433603131533, 493.3117556856464, 511.20811106197107, 485.73984562024395, 460.7429832537427, 392.214969118673, 425.28683067195277, 493.36842592886615, 481.37265096808864, 277.6661683843862, 312.24675215743224, 238.89687780361297, 241.73017671603645, 274.1635905335538, 247.26391927571248, 334.151613209758, 321.8941691604379, 304.964548612716, 350.4935226401088, 490.95092700225115, 534.1393757006418, 311.08731866717375, 333.021961021073, 299.5592331767722, 319.48350345944704, 358.13460852499406, 427.6530141246593, 593.809781579831, 607.0891101881036, 182.7257921757533, 250.02509046647708, 373.936993216588, 341.2511048400949, 273.91975062367413, 317.33906482197295, 454.3119312314974, 425.3851442254628, 461.04559088290796, 372.5126812681942, 298.4738270318079, 327.00216690284907, 176.04159992390035, 189.41370985941967, 290.4861249095757, 203.50058794973918, 429.9999234602154, 443.4717000742503, 483.77801051967924, 457.79932686786026, 577.8718472665659, 549.667386819953, 462.6146518646878, 513.7011339525625, 455.90558016481873, 435.3611651563914, 341.6622204007621, 403.3301745479096, 454.0451573131965, 591.2556509914333, 376.93454101042727, 376.53808136955615, 104.15129157853588, 171.26298057665997, 415.08964328194514, 409.9433208586154, 338.44267479240904, 326.9779443727463, 271.25216341524646, 220.95823216947292, 534.2785058109052, 534.8693927429604, 280.85884972883434, 285.8569838432354, 327.72963236088793, 342.190665154659, 304.58994759500206, 275.9630218909253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.079347253381192, "mean_inference_ms": 6.0245710974143325, "mean_action_processing_ms": 0.8781627363012978, "mean_env_wait_ms": 0.7604611646631974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007197380065917969, "StateBufferConnector_ms": 0.005307316780090332, "ViewRequirementAgentConnector_ms": 0.10853695869445801}, "num_episodes": 23, "episode_return_max": 2207.99663123306, "episode_return_min": 469.0239158316132, "episode_return_mean": 1766.159319147616, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.3095386279075, "num_env_steps_trained_throughput_per_sec": 309.3095386279075, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 12790.947, "restore_workers_time_ms": 0.016, "training_step_time_ms": 12790.902, "sample_time_ms": 2276.252, "learn_time_ms": 10489.839, "learn_throughput": 381.321, "synch_weights_time_ms": 23.74}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "8abce_00000", "date": "2024-08-16_12-22-17", "timestamp": 1723791137, "time_this_iter_s": 12.940263032913208, "time_total_s": 3645.4061076641083, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a28820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3645.4061076641083, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 41.85555555555556, "ram_util_percent": 74.08888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0295180245682047, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.540648880711307, "policy_loss": 0.002308595735732486, "vf_loss": 9.537452306192389, "vf_explained_var": 0.02150840954805808, "kl": 0.01183972516088934, "entropy": 0.6846490460413474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.657953980107787, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.367818265743356, "policy_loss": -0.0010191827874492716, "vf_loss": 9.36883356306288, "vf_explained_var": 0.0596025410152617, "kl": 0.009917872474154115, "entropy": 0.8857618391829193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 2207.99663123306, "episode_reward_min": 886.4043725901532, "episode_reward_mean": 1788.8088719275295, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 235.54296758894094, "predator_policy": 41.84717774331475}, "policy_reward_max": {"prey_policy": 887.665035355998, "predator_policy": 632.1244389221507}, "policy_reward_mean": {"prey_policy": 536.6546076845834, "predator_policy": 357.7498282791814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1989.4239478780414, 1279.6968250168752, 886.4043725901532, 1730.4409200605298, 1987.042018128025, 1501.6131428164945, 2042.4899207873166, 2109.6691077422524, 1464.723112897752, 2188.5294785763926, 1517.027658188105, 1645.7280266740684, 1809.6047151806179, 1805.952811608663, 2117.590670118885, 1904.6322476483438, 1752.6627866464582, 1870.5417872085864, 1718.338334973089, 1891.168905169877, 1677.318235704445, 1757.7506470029043, 1756.015483479339, 1606.6980520424322, 2175.592467055335, 2038.3578890503522, 1896.25052781351, 1444.4960964039728, 2060.2178937250997, 1827.8556780193371, 1448.3433301576708, 1964.5340461797216, 1484.2321568666891, 1993.7579214586906, 2022.259145687996, 1898.520071132871, 1638.7815646478318, 1660.3784292026178, 1557.3789128640979, 1959.7873332550678, 2027.1756300840327, 1653.9526517346842, 1880.910422703823, 1287.6827389248735, 1852.6938247003498, 1927.5987784251522, 2090.246080235921, 1781.4405043779352, 1649.5340713844114, 1468.7790470315274, 1867.6558118796236, 1408.3122791640592, 1540.6021995813946, 1987.4245013487516, 1964.408267021277, 1907.6811807799595, 1977.6601799250154, 2138.1961931746323, 1481.401032433276, 1682.5725156621315, 1559.7810289933645, 1875.974450200092, 2053.9954185579572, 1909.9945603685871, 1547.0412073795646, 1710.7766824142134, 1883.443548437584, 2005.3591620682892, 1960.760647876571, 1994.7925121814756, 1818.4639068452595, 1683.2405696606666, 2207.99663123306, 1840.3344442850453, 1369.0883325293032, 1916.3501855612603, 1997.136218988859, 1467.317674490316, 1979.6519756553419, 1792.8666826529038, 1841.0573435158185, 1917.1345359346674, 1852.372961429332, 1754.8831137694424, 992.6954722707459, 2033.5671629194967, 1890.524028479482, 1939.2183397631943, 1551.7820148993483, 1742.7698181835358, 2149.544552235044, 1745.8722848722007, 1944.3562079345015, 1910.9403529322244, 1752.5312762255705, 1788.6392107037798, 1845.4498003552205, 1500.3681458586861, 1956.2427454421193, 1538.8374024154916], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [543.7668331349112, 565.5695661598777, 741.3744566455731, 253.626931601813, 411.01091205623567, 283.5351527138543, 416.47224456100236, 629.3109857213776, 594.2067381323452, 500.1358219509915, 455.27219766799175, 567.5921669262507, 505.7306022047086, 493.7181552763831, 801.8041091942581, 584.8052049903525, 406.42973495744536, 391.7513317094128, 434.26175578097195, 714.6036420133278, 641.1534622347407, 773.6522449648822, 281.66274024063466, 437.7861736956982, 481.4087765795874, 447.20266384330654, 512.8505677980478, 616.4785550459424, 632.1589839665171, 470.20313866922754, 570.9689705249261, 524.49207625517, 394.0423955398736, 500.75108846055616, 452.73431335744004, 631.4727852216269, 554.2544287849795, 569.8959036954016, 494.6742651909321, 505.0271377757501, 679.4920083576765, 566.4896438068843, 553.2131504363243, 558.596181255996, 535.4915132194778, 406.86310468823166, 429.0352475558779, 483.5430030784643, 635.6117729517546, 346.10794712180154, 581.8485915690771, 705.9541195227846, 341.74208284256713, 536.1963266463442, 598.8278643723543, 447.7767327300851, 516.0940466906496, 586.2203565093605, 424.2789460308887, 485.01490083372727, 484.53736209513414, 275.4816436010742, 663.7954124885844, 513.6925373924354, 600.285996854423, 243.0552675693588, 504.2268348505978, 630.2547437480404, 580.440847652765, 521.6667346509004, 436.944306358148, 450.55543827882684, 565.1423286489755, 569.2097813432664, 412.2059504151149, 569.6703525989836, 562.0869286410605, 498.21753393327737, 462.934856739905, 543.783551121718, 486.69526662812723, 624.9170860310935, 394.16039727767355, 569.392220946303, 624.9911190413598, 640.4778930210679, 411.971097639888, 537.9453267763909, 310.3201740511609, 537.8537839015709, 423.95262594826363, 557.1633236029002, 683.8070497647642, 588.9372306805249, 365.15710564847654, 441.5423218324995, 540.8614422570892, 518.7597085855039, 484.5578668400116, 503.59412567186877, 744.5362472282037, 601.6920548421529, 369.2430743417988, 383.02342245206387, 331.428341757964, 553.7157865706035, 590.356839332518, 371.9773593133396, 719.9087037268516, 600.3902836061709, 688.2403574820103, 600.3980866617322, 528.9278836676075, 662.9446736077568, 531.0665157705325, 406.2307856361673, 490.7003424377781, 557.9498073532694, 469.9782722781633, 497.40614532728495, 481.841796673442, 486.68041687427865, 534.3320618476317, 461.94531289549997, 790.7791425623184, 429.65800384453814, 652.0810317788112, 632.4375346551207, 616.4539118918027, 565.1319857044396, 549.6350026035201, 667.1549669513812, 520.501910327631, 489.4700145754857, 535.7860543442083, 527.9957703365384, 422.1182762006294, 411.1031375894216, 574.3013385739247, 444.17538779029786, 490.60571668948006, 436.5914448345709, 399.89687641398064, 538.3512982980136, 797.433588847442, 365.2622340809875, 549.7748986917401, 537.0869232133236, 657.6288408074305, 436.0452195666782, 685.238720240089, 406.0785011806089, 736.6760400369874, 595.0395597867172, 429.4558946679018, 545.6513842376958, 530.7195836340675, 379.7844934674065, 548.3908679133364, 677.7599811674963, 502.9441887637292, 668.192857236542, 570.0120373038807, 766.5695291448545, 887.665035355998, 479.54138225525196, 612.4218599210614, 701.1109326847911, 428.24426310399315, 447.7113604936616, 517.6822875953839, 505.7253484733535, 702.3439913555878, 640.5271648126873, 438.5428975894519, 564.5633150851471, 564.5254558593493, 235.54296758894094, 523.2446264605088, 789.7486736938228, 556.5766132918495, 875.6277865902457, 556.6048390400977, 600.4981612997159, 734.0695388014402, 447.0032488926662, 506.8918087341371, 810.7596923406775, 522.6883976551312, 696.3631804284186, 536.6578932379314, 660.709972046235, 638.834398019051, 378.6142682225926, 512.5625138208547, 397.18026758168594, 572.7544745826876, 697.8428214989038, 623.3194887077113, 679.8395575620218], "policy_predator_policy_reward": [410.5090513539876, 469.5784972292642, 155.6351278320471, 129.06030893744068, 92.04170809927088, 99.81659972079247, 350.6619048311911, 333.9957849469586, 391.2871904975464, 501.4122675471419, 227.04916697444895, 251.69961124779994, 510.5189153713164, 532.5222479349109, 329.26753442042, 393.7922591372172, 367.96521189603897, 298.576834334854, 498.74731484099163, 540.9167659411017, 41.84717774331475, 60.37477324516769, 497.5782531545224, 428.7008595832128, 467.32044424331207, 413.6728305144058, 351.13667211353794, 325.4870166511368, 489.26188025757733, 525.9666672255636, 365.6951884134497, 443.476012454801, 459.4786808027448, 398.390621843289, 477.8865921639872, 308.4480964655359, 323.3237971845244, 270.86420530818543, 482.9083528771522, 408.5591493260434, 194.70671096781854, 236.62987257206498, 316.59473106299004, 329.34658424759294, 397.11168801788614, 416.54917755374396, 349.15586100117304, 344.963940406918, 561.7483080596267, 632.1244389221507, 365.01468611110886, 385.5404918473841, 524.6380288267399, 493.67408949786085, 221.40301388702343, 176.48848541451233, 456.9591653445054, 500.94432518058323, 460.3369750716808, 458.22485608304095, 296.587449977197, 391.73687448426836, 374.8927963824644, 412.1532999162384, 313.0259705407291, 327.8649219021812, 420.1791387075836, 439.09720415247295, 442.39763767290543, 477.75392571142504, 519.5918843808587, 491.4284421150392, 251.40175521816136, 253.02769943743002, 346.40795744215046, 332.0941687463698, 266.859828739709, 230.2146215500519, 504.0442812277156, 449.02464416572957, 472.6176460855497, 442.94563133925874, 399.8647690005418, 290.535264510163, 334.0675792807361, 281.37383136065927, 193.4319784772778, 144.33433603131533, 493.3117556856464, 511.20811106197107, 485.73984562024395, 460.7429832537427, 392.214969118673, 425.28683067195277, 493.36842592886615, 481.37265096808864, 277.6661683843862, 312.24675215743224, 238.89687780361297, 241.73017671603645, 274.1635905335538, 247.26391927571248, 334.151613209758, 321.8941691604379, 304.964548612716, 350.4935226401088, 490.95092700225115, 534.1393757006418, 311.08731866717375, 333.021961021073, 299.5592331767722, 319.48350345944704, 358.13460852499406, 427.6530141246593, 593.809781579831, 607.0891101881036, 182.7257921757533, 250.02509046647708, 373.936993216588, 341.2511048400949, 273.91975062367413, 317.33906482197295, 454.3119312314974, 425.3851442254628, 461.04559088290796, 372.5126812681942, 298.4738270318079, 327.00216690284907, 176.04159992390035, 189.41370985941967, 290.4861249095757, 203.50058794973918, 429.9999234602154, 443.4717000742503, 483.77801051967924, 457.79932686786026, 577.8718472665659, 549.667386819953, 462.6146518646878, 513.7011339525625, 455.90558016481873, 435.3611651563914, 341.6622204007621, 403.3301745479096, 454.0451573131965, 591.2556509914333, 376.93454101042727, 376.53808136955615, 104.15129157853588, 171.26298057665997, 415.08964328194514, 409.9433208586154, 338.44267479240904, 326.9779443727463, 271.25216341524646, 220.95823216947292, 534.2785058109052, 534.8693927429604, 280.85884972883434, 285.8569838432354, 327.72963236088793, 342.190665154659, 304.58994759500206, 275.9630218909253, 227.5112656190664, 257.6552781990174, 194.89992955628213, 246.45039160730866, 57.23365579074128, 59.5061928823492, 500.7669632941485, 509.392563556608, 330.0671084845306, 217.58576382667366, 429.8628277545182, 506.2492993340752, 388.6109617876683, 363.1026296633915, 236.5538463217671, 193.22267170743447, 390.9865325897222, 326.3536197632281, 301.7847855490614, 286.98449898332524, 380.99815593758785, 382.2852643028034, 289.72313042318683, 303.5657214342256, 279.6104789736047, 253.86921916841456, 286.82424270783866, 304.44710271177667, 372.04218936416044, 455.9589447494169, 296.5414762454067, 294.0838882107384, 358.0844290497352, 327.5610203107891, 88.39510230025647, 147.2832538455059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0699180189836905, "mean_inference_ms": 5.994657191383178, "mean_action_processing_ms": 0.8733087572138905, "mean_env_wait_ms": 0.7566918763711082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006853461265563965, "StateBufferConnector_ms": 0.005337715148925781, "ViewRequirementAgentConnector_ms": 0.10995781421661377}, "num_episodes": 18, "episode_return_max": 2207.99663123306, "episode_return_min": 886.4043725901532, "episode_return_mean": 1788.8088719275295, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 62.72425093760556, "num_env_steps_trained_throughput_per_sec": 62.72425093760556, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 17775.891, "restore_workers_time_ms": 0.016, "training_step_time_ms": 17775.847, "sample_time_ms": 2219.439, "learn_time_ms": 15536.652, "learn_throughput": 257.456, "synch_weights_time_ms": 18.665}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "8abce_00000", "date": "2024-08-16_12-23-21", "timestamp": 1723791201, "time_this_iter_s": 63.811774015426636, "time_total_s": 3709.217881679535, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a679d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3709.217881679535, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 50.06842105263158, "ram_util_percent": 75.50526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.266340593970011, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.392666292947435, "policy_loss": 0.0009662275117570682, "vf_loss": 9.39069881439209, "vf_explained_var": -0.002728589312740104, "kl": 0.013350188645169726, "entropy": 0.6551919231654475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9942932467927377, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.412857908925051, "policy_loss": -0.002185961813912308, "vf_loss": 9.415038246578641, "vf_explained_var": 0.017573172390145598, "kl": 0.014384675041950241, "entropy": 0.746161280517225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 2207.99663123306, "episode_reward_min": 992.6954722707459, "episode_reward_mean": 1781.2233499939653, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 235.54296758894094, "predator_policy": 12.549090780408822}, "policy_reward_max": {"prey_policy": 887.665035355998, "predator_policy": 632.1244389221507}, "policy_reward_mean": {"prey_policy": 546.1394204054483, "predator_policy": 344.47225459153407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1756.015483479339, 1606.6980520424322, 2175.592467055335, 2038.3578890503522, 1896.25052781351, 1444.4960964039728, 2060.2178937250997, 1827.8556780193371, 1448.3433301576708, 1964.5340461797216, 1484.2321568666891, 1993.7579214586906, 2022.259145687996, 1898.520071132871, 1638.7815646478318, 1660.3784292026178, 1557.3789128640979, 1959.7873332550678, 2027.1756300840327, 1653.9526517346842, 1880.910422703823, 1287.6827389248735, 1852.6938247003498, 1927.5987784251522, 2090.246080235921, 1781.4405043779352, 1649.5340713844114, 1468.7790470315274, 1867.6558118796236, 1408.3122791640592, 1540.6021995813946, 1987.4245013487516, 1964.408267021277, 1907.6811807799595, 1977.6601799250154, 2138.1961931746323, 1481.401032433276, 1682.5725156621315, 1559.7810289933645, 1875.974450200092, 2053.9954185579572, 1909.9945603685871, 1547.0412073795646, 1710.7766824142134, 1883.443548437584, 2005.3591620682892, 1960.760647876571, 1994.7925121814756, 1818.4639068452595, 1683.2405696606666, 2207.99663123306, 1840.3344442850453, 1369.0883325293032, 1916.3501855612603, 1997.136218988859, 1467.317674490316, 1979.6519756553419, 1792.8666826529038, 1841.0573435158185, 1917.1345359346674, 1852.372961429332, 1754.8831137694424, 992.6954722707459, 2033.5671629194967, 1890.524028479482, 1939.2183397631943, 1551.7820148993483, 1742.7698181835358, 2149.544552235044, 1745.8722848722007, 1944.3562079345015, 1910.9403529322244, 1752.5312762255705, 1788.6392107037798, 1845.4498003552205, 1500.3681458586861, 1956.2427454421193, 1538.8374024154916, 1431.5946194968046, 1319.5313704654316, 1455.5767904782174, 1599.304813824865, 2016.2115213954962, 1928.9730991462845, 1416.327217404866, 1406.3667599586904, 2058.4656297977904, 1689.197379349977, 1797.5028459210248, 1936.2959796399025, 1603.1728609606714, 1737.2975777355005, 2047.1274149911235, 1440.7841102734492, 2029.833870177995, 2011.8869521534873, 2046.0552261458065, 1844.6382882230898, 1238.0381374372812, 1835.6150142836548], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [535.4915132194778, 406.86310468823166, 429.0352475558779, 483.5430030784643, 635.6117729517546, 346.10794712180154, 581.8485915690771, 705.9541195227846, 341.74208284256713, 536.1963266463442, 598.8278643723543, 447.7767327300851, 516.0940466906496, 586.2203565093605, 424.2789460308887, 485.01490083372727, 484.53736209513414, 275.4816436010742, 663.7954124885844, 513.6925373924354, 600.285996854423, 243.0552675693588, 504.2268348505978, 630.2547437480404, 580.440847652765, 521.6667346509004, 436.944306358148, 450.55543827882684, 565.1423286489755, 569.2097813432664, 412.2059504151149, 569.6703525989836, 562.0869286410605, 498.21753393327737, 462.934856739905, 543.783551121718, 486.69526662812723, 624.9170860310935, 394.16039727767355, 569.392220946303, 624.9911190413598, 640.4778930210679, 411.971097639888, 537.9453267763909, 310.3201740511609, 537.8537839015709, 423.95262594826363, 557.1633236029002, 683.8070497647642, 588.9372306805249, 365.15710564847654, 441.5423218324995, 540.8614422570892, 518.7597085855039, 484.5578668400116, 503.59412567186877, 744.5362472282037, 601.6920548421529, 369.2430743417988, 383.02342245206387, 331.428341757964, 553.7157865706035, 590.356839332518, 371.9773593133396, 719.9087037268516, 600.3902836061709, 688.2403574820103, 600.3980866617322, 528.9278836676075, 662.9446736077568, 531.0665157705325, 406.2307856361673, 490.7003424377781, 557.9498073532694, 469.9782722781633, 497.40614532728495, 481.841796673442, 486.68041687427865, 534.3320618476317, 461.94531289549997, 790.7791425623184, 429.65800384453814, 652.0810317788112, 632.4375346551207, 616.4539118918027, 565.1319857044396, 549.6350026035201, 667.1549669513812, 520.501910327631, 489.4700145754857, 535.7860543442083, 527.9957703365384, 422.1182762006294, 411.1031375894216, 574.3013385739247, 444.17538779029786, 490.60571668948006, 436.5914448345709, 399.89687641398064, 538.3512982980136, 797.433588847442, 365.2622340809875, 549.7748986917401, 537.0869232133236, 657.6288408074305, 436.0452195666782, 685.238720240089, 406.0785011806089, 736.6760400369874, 595.0395597867172, 429.4558946679018, 545.6513842376958, 530.7195836340675, 379.7844934674065, 548.3908679133364, 677.7599811674963, 502.9441887637292, 668.192857236542, 570.0120373038807, 766.5695291448545, 887.665035355998, 479.54138225525196, 612.4218599210614, 701.1109326847911, 428.24426310399315, 447.7113604936616, 517.6822875953839, 505.7253484733535, 702.3439913555878, 640.5271648126873, 438.5428975894519, 564.5633150851471, 564.5254558593493, 235.54296758894094, 523.2446264605088, 789.7486736938228, 556.5766132918495, 875.6277865902457, 556.6048390400977, 600.4981612997159, 734.0695388014402, 447.0032488926662, 506.8918087341371, 810.7596923406775, 522.6883976551312, 696.3631804284186, 536.6578932379314, 660.709972046235, 638.834398019051, 378.6142682225926, 512.5625138208547, 397.18026758168594, 572.7544745826876, 697.8428214989038, 623.3194887077113, 679.8395575620218, 479.1204123577741, 424.5668434412816, 670.7006852258743, 336.91820412874534, 530.6907921574922, 551.2087300015451, 606.3732908747219, 511.14297994089947, 741.1944094536806, 676.7147800985108, 420.35625948410427, 481.07489353389275, 776.9791799352435, 327.64448137146417, 452.4076524686931, 483.03637407647875, 602.7969262505096, 526.7537814921892, 366.1497228810996, 554.8820953876486, 647.402988904617, 801.3325122585051, 445.127833866132, 723.9804709052759, 628.3408459540412, 818.7664816334428, 711.2736329818974, 776.2867739442037, 681.4364943750987, 734.7003094215884, 446.7366272715629, 388.38712665902256, 816.3488613936414, 612.2101602591326, 630.0408536010694, 483.27613082743244, 475.8131807311096, 753.5954685820518, 425.3604742144713, 491.22767993173926, 342.989460724216, 584.0370857301161, 476.9579958646592, 626.2607986773161], "policy_predator_policy_reward": [397.11168801788614, 416.54917755374396, 349.15586100117304, 344.963940406918, 561.7483080596267, 632.1244389221507, 365.01468611110886, 385.5404918473841, 524.6380288267399, 493.67408949786085, 221.40301388702343, 176.48848541451233, 456.9591653445054, 500.94432518058323, 460.3369750716808, 458.22485608304095, 296.587449977197, 391.73687448426836, 374.8927963824644, 412.1532999162384, 313.0259705407291, 327.8649219021812, 420.1791387075836, 439.09720415247295, 442.39763767290543, 477.75392571142504, 519.5918843808587, 491.4284421150392, 251.40175521816136, 253.02769943743002, 346.40795744215046, 332.0941687463698, 266.859828739709, 230.2146215500519, 504.0442812277156, 449.02464416572957, 472.6176460855497, 442.94563133925874, 399.8647690005418, 290.535264510163, 334.0675792807361, 281.37383136065927, 193.4319784772778, 144.33433603131533, 493.3117556856464, 511.20811106197107, 485.73984562024395, 460.7429832537427, 392.214969118673, 425.28683067195277, 493.36842592886615, 481.37265096808864, 277.6661683843862, 312.24675215743224, 238.89687780361297, 241.73017671603645, 274.1635905335538, 247.26391927571248, 334.151613209758, 321.8941691604379, 304.964548612716, 350.4935226401088, 490.95092700225115, 534.1393757006418, 311.08731866717375, 333.021961021073, 299.5592331767722, 319.48350345944704, 358.13460852499406, 427.6530141246593, 593.809781579831, 607.0891101881036, 182.7257921757533, 250.02509046647708, 373.936993216588, 341.2511048400949, 273.91975062367413, 317.33906482197295, 454.3119312314974, 425.3851442254628, 461.04559088290796, 372.5126812681942, 298.4738270318079, 327.00216690284907, 176.04159992390035, 189.41370985941967, 290.4861249095757, 203.50058794973918, 429.9999234602154, 443.4717000742503, 483.77801051967924, 457.79932686786026, 577.8718472665659, 549.667386819953, 462.6146518646878, 513.7011339525625, 455.90558016481873, 435.3611651563914, 341.6622204007621, 403.3301745479096, 454.0451573131965, 591.2556509914333, 376.93454101042727, 376.53808136955615, 104.15129157853588, 171.26298057665997, 415.08964328194514, 409.9433208586154, 338.44267479240904, 326.9779443727463, 271.25216341524646, 220.95823216947292, 534.2785058109052, 534.8693927429604, 280.85884972883434, 285.8569838432354, 327.72963236088793, 342.190665154659, 304.58994759500206, 275.9630218909253, 227.5112656190664, 257.6552781990174, 194.89992955628213, 246.45039160730866, 57.23365579074128, 59.5061928823492, 500.7669632941485, 509.392563556608, 330.0671084845306, 217.58576382667366, 429.8628277545182, 506.2492993340752, 388.6109617876683, 363.1026296633915, 236.5538463217671, 193.22267170743447, 390.9865325897222, 326.3536197632281, 301.7847855490614, 286.98449898332524, 380.99815593758785, 382.2852643028034, 289.72313042318683, 303.5657214342256, 279.6104789736047, 253.86921916841456, 286.82424270783866, 304.44710271177667, 372.04218936416044, 455.9589447494169, 296.5414762454067, 294.0838882107384, 358.0844290497352, 327.5610203107891, 88.39510230025647, 147.2832538455059, 270.99424417822394, 256.9131195195235, 184.47864095352028, 127.43384015729518, 201.47537387409253, 172.20189444508597, 231.41593175496845, 250.37261125427779, 330.1837535950315, 268.1185782482721, 483.95273181771955, 543.5892143105674, 153.27601076415553, 158.427545334004, 230.1099412350712, 240.8127921784447, 451.5077053794261, 477.40721667566913, 388.14385053289845, 380.0217105483288, 192.55979907850002, 156.20754567940702, 408.99116042938573, 358.1965144391124, 143.51644259277705, 12.549090780408822, 105.6059836549507, 144.1311871544451, 332.4584205564423, 298.53219063799446, 282.5201529616259, 323.14020338123674, 285.93368814917807, 315.3411603760474, 435.35288753843724, 463.217080186546, 389.3789597598002, 427.2676170728448, 483.97512879061327, 444.075005286266, 161.27231544306403, 149.73927553988517, 356.62114121936503, 375.77507852231474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0581594497025377, "mean_inference_ms": 5.964723294483036, "mean_action_processing_ms": 0.8680605465525193, "mean_env_wait_ms": 0.7523869602108902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006752967834472656, "StateBufferConnector_ms": 0.0032755136489868164, "ViewRequirementAgentConnector_ms": 0.11513006687164307}, "num_episodes": 22, "episode_return_max": 2207.99663123306, "episode_return_min": 992.6954722707459, "episode_return_mean": 1781.2233499939653, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.23529603311187, "num_env_steps_trained_throughput_per_sec": 266.23529603311187, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 18017.93, "restore_workers_time_ms": 0.016, "training_step_time_ms": 18017.887, "sample_time_ms": 2259.87, "learn_time_ms": 15739.78, "learn_throughput": 254.133, "synch_weights_time_ms": 17.162}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "8abce_00000", "date": "2024-08-16_12-23-36", "timestamp": 1723791216, "time_this_iter_s": 15.052561283111572, "time_total_s": 3724.2704429626465, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4870430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3724.2704429626465, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 61.50454545454545, "ram_util_percent": 79.03181818181817}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.746804982896835, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.363213524490437, "policy_loss": -0.0006989031837927917, "vf_loss": 9.363498438981475, "vf_explained_var": 0.00946817158391236, "kl": 0.005519893506718869, "entropy": 0.6340488735960905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2030641214242057, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.45910301359873, "policy_loss": 0.0007732767828557857, "vf_loss": 9.458323591726797, "vf_explained_var": -0.019806425092081543, "kl": 0.01572189384521042, "entropy": 0.7120337840110537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 2207.99663123306, "episode_reward_min": 992.6954722707459, "episode_reward_mean": 1781.0196775066738, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 199.81585939157858, "predator_policy": 12.549090780408822}, "policy_reward_max": {"prey_policy": 887.665035355998, "predator_policy": 607.0891101881036}, "policy_reward_mean": {"prey_policy": 552.0198416013674, "predator_policy": 338.48999715196953}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2027.1756300840327, 1653.9526517346842, 1880.910422703823, 1287.6827389248735, 1852.6938247003498, 1927.5987784251522, 2090.246080235921, 1781.4405043779352, 1649.5340713844114, 1468.7790470315274, 1867.6558118796236, 1408.3122791640592, 1540.6021995813946, 1987.4245013487516, 1964.408267021277, 1907.6811807799595, 1977.6601799250154, 2138.1961931746323, 1481.401032433276, 1682.5725156621315, 1559.7810289933645, 1875.974450200092, 2053.9954185579572, 1909.9945603685871, 1547.0412073795646, 1710.7766824142134, 1883.443548437584, 2005.3591620682892, 1960.760647876571, 1994.7925121814756, 1818.4639068452595, 1683.2405696606666, 2207.99663123306, 1840.3344442850453, 1369.0883325293032, 1916.3501855612603, 1997.136218988859, 1467.317674490316, 1979.6519756553419, 1792.8666826529038, 1841.0573435158185, 1917.1345359346674, 1852.372961429332, 1754.8831137694424, 992.6954722707459, 2033.5671629194967, 1890.524028479482, 1939.2183397631943, 1551.7820148993483, 1742.7698181835358, 2149.544552235044, 1745.8722848722007, 1944.3562079345015, 1910.9403529322244, 1752.5312762255705, 1788.6392107037798, 1845.4498003552205, 1500.3681458586861, 1956.2427454421193, 1538.8374024154916, 1431.5946194968046, 1319.5313704654316, 1455.5767904782174, 1599.304813824865, 2016.2115213954962, 1928.9730991462845, 1416.327217404866, 1406.3667599586904, 2058.4656297977904, 1689.197379349977, 1797.5028459210248, 1936.2959796399025, 1603.1728609606714, 1737.2975777355005, 2047.1274149911235, 1440.7841102734492, 2029.833870177995, 2011.8869521534873, 2046.0552261458065, 1844.6382882230898, 1238.0381374372812, 1835.6150142836548, 1085.178947680522, 1904.195059336595, 2162.3814330192185, 1823.9505331950577, 1875.1072220173396, 1992.1165730163111, 2047.627444201572, 1123.0140965038763, 1964.5080709653744, 1559.5786881975698, 2017.730381888953, 1417.627002396395, 1638.2341361498482, 1905.8259041484625, 2019.1276135100743, 2133.338632440177, 2107.7965324139705, 1635.751479232252], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [486.69526662812723, 624.9170860310935, 394.16039727767355, 569.392220946303, 624.9911190413598, 640.4778930210679, 411.971097639888, 537.9453267763909, 310.3201740511609, 537.8537839015709, 423.95262594826363, 557.1633236029002, 683.8070497647642, 588.9372306805249, 365.15710564847654, 441.5423218324995, 540.8614422570892, 518.7597085855039, 484.5578668400116, 503.59412567186877, 744.5362472282037, 601.6920548421529, 369.2430743417988, 383.02342245206387, 331.428341757964, 553.7157865706035, 590.356839332518, 371.9773593133396, 719.9087037268516, 600.3902836061709, 688.2403574820103, 600.3980866617322, 528.9278836676075, 662.9446736077568, 531.0665157705325, 406.2307856361673, 490.7003424377781, 557.9498073532694, 469.9782722781633, 497.40614532728495, 481.841796673442, 486.68041687427865, 534.3320618476317, 461.94531289549997, 790.7791425623184, 429.65800384453814, 652.0810317788112, 632.4375346551207, 616.4539118918027, 565.1319857044396, 549.6350026035201, 667.1549669513812, 520.501910327631, 489.4700145754857, 535.7860543442083, 527.9957703365384, 422.1182762006294, 411.1031375894216, 574.3013385739247, 444.17538779029786, 490.60571668948006, 436.5914448345709, 399.89687641398064, 538.3512982980136, 797.433588847442, 365.2622340809875, 549.7748986917401, 537.0869232133236, 657.6288408074305, 436.0452195666782, 685.238720240089, 406.0785011806089, 736.6760400369874, 595.0395597867172, 429.4558946679018, 545.6513842376958, 530.7195836340675, 379.7844934674065, 548.3908679133364, 677.7599811674963, 502.9441887637292, 668.192857236542, 570.0120373038807, 766.5695291448545, 887.665035355998, 479.54138225525196, 612.4218599210614, 701.1109326847911, 428.24426310399315, 447.7113604936616, 517.6822875953839, 505.7253484733535, 702.3439913555878, 640.5271648126873, 438.5428975894519, 564.5633150851471, 564.5254558593493, 235.54296758894094, 523.2446264605088, 789.7486736938228, 556.5766132918495, 875.6277865902457, 556.6048390400977, 600.4981612997159, 734.0695388014402, 447.0032488926662, 506.8918087341371, 810.7596923406775, 522.6883976551312, 696.3631804284186, 536.6578932379314, 660.709972046235, 638.834398019051, 378.6142682225926, 512.5625138208547, 397.18026758168594, 572.7544745826876, 697.8428214989038, 623.3194887077113, 679.8395575620218, 479.1204123577741, 424.5668434412816, 670.7006852258743, 336.91820412874534, 530.6907921574922, 551.2087300015451, 606.3732908747219, 511.14297994089947, 741.1944094536806, 676.7147800985108, 420.35625948410427, 481.07489353389275, 776.9791799352435, 327.64448137146417, 452.4076524686931, 483.03637407647875, 602.7969262505096, 526.7537814921892, 366.1497228810996, 554.8820953876486, 647.402988904617, 801.3325122585051, 445.127833866132, 723.9804709052759, 628.3408459540412, 818.7664816334428, 711.2736329818974, 776.2867739442037, 681.4364943750987, 734.7003094215884, 446.7366272715629, 388.38712665902256, 816.3488613936414, 612.2101602591326, 630.0408536010694, 483.27613082743244, 475.8131807311096, 753.5954685820518, 425.3604742144713, 491.22767993173926, 342.989460724216, 584.0370857301161, 476.9579958646592, 626.2607986773161, 345.28090830567345, 356.33270990517826, 624.0673963603577, 620.893374583593, 499.30244118624967, 599.0876767654548, 662.3106113667311, 610.6740060854061, 684.238038776169, 516.8871908211325, 371.37423069334625, 477.0768600762086, 624.1466727309265, 381.13530928210037, 451.1116220091744, 199.81585939157858, 531.1162765854414, 563.7137308310037, 337.3838596079016, 563.1756800786259, 625.123436900875, 572.5106285673539, 709.1791161793301, 365.5537781561243, 614.7574401201185, 419.8683250534612, 578.446189648602, 617.6085527707684, 745.1004549307743, 626.135361068949, 627.4384570058813, 452.3746117140568, 762.75147277999, 532.268754524861, 404.805661773299, 651.8325078931518], "policy_predator_policy_reward": [472.6176460855497, 442.94563133925874, 399.8647690005418, 290.535264510163, 334.0675792807361, 281.37383136065927, 193.4319784772778, 144.33433603131533, 493.3117556856464, 511.20811106197107, 485.73984562024395, 460.7429832537427, 392.214969118673, 425.28683067195277, 493.36842592886615, 481.37265096808864, 277.6661683843862, 312.24675215743224, 238.89687780361297, 241.73017671603645, 274.1635905335538, 247.26391927571248, 334.151613209758, 321.8941691604379, 304.964548612716, 350.4935226401088, 490.95092700225115, 534.1393757006418, 311.08731866717375, 333.021961021073, 299.5592331767722, 319.48350345944704, 358.13460852499406, 427.6530141246593, 593.809781579831, 607.0891101881036, 182.7257921757533, 250.02509046647708, 373.936993216588, 341.2511048400949, 273.91975062367413, 317.33906482197295, 454.3119312314974, 425.3851442254628, 461.04559088290796, 372.5126812681942, 298.4738270318079, 327.00216690284907, 176.04159992390035, 189.41370985941967, 290.4861249095757, 203.50058794973918, 429.9999234602154, 443.4717000742503, 483.77801051967924, 457.79932686786026, 577.8718472665659, 549.667386819953, 462.6146518646878, 513.7011339525625, 455.90558016481873, 435.3611651563914, 341.6622204007621, 403.3301745479096, 454.0451573131965, 591.2556509914333, 376.93454101042727, 376.53808136955615, 104.15129157853588, 171.26298057665997, 415.08964328194514, 409.9433208586154, 338.44267479240904, 326.9779443727463, 271.25216341524646, 220.95823216947292, 534.2785058109052, 534.8693927429604, 280.85884972883434, 285.8569838432354, 327.72963236088793, 342.190665154659, 304.58994759500206, 275.9630218909253, 227.5112656190664, 257.6552781990174, 194.89992955628213, 246.45039160730866, 57.23365579074128, 59.5061928823492, 500.7669632941485, 509.392563556608, 330.0671084845306, 217.58576382667366, 429.8628277545182, 506.2492993340752, 388.6109617876683, 363.1026296633915, 236.5538463217671, 193.22267170743447, 390.9865325897222, 326.3536197632281, 301.7847855490614, 286.98449898332524, 380.99815593758785, 382.2852643028034, 289.72313042318683, 303.5657214342256, 279.6104789736047, 253.86921916841456, 286.82424270783866, 304.44710271177667, 372.04218936416044, 455.9589447494169, 296.5414762454067, 294.0838882107384, 358.0844290497352, 327.5610203107891, 88.39510230025647, 147.2832538455059, 270.99424417822394, 256.9131195195235, 184.47864095352028, 127.43384015729518, 201.47537387409253, 172.20189444508597, 231.41593175496845, 250.37261125427779, 330.1837535950315, 268.1185782482721, 483.95273181771955, 543.5892143105674, 153.27601076415553, 158.427545334004, 230.1099412350712, 240.8127921784447, 451.5077053794261, 477.40721667566913, 388.14385053289845, 380.0217105483288, 192.55979907850002, 156.20754567940702, 408.99116042938573, 358.1965144391124, 143.51644259277705, 12.549090780408822, 105.6059836549507, 144.1311871544451, 332.4584205564423, 298.53219063799446, 282.5201529616259, 323.14020338123674, 285.93368814917807, 315.3411603760474, 435.35288753843724, 463.217080186546, 389.3789597598002, 427.2676170728448, 483.97512879061327, 444.075005286266, 161.27231544306403, 149.73927553988517, 356.62114121936503, 375.77507852231474, 220.42150438524322, 163.1438250844282, 318.69054181811737, 340.5437465745263, 562.0089735681705, 501.9823414993456, 271.78810970742194, 279.1778060354982, 303.6138827284469, 370.36810969158876, 561.5788867958996, 582.0865954508498, 512.4668296794207, 529.8786325091195, 247.5198959766652, 224.56671912645825, 404.75911544823373, 464.9189481006969, 361.1430767722714, 297.8760717387716, 396.9206261826156, 423.17569023810694, 217.74490910127528, 125.14919895966742, 293.56981912269185, 310.03855185357406, 368.67616091566964, 341.09500081342105, 281.2341513379064, 366.65764617244156, 509.1646442506127, 544.3609194696239, 445.345390692246, 367.4309144168763, 283.04647621378524, 296.0668333520165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.04801433041827, "mean_inference_ms": 5.930996610926554, "mean_action_processing_ms": 0.8635115885896021, "mean_env_wait_ms": 0.7487904882048306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00496828556060791, "StateBufferConnector_ms": 0.00325167179107666, "ViewRequirementAgentConnector_ms": 0.11818099021911621}, "num_episodes": 18, "episode_return_max": 2207.99663123306, "episode_return_min": 992.6954722707459, "episode_return_mean": 1781.0196775066738, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.44384256619713, "num_env_steps_trained_throughput_per_sec": 310.44384256619713, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 18090.752, "restore_workers_time_ms": 0.021, "training_step_time_ms": 18090.669, "sample_time_ms": 2217.459, "learn_time_ms": 15854.988, "learn_throughput": 252.287, "synch_weights_time_ms": 17.157}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "8abce_00000", "date": "2024-08-16_12-23-49", "timestamp": 1723791229, "time_this_iter_s": 12.891438007354736, "time_total_s": 3737.161880970001, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4a28820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3737.161880970001, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 46.86666666666667, "ram_util_percent": 77.02777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3500666748909724, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.490917861777008, "policy_loss": -0.0035238328531492875, "vf_loss": 9.49397285299957, "vf_explained_var": -0.012977871472242648, "kl": 0.006251217326012275, "entropy": 0.5915797324407668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.926530394068471, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.37415608199185, "policy_loss": -0.0021947858724546024, "vf_loss": 9.376348502043063, "vf_explained_var": -0.032033355873097816, "kl": 0.006153941213168164, "entropy": 0.7185563781904796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 2332.702379268544, "episode_reward_min": 992.6954722707459, "episode_reward_mean": 1802.121638160841, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 99.7333456935152, "predator_policy": 12.549090780408822}, "policy_reward_max": {"prey_policy": 887.665035355998, "predator_policy": 622.0487728690854}, "policy_reward_mean": {"prey_policy": 562.3114239360885, "predator_policy": 338.7493951443318}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1909.9945603685871, 1547.0412073795646, 1710.7766824142134, 1883.443548437584, 2005.3591620682892, 1960.760647876571, 1994.7925121814756, 1818.4639068452595, 1683.2405696606666, 2207.99663123306, 1840.3344442850453, 1369.0883325293032, 1916.3501855612603, 1997.136218988859, 1467.317674490316, 1979.6519756553419, 1792.8666826529038, 1841.0573435158185, 1917.1345359346674, 1852.372961429332, 1754.8831137694424, 992.6954722707459, 2033.5671629194967, 1890.524028479482, 1939.2183397631943, 1551.7820148993483, 1742.7698181835358, 2149.544552235044, 1745.8722848722007, 1944.3562079345015, 1910.9403529322244, 1752.5312762255705, 1788.6392107037798, 1845.4498003552205, 1500.3681458586861, 1956.2427454421193, 1538.8374024154916, 1431.5946194968046, 1319.5313704654316, 1455.5767904782174, 1599.304813824865, 2016.2115213954962, 1928.9730991462845, 1416.327217404866, 1406.3667599586904, 2058.4656297977904, 1689.197379349977, 1797.5028459210248, 1936.2959796399025, 1603.1728609606714, 1737.2975777355005, 2047.1274149911235, 1440.7841102734492, 2029.833870177995, 2011.8869521534873, 2046.0552261458065, 1844.6382882230898, 1238.0381374372812, 1835.6150142836548, 1085.178947680522, 1904.195059336595, 2162.3814330192185, 1823.9505331950577, 1875.1072220173396, 1992.1165730163111, 2047.627444201572, 1123.0140965038763, 1964.5080709653744, 1559.5786881975698, 2017.730381888953, 1417.627002396395, 1638.2341361498482, 1905.8259041484625, 2019.1276135100743, 2133.338632440177, 2107.7965324139705, 1635.751479232252, 2180.566642986014, 1294.2779707451452, 1890.91342785418, 1898.4269533900938, 2243.5816339536073, 2187.1131915818137, 1938.5260606156714, 2017.1856359316039, 1644.1284011428586, 1814.2972493664226, 1791.638322052778, 2332.702379268544, 1962.1298433153167, 1953.0559713630787, 2219.686797701247, 2001.7397782443684, 1754.5634440239464, 1935.5333597773426, 1216.3452782552476, 1540.9838718448477, 1472.3117087142302, 1970.8903634766755, 1915.2765881358691], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [652.0810317788112, 632.4375346551207, 616.4539118918027, 565.1319857044396, 549.6350026035201, 667.1549669513812, 520.501910327631, 489.4700145754857, 535.7860543442083, 527.9957703365384, 422.1182762006294, 411.1031375894216, 574.3013385739247, 444.17538779029786, 490.60571668948006, 436.5914448345709, 399.89687641398064, 538.3512982980136, 797.433588847442, 365.2622340809875, 549.7748986917401, 537.0869232133236, 657.6288408074305, 436.0452195666782, 685.238720240089, 406.0785011806089, 736.6760400369874, 595.0395597867172, 429.4558946679018, 545.6513842376958, 530.7195836340675, 379.7844934674065, 548.3908679133364, 677.7599811674963, 502.9441887637292, 668.192857236542, 570.0120373038807, 766.5695291448545, 887.665035355998, 479.54138225525196, 612.4218599210614, 701.1109326847911, 428.24426310399315, 447.7113604936616, 517.6822875953839, 505.7253484733535, 702.3439913555878, 640.5271648126873, 438.5428975894519, 564.5633150851471, 564.5254558593493, 235.54296758894094, 523.2446264605088, 789.7486736938228, 556.5766132918495, 875.6277865902457, 556.6048390400977, 600.4981612997159, 734.0695388014402, 447.0032488926662, 506.8918087341371, 810.7596923406775, 522.6883976551312, 696.3631804284186, 536.6578932379314, 660.709972046235, 638.834398019051, 378.6142682225926, 512.5625138208547, 397.18026758168594, 572.7544745826876, 697.8428214989038, 623.3194887077113, 679.8395575620218, 479.1204123577741, 424.5668434412816, 670.7006852258743, 336.91820412874534, 530.6907921574922, 551.2087300015451, 606.3732908747219, 511.14297994089947, 741.1944094536806, 676.7147800985108, 420.35625948410427, 481.07489353389275, 776.9791799352435, 327.64448137146417, 452.4076524686931, 483.03637407647875, 602.7969262505096, 526.7537814921892, 366.1497228810996, 554.8820953876486, 647.402988904617, 801.3325122585051, 445.127833866132, 723.9804709052759, 628.3408459540412, 818.7664816334428, 711.2736329818974, 776.2867739442037, 681.4364943750987, 734.7003094215884, 446.7366272715629, 388.38712665902256, 816.3488613936414, 612.2101602591326, 630.0408536010694, 483.27613082743244, 475.8131807311096, 753.5954685820518, 425.3604742144713, 491.22767993173926, 342.989460724216, 584.0370857301161, 476.9579958646592, 626.2607986773161, 345.28090830567345, 356.33270990517826, 624.0673963603577, 620.893374583593, 499.30244118624967, 599.0876767654548, 662.3106113667311, 610.6740060854061, 684.238038776169, 516.8871908211325, 371.37423069334625, 477.0768600762086, 624.1466727309265, 381.13530928210037, 451.1116220091744, 199.81585939157858, 531.1162765854414, 563.7137308310037, 337.3838596079016, 563.1756800786259, 625.123436900875, 572.5106285673539, 709.1791161793301, 365.5537781561243, 614.7574401201185, 419.8683250534612, 578.446189648602, 617.6085527707684, 745.1004549307743, 626.135361068949, 627.4384570058813, 452.3746117140568, 762.75147277999, 532.268754524861, 404.805661773299, 651.8325078931518, 569.6870396079319, 469.79260932561544, 757.8537942867613, 199.3432792763962, 604.9545679762721, 589.8485175529634, 661.0177794141023, 511.25116786829744, 488.8718679016418, 781.6311191372362, 511.93361193832976, 795.1058462531879, 523.2762328153345, 575.1192552850548, 670.478282387519, 497.0939645387249, 427.3479800124316, 497.6394632596488, 492.2749931300552, 696.9734638456931, 513.2966324328698, 762.1674770242371, 801.6712456993251, 320.9385117698302, 617.5502106365107, 575.5628865092148, 442.2562517320949, 778.4215251986421, 520.3389156648601, 736.2946079041824, 430.35729846542597, 512.9587156666956, 481.88227580170127, 646.5473587700665, 643.158274125225, 532.1956456150567, 700.9024919430212, 99.7333456935152, 375.78860962233443, 614.2665449383575, 529.1478259924955, 794.2351835160484, 658.6553181177933, 492.50283110612907, 674.1294625281135, 614.2710688955087], "policy_predator_policy_reward": [298.4738270318079, 327.00216690284907, 176.04159992390035, 189.41370985941967, 290.4861249095757, 203.50058794973918, 429.9999234602154, 443.4717000742503, 483.77801051967924, 457.79932686786026, 577.8718472665659, 549.667386819953, 462.6146518646878, 513.7011339525625, 455.90558016481873, 435.3611651563914, 341.6622204007621, 403.3301745479096, 454.0451573131965, 591.2556509914333, 376.93454101042727, 376.53808136955615, 104.15129157853588, 171.26298057665997, 415.08964328194514, 409.9433208586154, 338.44267479240904, 326.9779443727463, 271.25216341524646, 220.95823216947292, 534.2785058109052, 534.8693927429604, 280.85884972883434, 285.8569838432354, 327.72963236088793, 342.190665154659, 304.58994759500206, 275.9630218909253, 227.5112656190664, 257.6552781990174, 194.89992955628213, 246.45039160730866, 57.23365579074128, 59.5061928823492, 500.7669632941485, 509.392563556608, 330.0671084845306, 217.58576382667366, 429.8628277545182, 506.2492993340752, 388.6109617876683, 363.1026296633915, 236.5538463217671, 193.22267170743447, 390.9865325897222, 326.3536197632281, 301.7847855490614, 286.98449898332524, 380.99815593758785, 382.2852643028034, 289.72313042318683, 303.5657214342256, 279.6104789736047, 253.86921916841456, 286.82424270783866, 304.44710271177667, 372.04218936416044, 455.9589447494169, 296.5414762454067, 294.0838882107384, 358.0844290497352, 327.5610203107891, 88.39510230025647, 147.2832538455059, 270.99424417822394, 256.9131195195235, 184.47864095352028, 127.43384015729518, 201.47537387409253, 172.20189444508597, 231.41593175496845, 250.37261125427779, 330.1837535950315, 268.1185782482721, 483.95273181771955, 543.5892143105674, 153.27601076415553, 158.427545334004, 230.1099412350712, 240.8127921784447, 451.5077053794261, 477.40721667566913, 388.14385053289845, 380.0217105483288, 192.55979907850002, 156.20754567940702, 408.99116042938573, 358.1965144391124, 143.51644259277705, 12.549090780408822, 105.6059836549507, 144.1311871544451, 332.4584205564423, 298.53219063799446, 282.5201529616259, 323.14020338123674, 285.93368814917807, 315.3411603760474, 435.35288753843724, 463.217080186546, 389.3789597598002, 427.2676170728448, 483.97512879061327, 444.075005286266, 161.27231544306403, 149.73927553988517, 356.62114121936503, 375.77507852231474, 220.42150438524322, 163.1438250844282, 318.69054181811737, 340.5437465745263, 562.0089735681705, 501.9823414993456, 271.78810970742194, 279.1778060354982, 303.6138827284469, 370.36810969158876, 561.5788867958996, 582.0865954508498, 512.4668296794207, 529.8786325091195, 247.5198959766652, 224.56671912645825, 404.75911544823373, 464.9189481006969, 361.1430767722714, 297.8760717387716, 396.9206261826156, 423.17569023810694, 217.74490910127528, 125.14919895966742, 293.56981912269185, 310.03855185357406, 368.67616091566964, 341.09500081342105, 281.2341513379064, 366.65764617244156, 509.1646442506127, 544.3609194696239, 445.345390692246, 367.4309144168763, 283.04647621378524, 296.0668333520165, 572.4724013340311, 568.6145927184391, 157.3312480798611, 179.74964910212765, 396.94221949285213, 299.1681228320947, 284.5295923391669, 441.6284137685265, 492.825352812083, 480.2532941026482, 461.4520161570702, 418.6217172332233, 458.19197486755434, 381.93859764772645, 514.6748936024903, 334.9384954028694, 360.59331965788107, 358.54763821289396, 338.8626093482039, 286.18618304246945, 298.4632942639755, 217.7109183316961, 588.043848930306, 622.0487728690854, 386.17012439812186, 382.8466217714697, 352.13949991592756, 380.2386945164063, 457.21132957863466, 505.84194455357385, 544.9379667532332, 513.485797359015, 332.415029169219, 293.71878028295765, 417.36602874371766, 342.8134112933433, 201.47846766908756, 214.23097294962824, 182.31616025446397, 368.6125570296926, 45.2639070486379, 103.66479215705066, 428.74116699738835, 390.99104725536307, 344.13626600086263, 282.73979071138797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0334270190734407, "mean_inference_ms": 5.894630282157028, "mean_action_processing_ms": 0.85716271325725, "mean_env_wait_ms": 0.7434136193185769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047149658203125, "StateBufferConnector_ms": 0.0034563541412353516, "ViewRequirementAgentConnector_ms": 0.11590826511383057}, "num_episodes": 23, "episode_return_max": 2332.702379268544, "episode_return_min": 992.6954722707459, "episode_return_mean": 1802.121638160841, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.6054638403183, "num_env_steps_trained_throughput_per_sec": 304.6054638403183, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 18134.194, "restore_workers_time_ms": 0.022, "training_step_time_ms": 18134.111, "sample_time_ms": 2131.756, "learn_time_ms": 15984.103, "learn_throughput": 250.249, "synch_weights_time_ms": 17.28}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "8abce_00000", "date": "2024-08-16_12-24-02", "timestamp": 1723791242, "time_this_iter_s": 13.136540174484253, "time_total_s": 3750.2984211444855, "pid": 23731, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a48704c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3750.2984211444855, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 49.757894736842104, "ram_util_percent": 76.73157894736842}}
