{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8639857843912467, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.043832963610452, "policy_loss": -0.01109614829882664, "vf_loss": 6.05333933552737, "vf_explained_var": 0.01912498221826301, "kl": 0.007948895839964429, "entropy": 1.6036428942251457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1077527689870703, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.323855379397276, "policy_loss": -0.010329483923497338, "vf_loss": 7.332858660359862, "vf_explained_var": 0.023239030976774832, "kl": 0.006631010991555673, "entropy": 1.6038017797722388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 140.59795994207275, "num_env_steps_trained_throughput_per_sec": 140.59795994207275, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 28449.931, "restore_workers_time_ms": 0.049, "training_step_time_ms": 28449.731, "sample_time_ms": 4207.574, "learn_time_ms": 24224.663, "learn_throughput": 165.121, "synch_weights_time_ms": 14.967}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-35-09", "timestamp": 1724382309, "time_this_iter_s": 28.52290105819702, "time_total_s": 28.52290105819702, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32efdb1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.52290105819702, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.995238095238086, "ram_util_percent": 83.5142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.827754389703589, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.7635661135274896, "policy_loss": -0.008739534262370653, "vf_loss": 3.771183138045054, "vf_explained_var": 0.09231704095053295, "kl": 0.005612477219156014, "entropy": 1.598556724301091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5681521420756344, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.107978426211726, "policy_loss": -0.012478110219829927, "vf_loss": 6.119096246345964, "vf_explained_var": 0.14747507811854124, "kl": 0.006801534416190984, "entropy": 1.5959194935188092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.9588845151171, "num_env_steps_trained_throughput_per_sec": 149.9588845151171, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 27561.959, "restore_workers_time_ms": 0.033, "training_step_time_ms": 27561.757, "sample_time_ms": 3467.138, "learn_time_ms": 24068.396, "learn_throughput": 166.193, "synch_weights_time_ms": 21.967}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-35-38", "timestamp": 1724382338, "time_this_iter_s": 26.722364902496338, "time_total_s": 55.24526596069336, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32efa0790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.24526596069336, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.18048780487805, "ram_util_percent": 83.33414634146341}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.494315483078124, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.2275132383619036, "policy_loss": -0.013614579742508275, "vf_loss": 3.2396989393486546, "vf_explained_var": 0.10537979419899995, "kl": 0.007144443530998336, "entropy": 1.593452823982037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2403357103388144, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.82834580991634, "policy_loss": -0.01624586708010938, "vf_loss": 5.842989083446523, "vf_explained_var": 0.20221314077024108, "kl": 0.008012961716607961, "entropy": 1.5859928055415078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.0584031580513, "num_env_steps_trained_throughput_per_sec": 153.0584031580513, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 27085.92, "restore_workers_time_ms": 0.033, "training_step_time_ms": 27085.678, "sample_time_ms": 3118.745, "learn_time_ms": 23937.693, "learn_throughput": 167.1, "synch_weights_time_ms": 22.195}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-36-04", "timestamp": 1724382364, "time_this_iter_s": 26.19620704650879, "time_total_s": 81.44147300720215, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b086c4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81.44147300720215, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 38.03783783783784, "ram_util_percent": 83.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6403710734907282, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.084578364488309, "policy_loss": -0.013742602360804403, "vf_loss": 2.0968481025998553, "vf_explained_var": 0.1414505915036277, "kl": 0.007364333648155763, "entropy": 1.592077678347391, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.846671427999224, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.738451374397076, "policy_loss": -0.012500299029446469, "vf_loss": 5.7490835855877584, "vf_explained_var": 0.25857651202136245, "kl": 0.009340423088589752, "entropy": 1.5695880992071969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.76930729317618, "num_env_steps_trained_throughput_per_sec": 144.76930729317618, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 27222.012, "restore_workers_time_ms": 0.038, "training_step_time_ms": 27221.776, "sample_time_ms": 2973.082, "learn_time_ms": 24221.779, "learn_throughput": 165.141, "synch_weights_time_ms": 20.646}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-36-32", "timestamp": 1724382392, "time_this_iter_s": 27.693344831466675, "time_total_s": 109.13481783866882, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b086c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 109.13481783866882, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 43.907500000000006, "ram_util_percent": 83.39000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.002379789301958, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.259961563569528, "policy_loss": -0.013359362813865855, "vf_loss": 2.2719226279586713, "vf_explained_var": 0.14960957109612763, "kl": 0.006991552378706358, "entropy": 1.5843820916281806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4253.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.957405758093274, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.504781571140995, "policy_loss": -0.013034391477728686, "vf_loss": 6.516002211495051, "vf_explained_var": 0.3869747658255239, "kl": 0.009068788456232853, "entropy": 1.5579224158847143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4253.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 132.59511385748496, "num_env_steps_trained_throughput_per_sec": 132.59511385748496, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 27811.018, "restore_workers_time_ms": 0.038, "training_step_time_ms": 27810.448, "sample_time_ms": 3533.74, "learn_time_ms": 24248.448, "learn_throughput": 164.959, "synch_weights_time_ms": 21.166}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-37-02", "timestamp": 1724382422, "time_this_iter_s": 30.203529834747314, "time_total_s": 139.33834767341614, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08995e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 139.33834767341614, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 43.82093023255814, "ram_util_percent": 83.43488372093024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.389670498913558, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.121805246040304, "policy_loss": -0.013540929754969304, "vf_loss": 2.1336683978479374, "vf_explained_var": 0.211055854956309, "kl": 0.008388845754107312, "entropy": 1.5774453782530689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 5198.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.094184404075461, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.468803788745214, "policy_loss": -0.015610404723082427, "vf_loss": 6.482354132334391, "vf_explained_var": 0.4076432988126442, "kl": 0.010300279044541259, "entropy": 1.5447006549784745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 5198.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.38505694433945, "num_env_steps_trained_throughput_per_sec": 149.38505694433945, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 27638.595, "restore_workers_time_ms": 0.038, "training_step_time_ms": 27638.101, "sample_time_ms": 3367.92, "learn_time_ms": 24243.005, "learn_throughput": 164.996, "synch_weights_time_ms": 20.793}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-37-29", "timestamp": 1724382449, "time_this_iter_s": 26.833755016326904, "time_total_s": 166.17210268974304, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b084c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166.17210268974304, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 38.88947368421052, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.167877221548999, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.3080975899620664, "policy_loss": -0.01847512806819939, "vf_loss": 2.3241968284839043, "vf_explained_var": 0.22473085254588454, "kl": 0.011879397956063114, "entropy": 1.5531608729135422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6143.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999983}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.475680813965974, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.158511970661305, "policy_loss": -0.017203108049318117, "vf_loss": 7.173770951467847, "vf_explained_var": 0.40846235342126674, "kl": 0.009720528001832977, "entropy": 1.547647398237198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6143.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999983}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.5210098006256, "num_env_steps_trained_throughput_per_sec": 147.5210098006256, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 27563.766, "restore_workers_time_ms": 0.035, "training_step_time_ms": 27563.326, "sample_time_ms": 3223.937, "learn_time_ms": 24309.283, "learn_throughput": 164.546, "synch_weights_time_ms": 23.877}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-37-56", "timestamp": 1724382476, "time_this_iter_s": 27.160505056381226, "time_total_s": 193.33260774612427, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309563700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 193.33260774612427, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.97368421052631, "ram_util_percent": 83.23421052631582}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5056123959955086, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.357797844952376, "policy_loss": -0.015779200999963064, "vf_loss": 2.371623641977865, "vf_explained_var": 0.21134552558263142, "kl": 0.009766994423366019, "entropy": 1.5484370828305603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 7088.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.535960273894053, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.962003416737551, "policy_loss": -0.015661477513867553, "vf_loss": 6.975380283436447, "vf_explained_var": 0.47026025927256027, "kl": 0.011423054261123219, "entropy": 1.5373804613395974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 7088.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 634.0325013153707, "episode_reward_min": 93.96172044806806, "episode_reward_mean": 276.91955891625304, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -425.25021554310564, "predator_policy": 1.0426371339015965}, "policy_reward_max": {"prey_policy": 380.85736286609836, "predator_policy": 499.4930819051261}, "policy_reward_mean": {"prey_policy": -24.853065954867855, "predator_policy": 163.31284541299433}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.4000000000003, 148.833446149194, 130.3000000000005, 213.78901592903168, 109.73298130890088, 417.2000000000026, 318.599999999999, 293.7595391126457, 634.0325013153707, 271.8999999999994, 226.5714753114902, 98.1999999999984, 386.63477867275, 93.96172044806806, 218.19999999999914, 515.9, 289.43660224510506, 289.0999999999991], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.69088231930537, 140.78051794146594, -42.468472586944536, 64.21685333392657, -34.16640160979733, 75.54568383217125, -410.96827885132143, -69.5005877256011, -45.80012555469375, -425.25021554310564, -39.32242890605268, 380.85736286609836, -324.97071174497194, 115.03283477644823, 88.01519717801422, -383.71184128131347, 317.62493003027373, -0.7709904549057809, -33.36618122102561, 8.485817038584692, -335.2184128331362, -61.06380951777206, -133.49636743846037, -30.364369943254616, 140.90640048784508, -12.762622064545345, -216.7762134798771, -44.97789153141262, -54.10148197024916, 91.46693834380072, -19.912187077461454, 216.61721279183826, 23.021032651649065, 117.72615176964946, 20.49636486729004, -15.224963267701426], "policy_predator_policy_reward": [130.71308001665687, 18.21551972257204, 63.59369428093628, 63.49137112127544, 19.159602508114126, 69.76111526951183, 245.29668128432002, 448.9612012216343, 380.9994049343671, 199.78391747233135, 74.62242890605297, 1.0426371339015965, 302.2165741093457, 226.3213028591773, 89.96310131081965, 499.4930819051261, 6.081072730868625, 311.09748900913434, 267.7661812210257, 29.01418296141537, 415.7601581881278, 207.09353947426982, 145.80611625359708, 116.25462112811674, 219.4419833387226, 39.04901691072721, 96.11531850290649, 259.6005069564515, 113.80148197024806, 67.03306165619948, 246.01218707746125, 73.18278720816171, 101.88154124813505, 46.807876575673305, 125.68579269743898, 158.14280570297151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.158649400187459, "mean_inference_ms": 5.43213696315405, "mean_action_processing_ms": 3.143514916534202, "mean_env_wait_ms": 12.224599930772431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033206409878200954, "StateBufferConnector_ms": 0.0034199820624457467, "ViewRequirementAgentConnector_ms": 0.10415381855434841}, "num_episodes": 18, "episode_return_max": 634.0325013153707, "episode_return_min": 93.96172044806806, "episode_return_mean": 276.91955891625304, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.871628736412, "num_env_steps_trained_throughput_per_sec": 147.871628736412, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 27499.612, "restore_workers_time_ms": 0.035, "training_step_time_ms": 27499.201, "sample_time_ms": 3121.785, "learn_time_ms": 24346.426, "learn_throughput": 164.295, "synch_weights_time_ms": 24.972}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-38-24", "timestamp": 1724382504, "time_this_iter_s": 27.13768196105957, "time_total_s": 220.47028970718384, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30955c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 220.47028970718384, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 48.36666666666667, "ram_util_percent": 83.1871794871795}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.559752647523527, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.463774510035439, "policy_loss": -0.01735453491527883, "vf_loss": 3.479132053334877, "vf_explained_var": 0.2443063324721402, "kl": 0.009985007042627014, "entropy": 1.5212046246049264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8033.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.411755871394323, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.227159964849078, "policy_loss": -0.018898597003143065, "vf_loss": 7.243186353249524, "vf_explained_var": 0.5853692973101581, "kl": 0.014361202268905584, "entropy": 1.505849457039404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8033.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 714.0206386300276, "episode_reward_min": 56.000000000000526, "episode_reward_mean": 354.45713783053816, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 26000, "policy_reward_min": {"prey_policy": -593.0070310402167, "predator_policy": 1.0426371339015965}, "policy_reward_max": {"prey_policy": 380.85736286609836, "predator_policy": 603.3070310402176}, "policy_reward_mean": {"prey_policy": 19.87520160765946, "predator_policy": 157.3533673076096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.4000000000003, 148.833446149194, 130.3000000000005, 213.78901592903168, 109.73298130890088, 417.2000000000026, 318.599999999999, 293.7595391126457, 634.0325013153707, 271.8999999999994, 226.5714753114902, 98.1999999999984, 386.63477867275, 93.96172044806806, 218.19999999999914, 515.9, 289.43660224510506, 289.0999999999991, 239.4999999999991, 400.1935280656641, 294.30000000000007, 323.4, 511.2334734184982, 272.9641052640102, 366.45266581554597, 486.57951728830767, 646.2790373332451, 331.3911085841402, 244.8999999999995, 377.49999999999943, 357.3000000000017, 214.59999999999914, 592.6220663279468, 599.6715920388606, 269.3344136151678, 56.000000000000526, 390.1648871849786, 260.44455273064415, 484.5999999999995, 107.73321818039892, 352.0999999999998, 84.79999999999944, 294.8720869026316, 247.59017164540865, 191.12411785656477, 407.20667569517104, 351.1000000000006, 244.5999999999991, 563.4000000000001, 220.50000000000006, 632.2153029034961, 555.6999999999994, 478.30000000000007, 601.0000000000006, 242.39999999999918, 259.09999999999894, 421.33139789385496, 449.0606389297601, 599.2999999999996, 586.7994403891755, 600.6124850282097, 347.1531403958925, 714.0206386300276, 333.1, 450.6116363748256], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.69088231930537, 140.78051794146594, -42.468472586944536, 64.21685333392657, -34.16640160979733, 75.54568383217125, -410.96827885132143, -69.5005877256011, -45.80012555469375, -425.25021554310564, -39.32242890605268, 380.85736286609836, -324.97071174497194, 115.03283477644823, 88.01519717801422, -383.71184128131347, 317.62493003027373, -0.7709904549057809, -33.36618122102561, 8.485817038584692, -335.2184128331362, -61.06380951777206, -133.49636743846037, -30.364369943254616, 140.90640048784508, -12.762622064545345, -216.7762134798771, -44.97789153141262, -54.10148197024916, 91.46693834380072, -19.912187077461454, 216.61721279183826, 23.021032651649065, 117.72615176964946, 20.49636486729004, -15.224963267701426, -100.44654325033889, -69.45441521303749, -13.36274036061012, 73.68026922563593, 13.428929881609145, 113.24875932313121, -131.59163836778623, -6.712689736635619, 185.21787403401405, 135.72386862728, 93.53829844636158, -394.6962273176611, 165.17806012955648, -16.836221633191087, 78.39205963667852, 113.7350088265266, 363.9999999999999, 129.70466589374294, 206.93165579863003, -286.99614017531906, -41.61143531149918, 114.24682653415351, -593.0070310402167, 362.7925063032074, 206.7736330586893, -128.02564620816852, -37.54317563071206, -87.9537685035863, 106.1442790711348, 238.83575612935286, 187.170323691838, 288.26450172810337, -375.0456995367797, 176.53697659666307, -413.4882520466868, 15.60985505649737, -327.89389815277815, 305.98390390738774, -418.34714488593266, -150.59547267469335, 351.1913755241636, 75.32761475525129, -184.44152498634512, -37.49302712629794, -145.46209959157997, 189.03369820065927, -11.390212096559841, -60.72941126665835, 47.5428258539445, -20.58628167327778, -127.15476196545669, -116.83641574589973, 68.07170282968923, -127.21933856336133, 88.2780987051809, 222.20553416130923, 28.840534448090942, 215.5799238450069, -33.68535033393688, -73.97020862715269, 125.02974738981129, -46.21875944307425, 108.84969961817275, -421.7749780916572, 220.28997173908098, 201.19172264294113, 301.21291321519186, 40.748310650690755, 257.10233678253974, 69.2717976733122, 216.05677045317606, 231.5646056126689, 35.319594551296944, 52.48716402217958, -77.90886561716435, 199.67009546172255, 340.23094076453293, -549.0573773635375, -59.781915874029224, 291.1132855570572, 131.94477489948798, 160.45472630842556, 177.1651173918656, -11.418641142792453, 95.74754254971404, 324.54010280170036, 257.41416270499826, -43.349653554011965, 273.8548761572587, 324.9237365874373, 43.751714794924766, -358.70905898586955, 171.68684351614544, -33.54926860455498], "policy_predator_policy_reward": [130.71308001665687, 18.21551972257204, 63.59369428093628, 63.49137112127544, 19.159602508114126, 69.76111526951183, 245.29668128432002, 448.9612012216343, 380.9994049343671, 199.78391747233135, 74.62242890605297, 1.0426371339015965, 302.2165741093457, 226.3213028591773, 89.96310131081965, 499.4930819051261, 6.081072730868625, 311.09748900913434, 267.7661812210257, 29.01418296141537, 415.7601581881278, 207.09353947426982, 145.80611625359708, 116.25462112811674, 219.4419833387226, 39.04901691072721, 96.11531850290649, 259.6005069564515, 113.80148197024806, 67.03306165619948, 246.01218707746125, 73.18278720816171, 101.88154124813505, 46.807876575673305, 125.68579269743898, 158.14280570297151, 135.94654325033687, 273.4544152130367, 147.4655875217323, 192.41041167890364, 49.95133386039854, 117.6709769348606, 307.54103725278594, 154.16329085163477, 84.60286151967891, 105.6888692375258, 117.928004234372, 456.19402990094113, 180.51704013840396, 37.59378718077617, 73.97350292204902, 220.47894590305302, 70.57542450114468, 81.99894693835714, 287.1404208614362, 124.31517209939362, 77.81143531149912, 94.45317346584672, 603.3070310402176, 4.407493696792509, 120.22636694131064, 158.32564620816714, 156.27837996446831, 183.81856416982777, 190.15572092886526, 57.486310198593905, 19.260965221240674, 104.97580139767643, 335.48595211746067, 132.35718443782875, 427.24162559431306, 26.636771395878057, 111.80570796737526, 300.2691734629939, 408.58264591157007, 420.80452437970445, 5.108624475836292, 52.97238524474886, 287.137874016384, 42.52989627665654, 249.06209959157874, 59.46630179934089, 60.59021209656027, 96.32941126665771, 244.55099166462634, 23.364551057339337, 352.09681060895593, 139.484538747809, 84.26829606863068, 166.00345752160572, 85.43095144950415, 11.292091379177139, 10.159465551909182, 96.52007615499315, 89.62050042582922, 262.63505853526107, 203.7702526101887, 280.8187594430745, 111.34896841961368, 422.076310053872, 142.87835281078384, 67.85525571069013, 68.78708678480812, 144.9516893493083, 3.097663217460246, 148.82820232668732, 26.40950978047123, 126.96911415368378, 73.36269939711207, 81.23054202941151, 114.50631287595512, 22.83245727948486, 81.47223096200185, 548.685603530857, 128.74085843594474, 88.98841081078632, 157.18930790315324, 149.71119088893283, 148.86051149412052, 272.19245264598135, 104.28514636220606, 76.0396933145873, 68.49703085483164, 64.59160039007425, 7.09106997409692, 108.1509559112347, 136.04828520507508, 512.0090589858706, 236.7908261320644, 75.683235331171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.0024458656766, "mean_inference_ms": 5.361245893137632, "mean_action_processing_ms": 3.3256025299992045, "mean_env_wait_ms": 12.429678122933446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008635887732872596, "StateBufferConnector_ms": 0.005546533144437349, "ViewRequirementAgentConnector_ms": 0.14151554841261643}, "num_episodes": 47, "episode_return_max": 714.0206386300276, "episode_return_min": 56.000000000000526, "episode_return_mean": 354.45713783053816, "episodes_this_iter": 47}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.95954827878802, "num_env_steps_trained_throughput_per_sec": 144.95954827878802, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 27510.102, "restore_workers_time_ms": 0.063, "training_step_time_ms": 27509.689, "sample_time_ms": 3117.572, "learn_time_ms": 24362.48, "learn_throughput": 164.187, "synch_weights_time_ms": 23.937}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-38-51", "timestamp": 1724382531, "time_this_iter_s": 27.64117980003357, "time_total_s": 248.1114695072174, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30955caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 248.1114695072174, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 47.52307692307692, "ram_util_percent": 83.2974358974359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5496375553191655, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.9948159835956716, "policy_loss": -0.017459926599015792, "vf_loss": 4.009759660246511, "vf_explained_var": 0.16556086912356988, "kl": 0.012581261989990713, "entropy": 1.4892640991816446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8978.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.093731135161466, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.3775733034446755, "policy_loss": -0.019720151056116693, "vf_loss": 7.3942327004891855, "vf_explained_var": 0.5593084524548243, "kl": 0.015303765336376807, "entropy": 1.4684002716074545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8978.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 714.0206386300276, "episode_reward_min": 56.000000000000526, "episode_reward_mean": 362.1030784835431, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -593.0070310402167, "predator_policy": 1.0426371339015965}, "policy_reward_max": {"prey_policy": 380.85736286609836, "predator_policy": 603.3070310402176}, "policy_reward_mean": {"prey_policy": 27.95689660263613, "predator_policy": 153.09464263913543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.4000000000003, 148.833446149194, 130.3000000000005, 213.78901592903168, 109.73298130890088, 417.2000000000026, 318.599999999999, 293.7595391126457, 634.0325013153707, 271.8999999999994, 226.5714753114902, 98.1999999999984, 386.63477867275, 93.96172044806806, 218.19999999999914, 515.9, 289.43660224510506, 289.0999999999991, 239.4999999999991, 400.1935280656641, 294.30000000000007, 323.4, 511.2334734184982, 272.9641052640102, 366.45266581554597, 486.57951728830767, 646.2790373332451, 331.3911085841402, 244.8999999999995, 377.49999999999943, 357.3000000000017, 214.59999999999914, 592.6220663279468, 599.6715920388606, 269.3344136151678, 56.000000000000526, 390.1648871849786, 260.44455273064415, 484.5999999999995, 107.73321818039892, 352.0999999999998, 84.79999999999944, 294.8720869026316, 247.59017164540865, 191.12411785656477, 407.20667569517104, 351.1000000000006, 244.5999999999991, 563.4000000000001, 220.50000000000006, 632.2153029034961, 555.6999999999994, 478.30000000000007, 601.0000000000006, 242.39999999999918, 259.09999999999894, 421.33139789385496, 449.0606389297601, 599.2999999999996, 586.7994403891755, 600.6124850282097, 347.1531403958925, 714.0206386300276, 333.1, 450.6116363748256, 355.50818224750844, 241.79999999999927, 647.4000000000001, 362.99999999999943, 429.2058129125049, 247.84144829462713, 512.3000000000002, 583.919982835263, 274.7149252121372, 371.5000000000013, 549.7999999999997, 100.29999999999826, 191.8999999999966, 585.2, 443.0007085664735, 528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.69088231930537, 140.78051794146594, -42.468472586944536, 64.21685333392657, -34.16640160979733, 75.54568383217125, -410.96827885132143, -69.5005877256011, -45.80012555469375, -425.25021554310564, -39.32242890605268, 380.85736286609836, -324.97071174497194, 115.03283477644823, 88.01519717801422, -383.71184128131347, 317.62493003027373, -0.7709904549057809, -33.36618122102561, 8.485817038584692, -335.2184128331362, -61.06380951777206, -133.49636743846037, -30.364369943254616, 140.90640048784508, -12.762622064545345, -216.7762134798771, -44.97789153141262, -54.10148197024916, 91.46693834380072, -19.912187077461454, 216.61721279183826, 23.021032651649065, 117.72615176964946, 20.49636486729004, -15.224963267701426, -100.44654325033889, -69.45441521303749, -13.36274036061012, 73.68026922563593, 13.428929881609145, 113.24875932313121, -131.59163836778623, -6.712689736635619, 185.21787403401405, 135.72386862728, 93.53829844636158, -394.6962273176611, 165.17806012955648, -16.836221633191087, 78.39205963667852, 113.7350088265266, 363.9999999999999, 129.70466589374294, 206.93165579863003, -286.99614017531906, -41.61143531149918, 114.24682653415351, -593.0070310402167, 362.7925063032074, 206.7736330586893, -128.02564620816852, -37.54317563071206, -87.9537685035863, 106.1442790711348, 238.83575612935286, 187.170323691838, 288.26450172810337, -375.0456995367797, 176.53697659666307, -413.4882520466868, 15.60985505649737, -327.89389815277815, 305.98390390738774, -418.34714488593266, -150.59547267469335, 351.1913755241636, 75.32761475525129, -184.44152498634512, -37.49302712629794, -145.46209959157997, 189.03369820065927, -11.390212096559841, -60.72941126665835, 47.5428258539445, -20.58628167327778, -127.15476196545669, -116.83641574589973, 68.07170282968923, -127.21933856336133, 88.2780987051809, 222.20553416130923, 28.840534448090942, 215.5799238450069, -33.68535033393688, -73.97020862715269, 125.02974738981129, -46.21875944307425, 108.84969961817275, -421.7749780916572, 220.28997173908098, 201.19172264294113, 301.21291321519186, 40.748310650690755, 257.10233678253974, 69.2717976733122, 216.05677045317606, 231.5646056126689, 35.319594551296944, 52.48716402217958, -77.90886561716435, 199.67009546172255, 340.23094076453293, -549.0573773635375, -59.781915874029224, 291.1132855570572, 131.94477489948798, 160.45472630842556, 177.1651173918656, -11.418641142792453, 95.74754254971404, 324.54010280170036, 257.41416270499826, -43.349653554011965, 273.8548761572587, 324.9237365874373, 43.751714794924766, -358.70905898586955, 171.68684351614544, -33.54926860455498, -390.4810850397281, 4.520863995371393, 71.75708524203748, -55.257102628120094, 196.72770515950754, 300.6448538170445, 40.48069705942194, 181.67677799563873, 126.00046889005151, 0.15987637250162834, -177.693275715666, -108.94014708271868, 242.63882833703457, 245.02606726561433, 46.971971714924535, 311.3312580793634, -174.25811073195598, 61.165563843363046, 215.51296256037276, -31.20368460322735, 184.69125265238546, 275.2779736332838, 39.500928481261504, -305.4207462412372, -2.943055311186662, 92.71539769542797, 205.825147517939, 50.76493504546718, -267.45327225064335, 304.0610561897669, 90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301], "policy_predator_policy_reward": [130.71308001665687, 18.21551972257204, 63.59369428093628, 63.49137112127544, 19.159602508114126, 69.76111526951183, 245.29668128432002, 448.9612012216343, 380.9994049343671, 199.78391747233135, 74.62242890605297, 1.0426371339015965, 302.2165741093457, 226.3213028591773, 89.96310131081965, 499.4930819051261, 6.081072730868625, 311.09748900913434, 267.7661812210257, 29.01418296141537, 415.7601581881278, 207.09353947426982, 145.80611625359708, 116.25462112811674, 219.4419833387226, 39.04901691072721, 96.11531850290649, 259.6005069564515, 113.80148197024806, 67.03306165619948, 246.01218707746125, 73.18278720816171, 101.88154124813505, 46.807876575673305, 125.68579269743898, 158.14280570297151, 135.94654325033687, 273.4544152130367, 147.4655875217323, 192.41041167890364, 49.95133386039854, 117.6709769348606, 307.54103725278594, 154.16329085163477, 84.60286151967891, 105.6888692375258, 117.928004234372, 456.19402990094113, 180.51704013840396, 37.59378718077617, 73.97350292204902, 220.47894590305302, 70.57542450114468, 81.99894693835714, 287.1404208614362, 124.31517209939362, 77.81143531149912, 94.45317346584672, 603.3070310402176, 4.407493696792509, 120.22636694131064, 158.32564620816714, 156.27837996446831, 183.81856416982777, 190.15572092886526, 57.486310198593905, 19.260965221240674, 104.97580139767643, 335.48595211746067, 132.35718443782875, 427.24162559431306, 26.636771395878057, 111.80570796737526, 300.2691734629939, 408.58264591157007, 420.80452437970445, 5.108624475836292, 52.97238524474886, 287.137874016384, 42.52989627665654, 249.06209959157874, 59.46630179934089, 60.59021209656027, 96.32941126665771, 244.55099166462634, 23.364551057339337, 352.09681060895593, 139.484538747809, 84.26829606863068, 166.00345752160572, 85.43095144950415, 11.292091379177139, 10.159465551909182, 96.52007615499315, 89.62050042582922, 262.63505853526107, 203.7702526101887, 280.8187594430745, 111.34896841961368, 422.076310053872, 142.87835281078384, 67.85525571069013, 68.78708678480812, 144.9516893493083, 3.097663217460246, 148.82820232668732, 26.40950978047123, 126.96911415368378, 73.36269939711207, 81.23054202941151, 114.50631287595512, 22.83245727948486, 81.47223096200185, 548.685603530857, 128.74085843594474, 88.98841081078632, 157.18930790315324, 149.71119088893283, 148.86051149412052, 272.19245264598135, 104.28514636220606, 76.0396933145873, 68.49703085483164, 64.59160039007425, 7.09106997409692, 108.1509559112347, 136.04828520507508, 512.0090589858706, 236.7908261320644, 75.683235331171, 263.3957283346271, 478.0726749572387, 135.94291475796194, 89.35710262812012, 86.27229484049248, 63.75514618295546, 68.31930294057841, 72.52322200436127, 197.69029773733507, 105.35516991261662, 215.79277238051466, 318.6820987124964, 15.974521750058948, 8.6605826472921, 107.11014944364044, 118.50660359733423, 327.2422847133049, 60.56518738742654, 96.1072122084398, 91.08350983441537, 51.50874734761473, 38.32202636671628, 30.75883661474464, 335.46098114523534, 99.78631467229546, 2.341342943461918, 112.67485248206084, 215.9350649545327, 306.7770227835108, 99.61590184384039, 12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.010532939303557, "mean_inference_ms": 5.414778718375162, "mean_action_processing_ms": 3.1889482247631613, "mean_env_wait_ms": 12.48475680824165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077834394243028425, "StateBufferConnector_ms": 0.005393160714043511, "ViewRequirementAgentConnector_ms": 0.14027489556206596}, "num_episodes": 25, "episode_return_max": 714.0206386300276, "episode_return_min": 56.000000000000526, "episode_return_mean": 362.1030784835431, "episodes_this_iter": 25}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.11360672857424, "num_env_steps_trained_throughput_per_sec": 147.11360672857424, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 27478.08, "restore_workers_time_ms": 0.058, "training_step_time_ms": 27477.692, "sample_time_ms": 3059.531, "learn_time_ms": 24388.158, "learn_throughput": 164.014, "synch_weights_time_ms": 23.973}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-39-19", "timestamp": 1724382559, "time_this_iter_s": 27.240689754486084, "time_total_s": 275.3521592617035, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095635e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 275.3521592617035, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 40.96153846153845, "ram_util_percent": 83.27948717948718}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.500842142420471, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.3322218894958495, "policy_loss": -0.02222582103891505, "vf_loss": 3.3517027272118463, "vf_explained_var": 0.23183528399341322, "kl": 0.013724874036396464, "entropy": 1.460232965782206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 9923.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.15987829133947, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.081945954176484, "policy_loss": -0.016511924518518663, "vf_loss": 7.095817870185488, "vf_explained_var": 0.6418923568473291, "kl": 0.013200034410076797, "entropy": 1.4710599620506246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 9923.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 714.0206386300276, "episode_reward_min": 56.000000000000526, "episode_reward_mean": 362.1030784835431, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -593.0070310402167, "predator_policy": 1.0426371339015965}, "policy_reward_max": {"prey_policy": 380.85736286609836, "predator_policy": 603.3070310402176}, "policy_reward_mean": {"prey_policy": 27.95689660263613, "predator_policy": 153.09464263913543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.4000000000003, 148.833446149194, 130.3000000000005, 213.78901592903168, 109.73298130890088, 417.2000000000026, 318.599999999999, 293.7595391126457, 634.0325013153707, 271.8999999999994, 226.5714753114902, 98.1999999999984, 386.63477867275, 93.96172044806806, 218.19999999999914, 515.9, 289.43660224510506, 289.0999999999991, 239.4999999999991, 400.1935280656641, 294.30000000000007, 323.4, 511.2334734184982, 272.9641052640102, 366.45266581554597, 486.57951728830767, 646.2790373332451, 331.3911085841402, 244.8999999999995, 377.49999999999943, 357.3000000000017, 214.59999999999914, 592.6220663279468, 599.6715920388606, 269.3344136151678, 56.000000000000526, 390.1648871849786, 260.44455273064415, 484.5999999999995, 107.73321818039892, 352.0999999999998, 84.79999999999944, 294.8720869026316, 247.59017164540865, 191.12411785656477, 407.20667569517104, 351.1000000000006, 244.5999999999991, 563.4000000000001, 220.50000000000006, 632.2153029034961, 555.6999999999994, 478.30000000000007, 601.0000000000006, 242.39999999999918, 259.09999999999894, 421.33139789385496, 449.0606389297601, 599.2999999999996, 586.7994403891755, 600.6124850282097, 347.1531403958925, 714.0206386300276, 333.1, 450.6116363748256, 355.50818224750844, 241.79999999999927, 647.4000000000001, 362.99999999999943, 429.2058129125049, 247.84144829462713, 512.3000000000002, 583.919982835263, 274.7149252121372, 371.5000000000013, 549.7999999999997, 100.29999999999826, 191.8999999999966, 585.2, 443.0007085664735, 528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.69088231930537, 140.78051794146594, -42.468472586944536, 64.21685333392657, -34.16640160979733, 75.54568383217125, -410.96827885132143, -69.5005877256011, -45.80012555469375, -425.25021554310564, -39.32242890605268, 380.85736286609836, -324.97071174497194, 115.03283477644823, 88.01519717801422, -383.71184128131347, 317.62493003027373, -0.7709904549057809, -33.36618122102561, 8.485817038584692, -335.2184128331362, -61.06380951777206, -133.49636743846037, -30.364369943254616, 140.90640048784508, -12.762622064545345, -216.7762134798771, -44.97789153141262, -54.10148197024916, 91.46693834380072, -19.912187077461454, 216.61721279183826, 23.021032651649065, 117.72615176964946, 20.49636486729004, -15.224963267701426, -100.44654325033889, -69.45441521303749, -13.36274036061012, 73.68026922563593, 13.428929881609145, 113.24875932313121, -131.59163836778623, -6.712689736635619, 185.21787403401405, 135.72386862728, 93.53829844636158, -394.6962273176611, 165.17806012955648, -16.836221633191087, 78.39205963667852, 113.7350088265266, 363.9999999999999, 129.70466589374294, 206.93165579863003, -286.99614017531906, -41.61143531149918, 114.24682653415351, -593.0070310402167, 362.7925063032074, 206.7736330586893, -128.02564620816852, -37.54317563071206, -87.9537685035863, 106.1442790711348, 238.83575612935286, 187.170323691838, 288.26450172810337, -375.0456995367797, 176.53697659666307, -413.4882520466868, 15.60985505649737, -327.89389815277815, 305.98390390738774, -418.34714488593266, -150.59547267469335, 351.1913755241636, 75.32761475525129, -184.44152498634512, -37.49302712629794, -145.46209959157997, 189.03369820065927, -11.390212096559841, -60.72941126665835, 47.5428258539445, -20.58628167327778, -127.15476196545669, -116.83641574589973, 68.07170282968923, -127.21933856336133, 88.2780987051809, 222.20553416130923, 28.840534448090942, 215.5799238450069, -33.68535033393688, -73.97020862715269, 125.02974738981129, -46.21875944307425, 108.84969961817275, -421.7749780916572, 220.28997173908098, 201.19172264294113, 301.21291321519186, 40.748310650690755, 257.10233678253974, 69.2717976733122, 216.05677045317606, 231.5646056126689, 35.319594551296944, 52.48716402217958, -77.90886561716435, 199.67009546172255, 340.23094076453293, -549.0573773635375, -59.781915874029224, 291.1132855570572, 131.94477489948798, 160.45472630842556, 177.1651173918656, -11.418641142792453, 95.74754254971404, 324.54010280170036, 257.41416270499826, -43.349653554011965, 273.8548761572587, 324.9237365874373, 43.751714794924766, -358.70905898586955, 171.68684351614544, -33.54926860455498, -390.4810850397281, 4.520863995371393, 71.75708524203748, -55.257102628120094, 196.72770515950754, 300.6448538170445, 40.48069705942194, 181.67677799563873, 126.00046889005151, 0.15987637250162834, -177.693275715666, -108.94014708271868, 242.63882833703457, 245.02606726561433, 46.971971714924535, 311.3312580793634, -174.25811073195598, 61.165563843363046, 215.51296256037276, -31.20368460322735, 184.69125265238546, 275.2779736332838, 39.500928481261504, -305.4207462412372, -2.943055311186662, 92.71539769542797, 205.825147517939, 50.76493504546718, -267.45327225064335, 304.0610561897669, 90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301], "policy_predator_policy_reward": [130.71308001665687, 18.21551972257204, 63.59369428093628, 63.49137112127544, 19.159602508114126, 69.76111526951183, 245.29668128432002, 448.9612012216343, 380.9994049343671, 199.78391747233135, 74.62242890605297, 1.0426371339015965, 302.2165741093457, 226.3213028591773, 89.96310131081965, 499.4930819051261, 6.081072730868625, 311.09748900913434, 267.7661812210257, 29.01418296141537, 415.7601581881278, 207.09353947426982, 145.80611625359708, 116.25462112811674, 219.4419833387226, 39.04901691072721, 96.11531850290649, 259.6005069564515, 113.80148197024806, 67.03306165619948, 246.01218707746125, 73.18278720816171, 101.88154124813505, 46.807876575673305, 125.68579269743898, 158.14280570297151, 135.94654325033687, 273.4544152130367, 147.4655875217323, 192.41041167890364, 49.95133386039854, 117.6709769348606, 307.54103725278594, 154.16329085163477, 84.60286151967891, 105.6888692375258, 117.928004234372, 456.19402990094113, 180.51704013840396, 37.59378718077617, 73.97350292204902, 220.47894590305302, 70.57542450114468, 81.99894693835714, 287.1404208614362, 124.31517209939362, 77.81143531149912, 94.45317346584672, 603.3070310402176, 4.407493696792509, 120.22636694131064, 158.32564620816714, 156.27837996446831, 183.81856416982777, 190.15572092886526, 57.486310198593905, 19.260965221240674, 104.97580139767643, 335.48595211746067, 132.35718443782875, 427.24162559431306, 26.636771395878057, 111.80570796737526, 300.2691734629939, 408.58264591157007, 420.80452437970445, 5.108624475836292, 52.97238524474886, 287.137874016384, 42.52989627665654, 249.06209959157874, 59.46630179934089, 60.59021209656027, 96.32941126665771, 244.55099166462634, 23.364551057339337, 352.09681060895593, 139.484538747809, 84.26829606863068, 166.00345752160572, 85.43095144950415, 11.292091379177139, 10.159465551909182, 96.52007615499315, 89.62050042582922, 262.63505853526107, 203.7702526101887, 280.8187594430745, 111.34896841961368, 422.076310053872, 142.87835281078384, 67.85525571069013, 68.78708678480812, 144.9516893493083, 3.097663217460246, 148.82820232668732, 26.40950978047123, 126.96911415368378, 73.36269939711207, 81.23054202941151, 114.50631287595512, 22.83245727948486, 81.47223096200185, 548.685603530857, 128.74085843594474, 88.98841081078632, 157.18930790315324, 149.71119088893283, 148.86051149412052, 272.19245264598135, 104.28514636220606, 76.0396933145873, 68.49703085483164, 64.59160039007425, 7.09106997409692, 108.1509559112347, 136.04828520507508, 512.0090589858706, 236.7908261320644, 75.683235331171, 263.3957283346271, 478.0726749572387, 135.94291475796194, 89.35710262812012, 86.27229484049248, 63.75514618295546, 68.31930294057841, 72.52322200436127, 197.69029773733507, 105.35516991261662, 215.79277238051466, 318.6820987124964, 15.974521750058948, 8.6605826472921, 107.11014944364044, 118.50660359733423, 327.2422847133049, 60.56518738742654, 96.1072122084398, 91.08350983441537, 51.50874734761473, 38.32202636671628, 30.75883661474464, 335.46098114523534, 99.78631467229546, 2.341342943461918, 112.67485248206084, 215.9350649545327, 306.7770227835108, 99.61590184384039, 12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.010532939303557, "mean_inference_ms": 5.414778718375162, "mean_action_processing_ms": 3.1889482247631613, "mean_env_wait_ms": 12.48475680824165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077834394243028425, "StateBufferConnector_ms": 0.005393160714043511, "ViewRequirementAgentConnector_ms": 0.14027489556206596}, "num_episodes": 0, "episode_return_max": 714.0206386300276, "episode_return_min": 56.000000000000526, "episode_return_mean": 362.1030784835431, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.74052564882842, "num_env_steps_trained_throughput_per_sec": 148.74052564882842, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 27322.345, "restore_workers_time_ms": 0.071, "training_step_time_ms": 27321.946, "sample_time_ms": 2900.752, "learn_time_ms": 24391.193, "learn_throughput": 163.994, "synch_weights_time_ms": 23.91}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-39-46", "timestamp": 1724382586, "time_this_iter_s": 26.938175916671753, "time_total_s": 302.29033517837524, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095688b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 302.29033517837524, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 37.784210526315796, "ram_util_percent": 83.30263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1767791695064966, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.587088308258662, "policy_loss": -0.011444024483934438, "vf_loss": 2.596184748568863, "vf_explained_var": 0.1720874964244782, "kl": 0.011737941139471278, "entropy": 1.4924980454974703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10868.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.29864733736351, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.155950676448762, "policy_loss": -0.01246746735026439, "vf_loss": 7.166749258394595, "vf_explained_var": 0.5664860004470462, "kl": 0.008344568038191745, "entropy": 1.4939161506279435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10868.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 714.0206386300276, "episode_reward_min": 56.000000000000526, "episode_reward_mean": 362.1030784835431, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -593.0070310402167, "predator_policy": 1.0426371339015965}, "policy_reward_max": {"prey_policy": 380.85736286609836, "predator_policy": 603.3070310402176}, "policy_reward_mean": {"prey_policy": 27.95689660263613, "predator_policy": 153.09464263913543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.4000000000003, 148.833446149194, 130.3000000000005, 213.78901592903168, 109.73298130890088, 417.2000000000026, 318.599999999999, 293.7595391126457, 634.0325013153707, 271.8999999999994, 226.5714753114902, 98.1999999999984, 386.63477867275, 93.96172044806806, 218.19999999999914, 515.9, 289.43660224510506, 289.0999999999991, 239.4999999999991, 400.1935280656641, 294.30000000000007, 323.4, 511.2334734184982, 272.9641052640102, 366.45266581554597, 486.57951728830767, 646.2790373332451, 331.3911085841402, 244.8999999999995, 377.49999999999943, 357.3000000000017, 214.59999999999914, 592.6220663279468, 599.6715920388606, 269.3344136151678, 56.000000000000526, 390.1648871849786, 260.44455273064415, 484.5999999999995, 107.73321818039892, 352.0999999999998, 84.79999999999944, 294.8720869026316, 247.59017164540865, 191.12411785656477, 407.20667569517104, 351.1000000000006, 244.5999999999991, 563.4000000000001, 220.50000000000006, 632.2153029034961, 555.6999999999994, 478.30000000000007, 601.0000000000006, 242.39999999999918, 259.09999999999894, 421.33139789385496, 449.0606389297601, 599.2999999999996, 586.7994403891755, 600.6124850282097, 347.1531403958925, 714.0206386300276, 333.1, 450.6116363748256, 355.50818224750844, 241.79999999999927, 647.4000000000001, 362.99999999999943, 429.2058129125049, 247.84144829462713, 512.3000000000002, 583.919982835263, 274.7149252121372, 371.5000000000013, 549.7999999999997, 100.29999999999826, 191.8999999999966, 585.2, 443.0007085664735, 528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.69088231930537, 140.78051794146594, -42.468472586944536, 64.21685333392657, -34.16640160979733, 75.54568383217125, -410.96827885132143, -69.5005877256011, -45.80012555469375, -425.25021554310564, -39.32242890605268, 380.85736286609836, -324.97071174497194, 115.03283477644823, 88.01519717801422, -383.71184128131347, 317.62493003027373, -0.7709904549057809, -33.36618122102561, 8.485817038584692, -335.2184128331362, -61.06380951777206, -133.49636743846037, -30.364369943254616, 140.90640048784508, -12.762622064545345, -216.7762134798771, -44.97789153141262, -54.10148197024916, 91.46693834380072, -19.912187077461454, 216.61721279183826, 23.021032651649065, 117.72615176964946, 20.49636486729004, -15.224963267701426, -100.44654325033889, -69.45441521303749, -13.36274036061012, 73.68026922563593, 13.428929881609145, 113.24875932313121, -131.59163836778623, -6.712689736635619, 185.21787403401405, 135.72386862728, 93.53829844636158, -394.6962273176611, 165.17806012955648, -16.836221633191087, 78.39205963667852, 113.7350088265266, 363.9999999999999, 129.70466589374294, 206.93165579863003, -286.99614017531906, -41.61143531149918, 114.24682653415351, -593.0070310402167, 362.7925063032074, 206.7736330586893, -128.02564620816852, -37.54317563071206, -87.9537685035863, 106.1442790711348, 238.83575612935286, 187.170323691838, 288.26450172810337, -375.0456995367797, 176.53697659666307, -413.4882520466868, 15.60985505649737, -327.89389815277815, 305.98390390738774, -418.34714488593266, -150.59547267469335, 351.1913755241636, 75.32761475525129, -184.44152498634512, -37.49302712629794, -145.46209959157997, 189.03369820065927, -11.390212096559841, -60.72941126665835, 47.5428258539445, -20.58628167327778, -127.15476196545669, -116.83641574589973, 68.07170282968923, -127.21933856336133, 88.2780987051809, 222.20553416130923, 28.840534448090942, 215.5799238450069, -33.68535033393688, -73.97020862715269, 125.02974738981129, -46.21875944307425, 108.84969961817275, -421.7749780916572, 220.28997173908098, 201.19172264294113, 301.21291321519186, 40.748310650690755, 257.10233678253974, 69.2717976733122, 216.05677045317606, 231.5646056126689, 35.319594551296944, 52.48716402217958, -77.90886561716435, 199.67009546172255, 340.23094076453293, -549.0573773635375, -59.781915874029224, 291.1132855570572, 131.94477489948798, 160.45472630842556, 177.1651173918656, -11.418641142792453, 95.74754254971404, 324.54010280170036, 257.41416270499826, -43.349653554011965, 273.8548761572587, 324.9237365874373, 43.751714794924766, -358.70905898586955, 171.68684351614544, -33.54926860455498, -390.4810850397281, 4.520863995371393, 71.75708524203748, -55.257102628120094, 196.72770515950754, 300.6448538170445, 40.48069705942194, 181.67677799563873, 126.00046889005151, 0.15987637250162834, -177.693275715666, -108.94014708271868, 242.63882833703457, 245.02606726561433, 46.971971714924535, 311.3312580793634, -174.25811073195598, 61.165563843363046, 215.51296256037276, -31.20368460322735, 184.69125265238546, 275.2779736332838, 39.500928481261504, -305.4207462412372, -2.943055311186662, 92.71539769542797, 205.825147517939, 50.76493504546718, -267.45327225064335, 304.0610561897669, 90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301], "policy_predator_policy_reward": [130.71308001665687, 18.21551972257204, 63.59369428093628, 63.49137112127544, 19.159602508114126, 69.76111526951183, 245.29668128432002, 448.9612012216343, 380.9994049343671, 199.78391747233135, 74.62242890605297, 1.0426371339015965, 302.2165741093457, 226.3213028591773, 89.96310131081965, 499.4930819051261, 6.081072730868625, 311.09748900913434, 267.7661812210257, 29.01418296141537, 415.7601581881278, 207.09353947426982, 145.80611625359708, 116.25462112811674, 219.4419833387226, 39.04901691072721, 96.11531850290649, 259.6005069564515, 113.80148197024806, 67.03306165619948, 246.01218707746125, 73.18278720816171, 101.88154124813505, 46.807876575673305, 125.68579269743898, 158.14280570297151, 135.94654325033687, 273.4544152130367, 147.4655875217323, 192.41041167890364, 49.95133386039854, 117.6709769348606, 307.54103725278594, 154.16329085163477, 84.60286151967891, 105.6888692375258, 117.928004234372, 456.19402990094113, 180.51704013840396, 37.59378718077617, 73.97350292204902, 220.47894590305302, 70.57542450114468, 81.99894693835714, 287.1404208614362, 124.31517209939362, 77.81143531149912, 94.45317346584672, 603.3070310402176, 4.407493696792509, 120.22636694131064, 158.32564620816714, 156.27837996446831, 183.81856416982777, 190.15572092886526, 57.486310198593905, 19.260965221240674, 104.97580139767643, 335.48595211746067, 132.35718443782875, 427.24162559431306, 26.636771395878057, 111.80570796737526, 300.2691734629939, 408.58264591157007, 420.80452437970445, 5.108624475836292, 52.97238524474886, 287.137874016384, 42.52989627665654, 249.06209959157874, 59.46630179934089, 60.59021209656027, 96.32941126665771, 244.55099166462634, 23.364551057339337, 352.09681060895593, 139.484538747809, 84.26829606863068, 166.00345752160572, 85.43095144950415, 11.292091379177139, 10.159465551909182, 96.52007615499315, 89.62050042582922, 262.63505853526107, 203.7702526101887, 280.8187594430745, 111.34896841961368, 422.076310053872, 142.87835281078384, 67.85525571069013, 68.78708678480812, 144.9516893493083, 3.097663217460246, 148.82820232668732, 26.40950978047123, 126.96911415368378, 73.36269939711207, 81.23054202941151, 114.50631287595512, 22.83245727948486, 81.47223096200185, 548.685603530857, 128.74085843594474, 88.98841081078632, 157.18930790315324, 149.71119088893283, 148.86051149412052, 272.19245264598135, 104.28514636220606, 76.0396933145873, 68.49703085483164, 64.59160039007425, 7.09106997409692, 108.1509559112347, 136.04828520507508, 512.0090589858706, 236.7908261320644, 75.683235331171, 263.3957283346271, 478.0726749572387, 135.94291475796194, 89.35710262812012, 86.27229484049248, 63.75514618295546, 68.31930294057841, 72.52322200436127, 197.69029773733507, 105.35516991261662, 215.79277238051466, 318.6820987124964, 15.974521750058948, 8.6605826472921, 107.11014944364044, 118.50660359733423, 327.2422847133049, 60.56518738742654, 96.1072122084398, 91.08350983441537, 51.50874734761473, 38.32202636671628, 30.75883661474464, 335.46098114523534, 99.78631467229546, 2.341342943461918, 112.67485248206084, 215.9350649545327, 306.7770227835108, 99.61590184384039, 12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.010532939303557, "mean_inference_ms": 5.414778718375162, "mean_action_processing_ms": 3.1889482247631613, "mean_env_wait_ms": 12.48475680824165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077834394243028425, "StateBufferConnector_ms": 0.005393160714043511, "ViewRequirementAgentConnector_ms": 0.14027489556206596}, "num_episodes": 0, "episode_return_max": 714.0206386300276, "episode_return_min": 56.000000000000526, "episode_return_mean": 362.1030784835431, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.50740969940455, "num_env_steps_trained_throughput_per_sec": 152.50740969940455, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 27277.771, "restore_workers_time_ms": 0.07, "training_step_time_ms": 27277.365, "sample_time_ms": 2874.457, "learn_time_ms": 24373.824, "learn_throughput": 164.11, "synch_weights_time_ms": 23.327}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-40-12", "timestamp": 1724382612, "time_this_iter_s": 26.294838666915894, "time_total_s": 328.58517384529114, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309568dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 328.58517384529114, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 36.63157894736842, "ram_util_percent": 82.25526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8961670095958407, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.5710166260048197, "policy_loss": -0.016378896476986704, "vf_loss": 2.5855874494270044, "vf_explained_var": 0.21516341103447809, "kl": 0.009040336197527943, "entropy": 1.4906206070430694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 11813.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.039167603739985, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.029372880824659, "policy_loss": -0.01590569753830553, "vf_loss": 7.042780324643251, "vf_explained_var": 0.640410641576878, "kl": 0.012491232225740398, "entropy": 1.486857776288633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 11813.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 714.0206386300276, "episode_reward_min": 56.000000000000526, "episode_reward_mean": 362.1030784835431, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -593.0070310402167, "predator_policy": 1.0426371339015965}, "policy_reward_max": {"prey_policy": 380.85736286609836, "predator_policy": 603.3070310402176}, "policy_reward_mean": {"prey_policy": 27.95689660263613, "predator_policy": 153.09464263913543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.4000000000003, 148.833446149194, 130.3000000000005, 213.78901592903168, 109.73298130890088, 417.2000000000026, 318.599999999999, 293.7595391126457, 634.0325013153707, 271.8999999999994, 226.5714753114902, 98.1999999999984, 386.63477867275, 93.96172044806806, 218.19999999999914, 515.9, 289.43660224510506, 289.0999999999991, 239.4999999999991, 400.1935280656641, 294.30000000000007, 323.4, 511.2334734184982, 272.9641052640102, 366.45266581554597, 486.57951728830767, 646.2790373332451, 331.3911085841402, 244.8999999999995, 377.49999999999943, 357.3000000000017, 214.59999999999914, 592.6220663279468, 599.6715920388606, 269.3344136151678, 56.000000000000526, 390.1648871849786, 260.44455273064415, 484.5999999999995, 107.73321818039892, 352.0999999999998, 84.79999999999944, 294.8720869026316, 247.59017164540865, 191.12411785656477, 407.20667569517104, 351.1000000000006, 244.5999999999991, 563.4000000000001, 220.50000000000006, 632.2153029034961, 555.6999999999994, 478.30000000000007, 601.0000000000006, 242.39999999999918, 259.09999999999894, 421.33139789385496, 449.0606389297601, 599.2999999999996, 586.7994403891755, 600.6124850282097, 347.1531403958925, 714.0206386300276, 333.1, 450.6116363748256, 355.50818224750844, 241.79999999999927, 647.4000000000001, 362.99999999999943, 429.2058129125049, 247.84144829462713, 512.3000000000002, 583.919982835263, 274.7149252121372, 371.5000000000013, 549.7999999999997, 100.29999999999826, 191.8999999999966, 585.2, 443.0007085664735, 528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.69088231930537, 140.78051794146594, -42.468472586944536, 64.21685333392657, -34.16640160979733, 75.54568383217125, -410.96827885132143, -69.5005877256011, -45.80012555469375, -425.25021554310564, -39.32242890605268, 380.85736286609836, -324.97071174497194, 115.03283477644823, 88.01519717801422, -383.71184128131347, 317.62493003027373, -0.7709904549057809, -33.36618122102561, 8.485817038584692, -335.2184128331362, -61.06380951777206, -133.49636743846037, -30.364369943254616, 140.90640048784508, -12.762622064545345, -216.7762134798771, -44.97789153141262, -54.10148197024916, 91.46693834380072, -19.912187077461454, 216.61721279183826, 23.021032651649065, 117.72615176964946, 20.49636486729004, -15.224963267701426, -100.44654325033889, -69.45441521303749, -13.36274036061012, 73.68026922563593, 13.428929881609145, 113.24875932313121, -131.59163836778623, -6.712689736635619, 185.21787403401405, 135.72386862728, 93.53829844636158, -394.6962273176611, 165.17806012955648, -16.836221633191087, 78.39205963667852, 113.7350088265266, 363.9999999999999, 129.70466589374294, 206.93165579863003, -286.99614017531906, -41.61143531149918, 114.24682653415351, -593.0070310402167, 362.7925063032074, 206.7736330586893, -128.02564620816852, -37.54317563071206, -87.9537685035863, 106.1442790711348, 238.83575612935286, 187.170323691838, 288.26450172810337, -375.0456995367797, 176.53697659666307, -413.4882520466868, 15.60985505649737, -327.89389815277815, 305.98390390738774, -418.34714488593266, -150.59547267469335, 351.1913755241636, 75.32761475525129, -184.44152498634512, -37.49302712629794, -145.46209959157997, 189.03369820065927, -11.390212096559841, -60.72941126665835, 47.5428258539445, -20.58628167327778, -127.15476196545669, -116.83641574589973, 68.07170282968923, -127.21933856336133, 88.2780987051809, 222.20553416130923, 28.840534448090942, 215.5799238450069, -33.68535033393688, -73.97020862715269, 125.02974738981129, -46.21875944307425, 108.84969961817275, -421.7749780916572, 220.28997173908098, 201.19172264294113, 301.21291321519186, 40.748310650690755, 257.10233678253974, 69.2717976733122, 216.05677045317606, 231.5646056126689, 35.319594551296944, 52.48716402217958, -77.90886561716435, 199.67009546172255, 340.23094076453293, -549.0573773635375, -59.781915874029224, 291.1132855570572, 131.94477489948798, 160.45472630842556, 177.1651173918656, -11.418641142792453, 95.74754254971404, 324.54010280170036, 257.41416270499826, -43.349653554011965, 273.8548761572587, 324.9237365874373, 43.751714794924766, -358.70905898586955, 171.68684351614544, -33.54926860455498, -390.4810850397281, 4.520863995371393, 71.75708524203748, -55.257102628120094, 196.72770515950754, 300.6448538170445, 40.48069705942194, 181.67677799563873, 126.00046889005151, 0.15987637250162834, -177.693275715666, -108.94014708271868, 242.63882833703457, 245.02606726561433, 46.971971714924535, 311.3312580793634, -174.25811073195598, 61.165563843363046, 215.51296256037276, -31.20368460322735, 184.69125265238546, 275.2779736332838, 39.500928481261504, -305.4207462412372, -2.943055311186662, 92.71539769542797, 205.825147517939, 50.76493504546718, -267.45327225064335, 304.0610561897669, 90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301], "policy_predator_policy_reward": [130.71308001665687, 18.21551972257204, 63.59369428093628, 63.49137112127544, 19.159602508114126, 69.76111526951183, 245.29668128432002, 448.9612012216343, 380.9994049343671, 199.78391747233135, 74.62242890605297, 1.0426371339015965, 302.2165741093457, 226.3213028591773, 89.96310131081965, 499.4930819051261, 6.081072730868625, 311.09748900913434, 267.7661812210257, 29.01418296141537, 415.7601581881278, 207.09353947426982, 145.80611625359708, 116.25462112811674, 219.4419833387226, 39.04901691072721, 96.11531850290649, 259.6005069564515, 113.80148197024806, 67.03306165619948, 246.01218707746125, 73.18278720816171, 101.88154124813505, 46.807876575673305, 125.68579269743898, 158.14280570297151, 135.94654325033687, 273.4544152130367, 147.4655875217323, 192.41041167890364, 49.95133386039854, 117.6709769348606, 307.54103725278594, 154.16329085163477, 84.60286151967891, 105.6888692375258, 117.928004234372, 456.19402990094113, 180.51704013840396, 37.59378718077617, 73.97350292204902, 220.47894590305302, 70.57542450114468, 81.99894693835714, 287.1404208614362, 124.31517209939362, 77.81143531149912, 94.45317346584672, 603.3070310402176, 4.407493696792509, 120.22636694131064, 158.32564620816714, 156.27837996446831, 183.81856416982777, 190.15572092886526, 57.486310198593905, 19.260965221240674, 104.97580139767643, 335.48595211746067, 132.35718443782875, 427.24162559431306, 26.636771395878057, 111.80570796737526, 300.2691734629939, 408.58264591157007, 420.80452437970445, 5.108624475836292, 52.97238524474886, 287.137874016384, 42.52989627665654, 249.06209959157874, 59.46630179934089, 60.59021209656027, 96.32941126665771, 244.55099166462634, 23.364551057339337, 352.09681060895593, 139.484538747809, 84.26829606863068, 166.00345752160572, 85.43095144950415, 11.292091379177139, 10.159465551909182, 96.52007615499315, 89.62050042582922, 262.63505853526107, 203.7702526101887, 280.8187594430745, 111.34896841961368, 422.076310053872, 142.87835281078384, 67.85525571069013, 68.78708678480812, 144.9516893493083, 3.097663217460246, 148.82820232668732, 26.40950978047123, 126.96911415368378, 73.36269939711207, 81.23054202941151, 114.50631287595512, 22.83245727948486, 81.47223096200185, 548.685603530857, 128.74085843594474, 88.98841081078632, 157.18930790315324, 149.71119088893283, 148.86051149412052, 272.19245264598135, 104.28514636220606, 76.0396933145873, 68.49703085483164, 64.59160039007425, 7.09106997409692, 108.1509559112347, 136.04828520507508, 512.0090589858706, 236.7908261320644, 75.683235331171, 263.3957283346271, 478.0726749572387, 135.94291475796194, 89.35710262812012, 86.27229484049248, 63.75514618295546, 68.31930294057841, 72.52322200436127, 197.69029773733507, 105.35516991261662, 215.79277238051466, 318.6820987124964, 15.974521750058948, 8.6605826472921, 107.11014944364044, 118.50660359733423, 327.2422847133049, 60.56518738742654, 96.1072122084398, 91.08350983441537, 51.50874734761473, 38.32202636671628, 30.75883661474464, 335.46098114523534, 99.78631467229546, 2.341342943461918, 112.67485248206084, 215.9350649545327, 306.7770227835108, 99.61590184384039, 12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.010532939303557, "mean_inference_ms": 5.414778718375162, "mean_action_processing_ms": 3.1889482247631613, "mean_env_wait_ms": 12.48475680824165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077834394243028425, "StateBufferConnector_ms": 0.005393160714043511, "ViewRequirementAgentConnector_ms": 0.14027489556206596}, "num_episodes": 0, "episode_return_max": 714.0206386300276, "episode_return_min": 56.000000000000526, "episode_return_mean": 362.1030784835431, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.3663470049575, "num_env_steps_trained_throughput_per_sec": 149.3663470049575, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 27342.37, "restore_workers_time_ms": 0.07, "training_step_time_ms": 27341.983, "sample_time_ms": 2868.907, "learn_time_ms": 24444.02, "learn_throughput": 163.639, "synch_weights_time_ms": 23.87}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-40-39", "timestamp": 1724382639, "time_this_iter_s": 26.80994486808777, "time_total_s": 355.3951187133789, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095a6790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 355.3951187133789, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 38.47894736842105, "ram_util_percent": 83.09736842105265}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7779792091203115, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.83960954651, "policy_loss": -0.012750286885128213, "vf_loss": 2.850150515667345, "vf_explained_var": 0.17931050787527095, "kl": 0.011046529400393997, "entropy": 1.4679666333728367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12758.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.114981849736006, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.9510115043196095, "policy_loss": -0.013348149230196166, "vf_loss": 6.9622034521960705, "vf_explained_var": 0.5325989632379441, "kl": 0.010780999536019941, "entropy": 1.474933519186797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12758.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 714.0206386300276, "episode_reward_min": 56.000000000000526, "episode_reward_mean": 362.1030784835431, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -593.0070310402167, "predator_policy": 1.0426371339015965}, "policy_reward_max": {"prey_policy": 380.85736286609836, "predator_policy": 603.3070310402176}, "policy_reward_mean": {"prey_policy": 27.95689660263613, "predator_policy": 153.09464263913543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.4000000000003, 148.833446149194, 130.3000000000005, 213.78901592903168, 109.73298130890088, 417.2000000000026, 318.599999999999, 293.7595391126457, 634.0325013153707, 271.8999999999994, 226.5714753114902, 98.1999999999984, 386.63477867275, 93.96172044806806, 218.19999999999914, 515.9, 289.43660224510506, 289.0999999999991, 239.4999999999991, 400.1935280656641, 294.30000000000007, 323.4, 511.2334734184982, 272.9641052640102, 366.45266581554597, 486.57951728830767, 646.2790373332451, 331.3911085841402, 244.8999999999995, 377.49999999999943, 357.3000000000017, 214.59999999999914, 592.6220663279468, 599.6715920388606, 269.3344136151678, 56.000000000000526, 390.1648871849786, 260.44455273064415, 484.5999999999995, 107.73321818039892, 352.0999999999998, 84.79999999999944, 294.8720869026316, 247.59017164540865, 191.12411785656477, 407.20667569517104, 351.1000000000006, 244.5999999999991, 563.4000000000001, 220.50000000000006, 632.2153029034961, 555.6999999999994, 478.30000000000007, 601.0000000000006, 242.39999999999918, 259.09999999999894, 421.33139789385496, 449.0606389297601, 599.2999999999996, 586.7994403891755, 600.6124850282097, 347.1531403958925, 714.0206386300276, 333.1, 450.6116363748256, 355.50818224750844, 241.79999999999927, 647.4000000000001, 362.99999999999943, 429.2058129125049, 247.84144829462713, 512.3000000000002, 583.919982835263, 274.7149252121372, 371.5000000000013, 549.7999999999997, 100.29999999999826, 191.8999999999966, 585.2, 443.0007085664735, 528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.69088231930537, 140.78051794146594, -42.468472586944536, 64.21685333392657, -34.16640160979733, 75.54568383217125, -410.96827885132143, -69.5005877256011, -45.80012555469375, -425.25021554310564, -39.32242890605268, 380.85736286609836, -324.97071174497194, 115.03283477644823, 88.01519717801422, -383.71184128131347, 317.62493003027373, -0.7709904549057809, -33.36618122102561, 8.485817038584692, -335.2184128331362, -61.06380951777206, -133.49636743846037, -30.364369943254616, 140.90640048784508, -12.762622064545345, -216.7762134798771, -44.97789153141262, -54.10148197024916, 91.46693834380072, -19.912187077461454, 216.61721279183826, 23.021032651649065, 117.72615176964946, 20.49636486729004, -15.224963267701426, -100.44654325033889, -69.45441521303749, -13.36274036061012, 73.68026922563593, 13.428929881609145, 113.24875932313121, -131.59163836778623, -6.712689736635619, 185.21787403401405, 135.72386862728, 93.53829844636158, -394.6962273176611, 165.17806012955648, -16.836221633191087, 78.39205963667852, 113.7350088265266, 363.9999999999999, 129.70466589374294, 206.93165579863003, -286.99614017531906, -41.61143531149918, 114.24682653415351, -593.0070310402167, 362.7925063032074, 206.7736330586893, -128.02564620816852, -37.54317563071206, -87.9537685035863, 106.1442790711348, 238.83575612935286, 187.170323691838, 288.26450172810337, -375.0456995367797, 176.53697659666307, -413.4882520466868, 15.60985505649737, -327.89389815277815, 305.98390390738774, -418.34714488593266, -150.59547267469335, 351.1913755241636, 75.32761475525129, -184.44152498634512, -37.49302712629794, -145.46209959157997, 189.03369820065927, -11.390212096559841, -60.72941126665835, 47.5428258539445, -20.58628167327778, -127.15476196545669, -116.83641574589973, 68.07170282968923, -127.21933856336133, 88.2780987051809, 222.20553416130923, 28.840534448090942, 215.5799238450069, -33.68535033393688, -73.97020862715269, 125.02974738981129, -46.21875944307425, 108.84969961817275, -421.7749780916572, 220.28997173908098, 201.19172264294113, 301.21291321519186, 40.748310650690755, 257.10233678253974, 69.2717976733122, 216.05677045317606, 231.5646056126689, 35.319594551296944, 52.48716402217958, -77.90886561716435, 199.67009546172255, 340.23094076453293, -549.0573773635375, -59.781915874029224, 291.1132855570572, 131.94477489948798, 160.45472630842556, 177.1651173918656, -11.418641142792453, 95.74754254971404, 324.54010280170036, 257.41416270499826, -43.349653554011965, 273.8548761572587, 324.9237365874373, 43.751714794924766, -358.70905898586955, 171.68684351614544, -33.54926860455498, -390.4810850397281, 4.520863995371393, 71.75708524203748, -55.257102628120094, 196.72770515950754, 300.6448538170445, 40.48069705942194, 181.67677799563873, 126.00046889005151, 0.15987637250162834, -177.693275715666, -108.94014708271868, 242.63882833703457, 245.02606726561433, 46.971971714924535, 311.3312580793634, -174.25811073195598, 61.165563843363046, 215.51296256037276, -31.20368460322735, 184.69125265238546, 275.2779736332838, 39.500928481261504, -305.4207462412372, -2.943055311186662, 92.71539769542797, 205.825147517939, 50.76493504546718, -267.45327225064335, 304.0610561897669, 90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301], "policy_predator_policy_reward": [130.71308001665687, 18.21551972257204, 63.59369428093628, 63.49137112127544, 19.159602508114126, 69.76111526951183, 245.29668128432002, 448.9612012216343, 380.9994049343671, 199.78391747233135, 74.62242890605297, 1.0426371339015965, 302.2165741093457, 226.3213028591773, 89.96310131081965, 499.4930819051261, 6.081072730868625, 311.09748900913434, 267.7661812210257, 29.01418296141537, 415.7601581881278, 207.09353947426982, 145.80611625359708, 116.25462112811674, 219.4419833387226, 39.04901691072721, 96.11531850290649, 259.6005069564515, 113.80148197024806, 67.03306165619948, 246.01218707746125, 73.18278720816171, 101.88154124813505, 46.807876575673305, 125.68579269743898, 158.14280570297151, 135.94654325033687, 273.4544152130367, 147.4655875217323, 192.41041167890364, 49.95133386039854, 117.6709769348606, 307.54103725278594, 154.16329085163477, 84.60286151967891, 105.6888692375258, 117.928004234372, 456.19402990094113, 180.51704013840396, 37.59378718077617, 73.97350292204902, 220.47894590305302, 70.57542450114468, 81.99894693835714, 287.1404208614362, 124.31517209939362, 77.81143531149912, 94.45317346584672, 603.3070310402176, 4.407493696792509, 120.22636694131064, 158.32564620816714, 156.27837996446831, 183.81856416982777, 190.15572092886526, 57.486310198593905, 19.260965221240674, 104.97580139767643, 335.48595211746067, 132.35718443782875, 427.24162559431306, 26.636771395878057, 111.80570796737526, 300.2691734629939, 408.58264591157007, 420.80452437970445, 5.108624475836292, 52.97238524474886, 287.137874016384, 42.52989627665654, 249.06209959157874, 59.46630179934089, 60.59021209656027, 96.32941126665771, 244.55099166462634, 23.364551057339337, 352.09681060895593, 139.484538747809, 84.26829606863068, 166.00345752160572, 85.43095144950415, 11.292091379177139, 10.159465551909182, 96.52007615499315, 89.62050042582922, 262.63505853526107, 203.7702526101887, 280.8187594430745, 111.34896841961368, 422.076310053872, 142.87835281078384, 67.85525571069013, 68.78708678480812, 144.9516893493083, 3.097663217460246, 148.82820232668732, 26.40950978047123, 126.96911415368378, 73.36269939711207, 81.23054202941151, 114.50631287595512, 22.83245727948486, 81.47223096200185, 548.685603530857, 128.74085843594474, 88.98841081078632, 157.18930790315324, 149.71119088893283, 148.86051149412052, 272.19245264598135, 104.28514636220606, 76.0396933145873, 68.49703085483164, 64.59160039007425, 7.09106997409692, 108.1509559112347, 136.04828520507508, 512.0090589858706, 236.7908261320644, 75.683235331171, 263.3957283346271, 478.0726749572387, 135.94291475796194, 89.35710262812012, 86.27229484049248, 63.75514618295546, 68.31930294057841, 72.52322200436127, 197.69029773733507, 105.35516991261662, 215.79277238051466, 318.6820987124964, 15.974521750058948, 8.6605826472921, 107.11014944364044, 118.50660359733423, 327.2422847133049, 60.56518738742654, 96.1072122084398, 91.08350983441537, 51.50874734761473, 38.32202636671628, 30.75883661474464, 335.46098114523534, 99.78631467229546, 2.341342943461918, 112.67485248206084, 215.9350649545327, 306.7770227835108, 99.61590184384039, 12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.010532939303557, "mean_inference_ms": 5.414778718375162, "mean_action_processing_ms": 3.1889482247631613, "mean_env_wait_ms": 12.48475680824165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077834394243028425, "StateBufferConnector_ms": 0.005393160714043511, "ViewRequirementAgentConnector_ms": 0.14027489556206596}, "num_episodes": 0, "episode_return_max": 714.0206386300276, "episode_return_min": 56.000000000000526, "episode_return_mean": 362.1030784835431, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.81601226346632, "num_env_steps_trained_throughput_per_sec": 150.81601226346632, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 27231.583, "restore_workers_time_ms": 0.068, "training_step_time_ms": 27231.209, "sample_time_ms": 2831.074, "learn_time_ms": 24371.103, "learn_throughput": 164.129, "synch_weights_time_ms": 23.824}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-41-05", "timestamp": 1724382665, "time_this_iter_s": 26.578197956085205, "time_total_s": 381.9733166694641, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309568c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 381.9733166694641, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.792105263157886, "ram_util_percent": 82.79473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.585902254354386, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.795216969459776, "policy_loss": -0.013921501014933542, "vf_loss": 2.807401555303543, "vf_explained_var": 0.23775866435318396, "kl": 0.008684574187087714, "entropy": 1.4411243504317348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 13703.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.076217319473386, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.75839293595975, "policy_loss": -0.01263888932163359, "vf_loss": 6.769172885430553, "vf_explained_var": 0.618176148745118, "kl": 0.009294727043293061, "entropy": 1.4739750519000665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 13703.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 714.0206386300276, "episode_reward_min": 56.000000000000526, "episode_reward_mean": 362.1030784835431, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -593.0070310402167, "predator_policy": 1.0426371339015965}, "policy_reward_max": {"prey_policy": 380.85736286609836, "predator_policy": 603.3070310402176}, "policy_reward_mean": {"prey_policy": 27.95689660263613, "predator_policy": 153.09464263913543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.4000000000003, 148.833446149194, 130.3000000000005, 213.78901592903168, 109.73298130890088, 417.2000000000026, 318.599999999999, 293.7595391126457, 634.0325013153707, 271.8999999999994, 226.5714753114902, 98.1999999999984, 386.63477867275, 93.96172044806806, 218.19999999999914, 515.9, 289.43660224510506, 289.0999999999991, 239.4999999999991, 400.1935280656641, 294.30000000000007, 323.4, 511.2334734184982, 272.9641052640102, 366.45266581554597, 486.57951728830767, 646.2790373332451, 331.3911085841402, 244.8999999999995, 377.49999999999943, 357.3000000000017, 214.59999999999914, 592.6220663279468, 599.6715920388606, 269.3344136151678, 56.000000000000526, 390.1648871849786, 260.44455273064415, 484.5999999999995, 107.73321818039892, 352.0999999999998, 84.79999999999944, 294.8720869026316, 247.59017164540865, 191.12411785656477, 407.20667569517104, 351.1000000000006, 244.5999999999991, 563.4000000000001, 220.50000000000006, 632.2153029034961, 555.6999999999994, 478.30000000000007, 601.0000000000006, 242.39999999999918, 259.09999999999894, 421.33139789385496, 449.0606389297601, 599.2999999999996, 586.7994403891755, 600.6124850282097, 347.1531403958925, 714.0206386300276, 333.1, 450.6116363748256, 355.50818224750844, 241.79999999999927, 647.4000000000001, 362.99999999999943, 429.2058129125049, 247.84144829462713, 512.3000000000002, 583.919982835263, 274.7149252121372, 371.5000000000013, 549.7999999999997, 100.29999999999826, 191.8999999999966, 585.2, 443.0007085664735, 528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.69088231930537, 140.78051794146594, -42.468472586944536, 64.21685333392657, -34.16640160979733, 75.54568383217125, -410.96827885132143, -69.5005877256011, -45.80012555469375, -425.25021554310564, -39.32242890605268, 380.85736286609836, -324.97071174497194, 115.03283477644823, 88.01519717801422, -383.71184128131347, 317.62493003027373, -0.7709904549057809, -33.36618122102561, 8.485817038584692, -335.2184128331362, -61.06380951777206, -133.49636743846037, -30.364369943254616, 140.90640048784508, -12.762622064545345, -216.7762134798771, -44.97789153141262, -54.10148197024916, 91.46693834380072, -19.912187077461454, 216.61721279183826, 23.021032651649065, 117.72615176964946, 20.49636486729004, -15.224963267701426, -100.44654325033889, -69.45441521303749, -13.36274036061012, 73.68026922563593, 13.428929881609145, 113.24875932313121, -131.59163836778623, -6.712689736635619, 185.21787403401405, 135.72386862728, 93.53829844636158, -394.6962273176611, 165.17806012955648, -16.836221633191087, 78.39205963667852, 113.7350088265266, 363.9999999999999, 129.70466589374294, 206.93165579863003, -286.99614017531906, -41.61143531149918, 114.24682653415351, -593.0070310402167, 362.7925063032074, 206.7736330586893, -128.02564620816852, -37.54317563071206, -87.9537685035863, 106.1442790711348, 238.83575612935286, 187.170323691838, 288.26450172810337, -375.0456995367797, 176.53697659666307, -413.4882520466868, 15.60985505649737, -327.89389815277815, 305.98390390738774, -418.34714488593266, -150.59547267469335, 351.1913755241636, 75.32761475525129, -184.44152498634512, -37.49302712629794, -145.46209959157997, 189.03369820065927, -11.390212096559841, -60.72941126665835, 47.5428258539445, -20.58628167327778, -127.15476196545669, -116.83641574589973, 68.07170282968923, -127.21933856336133, 88.2780987051809, 222.20553416130923, 28.840534448090942, 215.5799238450069, -33.68535033393688, -73.97020862715269, 125.02974738981129, -46.21875944307425, 108.84969961817275, -421.7749780916572, 220.28997173908098, 201.19172264294113, 301.21291321519186, 40.748310650690755, 257.10233678253974, 69.2717976733122, 216.05677045317606, 231.5646056126689, 35.319594551296944, 52.48716402217958, -77.90886561716435, 199.67009546172255, 340.23094076453293, -549.0573773635375, -59.781915874029224, 291.1132855570572, 131.94477489948798, 160.45472630842556, 177.1651173918656, -11.418641142792453, 95.74754254971404, 324.54010280170036, 257.41416270499826, -43.349653554011965, 273.8548761572587, 324.9237365874373, 43.751714794924766, -358.70905898586955, 171.68684351614544, -33.54926860455498, -390.4810850397281, 4.520863995371393, 71.75708524203748, -55.257102628120094, 196.72770515950754, 300.6448538170445, 40.48069705942194, 181.67677799563873, 126.00046889005151, 0.15987637250162834, -177.693275715666, -108.94014708271868, 242.63882833703457, 245.02606726561433, 46.971971714924535, 311.3312580793634, -174.25811073195598, 61.165563843363046, 215.51296256037276, -31.20368460322735, 184.69125265238546, 275.2779736332838, 39.500928481261504, -305.4207462412372, -2.943055311186662, 92.71539769542797, 205.825147517939, 50.76493504546718, -267.45327225064335, 304.0610561897669, 90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301], "policy_predator_policy_reward": [130.71308001665687, 18.21551972257204, 63.59369428093628, 63.49137112127544, 19.159602508114126, 69.76111526951183, 245.29668128432002, 448.9612012216343, 380.9994049343671, 199.78391747233135, 74.62242890605297, 1.0426371339015965, 302.2165741093457, 226.3213028591773, 89.96310131081965, 499.4930819051261, 6.081072730868625, 311.09748900913434, 267.7661812210257, 29.01418296141537, 415.7601581881278, 207.09353947426982, 145.80611625359708, 116.25462112811674, 219.4419833387226, 39.04901691072721, 96.11531850290649, 259.6005069564515, 113.80148197024806, 67.03306165619948, 246.01218707746125, 73.18278720816171, 101.88154124813505, 46.807876575673305, 125.68579269743898, 158.14280570297151, 135.94654325033687, 273.4544152130367, 147.4655875217323, 192.41041167890364, 49.95133386039854, 117.6709769348606, 307.54103725278594, 154.16329085163477, 84.60286151967891, 105.6888692375258, 117.928004234372, 456.19402990094113, 180.51704013840396, 37.59378718077617, 73.97350292204902, 220.47894590305302, 70.57542450114468, 81.99894693835714, 287.1404208614362, 124.31517209939362, 77.81143531149912, 94.45317346584672, 603.3070310402176, 4.407493696792509, 120.22636694131064, 158.32564620816714, 156.27837996446831, 183.81856416982777, 190.15572092886526, 57.486310198593905, 19.260965221240674, 104.97580139767643, 335.48595211746067, 132.35718443782875, 427.24162559431306, 26.636771395878057, 111.80570796737526, 300.2691734629939, 408.58264591157007, 420.80452437970445, 5.108624475836292, 52.97238524474886, 287.137874016384, 42.52989627665654, 249.06209959157874, 59.46630179934089, 60.59021209656027, 96.32941126665771, 244.55099166462634, 23.364551057339337, 352.09681060895593, 139.484538747809, 84.26829606863068, 166.00345752160572, 85.43095144950415, 11.292091379177139, 10.159465551909182, 96.52007615499315, 89.62050042582922, 262.63505853526107, 203.7702526101887, 280.8187594430745, 111.34896841961368, 422.076310053872, 142.87835281078384, 67.85525571069013, 68.78708678480812, 144.9516893493083, 3.097663217460246, 148.82820232668732, 26.40950978047123, 126.96911415368378, 73.36269939711207, 81.23054202941151, 114.50631287595512, 22.83245727948486, 81.47223096200185, 548.685603530857, 128.74085843594474, 88.98841081078632, 157.18930790315324, 149.71119088893283, 148.86051149412052, 272.19245264598135, 104.28514636220606, 76.0396933145873, 68.49703085483164, 64.59160039007425, 7.09106997409692, 108.1509559112347, 136.04828520507508, 512.0090589858706, 236.7908261320644, 75.683235331171, 263.3957283346271, 478.0726749572387, 135.94291475796194, 89.35710262812012, 86.27229484049248, 63.75514618295546, 68.31930294057841, 72.52322200436127, 197.69029773733507, 105.35516991261662, 215.79277238051466, 318.6820987124964, 15.974521750058948, 8.6605826472921, 107.11014944364044, 118.50660359733423, 327.2422847133049, 60.56518738742654, 96.1072122084398, 91.08350983441537, 51.50874734761473, 38.32202636671628, 30.75883661474464, 335.46098114523534, 99.78631467229546, 2.341342943461918, 112.67485248206084, 215.9350649545327, 306.7770227835108, 99.61590184384039, 12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.010532939303557, "mean_inference_ms": 5.414778718375162, "mean_action_processing_ms": 3.1889482247631613, "mean_env_wait_ms": 12.48475680824165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077834394243028425, "StateBufferConnector_ms": 0.005393160714043511, "ViewRequirementAgentConnector_ms": 0.14027489556206596}, "num_episodes": 0, "episode_return_max": 714.0206386300276, "episode_return_min": 56.000000000000526, "episode_return_mean": 362.1030784835431, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.7617427211241, "num_env_steps_trained_throughput_per_sec": 150.7617427211241, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 26868.073, "restore_workers_time_ms": 0.066, "training_step_time_ms": 26867.88, "sample_time_ms": 2524.846, "learn_time_ms": 24313.819, "learn_throughput": 164.515, "synch_weights_time_ms": 24.02}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-41-32", "timestamp": 1724382692, "time_this_iter_s": 26.551349878311157, "time_total_s": 408.52466654777527, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309568ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 408.52466654777527, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 42.81891891891891, "ram_util_percent": 83.09189189189188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.467332705429622, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.408569489585029, "policy_loss": -0.017998593761314633, "vf_loss": 3.423881558261851, "vf_explained_var": 0.2559642478902504, "kl": 0.01343269545841154, "entropy": 1.3835251239241746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14648.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.06744915593869, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.629812048351954, "policy_loss": -0.01193951933186442, "vf_loss": 6.639680766050147, "vf_explained_var": 0.41730794723702486, "kl": 0.0103539691060269, "entropy": 1.4577134999017867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14648.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 714.0206386300276, "episode_reward_min": 56.000000000000526, "episode_reward_mean": 371.3558590231846, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 39600, "policy_reward_min": {"prey_policy": -737.6216985872288, "predator_policy": 1.0426371339015965}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 603.3070310402176}, "policy_reward_mean": {"prey_policy": 29.667364903540378, "predator_policy": 156.01056460805196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.4000000000003, 148.833446149194, 130.3000000000005, 213.78901592903168, 109.73298130890088, 417.2000000000026, 318.599999999999, 293.7595391126457, 634.0325013153707, 271.8999999999994, 226.5714753114902, 98.1999999999984, 386.63477867275, 93.96172044806806, 218.19999999999914, 515.9, 289.43660224510506, 289.0999999999991, 239.4999999999991, 400.1935280656641, 294.30000000000007, 323.4, 511.2334734184982, 272.9641052640102, 366.45266581554597, 486.57951728830767, 646.2790373332451, 331.3911085841402, 244.8999999999995, 377.49999999999943, 357.3000000000017, 214.59999999999914, 592.6220663279468, 599.6715920388606, 269.3344136151678, 56.000000000000526, 390.1648871849786, 260.44455273064415, 484.5999999999995, 107.73321818039892, 352.0999999999998, 84.79999999999944, 294.8720869026316, 247.59017164540865, 191.12411785656477, 407.20667569517104, 351.1000000000006, 244.5999999999991, 563.4000000000001, 220.50000000000006, 632.2153029034961, 555.6999999999994, 478.30000000000007, 601.0000000000006, 242.39999999999918, 259.09999999999894, 421.33139789385496, 449.0606389297601, 599.2999999999996, 586.7994403891755, 600.6124850282097, 347.1531403958925, 714.0206386300276, 333.1, 450.6116363748256, 355.50818224750844, 241.79999999999927, 647.4000000000001, 362.99999999999943, 429.2058129125049, 247.84144829462713, 512.3000000000002, 583.919982835263, 274.7149252121372, 371.5000000000013, 549.7999999999997, 100.29999999999826, 191.8999999999966, 585.2, 443.0007085664735, 528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5, 679.3633598698008, 545.2863440419089, 299.11165086608753, 558.2452385699922, 510.8459928197945, 612.7918390835578, 87.13509093967407, 415.69999999999914, 466.47346358558457], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.69088231930537, 140.78051794146594, -42.468472586944536, 64.21685333392657, -34.16640160979733, 75.54568383217125, -410.96827885132143, -69.5005877256011, -45.80012555469375, -425.25021554310564, -39.32242890605268, 380.85736286609836, -324.97071174497194, 115.03283477644823, 88.01519717801422, -383.71184128131347, 317.62493003027373, -0.7709904549057809, -33.36618122102561, 8.485817038584692, -335.2184128331362, -61.06380951777206, -133.49636743846037, -30.364369943254616, 140.90640048784508, -12.762622064545345, -216.7762134798771, -44.97789153141262, -54.10148197024916, 91.46693834380072, -19.912187077461454, 216.61721279183826, 23.021032651649065, 117.72615176964946, 20.49636486729004, -15.224963267701426, -100.44654325033889, -69.45441521303749, -13.36274036061012, 73.68026922563593, 13.428929881609145, 113.24875932313121, -131.59163836778623, -6.712689736635619, 185.21787403401405, 135.72386862728, 93.53829844636158, -394.6962273176611, 165.17806012955648, -16.836221633191087, 78.39205963667852, 113.7350088265266, 363.9999999999999, 129.70466589374294, 206.93165579863003, -286.99614017531906, -41.61143531149918, 114.24682653415351, -593.0070310402167, 362.7925063032074, 206.7736330586893, -128.02564620816852, -37.54317563071206, -87.9537685035863, 106.1442790711348, 238.83575612935286, 187.170323691838, 288.26450172810337, -375.0456995367797, 176.53697659666307, -413.4882520466868, 15.60985505649737, -327.89389815277815, 305.98390390738774, -418.34714488593266, -150.59547267469335, 351.1913755241636, 75.32761475525129, -184.44152498634512, -37.49302712629794, -145.46209959157997, 189.03369820065927, -11.390212096559841, -60.72941126665835, 47.5428258539445, -20.58628167327778, -127.15476196545669, -116.83641574589973, 68.07170282968923, -127.21933856336133, 88.2780987051809, 222.20553416130923, 28.840534448090942, 215.5799238450069, -33.68535033393688, -73.97020862715269, 125.02974738981129, -46.21875944307425, 108.84969961817275, -421.7749780916572, 220.28997173908098, 201.19172264294113, 301.21291321519186, 40.748310650690755, 257.10233678253974, 69.2717976733122, 216.05677045317606, 231.5646056126689, 35.319594551296944, 52.48716402217958, -77.90886561716435, 199.67009546172255, 340.23094076453293, -549.0573773635375, -59.781915874029224, 291.1132855570572, 131.94477489948798, 160.45472630842556, 177.1651173918656, -11.418641142792453, 95.74754254971404, 324.54010280170036, 257.41416270499826, -43.349653554011965, 273.8548761572587, 324.9237365874373, 43.751714794924766, -358.70905898586955, 171.68684351614544, -33.54926860455498, -390.4810850397281, 4.520863995371393, 71.75708524203748, -55.257102628120094, 196.72770515950754, 300.6448538170445, 40.48069705942194, 181.67677799563873, 126.00046889005151, 0.15987637250162834, -177.693275715666, -108.94014708271868, 242.63882833703457, 245.02606726561433, 46.971971714924535, 311.3312580793634, -174.25811073195598, 61.165563843363046, 215.51296256037276, -31.20368460322735, 184.69125265238546, 275.2779736332838, 39.500928481261504, -305.4207462412372, -2.943055311186662, 92.71539769542797, 205.825147517939, 50.76493504546718, -267.45327225064335, 304.0610561897669, 90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301, 240.33149542397368, 270.60566131772316, 115.1628797072602, 97.91676897740133, 145.55412340725215, -392.8435029578889, -181.05969210333612, 343.3387861087249, 367.9478685444601, -354.37948350709286, 22.169382402228663, 311.63698307482105, -737.6216985872288, -17.808276598118958, 231.82643137316956, 73.69603564708781, -92.77689980394611, 398.2], "policy_predator_policy_reward": [130.71308001665687, 18.21551972257204, 63.59369428093628, 63.49137112127544, 19.159602508114126, 69.76111526951183, 245.29668128432002, 448.9612012216343, 380.9994049343671, 199.78391747233135, 74.62242890605297, 1.0426371339015965, 302.2165741093457, 226.3213028591773, 89.96310131081965, 499.4930819051261, 6.081072730868625, 311.09748900913434, 267.7661812210257, 29.01418296141537, 415.7601581881278, 207.09353947426982, 145.80611625359708, 116.25462112811674, 219.4419833387226, 39.04901691072721, 96.11531850290649, 259.6005069564515, 113.80148197024806, 67.03306165619948, 246.01218707746125, 73.18278720816171, 101.88154124813505, 46.807876575673305, 125.68579269743898, 158.14280570297151, 135.94654325033687, 273.4544152130367, 147.4655875217323, 192.41041167890364, 49.95133386039854, 117.6709769348606, 307.54103725278594, 154.16329085163477, 84.60286151967891, 105.6888692375258, 117.928004234372, 456.19402990094113, 180.51704013840396, 37.59378718077617, 73.97350292204902, 220.47894590305302, 70.57542450114468, 81.99894693835714, 287.1404208614362, 124.31517209939362, 77.81143531149912, 94.45317346584672, 603.3070310402176, 4.407493696792509, 120.22636694131064, 158.32564620816714, 156.27837996446831, 183.81856416982777, 190.15572092886526, 57.486310198593905, 19.260965221240674, 104.97580139767643, 335.48595211746067, 132.35718443782875, 427.24162559431306, 26.636771395878057, 111.80570796737526, 300.2691734629939, 408.58264591157007, 420.80452437970445, 5.108624475836292, 52.97238524474886, 287.137874016384, 42.52989627665654, 249.06209959157874, 59.46630179934089, 60.59021209656027, 96.32941126665771, 244.55099166462634, 23.364551057339337, 352.09681060895593, 139.484538747809, 84.26829606863068, 166.00345752160572, 85.43095144950415, 11.292091379177139, 10.159465551909182, 96.52007615499315, 89.62050042582922, 262.63505853526107, 203.7702526101887, 280.8187594430745, 111.34896841961368, 422.076310053872, 142.87835281078384, 67.85525571069013, 68.78708678480812, 144.9516893493083, 3.097663217460246, 148.82820232668732, 26.40950978047123, 126.96911415368378, 73.36269939711207, 81.23054202941151, 114.50631287595512, 22.83245727948486, 81.47223096200185, 548.685603530857, 128.74085843594474, 88.98841081078632, 157.18930790315324, 149.71119088893283, 148.86051149412052, 272.19245264598135, 104.28514636220606, 76.0396933145873, 68.49703085483164, 64.59160039007425, 7.09106997409692, 108.1509559112347, 136.04828520507508, 512.0090589858706, 236.7908261320644, 75.683235331171, 263.3957283346271, 478.0726749572387, 135.94291475796194, 89.35710262812012, 86.27229484049248, 63.75514618295546, 68.31930294057841, 72.52322200436127, 197.69029773733507, 105.35516991261662, 215.79277238051466, 318.6820987124964, 15.974521750058948, 8.6605826472921, 107.11014944364044, 118.50660359733423, 327.2422847133049, 60.56518738742654, 96.1072122084398, 91.08350983441537, 51.50874734761473, 38.32202636671628, 30.75883661474464, 335.46098114523534, 99.78631467229546, 2.341342943461918, 112.67485248206084, 215.9350649545327, 306.7770227835108, 99.61590184384039, 12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686, 75.9350923319411, 92.49111079616283, 211.39924759109186, 120.80744776615536, 78.18037386876416, 468.2206565479642, 21.433539953519013, 374.53260461108437, 476.5602252033746, 20.717382579056075, 178.80233453904395, 100.1831390674638, 549.7423680108659, 292.8226981141567, 60.27356862683049, 49.90396435291241, 48.52499604662013, 112.52536734290518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.974824314505719, "mean_inference_ms": 5.3759975075420705, "mean_action_processing_ms": 3.080106926105422, "mean_env_wait_ms": 12.518246128815152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007430110314879754, "StateBufferConnector_ms": 0.0052139012500493215, "ViewRequirementAgentConnector_ms": 0.13553614568228672}, "num_episodes": 9, "episode_return_max": 714.0206386300276, "episode_return_min": 56.000000000000526, "episode_return_mean": 371.3558590231846, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.14628481007864, "num_env_steps_trained_throughput_per_sec": 151.14628481007864, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 26836.875, "restore_workers_time_ms": 0.067, "training_step_time_ms": 26836.679, "sample_time_ms": 2508.058, "learn_time_ms": 24299.614, "learn_throughput": 164.612, "synch_weights_time_ms": 23.881}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-41-58", "timestamp": 1724382718, "time_this_iter_s": 26.515605926513672, "time_total_s": 435.04027247428894, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095a6b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 435.04027247428894, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 35.660526315789475, "ram_util_percent": 82.62368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.940837599739196, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.221727285435591, "policy_loss": -0.011746498747733692, "vf_loss": 5.230732130625891, "vf_explained_var": 0.2462902650631294, "kl": 0.013708196625744224, "entropy": 1.2569735918095504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 15593.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.300509996767396, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.9811661230823985, "policy_loss": -0.015361355621584508, "vf_loss": 6.994126966769103, "vf_explained_var": 0.36543860359797403, "kl": 0.012002588968930973, "entropy": 1.4059895615098337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 15593.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 779.0521466860189, "episode_reward_min": 56.000000000000526, "episode_reward_mean": 415.42662300119895, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -881.165602871915, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1043.273031269514}, "policy_reward_mean": {"prey_policy": 46.47947018476494, "predator_policy": 161.23384131583458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [294.30000000000007, 323.4, 511.2334734184982, 272.9641052640102, 366.45266581554597, 486.57951728830767, 646.2790373332451, 331.3911085841402, 244.8999999999995, 377.49999999999943, 357.3000000000017, 214.59999999999914, 592.6220663279468, 599.6715920388606, 269.3344136151678, 56.000000000000526, 390.1648871849786, 260.44455273064415, 484.5999999999995, 107.73321818039892, 352.0999999999998, 84.79999999999944, 294.8720869026316, 247.59017164540865, 191.12411785656477, 407.20667569517104, 351.1000000000006, 244.5999999999991, 563.4000000000001, 220.50000000000006, 632.2153029034961, 555.6999999999994, 478.30000000000007, 601.0000000000006, 242.39999999999918, 259.09999999999894, 421.33139789385496, 449.0606389297601, 599.2999999999996, 586.7994403891755, 600.6124850282097, 347.1531403958925, 714.0206386300276, 333.1, 450.6116363748256, 355.50818224750844, 241.79999999999927, 647.4000000000001, 362.99999999999943, 429.2058129125049, 247.84144829462713, 512.3000000000002, 583.919982835263, 274.7149252121372, 371.5000000000013, 549.7999999999997, 100.29999999999826, 191.8999999999966, 585.2, 443.0007085664735, 528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5, 679.3633598698008, 545.2863440419089, 299.11165086608753, 558.2452385699922, 510.8459928197945, 612.7918390835578, 87.13509093967407, 415.69999999999914, 466.47346358558457, 503.5042281113365, 433.90000000000276, 177.19999999999786, 548.0536977778759, 461.7320284821526, 686.2757541432, 619.614022485918, 585.4959595877826, 522.3651706065749, 361.54143106205083, 409.40000000000225, 320.3498602572639, 322.6830172861262, 751.1912878632459, 367.5605667414895, 629.1740379604217, 655.0389697484862, 409.26229122691853, 426.7595036116011, 432.5238717443745, 779.0521466860189], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [13.428929881609145, 113.24875932313121, -131.59163836778623, -6.712689736635619, 185.21787403401405, 135.72386862728, 93.53829844636158, -394.6962273176611, 165.17806012955648, -16.836221633191087, 78.39205963667852, 113.7350088265266, 363.9999999999999, 129.70466589374294, 206.93165579863003, -286.99614017531906, -41.61143531149918, 114.24682653415351, -593.0070310402167, 362.7925063032074, 206.7736330586893, -128.02564620816852, -37.54317563071206, -87.9537685035863, 106.1442790711348, 238.83575612935286, 187.170323691838, 288.26450172810337, -375.0456995367797, 176.53697659666307, -413.4882520466868, 15.60985505649737, -327.89389815277815, 305.98390390738774, -418.34714488593266, -150.59547267469335, 351.1913755241636, 75.32761475525129, -184.44152498634512, -37.49302712629794, -145.46209959157997, 189.03369820065927, -11.390212096559841, -60.72941126665835, 47.5428258539445, -20.58628167327778, -127.15476196545669, -116.83641574589973, 68.07170282968923, -127.21933856336133, 88.2780987051809, 222.20553416130923, 28.840534448090942, 215.5799238450069, -33.68535033393688, -73.97020862715269, 125.02974738981129, -46.21875944307425, 108.84969961817275, -421.7749780916572, 220.28997173908098, 201.19172264294113, 301.21291321519186, 40.748310650690755, 257.10233678253974, 69.2717976733122, 216.05677045317606, 231.5646056126689, 35.319594551296944, 52.48716402217958, -77.90886561716435, 199.67009546172255, 340.23094076453293, -549.0573773635375, -59.781915874029224, 291.1132855570572, 131.94477489948798, 160.45472630842556, 177.1651173918656, -11.418641142792453, 95.74754254971404, 324.54010280170036, 257.41416270499826, -43.349653554011965, 273.8548761572587, 324.9237365874373, 43.751714794924766, -358.70905898586955, 171.68684351614544, -33.54926860455498, -390.4810850397281, 4.520863995371393, 71.75708524203748, -55.257102628120094, 196.72770515950754, 300.6448538170445, 40.48069705942194, 181.67677799563873, 126.00046889005151, 0.15987637250162834, -177.693275715666, -108.94014708271868, 242.63882833703457, 245.02606726561433, 46.971971714924535, 311.3312580793634, -174.25811073195598, 61.165563843363046, 215.51296256037276, -31.20368460322735, 184.69125265238546, 275.2779736332838, 39.500928481261504, -305.4207462412372, -2.943055311186662, 92.71539769542797, 205.825147517939, 50.76493504546718, -267.45327225064335, 304.0610561897669, 90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301, 240.33149542397368, 270.60566131772316, 115.1628797072602, 97.91676897740133, 145.55412340725215, -392.8435029578889, -181.05969210333612, 343.3387861087249, 367.9478685444601, -354.37948350709286, 22.169382402228663, 311.63698307482105, -737.6216985872288, -17.808276598118958, 231.82643137316956, 73.69603564708781, -92.77689980394611, 398.2, -534.4595726090051, 289.56359034955676, 383.16712792404246, 38.63230389258705, 29.008864920930638, -137.39561999115097, -69.88865010853479, 326.0611836066095, 72.1993185574303, 139.73673556225006, 298.9639252142462, 173.7417267384111, 270.0575930050252, 77.26584045466106, 246.92151274529903, -26.708402466949135, 61.59310486021527, 214.52899041517986, -87.70238340786432, -229.31685049133313, 16.316833197972986, 337.9910862041237, -881.165602871915, 1.233119461587457, 137.95276169814144, -301.0695191695815, 297.1898647191119, 394.7353725178508, 0.020391488308096006, -37.850321475986625, 133.23429533273907, 317.7347176757826, 141.29312305887208, 285.6142346932136, -62.06874282116635, -300.530583698882, 109.93767489503496, -311.58155895884124, -144.10850948703066, -0.9878986781108989, 364.46758684426305, 383.13331828130674], "policy_predator_policy_reward": [49.95133386039854, 117.6709769348606, 307.54103725278594, 154.16329085163477, 84.60286151967891, 105.6888692375258, 117.928004234372, 456.19402990094113, 180.51704013840396, 37.59378718077617, 73.97350292204902, 220.47894590305302, 70.57542450114468, 81.99894693835714, 287.1404208614362, 124.31517209939362, 77.81143531149912, 94.45317346584672, 603.3070310402176, 4.407493696792509, 120.22636694131064, 158.32564620816714, 156.27837996446831, 183.81856416982777, 190.15572092886526, 57.486310198593905, 19.260965221240674, 104.97580139767643, 335.48595211746067, 132.35718443782875, 427.24162559431306, 26.636771395878057, 111.80570796737526, 300.2691734629939, 408.58264591157007, 420.80452437970445, 5.108624475836292, 52.97238524474886, 287.137874016384, 42.52989627665654, 249.06209959157874, 59.46630179934089, 60.59021209656027, 96.32941126665771, 244.55099166462634, 23.364551057339337, 352.09681060895593, 139.484538747809, 84.26829606863068, 166.00345752160572, 85.43095144950415, 11.292091379177139, 10.159465551909182, 96.52007615499315, 89.62050042582922, 262.63505853526107, 203.7702526101887, 280.8187594430745, 111.34896841961368, 422.076310053872, 142.87835281078384, 67.85525571069013, 68.78708678480812, 144.9516893493083, 3.097663217460246, 148.82820232668732, 26.40950978047123, 126.96911415368378, 73.36269939711207, 81.23054202941151, 114.50631287595512, 22.83245727948486, 81.47223096200185, 548.685603530857, 128.74085843594474, 88.98841081078632, 157.18930790315324, 149.71119088893283, 148.86051149412052, 272.19245264598135, 104.28514636220606, 76.0396933145873, 68.49703085483164, 64.59160039007425, 7.09106997409692, 108.1509559112347, 136.04828520507508, 512.0090589858706, 236.7908261320644, 75.683235331171, 263.3957283346271, 478.0726749572387, 135.94291475796194, 89.35710262812012, 86.27229484049248, 63.75514618295546, 68.31930294057841, 72.52322200436127, 197.69029773733507, 105.35516991261662, 215.79277238051466, 318.6820987124964, 15.974521750058948, 8.6605826472921, 107.11014944364044, 118.50660359733423, 327.2422847133049, 60.56518738742654, 96.1072122084398, 91.08350983441537, 51.50874734761473, 38.32202636671628, 30.75883661474464, 335.46098114523534, 99.78631467229546, 2.341342943461918, 112.67485248206084, 215.9350649545327, 306.7770227835108, 99.61590184384039, 12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686, 75.9350923319411, 92.49111079616283, 211.39924759109186, 120.80744776615536, 78.18037386876416, 468.2206565479642, 21.433539953519013, 374.53260461108437, 476.5602252033746, 20.717382579056075, 178.80233453904395, 100.1831390674638, 549.7423680108659, 292.8226981141567, 60.27356862683049, 49.90396435291241, 48.52499604662013, 112.52536734290518, 645.4255009376583, 102.97470943312676, 10.832872075957539, 1.2676961074132267, 150.88237136215963, 134.70438370806002, 132.7685421818718, 159.11262209792943, 69.03485693866614, 180.76111742380436, 129.44599744217797, 84.12410474836463, 159.96623637379895, 112.32435265243274, 235.4624998223701, 129.82034948706237, 135.4301488222461, 110.8129265089332, 547.3411585905981, 131.2195063706471, 22.083166802027016, 33.00891379587628, 1043.273031269514, 157.00931239807664, 238.9225430107628, 246.87723174680372, 59.266050626283246, 0.0, 332.08615115753474, 73.30434557163272, 136.98559591643806, 41.21942903546205, 172.15187869700114, 55.9797332993995, 424.7355259694947, 347.1260917774722, 277.0967689874471, 351.3066186879602, 270.99113215744063, 306.6291477520755, 3.683725363274755, 27.76751619717433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.706253592936314, "mean_inference_ms": 5.313221082175682, "mean_action_processing_ms": 2.9768303942646015, "mean_env_wait_ms": 12.611888303062724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00786280632019043, "StateBufferConnector_ms": 0.00516963005065918, "ViewRequirementAgentConnector_ms": 0.13497841358184814}, "num_episodes": 21, "episode_return_max": 779.0521466860189, "episode_return_min": 56.000000000000526, "episode_return_mean": 415.42662300119895, "episodes_this_iter": 21}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.05843246550842, "num_env_steps_trained_throughput_per_sec": 152.05843246550842, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 26755.964, "restore_workers_time_ms": 0.066, "training_step_time_ms": 26755.773, "sample_time_ms": 2486.207, "learn_time_ms": 24241.512, "learn_throughput": 165.006, "synch_weights_time_ms": 23.12}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-42-25", "timestamp": 1724382745, "time_this_iter_s": 26.353440046310425, "time_total_s": 461.39371252059937, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08ca430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 461.39371252059937, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 35.67837837837838, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.275125931810449, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.7111262861383025, "policy_loss": -0.01310604614250007, "vf_loss": 6.721710833796749, "vf_explained_var": 0.23538578193654458, "kl": 0.012607560170292065, "entropy": 1.092498790776288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16538.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.945565134507639, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.5871789932250975, "policy_loss": -0.013645906660400291, "vf_loss": 7.598567226954869, "vf_explained_var": 0.33147331924034806, "kl": 0.011288283864361426, "entropy": 1.3452680319074601, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16538.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 779.0521466860189, "episode_reward_min": 66.60000000000049, "episode_reward_mean": 443.17188095210173, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -881.165602871915, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1043.273031269514}, "policy_reward_mean": {"prey_policy": 36.79482713415639, "predator_policy": 184.7911133418944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [247.59017164540865, 191.12411785656477, 407.20667569517104, 351.1000000000006, 244.5999999999991, 563.4000000000001, 220.50000000000006, 632.2153029034961, 555.6999999999994, 478.30000000000007, 601.0000000000006, 242.39999999999918, 259.09999999999894, 421.33139789385496, 449.0606389297601, 599.2999999999996, 586.7994403891755, 600.6124850282097, 347.1531403958925, 714.0206386300276, 333.1, 450.6116363748256, 355.50818224750844, 241.79999999999927, 647.4000000000001, 362.99999999999943, 429.2058129125049, 247.84144829462713, 512.3000000000002, 583.919982835263, 274.7149252121372, 371.5000000000013, 549.7999999999997, 100.29999999999826, 191.8999999999966, 585.2, 443.0007085664735, 528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5, 679.3633598698008, 545.2863440419089, 299.11165086608753, 558.2452385699922, 510.8459928197945, 612.7918390835578, 87.13509093967407, 415.69999999999914, 466.47346358558457, 503.5042281113365, 433.90000000000276, 177.19999999999786, 548.0536977778759, 461.7320284821526, 686.2757541432, 619.614022485918, 585.4959595877826, 522.3651706065749, 361.54143106205083, 409.40000000000225, 320.3498602572639, 322.6830172861262, 751.1912878632459, 367.5605667414895, 629.1740379604217, 655.0389697484862, 409.26229122691853, 426.7595036116011, 432.5238717443745, 779.0521466860189, 469.96317553210554, 398.49032043313457, 371.49340138858616, 635.3461815996798, 569.6552063085171, 100.73875207586195, 370.03076883038455, 336.8268372816917, 290.92099129830825, 526.8762436612028, 417.4000000000023, 290.30701154293695, 688.2495486391783, 478.3412846072389, 646.8266494240241, 487.94963350376054, 397.60000000000207, 285.6656418630642, 633.4279677397544, 510.3775916119351, 543.6012978636885, 654.0715583049785, 589.6084562646175], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-127.15476196545669, -116.83641574589973, 68.07170282968923, -127.21933856336133, 88.2780987051809, 222.20553416130923, 28.840534448090942, 215.5799238450069, -33.68535033393688, -73.97020862715269, 125.02974738981129, -46.21875944307425, 108.84969961817275, -421.7749780916572, 220.28997173908098, 201.19172264294113, 301.21291321519186, 40.748310650690755, 257.10233678253974, 69.2717976733122, 216.05677045317606, 231.5646056126689, 35.319594551296944, 52.48716402217958, -77.90886561716435, 199.67009546172255, 340.23094076453293, -549.0573773635375, -59.781915874029224, 291.1132855570572, 131.94477489948798, 160.45472630842556, 177.1651173918656, -11.418641142792453, 95.74754254971404, 324.54010280170036, 257.41416270499826, -43.349653554011965, 273.8548761572587, 324.9237365874373, 43.751714794924766, -358.70905898586955, 171.68684351614544, -33.54926860455498, -390.4810850397281, 4.520863995371393, 71.75708524203748, -55.257102628120094, 196.72770515950754, 300.6448538170445, 40.48069705942194, 181.67677799563873, 126.00046889005151, 0.15987637250162834, -177.693275715666, -108.94014708271868, 242.63882833703457, 245.02606726561433, 46.971971714924535, 311.3312580793634, -174.25811073195598, 61.165563843363046, 215.51296256037276, -31.20368460322735, 184.69125265238546, 275.2779736332838, 39.500928481261504, -305.4207462412372, -2.943055311186662, 92.71539769542797, 205.825147517939, 50.76493504546718, -267.45327225064335, 304.0610561897669, 90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301, 240.33149542397368, 270.60566131772316, 115.1628797072602, 97.91676897740133, 145.55412340725215, -392.8435029578889, -181.05969210333612, 343.3387861087249, 367.9478685444601, -354.37948350709286, 22.169382402228663, 311.63698307482105, -737.6216985872288, -17.808276598118958, 231.82643137316956, 73.69603564708781, -92.77689980394611, 398.2, -534.4595726090051, 289.56359034955676, 383.16712792404246, 38.63230389258705, 29.008864920930638, -137.39561999115097, -69.88865010853479, 326.0611836066095, 72.1993185574303, 139.73673556225006, 298.9639252142462, 173.7417267384111, 270.0575930050252, 77.26584045466106, 246.92151274529903, -26.708402466949135, 61.59310486021527, 214.52899041517986, -87.70238340786432, -229.31685049133313, 16.316833197972986, 337.9910862041237, -881.165602871915, 1.233119461587457, 137.95276169814144, -301.0695191695815, 297.1898647191119, 394.7353725178508, 0.020391488308096006, -37.850321475986625, 133.23429533273907, 317.7347176757826, 141.29312305887208, 285.6142346932136, -62.06874282116635, -300.530583698882, 109.93767489503496, -311.58155895884124, -144.10850948703066, -0.9878986781108989, 364.46758684426305, 383.13331828130674, -299.812934259479, 197.7713215703573, 100.31269974351709, -411.245013325922, -220.08038336541637, -153.0209887139161, 318.9025062206067, 116.1942548522233, -95.00152499488598, 195.50957338559542, -6.708503262406525, -692.8863386423267, 271.33356725072207, -795.9850824744505, -448.47662399846115, -398.3180704167241, -721.756061787946, 64.99274487935622, -15.098352329470103, -8.225870395815951, 355.4400645612677, 31.80469672738277, 38.65728856026385, -260.49883454628696, 4.324570061431969, 326.38160378467404, 45.09581008874023, -197.28107038581737, 239.6225347665416, -12.692774301077627, -14.617241753502867, -35.05066985329697, 20.199962055634156, 296.19109889552783, -548.970374361195, 112.3093518503741, -42.586819633592235, 268.19109336812807, -154.4516143578185, 332.2844374250176, 254.84490871489962, -344.7869440383453, 243.4616493946102, 182.877928378011, 60.41373349428567, 257.612340093485], "policy_predator_policy_reward": [352.09681060895593, 139.484538747809, 84.26829606863068, 166.00345752160572, 85.43095144950415, 11.292091379177139, 10.159465551909182, 96.52007615499315, 89.62050042582922, 262.63505853526107, 203.7702526101887, 280.8187594430745, 111.34896841961368, 422.076310053872, 142.87835281078384, 67.85525571069013, 68.78708678480812, 144.9516893493083, 3.097663217460246, 148.82820232668732, 26.40950978047123, 126.96911415368378, 73.36269939711207, 81.23054202941151, 114.50631287595512, 22.83245727948486, 81.47223096200185, 548.685603530857, 128.74085843594474, 88.98841081078632, 157.18930790315324, 149.71119088893283, 148.86051149412052, 272.19245264598135, 104.28514636220606, 76.0396933145873, 68.49703085483164, 64.59160039007425, 7.09106997409692, 108.1509559112347, 136.04828520507508, 512.0090589858706, 236.7908261320644, 75.683235331171, 263.3957283346271, 478.0726749572387, 135.94291475796194, 89.35710262812012, 86.27229484049248, 63.75514618295546, 68.31930294057841, 72.52322200436127, 197.69029773733507, 105.35516991261662, 215.79277238051466, 318.6820987124964, 15.974521750058948, 8.6605826472921, 107.11014944364044, 118.50660359733423, 327.2422847133049, 60.56518738742654, 96.1072122084398, 91.08350983441537, 51.50874734761473, 38.32202636671628, 30.75883661474464, 335.46098114523534, 99.78631467229546, 2.341342943461918, 112.67485248206084, 215.9350649545327, 306.7770227835108, 99.61590184384039, 12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686, 75.9350923319411, 92.49111079616283, 211.39924759109186, 120.80744776615536, 78.18037386876416, 468.2206565479642, 21.433539953519013, 374.53260461108437, 476.5602252033746, 20.717382579056075, 178.80233453904395, 100.1831390674638, 549.7423680108659, 292.8226981141567, 60.27356862683049, 49.90396435291241, 48.52499604662013, 112.52536734290518, 645.4255009376583, 102.97470943312676, 10.832872075957539, 1.2676961074132267, 150.88237136215963, 134.70438370806002, 132.7685421818718, 159.11262209792943, 69.03485693866614, 180.76111742380436, 129.44599744217797, 84.12410474836463, 159.96623637379895, 112.32435265243274, 235.4624998223701, 129.82034948706237, 135.4301488222461, 110.8129265089332, 547.3411585905981, 131.2195063706471, 22.083166802027016, 33.00891379587628, 1043.273031269514, 157.00931239807664, 238.9225430107628, 246.87723174680372, 59.266050626283246, 0.0, 332.08615115753474, 73.30434557163272, 136.98559591643806, 41.21942903546205, 172.15187869700114, 55.9797332993995, 424.7355259694947, 347.1260917774722, 277.0967689874471, 351.3066186879602, 270.99113215744063, 306.6291477520755, 3.683725363274755, 27.76751619717433, 216.45165753671805, 355.55313068450766, 506.22993480256065, 203.19269921297976, 145.09719236290542, 599.4975811050127, 169.9789004963823, 30.270520030467427, 79.96276249977772, 389.18439541803, 66.48074912017982, 733.8528448604148, 85.06833058586001, 809.6139534682544, 649.3699696208112, 534.2515620760656, 918.2599990234216, 29.424309183476872, 224.54019018245975, 325.6602762040277, 2.062064274080654, 28.093174437269045, 117.26468435688449, 394.88387317207395, 238.15432147900682, 119.38905331406586, 88.62631755817331, 541.900227346143, 326.2980087779579, 93.59888018060234, 217.71824441178137, 319.8993006987787, 18.400037944365845, 62.808901104472156, 247.60164638327578, 474.7250179906096, 282.1295420526825, 125.69415195253568, 189.17980509080977, 143.3649634539251, 423.6566951084699, 209.8866380786645, 63.235788670567416, 164.4961918617893, 176.96604837818398, 94.61633429866153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.496711453624936, "mean_inference_ms": 5.315570454004774, "mean_action_processing_ms": 2.6853917420891524, "mean_env_wait_ms": 12.654069814382224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007977843284606934, "StateBufferConnector_ms": 0.004786014556884766, "ViewRequirementAgentConnector_ms": 0.1202232837677002}, "num_episodes": 23, "episode_return_max": 779.0521466860189, "episode_return_min": 66.60000000000049, "episode_return_mean": 443.17188095210173, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.73235557507036, "num_env_steps_trained_throughput_per_sec": 150.73235557507036, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 26704.625, "restore_workers_time_ms": 0.066, "training_step_time_ms": 26704.368, "sample_time_ms": 2486.883, "learn_time_ms": 24190.093, "learn_throughput": 165.357, "synch_weights_time_ms": 22.291}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-42-51", "timestamp": 1724382771, "time_this_iter_s": 26.582256078720093, "time_total_s": 487.97596859931946, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30955cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 487.97596859931946, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.002631578947366, "ram_util_percent": 82.96578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.621297580602938, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.165827282395943, "policy_loss": -0.014948827913277363, "vf_loss": 8.178497970419587, "vf_explained_var": 0.1773792514725337, "kl": 0.011390798816348982, "entropy": 0.9108908882216802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17483.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.83670636081191, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.968580570927372, "policy_loss": -0.013330737270030474, "vf_loss": 7.979443372998919, "vf_explained_var": 0.2452314050740035, "kl": 0.012339794572699007, "entropy": 1.2570750786513878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17483.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 779.0521466860189, "episode_reward_min": 66.60000000000049, "episode_reward_mean": 435.02259041587973, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -924.1716726199357, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1043.273031269514}, "policy_reward_mean": {"prey_policy": -8.146840598385593, "predator_policy": 225.65813580632533}, "custom_metrics": {}, "hist_stats": {"episode_reward": [247.84144829462713, 512.3000000000002, 583.919982835263, 274.7149252121372, 371.5000000000013, 549.7999999999997, 100.29999999999826, 191.8999999999966, 585.2, 443.0007085664735, 528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5, 679.3633598698008, 545.2863440419089, 299.11165086608753, 558.2452385699922, 510.8459928197945, 612.7918390835578, 87.13509093967407, 415.69999999999914, 466.47346358558457, 503.5042281113365, 433.90000000000276, 177.19999999999786, 548.0536977778759, 461.7320284821526, 686.2757541432, 619.614022485918, 585.4959595877826, 522.3651706065749, 361.54143106205083, 409.40000000000225, 320.3498602572639, 322.6830172861262, 751.1912878632459, 367.5605667414895, 629.1740379604217, 655.0389697484862, 409.26229122691853, 426.7595036116011, 432.5238717443745, 779.0521466860189, 469.96317553210554, 398.49032043313457, 371.49340138858616, 635.3461815996798, 569.6552063085171, 100.73875207586195, 370.03076883038455, 336.8268372816917, 290.92099129830825, 526.8762436612028, 417.4000000000023, 290.30701154293695, 688.2495486391783, 478.3412846072389, 646.8266494240241, 487.94963350376054, 397.60000000000207, 285.6656418630642, 633.4279677397544, 510.3775916119351, 543.6012978636885, 654.0715583049785, 589.6084562646175, 244.56255912386055, 322.26904956773376, 212.6519315936305, 534.4385036916983, 351.1000000000022, 330.68236050383166, 86.80313024462959, 339.20000000000266, 458.60000000000036, 235.27227269414703, 544.7000000000005, 439.18714791204854, 170.7999999999976, 605.4979082494501, 507.15695588239174, 409.93028498756513, 421.3750390599801, 737.8971079740752, 454.88711308959057, 282.1000000000007, 372.19090884154605, 280.52616004570245, 495.92375756879517, 364.50954421979407, 398.48214154982105, 649.8548170323871, 467.6118934475162], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-177.693275715666, -108.94014708271868, 242.63882833703457, 245.02606726561433, 46.971971714924535, 311.3312580793634, -174.25811073195598, 61.165563843363046, 215.51296256037276, -31.20368460322735, 184.69125265238546, 275.2779736332838, 39.500928481261504, -305.4207462412372, -2.943055311186662, 92.71539769542797, 205.825147517939, 50.76493504546718, -267.45327225064335, 304.0610561897669, 90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301, 240.33149542397368, 270.60566131772316, 115.1628797072602, 97.91676897740133, 145.55412340725215, -392.8435029578889, -181.05969210333612, 343.3387861087249, 367.9478685444601, -354.37948350709286, 22.169382402228663, 311.63698307482105, -737.6216985872288, -17.808276598118958, 231.82643137316956, 73.69603564708781, -92.77689980394611, 398.2, -534.4595726090051, 289.56359034955676, 383.16712792404246, 38.63230389258705, 29.008864920930638, -137.39561999115097, -69.88865010853479, 326.0611836066095, 72.1993185574303, 139.73673556225006, 298.9639252142462, 173.7417267384111, 270.0575930050252, 77.26584045466106, 246.92151274529903, -26.708402466949135, 61.59310486021527, 214.52899041517986, -87.70238340786432, -229.31685049133313, 16.316833197972986, 337.9910862041237, -881.165602871915, 1.233119461587457, 137.95276169814144, -301.0695191695815, 297.1898647191119, 394.7353725178508, 0.020391488308096006, -37.850321475986625, 133.23429533273907, 317.7347176757826, 141.29312305887208, 285.6142346932136, -62.06874282116635, -300.530583698882, 109.93767489503496, -311.58155895884124, -144.10850948703066, -0.9878986781108989, 364.46758684426305, 383.13331828130674, -299.812934259479, 197.7713215703573, 100.31269974351709, -411.245013325922, -220.08038336541637, -153.0209887139161, 318.9025062206067, 116.1942548522233, -95.00152499488598, 195.50957338559542, -6.708503262406525, -692.8863386423267, 271.33356725072207, -795.9850824744505, -448.47662399846115, -398.3180704167241, -721.756061787946, 64.99274487935622, -15.098352329470103, -8.225870395815951, 355.4400645612677, 31.80469672738277, 38.65728856026385, -260.49883454628696, 4.324570061431969, 326.38160378467404, 45.09581008874023, -197.28107038581737, 239.6225347665416, -12.692774301077627, -14.617241753502867, -35.05066985329697, 20.199962055634156, 296.19109889552783, -548.970374361195, 112.3093518503741, -42.586819633592235, 268.19109336812807, -154.4516143578185, 332.2844374250176, 254.84490871489962, -344.7869440383453, 243.4616493946102, 182.877928378011, 60.41373349428567, 257.612340093485, 24.420524753830417, -697.4403880989877, 22.758741709604596, -73.64547074452366, 24.860097120199793, -745.9167418610697, 24.449191418496845, 166.26053920259355, -164.36622956636893, 114.18297579997747, -291.44702510648904, 61.04832489273776, -587.8810729877723, -739.9033711549323, -23.874138718391418, 31.86074489435106, -409.4833446417295, 330.3421654690543, -605.2777033089416, 110.39260018163303, 87.24101835425553, 213.6416748052298, 22.97368654627499, -145.57617121786674, -135.13375990476143, -36.625401527697846, 132.75120706979885, 295.1226915191962, -78.8449975696461, 13.006025442007006, -85.83114828040866, -111.26622640372527, -336.45220268432394, 111.81417331014214, 202.3549457362579, 383.42716269035077, 50.88825523424299, 10.867700172177347, -63.70732055564516, -20.95955578908135, 329.11963902890216, -924.1716726199357, -456.36975418181015, -359.62701115994645, -8.424662772447535, -175.23546052755364, -523.7547258955839, -126.93549959946131, -119.65987047783797, 98.96098191467533, 171.1381792093012, 57.37785672086917, -314.1555287829958, -47.43429877778343], "policy_predator_policy_reward": [215.79277238051466, 318.6820987124964, 15.974521750058948, 8.6605826472921, 107.11014944364044, 118.50660359733423, 327.2422847133049, 60.56518738742654, 96.1072122084398, 91.08350983441537, 51.50874734761473, 38.32202636671628, 30.75883661474464, 335.46098114523534, 99.78631467229546, 2.341342943461918, 112.67485248206084, 215.9350649545327, 306.7770227835108, 99.61590184384039, 12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686, 75.9350923319411, 92.49111079616283, 211.39924759109186, 120.80744776615536, 78.18037386876416, 468.2206565479642, 21.433539953519013, 374.53260461108437, 476.5602252033746, 20.717382579056075, 178.80233453904395, 100.1831390674638, 549.7423680108659, 292.8226981141567, 60.27356862683049, 49.90396435291241, 48.52499604662013, 112.52536734290518, 645.4255009376583, 102.97470943312676, 10.832872075957539, 1.2676961074132267, 150.88237136215963, 134.70438370806002, 132.7685421818718, 159.11262209792943, 69.03485693866614, 180.76111742380436, 129.44599744217797, 84.12410474836463, 159.96623637379895, 112.32435265243274, 235.4624998223701, 129.82034948706237, 135.4301488222461, 110.8129265089332, 547.3411585905981, 131.2195063706471, 22.083166802027016, 33.00891379587628, 1043.273031269514, 157.00931239807664, 238.9225430107628, 246.87723174680372, 59.266050626283246, 0.0, 332.08615115753474, 73.30434557163272, 136.98559591643806, 41.21942903546205, 172.15187869700114, 55.9797332993995, 424.7355259694947, 347.1260917774722, 277.0967689874471, 351.3066186879602, 270.99113215744063, 306.6291477520755, 3.683725363274755, 27.76751619717433, 216.45165753671805, 355.55313068450766, 506.22993480256065, 203.19269921297976, 145.09719236290542, 599.4975811050127, 169.9789004963823, 30.270520030467427, 79.96276249977772, 389.18439541803, 66.48074912017982, 733.8528448604148, 85.06833058586001, 809.6139534682544, 649.3699696208112, 534.2515620760656, 918.2599990234216, 29.424309183476872, 224.54019018245975, 325.6602762040277, 2.062064274080654, 28.093174437269045, 117.26468435688449, 394.88387317207395, 238.15432147900682, 119.38905331406586, 88.62631755817331, 541.900227346143, 326.2980087779579, 93.59888018060234, 217.71824441178137, 319.8993006987787, 18.400037944365845, 62.808901104472156, 247.60164638327578, 474.7250179906096, 282.1295420526825, 125.69415195253568, 189.17980509080977, 143.3649634539251, 423.6566951084699, 209.8866380786645, 63.235788670567416, 164.4961918617893, 176.96604837818398, 94.61633429866153, 270.9187388614763, 646.6636836075431, 349.00591943580616, 24.149859166843786, 448.7111272977175, 484.9974490367827, 185.09577779238612, 158.6329952782218, 195.26622956636749, 206.0170242000228, 0.0, 561.0810607175825, 383.19884644625176, 1031.3887279410847, 323.8741387183916, 7.339255105649114, 489.3833446417314, 48.35783453094567, 513.7311408993503, 216.42623492210544, 59.27307282802838, 184.54423401248619, 151.97129954120865, 409.81833304243037, 88.31582305817467, 254.24333837428352, 169.55867056344243, 8.065339097013066, 282.6402952607315, 290.3556327492969, 80.75861197883157, 526.2690476928673, 151.77361558183358, 494.2394528523272, 146.64505426374203, 5.469945283724417, 161.8773200012139, 231.25383768195164, 307.4550212875491, 59.31185505717772, 351.2185979597991, 616.0243444727807, 549.8855840422169, 546.6373413452424, 273.5900166806395, 405.9938641881548, 697.9608555361982, 317.23891417864036, 363.15987047783835, 56.021159635146795, 276.7624346038188, 144.57634649839812, 72.63166648710526, 756.5700545211901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.2153742617682495, "mean_inference_ms": 5.15458390754301, "mean_action_processing_ms": 2.47805734716725, "mean_env_wait_ms": 12.74323275784871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006436467170715332, "StateBufferConnector_ms": 0.004189252853393555, "ViewRequirementAgentConnector_ms": 0.15225112438201904}, "num_episodes": 27, "episode_return_max": 779.0521466860189, "episode_return_min": 66.60000000000049, "episode_return_mean": 435.02259041587973, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.8248544824594, "num_env_steps_trained_throughput_per_sec": 147.8248544824594, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 26651.13, "restore_workers_time_ms": 0.04, "training_step_time_ms": 26650.908, "sample_time_ms": 2487.476, "learn_time_ms": 24136.14, "learn_throughput": 165.727, "synch_weights_time_ms": 22.099}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-43-19", "timestamp": 1724382799, "time_this_iter_s": 27.112966775894165, "time_total_s": 515.0889353752136, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309568790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 515.0889353752136, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 36.920512820512826, "ram_util_percent": 83.02564102564101}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.773227979329528, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.455548375245755, "policy_loss": -0.009681333404369455, "vf_loss": 8.463542116255987, "vf_explained_var": 0.1833418396414903, "kl": 0.008437974470859718, "entropy": 0.8509193832912142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 18428.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.99979762879629, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.459419695031706, "policy_loss": -0.011782208122756509, "vf_loss": 8.468923228127617, "vf_explained_var": 0.2985423408488117, "kl": 0.011393303796156216, "entropy": 1.2369334727998764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 18428.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 779.0521466860189, "episode_reward_min": 66.60000000000049, "episode_reward_mean": 433.48039586286853, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -924.1716726199357, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1043.273031269514}, "policy_reward_mean": {"prey_policy": -33.293953088704654, "predator_policy": 250.03415102013875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5, 679.3633598698008, 545.2863440419089, 299.11165086608753, 558.2452385699922, 510.8459928197945, 612.7918390835578, 87.13509093967407, 415.69999999999914, 466.47346358558457, 503.5042281113365, 433.90000000000276, 177.19999999999786, 548.0536977778759, 461.7320284821526, 686.2757541432, 619.614022485918, 585.4959595877826, 522.3651706065749, 361.54143106205083, 409.40000000000225, 320.3498602572639, 322.6830172861262, 751.1912878632459, 367.5605667414895, 629.1740379604217, 655.0389697484862, 409.26229122691853, 426.7595036116011, 432.5238717443745, 779.0521466860189, 469.96317553210554, 398.49032043313457, 371.49340138858616, 635.3461815996798, 569.6552063085171, 100.73875207586195, 370.03076883038455, 336.8268372816917, 290.92099129830825, 526.8762436612028, 417.4000000000023, 290.30701154293695, 688.2495486391783, 478.3412846072389, 646.8266494240241, 487.94963350376054, 397.60000000000207, 285.6656418630642, 633.4279677397544, 510.3775916119351, 543.6012978636885, 654.0715583049785, 589.6084562646175, 244.56255912386055, 322.26904956773376, 212.6519315936305, 534.4385036916983, 351.1000000000022, 330.68236050383166, 86.80313024462959, 339.20000000000266, 458.60000000000036, 235.27227269414703, 544.7000000000005, 439.18714791204854, 170.7999999999976, 605.4979082494501, 507.15695588239174, 409.93028498756513, 421.3750390599801, 737.8971079740752, 454.88711308959057, 282.1000000000007, 372.19090884154605, 280.52616004570245, 495.92375756879517, 364.50954421979407, 398.48214154982105, 649.8548170323871, 467.6118934475162, 401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301, 240.33149542397368, 270.60566131772316, 115.1628797072602, 97.91676897740133, 145.55412340725215, -392.8435029578889, -181.05969210333612, 343.3387861087249, 367.9478685444601, -354.37948350709286, 22.169382402228663, 311.63698307482105, -737.6216985872288, -17.808276598118958, 231.82643137316956, 73.69603564708781, -92.77689980394611, 398.2, -534.4595726090051, 289.56359034955676, 383.16712792404246, 38.63230389258705, 29.008864920930638, -137.39561999115097, -69.88865010853479, 326.0611836066095, 72.1993185574303, 139.73673556225006, 298.9639252142462, 173.7417267384111, 270.0575930050252, 77.26584045466106, 246.92151274529903, -26.708402466949135, 61.59310486021527, 214.52899041517986, -87.70238340786432, -229.31685049133313, 16.316833197972986, 337.9910862041237, -881.165602871915, 1.233119461587457, 137.95276169814144, -301.0695191695815, 297.1898647191119, 394.7353725178508, 0.020391488308096006, -37.850321475986625, 133.23429533273907, 317.7347176757826, 141.29312305887208, 285.6142346932136, -62.06874282116635, -300.530583698882, 109.93767489503496, -311.58155895884124, -144.10850948703066, -0.9878986781108989, 364.46758684426305, 383.13331828130674, -299.812934259479, 197.7713215703573, 100.31269974351709, -411.245013325922, -220.08038336541637, -153.0209887139161, 318.9025062206067, 116.1942548522233, -95.00152499488598, 195.50957338559542, -6.708503262406525, -692.8863386423267, 271.33356725072207, -795.9850824744505, -448.47662399846115, -398.3180704167241, -721.756061787946, 64.99274487935622, -15.098352329470103, -8.225870395815951, 355.4400645612677, 31.80469672738277, 38.65728856026385, -260.49883454628696, 4.324570061431969, 326.38160378467404, 45.09581008874023, -197.28107038581737, 239.6225347665416, -12.692774301077627, -14.617241753502867, -35.05066985329697, 20.199962055634156, 296.19109889552783, -548.970374361195, 112.3093518503741, -42.586819633592235, 268.19109336812807, -154.4516143578185, 332.2844374250176, 254.84490871489962, -344.7869440383453, 243.4616493946102, 182.877928378011, 60.41373349428567, 257.612340093485, 24.420524753830417, -697.4403880989877, 22.758741709604596, -73.64547074452366, 24.860097120199793, -745.9167418610697, 24.449191418496845, 166.26053920259355, -164.36622956636893, 114.18297579997747, -291.44702510648904, 61.04832489273776, -587.8810729877723, -739.9033711549323, -23.874138718391418, 31.86074489435106, -409.4833446417295, 330.3421654690543, -605.2777033089416, 110.39260018163303, 87.24101835425553, 213.6416748052298, 22.97368654627499, -145.57617121786674, -135.13375990476143, -36.625401527697846, 132.75120706979885, 295.1226915191962, -78.8449975696461, 13.006025442007006, -85.83114828040866, -111.26622640372527, -336.45220268432394, 111.81417331014214, 202.3549457362579, 383.42716269035077, 50.88825523424299, 10.867700172177347, -63.70732055564516, -20.95955578908135, 329.11963902890216, -924.1716726199357, -456.36975418181015, -359.62701115994645, -8.424662772447535, -175.23546052755364, -523.7547258955839, -126.93549959946131, -119.65987047783797, 98.96098191467533, 171.1381792093012, 57.37785672086917, -314.1555287829958, -47.43429877778343, -55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448], "policy_predator_policy_reward": [12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686, 75.9350923319411, 92.49111079616283, 211.39924759109186, 120.80744776615536, 78.18037386876416, 468.2206565479642, 21.433539953519013, 374.53260461108437, 476.5602252033746, 20.717382579056075, 178.80233453904395, 100.1831390674638, 549.7423680108659, 292.8226981141567, 60.27356862683049, 49.90396435291241, 48.52499604662013, 112.52536734290518, 645.4255009376583, 102.97470943312676, 10.832872075957539, 1.2676961074132267, 150.88237136215963, 134.70438370806002, 132.7685421818718, 159.11262209792943, 69.03485693866614, 180.76111742380436, 129.44599744217797, 84.12410474836463, 159.96623637379895, 112.32435265243274, 235.4624998223701, 129.82034948706237, 135.4301488222461, 110.8129265089332, 547.3411585905981, 131.2195063706471, 22.083166802027016, 33.00891379587628, 1043.273031269514, 157.00931239807664, 238.9225430107628, 246.87723174680372, 59.266050626283246, 0.0, 332.08615115753474, 73.30434557163272, 136.98559591643806, 41.21942903546205, 172.15187869700114, 55.9797332993995, 424.7355259694947, 347.1260917774722, 277.0967689874471, 351.3066186879602, 270.99113215744063, 306.6291477520755, 3.683725363274755, 27.76751619717433, 216.45165753671805, 355.55313068450766, 506.22993480256065, 203.19269921297976, 145.09719236290542, 599.4975811050127, 169.9789004963823, 30.270520030467427, 79.96276249977772, 389.18439541803, 66.48074912017982, 733.8528448604148, 85.06833058586001, 809.6139534682544, 649.3699696208112, 534.2515620760656, 918.2599990234216, 29.424309183476872, 224.54019018245975, 325.6602762040277, 2.062064274080654, 28.093174437269045, 117.26468435688449, 394.88387317207395, 238.15432147900682, 119.38905331406586, 88.62631755817331, 541.900227346143, 326.2980087779579, 93.59888018060234, 217.71824441178137, 319.8993006987787, 18.400037944365845, 62.808901104472156, 247.60164638327578, 474.7250179906096, 282.1295420526825, 125.69415195253568, 189.17980509080977, 143.3649634539251, 423.6566951084699, 209.8866380786645, 63.235788670567416, 164.4961918617893, 176.96604837818398, 94.61633429866153, 270.9187388614763, 646.6636836075431, 349.00591943580616, 24.149859166843786, 448.7111272977175, 484.9974490367827, 185.09577779238612, 158.6329952782218, 195.26622956636749, 206.0170242000228, 0.0, 561.0810607175825, 383.19884644625176, 1031.3887279410847, 323.8741387183916, 7.339255105649114, 489.3833446417314, 48.35783453094567, 513.7311408993503, 216.42623492210544, 59.27307282802838, 184.54423401248619, 151.97129954120865, 409.81833304243037, 88.31582305817467, 254.24333837428352, 169.55867056344243, 8.065339097013066, 282.6402952607315, 290.3556327492969, 80.75861197883157, 526.2690476928673, 151.77361558183358, 494.2394528523272, 146.64505426374203, 5.469945283724417, 161.8773200012139, 231.25383768195164, 307.4550212875491, 59.31185505717772, 351.2185979597991, 616.0243444727807, 549.8855840422169, 546.6373413452424, 273.5900166806395, 405.9938641881548, 697.9608555361982, 317.23891417864036, 363.15987047783835, 56.021159635146795, 276.7624346038188, 144.57634649839812, 72.63166648710526, 756.5700545211901, 292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.121129342113097, "mean_inference_ms": 5.129331458321445, "mean_action_processing_ms": 2.4391533181151615, "mean_env_wait_ms": 12.73220531975079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065348148345947266, "StateBufferConnector_ms": 0.0042389631271362305, "ViewRequirementAgentConnector_ms": 0.16883599758148193}, "num_episodes": 10, "episode_return_max": 779.0521466860189, "episode_return_min": 66.60000000000049, "episode_return_mean": 433.48039586286853, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.1997293099001, "num_env_steps_trained_throughput_per_sec": 144.1997293099001, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 26706.073, "restore_workers_time_ms": 0.04, "training_step_time_ms": 26705.851, "sample_time_ms": 2577.732, "learn_time_ms": 24101.353, "learn_throughput": 165.966, "synch_weights_time_ms": 22.041}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-43-46", "timestamp": 1724382826, "time_this_iter_s": 27.790835857391357, "time_total_s": 542.879771232605, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08b8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 542.879771232605, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 39.22820512820513, "ram_util_percent": 83.09743589743589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.111552716562987, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.589710746744952, "policy_loss": -0.011492984450703103, "vf_loss": 8.599409965232567, "vf_explained_var": 0.17818343103247344, "kl": 0.008968822029296053, "entropy": 0.8017008573920639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19373.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.406957202235226, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.660906084252414, "policy_loss": -0.010162540164002509, "vf_loss": 8.66891259844341, "vf_explained_var": 0.17122115073380648, "kl": 0.010780171117937517, "entropy": 1.2435631975295052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19373.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 779.0521466860189, "episode_reward_min": 66.60000000000049, "episode_reward_mean": 433.48039586286853, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -924.1716726199357, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1043.273031269514}, "policy_reward_mean": {"prey_policy": -33.293953088704654, "predator_policy": 250.03415102013875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5, 679.3633598698008, 545.2863440419089, 299.11165086608753, 558.2452385699922, 510.8459928197945, 612.7918390835578, 87.13509093967407, 415.69999999999914, 466.47346358558457, 503.5042281113365, 433.90000000000276, 177.19999999999786, 548.0536977778759, 461.7320284821526, 686.2757541432, 619.614022485918, 585.4959595877826, 522.3651706065749, 361.54143106205083, 409.40000000000225, 320.3498602572639, 322.6830172861262, 751.1912878632459, 367.5605667414895, 629.1740379604217, 655.0389697484862, 409.26229122691853, 426.7595036116011, 432.5238717443745, 779.0521466860189, 469.96317553210554, 398.49032043313457, 371.49340138858616, 635.3461815996798, 569.6552063085171, 100.73875207586195, 370.03076883038455, 336.8268372816917, 290.92099129830825, 526.8762436612028, 417.4000000000023, 290.30701154293695, 688.2495486391783, 478.3412846072389, 646.8266494240241, 487.94963350376054, 397.60000000000207, 285.6656418630642, 633.4279677397544, 510.3775916119351, 543.6012978636885, 654.0715583049785, 589.6084562646175, 244.56255912386055, 322.26904956773376, 212.6519315936305, 534.4385036916983, 351.1000000000022, 330.68236050383166, 86.80313024462959, 339.20000000000266, 458.60000000000036, 235.27227269414703, 544.7000000000005, 439.18714791204854, 170.7999999999976, 605.4979082494501, 507.15695588239174, 409.93028498756513, 421.3750390599801, 737.8971079740752, 454.88711308959057, 282.1000000000007, 372.19090884154605, 280.52616004570245, 495.92375756879517, 364.50954421979407, 398.48214154982105, 649.8548170323871, 467.6118934475162, 401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301, 240.33149542397368, 270.60566131772316, 115.1628797072602, 97.91676897740133, 145.55412340725215, -392.8435029578889, -181.05969210333612, 343.3387861087249, 367.9478685444601, -354.37948350709286, 22.169382402228663, 311.63698307482105, -737.6216985872288, -17.808276598118958, 231.82643137316956, 73.69603564708781, -92.77689980394611, 398.2, -534.4595726090051, 289.56359034955676, 383.16712792404246, 38.63230389258705, 29.008864920930638, -137.39561999115097, -69.88865010853479, 326.0611836066095, 72.1993185574303, 139.73673556225006, 298.9639252142462, 173.7417267384111, 270.0575930050252, 77.26584045466106, 246.92151274529903, -26.708402466949135, 61.59310486021527, 214.52899041517986, -87.70238340786432, -229.31685049133313, 16.316833197972986, 337.9910862041237, -881.165602871915, 1.233119461587457, 137.95276169814144, -301.0695191695815, 297.1898647191119, 394.7353725178508, 0.020391488308096006, -37.850321475986625, 133.23429533273907, 317.7347176757826, 141.29312305887208, 285.6142346932136, -62.06874282116635, -300.530583698882, 109.93767489503496, -311.58155895884124, -144.10850948703066, -0.9878986781108989, 364.46758684426305, 383.13331828130674, -299.812934259479, 197.7713215703573, 100.31269974351709, -411.245013325922, -220.08038336541637, -153.0209887139161, 318.9025062206067, 116.1942548522233, -95.00152499488598, 195.50957338559542, -6.708503262406525, -692.8863386423267, 271.33356725072207, -795.9850824744505, -448.47662399846115, -398.3180704167241, -721.756061787946, 64.99274487935622, -15.098352329470103, -8.225870395815951, 355.4400645612677, 31.80469672738277, 38.65728856026385, -260.49883454628696, 4.324570061431969, 326.38160378467404, 45.09581008874023, -197.28107038581737, 239.6225347665416, -12.692774301077627, -14.617241753502867, -35.05066985329697, 20.199962055634156, 296.19109889552783, -548.970374361195, 112.3093518503741, -42.586819633592235, 268.19109336812807, -154.4516143578185, 332.2844374250176, 254.84490871489962, -344.7869440383453, 243.4616493946102, 182.877928378011, 60.41373349428567, 257.612340093485, 24.420524753830417, -697.4403880989877, 22.758741709604596, -73.64547074452366, 24.860097120199793, -745.9167418610697, 24.449191418496845, 166.26053920259355, -164.36622956636893, 114.18297579997747, -291.44702510648904, 61.04832489273776, -587.8810729877723, -739.9033711549323, -23.874138718391418, 31.86074489435106, -409.4833446417295, 330.3421654690543, -605.2777033089416, 110.39260018163303, 87.24101835425553, 213.6416748052298, 22.97368654627499, -145.57617121786674, -135.13375990476143, -36.625401527697846, 132.75120706979885, 295.1226915191962, -78.8449975696461, 13.006025442007006, -85.83114828040866, -111.26622640372527, -336.45220268432394, 111.81417331014214, 202.3549457362579, 383.42716269035077, 50.88825523424299, 10.867700172177347, -63.70732055564516, -20.95955578908135, 329.11963902890216, -924.1716726199357, -456.36975418181015, -359.62701115994645, -8.424662772447535, -175.23546052755364, -523.7547258955839, -126.93549959946131, -119.65987047783797, 98.96098191467533, 171.1381792093012, 57.37785672086917, -314.1555287829958, -47.43429877778343, -55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448], "policy_predator_policy_reward": [12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686, 75.9350923319411, 92.49111079616283, 211.39924759109186, 120.80744776615536, 78.18037386876416, 468.2206565479642, 21.433539953519013, 374.53260461108437, 476.5602252033746, 20.717382579056075, 178.80233453904395, 100.1831390674638, 549.7423680108659, 292.8226981141567, 60.27356862683049, 49.90396435291241, 48.52499604662013, 112.52536734290518, 645.4255009376583, 102.97470943312676, 10.832872075957539, 1.2676961074132267, 150.88237136215963, 134.70438370806002, 132.7685421818718, 159.11262209792943, 69.03485693866614, 180.76111742380436, 129.44599744217797, 84.12410474836463, 159.96623637379895, 112.32435265243274, 235.4624998223701, 129.82034948706237, 135.4301488222461, 110.8129265089332, 547.3411585905981, 131.2195063706471, 22.083166802027016, 33.00891379587628, 1043.273031269514, 157.00931239807664, 238.9225430107628, 246.87723174680372, 59.266050626283246, 0.0, 332.08615115753474, 73.30434557163272, 136.98559591643806, 41.21942903546205, 172.15187869700114, 55.9797332993995, 424.7355259694947, 347.1260917774722, 277.0967689874471, 351.3066186879602, 270.99113215744063, 306.6291477520755, 3.683725363274755, 27.76751619717433, 216.45165753671805, 355.55313068450766, 506.22993480256065, 203.19269921297976, 145.09719236290542, 599.4975811050127, 169.9789004963823, 30.270520030467427, 79.96276249977772, 389.18439541803, 66.48074912017982, 733.8528448604148, 85.06833058586001, 809.6139534682544, 649.3699696208112, 534.2515620760656, 918.2599990234216, 29.424309183476872, 224.54019018245975, 325.6602762040277, 2.062064274080654, 28.093174437269045, 117.26468435688449, 394.88387317207395, 238.15432147900682, 119.38905331406586, 88.62631755817331, 541.900227346143, 326.2980087779579, 93.59888018060234, 217.71824441178137, 319.8993006987787, 18.400037944365845, 62.808901104472156, 247.60164638327578, 474.7250179906096, 282.1295420526825, 125.69415195253568, 189.17980509080977, 143.3649634539251, 423.6566951084699, 209.8866380786645, 63.235788670567416, 164.4961918617893, 176.96604837818398, 94.61633429866153, 270.9187388614763, 646.6636836075431, 349.00591943580616, 24.149859166843786, 448.7111272977175, 484.9974490367827, 185.09577779238612, 158.6329952782218, 195.26622956636749, 206.0170242000228, 0.0, 561.0810607175825, 383.19884644625176, 1031.3887279410847, 323.8741387183916, 7.339255105649114, 489.3833446417314, 48.35783453094567, 513.7311408993503, 216.42623492210544, 59.27307282802838, 184.54423401248619, 151.97129954120865, 409.81833304243037, 88.31582305817467, 254.24333837428352, 169.55867056344243, 8.065339097013066, 282.6402952607315, 290.3556327492969, 80.75861197883157, 526.2690476928673, 151.77361558183358, 494.2394528523272, 146.64505426374203, 5.469945283724417, 161.8773200012139, 231.25383768195164, 307.4550212875491, 59.31185505717772, 351.2185979597991, 616.0243444727807, 549.8855840422169, 546.6373413452424, 273.5900166806395, 405.9938641881548, 697.9608555361982, 317.23891417864036, 363.15987047783835, 56.021159635146795, 276.7624346038188, 144.57634649839812, 72.63166648710526, 756.5700545211901, 292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.121129342113097, "mean_inference_ms": 5.129331458321445, "mean_action_processing_ms": 2.4391533181151615, "mean_env_wait_ms": 12.73220531975079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065348148345947266, "StateBufferConnector_ms": 0.0042389631271362305, "ViewRequirementAgentConnector_ms": 0.16883599758148193}, "num_episodes": 0, "episode_return_max": 779.0521466860189, "episode_return_min": 66.60000000000049, "episode_return_mean": 433.48039586286853, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.744878113267, "num_env_steps_trained_throughput_per_sec": 151.744878113267, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 26652.838, "restore_workers_time_ms": 0.052, "training_step_time_ms": 26652.596, "sample_time_ms": 2548.68, "learn_time_ms": 24077.254, "learn_throughput": 166.132, "synch_weights_time_ms": 22.081}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-44-13", "timestamp": 1724382853, "time_this_iter_s": 26.404146909713745, "time_total_s": 569.2839181423187, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08b83a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 569.2839181423187, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 34.79736842105263, "ram_util_percent": 83.14736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.1570302702762465, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.6515921950971, "policy_loss": -0.008973613332848622, "vf_loss": 8.65879878745508, "vf_explained_var": 0.2210806857971918, "kl": 0.008835103276565118, "entropy": 0.7735875976779474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 20318.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.577103277488991, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.703920341168763, "policy_loss": -0.012624735220596588, "vf_loss": 8.714063882070874, "vf_explained_var": 0.21402000970941373, "kl": 0.012406160539538457, "entropy": 1.2497005553472609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 20318.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 779.0521466860189, "episode_reward_min": 66.60000000000049, "episode_reward_mean": 433.48039586286853, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -924.1716726199357, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1043.273031269514}, "policy_reward_mean": {"prey_policy": -33.293953088704654, "predator_policy": 250.03415102013875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [528.5538797811572, 312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5, 679.3633598698008, 545.2863440419089, 299.11165086608753, 558.2452385699922, 510.8459928197945, 612.7918390835578, 87.13509093967407, 415.69999999999914, 466.47346358558457, 503.5042281113365, 433.90000000000276, 177.19999999999786, 548.0536977778759, 461.7320284821526, 686.2757541432, 619.614022485918, 585.4959595877826, 522.3651706065749, 361.54143106205083, 409.40000000000225, 320.3498602572639, 322.6830172861262, 751.1912878632459, 367.5605667414895, 629.1740379604217, 655.0389697484862, 409.26229122691853, 426.7595036116011, 432.5238717443745, 779.0521466860189, 469.96317553210554, 398.49032043313457, 371.49340138858616, 635.3461815996798, 569.6552063085171, 100.73875207586195, 370.03076883038455, 336.8268372816917, 290.92099129830825, 526.8762436612028, 417.4000000000023, 290.30701154293695, 688.2495486391783, 478.3412846072389, 646.8266494240241, 487.94963350376054, 397.60000000000207, 285.6656418630642, 633.4279677397544, 510.3775916119351, 543.6012978636885, 654.0715583049785, 589.6084562646175, 244.56255912386055, 322.26904956773376, 212.6519315936305, 534.4385036916983, 351.1000000000022, 330.68236050383166, 86.80313024462959, 339.20000000000266, 458.60000000000036, 235.27227269414703, 544.7000000000005, 439.18714791204854, 170.7999999999976, 605.4979082494501, 507.15695588239174, 409.93028498756513, 421.3750390599801, 737.8971079740752, 454.88711308959057, 282.1000000000007, 372.19090884154605, 280.52616004570245, 495.92375756879517, 364.50954421979407, 398.48214154982105, 649.8548170323871, 467.6118934475162, 401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [90.7776715152361, 209.97914334991668, -102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301, 240.33149542397368, 270.60566131772316, 115.1628797072602, 97.91676897740133, 145.55412340725215, -392.8435029578889, -181.05969210333612, 343.3387861087249, 367.9478685444601, -354.37948350709286, 22.169382402228663, 311.63698307482105, -737.6216985872288, -17.808276598118958, 231.82643137316956, 73.69603564708781, -92.77689980394611, 398.2, -534.4595726090051, 289.56359034955676, 383.16712792404246, 38.63230389258705, 29.008864920930638, -137.39561999115097, -69.88865010853479, 326.0611836066095, 72.1993185574303, 139.73673556225006, 298.9639252142462, 173.7417267384111, 270.0575930050252, 77.26584045466106, 246.92151274529903, -26.708402466949135, 61.59310486021527, 214.52899041517986, -87.70238340786432, -229.31685049133313, 16.316833197972986, 337.9910862041237, -881.165602871915, 1.233119461587457, 137.95276169814144, -301.0695191695815, 297.1898647191119, 394.7353725178508, 0.020391488308096006, -37.850321475986625, 133.23429533273907, 317.7347176757826, 141.29312305887208, 285.6142346932136, -62.06874282116635, -300.530583698882, 109.93767489503496, -311.58155895884124, -144.10850948703066, -0.9878986781108989, 364.46758684426305, 383.13331828130674, -299.812934259479, 197.7713215703573, 100.31269974351709, -411.245013325922, -220.08038336541637, -153.0209887139161, 318.9025062206067, 116.1942548522233, -95.00152499488598, 195.50957338559542, -6.708503262406525, -692.8863386423267, 271.33356725072207, -795.9850824744505, -448.47662399846115, -398.3180704167241, -721.756061787946, 64.99274487935622, -15.098352329470103, -8.225870395815951, 355.4400645612677, 31.80469672738277, 38.65728856026385, -260.49883454628696, 4.324570061431969, 326.38160378467404, 45.09581008874023, -197.28107038581737, 239.6225347665416, -12.692774301077627, -14.617241753502867, -35.05066985329697, 20.199962055634156, 296.19109889552783, -548.970374361195, 112.3093518503741, -42.586819633592235, 268.19109336812807, -154.4516143578185, 332.2844374250176, 254.84490871489962, -344.7869440383453, 243.4616493946102, 182.877928378011, 60.41373349428567, 257.612340093485, 24.420524753830417, -697.4403880989877, 22.758741709604596, -73.64547074452366, 24.860097120199793, -745.9167418610697, 24.449191418496845, 166.26053920259355, -164.36622956636893, 114.18297579997747, -291.44702510648904, 61.04832489273776, -587.8810729877723, -739.9033711549323, -23.874138718391418, 31.86074489435106, -409.4833446417295, 330.3421654690543, -605.2777033089416, 110.39260018163303, 87.24101835425553, 213.6416748052298, 22.97368654627499, -145.57617121786674, -135.13375990476143, -36.625401527697846, 132.75120706979885, 295.1226915191962, -78.8449975696461, 13.006025442007006, -85.83114828040866, -111.26622640372527, -336.45220268432394, 111.81417331014214, 202.3549457362579, 383.42716269035077, 50.88825523424299, 10.867700172177347, -63.70732055564516, -20.95955578908135, 329.11963902890216, -924.1716726199357, -456.36975418181015, -359.62701115994645, -8.424662772447535, -175.23546052755364, -523.7547258955839, -126.93549959946131, -119.65987047783797, 98.96098191467533, 171.1381792093012, 57.37785672086917, -314.1555287829958, -47.43429877778343, -55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448], "policy_predator_policy_reward": [12.313763580360087, 215.48330133564426, 306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686, 75.9350923319411, 92.49111079616283, 211.39924759109186, 120.80744776615536, 78.18037386876416, 468.2206565479642, 21.433539953519013, 374.53260461108437, 476.5602252033746, 20.717382579056075, 178.80233453904395, 100.1831390674638, 549.7423680108659, 292.8226981141567, 60.27356862683049, 49.90396435291241, 48.52499604662013, 112.52536734290518, 645.4255009376583, 102.97470943312676, 10.832872075957539, 1.2676961074132267, 150.88237136215963, 134.70438370806002, 132.7685421818718, 159.11262209792943, 69.03485693866614, 180.76111742380436, 129.44599744217797, 84.12410474836463, 159.96623637379895, 112.32435265243274, 235.4624998223701, 129.82034948706237, 135.4301488222461, 110.8129265089332, 547.3411585905981, 131.2195063706471, 22.083166802027016, 33.00891379587628, 1043.273031269514, 157.00931239807664, 238.9225430107628, 246.87723174680372, 59.266050626283246, 0.0, 332.08615115753474, 73.30434557163272, 136.98559591643806, 41.21942903546205, 172.15187869700114, 55.9797332993995, 424.7355259694947, 347.1260917774722, 277.0967689874471, 351.3066186879602, 270.99113215744063, 306.6291477520755, 3.683725363274755, 27.76751619717433, 216.45165753671805, 355.55313068450766, 506.22993480256065, 203.19269921297976, 145.09719236290542, 599.4975811050127, 169.9789004963823, 30.270520030467427, 79.96276249977772, 389.18439541803, 66.48074912017982, 733.8528448604148, 85.06833058586001, 809.6139534682544, 649.3699696208112, 534.2515620760656, 918.2599990234216, 29.424309183476872, 224.54019018245975, 325.6602762040277, 2.062064274080654, 28.093174437269045, 117.26468435688449, 394.88387317207395, 238.15432147900682, 119.38905331406586, 88.62631755817331, 541.900227346143, 326.2980087779579, 93.59888018060234, 217.71824441178137, 319.8993006987787, 18.400037944365845, 62.808901104472156, 247.60164638327578, 474.7250179906096, 282.1295420526825, 125.69415195253568, 189.17980509080977, 143.3649634539251, 423.6566951084699, 209.8866380786645, 63.235788670567416, 164.4961918617893, 176.96604837818398, 94.61633429866153, 270.9187388614763, 646.6636836075431, 349.00591943580616, 24.149859166843786, 448.7111272977175, 484.9974490367827, 185.09577779238612, 158.6329952782218, 195.26622956636749, 206.0170242000228, 0.0, 561.0810607175825, 383.19884644625176, 1031.3887279410847, 323.8741387183916, 7.339255105649114, 489.3833446417314, 48.35783453094567, 513.7311408993503, 216.42623492210544, 59.27307282802838, 184.54423401248619, 151.97129954120865, 409.81833304243037, 88.31582305817467, 254.24333837428352, 169.55867056344243, 8.065339097013066, 282.6402952607315, 290.3556327492969, 80.75861197883157, 526.2690476928673, 151.77361558183358, 494.2394528523272, 146.64505426374203, 5.469945283724417, 161.8773200012139, 231.25383768195164, 307.4550212875491, 59.31185505717772, 351.2185979597991, 616.0243444727807, 549.8855840422169, 546.6373413452424, 273.5900166806395, 405.9938641881548, 697.9608555361982, 317.23891417864036, 363.15987047783835, 56.021159635146795, 276.7624346038188, 144.57634649839812, 72.63166648710526, 756.5700545211901, 292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.121129342113097, "mean_inference_ms": 5.129331458321445, "mean_action_processing_ms": 2.4391533181151615, "mean_env_wait_ms": 12.73220531975079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065348148345947266, "StateBufferConnector_ms": 0.0042389631271362305, "ViewRequirementAgentConnector_ms": 0.16883599758148193}, "num_episodes": 0, "episode_return_max": 779.0521466860189, "episode_return_min": 66.60000000000049, "episode_return_mean": 433.48039586286853, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.2089056828092, "num_env_steps_trained_throughput_per_sec": 147.2089056828092, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 26747.242, "restore_workers_time_ms": 0.064, "training_step_time_ms": 26747.0, "sample_time_ms": 2645.153, "learn_time_ms": 24074.938, "learn_throughput": 166.148, "synch_weights_time_ms": 22.208}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-44-40", "timestamp": 1724382880, "time_this_iter_s": 27.21965003013611, "time_total_s": 596.5035681724548, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08b6160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 596.5035681724548, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 37.0421052631579, "ram_util_percent": 83.26842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.462450587244891, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.763251840500605, "policy_loss": -0.011138085806101719, "vf_loss": 8.772311169760568, "vf_explained_var": 0.2478313468120716, "kl": 0.01039386590666793, "entropy": 0.7347028380348569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21263.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.363795037622806, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.543780117438583, "policy_loss": -0.011698487960294914, "vf_loss": 8.553097278352768, "vf_explained_var": 0.3033775773628679, "kl": 0.011906689670055159, "entropy": 1.2515434443004547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21263.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 779.0521466860189, "episode_reward_min": 66.60000000000049, "episode_reward_mean": 429.7164870119526, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1477.3104851990051, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1373.7690863216635}, "policy_reward_mean": {"prey_policy": -42.5281368673421, "predator_policy": 257.3863803733182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [312.31248214176935, 319.8000000000004, 297.50000000000136, 542.6999999999998, 139.4172021214799, 293.15301906227324, 66.60000000000049, 580.6354613587079, 571.5, 679.3633598698008, 545.2863440419089, 299.11165086608753, 558.2452385699922, 510.8459928197945, 612.7918390835578, 87.13509093967407, 415.69999999999914, 466.47346358558457, 503.5042281113365, 433.90000000000276, 177.19999999999786, 548.0536977778759, 461.7320284821526, 686.2757541432, 619.614022485918, 585.4959595877826, 522.3651706065749, 361.54143106205083, 409.40000000000225, 320.3498602572639, 322.6830172861262, 751.1912878632459, 367.5605667414895, 629.1740379604217, 655.0389697484862, 409.26229122691853, 426.7595036116011, 432.5238717443745, 779.0521466860189, 469.96317553210554, 398.49032043313457, 371.49340138858616, 635.3461815996798, 569.6552063085171, 100.73875207586195, 370.03076883038455, 336.8268372816917, 290.92099129830825, 526.8762436612028, 417.4000000000023, 290.30701154293695, 688.2495486391783, 478.3412846072389, 646.8266494240241, 487.94963350376054, 397.60000000000207, 285.6656418630642, 633.4279677397544, 510.3775916119351, 543.6012978636885, 654.0715583049785, 589.6084562646175, 244.56255912386055, 322.26904956773376, 212.6519315936305, 534.4385036916983, 351.1000000000022, 330.68236050383166, 86.80313024462959, 339.20000000000266, 458.60000000000036, 235.27227269414703, 544.7000000000005, 439.18714791204854, 170.7999999999976, 605.4979082494501, 507.15695588239174, 409.93028498756513, 421.3750390599801, 737.8971079740752, 454.88711308959057, 282.1000000000007, 372.19090884154605, 280.52616004570245, 495.92375756879517, 364.50954421979407, 398.48214154982105, 649.8548170323871, 467.6118934475162, 401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346, 152.1629946895719], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-102.136504958221, -56.89287199592435, 60.064663830572684, 39.035567240967865, -41.569888463675305, 111.42605108227534, 144.18520549988838, 46.97990277801159, 33.20668381229057, -113.87619128076855, 35.03682594270631, -104.08893288752617, -48.692854634626244, -167.8185029113229, 41.18297323353671, 253.45907315606485, 257.3828554522934, 77.02311777378301, 240.33149542397368, 270.60566131772316, 115.1628797072602, 97.91676897740133, 145.55412340725215, -392.8435029578889, -181.05969210333612, 343.3387861087249, 367.9478685444601, -354.37948350709286, 22.169382402228663, 311.63698307482105, -737.6216985872288, -17.808276598118958, 231.82643137316956, 73.69603564708781, -92.77689980394611, 398.2, -534.4595726090051, 289.56359034955676, 383.16712792404246, 38.63230389258705, 29.008864920930638, -137.39561999115097, -69.88865010853479, 326.0611836066095, 72.1993185574303, 139.73673556225006, 298.9639252142462, 173.7417267384111, 270.0575930050252, 77.26584045466106, 246.92151274529903, -26.708402466949135, 61.59310486021527, 214.52899041517986, -87.70238340786432, -229.31685049133313, 16.316833197972986, 337.9910862041237, -881.165602871915, 1.233119461587457, 137.95276169814144, -301.0695191695815, 297.1898647191119, 394.7353725178508, 0.020391488308096006, -37.850321475986625, 133.23429533273907, 317.7347176757826, 141.29312305887208, 285.6142346932136, -62.06874282116635, -300.530583698882, 109.93767489503496, -311.58155895884124, -144.10850948703066, -0.9878986781108989, 364.46758684426305, 383.13331828130674, -299.812934259479, 197.7713215703573, 100.31269974351709, -411.245013325922, -220.08038336541637, -153.0209887139161, 318.9025062206067, 116.1942548522233, -95.00152499488598, 195.50957338559542, -6.708503262406525, -692.8863386423267, 271.33356725072207, -795.9850824744505, -448.47662399846115, -398.3180704167241, -721.756061787946, 64.99274487935622, -15.098352329470103, -8.225870395815951, 355.4400645612677, 31.80469672738277, 38.65728856026385, -260.49883454628696, 4.324570061431969, 326.38160378467404, 45.09581008874023, -197.28107038581737, 239.6225347665416, -12.692774301077627, -14.617241753502867, -35.05066985329697, 20.199962055634156, 296.19109889552783, -548.970374361195, 112.3093518503741, -42.586819633592235, 268.19109336812807, -154.4516143578185, 332.2844374250176, 254.84490871489962, -344.7869440383453, 243.4616493946102, 182.877928378011, 60.41373349428567, 257.612340093485, 24.420524753830417, -697.4403880989877, 22.758741709604596, -73.64547074452366, 24.860097120199793, -745.9167418610697, 24.449191418496845, 166.26053920259355, -164.36622956636893, 114.18297579997747, -291.44702510648904, 61.04832489273776, -587.8810729877723, -739.9033711549323, -23.874138718391418, 31.86074489435106, -409.4833446417295, 330.3421654690543, -605.2777033089416, 110.39260018163303, 87.24101835425553, 213.6416748052298, 22.97368654627499, -145.57617121786674, -135.13375990476143, -36.625401527697846, 132.75120706979885, 295.1226915191962, -78.8449975696461, 13.006025442007006, -85.83114828040866, -111.26622640372527, -336.45220268432394, 111.81417331014214, 202.3549457362579, 383.42716269035077, 50.88825523424299, 10.867700172177347, -63.70732055564516, -20.95955578908135, 329.11963902890216, -924.1716726199357, -456.36975418181015, -359.62701115994645, -8.424662772447535, -175.23546052755364, -523.7547258955839, -126.93549959946131, -119.65987047783797, 98.96098191467533, 171.1381792093012, 57.37785672086917, -314.1555287829958, -47.43429877778343, -55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448, -1477.3104851990051, -68.76945566333177], "policy_predator_policy_reward": [306.93963543611284, 164.4022236598021, 174.18636078467304, 46.513408143786535, 187.535080017701, 40.10875736369881, 162.71479450011162, 188.82009722198816, 75.09679002789801, 144.98991956205927, 248.82084308687644, 113.38428292021663, 84.49285463462562, 198.61850291132112, 247.63703778871925, 38.35637718038726, 58.317144547706654, 178.77688222621686, 75.9350923319411, 92.49111079616283, 211.39924759109186, 120.80744776615536, 78.18037386876416, 468.2206565479642, 21.433539953519013, 374.53260461108437, 476.5602252033746, 20.717382579056075, 178.80233453904395, 100.1831390674638, 549.7423680108659, 292.8226981141567, 60.27356862683049, 49.90396435291241, 48.52499604662013, 112.52536734290518, 645.4255009376583, 102.97470943312676, 10.832872075957539, 1.2676961074132267, 150.88237136215963, 134.70438370806002, 132.7685421818718, 159.11262209792943, 69.03485693866614, 180.76111742380436, 129.44599744217797, 84.12410474836463, 159.96623637379895, 112.32435265243274, 235.4624998223701, 129.82034948706237, 135.4301488222461, 110.8129265089332, 547.3411585905981, 131.2195063706471, 22.083166802027016, 33.00891379587628, 1043.273031269514, 157.00931239807664, 238.9225430107628, 246.87723174680372, 59.266050626283246, 0.0, 332.08615115753474, 73.30434557163272, 136.98559591643806, 41.21942903546205, 172.15187869700114, 55.9797332993995, 424.7355259694947, 347.1260917774722, 277.0967689874471, 351.3066186879602, 270.99113215744063, 306.6291477520755, 3.683725363274755, 27.76751619717433, 216.45165753671805, 355.55313068450766, 506.22993480256065, 203.19269921297976, 145.09719236290542, 599.4975811050127, 169.9789004963823, 30.270520030467427, 79.96276249977772, 389.18439541803, 66.48074912017982, 733.8528448604148, 85.06833058586001, 809.6139534682544, 649.3699696208112, 534.2515620760656, 918.2599990234216, 29.424309183476872, 224.54019018245975, 325.6602762040277, 2.062064274080654, 28.093174437269045, 117.26468435688449, 394.88387317207395, 238.15432147900682, 119.38905331406586, 88.62631755817331, 541.900227346143, 326.2980087779579, 93.59888018060234, 217.71824441178137, 319.8993006987787, 18.400037944365845, 62.808901104472156, 247.60164638327578, 474.7250179906096, 282.1295420526825, 125.69415195253568, 189.17980509080977, 143.3649634539251, 423.6566951084699, 209.8866380786645, 63.235788670567416, 164.4961918617893, 176.96604837818398, 94.61633429866153, 270.9187388614763, 646.6636836075431, 349.00591943580616, 24.149859166843786, 448.7111272977175, 484.9974490367827, 185.09577779238612, 158.6329952782218, 195.26622956636749, 206.0170242000228, 0.0, 561.0810607175825, 383.19884644625176, 1031.3887279410847, 323.8741387183916, 7.339255105649114, 489.3833446417314, 48.35783453094567, 513.7311408993503, 216.42623492210544, 59.27307282802838, 184.54423401248619, 151.97129954120865, 409.81833304243037, 88.31582305817467, 254.24333837428352, 169.55867056344243, 8.065339097013066, 282.6402952607315, 290.3556327492969, 80.75861197883157, 526.2690476928673, 151.77361558183358, 494.2394528523272, 146.64505426374203, 5.469945283724417, 161.8773200012139, 231.25383768195164, 307.4550212875491, 59.31185505717772, 351.2185979597991, 616.0243444727807, 549.8855840422169, 546.6373413452424, 273.5900166806395, 405.9938641881548, 697.9608555361982, 317.23891417864036, 363.15987047783835, 56.021159635146795, 276.7624346038188, 144.57634649839812, 72.63166648710526, 756.5700545211901, 292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336, 324.4738492302445, 1373.7690863216635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.129528093286432, "mean_inference_ms": 5.098695108631027, "mean_action_processing_ms": 2.43947456059758, "mean_env_wait_ms": 12.72957401843974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006450533866882324, "StateBufferConnector_ms": 0.0040961503982543945, "ViewRequirementAgentConnector_ms": 0.1686786413192749}, "num_episodes": 1, "episode_return_max": 779.0521466860189, "episode_return_min": 66.60000000000049, "episode_return_mean": 429.7164870119526, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.68181884450337, "num_env_steps_trained_throughput_per_sec": 152.68181884450337, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 26689.089, "restore_workers_time_ms": 0.064, "training_step_time_ms": 26688.828, "sample_time_ms": 2638.308, "learn_time_ms": 24024.317, "learn_throughput": 166.498, "synch_weights_time_ms": 21.786}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-45-06", "timestamp": 1724382906, "time_this_iter_s": 26.247477054595947, "time_total_s": 622.7510452270508, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b084cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 622.7510452270508, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 34.03947368421053, "ram_util_percent": 83.01052631578946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.812493443615223, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.646746469931628, "policy_loss": -0.012187078144775812, "vf_loss": 8.657029695864077, "vf_explained_var": 0.23141841831661406, "kl": 0.009519306242850328, "entropy": 0.7155227258722618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 22208.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.924802360837422, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.27471192526439, "policy_loss": -0.013449242905215927, "vf_loss": 8.285814742941074, "vf_explained_var": 0.3228947814179476, "kl": 0.011731944407617288, "entropy": 1.2354797020160333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 22208.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 779.0521466860189, "episode_reward_min": 9.426565315310402, "episode_reward_mean": 421.232167409459, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1477.3104851990051, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1373.7690863216635}, "policy_reward_mean": {"prey_policy": -109.43446833251593, "predator_policy": 320.0505520372452}, "custom_metrics": {}, "hist_stats": {"episode_reward": [679.3633598698008, 545.2863440419089, 299.11165086608753, 558.2452385699922, 510.8459928197945, 612.7918390835578, 87.13509093967407, 415.69999999999914, 466.47346358558457, 503.5042281113365, 433.90000000000276, 177.19999999999786, 548.0536977778759, 461.7320284821526, 686.2757541432, 619.614022485918, 585.4959595877826, 522.3651706065749, 361.54143106205083, 409.40000000000225, 320.3498602572639, 322.6830172861262, 751.1912878632459, 367.5605667414895, 629.1740379604217, 655.0389697484862, 409.26229122691853, 426.7595036116011, 432.5238717443745, 779.0521466860189, 469.96317553210554, 398.49032043313457, 371.49340138858616, 635.3461815996798, 569.6552063085171, 100.73875207586195, 370.03076883038455, 336.8268372816917, 290.92099129830825, 526.8762436612028, 417.4000000000023, 290.30701154293695, 688.2495486391783, 478.3412846072389, 646.8266494240241, 487.94963350376054, 397.60000000000207, 285.6656418630642, 633.4279677397544, 510.3775916119351, 543.6012978636885, 654.0715583049785, 589.6084562646175, 244.56255912386055, 322.26904956773376, 212.6519315936305, 534.4385036916983, 351.1000000000022, 330.68236050383166, 86.80313024462959, 339.20000000000266, 458.60000000000036, 235.27227269414703, 544.7000000000005, 439.18714791204854, 170.7999999999976, 605.4979082494501, 507.15695588239174, 409.93028498756513, 421.3750390599801, 737.8971079740752, 454.88711308959057, 282.1000000000007, 372.19090884154605, 280.52616004570245, 495.92375756879517, 364.50954421979407, 398.48214154982105, 649.8548170323871, 467.6118934475162, 401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346, 152.1629946895719, 9.426565315310402, 86.50895888590935, 419.52490421519826, 163.4032294700782, 496.8995735034594, 150.10928221100457, 316.7054118304812, 340.8694217534355, 291.73885724998104], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [240.33149542397368, 270.60566131772316, 115.1628797072602, 97.91676897740133, 145.55412340725215, -392.8435029578889, -181.05969210333612, 343.3387861087249, 367.9478685444601, -354.37948350709286, 22.169382402228663, 311.63698307482105, -737.6216985872288, -17.808276598118958, 231.82643137316956, 73.69603564708781, -92.77689980394611, 398.2, -534.4595726090051, 289.56359034955676, 383.16712792404246, 38.63230389258705, 29.008864920930638, -137.39561999115097, -69.88865010853479, 326.0611836066095, 72.1993185574303, 139.73673556225006, 298.9639252142462, 173.7417267384111, 270.0575930050252, 77.26584045466106, 246.92151274529903, -26.708402466949135, 61.59310486021527, 214.52899041517986, -87.70238340786432, -229.31685049133313, 16.316833197972986, 337.9910862041237, -881.165602871915, 1.233119461587457, 137.95276169814144, -301.0695191695815, 297.1898647191119, 394.7353725178508, 0.020391488308096006, -37.850321475986625, 133.23429533273907, 317.7347176757826, 141.29312305887208, 285.6142346932136, -62.06874282116635, -300.530583698882, 109.93767489503496, -311.58155895884124, -144.10850948703066, -0.9878986781108989, 364.46758684426305, 383.13331828130674, -299.812934259479, 197.7713215703573, 100.31269974351709, -411.245013325922, -220.08038336541637, -153.0209887139161, 318.9025062206067, 116.1942548522233, -95.00152499488598, 195.50957338559542, -6.708503262406525, -692.8863386423267, 271.33356725072207, -795.9850824744505, -448.47662399846115, -398.3180704167241, -721.756061787946, 64.99274487935622, -15.098352329470103, -8.225870395815951, 355.4400645612677, 31.80469672738277, 38.65728856026385, -260.49883454628696, 4.324570061431969, 326.38160378467404, 45.09581008874023, -197.28107038581737, 239.6225347665416, -12.692774301077627, -14.617241753502867, -35.05066985329697, 20.199962055634156, 296.19109889552783, -548.970374361195, 112.3093518503741, -42.586819633592235, 268.19109336812807, -154.4516143578185, 332.2844374250176, 254.84490871489962, -344.7869440383453, 243.4616493946102, 182.877928378011, 60.41373349428567, 257.612340093485, 24.420524753830417, -697.4403880989877, 22.758741709604596, -73.64547074452366, 24.860097120199793, -745.9167418610697, 24.449191418496845, 166.26053920259355, -164.36622956636893, 114.18297579997747, -291.44702510648904, 61.04832489273776, -587.8810729877723, -739.9033711549323, -23.874138718391418, 31.86074489435106, -409.4833446417295, 330.3421654690543, -605.2777033089416, 110.39260018163303, 87.24101835425553, 213.6416748052298, 22.97368654627499, -145.57617121786674, -135.13375990476143, -36.625401527697846, 132.75120706979885, 295.1226915191962, -78.8449975696461, 13.006025442007006, -85.83114828040866, -111.26622640372527, -336.45220268432394, 111.81417331014214, 202.3549457362579, 383.42716269035077, 50.88825523424299, 10.867700172177347, -63.70732055564516, -20.95955578908135, 329.11963902890216, -924.1716726199357, -456.36975418181015, -359.62701115994645, -8.424662772447535, -175.23546052755364, -523.7547258955839, -126.93549959946131, -119.65987047783797, 98.96098191467533, 171.1381792093012, 57.37785672086917, -314.1555287829958, -47.43429877778343, -55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448, -1477.3104851990051, -68.76945566333177, -1121.9388299162777, -1170.4423776101614, -1083.5624890839013, 40.0000000000003, -1462.305154272228, -337.80256187384134, -791.5663426973474, -1011.3829394797646, -751.6569012420729, -149.96002742009597, -138.037715460425, -1173.5190513124567, -1276.2295462815787, -247.55535647870343, -32.151484865405315, -1035.5633145981128, -750.5207507256381, -423.1642770464257], "policy_predator_policy_reward": [75.9350923319411, 92.49111079616283, 211.39924759109186, 120.80744776615536, 78.18037386876416, 468.2206565479642, 21.433539953519013, 374.53260461108437, 476.5602252033746, 20.717382579056075, 178.80233453904395, 100.1831390674638, 549.7423680108659, 292.8226981141567, 60.27356862683049, 49.90396435291241, 48.52499604662013, 112.52536734290518, 645.4255009376583, 102.97470943312676, 10.832872075957539, 1.2676961074132267, 150.88237136215963, 134.70438370806002, 132.7685421818718, 159.11262209792943, 69.03485693866614, 180.76111742380436, 129.44599744217797, 84.12410474836463, 159.96623637379895, 112.32435265243274, 235.4624998223701, 129.82034948706237, 135.4301488222461, 110.8129265089332, 547.3411585905981, 131.2195063706471, 22.083166802027016, 33.00891379587628, 1043.273031269514, 157.00931239807664, 238.9225430107628, 246.87723174680372, 59.266050626283246, 0.0, 332.08615115753474, 73.30434557163272, 136.98559591643806, 41.21942903546205, 172.15187869700114, 55.9797332993995, 424.7355259694947, 347.1260917774722, 277.0967689874471, 351.3066186879602, 270.99113215744063, 306.6291477520755, 3.683725363274755, 27.76751619717433, 216.45165753671805, 355.55313068450766, 506.22993480256065, 203.19269921297976, 145.09719236290542, 599.4975811050127, 169.9789004963823, 30.270520030467427, 79.96276249977772, 389.18439541803, 66.48074912017982, 733.8528448604148, 85.06833058586001, 809.6139534682544, 649.3699696208112, 534.2515620760656, 918.2599990234216, 29.424309183476872, 224.54019018245975, 325.6602762040277, 2.062064274080654, 28.093174437269045, 117.26468435688449, 394.88387317207395, 238.15432147900682, 119.38905331406586, 88.62631755817331, 541.900227346143, 326.2980087779579, 93.59888018060234, 217.71824441178137, 319.8993006987787, 18.400037944365845, 62.808901104472156, 247.60164638327578, 474.7250179906096, 282.1295420526825, 125.69415195253568, 189.17980509080977, 143.3649634539251, 423.6566951084699, 209.8866380786645, 63.235788670567416, 164.4961918617893, 176.96604837818398, 94.61633429866153, 270.9187388614763, 646.6636836075431, 349.00591943580616, 24.149859166843786, 448.7111272977175, 484.9974490367827, 185.09577779238612, 158.6329952782218, 195.26622956636749, 206.0170242000228, 0.0, 561.0810607175825, 383.19884644625176, 1031.3887279410847, 323.8741387183916, 7.339255105649114, 489.3833446417314, 48.35783453094567, 513.7311408993503, 216.42623492210544, 59.27307282802838, 184.54423401248619, 151.97129954120865, 409.81833304243037, 88.31582305817467, 254.24333837428352, 169.55867056344243, 8.065339097013066, 282.6402952607315, 290.3556327492969, 80.75861197883157, 526.2690476928673, 151.77361558183358, 494.2394528523272, 146.64505426374203, 5.469945283724417, 161.8773200012139, 231.25383768195164, 307.4550212875491, 59.31185505717772, 351.2185979597991, 616.0243444727807, 549.8855840422169, 546.6373413452424, 273.5900166806395, 405.9938641881548, 697.9608555361982, 317.23891417864036, 363.15987047783835, 56.021159635146795, 276.7624346038188, 144.57634649839812, 72.63166648710526, 756.5700545211901, 292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336, 324.4738492302445, 1373.7690863216635, 1114.56393203792, 1187.2438408038292, 1096.5624890839015, 33.50895888590971, 1179.0907466374433, 1040.5418737238233, 968.4659097657257, 997.8866018814642, 1010.6352125317749, 387.8812896338544, 579.4769217903976, 882.1891271934903, 1156.4374484757354, 684.0528661150263, 553.1133849797626, 855.4708362371886, 783.6814440051907, 681.7424410168566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.129668148917104, "mean_inference_ms": 5.004161293776661, "mean_action_processing_ms": 2.3176449451269288, "mean_env_wait_ms": 12.79876466836956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061043500900268555, "StateBufferConnector_ms": 0.003946423530578613, "ViewRequirementAgentConnector_ms": 0.1646331548690796}, "num_episodes": 9, "episode_return_max": 779.0521466860189, "episode_return_min": 9.426565315310402, "episode_return_mean": 421.232167409459, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.70980964985958, "num_env_steps_trained_throughput_per_sec": 152.70980964985958, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 26656.239, "restore_workers_time_ms": 0.075, "training_step_time_ms": 26655.925, "sample_time_ms": 2666.603, "learn_time_ms": 23963.572, "learn_throughput": 166.92, "synch_weights_time_ms": 21.558}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-45-33", "timestamp": 1724382933, "time_this_iter_s": 26.24101710319519, "time_total_s": 648.992062330246, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095634c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 648.992062330246, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 33.5918918918919, "ram_util_percent": 82.57567567567568}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.734683592735776, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.85190541555011, "policy_loss": -0.010578892104544494, "vf_loss": 8.86075281163372, "vf_explained_var": 0.21302607229777745, "kl": 0.008657368497735766, "entropy": 0.6856013067184933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23153.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.707438874623133, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.38423144779508, "policy_loss": -0.010793376852211262, "vf_loss": 8.392852028337105, "vf_explained_var": 0.33614160327053577, "kl": 0.010863905283745635, "entropy": 1.228153309367952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23153.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 779.0521466860189, "episode_reward_min": 9.426565315310402, "episode_reward_mean": 407.48113610386486, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1477.3104851990051, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1377.8338930227324}, "policy_reward_mean": {"prey_policy": -163.61208742785297, "predator_policy": 367.3526554797852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [415.69999999999914, 466.47346358558457, 503.5042281113365, 433.90000000000276, 177.19999999999786, 548.0536977778759, 461.7320284821526, 686.2757541432, 619.614022485918, 585.4959595877826, 522.3651706065749, 361.54143106205083, 409.40000000000225, 320.3498602572639, 322.6830172861262, 751.1912878632459, 367.5605667414895, 629.1740379604217, 655.0389697484862, 409.26229122691853, 426.7595036116011, 432.5238717443745, 779.0521466860189, 469.96317553210554, 398.49032043313457, 371.49340138858616, 635.3461815996798, 569.6552063085171, 100.73875207586195, 370.03076883038455, 336.8268372816917, 290.92099129830825, 526.8762436612028, 417.4000000000023, 290.30701154293695, 688.2495486391783, 478.3412846072389, 646.8266494240241, 487.94963350376054, 397.60000000000207, 285.6656418630642, 633.4279677397544, 510.3775916119351, 543.6012978636885, 654.0715583049785, 589.6084562646175, 244.56255912386055, 322.26904956773376, 212.6519315936305, 534.4385036916983, 351.1000000000022, 330.68236050383166, 86.80313024462959, 339.20000000000266, 458.60000000000036, 235.27227269414703, 544.7000000000005, 439.18714791204854, 170.7999999999976, 605.4979082494501, 507.15695588239174, 409.93028498756513, 421.3750390599801, 737.8971079740752, 454.88711308959057, 282.1000000000007, 372.19090884154605, 280.52616004570245, 495.92375756879517, 364.50954421979407, 398.48214154982105, 649.8548170323871, 467.6118934475162, 401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346, 152.1629946895719, 9.426565315310402, 86.50895888590935, 419.52490421519826, 163.4032294700782, 496.8995735034594, 150.10928221100457, 316.7054118304812, 340.8694217534355, 291.73885724998104, 334.8708892150255, 219.51188992534546, 424.01224876507575, 77.72499488987103, 382.42264590142577, 368.81808629883477, 110.31563063581793], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [231.82643137316956, 73.69603564708781, -92.77689980394611, 398.2, -534.4595726090051, 289.56359034955676, 383.16712792404246, 38.63230389258705, 29.008864920930638, -137.39561999115097, -69.88865010853479, 326.0611836066095, 72.1993185574303, 139.73673556225006, 298.9639252142462, 173.7417267384111, 270.0575930050252, 77.26584045466106, 246.92151274529903, -26.708402466949135, 61.59310486021527, 214.52899041517986, -87.70238340786432, -229.31685049133313, 16.316833197972986, 337.9910862041237, -881.165602871915, 1.233119461587457, 137.95276169814144, -301.0695191695815, 297.1898647191119, 394.7353725178508, 0.020391488308096006, -37.850321475986625, 133.23429533273907, 317.7347176757826, 141.29312305887208, 285.6142346932136, -62.06874282116635, -300.530583698882, 109.93767489503496, -311.58155895884124, -144.10850948703066, -0.9878986781108989, 364.46758684426305, 383.13331828130674, -299.812934259479, 197.7713215703573, 100.31269974351709, -411.245013325922, -220.08038336541637, -153.0209887139161, 318.9025062206067, 116.1942548522233, -95.00152499488598, 195.50957338559542, -6.708503262406525, -692.8863386423267, 271.33356725072207, -795.9850824744505, -448.47662399846115, -398.3180704167241, -721.756061787946, 64.99274487935622, -15.098352329470103, -8.225870395815951, 355.4400645612677, 31.80469672738277, 38.65728856026385, -260.49883454628696, 4.324570061431969, 326.38160378467404, 45.09581008874023, -197.28107038581737, 239.6225347665416, -12.692774301077627, -14.617241753502867, -35.05066985329697, 20.199962055634156, 296.19109889552783, -548.970374361195, 112.3093518503741, -42.586819633592235, 268.19109336812807, -154.4516143578185, 332.2844374250176, 254.84490871489962, -344.7869440383453, 243.4616493946102, 182.877928378011, 60.41373349428567, 257.612340093485, 24.420524753830417, -697.4403880989877, 22.758741709604596, -73.64547074452366, 24.860097120199793, -745.9167418610697, 24.449191418496845, 166.26053920259355, -164.36622956636893, 114.18297579997747, -291.44702510648904, 61.04832489273776, -587.8810729877723, -739.9033711549323, -23.874138718391418, 31.86074489435106, -409.4833446417295, 330.3421654690543, -605.2777033089416, 110.39260018163303, 87.24101835425553, 213.6416748052298, 22.97368654627499, -145.57617121786674, -135.13375990476143, -36.625401527697846, 132.75120706979885, 295.1226915191962, -78.8449975696461, 13.006025442007006, -85.83114828040866, -111.26622640372527, -336.45220268432394, 111.81417331014214, 202.3549457362579, 383.42716269035077, 50.88825523424299, 10.867700172177347, -63.70732055564516, -20.95955578908135, 329.11963902890216, -924.1716726199357, -456.36975418181015, -359.62701115994645, -8.424662772447535, -175.23546052755364, -523.7547258955839, -126.93549959946131, -119.65987047783797, 98.96098191467533, 171.1381792093012, 57.37785672086917, -314.1555287829958, -47.43429877778343, -55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448, -1477.3104851990051, -68.76945566333177, -1121.9388299162777, -1170.4423776101614, -1083.5624890839013, 40.0000000000003, -1462.305154272228, -337.80256187384134, -791.5663426973474, -1011.3829394797646, -751.6569012420729, -149.96002742009597, -138.037715460425, -1173.5190513124567, -1276.2295462815787, -247.55535647870343, -32.151484865405315, -1035.5633145981128, -750.5207507256381, -423.1642770464257, -517.3805312610015, -1418.616303652699, -948.2875470324932, -852.3963571557006, -423.4471971892629, -1116.2075726762669, -1377.6338930227323, 36.15143367015825, -530.1592845306983, -1124.9068251781484, -1083.1485046386417, -100.63874971932867, 40.0000000000003, -1187.9011914704215], "policy_predator_policy_reward": [60.27356862683049, 49.90396435291241, 48.52499604662013, 112.52536734290518, 645.4255009376583, 102.97470943312676, 10.832872075957539, 1.2676961074132267, 150.88237136215963, 134.70438370806002, 132.7685421818718, 159.11262209792943, 69.03485693866614, 180.76111742380436, 129.44599744217797, 84.12410474836463, 159.96623637379895, 112.32435265243274, 235.4624998223701, 129.82034948706237, 135.4301488222461, 110.8129265089332, 547.3411585905981, 131.2195063706471, 22.083166802027016, 33.00891379587628, 1043.273031269514, 157.00931239807664, 238.9225430107628, 246.87723174680372, 59.266050626283246, 0.0, 332.08615115753474, 73.30434557163272, 136.98559591643806, 41.21942903546205, 172.15187869700114, 55.9797332993995, 424.7355259694947, 347.1260917774722, 277.0967689874471, 351.3066186879602, 270.99113215744063, 306.6291477520755, 3.683725363274755, 27.76751619717433, 216.45165753671805, 355.55313068450766, 506.22993480256065, 203.19269921297976, 145.09719236290542, 599.4975811050127, 169.9789004963823, 30.270520030467427, 79.96276249977772, 389.18439541803, 66.48074912017982, 733.8528448604148, 85.06833058586001, 809.6139534682544, 649.3699696208112, 534.2515620760656, 918.2599990234216, 29.424309183476872, 224.54019018245975, 325.6602762040277, 2.062064274080654, 28.093174437269045, 117.26468435688449, 394.88387317207395, 238.15432147900682, 119.38905331406586, 88.62631755817331, 541.900227346143, 326.2980087779579, 93.59888018060234, 217.71824441178137, 319.8993006987787, 18.400037944365845, 62.808901104472156, 247.60164638327578, 474.7250179906096, 282.1295420526825, 125.69415195253568, 189.17980509080977, 143.3649634539251, 423.6566951084699, 209.8866380786645, 63.235788670567416, 164.4961918617893, 176.96604837818398, 94.61633429866153, 270.9187388614763, 646.6636836075431, 349.00591943580616, 24.149859166843786, 448.7111272977175, 484.9974490367827, 185.09577779238612, 158.6329952782218, 195.26622956636749, 206.0170242000228, 0.0, 561.0810607175825, 383.19884644625176, 1031.3887279410847, 323.8741387183916, 7.339255105649114, 489.3833446417314, 48.35783453094567, 513.7311408993503, 216.42623492210544, 59.27307282802838, 184.54423401248619, 151.97129954120865, 409.81833304243037, 88.31582305817467, 254.24333837428352, 169.55867056344243, 8.065339097013066, 282.6402952607315, 290.3556327492969, 80.75861197883157, 526.2690476928673, 151.77361558183358, 494.2394528523272, 146.64505426374203, 5.469945283724417, 161.8773200012139, 231.25383768195164, 307.4550212875491, 59.31185505717772, 351.2185979597991, 616.0243444727807, 549.8855840422169, 546.6373413452424, 273.5900166806395, 405.9938641881548, 697.9608555361982, 317.23891417864036, 363.15987047783835, 56.021159635146795, 276.7624346038188, 144.57634649839812, 72.63166648710526, 756.5700545211901, 292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336, 324.4738492302445, 1373.7690863216635, 1114.56393203792, 1187.2438408038292, 1096.5624890839015, 33.50895888590971, 1179.0907466374433, 1040.5418737238233, 968.4659097657257, 997.8866018814642, 1010.6352125317749, 387.8812896338544, 579.4769217903976, 882.1891271934903, 1156.4374484757354, 684.0528661150263, 553.1133849797626, 855.4708362371886, 783.6814440051907, 681.7424410168566, 1255.9532366336693, 1014.9144874950576, 865.1100284092647, 1155.0857657042754, 1107.6346659187584, 856.0323527118483, 1377.8338930227324, 41.37356121971326, 956.9767049100473, 1080.512050700223, 995.4371858380342, 557.168154818771, 171.16006009144374, 1087.0567620147976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.072151288539459, "mean_inference_ms": 5.017141165186937, "mean_action_processing_ms": 2.3273901679641584, "mean_env_wait_ms": 12.82528925335584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006203651428222656, "StateBufferConnector_ms": 0.004039168357849121, "ViewRequirementAgentConnector_ms": 0.17018187046051025}, "num_episodes": 7, "episode_return_max": 779.0521466860189, "episode_return_min": 9.426565315310402, "episode_return_mean": 407.48113610386486, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.91439351429656, "num_env_steps_trained_throughput_per_sec": 152.91439351429656, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 26618.888, "restore_workers_time_ms": 0.074, "training_step_time_ms": 26618.563, "sample_time_ms": 2607.837, "learn_time_ms": 23984.115, "learn_throughput": 166.777, "synch_weights_time_ms": 22.411}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-45-59", "timestamp": 1724382959, "time_this_iter_s": 26.20240879058838, "time_total_s": 675.1944711208344, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08ca820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 675.1944711208344, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 34.24324324324324, "ram_util_percent": 82.32162162162163}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.940901572868308, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.603856280997947, "policy_loss": -0.006748056924216961, "vf_loss": 8.608955641650649, "vf_explained_var": 0.24093297581193307, "kl": 0.008243557143335542, "entropy": 0.6922378710338047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 24098.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.263046755235662, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.415829851766112, "policy_loss": -0.012737006612033362, "vf_loss": 8.426314808578088, "vf_explained_var": 0.366470673475316, "kl": 0.011260277553210183, "entropy": 1.2071321329742513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 24098.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 779.0521466860189, "episode_reward_min": 0.3371928311040775, "episode_reward_mean": 377.87248047730094, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1540.0007106306791, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.7353725178508, "predator_policy": 1540.0007106306791}, "policy_reward_mean": {"prey_policy": -304.1090890114863, "predator_policy": 493.0453292501367}, "custom_metrics": {}, "hist_stats": {"episode_reward": [751.1912878632459, 367.5605667414895, 629.1740379604217, 655.0389697484862, 409.26229122691853, 426.7595036116011, 432.5238717443745, 779.0521466860189, 469.96317553210554, 398.49032043313457, 371.49340138858616, 635.3461815996798, 569.6552063085171, 100.73875207586195, 370.03076883038455, 336.8268372816917, 290.92099129830825, 526.8762436612028, 417.4000000000023, 290.30701154293695, 688.2495486391783, 478.3412846072389, 646.8266494240241, 487.94963350376054, 397.60000000000207, 285.6656418630642, 633.4279677397544, 510.3775916119351, 543.6012978636885, 654.0715583049785, 589.6084562646175, 244.56255912386055, 322.26904956773376, 212.6519315936305, 534.4385036916983, 351.1000000000022, 330.68236050383166, 86.80313024462959, 339.20000000000266, 458.60000000000036, 235.27227269414703, 544.7000000000005, 439.18714791204854, 170.7999999999976, 605.4979082494501, 507.15695588239174, 409.93028498756513, 421.3750390599801, 737.8971079740752, 454.88711308959057, 282.1000000000007, 372.19090884154605, 280.52616004570245, 495.92375756879517, 364.50954421979407, 398.48214154982105, 649.8548170323871, 467.6118934475162, 401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346, 152.1629946895719, 9.426565315310402, 86.50895888590935, 419.52490421519826, 163.4032294700782, 496.8995735034594, 150.10928221100457, 316.7054118304812, 340.8694217534355, 291.73885724998104, 334.8708892150255, 219.51188992534546, 424.01224876507575, 77.72499488987103, 382.42264590142577, 368.81808629883477, 110.31563063581793, 233.44823130063082, 164.42773760986887, 0.3371928311040775, 1.3124943442045698, 276.96439895121915, 537.1258707636124, 617.3741932142779, 298.65087672205135, 161.22605610403028, 645.8106716016746, 59.796166314339374, 125.10274377389825, 404.32714074925076, 149.90970347095765, 197.60959297836342], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [297.1898647191119, 394.7353725178508, 0.020391488308096006, -37.850321475986625, 133.23429533273907, 317.7347176757826, 141.29312305887208, 285.6142346932136, -62.06874282116635, -300.530583698882, 109.93767489503496, -311.58155895884124, -144.10850948703066, -0.9878986781108989, 364.46758684426305, 383.13331828130674, -299.812934259479, 197.7713215703573, 100.31269974351709, -411.245013325922, -220.08038336541637, -153.0209887139161, 318.9025062206067, 116.1942548522233, -95.00152499488598, 195.50957338559542, -6.708503262406525, -692.8863386423267, 271.33356725072207, -795.9850824744505, -448.47662399846115, -398.3180704167241, -721.756061787946, 64.99274487935622, -15.098352329470103, -8.225870395815951, 355.4400645612677, 31.80469672738277, 38.65728856026385, -260.49883454628696, 4.324570061431969, 326.38160378467404, 45.09581008874023, -197.28107038581737, 239.6225347665416, -12.692774301077627, -14.617241753502867, -35.05066985329697, 20.199962055634156, 296.19109889552783, -548.970374361195, 112.3093518503741, -42.586819633592235, 268.19109336812807, -154.4516143578185, 332.2844374250176, 254.84490871489962, -344.7869440383453, 243.4616493946102, 182.877928378011, 60.41373349428567, 257.612340093485, 24.420524753830417, -697.4403880989877, 22.758741709604596, -73.64547074452366, 24.860097120199793, -745.9167418610697, 24.449191418496845, 166.26053920259355, -164.36622956636893, 114.18297579997747, -291.44702510648904, 61.04832489273776, -587.8810729877723, -739.9033711549323, -23.874138718391418, 31.86074489435106, -409.4833446417295, 330.3421654690543, -605.2777033089416, 110.39260018163303, 87.24101835425553, 213.6416748052298, 22.97368654627499, -145.57617121786674, -135.13375990476143, -36.625401527697846, 132.75120706979885, 295.1226915191962, -78.8449975696461, 13.006025442007006, -85.83114828040866, -111.26622640372527, -336.45220268432394, 111.81417331014214, 202.3549457362579, 383.42716269035077, 50.88825523424299, 10.867700172177347, -63.70732055564516, -20.95955578908135, 329.11963902890216, -924.1716726199357, -456.36975418181015, -359.62701115994645, -8.424662772447535, -175.23546052755364, -523.7547258955839, -126.93549959946131, -119.65987047783797, 98.96098191467533, 171.1381792093012, 57.37785672086917, -314.1555287829958, -47.43429877778343, -55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448, -1477.3104851990051, -68.76945566333177, -1121.9388299162777, -1170.4423776101614, -1083.5624890839013, 40.0000000000003, -1462.305154272228, -337.80256187384134, -791.5663426973474, -1011.3829394797646, -751.6569012420729, -149.96002742009597, -138.037715460425, -1173.5190513124567, -1276.2295462815787, -247.55535647870343, -32.151484865405315, -1035.5633145981128, -750.5207507256381, -423.1642770464257, -517.3805312610015, -1418.616303652699, -948.2875470324932, -852.3963571557006, -423.4471971892629, -1116.2075726762669, -1377.6338930227323, 36.15143367015825, -530.1592845306983, -1124.9068251781484, -1083.1485046386417, -100.63874971932867, 40.0000000000003, -1187.9011914704215, -1043.5220001718494, -1162.0981972805732, -280.1082143094074, -891.281422925905, -1291.629456943885, -1540.0007106306791, -1282.9096305536752, -1387.061815759687, -258.8221278269986, -262.14181509086757, -1515.9785596446957, -453.6177904605944, -169.6479104136784, -1172.9116531635498, -1287.282705635622, 40.0000000000003, -1395.3840414162648, -650.2380463462935, -1196.1938580927833, 74.66328693782498, -1348.798377403471, -789.4673229995873, -1040.394983738823, -1242.00188377068, -1095.8615038823539, -219.93823350127263, -803.5070949717056, -1237.5234778082731, -585.020069359562, -1152.5461146535047], "policy_predator_policy_reward": [59.266050626283246, 0.0, 332.08615115753474, 73.30434557163272, 136.98559591643806, 41.21942903546205, 172.15187869700114, 55.9797332993995, 424.7355259694947, 347.1260917774722, 277.0967689874471, 351.3066186879602, 270.99113215744063, 306.6291477520755, 3.683725363274755, 27.76751619717433, 216.45165753671805, 355.55313068450766, 506.22993480256065, 203.19269921297976, 145.09719236290542, 599.4975811050127, 169.9789004963823, 30.270520030467427, 79.96276249977772, 389.18439541803, 66.48074912017982, 733.8528448604148, 85.06833058586001, 809.6139534682544, 649.3699696208112, 534.2515620760656, 918.2599990234216, 29.424309183476872, 224.54019018245975, 325.6602762040277, 2.062064274080654, 28.093174437269045, 117.26468435688449, 394.88387317207395, 238.15432147900682, 119.38905331406586, 88.62631755817331, 541.900227346143, 326.2980087779579, 93.59888018060234, 217.71824441178137, 319.8993006987787, 18.400037944365845, 62.808901104472156, 247.60164638327578, 474.7250179906096, 282.1295420526825, 125.69415195253568, 189.17980509080977, 143.3649634539251, 423.6566951084699, 209.8866380786645, 63.235788670567416, 164.4961918617893, 176.96604837818398, 94.61633429866153, 270.9187388614763, 646.6636836075431, 349.00591943580616, 24.149859166843786, 448.7111272977175, 484.9974490367827, 185.09577779238612, 158.6329952782218, 195.26622956636749, 206.0170242000228, 0.0, 561.0810607175825, 383.19884644625176, 1031.3887279410847, 323.8741387183916, 7.339255105649114, 489.3833446417314, 48.35783453094567, 513.7311408993503, 216.42623492210544, 59.27307282802838, 184.54423401248619, 151.97129954120865, 409.81833304243037, 88.31582305817467, 254.24333837428352, 169.55867056344243, 8.065339097013066, 282.6402952607315, 290.3556327492969, 80.75861197883157, 526.2690476928673, 151.77361558183358, 494.2394528523272, 146.64505426374203, 5.469945283724417, 161.8773200012139, 231.25383768195164, 307.4550212875491, 59.31185505717772, 351.2185979597991, 616.0243444727807, 549.8855840422169, 546.6373413452424, 273.5900166806395, 405.9938641881548, 697.9608555361982, 317.23891417864036, 363.15987047783835, 56.021159635146795, 276.7624346038188, 144.57634649839812, 72.63166648710526, 756.5700545211901, 292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336, 324.4738492302445, 1373.7690863216635, 1114.56393203792, 1187.2438408038292, 1096.5624890839015, 33.50895888590971, 1179.0907466374433, 1040.5418737238233, 968.4659097657257, 997.8866018814642, 1010.6352125317749, 387.8812896338544, 579.4769217903976, 882.1891271934903, 1156.4374484757354, 684.0528661150263, 553.1133849797626, 855.4708362371886, 783.6814440051907, 681.7424410168566, 1255.9532366336693, 1014.9144874950576, 865.1100284092647, 1155.0857657042754, 1107.6346659187584, 856.0323527118483, 1377.8338930227324, 41.37356121971326, 956.9767049100473, 1080.512050700223, 995.4371858380342, 557.168154818771, 171.16006009144374, 1087.0567620147976, 1232.647574323618, 1206.4208544294336, 523.7059312616885, 812.1114435834978, 1291.9666497749893, 1540.0007106306791, 1284.1391528769211, 1387.144787780646, 166.74961522758193, 631.1787266415039, 1365.4055350432682, 1141.3166858256338, 942.665593109482, 1017.2681636820245, 1167.2290261468877, 378.7045562107875, 1331.459797355665, 875.3883465109243, 1158.3007006081314, 609.0405421485012, 1010.3385104509603, 1187.7233562664383, 1172.6903531349362, 1234.8092581484652, 1073.9833843722934, 646.143493760583, 1320.129293132245, 870.8109831186921, 1279.2797540135766, 655.8960229778571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.1020330377679715, "mean_inference_ms": 5.098486966286157, "mean_action_processing_ms": 2.325868971237827, "mean_env_wait_ms": 12.924842240238927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01207578182220459, "StateBufferConnector_ms": 0.020932912826538086, "ViewRequirementAgentConnector_ms": 0.23448598384857178}, "num_episodes": 15, "episode_return_max": 779.0521466860189, "episode_return_min": 0.3371928311040775, "episode_return_mean": 377.87248047730094, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 126.30065243455734, "num_env_steps_trained_throughput_per_sec": 126.30065243455734, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 27139.488, "restore_workers_time_ms": 0.073, "training_step_time_ms": 27139.168, "sample_time_ms": 3052.336, "learn_time_ms": 24060.28, "learn_throughput": 166.249, "synch_weights_time_ms": 22.076}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-46-31", "timestamp": 1724382991, "time_this_iter_s": 31.72010898590088, "time_total_s": 706.9145801067352, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b084ca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 706.9145801067352, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 49.037777777777784, "ram_util_percent": 83.35555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.396983077917149, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.993020874104172, "policy_loss": -0.009549679242015358, "vf_loss": 9.000735693633871, "vf_explained_var": 0.1933276749161816, "kl": 0.009174385047936566, "entropy": 0.6466786765547656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25043.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999904}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.922715781605433, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.632342907234474, "policy_loss": -0.012749531710392269, "vf_loss": 8.64298778564211, "vf_explained_var": 0.3067954004126251, "kl": 0.010523156939990936, "entropy": 1.1978461056159286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25043.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999904}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 737.8971079740752, "episode_reward_min": 0.3371928311040775, "episode_reward_mean": 326.4010814536971, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1540.0007106306791, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.42716269035077, "predator_policy": 1540.0007106306791}, "policy_reward_mean": {"prey_policy": -464.0200192662189, "predator_policy": 627.2205599930675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.92099129830825, 526.8762436612028, 417.4000000000023, 290.30701154293695, 688.2495486391783, 478.3412846072389, 646.8266494240241, 487.94963350376054, 397.60000000000207, 285.6656418630642, 633.4279677397544, 510.3775916119351, 543.6012978636885, 654.0715583049785, 589.6084562646175, 244.56255912386055, 322.26904956773376, 212.6519315936305, 534.4385036916983, 351.1000000000022, 330.68236050383166, 86.80313024462959, 339.20000000000266, 458.60000000000036, 235.27227269414703, 544.7000000000005, 439.18714791204854, 170.7999999999976, 605.4979082494501, 507.15695588239174, 409.93028498756513, 421.3750390599801, 737.8971079740752, 454.88711308959057, 282.1000000000007, 372.19090884154605, 280.52616004570245, 495.92375756879517, 364.50954421979407, 398.48214154982105, 649.8548170323871, 467.6118934475162, 401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346, 152.1629946895719, 9.426565315310402, 86.50895888590935, 419.52490421519826, 163.4032294700782, 496.8995735034594, 150.10928221100457, 316.7054118304812, 340.8694217534355, 291.73885724998104, 334.8708892150255, 219.51188992534546, 424.01224876507575, 77.72499488987103, 382.42264590142577, 368.81808629883477, 110.31563063581793, 233.44823130063082, 164.42773760986887, 0.3371928311040775, 1.3124943442045698, 276.96439895121915, 537.1258707636124, 617.3741932142779, 298.65087672205135, 161.22605610403028, 645.8106716016746, 59.796166314339374, 125.10274377389825, 404.32714074925076, 149.90970347095765, 197.60959297836342, 13.292508869100443, 134.06671940012103, 10.452763028549331, 108.87560925698796, 342.86848513584357, 241.07429585838298, 107.35960956018604, 3.4163594265421184, 87.19853135712611, 418.3493141105669, 187.24733156521083, 15.69704215930278, 256.49789725409755, 246.7953927210289, 86.13966865899661, 296.635888310092], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-721.756061787946, 64.99274487935622, -15.098352329470103, -8.225870395815951, 355.4400645612677, 31.80469672738277, 38.65728856026385, -260.49883454628696, 4.324570061431969, 326.38160378467404, 45.09581008874023, -197.28107038581737, 239.6225347665416, -12.692774301077627, -14.617241753502867, -35.05066985329697, 20.199962055634156, 296.19109889552783, -548.970374361195, 112.3093518503741, -42.586819633592235, 268.19109336812807, -154.4516143578185, 332.2844374250176, 254.84490871489962, -344.7869440383453, 243.4616493946102, 182.877928378011, 60.41373349428567, 257.612340093485, 24.420524753830417, -697.4403880989877, 22.758741709604596, -73.64547074452366, 24.860097120199793, -745.9167418610697, 24.449191418496845, 166.26053920259355, -164.36622956636893, 114.18297579997747, -291.44702510648904, 61.04832489273776, -587.8810729877723, -739.9033711549323, -23.874138718391418, 31.86074489435106, -409.4833446417295, 330.3421654690543, -605.2777033089416, 110.39260018163303, 87.24101835425553, 213.6416748052298, 22.97368654627499, -145.57617121786674, -135.13375990476143, -36.625401527697846, 132.75120706979885, 295.1226915191962, -78.8449975696461, 13.006025442007006, -85.83114828040866, -111.26622640372527, -336.45220268432394, 111.81417331014214, 202.3549457362579, 383.42716269035077, 50.88825523424299, 10.867700172177347, -63.70732055564516, -20.95955578908135, 329.11963902890216, -924.1716726199357, -456.36975418181015, -359.62701115994645, -8.424662772447535, -175.23546052755364, -523.7547258955839, -126.93549959946131, -119.65987047783797, 98.96098191467533, 171.1381792093012, 57.37785672086917, -314.1555287829958, -47.43429877778343, -55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448, -1477.3104851990051, -68.76945566333177, -1121.9388299162777, -1170.4423776101614, -1083.5624890839013, 40.0000000000003, -1462.305154272228, -337.80256187384134, -791.5663426973474, -1011.3829394797646, -751.6569012420729, -149.96002742009597, -138.037715460425, -1173.5190513124567, -1276.2295462815787, -247.55535647870343, -32.151484865405315, -1035.5633145981128, -750.5207507256381, -423.1642770464257, -517.3805312610015, -1418.616303652699, -948.2875470324932, -852.3963571557006, -423.4471971892629, -1116.2075726762669, -1377.6338930227323, 36.15143367015825, -530.1592845306983, -1124.9068251781484, -1083.1485046386417, -100.63874971932867, 40.0000000000003, -1187.9011914704215, -1043.5220001718494, -1162.0981972805732, -280.1082143094074, -891.281422925905, -1291.629456943885, -1540.0007106306791, -1282.9096305536752, -1387.061815759687, -258.8221278269986, -262.14181509086757, -1515.9785596446957, -453.6177904605944, -169.6479104136784, -1172.9116531635498, -1287.282705635622, 40.0000000000003, -1395.3840414162648, -650.2380463462935, -1196.1938580927833, 74.66328693782498, -1348.798377403471, -789.4673229995873, -1040.394983738823, -1242.00188377068, -1095.8615038823539, -219.93823350127263, -803.5070949717056, -1237.5234778082731, -585.020069359562, -1152.5461146535047, -1371.315216044777, -1491.5063853055342, -765.3496591197638, -1468.601597435513, -1189.325427293842, -1364.4586858083362, -799.2321679047595, -983.6060166168287, -1364.4905044722093, -514.857912002471, -940.025546635631, -977.9624357957388, -1434.043793711554, -699.0702616173832, -1262.2970894103034, -1337.751378744451, -1327.9108390511858, -927.1683599422063, -1100.9291355956495, -567.6869694194398, -1166.3493671397457, -775.1192992056295, -1364.6691816640218, -1111.6523055690195, -766.0681085331311, -921.6209660073794, -804.9988425810891, -35.435380847460365, -1260.8003828911794, -987.4265236961523, -626.8235228704581, -1024.9113640581866], "policy_predator_policy_reward": [918.2599990234216, 29.424309183476872, 224.54019018245975, 325.6602762040277, 2.062064274080654, 28.093174437269045, 117.26468435688449, 394.88387317207395, 238.15432147900682, 119.38905331406586, 88.62631755817331, 541.900227346143, 326.2980087779579, 93.59888018060234, 217.71824441178137, 319.8993006987787, 18.400037944365845, 62.808901104472156, 247.60164638327578, 474.7250179906096, 282.1295420526825, 125.69415195253568, 189.17980509080977, 143.3649634539251, 423.6566951084699, 209.8866380786645, 63.235788670567416, 164.4961918617893, 176.96604837818398, 94.61633429866153, 270.9187388614763, 646.6636836075431, 349.00591943580616, 24.149859166843786, 448.7111272977175, 484.9974490367827, 185.09577779238612, 158.6329952782218, 195.26622956636749, 206.0170242000228, 0.0, 561.0810607175825, 383.19884644625176, 1031.3887279410847, 323.8741387183916, 7.339255105649114, 489.3833446417314, 48.35783453094567, 513.7311408993503, 216.42623492210544, 59.27307282802838, 184.54423401248619, 151.97129954120865, 409.81833304243037, 88.31582305817467, 254.24333837428352, 169.55867056344243, 8.065339097013066, 282.6402952607315, 290.3556327492969, 80.75861197883157, 526.2690476928673, 151.77361558183358, 494.2394528523272, 146.64505426374203, 5.469945283724417, 161.8773200012139, 231.25383768195164, 307.4550212875491, 59.31185505717772, 351.2185979597991, 616.0243444727807, 549.8855840422169, 546.6373413452424, 273.5900166806395, 405.9938641881548, 697.9608555361982, 317.23891417864036, 363.15987047783835, 56.021159635146795, 276.7624346038188, 144.57634649839812, 72.63166648710526, 756.5700545211901, 292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336, 324.4738492302445, 1373.7690863216635, 1114.56393203792, 1187.2438408038292, 1096.5624890839015, 33.50895888590971, 1179.0907466374433, 1040.5418737238233, 968.4659097657257, 997.8866018814642, 1010.6352125317749, 387.8812896338544, 579.4769217903976, 882.1891271934903, 1156.4374484757354, 684.0528661150263, 553.1133849797626, 855.4708362371886, 783.6814440051907, 681.7424410168566, 1255.9532366336693, 1014.9144874950576, 865.1100284092647, 1155.0857657042754, 1107.6346659187584, 856.0323527118483, 1377.8338930227324, 41.37356121971326, 956.9767049100473, 1080.512050700223, 995.4371858380342, 557.168154818771, 171.16006009144374, 1087.0567620147976, 1232.647574323618, 1206.4208544294336, 523.7059312616885, 812.1114435834978, 1291.9666497749893, 1540.0007106306791, 1284.1391528769211, 1387.144787780646, 166.74961522758193, 631.1787266415039, 1365.4055350432682, 1141.3166858256338, 942.665593109482, 1017.2681636820245, 1167.2290261468877, 378.7045562107875, 1331.459797355665, 875.3883465109243, 1158.3007006081314, 609.0405421485012, 1010.3385104509603, 1187.7233562664383, 1172.6903531349362, 1234.8092581484652, 1073.9833843722934, 646.143493760583, 1320.129293132245, 870.8109831186921, 1279.2797540135766, 655.8960229778571, 1384.607724913877, 1491.5063853055342, 897.3970310939497, 1470.6209448614484, 1195.3247850666096, 1368.912091064118, 953.6415557377082, 938.0722380408682, 1139.0093127659725, 1083.2075888445527, 1117.368858522516, 1041.6934197672365, 916.7980537045473, 1323.6756111845807, 1263.1508007298653, 1340.3140268514308, 1327.9108390511858, 1014.3668912993327, 1187.7358681038197, 899.2295510218385, 1163.198887683185, 965.5171102274046, 1197.1490330414565, 1294.8694963508876, 828.0823367719877, 1116.1046350226209, 693.4969171811549, 393.7326989684231, 1276.4218451069953, 1057.944730139332, 834.2442484666155, 1114.1265267721226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.102366541983465, "mean_inference_ms": 5.155843231343725, "mean_action_processing_ms": 2.3657365587125025, "mean_env_wait_ms": 13.026306689618965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013692140579223633, "StateBufferConnector_ms": 0.02088344097137451, "ViewRequirementAgentConnector_ms": 0.24360871315002441}, "num_episodes": 16, "episode_return_max": 737.8971079740752, "episode_return_min": 0.3371928311040775, "episode_return_mean": 326.4010814536971, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.36019797317564, "num_env_steps_trained_throughput_per_sec": 150.36019797317564, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 27169.198, "restore_workers_time_ms": 0.073, "training_step_time_ms": 27168.864, "sample_time_ms": 3089.275, "learn_time_ms": 24053.332, "learn_throughput": 166.297, "synch_weights_time_ms": 21.529}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-46-57", "timestamp": 1724383017, "time_this_iter_s": 26.65510392189026, "time_total_s": 733.5696840286255, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08b8c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 733.5696840286255, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 37.37894736842105, "ram_util_percent": 83.35526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.795075848115184, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.716699429163857, "policy_loss": -0.008214875144598188, "vf_loss": 8.723312680178848, "vf_explained_var": 0.22806720569650962, "kl": 0.008008205635157764, "entropy": 0.6216124905480279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25988.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.38809631879998, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.557518937348059, "policy_loss": -0.011495655433585246, "vf_loss": 8.566621372687123, "vf_explained_var": 0.2971401269473727, "kl": 0.011966006182350967, "entropy": 1.1750651345681893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25988.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 737.8971079740752, "episode_reward_min": 0.3371928311040775, "episode_reward_mean": 275.0651227946545, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1540.0007106306791, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.42716269035077, "predator_policy": 1540.0007106306791}, "policy_reward_mean": {"prey_policy": -627.0509573414034, "predator_policy": 764.5835187387306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [244.56255912386055, 322.26904956773376, 212.6519315936305, 534.4385036916983, 351.1000000000022, 330.68236050383166, 86.80313024462959, 339.20000000000266, 458.60000000000036, 235.27227269414703, 544.7000000000005, 439.18714791204854, 170.7999999999976, 605.4979082494501, 507.15695588239174, 409.93028498756513, 421.3750390599801, 737.8971079740752, 454.88711308959057, 282.1000000000007, 372.19090884154605, 280.52616004570245, 495.92375756879517, 364.50954421979407, 398.48214154982105, 649.8548170323871, 467.6118934475162, 401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346, 152.1629946895719, 9.426565315310402, 86.50895888590935, 419.52490421519826, 163.4032294700782, 496.8995735034594, 150.10928221100457, 316.7054118304812, 340.8694217534355, 291.73885724998104, 334.8708892150255, 219.51188992534546, 424.01224876507575, 77.72499488987103, 382.42264590142577, 368.81808629883477, 110.31563063581793, 233.44823130063082, 164.42773760986887, 0.3371928311040775, 1.3124943442045698, 276.96439895121915, 537.1258707636124, 617.3741932142779, 298.65087672205135, 161.22605610403028, 645.8106716016746, 59.796166314339374, 125.10274377389825, 404.32714074925076, 149.90970347095765, 197.60959297836342, 13.292508869100443, 134.06671940012103, 10.452763028549331, 108.87560925698796, 342.86848513584357, 241.07429585838298, 107.35960956018604, 3.4163594265421184, 87.19853135712611, 418.3493141105669, 187.24733156521083, 15.69704215930278, 256.49789725409755, 246.7953927210289, 86.13966865899661, 296.635888310092, 304.21570639966933, 82.69844837894007, 17.708186018431466, 214.58194637213398, 98.72642003926387, 108.18713268152949, 117.69779654545995, 62.86055685172655, 109.76153457947618, 55.80754118909945, 85.57340733143363, 261.15040445835524, 407.64694169948774, 316.4798219010784, 64.53216597434415], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [24.420524753830417, -697.4403880989877, 22.758741709604596, -73.64547074452366, 24.860097120199793, -745.9167418610697, 24.449191418496845, 166.26053920259355, -164.36622956636893, 114.18297579997747, -291.44702510648904, 61.04832489273776, -587.8810729877723, -739.9033711549323, -23.874138718391418, 31.86074489435106, -409.4833446417295, 330.3421654690543, -605.2777033089416, 110.39260018163303, 87.24101835425553, 213.6416748052298, 22.97368654627499, -145.57617121786674, -135.13375990476143, -36.625401527697846, 132.75120706979885, 295.1226915191962, -78.8449975696461, 13.006025442007006, -85.83114828040866, -111.26622640372527, -336.45220268432394, 111.81417331014214, 202.3549457362579, 383.42716269035077, 50.88825523424299, 10.867700172177347, -63.70732055564516, -20.95955578908135, 329.11963902890216, -924.1716726199357, -456.36975418181015, -359.62701115994645, -8.424662772447535, -175.23546052755364, -523.7547258955839, -126.93549959946131, -119.65987047783797, 98.96098191467533, 171.1381792093012, 57.37785672086917, -314.1555287829958, -47.43429877778343, -55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448, -1477.3104851990051, -68.76945566333177, -1121.9388299162777, -1170.4423776101614, -1083.5624890839013, 40.0000000000003, -1462.305154272228, -337.80256187384134, -791.5663426973474, -1011.3829394797646, -751.6569012420729, -149.96002742009597, -138.037715460425, -1173.5190513124567, -1276.2295462815787, -247.55535647870343, -32.151484865405315, -1035.5633145981128, -750.5207507256381, -423.1642770464257, -517.3805312610015, -1418.616303652699, -948.2875470324932, -852.3963571557006, -423.4471971892629, -1116.2075726762669, -1377.6338930227323, 36.15143367015825, -530.1592845306983, -1124.9068251781484, -1083.1485046386417, -100.63874971932867, 40.0000000000003, -1187.9011914704215, -1043.5220001718494, -1162.0981972805732, -280.1082143094074, -891.281422925905, -1291.629456943885, -1540.0007106306791, -1282.9096305536752, -1387.061815759687, -258.8221278269986, -262.14181509086757, -1515.9785596446957, -453.6177904605944, -169.6479104136784, -1172.9116531635498, -1287.282705635622, 40.0000000000003, -1395.3840414162648, -650.2380463462935, -1196.1938580927833, 74.66328693782498, -1348.798377403471, -789.4673229995873, -1040.394983738823, -1242.00188377068, -1095.8615038823539, -219.93823350127263, -803.5070949717056, -1237.5234778082731, -585.020069359562, -1152.5461146535047, -1371.315216044777, -1491.5063853055342, -765.3496591197638, -1468.601597435513, -1189.325427293842, -1364.4586858083362, -799.2321679047595, -983.6060166168287, -1364.4905044722093, -514.857912002471, -940.025546635631, -977.9624357957388, -1434.043793711554, -699.0702616173832, -1262.2970894103034, -1337.751378744451, -1327.9108390511858, -927.1683599422063, -1100.9291355956495, -567.6869694194398, -1166.3493671397457, -775.1192992056295, -1364.6691816640218, -1111.6523055690195, -766.0681085331311, -921.6209660073794, -804.9988425810891, -35.435380847460365, -1260.8003828911794, -987.4265236961523, -626.8235228704581, -1024.9113640581866, -1127.3685881596211, -722.7659319221486, -1026.757372811938, -1280.4673344965688, -1230.3681183841659, -1183.0359832722054, -1019.5972175818217, -881.890420626834, -1264.9274976411307, -505.55611578107187, -627.7417053434561, -1309.987716194455, -1266.433029068143, -941.4383906581866, -1216.2758012901509, -979.1141788356142, -1419.200865520459, -1260.0691583881526, -1271.425170683749, -1210.3016411665437, -990.930406957456, -1302.015315917135, -1078.0262570002278, -806.0763063777025, -1128.222609887588, -601.891805455375, 40.0000000000003, -1325.122372242042, -1370.7902011722374, -1519.7009128452387], "policy_predator_policy_reward": [270.9187388614763, 646.6636836075431, 349.00591943580616, 24.149859166843786, 448.7111272977175, 484.9974490367827, 185.09577779238612, 158.6329952782218, 195.26622956636749, 206.0170242000228, 0.0, 561.0810607175825, 383.19884644625176, 1031.3887279410847, 323.8741387183916, 7.339255105649114, 489.3833446417314, 48.35783453094567, 513.7311408993503, 216.42623492210544, 59.27307282802838, 184.54423401248619, 151.97129954120865, 409.81833304243037, 88.31582305817467, 254.24333837428352, 169.55867056344243, 8.065339097013066, 282.6402952607315, 290.3556327492969, 80.75861197883157, 526.2690476928673, 151.77361558183358, 494.2394528523272, 146.64505426374203, 5.469945283724417, 161.8773200012139, 231.25383768195164, 307.4550212875491, 59.31185505717772, 351.2185979597991, 616.0243444727807, 549.8855840422169, 546.6373413452424, 273.5900166806395, 405.9938641881548, 697.9608555361982, 317.23891417864036, 363.15987047783835, 56.021159635146795, 276.7624346038188, 144.57634649839812, 72.63166648710526, 756.5700545211901, 292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336, 324.4738492302445, 1373.7690863216635, 1114.56393203792, 1187.2438408038292, 1096.5624890839015, 33.50895888590971, 1179.0907466374433, 1040.5418737238233, 968.4659097657257, 997.8866018814642, 1010.6352125317749, 387.8812896338544, 579.4769217903976, 882.1891271934903, 1156.4374484757354, 684.0528661150263, 553.1133849797626, 855.4708362371886, 783.6814440051907, 681.7424410168566, 1255.9532366336693, 1014.9144874950576, 865.1100284092647, 1155.0857657042754, 1107.6346659187584, 856.0323527118483, 1377.8338930227324, 41.37356121971326, 956.9767049100473, 1080.512050700223, 995.4371858380342, 557.168154818771, 171.16006009144374, 1087.0567620147976, 1232.647574323618, 1206.4208544294336, 523.7059312616885, 812.1114435834978, 1291.9666497749893, 1540.0007106306791, 1284.1391528769211, 1387.144787780646, 166.74961522758193, 631.1787266415039, 1365.4055350432682, 1141.3166858256338, 942.665593109482, 1017.2681636820245, 1167.2290261468877, 378.7045562107875, 1331.459797355665, 875.3883465109243, 1158.3007006081314, 609.0405421485012, 1010.3385104509603, 1187.7233562664383, 1172.6903531349362, 1234.8092581484652, 1073.9833843722934, 646.143493760583, 1320.129293132245, 870.8109831186921, 1279.2797540135766, 655.8960229778571, 1384.607724913877, 1491.5063853055342, 897.3970310939497, 1470.6209448614484, 1195.3247850666096, 1368.912091064118, 953.6415557377082, 938.0722380408682, 1139.0093127659725, 1083.2075888445527, 1117.368858522516, 1041.6934197672365, 916.7980537045473, 1323.6756111845807, 1263.1508007298653, 1340.3140268514308, 1327.9108390511858, 1014.3668912993327, 1187.7358681038197, 899.2295510218385, 1163.198887683185, 965.5171102274046, 1197.1490330414565, 1294.8694963508876, 828.0823367719877, 1116.1046350226209, 693.4969171811549, 393.7326989684231, 1276.4218451069953, 1057.944730139332, 834.2442484666155, 1114.1265267721226, 1406.288103719902, 748.0621227615361, 1255.0280774305556, 1134.895078256892, 1166.8462639734792, 1264.266023701323, 1185.2064916379127, 930.8630929428776, 1263.9800578534957, 605.2299756079741, 1046.8954785466858, 999.021075672755, 1266.292387874942, 1059.2768283968458, 1312.6405354671206, 945.610001510372, 1407.496337259733, 1381.535221228354, 1326.727488317736, 1210.8068647216571, 1080.3978042057338, 1298.1213260002908, 1039.1641856136964, 1106.0887822225907, 975.1294488352117, 1162.6319082072414, 424.4116011643404, 1177.1905929787763, 1446.7209416286235, 1508.302338363194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.20756142723034, "mean_inference_ms": 5.195595162367872, "mean_action_processing_ms": 2.2955264988254456, "mean_env_wait_ms": 13.129815188939356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030052542686462402, "StateBufferConnector_ms": 0.02129042148590088, "ViewRequirementAgentConnector_ms": 0.24833261966705322}, "num_episodes": 15, "episode_return_max": 737.8971079740752, "episode_return_min": 0.3371928311040775, "episode_return_mean": 275.0651227946545, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.0690230206351, "num_env_steps_trained_throughput_per_sec": 152.0690230206351, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 27145.872, "restore_workers_time_ms": 0.073, "training_step_time_ms": 27145.585, "sample_time_ms": 3094.977, "learn_time_ms": 24023.661, "learn_throughput": 166.503, "synch_weights_time_ms": 21.67}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-47-24", "timestamp": 1724383044, "time_this_iter_s": 26.34084391593933, "time_total_s": 759.9105279445648, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08b8040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 759.9105279445648, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 34.82631578947369, "ram_util_percent": 83.22105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.153579647705039, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.690501528442221, "policy_loss": -0.009710656784760652, "vf_loss": 8.698786142137315, "vf_explained_var": 0.25712647097451347, "kl": 0.007130175289111557, "entropy": 0.6272974416377053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 26933.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.335959284772319, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.690655412118902, "policy_loss": -0.01142347438073663, "vf_loss": 8.699977428194076, "vf_explained_var": 0.34037134325693524, "kl": 0.010507377894674107, "entropy": 1.155813971776811, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 26933.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 649.8548170323871, "episode_reward_min": 0.08087944381469558, "episode_reward_mean": 229.3661130617343, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1685.32383341174, "predator_policy": 33.50895888590971}, "policy_reward_max": {"prey_policy": 171.1381792093012, "predator_policy": 1685.32383341174}, "policy_reward_mean": {"prey_policy": -824.6128985852847, "predator_policy": 939.2959551161521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [495.92375756879517, 364.50954421979407, 398.48214154982105, 649.8548170323871, 467.6118934475162, 401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346, 152.1629946895719, 9.426565315310402, 86.50895888590935, 419.52490421519826, 163.4032294700782, 496.8995735034594, 150.10928221100457, 316.7054118304812, 340.8694217534355, 291.73885724998104, 334.8708892150255, 219.51188992534546, 424.01224876507575, 77.72499488987103, 382.42264590142577, 368.81808629883477, 110.31563063581793, 233.44823130063082, 164.42773760986887, 0.3371928311040775, 1.3124943442045698, 276.96439895121915, 537.1258707636124, 617.3741932142779, 298.65087672205135, 161.22605610403028, 645.8106716016746, 59.796166314339374, 125.10274377389825, 404.32714074925076, 149.90970347095765, 197.60959297836342, 13.292508869100443, 134.06671940012103, 10.452763028549331, 108.87560925698796, 342.86848513584357, 241.07429585838298, 107.35960956018604, 3.4163594265421184, 87.19853135712611, 418.3493141105669, 187.24733156521083, 15.69704215930278, 256.49789725409755, 246.7953927210289, 86.13966865899661, 296.635888310092, 304.21570639966933, 82.69844837894007, 17.708186018431466, 214.58194637213398, 98.72642003926387, 108.18713268152949, 117.69779654545995, 62.86055685172655, 109.76153457947618, 55.80754118909945, 85.57340733143363, 261.15040445835524, 407.64694169948774, 316.4798219010784, 64.53216597434415, 394.8289343015221, 2.2962400535463843, 73.05864454482443, 351.21616794224593, 62.539886862532114, 112.23933243990551, 193.14008909793685, 13.499999999999975, 127.92737991881441, 0.08087944381469558, 343.49096803608137, 86.4479782276202, 8.794075539641003, 184.91601147403716, 355.2470720581914, 61.45819141931183, 338.27765574332096, 94.36653655145415, 309.3182415662524, 254.57356639876042, 318.51848826047853, 85.69112028957498], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-8.424662772447535, -175.23546052755364, -523.7547258955839, -126.93549959946131, -119.65987047783797, 98.96098191467533, 171.1381792093012, 57.37785672086917, -314.1555287829958, -47.43429877778343, -55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448, -1477.3104851990051, -68.76945566333177, -1121.9388299162777, -1170.4423776101614, -1083.5624890839013, 40.0000000000003, -1462.305154272228, -337.80256187384134, -791.5663426973474, -1011.3829394797646, -751.6569012420729, -149.96002742009597, -138.037715460425, -1173.5190513124567, -1276.2295462815787, -247.55535647870343, -32.151484865405315, -1035.5633145981128, -750.5207507256381, -423.1642770464257, -517.3805312610015, -1418.616303652699, -948.2875470324932, -852.3963571557006, -423.4471971892629, -1116.2075726762669, -1377.6338930227323, 36.15143367015825, -530.1592845306983, -1124.9068251781484, -1083.1485046386417, -100.63874971932867, 40.0000000000003, -1187.9011914704215, -1043.5220001718494, -1162.0981972805732, -280.1082143094074, -891.281422925905, -1291.629456943885, -1540.0007106306791, -1282.9096305536752, -1387.061815759687, -258.8221278269986, -262.14181509086757, -1515.9785596446957, -453.6177904605944, -169.6479104136784, -1172.9116531635498, -1287.282705635622, 40.0000000000003, -1395.3840414162648, -650.2380463462935, -1196.1938580927833, 74.66328693782498, -1348.798377403471, -789.4673229995873, -1040.394983738823, -1242.00188377068, -1095.8615038823539, -219.93823350127263, -803.5070949717056, -1237.5234778082731, -585.020069359562, -1152.5461146535047, -1371.315216044777, -1491.5063853055342, -765.3496591197638, -1468.601597435513, -1189.325427293842, -1364.4586858083362, -799.2321679047595, -983.6060166168287, -1364.4905044722093, -514.857912002471, -940.025546635631, -977.9624357957388, -1434.043793711554, -699.0702616173832, -1262.2970894103034, -1337.751378744451, -1327.9108390511858, -927.1683599422063, -1100.9291355956495, -567.6869694194398, -1166.3493671397457, -775.1192992056295, -1364.6691816640218, -1111.6523055690195, -766.0681085331311, -921.6209660073794, -804.9988425810891, -35.435380847460365, -1260.8003828911794, -987.4265236961523, -626.8235228704581, -1024.9113640581866, -1127.3685881596211, -722.7659319221486, -1026.757372811938, -1280.4673344965688, -1230.3681183841659, -1183.0359832722054, -1019.5972175818217, -881.890420626834, -1264.9274976411307, -505.55611578107187, -627.7417053434561, -1309.987716194455, -1266.433029068143, -941.4383906581866, -1216.2758012901509, -979.1141788356142, -1419.200865520459, -1260.0691583881526, -1271.425170683749, -1210.3016411665437, -990.930406957456, -1302.015315917135, -1078.0262570002278, -806.0763063777025, -1128.222609887588, -601.891805455375, 40.0000000000003, -1325.122372242042, -1370.7902011722374, -1519.7009128452387, -189.50335674549663, -1022.2599403704758, -1446.615299431614, -1462.8347819902615, -1203.6423510080806, -1068.6025702548282, -296.2648233092684, -1273.2909031141614, -1415.7699060434854, -1239.0329243623696, -872.1270229035861, -1058.6617662853225, -127.38818223197234, -1167.4111735940457, -1482.583386385688, -1023.9940258790759, -992.1619866630843, -978.4828523703375, -1685.32383341174, -1324.8340213333606, -356.8147588430199, -1290.713329020855, -1236.668333044402, -1323.629966360264, -1500.3441066370394, -1071.966367428679, -561.7760721052405, -765.2928554668463, 19.189873518527534, -963.3111645995689, -1255.5965608359504, -1233.2993999748612, -618.1635715242585, -1113.8559128346328, -963.6708327079552, -764.8314025163736, -1320.9866273820412, -236.22448760073664, -673.5579445858676, -938.8692504913714, -1406.0215435529121, -615.6395862953443, -1109.8933537572327, -1209.6822097738384], "policy_predator_policy_reward": [273.5900166806395, 405.9938641881548, 697.9608555361982, 317.23891417864036, 363.15987047783835, 56.021159635146795, 276.7624346038188, 144.57634649839812, 72.63166648710526, 756.5700545211901, 292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336, 324.4738492302445, 1373.7690863216635, 1114.56393203792, 1187.2438408038292, 1096.5624890839015, 33.50895888590971, 1179.0907466374433, 1040.5418737238233, 968.4659097657257, 997.8866018814642, 1010.6352125317749, 387.8812896338544, 579.4769217903976, 882.1891271934903, 1156.4374484757354, 684.0528661150263, 553.1133849797626, 855.4708362371886, 783.6814440051907, 681.7424410168566, 1255.9532366336693, 1014.9144874950576, 865.1100284092647, 1155.0857657042754, 1107.6346659187584, 856.0323527118483, 1377.8338930227324, 41.37356121971326, 956.9767049100473, 1080.512050700223, 995.4371858380342, 557.168154818771, 171.16006009144374, 1087.0567620147976, 1232.647574323618, 1206.4208544294336, 523.7059312616885, 812.1114435834978, 1291.9666497749893, 1540.0007106306791, 1284.1391528769211, 1387.144787780646, 166.74961522758193, 631.1787266415039, 1365.4055350432682, 1141.3166858256338, 942.665593109482, 1017.2681636820245, 1167.2290261468877, 378.7045562107875, 1331.459797355665, 875.3883465109243, 1158.3007006081314, 609.0405421485012, 1010.3385104509603, 1187.7233562664383, 1172.6903531349362, 1234.8092581484652, 1073.9833843722934, 646.143493760583, 1320.129293132245, 870.8109831186921, 1279.2797540135766, 655.8960229778571, 1384.607724913877, 1491.5063853055342, 897.3970310939497, 1470.6209448614484, 1195.3247850666096, 1368.912091064118, 953.6415557377082, 938.0722380408682, 1139.0093127659725, 1083.2075888445527, 1117.368858522516, 1041.6934197672365, 916.7980537045473, 1323.6756111845807, 1263.1508007298653, 1340.3140268514308, 1327.9108390511858, 1014.3668912993327, 1187.7358681038197, 899.2295510218385, 1163.198887683185, 965.5171102274046, 1197.1490330414565, 1294.8694963508876, 828.0823367719877, 1116.1046350226209, 693.4969171811549, 393.7326989684231, 1276.4218451069953, 1057.944730139332, 834.2442484666155, 1114.1265267721226, 1406.288103719902, 748.0621227615361, 1255.0280774305556, 1134.895078256892, 1166.8462639734792, 1264.266023701323, 1185.2064916379127, 930.8630929428776, 1263.9800578534957, 605.2299756079741, 1046.8954785466858, 999.021075672755, 1266.292387874942, 1059.2768283968458, 1312.6405354671206, 945.610001510372, 1407.496337259733, 1381.535221228354, 1326.727488317736, 1210.8068647216571, 1080.3978042057338, 1298.1213260002908, 1039.1641856136964, 1106.0887822225907, 975.1294488352117, 1162.6319082072414, 424.4116011643404, 1177.1905929787763, 1446.7209416286235, 1508.302338363194, 707.6051207664601, 898.9871106510319, 1448.9115394851601, 1462.8347819902615, 1390.9314115048444, 954.3721543028917, 722.3090716151481, 1198.4628227505325, 1329.124298771291, 1388.2184184970974, 846.262420903561, 1196.7657007252533, 529.0512578236023, 958.8881871003523, 1482.583386385688, 1037.494025879076, 1099.968603912023, 998.6036150402126, 1685.32383341174, 1324.9149007771755, 1188.699185323564, 802.3198705763972, 1292.0255205423568, 1354.7207570899302, 1500.0559794923067, 1081.0485701130528, 1365.2239842655047, 146.7609547806167, 838.7854884874008, 460.5828746518306, 1082.1739229497941, 1468.1802292803286, 1097.9420733169704, 972.3550667852401, 674.2810227586937, 1148.5877490170883, 521.6146695102096, 1344.9146870388195, 817.0894266187416, 1049.9113348572578, 1001.059491938478, 1339.1201261702556, 1194.9071210488153, 1210.3595627718305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.243257371641468, "mean_inference_ms": 5.257403349406564, "mean_action_processing_ms": 2.336272291165882, "mean_env_wait_ms": 13.21284778652277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029531359672546387, "StateBufferConnector_ms": 0.021588921546936035, "ViewRequirementAgentConnector_ms": 0.21022534370422363}, "num_episodes": 22, "episode_return_max": 649.8548170323871, "episode_return_min": 0.08087944381469558, "episode_return_mean": 229.3661130617343, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.90774905168277, "num_env_steps_trained_throughput_per_sec": 148.90774905168277, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 27126.214, "restore_workers_time_ms": 0.102, "training_step_time_ms": 27125.879, "sample_time_ms": 3028.999, "learn_time_ms": 24069.462, "learn_throughput": 166.186, "synch_weights_time_ms": 21.628}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-47-51", "timestamp": 1724383071, "time_this_iter_s": 26.932358026504517, "time_total_s": 786.8428859710693, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095d74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 786.8428859710693, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 35.95789473684211, "ram_util_percent": 82.84736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.325614835093262, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.824720535076484, "policy_loss": -0.009346473667396124, "vf_loss": 8.832656325991191, "vf_explained_var": 0.25638893798545553, "kl": 0.007053388824942645, "entropy": 0.5947171164568139, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27878.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.602712637406809, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.746073402929559, "policy_loss": -0.013303849076428426, "vf_loss": 8.7568723138678, "vf_explained_var": 0.32104598800972023, "kl": 0.012524428493565037, "entropy": 1.1176161699194127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27878.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 645.8106716016746, "episode_reward_min": 0.08087944381469558, "episode_reward_mean": 213.88545947184753, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1685.32383341174, "predator_policy": 33.50895888590971}, "policy_reward_max": {"prey_policy": 102.8298943303136, "predator_policy": 1685.32383341174}, "policy_reward_mean": {"prey_policy": -865.3746377510282, "predator_policy": 972.317367486952}, "custom_metrics": {}, "hist_stats": {"episode_reward": [401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346, 152.1629946895719, 9.426565315310402, 86.50895888590935, 419.52490421519826, 163.4032294700782, 496.8995735034594, 150.10928221100457, 316.7054118304812, 340.8694217534355, 291.73885724998104, 334.8708892150255, 219.51188992534546, 424.01224876507575, 77.72499488987103, 382.42264590142577, 368.81808629883477, 110.31563063581793, 233.44823130063082, 164.42773760986887, 0.3371928311040775, 1.3124943442045698, 276.96439895121915, 537.1258707636124, 617.3741932142779, 298.65087672205135, 161.22605610403028, 645.8106716016746, 59.796166314339374, 125.10274377389825, 404.32714074925076, 149.90970347095765, 197.60959297836342, 13.292508869100443, 134.06671940012103, 10.452763028549331, 108.87560925698796, 342.86848513584357, 241.07429585838298, 107.35960956018604, 3.4163594265421184, 87.19853135712611, 418.3493141105669, 187.24733156521083, 15.69704215930278, 256.49789725409755, 246.7953927210289, 86.13966865899661, 296.635888310092, 304.21570639966933, 82.69844837894007, 17.708186018431466, 214.58194637213398, 98.72642003926387, 108.18713268152949, 117.69779654545995, 62.86055685172655, 109.76153457947618, 55.80754118909945, 85.57340733143363, 261.15040445835524, 407.64694169948774, 316.4798219010784, 64.53216597434415, 394.8289343015221, 2.2962400535463843, 73.05864454482443, 351.21616794224593, 62.539886862532114, 112.23933243990551, 193.14008909793685, 13.499999999999975, 127.92737991881441, 0.08087944381469558, 343.49096803608137, 86.4479782276202, 8.794075539641003, 184.91601147403716, 355.2470720581914, 61.45819141931183, 338.27765574332096, 94.36653655145415, 309.3182415662524, 254.57356639876042, 318.51848826047853, 85.69112028957498, 61.391160597433284, 366.35657099209146, 255.99651019667567, 55.435763495034365, 89.13678954840512], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448, -1477.3104851990051, -68.76945566333177, -1121.9388299162777, -1170.4423776101614, -1083.5624890839013, 40.0000000000003, -1462.305154272228, -337.80256187384134, -791.5663426973474, -1011.3829394797646, -751.6569012420729, -149.96002742009597, -138.037715460425, -1173.5190513124567, -1276.2295462815787, -247.55535647870343, -32.151484865405315, -1035.5633145981128, -750.5207507256381, -423.1642770464257, -517.3805312610015, -1418.616303652699, -948.2875470324932, -852.3963571557006, -423.4471971892629, -1116.2075726762669, -1377.6338930227323, 36.15143367015825, -530.1592845306983, -1124.9068251781484, -1083.1485046386417, -100.63874971932867, 40.0000000000003, -1187.9011914704215, -1043.5220001718494, -1162.0981972805732, -280.1082143094074, -891.281422925905, -1291.629456943885, -1540.0007106306791, -1282.9096305536752, -1387.061815759687, -258.8221278269986, -262.14181509086757, -1515.9785596446957, -453.6177904605944, -169.6479104136784, -1172.9116531635498, -1287.282705635622, 40.0000000000003, -1395.3840414162648, -650.2380463462935, -1196.1938580927833, 74.66328693782498, -1348.798377403471, -789.4673229995873, -1040.394983738823, -1242.00188377068, -1095.8615038823539, -219.93823350127263, -803.5070949717056, -1237.5234778082731, -585.020069359562, -1152.5461146535047, -1371.315216044777, -1491.5063853055342, -765.3496591197638, -1468.601597435513, -1189.325427293842, -1364.4586858083362, -799.2321679047595, -983.6060166168287, -1364.4905044722093, -514.857912002471, -940.025546635631, -977.9624357957388, -1434.043793711554, -699.0702616173832, -1262.2970894103034, -1337.751378744451, -1327.9108390511858, -927.1683599422063, -1100.9291355956495, -567.6869694194398, -1166.3493671397457, -775.1192992056295, -1364.6691816640218, -1111.6523055690195, -766.0681085331311, -921.6209660073794, -804.9988425810891, -35.435380847460365, -1260.8003828911794, -987.4265236961523, -626.8235228704581, -1024.9113640581866, -1127.3685881596211, -722.7659319221486, -1026.757372811938, -1280.4673344965688, -1230.3681183841659, -1183.0359832722054, -1019.5972175818217, -881.890420626834, -1264.9274976411307, -505.55611578107187, -627.7417053434561, -1309.987716194455, -1266.433029068143, -941.4383906581866, -1216.2758012901509, -979.1141788356142, -1419.200865520459, -1260.0691583881526, -1271.425170683749, -1210.3016411665437, -990.930406957456, -1302.015315917135, -1078.0262570002278, -806.0763063777025, -1128.222609887588, -601.891805455375, 40.0000000000003, -1325.122372242042, -1370.7902011722374, -1519.7009128452387, -189.50335674549663, -1022.2599403704758, -1446.615299431614, -1462.8347819902615, -1203.6423510080806, -1068.6025702548282, -296.2648233092684, -1273.2909031141614, -1415.7699060434854, -1239.0329243623696, -872.1270229035861, -1058.6617662853225, -127.38818223197234, -1167.4111735940457, -1482.583386385688, -1023.9940258790759, -992.1619866630843, -978.4828523703375, -1685.32383341174, -1324.8340213333606, -356.8147588430199, -1290.713329020855, -1236.668333044402, -1323.629966360264, -1500.3441066370394, -1071.966367428679, -561.7760721052405, -765.2928554668463, 19.189873518527534, -963.3111645995689, -1255.5965608359504, -1233.2993999748612, -618.1635715242585, -1113.8559128346328, -963.6708327079552, -764.8314025163736, -1320.9866273820412, -236.22448760073664, -673.5579445858676, -938.8692504913714, -1406.0215435529121, -615.6395862953443, -1109.8933537572327, -1209.6822097738384, -1135.5284078660727, -1122.9665073675176, -280.77740914098507, -387.1270278972946, -1326.8467592249121, -45.78816534656452, -1260.1820756238785, -1316.1735176561647, -1316.4926703857038, -948.5883216284103], "policy_predator_policy_reward": [292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336, 324.4738492302445, 1373.7690863216635, 1114.56393203792, 1187.2438408038292, 1096.5624890839015, 33.50895888590971, 1179.0907466374433, 1040.5418737238233, 968.4659097657257, 997.8866018814642, 1010.6352125317749, 387.8812896338544, 579.4769217903976, 882.1891271934903, 1156.4374484757354, 684.0528661150263, 553.1133849797626, 855.4708362371886, 783.6814440051907, 681.7424410168566, 1255.9532366336693, 1014.9144874950576, 865.1100284092647, 1155.0857657042754, 1107.6346659187584, 856.0323527118483, 1377.8338930227324, 41.37356121971326, 956.9767049100473, 1080.512050700223, 995.4371858380342, 557.168154818771, 171.16006009144374, 1087.0567620147976, 1232.647574323618, 1206.4208544294336, 523.7059312616885, 812.1114435834978, 1291.9666497749893, 1540.0007106306791, 1284.1391528769211, 1387.144787780646, 166.74961522758193, 631.1787266415039, 1365.4055350432682, 1141.3166858256338, 942.665593109482, 1017.2681636820245, 1167.2290261468877, 378.7045562107875, 1331.459797355665, 875.3883465109243, 1158.3007006081314, 609.0405421485012, 1010.3385104509603, 1187.7233562664383, 1172.6903531349362, 1234.8092581484652, 1073.9833843722934, 646.143493760583, 1320.129293132245, 870.8109831186921, 1279.2797540135766, 655.8960229778571, 1384.607724913877, 1491.5063853055342, 897.3970310939497, 1470.6209448614484, 1195.3247850666096, 1368.912091064118, 953.6415557377082, 938.0722380408682, 1139.0093127659725, 1083.2075888445527, 1117.368858522516, 1041.6934197672365, 916.7980537045473, 1323.6756111845807, 1263.1508007298653, 1340.3140268514308, 1327.9108390511858, 1014.3668912993327, 1187.7358681038197, 899.2295510218385, 1163.198887683185, 965.5171102274046, 1197.1490330414565, 1294.8694963508876, 828.0823367719877, 1116.1046350226209, 693.4969171811549, 393.7326989684231, 1276.4218451069953, 1057.944730139332, 834.2442484666155, 1114.1265267721226, 1406.288103719902, 748.0621227615361, 1255.0280774305556, 1134.895078256892, 1166.8462639734792, 1264.266023701323, 1185.2064916379127, 930.8630929428776, 1263.9800578534957, 605.2299756079741, 1046.8954785466858, 999.021075672755, 1266.292387874942, 1059.2768283968458, 1312.6405354671206, 945.610001510372, 1407.496337259733, 1381.535221228354, 1326.727488317736, 1210.8068647216571, 1080.3978042057338, 1298.1213260002908, 1039.1641856136964, 1106.0887822225907, 975.1294488352117, 1162.6319082072414, 424.4116011643404, 1177.1905929787763, 1446.7209416286235, 1508.302338363194, 707.6051207664601, 898.9871106510319, 1448.9115394851601, 1462.8347819902615, 1390.9314115048444, 954.3721543028917, 722.3090716151481, 1198.4628227505325, 1329.124298771291, 1388.2184184970974, 846.262420903561, 1196.7657007252533, 529.0512578236023, 958.8881871003523, 1482.583386385688, 1037.494025879076, 1099.968603912023, 998.6036150402126, 1685.32383341174, 1324.9149007771755, 1188.699185323564, 802.3198705763972, 1292.0255205423568, 1354.7207570899302, 1500.0559794923067, 1081.0485701130528, 1365.2239842655047, 146.7609547806167, 838.7854884874008, 460.5828746518306, 1082.1739229497941, 1468.1802292803286, 1097.9420733169704, 972.3550667852401, 674.2810227586937, 1148.5877490170883, 521.6146695102096, 1344.9146870388195, 817.0894266187416, 1049.9113348572578, 1001.059491938478, 1339.1201261702556, 1194.9071210488153, 1210.3595627718305, 1179.8380714629272, 1140.0480043680982, 552.6620269002352, 481.5989811301351, 1151.15442673837, 477.4770080297834, 1468.1087162079086, 1163.6826405671702, 1310.5977200967518, 1043.620061465767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.262951706502613, "mean_inference_ms": 5.283065421167398, "mean_action_processing_ms": 2.303920630320202, "mean_env_wait_ms": 13.26227249331306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02938997745513916, "StateBufferConnector_ms": 0.021572113037109375, "ViewRequirementAgentConnector_ms": 0.20973384380340576}, "num_episodes": 5, "episode_return_max": 645.8106716016746, "episode_return_min": 0.08087944381469558, "episode_return_mean": 213.88545947184753, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.85322653090415, "num_env_steps_trained_throughput_per_sec": 152.85322653090415, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 26969.173, "restore_workers_time_ms": 0.102, "training_step_time_ms": 26968.757, "sample_time_ms": 2915.613, "learn_time_ms": 24025.334, "learn_throughput": 166.491, "synch_weights_time_ms": 21.87}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-48-17", "timestamp": 1724383097, "time_this_iter_s": 26.2048761844635, "time_total_s": 813.0477621555328, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08b8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 813.0477621555328, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 34.494594594594595, "ram_util_percent": 83.08648648648648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.53828614779881, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.543792765985721, "policy_loss": -0.0066209432831595815, "vf_loss": 8.549058755238852, "vf_explained_var": 0.30610261417570567, "kl": 0.006774608900267927, "entropy": 0.5948530460476245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 28823.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.42636327175867, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.644776646043889, "policy_loss": -0.011647271057935777, "vf_loss": 8.654019243755037, "vf_explained_var": 0.3674985208208599, "kl": 0.012023446623176809, "entropy": 1.110702902425534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 28823.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 645.8106716016746, "episode_reward_min": 0.08087944381469558, "episode_reward_mean": 213.88545947184753, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1685.32383341174, "predator_policy": 33.50895888590971}, "policy_reward_max": {"prey_policy": 102.8298943303136, "predator_policy": 1685.32383341174}, "policy_reward_mean": {"prey_policy": -865.3746377510282, "predator_policy": 972.317367486952}, "custom_metrics": {}, "hist_stats": {"episode_reward": [401.40225569497807, 342.20237883822165, 452.92411107910095, 366.58377853141036, 570.6844041095785, 282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346, 152.1629946895719, 9.426565315310402, 86.50895888590935, 419.52490421519826, 163.4032294700782, 496.8995735034594, 150.10928221100457, 316.7054118304812, 340.8694217534355, 291.73885724998104, 334.8708892150255, 219.51188992534546, 424.01224876507575, 77.72499488987103, 382.42264590142577, 368.81808629883477, 110.31563063581793, 233.44823130063082, 164.42773760986887, 0.3371928311040775, 1.3124943442045698, 276.96439895121915, 537.1258707636124, 617.3741932142779, 298.65087672205135, 161.22605610403028, 645.8106716016746, 59.796166314339374, 125.10274377389825, 404.32714074925076, 149.90970347095765, 197.60959297836342, 13.292508869100443, 134.06671940012103, 10.452763028549331, 108.87560925698796, 342.86848513584357, 241.07429585838298, 107.35960956018604, 3.4163594265421184, 87.19853135712611, 418.3493141105669, 187.24733156521083, 15.69704215930278, 256.49789725409755, 246.7953927210289, 86.13966865899661, 296.635888310092, 304.21570639966933, 82.69844837894007, 17.708186018431466, 214.58194637213398, 98.72642003926387, 108.18713268152949, 117.69779654545995, 62.86055685172655, 109.76153457947618, 55.80754118909945, 85.57340733143363, 261.15040445835524, 407.64694169948774, 316.4798219010784, 64.53216597434415, 394.8289343015221, 2.2962400535463843, 73.05864454482443, 351.21616794224593, 62.539886862532114, 112.23933243990551, 193.14008909793685, 13.499999999999975, 127.92737991881441, 0.08087944381469558, 343.49096803608137, 86.4479782276202, 8.794075539641003, 184.91601147403716, 355.2470720581914, 61.45819141931183, 338.27765574332096, 94.36653655145415, 309.3182415662524, 254.57356639876042, 318.51848826047853, 85.69112028957498, 61.391160597433284, 366.35657099209146, 255.99651019667567, 55.435763495034365, 89.13678954840512], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-55.66779299643197, -601.5656785265685, -258.28995962271955, 42.335027168041954, -123.37644102094376, -10.986988309238733, -56.1648444082403, -681.1854703875379, -58.16742969664459, 102.8298943303136, -186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448, -1477.3104851990051, -68.76945566333177, -1121.9388299162777, -1170.4423776101614, -1083.5624890839013, 40.0000000000003, -1462.305154272228, -337.80256187384134, -791.5663426973474, -1011.3829394797646, -751.6569012420729, -149.96002742009597, -138.037715460425, -1173.5190513124567, -1276.2295462815787, -247.55535647870343, -32.151484865405315, -1035.5633145981128, -750.5207507256381, -423.1642770464257, -517.3805312610015, -1418.616303652699, -948.2875470324932, -852.3963571557006, -423.4471971892629, -1116.2075726762669, -1377.6338930227323, 36.15143367015825, -530.1592845306983, -1124.9068251781484, -1083.1485046386417, -100.63874971932867, 40.0000000000003, -1187.9011914704215, -1043.5220001718494, -1162.0981972805732, -280.1082143094074, -891.281422925905, -1291.629456943885, -1540.0007106306791, -1282.9096305536752, -1387.061815759687, -258.8221278269986, -262.14181509086757, -1515.9785596446957, -453.6177904605944, -169.6479104136784, -1172.9116531635498, -1287.282705635622, 40.0000000000003, -1395.3840414162648, -650.2380463462935, -1196.1938580927833, 74.66328693782498, -1348.798377403471, -789.4673229995873, -1040.394983738823, -1242.00188377068, -1095.8615038823539, -219.93823350127263, -803.5070949717056, -1237.5234778082731, -585.020069359562, -1152.5461146535047, -1371.315216044777, -1491.5063853055342, -765.3496591197638, -1468.601597435513, -1189.325427293842, -1364.4586858083362, -799.2321679047595, -983.6060166168287, -1364.4905044722093, -514.857912002471, -940.025546635631, -977.9624357957388, -1434.043793711554, -699.0702616173832, -1262.2970894103034, -1337.751378744451, -1327.9108390511858, -927.1683599422063, -1100.9291355956495, -567.6869694194398, -1166.3493671397457, -775.1192992056295, -1364.6691816640218, -1111.6523055690195, -766.0681085331311, -921.6209660073794, -804.9988425810891, -35.435380847460365, -1260.8003828911794, -987.4265236961523, -626.8235228704581, -1024.9113640581866, -1127.3685881596211, -722.7659319221486, -1026.757372811938, -1280.4673344965688, -1230.3681183841659, -1183.0359832722054, -1019.5972175818217, -881.890420626834, -1264.9274976411307, -505.55611578107187, -627.7417053434561, -1309.987716194455, -1266.433029068143, -941.4383906581866, -1216.2758012901509, -979.1141788356142, -1419.200865520459, -1260.0691583881526, -1271.425170683749, -1210.3016411665437, -990.930406957456, -1302.015315917135, -1078.0262570002278, -806.0763063777025, -1128.222609887588, -601.891805455375, 40.0000000000003, -1325.122372242042, -1370.7902011722374, -1519.7009128452387, -189.50335674549663, -1022.2599403704758, -1446.615299431614, -1462.8347819902615, -1203.6423510080806, -1068.6025702548282, -296.2648233092684, -1273.2909031141614, -1415.7699060434854, -1239.0329243623696, -872.1270229035861, -1058.6617662853225, -127.38818223197234, -1167.4111735940457, -1482.583386385688, -1023.9940258790759, -992.1619866630843, -978.4828523703375, -1685.32383341174, -1324.8340213333606, -356.8147588430199, -1290.713329020855, -1236.668333044402, -1323.629966360264, -1500.3441066370394, -1071.966367428679, -561.7760721052405, -765.2928554668463, 19.189873518527534, -963.3111645995689, -1255.5965608359504, -1233.2993999748612, -618.1635715242585, -1113.8559128346328, -963.6708327079552, -764.8314025163736, -1320.9866273820412, -236.22448760073664, -673.5579445858676, -938.8692504913714, -1406.0215435529121, -615.6395862953443, -1109.8933537572327, -1209.6822097738384, -1135.5284078660727, -1122.9665073675176, -280.77740914098507, -387.1270278972946, -1326.8467592249121, -45.78816534656452, -1260.1820756238785, -1316.1735176561647, -1316.4926703857038, -948.5883216284103], "policy_predator_policy_reward": [292.1603292003542, 766.4753980176239, 132.23640327927305, 425.9209080136291, 456.7633365013967, 130.52420390788492, 538.4261819927609, 565.5079113344267, 307.2289854444068, 218.79295403150286, 120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336, 324.4738492302445, 1373.7690863216635, 1114.56393203792, 1187.2438408038292, 1096.5624890839015, 33.50895888590971, 1179.0907466374433, 1040.5418737238233, 968.4659097657257, 997.8866018814642, 1010.6352125317749, 387.8812896338544, 579.4769217903976, 882.1891271934903, 1156.4374484757354, 684.0528661150263, 553.1133849797626, 855.4708362371886, 783.6814440051907, 681.7424410168566, 1255.9532366336693, 1014.9144874950576, 865.1100284092647, 1155.0857657042754, 1107.6346659187584, 856.0323527118483, 1377.8338930227324, 41.37356121971326, 956.9767049100473, 1080.512050700223, 995.4371858380342, 557.168154818771, 171.16006009144374, 1087.0567620147976, 1232.647574323618, 1206.4208544294336, 523.7059312616885, 812.1114435834978, 1291.9666497749893, 1540.0007106306791, 1284.1391528769211, 1387.144787780646, 166.74961522758193, 631.1787266415039, 1365.4055350432682, 1141.3166858256338, 942.665593109482, 1017.2681636820245, 1167.2290261468877, 378.7045562107875, 1331.459797355665, 875.3883465109243, 1158.3007006081314, 609.0405421485012, 1010.3385104509603, 1187.7233562664383, 1172.6903531349362, 1234.8092581484652, 1073.9833843722934, 646.143493760583, 1320.129293132245, 870.8109831186921, 1279.2797540135766, 655.8960229778571, 1384.607724913877, 1491.5063853055342, 897.3970310939497, 1470.6209448614484, 1195.3247850666096, 1368.912091064118, 953.6415557377082, 938.0722380408682, 1139.0093127659725, 1083.2075888445527, 1117.368858522516, 1041.6934197672365, 916.7980537045473, 1323.6756111845807, 1263.1508007298653, 1340.3140268514308, 1327.9108390511858, 1014.3668912993327, 1187.7358681038197, 899.2295510218385, 1163.198887683185, 965.5171102274046, 1197.1490330414565, 1294.8694963508876, 828.0823367719877, 1116.1046350226209, 693.4969171811549, 393.7326989684231, 1276.4218451069953, 1057.944730139332, 834.2442484666155, 1114.1265267721226, 1406.288103719902, 748.0621227615361, 1255.0280774305556, 1134.895078256892, 1166.8462639734792, 1264.266023701323, 1185.2064916379127, 930.8630929428776, 1263.9800578534957, 605.2299756079741, 1046.8954785466858, 999.021075672755, 1266.292387874942, 1059.2768283968458, 1312.6405354671206, 945.610001510372, 1407.496337259733, 1381.535221228354, 1326.727488317736, 1210.8068647216571, 1080.3978042057338, 1298.1213260002908, 1039.1641856136964, 1106.0887822225907, 975.1294488352117, 1162.6319082072414, 424.4116011643404, 1177.1905929787763, 1446.7209416286235, 1508.302338363194, 707.6051207664601, 898.9871106510319, 1448.9115394851601, 1462.8347819902615, 1390.9314115048444, 954.3721543028917, 722.3090716151481, 1198.4628227505325, 1329.124298771291, 1388.2184184970974, 846.262420903561, 1196.7657007252533, 529.0512578236023, 958.8881871003523, 1482.583386385688, 1037.494025879076, 1099.968603912023, 998.6036150402126, 1685.32383341174, 1324.9149007771755, 1188.699185323564, 802.3198705763972, 1292.0255205423568, 1354.7207570899302, 1500.0559794923067, 1081.0485701130528, 1365.2239842655047, 146.7609547806167, 838.7854884874008, 460.5828746518306, 1082.1739229497941, 1468.1802292803286, 1097.9420733169704, 972.3550667852401, 674.2810227586937, 1148.5877490170883, 521.6146695102096, 1344.9146870388195, 817.0894266187416, 1049.9113348572578, 1001.059491938478, 1339.1201261702556, 1194.9071210488153, 1210.3595627718305, 1179.8380714629272, 1140.0480043680982, 552.6620269002352, 481.5989811301351, 1151.15442673837, 477.4770080297834, 1468.1087162079086, 1163.6826405671702, 1310.5977200967518, 1043.620061465767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.262951706502613, "mean_inference_ms": 5.283065421167398, "mean_action_processing_ms": 2.303920630320202, "mean_env_wait_ms": 13.26227249331306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02938997745513916, "StateBufferConnector_ms": 0.021572113037109375, "ViewRequirementAgentConnector_ms": 0.20973384380340576}, "num_episodes": 0, "episode_return_max": 645.8106716016746, "episode_return_min": 0.08087944381469558, "episode_return_mean": 213.88545947184753, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.43460734516222, "num_env_steps_trained_throughput_per_sec": 153.43460734516222, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 26940.128, "restore_workers_time_ms": 0.076, "training_step_time_ms": 26939.749, "sample_time_ms": 2913.588, "learn_time_ms": 23997.824, "learn_throughput": 166.682, "synch_weights_time_ms": 22.196}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-48-43", "timestamp": 1724383123, "time_this_iter_s": 26.124473094940186, "time_total_s": 839.172235250473, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08b8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 839.172235250473, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 40.74324324324324, "ram_util_percent": 82.8918918918919}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.933079543567839, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.376772762984826, "policy_loss": -0.007604301714205316, "vf_loss": 8.383029680403451, "vf_explained_var": 0.36905038016183034, "kl": 0.006736676890905651, "entropy": 0.6136377555668039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29768.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.919559898326007, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.53506331620393, "policy_loss": -0.010269026600179218, "vf_loss": 8.543007249680777, "vf_explained_var": 0.4886769943136387, "kl": 0.011625579911624155, "entropy": 1.1313993982537083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29768.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 645.8106716016746, "episode_reward_min": -0.1990669584872493, "episode_reward_mean": 202.35877871225094, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1685.32383341174, "predator_policy": 33.50895888590971}, "policy_reward_max": {"prey_policy": 74.66328693782498, "predator_policy": 1685.32383341174}, "policy_reward_mean": {"prey_policy": -911.6043117268928, "predator_policy": 1012.7837010830183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [282.3830722770306, 424.9483935450345, 286.34018203420544, 449.7248287692797, 129.0642047285346, 152.1629946895719, 9.426565315310402, 86.50895888590935, 419.52490421519826, 163.4032294700782, 496.8995735034594, 150.10928221100457, 316.7054118304812, 340.8694217534355, 291.73885724998104, 334.8708892150255, 219.51188992534546, 424.01224876507575, 77.72499488987103, 382.42264590142577, 368.81808629883477, 110.31563063581793, 233.44823130063082, 164.42773760986887, 0.3371928311040775, 1.3124943442045698, 276.96439895121915, 537.1258707636124, 617.3741932142779, 298.65087672205135, 161.22605610403028, 645.8106716016746, 59.796166314339374, 125.10274377389825, 404.32714074925076, 149.90970347095765, 197.60959297836342, 13.292508869100443, 134.06671940012103, 10.452763028549331, 108.87560925698796, 342.86848513584357, 241.07429585838298, 107.35960956018604, 3.4163594265421184, 87.19853135712611, 418.3493141105669, 187.24733156521083, 15.69704215930278, 256.49789725409755, 246.7953927210289, 86.13966865899661, 296.635888310092, 304.21570639966933, 82.69844837894007, 17.708186018431466, 214.58194637213398, 98.72642003926387, 108.18713268152949, 117.69779654545995, 62.86055685172655, 109.76153457947618, 55.80754118909945, 85.57340733143363, 261.15040445835524, 407.64694169948774, 316.4798219010784, 64.53216597434415, 394.8289343015221, 2.2962400535463843, 73.05864454482443, 351.21616794224593, 62.539886862532114, 112.23933243990551, 193.14008909793685, 13.499999999999975, 127.92737991881441, 0.08087944381469558, 343.49096803608137, 86.4479782276202, 8.794075539641003, 184.91601147403716, 355.2470720581914, 61.45819141931183, 338.27765574332096, 94.36653655145415, 309.3182415662524, 254.57356639876042, 318.51848826047853, 85.69112028957498, 61.391160597433284, 366.35657099209146, 255.99651019667567, 55.435763495034365, 89.13678954840512, -0.1990669584872493, 0.10000000000000231, 229.61968073099735, 550.9772942138026, 200.63094430731502], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-186.92837744239714, -64.71556547447989, -172.56043951828443, -52.47919870092131, 30.92105247297755, -194.65585972136785, -204.17252304696186, -96.071998825283, -515.077137888612, -665.8717153689448, -1477.3104851990051, -68.76945566333177, -1121.9388299162777, -1170.4423776101614, -1083.5624890839013, 40.0000000000003, -1462.305154272228, -337.80256187384134, -791.5663426973474, -1011.3829394797646, -751.6569012420729, -149.96002742009597, -138.037715460425, -1173.5190513124567, -1276.2295462815787, -247.55535647870343, -32.151484865405315, -1035.5633145981128, -750.5207507256381, -423.1642770464257, -517.3805312610015, -1418.616303652699, -948.2875470324932, -852.3963571557006, -423.4471971892629, -1116.2075726762669, -1377.6338930227323, 36.15143367015825, -530.1592845306983, -1124.9068251781484, -1083.1485046386417, -100.63874971932867, 40.0000000000003, -1187.9011914704215, -1043.5220001718494, -1162.0981972805732, -280.1082143094074, -891.281422925905, -1291.629456943885, -1540.0007106306791, -1282.9096305536752, -1387.061815759687, -258.8221278269986, -262.14181509086757, -1515.9785596446957, -453.6177904605944, -169.6479104136784, -1172.9116531635498, -1287.282705635622, 40.0000000000003, -1395.3840414162648, -650.2380463462935, -1196.1938580927833, 74.66328693782498, -1348.798377403471, -789.4673229995873, -1040.394983738823, -1242.00188377068, -1095.8615038823539, -219.93823350127263, -803.5070949717056, -1237.5234778082731, -585.020069359562, -1152.5461146535047, -1371.315216044777, -1491.5063853055342, -765.3496591197638, -1468.601597435513, -1189.325427293842, -1364.4586858083362, -799.2321679047595, -983.6060166168287, -1364.4905044722093, -514.857912002471, -940.025546635631, -977.9624357957388, -1434.043793711554, -699.0702616173832, -1262.2970894103034, -1337.751378744451, -1327.9108390511858, -927.1683599422063, -1100.9291355956495, -567.6869694194398, -1166.3493671397457, -775.1192992056295, -1364.6691816640218, -1111.6523055690195, -766.0681085331311, -921.6209660073794, -804.9988425810891, -35.435380847460365, -1260.8003828911794, -987.4265236961523, -626.8235228704581, -1024.9113640581866, -1127.3685881596211, -722.7659319221486, -1026.757372811938, -1280.4673344965688, -1230.3681183841659, -1183.0359832722054, -1019.5972175818217, -881.890420626834, -1264.9274976411307, -505.55611578107187, -627.7417053434561, -1309.987716194455, -1266.433029068143, -941.4383906581866, -1216.2758012901509, -979.1141788356142, -1419.200865520459, -1260.0691583881526, -1271.425170683749, -1210.3016411665437, -990.930406957456, -1302.015315917135, -1078.0262570002278, -806.0763063777025, -1128.222609887588, -601.891805455375, 40.0000000000003, -1325.122372242042, -1370.7902011722374, -1519.7009128452387, -189.50335674549663, -1022.2599403704758, -1446.615299431614, -1462.8347819902615, -1203.6423510080806, -1068.6025702548282, -296.2648233092684, -1273.2909031141614, -1415.7699060434854, -1239.0329243623696, -872.1270229035861, -1058.6617662853225, -127.38818223197234, -1167.4111735940457, -1482.583386385688, -1023.9940258790759, -992.1619866630843, -978.4828523703375, -1685.32383341174, -1324.8340213333606, -356.8147588430199, -1290.713329020855, -1236.668333044402, -1323.629966360264, -1500.3441066370394, -1071.966367428679, -561.7760721052405, -765.2928554668463, 19.189873518527534, -963.3111645995689, -1255.5965608359504, -1233.2993999748612, -618.1635715242585, -1113.8559128346328, -963.6708327079552, -764.8314025163736, -1320.9866273820412, -236.22448760073664, -673.5579445858676, -938.8692504913714, -1406.0215435529121, -615.6395862953443, -1109.8933537572327, -1209.6822097738384, -1135.5284078660727, -1122.9665073675176, -280.77740914098507, -387.1270278972946, -1326.8467592249121, -45.78816534656452, -1260.1820756238785, -1316.1735176561647, -1316.4926703857038, -948.5883216284103, -1508.9670582628162, -1434.5575835589239, -1508.5072385200094, -1417.0355627860738, -1157.5955126719798, -731.5751308394309, -464.45149603004427, -1312.1816290804527, -1296.7715985631248, -114.53166833000037], "policy_predator_policy_reward": [120.72715433794865, 413.29986085595533, 414.25644803112505, 235.7315837331151, 374.89620395125945, 75.17878533133702, 161.31661613927855, 588.6527345022444, 340.11650085545836, 969.8965571306336, 324.4738492302445, 1373.7690863216635, 1114.56393203792, 1187.2438408038292, 1096.5624890839015, 33.50895888590971, 1179.0907466374433, 1040.5418737238233, 968.4659097657257, 997.8866018814642, 1010.6352125317749, 387.8812896338544, 579.4769217903976, 882.1891271934903, 1156.4374484757354, 684.0528661150263, 553.1133849797626, 855.4708362371886, 783.6814440051907, 681.7424410168566, 1255.9532366336693, 1014.9144874950576, 865.1100284092647, 1155.0857657042754, 1107.6346659187584, 856.0323527118483, 1377.8338930227324, 41.37356121971326, 956.9767049100473, 1080.512050700223, 995.4371858380342, 557.168154818771, 171.16006009144374, 1087.0567620147976, 1232.647574323618, 1206.4208544294336, 523.7059312616885, 812.1114435834978, 1291.9666497749893, 1540.0007106306791, 1284.1391528769211, 1387.144787780646, 166.74961522758193, 631.1787266415039, 1365.4055350432682, 1141.3166858256338, 942.665593109482, 1017.2681636820245, 1167.2290261468877, 378.7045562107875, 1331.459797355665, 875.3883465109243, 1158.3007006081314, 609.0405421485012, 1010.3385104509603, 1187.7233562664383, 1172.6903531349362, 1234.8092581484652, 1073.9833843722934, 646.143493760583, 1320.129293132245, 870.8109831186921, 1279.2797540135766, 655.8960229778571, 1384.607724913877, 1491.5063853055342, 897.3970310939497, 1470.6209448614484, 1195.3247850666096, 1368.912091064118, 953.6415557377082, 938.0722380408682, 1139.0093127659725, 1083.2075888445527, 1117.368858522516, 1041.6934197672365, 916.7980537045473, 1323.6756111845807, 1263.1508007298653, 1340.3140268514308, 1327.9108390511858, 1014.3668912993327, 1187.7358681038197, 899.2295510218385, 1163.198887683185, 965.5171102274046, 1197.1490330414565, 1294.8694963508876, 828.0823367719877, 1116.1046350226209, 693.4969171811549, 393.7326989684231, 1276.4218451069953, 1057.944730139332, 834.2442484666155, 1114.1265267721226, 1406.288103719902, 748.0621227615361, 1255.0280774305556, 1134.895078256892, 1166.8462639734792, 1264.266023701323, 1185.2064916379127, 930.8630929428776, 1263.9800578534957, 605.2299756079741, 1046.8954785466858, 999.021075672755, 1266.292387874942, 1059.2768283968458, 1312.6405354671206, 945.610001510372, 1407.496337259733, 1381.535221228354, 1326.727488317736, 1210.8068647216571, 1080.3978042057338, 1298.1213260002908, 1039.1641856136964, 1106.0887822225907, 975.1294488352117, 1162.6319082072414, 424.4116011643404, 1177.1905929787763, 1446.7209416286235, 1508.302338363194, 707.6051207664601, 898.9871106510319, 1448.9115394851601, 1462.8347819902615, 1390.9314115048444, 954.3721543028917, 722.3090716151481, 1198.4628227505325, 1329.124298771291, 1388.2184184970974, 846.262420903561, 1196.7657007252533, 529.0512578236023, 958.8881871003523, 1482.583386385688, 1037.494025879076, 1099.968603912023, 998.6036150402126, 1685.32383341174, 1324.9149007771755, 1188.699185323564, 802.3198705763972, 1292.0255205423568, 1354.7207570899302, 1500.0559794923067, 1081.0485701130528, 1365.2239842655047, 146.7609547806167, 838.7854884874008, 460.5828746518306, 1082.1739229497941, 1468.1802292803286, 1097.9420733169704, 972.3550667852401, 674.2810227586937, 1148.5877490170883, 521.6146695102096, 1344.9146870388195, 817.0894266187416, 1049.9113348572578, 1001.059491938478, 1339.1201261702556, 1194.9071210488153, 1210.3595627718305, 1179.8380714629272, 1140.0480043680982, 552.6620269002352, 481.5989811301351, 1151.15442673837, 477.4770080297834, 1468.1087162079086, 1163.6826405671702, 1310.5977200967518, 1043.620061465767, 1508.9670582628162, 1434.3585166004366, 1508.5072385200094, 1417.1355627860737, 770.2595368828564, 1348.5307873595518, 1076.0854728047802, 1251.5249465195186, 1351.3700599710767, 260.5641512293632]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.287558540614441, "mean_inference_ms": 5.296751253918211, "mean_action_processing_ms": 2.2628716525447095, "mean_env_wait_ms": 13.28839751417024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029273271560668945, "StateBufferConnector_ms": 0.021510601043701172, "ViewRequirementAgentConnector_ms": 0.20079731941223145}, "num_episodes": 5, "episode_return_max": 645.8106716016746, "episode_return_min": -0.1990669584872493, "episode_return_mean": 202.35877871225094, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.7171666852639, "num_env_steps_trained_throughput_per_sec": 150.7171666852639, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 26876.885, "restore_workers_time_ms": 0.064, "training_step_time_ms": 26876.443, "sample_time_ms": 2849.756, "learn_time_ms": 23997.748, "learn_throughput": 166.682, "synch_weights_time_ms": 22.703}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-49-10", "timestamp": 1724383150, "time_this_iter_s": 26.582478284835815, "time_total_s": 865.7547135353088, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08bb0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 865.7547135353088, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 41.397297297297314, "ram_util_percent": 83.24864864864863}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.915079435595759, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.290132217810898, "policy_loss": -0.007552319763612652, "vf_loss": 8.296283798621445, "vf_explained_var": 0.3683382863720889, "kl": 0.007003807296444263, "entropy": 0.6195677377559521, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 30713.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.655575949678976, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.583058815910702, "policy_loss": -0.012744870294555628, "vf_loss": 8.593542944186579, "vf_explained_var": 0.45428999593018227, "kl": 0.011303701139887962, "entropy": 1.1010008882593225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 30713.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 645.8106716016746, "episode_reward_min": -0.949567990453343, "episode_reward_mean": 187.98522891210953, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1685.32383341174, "predator_policy": 41.37356121971326}, "policy_reward_max": {"prey_policy": 157.43528758703928, "predator_policy": 1685.32383341174}, "policy_reward_mean": {"prey_policy": -971.8275939544727, "predator_policy": 1065.8202084105278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.4032294700782, 496.8995735034594, 150.10928221100457, 316.7054118304812, 340.8694217534355, 291.73885724998104, 334.8708892150255, 219.51188992534546, 424.01224876507575, 77.72499488987103, 382.42264590142577, 368.81808629883477, 110.31563063581793, 233.44823130063082, 164.42773760986887, 0.3371928311040775, 1.3124943442045698, 276.96439895121915, 537.1258707636124, 617.3741932142779, 298.65087672205135, 161.22605610403028, 645.8106716016746, 59.796166314339374, 125.10274377389825, 404.32714074925076, 149.90970347095765, 197.60959297836342, 13.292508869100443, 134.06671940012103, 10.452763028549331, 108.87560925698796, 342.86848513584357, 241.07429585838298, 107.35960956018604, 3.4163594265421184, 87.19853135712611, 418.3493141105669, 187.24733156521083, 15.69704215930278, 256.49789725409755, 246.7953927210289, 86.13966865899661, 296.635888310092, 304.21570639966933, 82.69844837894007, 17.708186018431466, 214.58194637213398, 98.72642003926387, 108.18713268152949, 117.69779654545995, 62.86055685172655, 109.76153457947618, 55.80754118909945, 85.57340733143363, 261.15040445835524, 407.64694169948774, 316.4798219010784, 64.53216597434415, 394.8289343015221, 2.2962400535463843, 73.05864454482443, 351.21616794224593, 62.539886862532114, 112.23933243990551, 193.14008909793685, 13.499999999999975, 127.92737991881441, 0.08087944381469558, 343.49096803608137, 86.4479782276202, 8.794075539641003, 184.91601147403716, 355.2470720581914, 61.45819141931183, 338.27765574332096, 94.36653655145415, 309.3182415662524, 254.57356639876042, 318.51848826047853, 85.69112028957498, 61.391160597433284, 366.35657099209146, 255.99651019667567, 55.435763495034365, 89.13678954840512, -0.1990669584872493, 0.10000000000000231, 229.61968073099735, 550.9772942138026, 200.63094430731502, 175.32189153294203, 12.54355710468941, 4.099999999999989, 120.02261005243989, -0.949567990453343, 259.6967601083857, 104.71600331872348, 10.79999999999998, 116.4778703192056], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-791.5663426973474, -1011.3829394797646, -751.6569012420729, -149.96002742009597, -138.037715460425, -1173.5190513124567, -1276.2295462815787, -247.55535647870343, -32.151484865405315, -1035.5633145981128, -750.5207507256381, -423.1642770464257, -517.3805312610015, -1418.616303652699, -948.2875470324932, -852.3963571557006, -423.4471971892629, -1116.2075726762669, -1377.6338930227323, 36.15143367015825, -530.1592845306983, -1124.9068251781484, -1083.1485046386417, -100.63874971932867, 40.0000000000003, -1187.9011914704215, -1043.5220001718494, -1162.0981972805732, -280.1082143094074, -891.281422925905, -1291.629456943885, -1540.0007106306791, -1282.9096305536752, -1387.061815759687, -258.8221278269986, -262.14181509086757, -1515.9785596446957, -453.6177904605944, -169.6479104136784, -1172.9116531635498, -1287.282705635622, 40.0000000000003, -1395.3840414162648, -650.2380463462935, -1196.1938580927833, 74.66328693782498, -1348.798377403471, -789.4673229995873, -1040.394983738823, -1242.00188377068, -1095.8615038823539, -219.93823350127263, -803.5070949717056, -1237.5234778082731, -585.020069359562, -1152.5461146535047, -1371.315216044777, -1491.5063853055342, -765.3496591197638, -1468.601597435513, -1189.325427293842, -1364.4586858083362, -799.2321679047595, -983.6060166168287, -1364.4905044722093, -514.857912002471, -940.025546635631, -977.9624357957388, -1434.043793711554, -699.0702616173832, -1262.2970894103034, -1337.751378744451, -1327.9108390511858, -927.1683599422063, -1100.9291355956495, -567.6869694194398, -1166.3493671397457, -775.1192992056295, -1364.6691816640218, -1111.6523055690195, -766.0681085331311, -921.6209660073794, -804.9988425810891, -35.435380847460365, -1260.8003828911794, -987.4265236961523, -626.8235228704581, -1024.9113640581866, -1127.3685881596211, -722.7659319221486, -1026.757372811938, -1280.4673344965688, -1230.3681183841659, -1183.0359832722054, -1019.5972175818217, -881.890420626834, -1264.9274976411307, -505.55611578107187, -627.7417053434561, -1309.987716194455, -1266.433029068143, -941.4383906581866, -1216.2758012901509, -979.1141788356142, -1419.200865520459, -1260.0691583881526, -1271.425170683749, -1210.3016411665437, -990.930406957456, -1302.015315917135, -1078.0262570002278, -806.0763063777025, -1128.222609887588, -601.891805455375, 40.0000000000003, -1325.122372242042, -1370.7902011722374, -1519.7009128452387, -189.50335674549663, -1022.2599403704758, -1446.615299431614, -1462.8347819902615, -1203.6423510080806, -1068.6025702548282, -296.2648233092684, -1273.2909031141614, -1415.7699060434854, -1239.0329243623696, -872.1270229035861, -1058.6617662853225, -127.38818223197234, -1167.4111735940457, -1482.583386385688, -1023.9940258790759, -992.1619866630843, -978.4828523703375, -1685.32383341174, -1324.8340213333606, -356.8147588430199, -1290.713329020855, -1236.668333044402, -1323.629966360264, -1500.3441066370394, -1071.966367428679, -561.7760721052405, -765.2928554668463, 19.189873518527534, -963.3111645995689, -1255.5965608359504, -1233.2993999748612, -618.1635715242585, -1113.8559128346328, -963.6708327079552, -764.8314025163736, -1320.9866273820412, -236.22448760073664, -673.5579445858676, -938.8692504913714, -1406.0215435529121, -615.6395862953443, -1109.8933537572327, -1209.6822097738384, -1135.5284078660727, -1122.9665073675176, -280.77740914098507, -387.1270278972946, -1326.8467592249121, -45.78816534656452, -1260.1820756238785, -1316.1735176561647, -1316.4926703857038, -948.5883216284103, -1508.9670582628162, -1434.5575835589239, -1508.5072385200094, -1417.0355627860738, -1157.5955126719798, -731.5751308394309, -464.45149603004427, -1312.1816290804527, -1296.7715985631248, -114.53166833000037, -630.4535285558928, -1212.7876447842336, -1454.930236459725, -1375.2070225859134, -1469.5498793598151, -1434.9093630808604, -573.6355443688446, -1321.3673340831645, -1250.7242321549732, -1396.0838437555406, 157.43528758703928, -1468.585846070838, -974.457800980885, -1627.7687295614353, -1089.1271282565203, -1303.6354807593304, -1325.8243691472085, -1096.7868662708947], "policy_predator_policy_reward": [968.4659097657257, 997.8866018814642, 1010.6352125317749, 387.8812896338544, 579.4769217903976, 882.1891271934903, 1156.4374484757354, 684.0528661150263, 553.1133849797626, 855.4708362371886, 783.6814440051907, 681.7424410168566, 1255.9532366336693, 1014.9144874950576, 865.1100284092647, 1155.0857657042754, 1107.6346659187584, 856.0323527118483, 1377.8338930227324, 41.37356121971326, 956.9767049100473, 1080.512050700223, 995.4371858380342, 557.168154818771, 171.16006009144374, 1087.0567620147976, 1232.647574323618, 1206.4208544294336, 523.7059312616885, 812.1114435834978, 1291.9666497749893, 1540.0007106306791, 1284.1391528769211, 1387.144787780646, 166.74961522758193, 631.1787266415039, 1365.4055350432682, 1141.3166858256338, 942.665593109482, 1017.2681636820245, 1167.2290261468877, 378.7045562107875, 1331.459797355665, 875.3883465109243, 1158.3007006081314, 609.0405421485012, 1010.3385104509603, 1187.7233562664383, 1172.6903531349362, 1234.8092581484652, 1073.9833843722934, 646.143493760583, 1320.129293132245, 870.8109831186921, 1279.2797540135766, 655.8960229778571, 1384.607724913877, 1491.5063853055342, 897.3970310939497, 1470.6209448614484, 1195.3247850666096, 1368.912091064118, 953.6415557377082, 938.0722380408682, 1139.0093127659725, 1083.2075888445527, 1117.368858522516, 1041.6934197672365, 916.7980537045473, 1323.6756111845807, 1263.1508007298653, 1340.3140268514308, 1327.9108390511858, 1014.3668912993327, 1187.7358681038197, 899.2295510218385, 1163.198887683185, 965.5171102274046, 1197.1490330414565, 1294.8694963508876, 828.0823367719877, 1116.1046350226209, 693.4969171811549, 393.7326989684231, 1276.4218451069953, 1057.944730139332, 834.2442484666155, 1114.1265267721226, 1406.288103719902, 748.0621227615361, 1255.0280774305556, 1134.895078256892, 1166.8462639734792, 1264.266023701323, 1185.2064916379127, 930.8630929428776, 1263.9800578534957, 605.2299756079741, 1046.8954785466858, 999.021075672755, 1266.292387874942, 1059.2768283968458, 1312.6405354671206, 945.610001510372, 1407.496337259733, 1381.535221228354, 1326.727488317736, 1210.8068647216571, 1080.3978042057338, 1298.1213260002908, 1039.1641856136964, 1106.0887822225907, 975.1294488352117, 1162.6319082072414, 424.4116011643404, 1177.1905929787763, 1446.7209416286235, 1508.302338363194, 707.6051207664601, 898.9871106510319, 1448.9115394851601, 1462.8347819902615, 1390.9314115048444, 954.3721543028917, 722.3090716151481, 1198.4628227505325, 1329.124298771291, 1388.2184184970974, 846.262420903561, 1196.7657007252533, 529.0512578236023, 958.8881871003523, 1482.583386385688, 1037.494025879076, 1099.968603912023, 998.6036150402126, 1685.32383341174, 1324.9149007771755, 1188.699185323564, 802.3198705763972, 1292.0255205423568, 1354.7207570899302, 1500.0559794923067, 1081.0485701130528, 1365.2239842655047, 146.7609547806167, 838.7854884874008, 460.5828746518306, 1082.1739229497941, 1468.1802292803286, 1097.9420733169704, 972.3550667852401, 674.2810227586937, 1148.5877490170883, 521.6146695102096, 1344.9146870388195, 817.0894266187416, 1049.9113348572578, 1001.059491938478, 1339.1201261702556, 1194.9071210488153, 1210.3595627718305, 1179.8380714629272, 1140.0480043680982, 552.6620269002352, 481.5989811301351, 1151.15442673837, 477.4770080297834, 1468.1087162079086, 1163.6826405671702, 1310.5977200967518, 1043.620061465767, 1508.9670582628162, 1434.3585166004366, 1508.5072385200094, 1417.1355627860737, 770.2595368828564, 1348.5307873595518, 1076.0854728047802, 1251.5249465195186, 1351.3700599710767, 260.5641512293632, 1209.6706614741508, 808.8924033989186, 1481.5555097361098, 1361.1253064142177, 1473.649879359815, 1434.9093630808604, 652.5710540064473, 1362.4544344980022, 1290.7300665002515, 1355.1284414198092, 736.2096407585044, 834.6376778336825, 1081.8847910852546, 1625.0577427757892, 1099.9271282565217, 1303.6354807593304, 1330.2327567108957, 1208.8563490264141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.247689377938448, "mean_inference_ms": 5.30633867021858, "mean_action_processing_ms": 2.2872290683867798, "mean_env_wait_ms": 13.32673596649173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02921140193939209, "StateBufferConnector_ms": 0.021523714065551758, "ViewRequirementAgentConnector_ms": 0.18483400344848633}, "num_episodes": 9, "episode_return_max": 645.8106716016746, "episode_return_min": -0.949567990453343, "episode_return_mean": 187.98522891210953, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.76540780342586, "num_env_steps_trained_throughput_per_sec": 151.76540780342586, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 26892.703, "restore_workers_time_ms": 0.065, "training_step_time_ms": 26892.286, "sample_time_ms": 2865.46, "learn_time_ms": 23999.156, "learn_throughput": 166.673, "synch_weights_time_ms": 21.62}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-49-36", "timestamp": 1724383176, "time_this_iter_s": 26.39947509765625, "time_total_s": 892.1541886329651, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08bb310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 892.1541886329651, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 35.85945945945946, "ram_util_percent": 82.35135135135137}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.898694015179993, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.076931260628674, "policy_loss": -0.006221724035977213, "vf_loss": 8.081771551868902, "vf_explained_var": 0.4055658304502094, "kl": 0.006907270930303389, "entropy": 0.6355118505223087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31658.0, "diff_num_grad_updates_vs_sampler_policy": 493.2625000000007}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.735135681162436, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.35824281349384, "policy_loss": -0.011566828698333767, "vf_loss": 8.367485160423964, "vf_explained_var": 0.4518796790213812, "kl": 0.011622461875673956, "entropy": 1.100336323213325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31658.0, "diff_num_grad_updates_vs_sampler_policy": 493.2625000000007}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 645.8106716016746, "episode_reward_min": -0.949567990453343, "episode_reward_mean": 168.41213882433308, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1685.32383341174, "predator_policy": 146.7609547806167}, "policy_reward_max": {"prey_policy": 157.43528758703928, "predator_policy": 1685.32383341174}, "policy_reward_mean": {"prey_policy": -1023.4609200915339, "predator_policy": 1107.6669895037005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.31563063581793, 233.44823130063082, 164.42773760986887, 0.3371928311040775, 1.3124943442045698, 276.96439895121915, 537.1258707636124, 617.3741932142779, 298.65087672205135, 161.22605610403028, 645.8106716016746, 59.796166314339374, 125.10274377389825, 404.32714074925076, 149.90970347095765, 197.60959297836342, 13.292508869100443, 134.06671940012103, 10.452763028549331, 108.87560925698796, 342.86848513584357, 241.07429585838298, 107.35960956018604, 3.4163594265421184, 87.19853135712611, 418.3493141105669, 187.24733156521083, 15.69704215930278, 256.49789725409755, 246.7953927210289, 86.13966865899661, 296.635888310092, 304.21570639966933, 82.69844837894007, 17.708186018431466, 214.58194637213398, 98.72642003926387, 108.18713268152949, 117.69779654545995, 62.86055685172655, 109.76153457947618, 55.80754118909945, 85.57340733143363, 261.15040445835524, 407.64694169948774, 316.4798219010784, 64.53216597434415, 394.8289343015221, 2.2962400535463843, 73.05864454482443, 351.21616794224593, 62.539886862532114, 112.23933243990551, 193.14008909793685, 13.499999999999975, 127.92737991881441, 0.08087944381469558, 343.49096803608137, 86.4479782276202, 8.794075539641003, 184.91601147403716, 355.2470720581914, 61.45819141931183, 338.27765574332096, 94.36653655145415, 309.3182415662524, 254.57356639876042, 318.51848826047853, 85.69112028957498, 61.391160597433284, 366.35657099209146, 255.99651019667567, 55.435763495034365, 89.13678954840512, -0.1990669584872493, 0.10000000000000231, 229.61968073099735, 550.9772942138026, 200.63094430731502, 175.32189153294203, 12.54355710468941, 4.099999999999989, 120.02261005243989, -0.949567990453343, 259.6967601083857, 104.71600331872348, 10.79999999999998, 116.4778703192056, 0.41672595435132287, 208.18802158764777, 26.617567659981088, 1.7805781223393229, 0.8896813079937429, 184.05712370008519, 46.00000000000002, 308.00511696331415, 263.6679926879089, 248.7270513343284, 320.4723533757343, 0.9553095426887301], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [40.0000000000003, -1187.9011914704215, -1043.5220001718494, -1162.0981972805732, -280.1082143094074, -891.281422925905, -1291.629456943885, -1540.0007106306791, -1282.9096305536752, -1387.061815759687, -258.8221278269986, -262.14181509086757, -1515.9785596446957, -453.6177904605944, -169.6479104136784, -1172.9116531635498, -1287.282705635622, 40.0000000000003, -1395.3840414162648, -650.2380463462935, -1196.1938580927833, 74.66328693782498, -1348.798377403471, -789.4673229995873, -1040.394983738823, -1242.00188377068, -1095.8615038823539, -219.93823350127263, -803.5070949717056, -1237.5234778082731, -585.020069359562, -1152.5461146535047, -1371.315216044777, -1491.5063853055342, -765.3496591197638, -1468.601597435513, -1189.325427293842, -1364.4586858083362, -799.2321679047595, -983.6060166168287, -1364.4905044722093, -514.857912002471, -940.025546635631, -977.9624357957388, -1434.043793711554, -699.0702616173832, -1262.2970894103034, -1337.751378744451, -1327.9108390511858, -927.1683599422063, -1100.9291355956495, -567.6869694194398, -1166.3493671397457, -775.1192992056295, -1364.6691816640218, -1111.6523055690195, -766.0681085331311, -921.6209660073794, -804.9988425810891, -35.435380847460365, -1260.8003828911794, -987.4265236961523, -626.8235228704581, -1024.9113640581866, -1127.3685881596211, -722.7659319221486, -1026.757372811938, -1280.4673344965688, -1230.3681183841659, -1183.0359832722054, -1019.5972175818217, -881.890420626834, -1264.9274976411307, -505.55611578107187, -627.7417053434561, -1309.987716194455, -1266.433029068143, -941.4383906581866, -1216.2758012901509, -979.1141788356142, -1419.200865520459, -1260.0691583881526, -1271.425170683749, -1210.3016411665437, -990.930406957456, -1302.015315917135, -1078.0262570002278, -806.0763063777025, -1128.222609887588, -601.891805455375, 40.0000000000003, -1325.122372242042, -1370.7902011722374, -1519.7009128452387, -189.50335674549663, -1022.2599403704758, -1446.615299431614, -1462.8347819902615, -1203.6423510080806, -1068.6025702548282, -296.2648233092684, -1273.2909031141614, -1415.7699060434854, -1239.0329243623696, -872.1270229035861, -1058.6617662853225, -127.38818223197234, -1167.4111735940457, -1482.583386385688, -1023.9940258790759, -992.1619866630843, -978.4828523703375, -1685.32383341174, -1324.8340213333606, -356.8147588430199, -1290.713329020855, -1236.668333044402, -1323.629966360264, -1500.3441066370394, -1071.966367428679, -561.7760721052405, -765.2928554668463, 19.189873518527534, -963.3111645995689, -1255.5965608359504, -1233.2993999748612, -618.1635715242585, -1113.8559128346328, -963.6708327079552, -764.8314025163736, -1320.9866273820412, -236.22448760073664, -673.5579445858676, -938.8692504913714, -1406.0215435529121, -615.6395862953443, -1109.8933537572327, -1209.6822097738384, -1135.5284078660727, -1122.9665073675176, -280.77740914098507, -387.1270278972946, -1326.8467592249121, -45.78816534656452, -1260.1820756238785, -1316.1735176561647, -1316.4926703857038, -948.5883216284103, -1508.9670582628162, -1434.5575835589239, -1508.5072385200094, -1417.0355627860738, -1157.5955126719798, -731.5751308394309, -464.45149603004427, -1312.1816290804527, -1296.7715985631248, -114.53166833000037, -630.4535285558928, -1212.7876447842336, -1454.930236459725, -1375.2070225859134, -1469.5498793598151, -1434.9093630808604, -573.6355443688446, -1321.3673340831645, -1250.7242321549732, -1396.0838437555406, 157.43528758703928, -1468.585846070838, -974.457800980885, -1627.7687295614353, -1089.1271282565203, -1303.6354807593304, -1325.8243691472085, -1096.7868662708947, -1313.8118436816155, -1577.9638524390577, -1093.8524539564949, -930.8180234572111, -1611.9861794258675, -1100.7460483660802, -1469.345295210985, -1415.9771423338443, -1331.8423347064931, -1390.064053838507, -574.6131112610434, -1327.9099571579447, -1231.7479719770834, -1163.54312691231, -1105.5473770553613, -737.7461917736106, -1264.2164835720357, -517.4112360511577, -256.9677217385108, -1477.6579343302858, -870.9913253025921, -1129.7343011591527, -1328.8976930755296, -1341.2526086242917], "policy_predator_policy_reward": [171.16006009144374, 1087.0567620147976, 1232.647574323618, 1206.4208544294336, 523.7059312616885, 812.1114435834978, 1291.9666497749893, 1540.0007106306791, 1284.1391528769211, 1387.144787780646, 166.74961522758193, 631.1787266415039, 1365.4055350432682, 1141.3166858256338, 942.665593109482, 1017.2681636820245, 1167.2290261468877, 378.7045562107875, 1331.459797355665, 875.3883465109243, 1158.3007006081314, 609.0405421485012, 1010.3385104509603, 1187.7233562664383, 1172.6903531349362, 1234.8092581484652, 1073.9833843722934, 646.143493760583, 1320.129293132245, 870.8109831186921, 1279.2797540135766, 655.8960229778571, 1384.607724913877, 1491.5063853055342, 897.3970310939497, 1470.6209448614484, 1195.3247850666096, 1368.912091064118, 953.6415557377082, 938.0722380408682, 1139.0093127659725, 1083.2075888445527, 1117.368858522516, 1041.6934197672365, 916.7980537045473, 1323.6756111845807, 1263.1508007298653, 1340.3140268514308, 1327.9108390511858, 1014.3668912993327, 1187.7358681038197, 899.2295510218385, 1163.198887683185, 965.5171102274046, 1197.1490330414565, 1294.8694963508876, 828.0823367719877, 1116.1046350226209, 693.4969171811549, 393.7326989684231, 1276.4218451069953, 1057.944730139332, 834.2442484666155, 1114.1265267721226, 1406.288103719902, 748.0621227615361, 1255.0280774305556, 1134.895078256892, 1166.8462639734792, 1264.266023701323, 1185.2064916379127, 930.8630929428776, 1263.9800578534957, 605.2299756079741, 1046.8954785466858, 999.021075672755, 1266.292387874942, 1059.2768283968458, 1312.6405354671206, 945.610001510372, 1407.496337259733, 1381.535221228354, 1326.727488317736, 1210.8068647216571, 1080.3978042057338, 1298.1213260002908, 1039.1641856136964, 1106.0887822225907, 975.1294488352117, 1162.6319082072414, 424.4116011643404, 1177.1905929787763, 1446.7209416286235, 1508.302338363194, 707.6051207664601, 898.9871106510319, 1448.9115394851601, 1462.8347819902615, 1390.9314115048444, 954.3721543028917, 722.3090716151481, 1198.4628227505325, 1329.124298771291, 1388.2184184970974, 846.262420903561, 1196.7657007252533, 529.0512578236023, 958.8881871003523, 1482.583386385688, 1037.494025879076, 1099.968603912023, 998.6036150402126, 1685.32383341174, 1324.9149007771755, 1188.699185323564, 802.3198705763972, 1292.0255205423568, 1354.7207570899302, 1500.0559794923067, 1081.0485701130528, 1365.2239842655047, 146.7609547806167, 838.7854884874008, 460.5828746518306, 1082.1739229497941, 1468.1802292803286, 1097.9420733169704, 972.3550667852401, 674.2810227586937, 1148.5877490170883, 521.6146695102096, 1344.9146870388195, 817.0894266187416, 1049.9113348572578, 1001.059491938478, 1339.1201261702556, 1194.9071210488153, 1210.3595627718305, 1179.8380714629272, 1140.0480043680982, 552.6620269002352, 481.5989811301351, 1151.15442673837, 477.4770080297834, 1468.1087162079086, 1163.6826405671702, 1310.5977200967518, 1043.620061465767, 1508.9670582628162, 1434.3585166004366, 1508.5072385200094, 1417.1355627860737, 770.2595368828564, 1348.5307873595518, 1076.0854728047802, 1251.5249465195186, 1351.3700599710767, 260.5641512293632, 1209.6706614741508, 808.8924033989186, 1481.5555097361098, 1361.1253064142177, 1473.649879359815, 1434.9093630808604, 652.5710540064473, 1362.4544344980022, 1290.7300665002515, 1355.1284414198092, 736.2096407585044, 834.6376778336825, 1081.8847910852546, 1625.0577427757892, 1099.9271282565217, 1303.6354807593304, 1330.2327567108957, 1208.8563490264141, 1314.2285696359668, 1577.9638524390577, 1232.547032518842, 1000.3114664825116, 1612.3861794258676, 1126.9636160260625, 1470.425873333324, 1416.6771423338444, 1332.7320160144868, 1390.064053838507, 1243.3084526759128, 843.2717394431608, 1271.7479719770827, 1169.5431269123098, 893.6987135429704, 1257.599972249315, 1263.9861728341768, 781.3095394769281, 504.30073941576507, 1479.05196798736, 1125.702599887268, 1195.495379950203, 1329.2530026182183, 1341.8526086242919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.29485137866927, "mean_inference_ms": 5.352232755803699, "mean_action_processing_ms": 2.2515073241416625, "mean_env_wait_ms": 13.347122303885554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029085516929626465, "StateBufferConnector_ms": 0.021524786949157715, "ViewRequirementAgentConnector_ms": 0.1996248960494995}, "num_episodes": 12, "episode_return_max": 645.8106716016746, "episode_return_min": -0.949567990453343, "episode_return_mean": 168.41213882433308, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.60279293381015, "num_env_steps_trained_throughput_per_sec": 146.60279293381015, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 27001.775, "restore_workers_time_ms": 0.052, "training_step_time_ms": 27001.331, "sample_time_ms": 2934.226, "learn_time_ms": 24037.776, "learn_throughput": 166.405, "synch_weights_time_ms": 22.728}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-50-04", "timestamp": 1724383204, "time_this_iter_s": 27.339579820632935, "time_total_s": 919.493768453598, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095a6280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 919.493768453598, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 38.00256410256411, "ram_util_percent": 82.97692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.406587189467496, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.24601657504127, "policy_loss": -0.009081864543259145, "vf_loss": 8.25367701848348, "vf_explained_var": 0.4026140428094006, "kl": 0.007106984891588726, "entropy": 0.584095823354822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 32603.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.888949982955975, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.292401909702038, "policy_loss": -0.011707465060390335, "vf_loss": 8.302284633293354, "vf_explained_var": 0.5610686791636956, "kl": 0.009123726890092252, "entropy": 1.0496713074426802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 32603.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 645.8106716016746, "episode_reward_min": -0.949567990453343, "episode_reward_mean": 162.26985017310176, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1685.32383341174, "predator_policy": 48.917171772316856}, "policy_reward_max": {"prey_policy": 157.43528758703928, "predator_policy": 1685.32383341174}, "policy_reward_mean": {"prey_policy": -1026.11695887401, "predator_policy": 1107.2518839605607}, "custom_metrics": {}, "hist_stats": {"episode_reward": [161.22605610403028, 645.8106716016746, 59.796166314339374, 125.10274377389825, 404.32714074925076, 149.90970347095765, 197.60959297836342, 13.292508869100443, 134.06671940012103, 10.452763028549331, 108.87560925698796, 342.86848513584357, 241.07429585838298, 107.35960956018604, 3.4163594265421184, 87.19853135712611, 418.3493141105669, 187.24733156521083, 15.69704215930278, 256.49789725409755, 246.7953927210289, 86.13966865899661, 296.635888310092, 304.21570639966933, 82.69844837894007, 17.708186018431466, 214.58194637213398, 98.72642003926387, 108.18713268152949, 117.69779654545995, 62.86055685172655, 109.76153457947618, 55.80754118909945, 85.57340733143363, 261.15040445835524, 407.64694169948774, 316.4798219010784, 64.53216597434415, 394.8289343015221, 2.2962400535463843, 73.05864454482443, 351.21616794224593, 62.539886862532114, 112.23933243990551, 193.14008909793685, 13.499999999999975, 127.92737991881441, 0.08087944381469558, 343.49096803608137, 86.4479782276202, 8.794075539641003, 184.91601147403716, 355.2470720581914, 61.45819141931183, 338.27765574332096, 94.36653655145415, 309.3182415662524, 254.57356639876042, 318.51848826047853, 85.69112028957498, 61.391160597433284, 366.35657099209146, 255.99651019667567, 55.435763495034365, 89.13678954840512, -0.1990669584872493, 0.10000000000000231, 229.61968073099735, 550.9772942138026, 200.63094430731502, 175.32189153294203, 12.54355710468941, 4.099999999999989, 120.02261005243989, -0.949567990453343, 259.6967601083857, 104.71600331872348, 10.79999999999998, 116.4778703192056, 0.41672595435132287, 208.18802158764777, 26.617567659981088, 1.7805781223393229, 0.8896813079937429, 184.05712370008519, 46.00000000000002, 308.00511696331415, 263.6679926879089, 248.7270513343284, 320.4723533757343, 0.9553095426887301, 3.158514446087425, 290.333430312121, 477.7603154011425, 48.2950174935804, 292.41334351544725, 1.000000000000003, 93.91938525113599, 75.97317690733402, 342.87457792280895], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1395.3840414162648, -650.2380463462935, -1196.1938580927833, 74.66328693782498, -1348.798377403471, -789.4673229995873, -1040.394983738823, -1242.00188377068, -1095.8615038823539, -219.93823350127263, -803.5070949717056, -1237.5234778082731, -585.020069359562, -1152.5461146535047, -1371.315216044777, -1491.5063853055342, -765.3496591197638, -1468.601597435513, -1189.325427293842, -1364.4586858083362, -799.2321679047595, -983.6060166168287, -1364.4905044722093, -514.857912002471, -940.025546635631, -977.9624357957388, -1434.043793711554, -699.0702616173832, -1262.2970894103034, -1337.751378744451, -1327.9108390511858, -927.1683599422063, -1100.9291355956495, -567.6869694194398, -1166.3493671397457, -775.1192992056295, -1364.6691816640218, -1111.6523055690195, -766.0681085331311, -921.6209660073794, -804.9988425810891, -35.435380847460365, -1260.8003828911794, -987.4265236961523, -626.8235228704581, -1024.9113640581866, -1127.3685881596211, -722.7659319221486, -1026.757372811938, -1280.4673344965688, -1230.3681183841659, -1183.0359832722054, -1019.5972175818217, -881.890420626834, -1264.9274976411307, -505.55611578107187, -627.7417053434561, -1309.987716194455, -1266.433029068143, -941.4383906581866, -1216.2758012901509, -979.1141788356142, -1419.200865520459, -1260.0691583881526, -1271.425170683749, -1210.3016411665437, -990.930406957456, -1302.015315917135, -1078.0262570002278, -806.0763063777025, -1128.222609887588, -601.891805455375, 40.0000000000003, -1325.122372242042, -1370.7902011722374, -1519.7009128452387, -189.50335674549663, -1022.2599403704758, -1446.615299431614, -1462.8347819902615, -1203.6423510080806, -1068.6025702548282, -296.2648233092684, -1273.2909031141614, -1415.7699060434854, -1239.0329243623696, -872.1270229035861, -1058.6617662853225, -127.38818223197234, -1167.4111735940457, -1482.583386385688, -1023.9940258790759, -992.1619866630843, -978.4828523703375, -1685.32383341174, -1324.8340213333606, -356.8147588430199, -1290.713329020855, -1236.668333044402, -1323.629966360264, -1500.3441066370394, -1071.966367428679, -561.7760721052405, -765.2928554668463, 19.189873518527534, -963.3111645995689, -1255.5965608359504, -1233.2993999748612, -618.1635715242585, -1113.8559128346328, -963.6708327079552, -764.8314025163736, -1320.9866273820412, -236.22448760073664, -673.5579445858676, -938.8692504913714, -1406.0215435529121, -615.6395862953443, -1109.8933537572327, -1209.6822097738384, -1135.5284078660727, -1122.9665073675176, -280.77740914098507, -387.1270278972946, -1326.8467592249121, -45.78816534656452, -1260.1820756238785, -1316.1735176561647, -1316.4926703857038, -948.5883216284103, -1508.9670582628162, -1434.5575835589239, -1508.5072385200094, -1417.0355627860738, -1157.5955126719798, -731.5751308394309, -464.45149603004427, -1312.1816290804527, -1296.7715985631248, -114.53166833000037, -630.4535285558928, -1212.7876447842336, -1454.930236459725, -1375.2070225859134, -1469.5498793598151, -1434.9093630808604, -573.6355443688446, -1321.3673340831645, -1250.7242321549732, -1396.0838437555406, 157.43528758703928, -1468.585846070838, -974.457800980885, -1627.7687295614353, -1089.1271282565203, -1303.6354807593304, -1325.8243691472085, -1096.7868662708947, -1313.8118436816155, -1577.9638524390577, -1093.8524539564949, -930.8180234572111, -1611.9861794258675, -1100.7460483660802, -1469.345295210985, -1415.9771423338443, -1331.8423347064931, -1390.064053838507, -574.6131112610434, -1327.9099571579447, -1231.7479719770834, -1163.54312691231, -1105.5473770553613, -737.7461917736106, -1264.2164835720357, -517.4112360511577, -256.9677217385108, -1477.6579343302858, -870.9913253025921, -1129.7343011591527, -1328.8976930755296, -1341.2526086242917, -1475.0517171377141, -1555.9527161352087, -641.0440628516924, -151.9718343195909, -1309.3772839489095, -373.72911918659867, -1056.424235163232, -1321.0088139929485, 28.869542338169232, -756.0157446097812, -1526.4965273522637, -1097.4859143596545, -1434.097700798681, -958.8621389221931, -532.1363908150721, -3.0176923178562367, -1187.6762153871578, -286.64439381689914], "policy_predator_policy_reward": [1331.459797355665, 875.3883465109243, 1158.3007006081314, 609.0405421485012, 1010.3385104509603, 1187.7233562664383, 1172.6903531349362, 1234.8092581484652, 1073.9833843722934, 646.143493760583, 1320.129293132245, 870.8109831186921, 1279.2797540135766, 655.8960229778571, 1384.607724913877, 1491.5063853055342, 897.3970310939497, 1470.6209448614484, 1195.3247850666096, 1368.912091064118, 953.6415557377082, 938.0722380408682, 1139.0093127659725, 1083.2075888445527, 1117.368858522516, 1041.6934197672365, 916.7980537045473, 1323.6756111845807, 1263.1508007298653, 1340.3140268514308, 1327.9108390511858, 1014.3668912993327, 1187.7358681038197, 899.2295510218385, 1163.198887683185, 965.5171102274046, 1197.1490330414565, 1294.8694963508876, 828.0823367719877, 1116.1046350226209, 693.4969171811549, 393.7326989684231, 1276.4218451069953, 1057.944730139332, 834.2442484666155, 1114.1265267721226, 1406.288103719902, 748.0621227615361, 1255.0280774305556, 1134.895078256892, 1166.8462639734792, 1264.266023701323, 1185.2064916379127, 930.8630929428776, 1263.9800578534957, 605.2299756079741, 1046.8954785466858, 999.021075672755, 1266.292387874942, 1059.2768283968458, 1312.6405354671206, 945.610001510372, 1407.496337259733, 1381.535221228354, 1326.727488317736, 1210.8068647216571, 1080.3978042057338, 1298.1213260002908, 1039.1641856136964, 1106.0887822225907, 975.1294488352117, 1162.6319082072414, 424.4116011643404, 1177.1905929787763, 1446.7209416286235, 1508.302338363194, 707.6051207664601, 898.9871106510319, 1448.9115394851601, 1462.8347819902615, 1390.9314115048444, 954.3721543028917, 722.3090716151481, 1198.4628227505325, 1329.124298771291, 1388.2184184970974, 846.262420903561, 1196.7657007252533, 529.0512578236023, 958.8881871003523, 1482.583386385688, 1037.494025879076, 1099.968603912023, 998.6036150402126, 1685.32383341174, 1324.9149007771755, 1188.699185323564, 802.3198705763972, 1292.0255205423568, 1354.7207570899302, 1500.0559794923067, 1081.0485701130528, 1365.2239842655047, 146.7609547806167, 838.7854884874008, 460.5828746518306, 1082.1739229497941, 1468.1802292803286, 1097.9420733169704, 972.3550667852401, 674.2810227586937, 1148.5877490170883, 521.6146695102096, 1344.9146870388195, 817.0894266187416, 1049.9113348572578, 1001.059491938478, 1339.1201261702556, 1194.9071210488153, 1210.3595627718305, 1179.8380714629272, 1140.0480043680982, 552.6620269002352, 481.5989811301351, 1151.15442673837, 477.4770080297834, 1468.1087162079086, 1163.6826405671702, 1310.5977200967518, 1043.620061465767, 1508.9670582628162, 1434.3585166004366, 1508.5072385200094, 1417.1355627860737, 770.2595368828564, 1348.5307873595518, 1076.0854728047802, 1251.5249465195186, 1351.3700599710767, 260.5641512293632, 1209.6706614741508, 808.8924033989186, 1481.5555097361098, 1361.1253064142177, 1473.649879359815, 1434.9093630808604, 652.5710540064473, 1362.4544344980022, 1290.7300665002515, 1355.1284414198092, 736.2096407585044, 834.6376778336825, 1081.8847910852546, 1625.0577427757892, 1099.9271282565217, 1303.6354807593304, 1330.2327567108957, 1208.8563490264141, 1314.2285696359668, 1577.9638524390577, 1232.547032518842, 1000.3114664825116, 1612.3861794258676, 1126.9636160260625, 1470.425873333324, 1416.6771423338444, 1332.7320160144868, 1390.064053838507, 1243.3084526759128, 843.2717394431608, 1271.7479719770827, 1169.5431269123098, 893.6987135429704, 1257.599972249315, 1263.9861728341768, 781.3095394769281, 504.30073941576507, 1479.05196798736, 1125.702599887268, 1195.495379950203, 1329.2530026182183, 1341.8526086242919, 1475.2102315838015, 1558.9527161352084, 48.917171772316856, 1034.4321557110877, 1085.6383050440425, 1075.2284134926085, 1100.319252656805, 1325.408813992948, 585.5199026227924, 434.03964316426277, 1526.4965273522637, 1098.4859143596545, 1031.1008597682476, 1455.7783652037624, 557.6038746918492, 53.52338534841784, 1155.411058729001, 661.7841283978671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.280203987368981, "mean_inference_ms": 5.357216984451146, "mean_action_processing_ms": 2.2381078860813832, "mean_env_wait_ms": 13.349363369552382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02408623695373535, "StateBufferConnector_ms": 0.020986557006835938, "ViewRequirementAgentConnector_ms": 0.14548206329345703}, "num_episodes": 9, "episode_return_max": 645.8106716016746, "episode_return_min": -0.949567990453343, "episode_return_mean": 162.26985017310176, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.4501596307304, "num_env_steps_trained_throughput_per_sec": 145.4501596307304, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 27136.047, "restore_workers_time_ms": 0.085, "training_step_time_ms": 27135.553, "sample_time_ms": 3048.509, "learn_time_ms": 24057.536, "learn_throughput": 166.268, "synch_weights_time_ms": 23.774}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-50-31", "timestamp": 1724383231, "time_this_iter_s": 27.52680206298828, "time_total_s": 947.0205705165863, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309568d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 947.0205705165863, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 38.297435897435896, "ram_util_percent": 82.85897435897436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.1314436216203, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.546546241215298, "policy_loss": -0.008715894877930324, "vf_loss": 8.553981154810185, "vf_explained_var": 0.35173202071871074, "kl": 0.006404882317123117, "entropy": 0.5264842104974878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33548.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.231637068021865, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.469619711113985, "policy_loss": -0.009118267585814157, "vf_loss": 8.476981117611839, "vf_explained_var": 0.5211906207932366, "kl": 0.008784323233973096, "entropy": 0.9891689692224775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33548.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 550.9772942138026, "episode_reward_min": -0.949567990453343, "episode_reward_mean": 146.88553839338283, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1698.9596007835728, "predator_policy": 45.061186121313824}, "policy_reward_max": {"prey_policy": 243.53881387868586, "predator_policy": 1698.9596007835728}, "policy_reward_mean": {"prey_policy": -1031.5622415721089, "predator_policy": 1105.0050107688003}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.4163594265421184, 87.19853135712611, 418.3493141105669, 187.24733156521083, 15.69704215930278, 256.49789725409755, 246.7953927210289, 86.13966865899661, 296.635888310092, 304.21570639966933, 82.69844837894007, 17.708186018431466, 214.58194637213398, 98.72642003926387, 108.18713268152949, 117.69779654545995, 62.86055685172655, 109.76153457947618, 55.80754118909945, 85.57340733143363, 261.15040445835524, 407.64694169948774, 316.4798219010784, 64.53216597434415, 394.8289343015221, 2.2962400535463843, 73.05864454482443, 351.21616794224593, 62.539886862532114, 112.23933243990551, 193.14008909793685, 13.499999999999975, 127.92737991881441, 0.08087944381469558, 343.49096803608137, 86.4479782276202, 8.794075539641003, 184.91601147403716, 355.2470720581914, 61.45819141931183, 338.27765574332096, 94.36653655145415, 309.3182415662524, 254.57356639876042, 318.51848826047853, 85.69112028957498, 61.391160597433284, 366.35657099209146, 255.99651019667567, 55.435763495034365, 89.13678954840512, -0.1990669584872493, 0.10000000000000231, 229.61968073099735, 550.9772942138026, 200.63094430731502, 175.32189153294203, 12.54355710468941, 4.099999999999989, 120.02261005243989, -0.949567990453343, 259.6967601083857, 104.71600331872348, 10.79999999999998, 116.4778703192056, 0.41672595435132287, 208.18802158764777, 26.617567659981088, 1.7805781223393229, 0.8896813079937429, 184.05712370008519, 46.00000000000002, 308.00511696331415, 263.6679926879089, 248.7270513343284, 320.4723533757343, 0.9553095426887301, 3.158514446087425, 290.333430312121, 477.7603154011425, 48.2950174935804, 292.41334351544725, 1.000000000000003, 93.91938525113599, 75.97317690733402, 342.87457792280895, 4.0000000000000036, 323.1, 30.645286857329385, 63.50846061961306, 265.5913691680511, 28.08460826717086, 153.22467643141442, 0.3999999999999999, 7.993605777301127e-15, 103.49772565319452, 0.6000000000000105, 1.0000000000000013, 26.511529840295815, 163.17723129272198], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1262.2970894103034, -1337.751378744451, -1327.9108390511858, -927.1683599422063, -1100.9291355956495, -567.6869694194398, -1166.3493671397457, -775.1192992056295, -1364.6691816640218, -1111.6523055690195, -766.0681085331311, -921.6209660073794, -804.9988425810891, -35.435380847460365, -1260.8003828911794, -987.4265236961523, -626.8235228704581, -1024.9113640581866, -1127.3685881596211, -722.7659319221486, -1026.757372811938, -1280.4673344965688, -1230.3681183841659, -1183.0359832722054, -1019.5972175818217, -881.890420626834, -1264.9274976411307, -505.55611578107187, -627.7417053434561, -1309.987716194455, -1266.433029068143, -941.4383906581866, -1216.2758012901509, -979.1141788356142, -1419.200865520459, -1260.0691583881526, -1271.425170683749, -1210.3016411665437, -990.930406957456, -1302.015315917135, -1078.0262570002278, -806.0763063777025, -1128.222609887588, -601.891805455375, 40.0000000000003, -1325.122372242042, -1370.7902011722374, -1519.7009128452387, -189.50335674549663, -1022.2599403704758, -1446.615299431614, -1462.8347819902615, -1203.6423510080806, -1068.6025702548282, -296.2648233092684, -1273.2909031141614, -1415.7699060434854, -1239.0329243623696, -872.1270229035861, -1058.6617662853225, -127.38818223197234, -1167.4111735940457, -1482.583386385688, -1023.9940258790759, -992.1619866630843, -978.4828523703375, -1685.32383341174, -1324.8340213333606, -356.8147588430199, -1290.713329020855, -1236.668333044402, -1323.629966360264, -1500.3441066370394, -1071.966367428679, -561.7760721052405, -765.2928554668463, 19.189873518527534, -963.3111645995689, -1255.5965608359504, -1233.2993999748612, -618.1635715242585, -1113.8559128346328, -963.6708327079552, -764.8314025163736, -1320.9866273820412, -236.22448760073664, -673.5579445858676, -938.8692504913714, -1406.0215435529121, -615.6395862953443, -1109.8933537572327, -1209.6822097738384, -1135.5284078660727, -1122.9665073675176, -280.77740914098507, -387.1270278972946, -1326.8467592249121, -45.78816534656452, -1260.1820756238785, -1316.1735176561647, -1316.4926703857038, -948.5883216284103, -1508.9670582628162, -1434.5575835589239, -1508.5072385200094, -1417.0355627860738, -1157.5955126719798, -731.5751308394309, -464.45149603004427, -1312.1816290804527, -1296.7715985631248, -114.53166833000037, -630.4535285558928, -1212.7876447842336, -1454.930236459725, -1375.2070225859134, -1469.5498793598151, -1434.9093630808604, -573.6355443688446, -1321.3673340831645, -1250.7242321549732, -1396.0838437555406, 157.43528758703928, -1468.585846070838, -974.457800980885, -1627.7687295614353, -1089.1271282565203, -1303.6354807593304, -1325.8243691472085, -1096.7868662708947, -1313.8118436816155, -1577.9638524390577, -1093.8524539564949, -930.8180234572111, -1611.9861794258675, -1100.7460483660802, -1469.345295210985, -1415.9771423338443, -1331.8423347064931, -1390.064053838507, -574.6131112610434, -1327.9099571579447, -1231.7479719770834, -1163.54312691231, -1105.5473770553613, -737.7461917736106, -1264.2164835720357, -517.4112360511577, -256.9677217385108, -1477.6579343302858, -870.9913253025921, -1129.7343011591527, -1328.8976930755296, -1341.2526086242917, -1475.0517171377141, -1555.9527161352087, -641.0440628516924, -151.9718343195909, -1309.3772839489095, -373.72911918659867, -1056.424235163232, -1321.0088139929485, 28.869542338169232, -756.0157446097812, -1526.4965273522637, -1097.4859143596545, -1434.097700798681, -958.8621389221931, -532.1363908150721, -3.0176923178562367, -1187.6762153871578, -286.64439381689914, -1146.7347867179587, -1259.271625170217, -44.363244065648026, 243.53881387868586, -1546.0938834040646, -117.96194453105132, -1289.5317942078675, -395.8773442785742, -1536.2469344575468, 122.66316929957199, -1298.0071796580864, -1140.3824312971174, -637.2483294633843, -1445.1610850882396, -1478.7803132560632, -1448.36402026232, -1453.7120391968324, -1698.9596007835728, -589.144144106503, -1156.4687598099515, -1547.930995266865, -1359.2029178634102, -1435.9420914077132, -1508.5457377300388, -1529.2793363555481, -1249.345024146285, -992.7142394621732, -196.0460515821251], "policy_predator_policy_reward": [1263.1508007298653, 1340.3140268514308, 1327.9108390511858, 1014.3668912993327, 1187.7358681038197, 899.2295510218385, 1163.198887683185, 965.5171102274046, 1197.1490330414565, 1294.8694963508876, 828.0823367719877, 1116.1046350226209, 693.4969171811549, 393.7326989684231, 1276.4218451069953, 1057.944730139332, 834.2442484666155, 1114.1265267721226, 1406.288103719902, 748.0621227615361, 1255.0280774305556, 1134.895078256892, 1166.8462639734792, 1264.266023701323, 1185.2064916379127, 930.8630929428776, 1263.9800578534957, 605.2299756079741, 1046.8954785466858, 999.021075672755, 1266.292387874942, 1059.2768283968458, 1312.6405354671206, 945.610001510372, 1407.496337259733, 1381.535221228354, 1326.727488317736, 1210.8068647216571, 1080.3978042057338, 1298.1213260002908, 1039.1641856136964, 1106.0887822225907, 975.1294488352117, 1162.6319082072414, 424.4116011643404, 1177.1905929787763, 1446.7209416286235, 1508.302338363194, 707.6051207664601, 898.9871106510319, 1448.9115394851601, 1462.8347819902615, 1390.9314115048444, 954.3721543028917, 722.3090716151481, 1198.4628227505325, 1329.124298771291, 1388.2184184970974, 846.262420903561, 1196.7657007252533, 529.0512578236023, 958.8881871003523, 1482.583386385688, 1037.494025879076, 1099.968603912023, 998.6036150402126, 1685.32383341174, 1324.9149007771755, 1188.699185323564, 802.3198705763972, 1292.0255205423568, 1354.7207570899302, 1500.0559794923067, 1081.0485701130528, 1365.2239842655047, 146.7609547806167, 838.7854884874008, 460.5828746518306, 1082.1739229497941, 1468.1802292803286, 1097.9420733169704, 972.3550667852401, 674.2810227586937, 1148.5877490170883, 521.6146695102096, 1344.9146870388195, 817.0894266187416, 1049.9113348572578, 1001.059491938478, 1339.1201261702556, 1194.9071210488153, 1210.3595627718305, 1179.8380714629272, 1140.0480043680982, 552.6620269002352, 481.5989811301351, 1151.15442673837, 477.4770080297834, 1468.1087162079086, 1163.6826405671702, 1310.5977200967518, 1043.620061465767, 1508.9670582628162, 1434.3585166004366, 1508.5072385200094, 1417.1355627860737, 770.2595368828564, 1348.5307873595518, 1076.0854728047802, 1251.5249465195186, 1351.3700599710767, 260.5641512293632, 1209.6706614741508, 808.8924033989186, 1481.5555097361098, 1361.1253064142177, 1473.649879359815, 1434.9093630808604, 652.5710540064473, 1362.4544344980022, 1290.7300665002515, 1355.1284414198092, 736.2096407585044, 834.6376778336825, 1081.8847910852546, 1625.0577427757892, 1099.9271282565217, 1303.6354807593304, 1330.2327567108957, 1208.8563490264141, 1314.2285696359668, 1577.9638524390577, 1232.547032518842, 1000.3114664825116, 1612.3861794258676, 1126.9636160260625, 1470.425873333324, 1416.6771423338444, 1332.7320160144868, 1390.064053838507, 1243.3084526759128, 843.2717394431608, 1271.7479719770827, 1169.5431269123098, 893.6987135429704, 1257.599972249315, 1263.9861728341768, 781.3095394769281, 504.30073941576507, 1479.05196798736, 1125.702599887268, 1195.495379950203, 1329.2530026182183, 1341.8526086242919, 1475.2102315838015, 1558.9527161352084, 48.917171772316856, 1034.4321557110877, 1085.6383050440425, 1075.2284134926085, 1100.319252656805, 1325.408813992948, 585.5199026227924, 434.03964316426277, 1526.4965273522637, 1098.4859143596545, 1031.1008597682476, 1455.7783652037624, 557.6038746918492, 53.52338534841784, 1155.411058729001, 661.7841283978671, 1150.734786717955, 1259.271625170217, 78.86324406564772, 45.061186121313824, 1546.0938834040646, 148.6072313883808, 1290.9317942078671, 457.98580489818585, 1198.5639309115907, 480.6112034144371, 1098.238311974418, 1368.2359072479571, 790.473005894798, 1445.1610850882396, 1478.9803132560633, 1448.5640202623201, 1453.7120391968324, 1698.9596007835728, 672.141869759697, 1176.9687598099517, 1548.5309952668651, 1359.2029178634102, 1436.9420914077123, 1508.5457377300388, 1529.2793363555481, 1275.856553986581, 1171.7207073896425, 180.2168149473803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.238700527907614, "mean_inference_ms": 5.3332165736548385, "mean_action_processing_ms": 2.23127735503799, "mean_env_wait_ms": 13.322196982017871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020621061325073242, "StateBufferConnector_ms": 0.004705548286437988, "ViewRequirementAgentConnector_ms": 0.12255609035491943}, "num_episodes": 14, "episode_return_max": 550.9772942138026, "episode_return_min": -0.949567990453343, "episode_return_mean": 146.88553839338283, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.27968777183352, "num_env_steps_trained_throughput_per_sec": 151.27968777183352, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 26613.111, "restore_workers_time_ms": 0.086, "training_step_time_ms": 26612.614, "sample_time_ms": 2602.5, "learn_time_ms": 23980.579, "learn_throughput": 166.802, "synch_weights_time_ms": 23.687}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-50-58", "timestamp": 1724383258, "time_this_iter_s": 26.490134954452515, "time_total_s": 973.5107054710388, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08b8430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 973.5107054710388, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 35.68378378378378, "ram_util_percent": 83.11351351351354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.411621848363724, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.408350771949404, "policy_loss": -0.006538531158080019, "vf_loss": 8.413693509783064, "vf_explained_var": 0.38074765173846453, "kl": 0.005979099665600905, "entropy": 0.5428170779394725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34493.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.90705620927155, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.690143076074186, "policy_loss": -0.011781293965343918, "vf_loss": 8.69971657303906, "vf_explained_var": 0.5418555261596801, "kl": 0.011038962874817785, "entropy": 1.0090108016180614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34493.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 550.9772942138026, "episode_reward_min": -0.949567990453343, "episode_reward_mean": 146.37167228825584, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1698.9596007835728, "predator_policy": 45.061186121313824}, "policy_reward_max": {"prey_policy": 243.53881387868586, "predator_policy": 1698.9596007835728}, "policy_reward_mean": {"prey_policy": -1031.761062941098, "predator_policy": 1104.946899085226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [304.21570639966933, 82.69844837894007, 17.708186018431466, 214.58194637213398, 98.72642003926387, 108.18713268152949, 117.69779654545995, 62.86055685172655, 109.76153457947618, 55.80754118909945, 85.57340733143363, 261.15040445835524, 407.64694169948774, 316.4798219010784, 64.53216597434415, 394.8289343015221, 2.2962400535463843, 73.05864454482443, 351.21616794224593, 62.539886862532114, 112.23933243990551, 193.14008909793685, 13.499999999999975, 127.92737991881441, 0.08087944381469558, 343.49096803608137, 86.4479782276202, 8.794075539641003, 184.91601147403716, 355.2470720581914, 61.45819141931183, 338.27765574332096, 94.36653655145415, 309.3182415662524, 254.57356639876042, 318.51848826047853, 85.69112028957498, 61.391160597433284, 366.35657099209146, 255.99651019667567, 55.435763495034365, 89.13678954840512, -0.1990669584872493, 0.10000000000000231, 229.61968073099735, 550.9772942138026, 200.63094430731502, 175.32189153294203, 12.54355710468941, 4.099999999999989, 120.02261005243989, -0.949567990453343, 259.6967601083857, 104.71600331872348, 10.79999999999998, 116.4778703192056, 0.41672595435132287, 208.18802158764777, 26.617567659981088, 1.7805781223393229, 0.8896813079937429, 184.05712370008519, 46.00000000000002, 308.00511696331415, 263.6679926879089, 248.7270513343284, 320.4723533757343, 0.9553095426887301, 3.158514446087425, 290.333430312121, 477.7603154011425, 48.2950174935804, 292.41334351544725, 1.000000000000003, 93.91938525113599, 75.97317690733402, 342.87457792280895, 4.0000000000000036, 323.1, 30.645286857329385, 63.50846061961306, 265.5913691680511, 28.08460826717086, 153.22467643141442, 0.3999999999999999, 7.993605777301127e-15, 103.49772565319452, 0.6000000000000105, 1.0000000000000013, 26.511529840295815, 163.17723129272198, -3.552713678800501e-15, 217.47465763156302, 305.43071134199766, 10.879829651190509, 85.6, 425.70161205568087, 3.0, 325.96124679213506, 172.54275757770037], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1127.3685881596211, -722.7659319221486, -1026.757372811938, -1280.4673344965688, -1230.3681183841659, -1183.0359832722054, -1019.5972175818217, -881.890420626834, -1264.9274976411307, -505.55611578107187, -627.7417053434561, -1309.987716194455, -1266.433029068143, -941.4383906581866, -1216.2758012901509, -979.1141788356142, -1419.200865520459, -1260.0691583881526, -1271.425170683749, -1210.3016411665437, -990.930406957456, -1302.015315917135, -1078.0262570002278, -806.0763063777025, -1128.222609887588, -601.891805455375, 40.0000000000003, -1325.122372242042, -1370.7902011722374, -1519.7009128452387, -189.50335674549663, -1022.2599403704758, -1446.615299431614, -1462.8347819902615, -1203.6423510080806, -1068.6025702548282, -296.2648233092684, -1273.2909031141614, -1415.7699060434854, -1239.0329243623696, -872.1270229035861, -1058.6617662853225, -127.38818223197234, -1167.4111735940457, -1482.583386385688, -1023.9940258790759, -992.1619866630843, -978.4828523703375, -1685.32383341174, -1324.8340213333606, -356.8147588430199, -1290.713329020855, -1236.668333044402, -1323.629966360264, -1500.3441066370394, -1071.966367428679, -561.7760721052405, -765.2928554668463, 19.189873518527534, -963.3111645995689, -1255.5965608359504, -1233.2993999748612, -618.1635715242585, -1113.8559128346328, -963.6708327079552, -764.8314025163736, -1320.9866273820412, -236.22448760073664, -673.5579445858676, -938.8692504913714, -1406.0215435529121, -615.6395862953443, -1109.8933537572327, -1209.6822097738384, -1135.5284078660727, -1122.9665073675176, -280.77740914098507, -387.1270278972946, -1326.8467592249121, -45.78816534656452, -1260.1820756238785, -1316.1735176561647, -1316.4926703857038, -948.5883216284103, -1508.9670582628162, -1434.5575835589239, -1508.5072385200094, -1417.0355627860738, -1157.5955126719798, -731.5751308394309, -464.45149603004427, -1312.1816290804527, -1296.7715985631248, -114.53166833000037, -630.4535285558928, -1212.7876447842336, -1454.930236459725, -1375.2070225859134, -1469.5498793598151, -1434.9093630808604, -573.6355443688446, -1321.3673340831645, -1250.7242321549732, -1396.0838437555406, 157.43528758703928, -1468.585846070838, -974.457800980885, -1627.7687295614353, -1089.1271282565203, -1303.6354807593304, -1325.8243691472085, -1096.7868662708947, -1313.8118436816155, -1577.9638524390577, -1093.8524539564949, -930.8180234572111, -1611.9861794258675, -1100.7460483660802, -1469.345295210985, -1415.9771423338443, -1331.8423347064931, -1390.064053838507, -574.6131112610434, -1327.9099571579447, -1231.7479719770834, -1163.54312691231, -1105.5473770553613, -737.7461917736106, -1264.2164835720357, -517.4112360511577, -256.9677217385108, -1477.6579343302858, -870.9913253025921, -1129.7343011591527, -1328.8976930755296, -1341.2526086242917, -1475.0517171377141, -1555.9527161352087, -641.0440628516924, -151.9718343195909, -1309.3772839489095, -373.72911918659867, -1056.424235163232, -1321.0088139929485, 28.869542338169232, -756.0157446097812, -1526.4965273522637, -1097.4859143596545, -1434.097700798681, -958.8621389221931, -532.1363908150721, -3.0176923178562367, -1187.6762153871578, -286.64439381689914, -1146.7347867179587, -1259.271625170217, -44.363244065648026, 243.53881387868586, -1546.0938834040646, -117.96194453105132, -1289.5317942078675, -395.8773442785742, -1536.2469344575468, 122.66316929957199, -1298.0071796580864, -1140.3824312971174, -637.2483294633843, -1445.1610850882396, -1478.7803132560632, -1448.36402026232, -1453.7120391968324, -1698.9596007835728, -589.144144106503, -1156.4687598099515, -1547.930995266865, -1359.2029178634102, -1435.9420914077132, -1508.5457377300388, -1529.2793363555481, -1249.345024146285, -992.7142394621732, -196.0460515821251, -1291.5157465367781, -1429.3624069745872, -429.5229354564622, -846.4537067129413, -896.9633916361652, -1254.4574233345822, -1164.0264190675985, -1277.2798892445155, -1050.7841789919048, -1378.0531592799925, -343.11632343177854, -970.3568998587465, -1305.679599788633, -1457.0480201231103, 127.04434145722358, -1342.8771254501987, -1120.0301192411796, 21.09971264741568], "policy_predator_policy_reward": [1406.288103719902, 748.0621227615361, 1255.0280774305556, 1134.895078256892, 1166.8462639734792, 1264.266023701323, 1185.2064916379127, 930.8630929428776, 1263.9800578534957, 605.2299756079741, 1046.8954785466858, 999.021075672755, 1266.292387874942, 1059.2768283968458, 1312.6405354671206, 945.610001510372, 1407.496337259733, 1381.535221228354, 1326.727488317736, 1210.8068647216571, 1080.3978042057338, 1298.1213260002908, 1039.1641856136964, 1106.0887822225907, 975.1294488352117, 1162.6319082072414, 424.4116011643404, 1177.1905929787763, 1446.7209416286235, 1508.302338363194, 707.6051207664601, 898.9871106510319, 1448.9115394851601, 1462.8347819902615, 1390.9314115048444, 954.3721543028917, 722.3090716151481, 1198.4628227505325, 1329.124298771291, 1388.2184184970974, 846.262420903561, 1196.7657007252533, 529.0512578236023, 958.8881871003523, 1482.583386385688, 1037.494025879076, 1099.968603912023, 998.6036150402126, 1685.32383341174, 1324.9149007771755, 1188.699185323564, 802.3198705763972, 1292.0255205423568, 1354.7207570899302, 1500.0559794923067, 1081.0485701130528, 1365.2239842655047, 146.7609547806167, 838.7854884874008, 460.5828746518306, 1082.1739229497941, 1468.1802292803286, 1097.9420733169704, 972.3550667852401, 674.2810227586937, 1148.5877490170883, 521.6146695102096, 1344.9146870388195, 817.0894266187416, 1049.9113348572578, 1001.059491938478, 1339.1201261702556, 1194.9071210488153, 1210.3595627718305, 1179.8380714629272, 1140.0480043680982, 552.6620269002352, 481.5989811301351, 1151.15442673837, 477.4770080297834, 1468.1087162079086, 1163.6826405671702, 1310.5977200967518, 1043.620061465767, 1508.9670582628162, 1434.3585166004366, 1508.5072385200094, 1417.1355627860737, 770.2595368828564, 1348.5307873595518, 1076.0854728047802, 1251.5249465195186, 1351.3700599710767, 260.5641512293632, 1209.6706614741508, 808.8924033989186, 1481.5555097361098, 1361.1253064142177, 1473.649879359815, 1434.9093630808604, 652.5710540064473, 1362.4544344980022, 1290.7300665002515, 1355.1284414198092, 736.2096407585044, 834.6376778336825, 1081.8847910852546, 1625.0577427757892, 1099.9271282565217, 1303.6354807593304, 1330.2327567108957, 1208.8563490264141, 1314.2285696359668, 1577.9638524390577, 1232.547032518842, 1000.3114664825116, 1612.3861794258676, 1126.9636160260625, 1470.425873333324, 1416.6771423338444, 1332.7320160144868, 1390.064053838507, 1243.3084526759128, 843.2717394431608, 1271.7479719770827, 1169.5431269123098, 893.6987135429704, 1257.599972249315, 1263.9861728341768, 781.3095394769281, 504.30073941576507, 1479.05196798736, 1125.702599887268, 1195.495379950203, 1329.2530026182183, 1341.8526086242919, 1475.2102315838015, 1558.9527161352084, 48.917171772316856, 1034.4321557110877, 1085.6383050440425, 1075.2284134926085, 1100.319252656805, 1325.408813992948, 585.5199026227924, 434.03964316426277, 1526.4965273522637, 1098.4859143596545, 1031.1008597682476, 1455.7783652037624, 557.6038746918492, 53.52338534841784, 1155.411058729001, 661.7841283978671, 1150.734786717955, 1259.271625170217, 78.86324406564772, 45.061186121313824, 1546.0938834040646, 148.6072313883808, 1290.9317942078671, 457.98580489818585, 1198.5639309115907, 480.6112034144371, 1098.238311974418, 1368.2359072479571, 790.473005894798, 1445.1610850882396, 1478.9803132560633, 1448.5640202623201, 1453.7120391968324, 1698.9596007835728, 672.141869759697, 1176.9687598099517, 1548.5309952668651, 1359.2029178634102, 1436.9420914077123, 1508.5457377300388, 1529.2793363555481, 1275.856553986581, 1171.7207073896425, 180.2168149473803, 1291.5157465367781, 1429.3624069745872, 131.86563078890487, 1361.5856690120593, 1210.562990221898, 1246.288536090851, 1248.7836573041254, 1203.4024806591794, 1136.3841789919045, 1378.0531592799925, 1087.7339369606848, 651.4408983855274, 1308.679599788633, 1457.0480201231103, 371.8603006484873, 1169.9337301366215, 585.7570573733478, 685.7161067981182]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.218738407673893, "mean_inference_ms": 5.291971025868718, "mean_action_processing_ms": 2.225354102596145, "mean_env_wait_ms": 13.296141509199401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020993351936340332, "StateBufferConnector_ms": 0.004703044891357422, "ViewRequirementAgentConnector_ms": 0.1272730827331543}, "num_episodes": 9, "episode_return_max": 550.9772942138026, "episode_return_min": -0.949567990453343, "episode_return_mean": 146.37167228825584, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.73917285568007, "num_env_steps_trained_throughput_per_sec": 147.73917285568007, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 26660.307, "restore_workers_time_ms": 0.086, "training_step_time_ms": 26659.822, "sample_time_ms": 2645.62, "learn_time_ms": 23985.646, "learn_throughput": 166.766, "synch_weights_time_ms": 23.006}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-51-25", "timestamp": 1724383285, "time_this_iter_s": 27.116509914398193, "time_total_s": 1000.627215385437, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309628550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1000.627215385437, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 37.32051282051282, "ram_util_percent": 82.93333333333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.374843085379828, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.553918409599829, "policy_loss": -0.008224292806344766, "vf_loss": 8.560966573442732, "vf_explained_var": 0.36283639574807786, "kl": 0.00588067799040348, "entropy": 0.5129594092331236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 35438.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.199053879641983, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.473298083915912, "policy_loss": -0.011269527981205592, "vf_loss": 8.482596859603962, "vf_explained_var": 0.5652572628051515, "kl": 0.009853664141828342, "entropy": 0.9512614880289351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 35438.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 550.9772942138026, "episode_reward_min": -2.256205768412604, "episode_reward_mean": 134.4049770195967, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1698.9596007835728, "predator_policy": 45.061186121313824}, "policy_reward_max": {"prey_policy": 243.53881387868586, "predator_policy": 1698.9596007835728}, "policy_reward_mean": {"prey_policy": -1058.4014671666307, "predator_policy": 1125.603955676429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.53216597434415, 394.8289343015221, 2.2962400535463843, 73.05864454482443, 351.21616794224593, 62.539886862532114, 112.23933243990551, 193.14008909793685, 13.499999999999975, 127.92737991881441, 0.08087944381469558, 343.49096803608137, 86.4479782276202, 8.794075539641003, 184.91601147403716, 355.2470720581914, 61.45819141931183, 338.27765574332096, 94.36653655145415, 309.3182415662524, 254.57356639876042, 318.51848826047853, 85.69112028957498, 61.391160597433284, 366.35657099209146, 255.99651019667567, 55.435763495034365, 89.13678954840512, -0.1990669584872493, 0.10000000000000231, 229.61968073099735, 550.9772942138026, 200.63094430731502, 175.32189153294203, 12.54355710468941, 4.099999999999989, 120.02261005243989, -0.949567990453343, 259.6967601083857, 104.71600331872348, 10.79999999999998, 116.4778703192056, 0.41672595435132287, 208.18802158764777, 26.617567659981088, 1.7805781223393229, 0.8896813079937429, 184.05712370008519, 46.00000000000002, 308.00511696331415, 263.6679926879089, 248.7270513343284, 320.4723533757343, 0.9553095426887301, 3.158514446087425, 290.333430312121, 477.7603154011425, 48.2950174935804, 292.41334351544725, 1.000000000000003, 93.91938525113599, 75.97317690733402, 342.87457792280895, 4.0000000000000036, 323.1, 30.645286857329385, 63.50846061961306, 265.5913691680511, 28.08460826717086, 153.22467643141442, 0.3999999999999999, 7.993605777301127e-15, 103.49772565319452, 0.6000000000000105, 1.0000000000000013, 26.511529840295815, 163.17723129272198, -3.552713678800501e-15, 217.47465763156302, 305.43071134199766, 10.879829651190509, 85.6, 425.70161205568087, 3.0, 325.96124679213506, 172.54275757770037, -2.1316282072803006e-14, -1.3766765505351941e-14, 257.2348653386387, 5.820737203649752, 486.9926121559581, 4.624467247336856, 0.09999999999999254, -2.256205768412604, 30.800000000000097, 224.61454732763417, 0.19999999999999574, 34.59529407536522, 3.7000000000000157, 7.993605777301127e-15], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1370.7902011722374, -1519.7009128452387, -189.50335674549663, -1022.2599403704758, -1446.615299431614, -1462.8347819902615, -1203.6423510080806, -1068.6025702548282, -296.2648233092684, -1273.2909031141614, -1415.7699060434854, -1239.0329243623696, -872.1270229035861, -1058.6617662853225, -127.38818223197234, -1167.4111735940457, -1482.583386385688, -1023.9940258790759, -992.1619866630843, -978.4828523703375, -1685.32383341174, -1324.8340213333606, -356.8147588430199, -1290.713329020855, -1236.668333044402, -1323.629966360264, -1500.3441066370394, -1071.966367428679, -561.7760721052405, -765.2928554668463, 19.189873518527534, -963.3111645995689, -1255.5965608359504, -1233.2993999748612, -618.1635715242585, -1113.8559128346328, -963.6708327079552, -764.8314025163736, -1320.9866273820412, -236.22448760073664, -673.5579445858676, -938.8692504913714, -1406.0215435529121, -615.6395862953443, -1109.8933537572327, -1209.6822097738384, -1135.5284078660727, -1122.9665073675176, -280.77740914098507, -387.1270278972946, -1326.8467592249121, -45.78816534656452, -1260.1820756238785, -1316.1735176561647, -1316.4926703857038, -948.5883216284103, -1508.9670582628162, -1434.5575835589239, -1508.5072385200094, -1417.0355627860738, -1157.5955126719798, -731.5751308394309, -464.45149603004427, -1312.1816290804527, -1296.7715985631248, -114.53166833000037, -630.4535285558928, -1212.7876447842336, -1454.930236459725, -1375.2070225859134, -1469.5498793598151, -1434.9093630808604, -573.6355443688446, -1321.3673340831645, -1250.7242321549732, -1396.0838437555406, 157.43528758703928, -1468.585846070838, -974.457800980885, -1627.7687295614353, -1089.1271282565203, -1303.6354807593304, -1325.8243691472085, -1096.7868662708947, -1313.8118436816155, -1577.9638524390577, -1093.8524539564949, -930.8180234572111, -1611.9861794258675, -1100.7460483660802, -1469.345295210985, -1415.9771423338443, -1331.8423347064931, -1390.064053838507, -574.6131112610434, -1327.9099571579447, -1231.7479719770834, -1163.54312691231, -1105.5473770553613, -737.7461917736106, -1264.2164835720357, -517.4112360511577, -256.9677217385108, -1477.6579343302858, -870.9913253025921, -1129.7343011591527, -1328.8976930755296, -1341.2526086242917, -1475.0517171377141, -1555.9527161352087, -641.0440628516924, -151.9718343195909, -1309.3772839489095, -373.72911918659867, -1056.424235163232, -1321.0088139929485, 28.869542338169232, -756.0157446097812, -1526.4965273522637, -1097.4859143596545, -1434.097700798681, -958.8621389221931, -532.1363908150721, -3.0176923178562367, -1187.6762153871578, -286.64439381689914, -1146.7347867179587, -1259.271625170217, -44.363244065648026, 243.53881387868586, -1546.0938834040646, -117.96194453105132, -1289.5317942078675, -395.8773442785742, -1536.2469344575468, 122.66316929957199, -1298.0071796580864, -1140.3824312971174, -637.2483294633843, -1445.1610850882396, -1478.7803132560632, -1448.36402026232, -1453.7120391968324, -1698.9596007835728, -589.144144106503, -1156.4687598099515, -1547.930995266865, -1359.2029178634102, -1435.9420914077132, -1508.5457377300388, -1529.2793363555481, -1249.345024146285, -992.7142394621732, -196.0460515821251, -1291.5157465367781, -1429.3624069745872, -429.5229354564622, -846.4537067129413, -896.9633916361652, -1254.4574233345822, -1164.0264190675985, -1277.2798892445155, -1050.7841789919048, -1378.0531592799925, -343.11632343177854, -970.3568998587465, -1305.679599788633, -1457.0480201231103, 127.04434145722358, -1342.8771254501987, -1120.0301192411796, 21.09971264741568, -1495.2509469767551, -1608.7524043047104, -1416.20788055115, -1480.9010648773617, -458.2082398050539, -1224.0796538252412, -1158.2075096780889, -1455.553605430317, -334.2186571996185, -1179.2118576294133, -1390.1322789321446, -1003.2810225308731, -1366.3360175319056, -1421.9731050345717, -1493.1730788167574, -1419.223834392142, -859.7544532519032, -1164.2079155765605, -311.67209397729715, -1100.4192568887545, -1370.4435208222633, -1269.6358716988007, -1407.4090114371322, -1088.719830130882, -1254.6234422604705, -1528.7638683626028, -1667.8810191890827, -1336.8467156586082], "policy_predator_policy_reward": [1446.7209416286235, 1508.302338363194, 707.6051207664601, 898.9871106510319, 1448.9115394851601, 1462.8347819902615, 1390.9314115048444, 954.3721543028917, 722.3090716151481, 1198.4628227505325, 1329.124298771291, 1388.2184184970974, 846.262420903561, 1196.7657007252533, 529.0512578236023, 958.8881871003523, 1482.583386385688, 1037.494025879076, 1099.968603912023, 998.6036150402126, 1685.32383341174, 1324.9149007771755, 1188.699185323564, 802.3198705763972, 1292.0255205423568, 1354.7207570899302, 1500.0559794923067, 1081.0485701130528, 1365.2239842655047, 146.7609547806167, 838.7854884874008, 460.5828746518306, 1082.1739229497941, 1468.1802292803286, 1097.9420733169704, 972.3550667852401, 674.2810227586937, 1148.5877490170883, 521.6146695102096, 1344.9146870388195, 817.0894266187416, 1049.9113348572578, 1001.059491938478, 1339.1201261702556, 1194.9071210488153, 1210.3595627718305, 1179.8380714629272, 1140.0480043680982, 552.6620269002352, 481.5989811301351, 1151.15442673837, 477.4770080297834, 1468.1087162079086, 1163.6826405671702, 1310.5977200967518, 1043.620061465767, 1508.9670582628162, 1434.3585166004366, 1508.5072385200094, 1417.1355627860737, 770.2595368828564, 1348.5307873595518, 1076.0854728047802, 1251.5249465195186, 1351.3700599710767, 260.5641512293632, 1209.6706614741508, 808.8924033989186, 1481.5555097361098, 1361.1253064142177, 1473.649879359815, 1434.9093630808604, 652.5710540064473, 1362.4544344980022, 1290.7300665002515, 1355.1284414198092, 736.2096407585044, 834.6376778336825, 1081.8847910852546, 1625.0577427757892, 1099.9271282565217, 1303.6354807593304, 1330.2327567108957, 1208.8563490264141, 1314.2285696359668, 1577.9638524390577, 1232.547032518842, 1000.3114664825116, 1612.3861794258676, 1126.9636160260625, 1470.425873333324, 1416.6771423338444, 1332.7320160144868, 1390.064053838507, 1243.3084526759128, 843.2717394431608, 1271.7479719770827, 1169.5431269123098, 893.6987135429704, 1257.599972249315, 1263.9861728341768, 781.3095394769281, 504.30073941576507, 1479.05196798736, 1125.702599887268, 1195.495379950203, 1329.2530026182183, 1341.8526086242919, 1475.2102315838015, 1558.9527161352084, 48.917171772316856, 1034.4321557110877, 1085.6383050440425, 1075.2284134926085, 1100.319252656805, 1325.408813992948, 585.5199026227924, 434.03964316426277, 1526.4965273522637, 1098.4859143596545, 1031.1008597682476, 1455.7783652037624, 557.6038746918492, 53.52338534841784, 1155.411058729001, 661.7841283978671, 1150.734786717955, 1259.271625170217, 78.86324406564772, 45.061186121313824, 1546.0938834040646, 148.6072313883808, 1290.9317942078671, 457.98580489818585, 1198.5639309115907, 480.6112034144371, 1098.238311974418, 1368.2359072479571, 790.473005894798, 1445.1610850882396, 1478.9803132560633, 1448.5640202623201, 1453.7120391968324, 1698.9596007835728, 672.141869759697, 1176.9687598099517, 1548.5309952668651, 1359.2029178634102, 1436.9420914077123, 1508.5457377300388, 1529.2793363555481, 1275.856553986581, 1171.7207073896425, 180.2168149473803, 1291.5157465367781, 1429.3624069745872, 131.86563078890487, 1361.5856690120593, 1210.562990221898, 1246.288536090851, 1248.7836573041254, 1203.4024806591794, 1136.3841789919045, 1378.0531592799925, 1087.7339369606848, 651.4408983855274, 1308.679599788633, 1457.0480201231103, 371.8603006484873, 1169.9337301366215, 585.7570573733478, 685.7161067981182, 1495.2509469767551, 1608.7524043047104, 1416.20788055115, 1480.9010648773617, 564.0215218440984, 1375.5012371248376, 1447.7031634771788, 1171.8786888348766, 852.3784813478844, 1148.0446456371076, 1384.9450294023682, 1013.0927393079862, 1366.3360175319056, 1422.0731050345717, 1490.9168730483448, 1419.223834392142, 866.4544532519049, 1188.3079155765602, 629.421403104063, 1007.2844950896218, 1370.6435208222633, 1269.6358716988007, 1408.0666020871777, 1122.6575335562013, 1258.3234422604671, 1528.7638683626028, 1667.8810191890827, 1336.8467156586082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.170796001879478, "mean_inference_ms": 5.27296567253496, "mean_action_processing_ms": 2.2411125856802356, "mean_env_wait_ms": 13.26354821206416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004590511322021484, "StateBufferConnector_ms": 0.004310488700866699, "ViewRequirementAgentConnector_ms": 0.12363600730895996}, "num_episodes": 14, "episode_return_max": 550.9772942138026, "episode_return_min": -2.256205768412604, "episode_return_mean": 134.4049770195967, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.05591735652945, "num_env_steps_trained_throughput_per_sec": 152.05591735652945, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 26660.538, "restore_workers_time_ms": 0.09, "training_step_time_ms": 26660.072, "sample_time_ms": 2629.051, "learn_time_ms": 24004.039, "learn_throughput": 166.639, "synch_weights_time_ms": 21.927}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-51-51", "timestamp": 1724383311, "time_this_iter_s": 26.34583592414856, "time_total_s": 1026.9730513095856, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309568ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1026.9730513095856, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 43.72972972972973, "ram_util_percent": 82.7891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.689068717805167, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.260032077062698, "policy_loss": -0.0072721049827696, "vf_loss": 8.266222417417657, "vf_explained_var": 0.4248848831842816, "kl": 0.00540886102712383, "entropy": 0.5030543602963604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36383.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.730470557313748, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.17903584222945, "policy_loss": -0.011331794061328447, "vf_loss": 8.188548168808063, "vf_explained_var": 0.6045683700571616, "kl": 0.009097284556085628, "entropy": 0.9396599232835113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36383.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 648.2112419773517, "episode_reward_min": -2.256205768412604, "episode_reward_mean": 159.9724685452705, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1698.9596007835728, "predator_policy": 16.413099057250196}, "policy_reward_max": {"prey_policy": 366.36359023963445, "predator_policy": 1698.9596007835728}, "policy_reward_mean": {"prey_policy": -996.099791650832, "predator_policy": 1076.0860259234673}, "custom_metrics": {}, "hist_stats": {"episode_reward": [184.91601147403716, 355.2470720581914, 61.45819141931183, 338.27765574332096, 94.36653655145415, 309.3182415662524, 254.57356639876042, 318.51848826047853, 85.69112028957498, 61.391160597433284, 366.35657099209146, 255.99651019667567, 55.435763495034365, 89.13678954840512, -0.1990669584872493, 0.10000000000000231, 229.61968073099735, 550.9772942138026, 200.63094430731502, 175.32189153294203, 12.54355710468941, 4.099999999999989, 120.02261005243989, -0.949567990453343, 259.6967601083857, 104.71600331872348, 10.79999999999998, 116.4778703192056, 0.41672595435132287, 208.18802158764777, 26.617567659981088, 1.7805781223393229, 0.8896813079937429, 184.05712370008519, 46.00000000000002, 308.00511696331415, 263.6679926879089, 248.7270513343284, 320.4723533757343, 0.9553095426887301, 3.158514446087425, 290.333430312121, 477.7603154011425, 48.2950174935804, 292.41334351544725, 1.000000000000003, 93.91938525113599, 75.97317690733402, 342.87457792280895, 4.0000000000000036, 323.1, 30.645286857329385, 63.50846061961306, 265.5913691680511, 28.08460826717086, 153.22467643141442, 0.3999999999999999, 7.993605777301127e-15, 103.49772565319452, 0.6000000000000105, 1.0000000000000013, 26.511529840295815, 163.17723129272198, -3.552713678800501e-15, 217.47465763156302, 305.43071134199766, 10.879829651190509, 85.6, 425.70161205568087, 3.0, 325.96124679213506, 172.54275757770037, -2.1316282072803006e-14, -1.3766765505351941e-14, 257.2348653386387, 5.820737203649752, 486.9926121559581, 4.624467247336856, 0.09999999999999254, -2.256205768412604, 30.800000000000097, 224.61454732763417, 0.19999999999999574, 34.59529407536522, 3.7000000000000157, 7.993605777301127e-15, 18.054457610799133, 273.45157403402175, 532.830939209526, 648.2112419773517, 396.01820839406906, 475.1555150410667, 209.9085218459084, 170.12647302405452, 328.27397368807976, 373.44409050034784, 401.02793109017597, 143.63598425025373, 122.99618744879264, 297.7067968357615], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-561.7760721052405, -765.2928554668463, 19.189873518527534, -963.3111645995689, -1255.5965608359504, -1233.2993999748612, -618.1635715242585, -1113.8559128346328, -963.6708327079552, -764.8314025163736, -1320.9866273820412, -236.22448760073664, -673.5579445858676, -938.8692504913714, -1406.0215435529121, -615.6395862953443, -1109.8933537572327, -1209.6822097738384, -1135.5284078660727, -1122.9665073675176, -280.77740914098507, -387.1270278972946, -1326.8467592249121, -45.78816534656452, -1260.1820756238785, -1316.1735176561647, -1316.4926703857038, -948.5883216284103, -1508.9670582628162, -1434.5575835589239, -1508.5072385200094, -1417.0355627860738, -1157.5955126719798, -731.5751308394309, -464.45149603004427, -1312.1816290804527, -1296.7715985631248, -114.53166833000037, -630.4535285558928, -1212.7876447842336, -1454.930236459725, -1375.2070225859134, -1469.5498793598151, -1434.9093630808604, -573.6355443688446, -1321.3673340831645, -1250.7242321549732, -1396.0838437555406, 157.43528758703928, -1468.585846070838, -974.457800980885, -1627.7687295614353, -1089.1271282565203, -1303.6354807593304, -1325.8243691472085, -1096.7868662708947, -1313.8118436816155, -1577.9638524390577, -1093.8524539564949, -930.8180234572111, -1611.9861794258675, -1100.7460483660802, -1469.345295210985, -1415.9771423338443, -1331.8423347064931, -1390.064053838507, -574.6131112610434, -1327.9099571579447, -1231.7479719770834, -1163.54312691231, -1105.5473770553613, -737.7461917736106, -1264.2164835720357, -517.4112360511577, -256.9677217385108, -1477.6579343302858, -870.9913253025921, -1129.7343011591527, -1328.8976930755296, -1341.2526086242917, -1475.0517171377141, -1555.9527161352087, -641.0440628516924, -151.9718343195909, -1309.3772839489095, -373.72911918659867, -1056.424235163232, -1321.0088139929485, 28.869542338169232, -756.0157446097812, -1526.4965273522637, -1097.4859143596545, -1434.097700798681, -958.8621389221931, -532.1363908150721, -3.0176923178562367, -1187.6762153871578, -286.64439381689914, -1146.7347867179587, -1259.271625170217, -44.363244065648026, 243.53881387868586, -1546.0938834040646, -117.96194453105132, -1289.5317942078675, -395.8773442785742, -1536.2469344575468, 122.66316929957199, -1298.0071796580864, -1140.3824312971174, -637.2483294633843, -1445.1610850882396, -1478.7803132560632, -1448.36402026232, -1453.7120391968324, -1698.9596007835728, -589.144144106503, -1156.4687598099515, -1547.930995266865, -1359.2029178634102, -1435.9420914077132, -1508.5457377300388, -1529.2793363555481, -1249.345024146285, -992.7142394621732, -196.0460515821251, -1291.5157465367781, -1429.3624069745872, -429.5229354564622, -846.4537067129413, -896.9633916361652, -1254.4574233345822, -1164.0264190675985, -1277.2798892445155, -1050.7841789919048, -1378.0531592799925, -343.11632343177854, -970.3568998587465, -1305.679599788633, -1457.0480201231103, 127.04434145722358, -1342.8771254501987, -1120.0301192411796, 21.09971264741568, -1495.2509469767551, -1608.7524043047104, -1416.20788055115, -1480.9010648773617, -458.2082398050539, -1224.0796538252412, -1158.2075096780889, -1455.553605430317, -334.2186571996185, -1179.2118576294133, -1390.1322789321446, -1003.2810225308731, -1366.3360175319056, -1421.9731050345717, -1493.1730788167574, -1419.223834392142, -859.7544532519032, -1164.2079155765605, -311.67209397729715, -1100.4192568887545, -1370.4435208222633, -1269.6358716988007, -1407.4090114371322, -1088.719830130882, -1254.6234422604705, -1528.7638683626028, -1667.8810191890827, -1336.8467156586082, -1577.3907749374314, -919.2281424757132, -478.7605196745093, 51.372394986499984, -187.3169886711003, -620.7604449325954, 142.8355638451451, -926.6776153311346, 77.31852753954965, -1300.006921296928, -333.51242524393825, -1408.8654715639998, -983.0540883340392, -176.18812636022108, -1498.8299324291575, -899.7159732172847, -643.0047868056027, -667.166980153406, -1543.2481808926595, 366.36359023963445, -814.803909242139, 26.11867013038298, -249.3531464151652, -1516.0720594255486, -27.109588377270683, -1298.882762278051, -1415.3162824433264, 280.17839387974425], "policy_predator_policy_reward": [1365.2239842655047, 146.7609547806167, 838.7854884874008, 460.5828746518306, 1082.1739229497941, 1468.1802292803286, 1097.9420733169704, 972.3550667852401, 674.2810227586937, 1148.5877490170883, 521.6146695102096, 1344.9146870388195, 817.0894266187416, 1049.9113348572578, 1001.059491938478, 1339.1201261702556, 1194.9071210488153, 1210.3595627718305, 1179.8380714629272, 1140.0480043680982, 552.6620269002352, 481.5989811301351, 1151.15442673837, 477.4770080297834, 1468.1087162079086, 1163.6826405671702, 1310.5977200967518, 1043.620061465767, 1508.9670582628162, 1434.3585166004366, 1508.5072385200094, 1417.1355627860737, 770.2595368828564, 1348.5307873595518, 1076.0854728047802, 1251.5249465195186, 1351.3700599710767, 260.5641512293632, 1209.6706614741508, 808.8924033989186, 1481.5555097361098, 1361.1253064142177, 1473.649879359815, 1434.9093630808604, 652.5710540064473, 1362.4544344980022, 1290.7300665002515, 1355.1284414198092, 736.2096407585044, 834.6376778336825, 1081.8847910852546, 1625.0577427757892, 1099.9271282565217, 1303.6354807593304, 1330.2327567108957, 1208.8563490264141, 1314.2285696359668, 1577.9638524390577, 1232.547032518842, 1000.3114664825116, 1612.3861794258676, 1126.9636160260625, 1470.425873333324, 1416.6771423338444, 1332.7320160144868, 1390.064053838507, 1243.3084526759128, 843.2717394431608, 1271.7479719770827, 1169.5431269123098, 893.6987135429704, 1257.599972249315, 1263.9861728341768, 781.3095394769281, 504.30073941576507, 1479.05196798736, 1125.702599887268, 1195.495379950203, 1329.2530026182183, 1341.8526086242919, 1475.2102315838015, 1558.9527161352084, 48.917171772316856, 1034.4321557110877, 1085.6383050440425, 1075.2284134926085, 1100.319252656805, 1325.408813992948, 585.5199026227924, 434.03964316426277, 1526.4965273522637, 1098.4859143596545, 1031.1008597682476, 1455.7783652037624, 557.6038746918492, 53.52338534841784, 1155.411058729001, 661.7841283978671, 1150.734786717955, 1259.271625170217, 78.86324406564772, 45.061186121313824, 1546.0938834040646, 148.6072313883808, 1290.9317942078671, 457.98580489818585, 1198.5639309115907, 480.6112034144371, 1098.238311974418, 1368.2359072479571, 790.473005894798, 1445.1610850882396, 1478.9803132560633, 1448.5640202623201, 1453.7120391968324, 1698.9596007835728, 672.141869759697, 1176.9687598099517, 1548.5309952668651, 1359.2029178634102, 1436.9420914077123, 1508.5457377300388, 1529.2793363555481, 1275.856553986581, 1171.7207073896425, 180.2168149473803, 1291.5157465367781, 1429.3624069745872, 131.86563078890487, 1361.5856690120593, 1210.562990221898, 1246.288536090851, 1248.7836573041254, 1203.4024806591794, 1136.3841789919045, 1378.0531592799925, 1087.7339369606848, 651.4408983855274, 1308.679599788633, 1457.0480201231103, 371.8603006484873, 1169.9337301366215, 585.7570573733478, 685.7161067981182, 1495.2509469767551, 1608.7524043047104, 1416.20788055115, 1480.9010648773617, 564.0215218440984, 1375.5012371248376, 1447.7031634771788, 1171.8786888348766, 852.3784813478844, 1148.0446456371076, 1384.9450294023682, 1013.0927393079862, 1366.3360175319056, 1422.0731050345717, 1490.9168730483448, 1419.223834392142, 866.4544532519049, 1188.3079155765602, 629.421403104063, 1007.2844950896218, 1370.6435208222633, 1269.6358716988007, 1408.0666020871777, 1122.6575335562013, 1258.3234422604671, 1528.7638683626028, 1667.8810191890827, 1336.8467156586082, 1577.3907749374314, 937.2826000865128, 681.421157686706, 19.418541035327642, 693.0981179084866, 647.8102549047346, 904.587700239234, 527.4655932241076, 410.33202184947663, 1208.3745803019688, 1202.8199390308973, 1014.7134728181065, 1047.0024995755234, 322.14823696464646, 1461.0829744710743, 1107.589404199421, 1136.8178914596954, 501.6278491873949, 19.525064403256998, 1530.803616750116, 752.9565664114922, 436.75660379043893, 391.989130665422, 1517.0720594255488, 149.00577582606354, 1299.982762278051, 1416.4315863420934, 16.413099057250196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.1376491601040435, "mean_inference_ms": 5.287188427063305, "mean_action_processing_ms": 2.212862649627952, "mean_env_wait_ms": 13.273926735559371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006047606468200684, "StateBufferConnector_ms": 0.004070401191711426, "ViewRequirementAgentConnector_ms": 0.1193685531616211}, "num_episodes": 14, "episode_return_max": 648.2112419773517, "episode_return_min": -2.256205768412604, "episode_return_mean": 159.9724685452705, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.00418793926423, "num_env_steps_trained_throughput_per_sec": 150.00418793926423, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 26640.882, "restore_workers_time_ms": 0.061, "training_step_time_ms": 26640.462, "sample_time_ms": 2633.879, "learn_time_ms": 23978.527, "learn_throughput": 166.816, "synch_weights_time_ms": 23.516}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-52-18", "timestamp": 1724383338, "time_this_iter_s": 26.723670959472656, "time_total_s": 1053.6967222690582, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b084ca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1053.6967222690582, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 43.55263157894738, "ram_util_percent": 83.26315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.402142126598054, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.922687377122344, "policy_loss": -0.008472081120544797, "vf_loss": 7.929852389280128, "vf_explained_var": 0.45570583766099637, "kl": 0.006535260192187572, "entropy": 0.5471986319968309, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 37328.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.638937432677658, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.058575422297078, "policy_loss": -0.010016618179226363, "vf_loss": 8.066820368691097, "vf_explained_var": 0.6140280839627382, "kl": 0.008858273905164823, "entropy": 0.8931101820456288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 37328.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 648.2112419773517, "episode_reward_min": -2.256205768412604, "episode_reward_mean": 165.5974681903286, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1698.9596007835728, "predator_policy": 16.413099057250196}, "policy_reward_max": {"prey_policy": 366.36359023963445, "predator_policy": 1698.9596007835728}, "policy_reward_mean": {"prey_policy": -977.4773710857716, "predator_policy": 1060.276105180936}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.35657099209146, 255.99651019667567, 55.435763495034365, 89.13678954840512, -0.1990669584872493, 0.10000000000000231, 229.61968073099735, 550.9772942138026, 200.63094430731502, 175.32189153294203, 12.54355710468941, 4.099999999999989, 120.02261005243989, -0.949567990453343, 259.6967601083857, 104.71600331872348, 10.79999999999998, 116.4778703192056, 0.41672595435132287, 208.18802158764777, 26.617567659981088, 1.7805781223393229, 0.8896813079937429, 184.05712370008519, 46.00000000000002, 308.00511696331415, 263.6679926879089, 248.7270513343284, 320.4723533757343, 0.9553095426887301, 3.158514446087425, 290.333430312121, 477.7603154011425, 48.2950174935804, 292.41334351544725, 1.000000000000003, 93.91938525113599, 75.97317690733402, 342.87457792280895, 4.0000000000000036, 323.1, 30.645286857329385, 63.50846061961306, 265.5913691680511, 28.08460826717086, 153.22467643141442, 0.3999999999999999, 7.993605777301127e-15, 103.49772565319452, 0.6000000000000105, 1.0000000000000013, 26.511529840295815, 163.17723129272198, -3.552713678800501e-15, 217.47465763156302, 305.43071134199766, 10.879829651190509, 85.6, 425.70161205568087, 3.0, 325.96124679213506, 172.54275757770037, -2.1316282072803006e-14, -1.3766765505351941e-14, 257.2348653386387, 5.820737203649752, 486.9926121559581, 4.624467247336856, 0.09999999999999254, -2.256205768412604, 30.800000000000097, 224.61454732763417, 0.19999999999999574, 34.59529407536522, 3.7000000000000157, 7.993605777301127e-15, 18.054457610799133, 273.45157403402175, 532.830939209526, 648.2112419773517, 396.01820839406906, 475.1555150410667, 209.9085218459084, 170.12647302405452, 328.27397368807976, 373.44409050034784, 401.02793109017597, 143.63598425025373, 122.99618744879264, 297.7067968357615, 430.10031180555865, 221.7305096201058, 200.38993896850954, 237.52864219533, 628.8549955274334, 254.30519413870002, 197.86418492126145, 82.75888525496009, 1.865174681370263e-14, 372.7253464327645], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-280.77740914098507, -387.1270278972946, -1326.8467592249121, -45.78816534656452, -1260.1820756238785, -1316.1735176561647, -1316.4926703857038, -948.5883216284103, -1508.9670582628162, -1434.5575835589239, -1508.5072385200094, -1417.0355627860738, -1157.5955126719798, -731.5751308394309, -464.45149603004427, -1312.1816290804527, -1296.7715985631248, -114.53166833000037, -630.4535285558928, -1212.7876447842336, -1454.930236459725, -1375.2070225859134, -1469.5498793598151, -1434.9093630808604, -573.6355443688446, -1321.3673340831645, -1250.7242321549732, -1396.0838437555406, 157.43528758703928, -1468.585846070838, -974.457800980885, -1627.7687295614353, -1089.1271282565203, -1303.6354807593304, -1325.8243691472085, -1096.7868662708947, -1313.8118436816155, -1577.9638524390577, -1093.8524539564949, -930.8180234572111, -1611.9861794258675, -1100.7460483660802, -1469.345295210985, -1415.9771423338443, -1331.8423347064931, -1390.064053838507, -574.6131112610434, -1327.9099571579447, -1231.7479719770834, -1163.54312691231, -1105.5473770553613, -737.7461917736106, -1264.2164835720357, -517.4112360511577, -256.9677217385108, -1477.6579343302858, -870.9913253025921, -1129.7343011591527, -1328.8976930755296, -1341.2526086242917, -1475.0517171377141, -1555.9527161352087, -641.0440628516924, -151.9718343195909, -1309.3772839489095, -373.72911918659867, -1056.424235163232, -1321.0088139929485, 28.869542338169232, -756.0157446097812, -1526.4965273522637, -1097.4859143596545, -1434.097700798681, -958.8621389221931, -532.1363908150721, -3.0176923178562367, -1187.6762153871578, -286.64439381689914, -1146.7347867179587, -1259.271625170217, -44.363244065648026, 243.53881387868586, -1546.0938834040646, -117.96194453105132, -1289.5317942078675, -395.8773442785742, -1536.2469344575468, 122.66316929957199, -1298.0071796580864, -1140.3824312971174, -637.2483294633843, -1445.1610850882396, -1478.7803132560632, -1448.36402026232, -1453.7120391968324, -1698.9596007835728, -589.144144106503, -1156.4687598099515, -1547.930995266865, -1359.2029178634102, -1435.9420914077132, -1508.5457377300388, -1529.2793363555481, -1249.345024146285, -992.7142394621732, -196.0460515821251, -1291.5157465367781, -1429.3624069745872, -429.5229354564622, -846.4537067129413, -896.9633916361652, -1254.4574233345822, -1164.0264190675985, -1277.2798892445155, -1050.7841789919048, -1378.0531592799925, -343.11632343177854, -970.3568998587465, -1305.679599788633, -1457.0480201231103, 127.04434145722358, -1342.8771254501987, -1120.0301192411796, 21.09971264741568, -1495.2509469767551, -1608.7524043047104, -1416.20788055115, -1480.9010648773617, -458.2082398050539, -1224.0796538252412, -1158.2075096780889, -1455.553605430317, -334.2186571996185, -1179.2118576294133, -1390.1322789321446, -1003.2810225308731, -1366.3360175319056, -1421.9731050345717, -1493.1730788167574, -1419.223834392142, -859.7544532519032, -1164.2079155765605, -311.67209397729715, -1100.4192568887545, -1370.4435208222633, -1269.6358716988007, -1407.4090114371322, -1088.719830130882, -1254.6234422604705, -1528.7638683626028, -1667.8810191890827, -1336.8467156586082, -1577.3907749374314, -919.2281424757132, -478.7605196745093, 51.372394986499984, -187.3169886711003, -620.7604449325954, 142.8355638451451, -926.6776153311346, 77.31852753954965, -1300.006921296928, -333.51242524393825, -1408.8654715639998, -983.0540883340392, -176.18812636022108, -1498.8299324291575, -899.7159732172847, -643.0047868056027, -667.166980153406, -1543.2481808926595, 366.36359023963445, -814.803909242139, 26.11867013038298, -249.3531464151652, -1516.0720594255486, -27.109588377270683, -1298.882762278051, -1415.3162824433264, 280.17839387974425, -1020.6182489663404, 26.775973746301045, 101.46006129966462, -1238.176425022391, -526.6120453233028, -133.80020649057985, -1069.5448101818906, -246.6904408246065, -661.8511320433048, -493.4599152532976, -1192.6538288348224, -571.2551517416451, -1032.135035564477, -818.9017614017695, -95.3463621090558, -1277.183694436098, -1309.187158959266, -1446.3277653087328, -388.3409113084124, -871.6448459839561], "policy_predator_policy_reward": [552.6620269002352, 481.5989811301351, 1151.15442673837, 477.4770080297834, 1468.1087162079086, 1163.6826405671702, 1310.5977200967518, 1043.620061465767, 1508.9670582628162, 1434.3585166004366, 1508.5072385200094, 1417.1355627860737, 770.2595368828564, 1348.5307873595518, 1076.0854728047802, 1251.5249465195186, 1351.3700599710767, 260.5641512293632, 1209.6706614741508, 808.8924033989186, 1481.5555097361098, 1361.1253064142177, 1473.649879359815, 1434.9093630808604, 652.5710540064473, 1362.4544344980022, 1290.7300665002515, 1355.1284414198092, 736.2096407585044, 834.6376778336825, 1081.8847910852546, 1625.0577427757892, 1099.9271282565217, 1303.6354807593304, 1330.2327567108957, 1208.8563490264141, 1314.2285696359668, 1577.9638524390577, 1232.547032518842, 1000.3114664825116, 1612.3861794258676, 1126.9636160260625, 1470.425873333324, 1416.6771423338444, 1332.7320160144868, 1390.064053838507, 1243.3084526759128, 843.2717394431608, 1271.7479719770827, 1169.5431269123098, 893.6987135429704, 1257.599972249315, 1263.9861728341768, 781.3095394769281, 504.30073941576507, 1479.05196798736, 1125.702599887268, 1195.495379950203, 1329.2530026182183, 1341.8526086242919, 1475.2102315838015, 1558.9527161352084, 48.917171772316856, 1034.4321557110877, 1085.6383050440425, 1075.2284134926085, 1100.319252656805, 1325.408813992948, 585.5199026227924, 434.03964316426277, 1526.4965273522637, 1098.4859143596545, 1031.1008597682476, 1455.7783652037624, 557.6038746918492, 53.52338534841784, 1155.411058729001, 661.7841283978671, 1150.734786717955, 1259.271625170217, 78.86324406564772, 45.061186121313824, 1546.0938834040646, 148.6072313883808, 1290.9317942078671, 457.98580489818585, 1198.5639309115907, 480.6112034144371, 1098.238311974418, 1368.2359072479571, 790.473005894798, 1445.1610850882396, 1478.9803132560633, 1448.5640202623201, 1453.7120391968324, 1698.9596007835728, 672.141869759697, 1176.9687598099517, 1548.5309952668651, 1359.2029178634102, 1436.9420914077123, 1508.5457377300388, 1529.2793363555481, 1275.856553986581, 1171.7207073896425, 180.2168149473803, 1291.5157465367781, 1429.3624069745872, 131.86563078890487, 1361.5856690120593, 1210.562990221898, 1246.288536090851, 1248.7836573041254, 1203.4024806591794, 1136.3841789919045, 1378.0531592799925, 1087.7339369606848, 651.4408983855274, 1308.679599788633, 1457.0480201231103, 371.8603006484873, 1169.9337301366215, 585.7570573733478, 685.7161067981182, 1495.2509469767551, 1608.7524043047104, 1416.20788055115, 1480.9010648773617, 564.0215218440984, 1375.5012371248376, 1447.7031634771788, 1171.8786888348766, 852.3784813478844, 1148.0446456371076, 1384.9450294023682, 1013.0927393079862, 1366.3360175319056, 1422.0731050345717, 1490.9168730483448, 1419.223834392142, 866.4544532519049, 1188.3079155765602, 629.421403104063, 1007.2844950896218, 1370.6435208222633, 1269.6358716988007, 1408.0666020871777, 1122.6575335562013, 1258.3234422604671, 1528.7638683626028, 1667.8810191890827, 1336.8467156586082, 1577.3907749374314, 937.2826000865128, 681.421157686706, 19.418541035327642, 693.0981179084866, 647.8102549047346, 904.587700239234, 527.4655932241076, 410.33202184947663, 1208.3745803019688, 1202.8199390308973, 1014.7134728181065, 1047.0024995755234, 322.14823696464646, 1461.0829744710743, 1107.589404199421, 1136.8178914596954, 501.6278491873949, 19.525064403256998, 1530.803616750116, 752.9565664114922, 436.75660379043893, 391.989130665422, 1517.0720594255488, 149.00577582606354, 1299.982762278051, 1416.4315863420934, 16.413099057250196, 1023.0950635977091, 400.8475234278881, 119.57044832044134, 1238.8764250223903, 558.3349011040565, 302.4672896783392, 1072.1448101818912, 481.6190830199368, 904.6047003194016, 879.5613425046431, 911.1307870731782, 1107.083387641991, 1034.529935323294, 1014.3710465642135, 177.705247364015, 1277.583694436098, 1309.187158959266, 1446.3277653087328, 1337.5810494952525, 295.13005422988954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.11787697220765, "mean_inference_ms": 5.23706730730603, "mean_action_processing_ms": 2.203715655921319, "mean_env_wait_ms": 13.255100557868655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061490535736083984, "StateBufferConnector_ms": 0.004286289215087891, "ViewRequirementAgentConnector_ms": 0.12409937381744385}, "num_episodes": 10, "episode_return_max": 648.2112419773517, "episode_return_min": -2.256205768412604, "episode_return_mean": 165.5974681903286, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.1696766453137, "num_env_steps_trained_throughput_per_sec": 151.1696766453137, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 26670.028, "restore_workers_time_ms": 0.062, "training_step_time_ms": 26669.693, "sample_time_ms": 2651.742, "learn_time_ms": 23990.373, "learn_throughput": 166.734, "synch_weights_time_ms": 23.265}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-52-45", "timestamp": 1724383365, "time_this_iter_s": 26.519447088241577, "time_total_s": 1080.2161693572998, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3096285e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1080.2161693572998, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 38.71351351351351, "ram_util_percent": 82.76486486486488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.337650158165623, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.96268853384351, "policy_loss": -0.008166162368580305, "vf_loss": 7.969527954525418, "vf_explained_var": 0.44236243591106755, "kl": 0.006633737996940023, "entropy": 0.5310096814834252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38273.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.580574567481953, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.031025090797868, "policy_loss": -0.010466217772453709, "vf_loss": 8.039905340709383, "vf_explained_var": 0.5493832240659724, "kl": 0.007929853966863697, "entropy": 0.8479795282479947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38273.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 648.2112419773517, "episode_reward_min": -2.256205768412604, "episode_reward_mean": 168.3884584776572, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1698.9596007835728, "predator_policy": 16.413099057250196}, "policy_reward_max": {"prey_policy": 366.36359023963445, "predator_policy": 1698.9596007835728}, "policy_reward_mean": {"prey_policy": -975.5238634656716, "predator_policy": 1059.7180927045004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [550.9772942138026, 200.63094430731502, 175.32189153294203, 12.54355710468941, 4.099999999999989, 120.02261005243989, -0.949567990453343, 259.6967601083857, 104.71600331872348, 10.79999999999998, 116.4778703192056, 0.41672595435132287, 208.18802158764777, 26.617567659981088, 1.7805781223393229, 0.8896813079937429, 184.05712370008519, 46.00000000000002, 308.00511696331415, 263.6679926879089, 248.7270513343284, 320.4723533757343, 0.9553095426887301, 3.158514446087425, 290.333430312121, 477.7603154011425, 48.2950174935804, 292.41334351544725, 1.000000000000003, 93.91938525113599, 75.97317690733402, 342.87457792280895, 4.0000000000000036, 323.1, 30.645286857329385, 63.50846061961306, 265.5913691680511, 28.08460826717086, 153.22467643141442, 0.3999999999999999, 7.993605777301127e-15, 103.49772565319452, 0.6000000000000105, 1.0000000000000013, 26.511529840295815, 163.17723129272198, -3.552713678800501e-15, 217.47465763156302, 305.43071134199766, 10.879829651190509, 85.6, 425.70161205568087, 3.0, 325.96124679213506, 172.54275757770037, -2.1316282072803006e-14, -1.3766765505351941e-14, 257.2348653386387, 5.820737203649752, 486.9926121559581, 4.624467247336856, 0.09999999999999254, -2.256205768412604, 30.800000000000097, 224.61454732763417, 0.19999999999999574, 34.59529407536522, 3.7000000000000157, 7.993605777301127e-15, 18.054457610799133, 273.45157403402175, 532.830939209526, 648.2112419773517, 396.01820839406906, 475.1555150410667, 209.9085218459084, 170.12647302405452, 328.27397368807976, 373.44409050034784, 401.02793109017597, 143.63598425025373, 122.99618744879264, 297.7067968357615, 430.10031180555865, 221.7305096201058, 200.38993896850954, 237.52864219533, 628.8549955274334, 254.30519413870002, 197.86418492126145, 82.75888525496009, 1.865174681370263e-14, 372.7253464327645, 604.8136461467523, 135.3435142078955, -3.552713678800501e-15, 57.0606342236431, 11.200000000000017, 459.25282788877587, 7.874654270512243], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-464.45149603004427, -1312.1816290804527, -1296.7715985631248, -114.53166833000037, -630.4535285558928, -1212.7876447842336, -1454.930236459725, -1375.2070225859134, -1469.5498793598151, -1434.9093630808604, -573.6355443688446, -1321.3673340831645, -1250.7242321549732, -1396.0838437555406, 157.43528758703928, -1468.585846070838, -974.457800980885, -1627.7687295614353, -1089.1271282565203, -1303.6354807593304, -1325.8243691472085, -1096.7868662708947, -1313.8118436816155, -1577.9638524390577, -1093.8524539564949, -930.8180234572111, -1611.9861794258675, -1100.7460483660802, -1469.345295210985, -1415.9771423338443, -1331.8423347064931, -1390.064053838507, -574.6131112610434, -1327.9099571579447, -1231.7479719770834, -1163.54312691231, -1105.5473770553613, -737.7461917736106, -1264.2164835720357, -517.4112360511577, -256.9677217385108, -1477.6579343302858, -870.9913253025921, -1129.7343011591527, -1328.8976930755296, -1341.2526086242917, -1475.0517171377141, -1555.9527161352087, -641.0440628516924, -151.9718343195909, -1309.3772839489095, -373.72911918659867, -1056.424235163232, -1321.0088139929485, 28.869542338169232, -756.0157446097812, -1526.4965273522637, -1097.4859143596545, -1434.097700798681, -958.8621389221931, -532.1363908150721, -3.0176923178562367, -1187.6762153871578, -286.64439381689914, -1146.7347867179587, -1259.271625170217, -44.363244065648026, 243.53881387868586, -1546.0938834040646, -117.96194453105132, -1289.5317942078675, -395.8773442785742, -1536.2469344575468, 122.66316929957199, -1298.0071796580864, -1140.3824312971174, -637.2483294633843, -1445.1610850882396, -1478.7803132560632, -1448.36402026232, -1453.7120391968324, -1698.9596007835728, -589.144144106503, -1156.4687598099515, -1547.930995266865, -1359.2029178634102, -1435.9420914077132, -1508.5457377300388, -1529.2793363555481, -1249.345024146285, -992.7142394621732, -196.0460515821251, -1291.5157465367781, -1429.3624069745872, -429.5229354564622, -846.4537067129413, -896.9633916361652, -1254.4574233345822, -1164.0264190675985, -1277.2798892445155, -1050.7841789919048, -1378.0531592799925, -343.11632343177854, -970.3568998587465, -1305.679599788633, -1457.0480201231103, 127.04434145722358, -1342.8771254501987, -1120.0301192411796, 21.09971264741568, -1495.2509469767551, -1608.7524043047104, -1416.20788055115, -1480.9010648773617, -458.2082398050539, -1224.0796538252412, -1158.2075096780889, -1455.553605430317, -334.2186571996185, -1179.2118576294133, -1390.1322789321446, -1003.2810225308731, -1366.3360175319056, -1421.9731050345717, -1493.1730788167574, -1419.223834392142, -859.7544532519032, -1164.2079155765605, -311.67209397729715, -1100.4192568887545, -1370.4435208222633, -1269.6358716988007, -1407.4090114371322, -1088.719830130882, -1254.6234422604705, -1528.7638683626028, -1667.8810191890827, -1336.8467156586082, -1577.3907749374314, -919.2281424757132, -478.7605196745093, 51.372394986499984, -187.3169886711003, -620.7604449325954, 142.8355638451451, -926.6776153311346, 77.31852753954965, -1300.006921296928, -333.51242524393825, -1408.8654715639998, -983.0540883340392, -176.18812636022108, -1498.8299324291575, -899.7159732172847, -643.0047868056027, -667.166980153406, -1543.2481808926595, 366.36359023963445, -814.803909242139, 26.11867013038298, -249.3531464151652, -1516.0720594255486, -27.109588377270683, -1298.882762278051, -1415.3162824433264, 280.17839387974425, -1020.6182489663404, 26.775973746301045, 101.46006129966462, -1238.176425022391, -526.6120453233028, -133.80020649057985, -1069.5448101818906, -246.6904408246065, -661.8511320433048, -493.4599152532976, -1192.6538288348224, -571.2551517416451, -1032.135035564477, -818.9017614017695, -95.3463621090558, -1277.183694436098, -1309.187158959266, -1446.3277653087328, -388.3409113084124, -871.6448459839561, -1197.5860871913312, -323.1111330338219, -1399.9406903661595, -159.24436969595553, -1294.984385212365, -1485.7770031413406, -749.7047274677468, -1412.9159306477832, -1491.9830154194874, -1280.0206640891197, -713.8321290359341, -183.1602485834001, -1207.0679278324183, -1350.1841978062923], "policy_predator_policy_reward": [1076.0854728047802, 1251.5249465195186, 1351.3700599710767, 260.5641512293632, 1209.6706614741508, 808.8924033989186, 1481.5555097361098, 1361.1253064142177, 1473.649879359815, 1434.9093630808604, 652.5710540064473, 1362.4544344980022, 1290.7300665002515, 1355.1284414198092, 736.2096407585044, 834.6376778336825, 1081.8847910852546, 1625.0577427757892, 1099.9271282565217, 1303.6354807593304, 1330.2327567108957, 1208.8563490264141, 1314.2285696359668, 1577.9638524390577, 1232.547032518842, 1000.3114664825116, 1612.3861794258676, 1126.9636160260625, 1470.425873333324, 1416.6771423338444, 1332.7320160144868, 1390.064053838507, 1243.3084526759128, 843.2717394431608, 1271.7479719770827, 1169.5431269123098, 893.6987135429704, 1257.599972249315, 1263.9861728341768, 781.3095394769281, 504.30073941576507, 1479.05196798736, 1125.702599887268, 1195.495379950203, 1329.2530026182183, 1341.8526086242919, 1475.2102315838015, 1558.9527161352084, 48.917171772316856, 1034.4321557110877, 1085.6383050440425, 1075.2284134926085, 1100.319252656805, 1325.408813992948, 585.5199026227924, 434.03964316426277, 1526.4965273522637, 1098.4859143596545, 1031.1008597682476, 1455.7783652037624, 557.6038746918492, 53.52338534841784, 1155.411058729001, 661.7841283978671, 1150.734786717955, 1259.271625170217, 78.86324406564772, 45.061186121313824, 1546.0938834040646, 148.6072313883808, 1290.9317942078671, 457.98580489818585, 1198.5639309115907, 480.6112034144371, 1098.238311974418, 1368.2359072479571, 790.473005894798, 1445.1610850882396, 1478.9803132560633, 1448.5640202623201, 1453.7120391968324, 1698.9596007835728, 672.141869759697, 1176.9687598099517, 1548.5309952668651, 1359.2029178634102, 1436.9420914077123, 1508.5457377300388, 1529.2793363555481, 1275.856553986581, 1171.7207073896425, 180.2168149473803, 1291.5157465367781, 1429.3624069745872, 131.86563078890487, 1361.5856690120593, 1210.562990221898, 1246.288536090851, 1248.7836573041254, 1203.4024806591794, 1136.3841789919045, 1378.0531592799925, 1087.7339369606848, 651.4408983855274, 1308.679599788633, 1457.0480201231103, 371.8603006484873, 1169.9337301366215, 585.7570573733478, 685.7161067981182, 1495.2509469767551, 1608.7524043047104, 1416.20788055115, 1480.9010648773617, 564.0215218440984, 1375.5012371248376, 1447.7031634771788, 1171.8786888348766, 852.3784813478844, 1148.0446456371076, 1384.9450294023682, 1013.0927393079862, 1366.3360175319056, 1422.0731050345717, 1490.9168730483448, 1419.223834392142, 866.4544532519049, 1188.3079155765602, 629.421403104063, 1007.2844950896218, 1370.6435208222633, 1269.6358716988007, 1408.0666020871777, 1122.6575335562013, 1258.3234422604671, 1528.7638683626028, 1667.8810191890827, 1336.8467156586082, 1577.3907749374314, 937.2826000865128, 681.421157686706, 19.418541035327642, 693.0981179084866, 647.8102549047346, 904.587700239234, 527.4655932241076, 410.33202184947663, 1208.3745803019688, 1202.8199390308973, 1014.7134728181065, 1047.0024995755234, 322.14823696464646, 1461.0829744710743, 1107.589404199421, 1136.8178914596954, 501.6278491873949, 19.525064403256998, 1530.803616750116, 752.9565664114922, 436.75660379043893, 391.989130665422, 1517.0720594255488, 149.00577582606354, 1299.982762278051, 1416.4315863420934, 16.413099057250196, 1023.0950635977091, 400.8475234278881, 119.57044832044134, 1238.8764250223903, 558.3349011040565, 302.4672896783392, 1072.1448101818912, 481.6190830199368, 904.6047003194016, 879.5613425046431, 911.1307870731782, 1107.083387641991, 1034.529935323294, 1014.3710465642135, 177.705247364015, 1277.583694436098, 1309.187158959266, 1446.3277653087328, 1337.5810494952525, 295.13005422988954, 953.6628535272307, 1171.8480128446793, 934.7959321557585, 759.7326421142492, 1294.984385212365, 1485.7770031413406, 806.7653616913907, 1412.9159306477832, 1491.9830154194874, 1291.2206640891195, 675.5361020544788, 680.7091034536301, 1212.6470348336825, 1352.479745075539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.081613096990118, "mean_inference_ms": 5.221270444399738, "mean_action_processing_ms": 2.226797274291321, "mean_env_wait_ms": 13.242180713497266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006185054779052734, "StateBufferConnector_ms": 0.0043239593505859375, "ViewRequirementAgentConnector_ms": 0.1330016851425171}, "num_episodes": 7, "episode_return_max": 648.2112419773517, "episode_return_min": -2.256205768412604, "episode_return_mean": 168.3884584776572, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.7338061644781, "num_env_steps_trained_throughput_per_sec": 152.7338061644781, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 26681.989, "restore_workers_time_ms": 0.062, "training_step_time_ms": 26681.659, "sample_time_ms": 2639.978, "learn_time_ms": 24014.711, "learn_throughput": 166.565, "synch_weights_time_ms": 22.81}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-53-11", "timestamp": 1724383391, "time_this_iter_s": 26.238177061080933, "time_total_s": 1106.4543464183807, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095ce310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1106.4543464183807, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 34.226315789473674, "ram_util_percent": 81.77368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.092759951081856, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.580785688773664, "policy_loss": -0.006127675036806121, "vf_loss": 7.585713258874479, "vf_explained_var": 0.5022133317573991, "kl": 0.006000544494461446, "entropy": 0.5665650241274052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 39218.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.225454671042307, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.831669630827727, "policy_loss": -0.010325958237800964, "vf_loss": 7.840252081048551, "vf_explained_var": 0.579963966021462, "kl": 0.008717432443210214, "entropy": 0.8593222734158632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 39218.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 648.2112419773517, "episode_reward_min": -2.256205768412604, "episode_reward_mean": 161.50981047308215, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1698.9596007835728, "predator_policy": 16.413099057250196}, "policy_reward_max": {"prey_policy": 366.36359023963445, "predator_policy": 1698.9596007835728}, "policy_reward_mean": {"prey_policy": -968.2988534504459, "predator_policy": 1049.053758686987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [259.6967601083857, 104.71600331872348, 10.79999999999998, 116.4778703192056, 0.41672595435132287, 208.18802158764777, 26.617567659981088, 1.7805781223393229, 0.8896813079937429, 184.05712370008519, 46.00000000000002, 308.00511696331415, 263.6679926879089, 248.7270513343284, 320.4723533757343, 0.9553095426887301, 3.158514446087425, 290.333430312121, 477.7603154011425, 48.2950174935804, 292.41334351544725, 1.000000000000003, 93.91938525113599, 75.97317690733402, 342.87457792280895, 4.0000000000000036, 323.1, 30.645286857329385, 63.50846061961306, 265.5913691680511, 28.08460826717086, 153.22467643141442, 0.3999999999999999, 7.993605777301127e-15, 103.49772565319452, 0.6000000000000105, 1.0000000000000013, 26.511529840295815, 163.17723129272198, -3.552713678800501e-15, 217.47465763156302, 305.43071134199766, 10.879829651190509, 85.6, 425.70161205568087, 3.0, 325.96124679213506, 172.54275757770037, -2.1316282072803006e-14, -1.3766765505351941e-14, 257.2348653386387, 5.820737203649752, 486.9926121559581, 4.624467247336856, 0.09999999999999254, -2.256205768412604, 30.800000000000097, 224.61454732763417, 0.19999999999999574, 34.59529407536522, 3.7000000000000157, 7.993605777301127e-15, 18.054457610799133, 273.45157403402175, 532.830939209526, 648.2112419773517, 396.01820839406906, 475.1555150410667, 209.9085218459084, 170.12647302405452, 328.27397368807976, 373.44409050034784, 401.02793109017597, 143.63598425025373, 122.99618744879264, 297.7067968357615, 430.10031180555865, 221.7305096201058, 200.38993896850954, 237.52864219533, 628.8549955274334, 254.30519413870002, 197.86418492126145, 82.75888525496009, 1.865174681370263e-14, 372.7253464327645, 604.8136461467523, 135.3435142078955, -3.552713678800501e-15, 57.0606342236431, 11.200000000000017, 459.25282788877587, 7.874654270512243, 1.0999999999999948, 52.89999999999999, 3.400000000000003, 30.961557357756256, 3.299999999999999, 92.71725033267836, 190.4031210727976], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [157.43528758703928, -1468.585846070838, -974.457800980885, -1627.7687295614353, -1089.1271282565203, -1303.6354807593304, -1325.8243691472085, -1096.7868662708947, -1313.8118436816155, -1577.9638524390577, -1093.8524539564949, -930.8180234572111, -1611.9861794258675, -1100.7460483660802, -1469.345295210985, -1415.9771423338443, -1331.8423347064931, -1390.064053838507, -574.6131112610434, -1327.9099571579447, -1231.7479719770834, -1163.54312691231, -1105.5473770553613, -737.7461917736106, -1264.2164835720357, -517.4112360511577, -256.9677217385108, -1477.6579343302858, -870.9913253025921, -1129.7343011591527, -1328.8976930755296, -1341.2526086242917, -1475.0517171377141, -1555.9527161352087, -641.0440628516924, -151.9718343195909, -1309.3772839489095, -373.72911918659867, -1056.424235163232, -1321.0088139929485, 28.869542338169232, -756.0157446097812, -1526.4965273522637, -1097.4859143596545, -1434.097700798681, -958.8621389221931, -532.1363908150721, -3.0176923178562367, -1187.6762153871578, -286.64439381689914, -1146.7347867179587, -1259.271625170217, -44.363244065648026, 243.53881387868586, -1546.0938834040646, -117.96194453105132, -1289.5317942078675, -395.8773442785742, -1536.2469344575468, 122.66316929957199, -1298.0071796580864, -1140.3824312971174, -637.2483294633843, -1445.1610850882396, -1478.7803132560632, -1448.36402026232, -1453.7120391968324, -1698.9596007835728, -589.144144106503, -1156.4687598099515, -1547.930995266865, -1359.2029178634102, -1435.9420914077132, -1508.5457377300388, -1529.2793363555481, -1249.345024146285, -992.7142394621732, -196.0460515821251, -1291.5157465367781, -1429.3624069745872, -429.5229354564622, -846.4537067129413, -896.9633916361652, -1254.4574233345822, -1164.0264190675985, -1277.2798892445155, -1050.7841789919048, -1378.0531592799925, -343.11632343177854, -970.3568998587465, -1305.679599788633, -1457.0480201231103, 127.04434145722358, -1342.8771254501987, -1120.0301192411796, 21.09971264741568, -1495.2509469767551, -1608.7524043047104, -1416.20788055115, -1480.9010648773617, -458.2082398050539, -1224.0796538252412, -1158.2075096780889, -1455.553605430317, -334.2186571996185, -1179.2118576294133, -1390.1322789321446, -1003.2810225308731, -1366.3360175319056, -1421.9731050345717, -1493.1730788167574, -1419.223834392142, -859.7544532519032, -1164.2079155765605, -311.67209397729715, -1100.4192568887545, -1370.4435208222633, -1269.6358716988007, -1407.4090114371322, -1088.719830130882, -1254.6234422604705, -1528.7638683626028, -1667.8810191890827, -1336.8467156586082, -1577.3907749374314, -919.2281424757132, -478.7605196745093, 51.372394986499984, -187.3169886711003, -620.7604449325954, 142.8355638451451, -926.6776153311346, 77.31852753954965, -1300.006921296928, -333.51242524393825, -1408.8654715639998, -983.0540883340392, -176.18812636022108, -1498.8299324291575, -899.7159732172847, -643.0047868056027, -667.166980153406, -1543.2481808926595, 366.36359023963445, -814.803909242139, 26.11867013038298, -249.3531464151652, -1516.0720594255486, -27.109588377270683, -1298.882762278051, -1415.3162824433264, 280.17839387974425, -1020.6182489663404, 26.775973746301045, 101.46006129966462, -1238.176425022391, -526.6120453233028, -133.80020649057985, -1069.5448101818906, -246.6904408246065, -661.8511320433048, -493.4599152532976, -1192.6538288348224, -571.2551517416451, -1032.135035564477, -818.9017614017695, -95.3463621090558, -1277.183694436098, -1309.187158959266, -1446.3277653087328, -388.3409113084124, -871.6448459839561, -1197.5860871913312, -323.1111330338219, -1399.9406903661595, -159.24436969595553, -1294.984385212365, -1485.7770031413406, -749.7047274677468, -1412.9159306477832, -1491.9830154194874, -1280.0206640891197, -713.8321290359341, -183.1602485834001, -1207.0679278324183, -1350.1841978062923, -1184.5428996853452, -1233.5818853055405, -941.4574020588225, -1120.2675070273285, -1099.4833479744009, -1507.0461877549183, -1054.9225311915186, -918.5668991558845, -1324.092856481583, -675.66810785267, -1194.389012016887, -541.7671418057956, 157.8155338417941, -1224.6127736785475], "policy_predator_policy_reward": [736.2096407585044, 834.6376778336825, 1081.8847910852546, 1625.0577427757892, 1099.9271282565217, 1303.6354807593304, 1330.2327567108957, 1208.8563490264141, 1314.2285696359668, 1577.9638524390577, 1232.547032518842, 1000.3114664825116, 1612.3861794258676, 1126.9636160260625, 1470.425873333324, 1416.6771423338444, 1332.7320160144868, 1390.064053838507, 1243.3084526759128, 843.2717394431608, 1271.7479719770827, 1169.5431269123098, 893.6987135429704, 1257.599972249315, 1263.9861728341768, 781.3095394769281, 504.30073941576507, 1479.05196798736, 1125.702599887268, 1195.495379950203, 1329.2530026182183, 1341.8526086242919, 1475.2102315838015, 1558.9527161352084, 48.917171772316856, 1034.4321557110877, 1085.6383050440425, 1075.2284134926085, 1100.319252656805, 1325.408813992948, 585.5199026227924, 434.03964316426277, 1526.4965273522637, 1098.4859143596545, 1031.1008597682476, 1455.7783652037624, 557.6038746918492, 53.52338534841784, 1155.411058729001, 661.7841283978671, 1150.734786717955, 1259.271625170217, 78.86324406564772, 45.061186121313824, 1546.0938834040646, 148.6072313883808, 1290.9317942078671, 457.98580489818585, 1198.5639309115907, 480.6112034144371, 1098.238311974418, 1368.2359072479571, 790.473005894798, 1445.1610850882396, 1478.9803132560633, 1448.5640202623201, 1453.7120391968324, 1698.9596007835728, 672.141869759697, 1176.9687598099517, 1548.5309952668651, 1359.2029178634102, 1436.9420914077123, 1508.5457377300388, 1529.2793363555481, 1275.856553986581, 1171.7207073896425, 180.2168149473803, 1291.5157465367781, 1429.3624069745872, 131.86563078890487, 1361.5856690120593, 1210.562990221898, 1246.288536090851, 1248.7836573041254, 1203.4024806591794, 1136.3841789919045, 1378.0531592799925, 1087.7339369606848, 651.4408983855274, 1308.679599788633, 1457.0480201231103, 371.8603006484873, 1169.9337301366215, 585.7570573733478, 685.7161067981182, 1495.2509469767551, 1608.7524043047104, 1416.20788055115, 1480.9010648773617, 564.0215218440984, 1375.5012371248376, 1447.7031634771788, 1171.8786888348766, 852.3784813478844, 1148.0446456371076, 1384.9450294023682, 1013.0927393079862, 1366.3360175319056, 1422.0731050345717, 1490.9168730483448, 1419.223834392142, 866.4544532519049, 1188.3079155765602, 629.421403104063, 1007.2844950896218, 1370.6435208222633, 1269.6358716988007, 1408.0666020871777, 1122.6575335562013, 1258.3234422604671, 1528.7638683626028, 1667.8810191890827, 1336.8467156586082, 1577.3907749374314, 937.2826000865128, 681.421157686706, 19.418541035327642, 693.0981179084866, 647.8102549047346, 904.587700239234, 527.4655932241076, 410.33202184947663, 1208.3745803019688, 1202.8199390308973, 1014.7134728181065, 1047.0024995755234, 322.14823696464646, 1461.0829744710743, 1107.589404199421, 1136.8178914596954, 501.6278491873949, 19.525064403256998, 1530.803616750116, 752.9565664114922, 436.75660379043893, 391.989130665422, 1517.0720594255488, 149.00577582606354, 1299.982762278051, 1416.4315863420934, 16.413099057250196, 1023.0950635977091, 400.8475234278881, 119.57044832044134, 1238.8764250223903, 558.3349011040565, 302.4672896783392, 1072.1448101818912, 481.6190830199368, 904.6047003194016, 879.5613425046431, 911.1307870731782, 1107.083387641991, 1034.529935323294, 1014.3710465642135, 177.705247364015, 1277.583694436098, 1309.187158959266, 1446.3277653087328, 1337.5810494952525, 295.13005422988954, 953.6628535272307, 1171.8480128446793, 934.7959321557585, 759.7326421142492, 1294.984385212365, 1485.7770031413406, 806.7653616913907, 1412.9159306477832, 1491.9830154194874, 1291.2206640891195, 675.5361020544788, 680.7091034536301, 1212.6470348336825, 1352.479745075539, 1185.6428996853451, 1233.5818853055405, 981.0574020588233, 1133.5675070273285, 1101.8833479744012, 1508.0461877549183, 1085.5133281817414, 918.9376595234105, 1324.092856481583, 678.9681078526701, 1187.1277782615734, 641.7456258937887, 31.687587231003445, 1225.5127736785475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.083436404214366, "mean_inference_ms": 5.226372577258384, "mean_action_processing_ms": 2.2009435175729686, "mean_env_wait_ms": 13.245567318665044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006187319755554199, "StateBufferConnector_ms": 0.006561756134033203, "ViewRequirementAgentConnector_ms": 0.13084423542022705}, "num_episodes": 7, "episode_return_max": 648.2112419773517, "episode_return_min": -2.256205768412604, "episode_return_mean": 161.50981047308215, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.48303101673088, "num_env_steps_trained_throughput_per_sec": 153.48303101673088, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 26634.155, "restore_workers_time_ms": 0.061, "training_step_time_ms": 26633.86, "sample_time_ms": 2575.944, "learn_time_ms": 24031.816, "learn_throughput": 166.446, "synch_weights_time_ms": 22.171}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-53-37", "timestamp": 1724383417, "time_this_iter_s": 26.123050928115845, "time_total_s": 1132.5773973464966, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309628790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1132.5773973464966, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 34.2972972972973, "ram_util_percent": 81.99999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.480077295707016, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.405160155119719, "policy_loss": -0.009342968334300965, "vf_loss": 7.413108162148289, "vf_explained_var": 0.5241039809726533, "kl": 0.006974800820856616, "entropy": 0.6050805102895808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40163.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.71123975483829, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.244627995465798, "policy_loss": -0.011386809144021263, "vf_loss": 7.254398432736674, "vf_explained_var": 0.6406375334376381, "kl": 0.008081675810177647, "entropy": 0.8663149703747381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40163.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 648.2112419773517, "episode_reward_min": -2.256205768412604, "episode_reward_mean": 177.30889429271667, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1698.9596007835728, "predator_policy": 16.413099057250196}, "policy_reward_max": {"prey_policy": 366.36359023963445, "predator_policy": 1698.9596007835728}, "policy_reward_mean": {"prey_policy": -948.6776562150926, "predator_policy": 1037.3321033614511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.00000000000002, 308.00511696331415, 263.6679926879089, 248.7270513343284, 320.4723533757343, 0.9553095426887301, 3.158514446087425, 290.333430312121, 477.7603154011425, 48.2950174935804, 292.41334351544725, 1.000000000000003, 93.91938525113599, 75.97317690733402, 342.87457792280895, 4.0000000000000036, 323.1, 30.645286857329385, 63.50846061961306, 265.5913691680511, 28.08460826717086, 153.22467643141442, 0.3999999999999999, 7.993605777301127e-15, 103.49772565319452, 0.6000000000000105, 1.0000000000000013, 26.511529840295815, 163.17723129272198, -3.552713678800501e-15, 217.47465763156302, 305.43071134199766, 10.879829651190509, 85.6, 425.70161205568087, 3.0, 325.96124679213506, 172.54275757770037, -2.1316282072803006e-14, -1.3766765505351941e-14, 257.2348653386387, 5.820737203649752, 486.9926121559581, 4.624467247336856, 0.09999999999999254, -2.256205768412604, 30.800000000000097, 224.61454732763417, 0.19999999999999574, 34.59529407536522, 3.7000000000000157, 7.993605777301127e-15, 18.054457610799133, 273.45157403402175, 532.830939209526, 648.2112419773517, 396.01820839406906, 475.1555150410667, 209.9085218459084, 170.12647302405452, 328.27397368807976, 373.44409050034784, 401.02793109017597, 143.63598425025373, 122.99618744879264, 297.7067968357615, 430.10031180555865, 221.7305096201058, 200.38993896850954, 237.52864219533, 628.8549955274334, 254.30519413870002, 197.86418492126145, 82.75888525496009, 1.865174681370263e-14, 372.7253464327645, 604.8136461467523, 135.3435142078955, -3.552713678800501e-15, 57.0606342236431, 11.200000000000017, 459.25282788877587, 7.874654270512243, 1.0999999999999948, 52.89999999999999, 3.400000000000003, 30.961557357756256, 3.299999999999999, 92.71725033267836, 190.4031210727976, 628.5393605531242, 336.9875942164388, 490.6333070312155, 0.3145804658108502, 233.35354446396096, 16.77005492366574, 364.4662566152945, -8.881784197001252e-16, 17.061664905327206, 405.42235086732677], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1231.7479719770834, -1163.54312691231, -1105.5473770553613, -737.7461917736106, -1264.2164835720357, -517.4112360511577, -256.9677217385108, -1477.6579343302858, -870.9913253025921, -1129.7343011591527, -1328.8976930755296, -1341.2526086242917, -1475.0517171377141, -1555.9527161352087, -641.0440628516924, -151.9718343195909, -1309.3772839489095, -373.72911918659867, -1056.424235163232, -1321.0088139929485, 28.869542338169232, -756.0157446097812, -1526.4965273522637, -1097.4859143596545, -1434.097700798681, -958.8621389221931, -532.1363908150721, -3.0176923178562367, -1187.6762153871578, -286.64439381689914, -1146.7347867179587, -1259.271625170217, -44.363244065648026, 243.53881387868586, -1546.0938834040646, -117.96194453105132, -1289.5317942078675, -395.8773442785742, -1536.2469344575468, 122.66316929957199, -1298.0071796580864, -1140.3824312971174, -637.2483294633843, -1445.1610850882396, -1478.7803132560632, -1448.36402026232, -1453.7120391968324, -1698.9596007835728, -589.144144106503, -1156.4687598099515, -1547.930995266865, -1359.2029178634102, -1435.9420914077132, -1508.5457377300388, -1529.2793363555481, -1249.345024146285, -992.7142394621732, -196.0460515821251, -1291.5157465367781, -1429.3624069745872, -429.5229354564622, -846.4537067129413, -896.9633916361652, -1254.4574233345822, -1164.0264190675985, -1277.2798892445155, -1050.7841789919048, -1378.0531592799925, -343.11632343177854, -970.3568998587465, -1305.679599788633, -1457.0480201231103, 127.04434145722358, -1342.8771254501987, -1120.0301192411796, 21.09971264741568, -1495.2509469767551, -1608.7524043047104, -1416.20788055115, -1480.9010648773617, -458.2082398050539, -1224.0796538252412, -1158.2075096780889, -1455.553605430317, -334.2186571996185, -1179.2118576294133, -1390.1322789321446, -1003.2810225308731, -1366.3360175319056, -1421.9731050345717, -1493.1730788167574, -1419.223834392142, -859.7544532519032, -1164.2079155765605, -311.67209397729715, -1100.4192568887545, -1370.4435208222633, -1269.6358716988007, -1407.4090114371322, -1088.719830130882, -1254.6234422604705, -1528.7638683626028, -1667.8810191890827, -1336.8467156586082, -1577.3907749374314, -919.2281424757132, -478.7605196745093, 51.372394986499984, -187.3169886711003, -620.7604449325954, 142.8355638451451, -926.6776153311346, 77.31852753954965, -1300.006921296928, -333.51242524393825, -1408.8654715639998, -983.0540883340392, -176.18812636022108, -1498.8299324291575, -899.7159732172847, -643.0047868056027, -667.166980153406, -1543.2481808926595, 366.36359023963445, -814.803909242139, 26.11867013038298, -249.3531464151652, -1516.0720594255486, -27.109588377270683, -1298.882762278051, -1415.3162824433264, 280.17839387974425, -1020.6182489663404, 26.775973746301045, 101.46006129966462, -1238.176425022391, -526.6120453233028, -133.80020649057985, -1069.5448101818906, -246.6904408246065, -661.8511320433048, -493.4599152532976, -1192.6538288348224, -571.2551517416451, -1032.135035564477, -818.9017614017695, -95.3463621090558, -1277.183694436098, -1309.187158959266, -1446.3277653087328, -388.3409113084124, -871.6448459839561, -1197.5860871913312, -323.1111330338219, -1399.9406903661595, -159.24436969595553, -1294.984385212365, -1485.7770031413406, -749.7047274677468, -1412.9159306477832, -1491.9830154194874, -1280.0206640891197, -713.8321290359341, -183.1602485834001, -1207.0679278324183, -1350.1841978062923, -1184.5428996853452, -1233.5818853055405, -941.4574020588225, -1120.2675070273285, -1099.4833479744009, -1507.0461877549183, -1054.9225311915186, -918.5668991558845, -1324.092856481583, -675.66810785267, -1194.389012016887, -541.7671418057956, 157.8155338417941, -1224.6127736785475, 89.1183151378336, -894.0340800476391, -1357.713207762419, -951.6763724638597, -1330.7020183196496, 309.1966261785147, -1414.1144537850812, -1230.9180262265122, -952.2817661898017, -765.8077650812871, -1679.7985123543242, -1077.759850348556, -1314.6879721313371, -814.9750158333999, -1459.0555544784393, -1390.3988214047436, -1569.8962212311826, -1184.567792560541, 323.8206545503112, -1277.189947872467], "policy_predator_policy_reward": [1271.7479719770827, 1169.5431269123098, 893.6987135429704, 1257.599972249315, 1263.9861728341768, 781.3095394769281, 504.30073941576507, 1479.05196798736, 1125.702599887268, 1195.495379950203, 1329.2530026182183, 1341.8526086242919, 1475.2102315838015, 1558.9527161352084, 48.917171772316856, 1034.4321557110877, 1085.6383050440425, 1075.2284134926085, 1100.319252656805, 1325.408813992948, 585.5199026227924, 434.03964316426277, 1526.4965273522637, 1098.4859143596545, 1031.1008597682476, 1455.7783652037624, 557.6038746918492, 53.52338534841784, 1155.411058729001, 661.7841283978671, 1150.734786717955, 1259.271625170217, 78.86324406564772, 45.061186121313824, 1546.0938834040646, 148.6072313883808, 1290.9317942078671, 457.98580489818585, 1198.5639309115907, 480.6112034144371, 1098.238311974418, 1368.2359072479571, 790.473005894798, 1445.1610850882396, 1478.9803132560633, 1448.5640202623201, 1453.7120391968324, 1698.9596007835728, 672.141869759697, 1176.9687598099517, 1548.5309952668651, 1359.2029178634102, 1436.9420914077123, 1508.5457377300388, 1529.2793363555481, 1275.856553986581, 1171.7207073896425, 180.2168149473803, 1291.5157465367781, 1429.3624069745872, 131.86563078890487, 1361.5856690120593, 1210.562990221898, 1246.288536090851, 1248.7836573041254, 1203.4024806591794, 1136.3841789919045, 1378.0531592799925, 1087.7339369606848, 651.4408983855274, 1308.679599788633, 1457.0480201231103, 371.8603006484873, 1169.9337301366215, 585.7570573733478, 685.7161067981182, 1495.2509469767551, 1608.7524043047104, 1416.20788055115, 1480.9010648773617, 564.0215218440984, 1375.5012371248376, 1447.7031634771788, 1171.8786888348766, 852.3784813478844, 1148.0446456371076, 1384.9450294023682, 1013.0927393079862, 1366.3360175319056, 1422.0731050345717, 1490.9168730483448, 1419.223834392142, 866.4544532519049, 1188.3079155765602, 629.421403104063, 1007.2844950896218, 1370.6435208222633, 1269.6358716988007, 1408.0666020871777, 1122.6575335562013, 1258.3234422604671, 1528.7638683626028, 1667.8810191890827, 1336.8467156586082, 1577.3907749374314, 937.2826000865128, 681.421157686706, 19.418541035327642, 693.0981179084866, 647.8102549047346, 904.587700239234, 527.4655932241076, 410.33202184947663, 1208.3745803019688, 1202.8199390308973, 1014.7134728181065, 1047.0024995755234, 322.14823696464646, 1461.0829744710743, 1107.589404199421, 1136.8178914596954, 501.6278491873949, 19.525064403256998, 1530.803616750116, 752.9565664114922, 436.75660379043893, 391.989130665422, 1517.0720594255488, 149.00577582606354, 1299.982762278051, 1416.4315863420934, 16.413099057250196, 1023.0950635977091, 400.8475234278881, 119.57044832044134, 1238.8764250223903, 558.3349011040565, 302.4672896783392, 1072.1448101818912, 481.6190830199368, 904.6047003194016, 879.5613425046431, 911.1307870731782, 1107.083387641991, 1034.529935323294, 1014.3710465642135, 177.705247364015, 1277.583694436098, 1309.187158959266, 1446.3277653087328, 1337.5810494952525, 295.13005422988954, 953.6628535272307, 1171.8480128446793, 934.7959321557585, 759.7326421142492, 1294.984385212365, 1485.7770031413406, 806.7653616913907, 1412.9159306477832, 1491.9830154194874, 1291.2206640891195, 675.5361020544788, 680.7091034536301, 1212.6470348336825, 1352.479745075539, 1185.6428996853451, 1233.5818853055405, 981.0574020588233, 1133.5675070273285, 1101.8833479744012, 1508.0461877549183, 1085.5133281817414, 918.9376595234105, 1324.092856481583, 678.9681078526701, 1187.1277782615734, 641.7456258937887, 31.687587231003445, 1225.5127736785475, 711.7811152686965, 721.6740101942348, 1310.1402826383226, 1336.236891804399, 1301.490683806814, 210.64801536553725, 1414.1144537850812, 1231.232606692323, 1393.7980666983428, 557.6450090367011, 1683.026145215189, 1091.3022724113562, 1239.0642711511791, 1255.064973428854, 1459.0555544784393, 1390.3988214047436, 1630.2747619632626, 1141.2509167337885, 81.6016963170157, 1277.189947872467]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.063834978112791, "mean_inference_ms": 5.221709665391719, "mean_action_processing_ms": 2.1903758536992437, "mean_env_wait_ms": 13.238919083040269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00890493392944336, "StateBufferConnector_ms": 0.006536245346069336, "ViewRequirementAgentConnector_ms": 0.13043606281280518}, "num_episodes": 10, "episode_return_max": 648.2112419773517, "episode_return_min": -2.256205768412604, "episode_return_mean": 177.30889429271667, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.95769902943815, "num_env_steps_trained_throughput_per_sec": 152.95769902943815, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 26613.626, "restore_workers_time_ms": 0.072, "training_step_time_ms": 26613.303, "sample_time_ms": 2546.606, "learn_time_ms": 24040.661, "learn_throughput": 166.385, "synch_weights_time_ms": 22.158}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-54-03", "timestamp": 1724383443, "time_this_iter_s": 26.185128927230835, "time_total_s": 1158.7625262737274, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b084c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1158.7625262737274, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 33.46216216216216, "ram_util_percent": 81.97567567567567}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.037917280701734, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.871512553805396, "policy_loss": -0.008366538181151979, "vf_loss": 6.8787040770999965, "vf_explained_var": 0.5694145807513484, "kl": 0.005875154653633082, "entropy": 0.6385863240749117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 41108.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.4604808035351, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.063726408014853, "policy_loss": -0.010235352994056132, "vf_loss": 7.072504930143003, "vf_explained_var": 0.7073901544803034, "kl": 0.007284029453707041, "entropy": 0.8986273993890752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 41108.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 648.2112419773517, "episode_reward_min": -2.256205768412604, "episode_reward_mean": 171.91519506157866, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1698.9596007835728, "predator_policy": 16.413099057250196}, "policy_reward_max": {"prey_policy": 366.36359023963445, "predator_policy": 1698.9596007835728}, "policy_reward_mean": {"prey_policy": -944.150039308676, "predator_policy": 1030.1076368394654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9553095426887301, 3.158514446087425, 290.333430312121, 477.7603154011425, 48.2950174935804, 292.41334351544725, 1.000000000000003, 93.91938525113599, 75.97317690733402, 342.87457792280895, 4.0000000000000036, 323.1, 30.645286857329385, 63.50846061961306, 265.5913691680511, 28.08460826717086, 153.22467643141442, 0.3999999999999999, 7.993605777301127e-15, 103.49772565319452, 0.6000000000000105, 1.0000000000000013, 26.511529840295815, 163.17723129272198, -3.552713678800501e-15, 217.47465763156302, 305.43071134199766, 10.879829651190509, 85.6, 425.70161205568087, 3.0, 325.96124679213506, 172.54275757770037, -2.1316282072803006e-14, -1.3766765505351941e-14, 257.2348653386387, 5.820737203649752, 486.9926121559581, 4.624467247336856, 0.09999999999999254, -2.256205768412604, 30.800000000000097, 224.61454732763417, 0.19999999999999574, 34.59529407536522, 3.7000000000000157, 7.993605777301127e-15, 18.054457610799133, 273.45157403402175, 532.830939209526, 648.2112419773517, 396.01820839406906, 475.1555150410667, 209.9085218459084, 170.12647302405452, 328.27397368807976, 373.44409050034784, 401.02793109017597, 143.63598425025373, 122.99618744879264, 297.7067968357615, 430.10031180555865, 221.7305096201058, 200.38993896850954, 237.52864219533, 628.8549955274334, 254.30519413870002, 197.86418492126145, 82.75888525496009, 1.865174681370263e-14, 372.7253464327645, 604.8136461467523, 135.3435142078955, -3.552713678800501e-15, 57.0606342236431, 11.200000000000017, 459.25282788877587, 7.874654270512243, 1.0999999999999948, 52.89999999999999, 3.400000000000003, 30.961557357756256, 3.299999999999999, 92.71725033267836, 190.4031210727976, 628.5393605531242, 336.9875942164388, 490.6333070312155, 0.3145804658108502, 233.35354446396096, 16.77005492366574, 364.4662566152945, -8.881784197001252e-16, 17.061664905327206, 405.42235086732677, 449.0466901365035, 20.900000000000006, 6.399999999999995, 3.0000000000000018, 168.15590111097464], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1328.8976930755296, -1341.2526086242917, -1475.0517171377141, -1555.9527161352087, -641.0440628516924, -151.9718343195909, -1309.3772839489095, -373.72911918659867, -1056.424235163232, -1321.0088139929485, 28.869542338169232, -756.0157446097812, -1526.4965273522637, -1097.4859143596545, -1434.097700798681, -958.8621389221931, -532.1363908150721, -3.0176923178562367, -1187.6762153871578, -286.64439381689914, -1146.7347867179587, -1259.271625170217, -44.363244065648026, 243.53881387868586, -1546.0938834040646, -117.96194453105132, -1289.5317942078675, -395.8773442785742, -1536.2469344575468, 122.66316929957199, -1298.0071796580864, -1140.3824312971174, -637.2483294633843, -1445.1610850882396, -1478.7803132560632, -1448.36402026232, -1453.7120391968324, -1698.9596007835728, -589.144144106503, -1156.4687598099515, -1547.930995266865, -1359.2029178634102, -1435.9420914077132, -1508.5457377300388, -1529.2793363555481, -1249.345024146285, -992.7142394621732, -196.0460515821251, -1291.5157465367781, -1429.3624069745872, -429.5229354564622, -846.4537067129413, -896.9633916361652, -1254.4574233345822, -1164.0264190675985, -1277.2798892445155, -1050.7841789919048, -1378.0531592799925, -343.11632343177854, -970.3568998587465, -1305.679599788633, -1457.0480201231103, 127.04434145722358, -1342.8771254501987, -1120.0301192411796, 21.09971264741568, -1495.2509469767551, -1608.7524043047104, -1416.20788055115, -1480.9010648773617, -458.2082398050539, -1224.0796538252412, -1158.2075096780889, -1455.553605430317, -334.2186571996185, -1179.2118576294133, -1390.1322789321446, -1003.2810225308731, -1366.3360175319056, -1421.9731050345717, -1493.1730788167574, -1419.223834392142, -859.7544532519032, -1164.2079155765605, -311.67209397729715, -1100.4192568887545, -1370.4435208222633, -1269.6358716988007, -1407.4090114371322, -1088.719830130882, -1254.6234422604705, -1528.7638683626028, -1667.8810191890827, -1336.8467156586082, -1577.3907749374314, -919.2281424757132, -478.7605196745093, 51.372394986499984, -187.3169886711003, -620.7604449325954, 142.8355638451451, -926.6776153311346, 77.31852753954965, -1300.006921296928, -333.51242524393825, -1408.8654715639998, -983.0540883340392, -176.18812636022108, -1498.8299324291575, -899.7159732172847, -643.0047868056027, -667.166980153406, -1543.2481808926595, 366.36359023963445, -814.803909242139, 26.11867013038298, -249.3531464151652, -1516.0720594255486, -27.109588377270683, -1298.882762278051, -1415.3162824433264, 280.17839387974425, -1020.6182489663404, 26.775973746301045, 101.46006129966462, -1238.176425022391, -526.6120453233028, -133.80020649057985, -1069.5448101818906, -246.6904408246065, -661.8511320433048, -493.4599152532976, -1192.6538288348224, -571.2551517416451, -1032.135035564477, -818.9017614017695, -95.3463621090558, -1277.183694436098, -1309.187158959266, -1446.3277653087328, -388.3409113084124, -871.6448459839561, -1197.5860871913312, -323.1111330338219, -1399.9406903661595, -159.24436969595553, -1294.984385212365, -1485.7770031413406, -749.7047274677468, -1412.9159306477832, -1491.9830154194874, -1280.0206640891197, -713.8321290359341, -183.1602485834001, -1207.0679278324183, -1350.1841978062923, -1184.5428996853452, -1233.5818853055405, -941.4574020588225, -1120.2675070273285, -1099.4833479744009, -1507.0461877549183, -1054.9225311915186, -918.5668991558845, -1324.092856481583, -675.66810785267, -1194.389012016887, -541.7671418057956, 157.8155338417941, -1224.6127736785475, 89.1183151378336, -894.0340800476391, -1357.713207762419, -951.6763724638597, -1330.7020183196496, 309.1966261785147, -1414.1144537850812, -1230.9180262265122, -952.2817661898017, -765.8077650812871, -1679.7985123543242, -1077.759850348556, -1314.6879721313371, -814.9750158333999, -1459.0555544784393, -1390.3988214047436, -1569.8962212311826, -1184.567792560541, 323.8206545503112, -1277.189947872467, 297.53191949359865, -420.63583289207526, -1393.673318585528, -951.6744256721375, -1237.6305448601436, -1175.994273616613, -1595.5167733816627, -1221.4653798129184, -1213.4037850766629, 62.422125815373676], "policy_predator_policy_reward": [1329.2530026182183, 1341.8526086242919, 1475.2102315838015, 1558.9527161352084, 48.917171772316856, 1034.4321557110877, 1085.6383050440425, 1075.2284134926085, 1100.319252656805, 1325.408813992948, 585.5199026227924, 434.03964316426277, 1526.4965273522637, 1098.4859143596545, 1031.1008597682476, 1455.7783652037624, 557.6038746918492, 53.52338534841784, 1155.411058729001, 661.7841283978671, 1150.734786717955, 1259.271625170217, 78.86324406564772, 45.061186121313824, 1546.0938834040646, 148.6072313883808, 1290.9317942078671, 457.98580489818585, 1198.5639309115907, 480.6112034144371, 1098.238311974418, 1368.2359072479571, 790.473005894798, 1445.1610850882396, 1478.9803132560633, 1448.5640202623201, 1453.7120391968324, 1698.9596007835728, 672.141869759697, 1176.9687598099517, 1548.5309952668651, 1359.2029178634102, 1436.9420914077123, 1508.5457377300388, 1529.2793363555481, 1275.856553986581, 1171.7207073896425, 180.2168149473803, 1291.5157465367781, 1429.3624069745872, 131.86563078890487, 1361.5856690120593, 1210.562990221898, 1246.288536090851, 1248.7836573041254, 1203.4024806591794, 1136.3841789919045, 1378.0531592799925, 1087.7339369606848, 651.4408983855274, 1308.679599788633, 1457.0480201231103, 371.8603006484873, 1169.9337301366215, 585.7570573733478, 685.7161067981182, 1495.2509469767551, 1608.7524043047104, 1416.20788055115, 1480.9010648773617, 564.0215218440984, 1375.5012371248376, 1447.7031634771788, 1171.8786888348766, 852.3784813478844, 1148.0446456371076, 1384.9450294023682, 1013.0927393079862, 1366.3360175319056, 1422.0731050345717, 1490.9168730483448, 1419.223834392142, 866.4544532519049, 1188.3079155765602, 629.421403104063, 1007.2844950896218, 1370.6435208222633, 1269.6358716988007, 1408.0666020871777, 1122.6575335562013, 1258.3234422604671, 1528.7638683626028, 1667.8810191890827, 1336.8467156586082, 1577.3907749374314, 937.2826000865128, 681.421157686706, 19.418541035327642, 693.0981179084866, 647.8102549047346, 904.587700239234, 527.4655932241076, 410.33202184947663, 1208.3745803019688, 1202.8199390308973, 1014.7134728181065, 1047.0024995755234, 322.14823696464646, 1461.0829744710743, 1107.589404199421, 1136.8178914596954, 501.6278491873949, 19.525064403256998, 1530.803616750116, 752.9565664114922, 436.75660379043893, 391.989130665422, 1517.0720594255488, 149.00577582606354, 1299.982762278051, 1416.4315863420934, 16.413099057250196, 1023.0950635977091, 400.8475234278881, 119.57044832044134, 1238.8764250223903, 558.3349011040565, 302.4672896783392, 1072.1448101818912, 481.6190830199368, 904.6047003194016, 879.5613425046431, 911.1307870731782, 1107.083387641991, 1034.529935323294, 1014.3710465642135, 177.705247364015, 1277.583694436098, 1309.187158959266, 1446.3277653087328, 1337.5810494952525, 295.13005422988954, 953.6628535272307, 1171.8480128446793, 934.7959321557585, 759.7326421142492, 1294.984385212365, 1485.7770031413406, 806.7653616913907, 1412.9159306477832, 1491.9830154194874, 1291.2206640891195, 675.5361020544788, 680.7091034536301, 1212.6470348336825, 1352.479745075539, 1185.6428996853451, 1233.5818853055405, 981.0574020588233, 1133.5675070273285, 1101.8833479744012, 1508.0461877549183, 1085.5133281817414, 918.9376595234105, 1324.092856481583, 678.9681078526701, 1187.1277782615734, 641.7456258937887, 31.687587231003445, 1225.5127736785475, 711.7811152686965, 721.6740101942348, 1310.1402826383226, 1336.236891804399, 1301.490683806814, 210.64801536553725, 1414.1144537850812, 1231.232606692323, 1393.7980666983428, 557.6450090367011, 1683.026145215189, 1091.3022724113562, 1239.0642711511791, 1255.064973428854, 1459.0555544784393, 1390.3988214047436, 1630.2747619632626, 1141.2509167337885, 81.6016963170157, 1277.189947872467, 48.08837406800152, 524.0622294669797, 1393.673318585528, 972.5744256721379, 1243.230544860145, 1176.794273616613, 1595.5167733816627, 1224.4653798129186, 993.426960682017, 325.7105996902478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.058734020540726, "mean_inference_ms": 5.1875469547383455, "mean_action_processing_ms": 2.198526215867355, "mean_env_wait_ms": 13.219475911326532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008892655372619629, "StateBufferConnector_ms": 0.006470799446105957, "ViewRequirementAgentConnector_ms": 0.11146879196166992}, "num_episodes": 5, "episode_return_max": 648.2112419773517, "episode_return_min": -2.256205768412604, "episode_return_mean": 171.91519506157866, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.52672949953373, "num_env_steps_trained_throughput_per_sec": 153.52672949953373, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 26490.574, "restore_workers_time_ms": 0.073, "training_step_time_ms": 26490.332, "sample_time_ms": 2439.94, "learn_time_ms": 24025.014, "learn_throughput": 166.493, "synch_weights_time_ms": 22.029}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-54-29", "timestamp": 1724383469, "time_this_iter_s": 26.09450387954712, "time_total_s": 1184.8570301532745, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309568b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1184.8570301532745, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 34.36756756756757, "ram_util_percent": 81.24594594594596}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.959623801519, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.677283195717625, "policy_loss": -0.00748196199718646, "vf_loss": 6.683545351785327, "vf_explained_var": 0.5111741998208263, "kl": 0.006099233959885265, "entropy": 0.6649873807947472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42053.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.56003911280758, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.897711331503732, "policy_loss": -0.01135504992269768, "vf_loss": 6.907416610616855, "vf_explained_var": 0.6181826691778879, "kl": 0.008248859498324611, "entropy": 0.8610605852313773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42053.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 648.2112419773517, "episode_reward_min": -2.256205768412604, "episode_reward_mean": 176.7736090335062, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1698.9596007835728, "predator_policy": 16.413099057250196}, "policy_reward_max": {"prey_policy": 366.36359023963445, "predator_policy": 1698.9596007835728}, "policy_reward_mean": {"prey_policy": -905.1903210763547, "predator_policy": 993.5771255931081}, "custom_metrics": {}, "hist_stats": {"episode_reward": [323.1, 30.645286857329385, 63.50846061961306, 265.5913691680511, 28.08460826717086, 153.22467643141442, 0.3999999999999999, 7.993605777301127e-15, 103.49772565319452, 0.6000000000000105, 1.0000000000000013, 26.511529840295815, 163.17723129272198, -3.552713678800501e-15, 217.47465763156302, 305.43071134199766, 10.879829651190509, 85.6, 425.70161205568087, 3.0, 325.96124679213506, 172.54275757770037, -2.1316282072803006e-14, -1.3766765505351941e-14, 257.2348653386387, 5.820737203649752, 486.9926121559581, 4.624467247336856, 0.09999999999999254, -2.256205768412604, 30.800000000000097, 224.61454732763417, 0.19999999999999574, 34.59529407536522, 3.7000000000000157, 7.993605777301127e-15, 18.054457610799133, 273.45157403402175, 532.830939209526, 648.2112419773517, 396.01820839406906, 475.1555150410667, 209.9085218459084, 170.12647302405452, 328.27397368807976, 373.44409050034784, 401.02793109017597, 143.63598425025373, 122.99618744879264, 297.7067968357615, 430.10031180555865, 221.7305096201058, 200.38993896850954, 237.52864219533, 628.8549955274334, 254.30519413870002, 197.86418492126145, 82.75888525496009, 1.865174681370263e-14, 372.7253464327645, 604.8136461467523, 135.3435142078955, -3.552713678800501e-15, 57.0606342236431, 11.200000000000017, 459.25282788877587, 7.874654270512243, 1.0999999999999948, 52.89999999999999, 3.400000000000003, 30.961557357756256, 3.299999999999999, 92.71725033267836, 190.4031210727976, 628.5393605531242, 336.9875942164388, 490.6333070312155, 0.3145804658108502, 233.35354446396096, 16.77005492366574, 364.4662566152945, -8.881784197001252e-16, 17.061664905327206, 405.42235086732677, 449.0466901365035, 20.900000000000006, 6.399999999999995, 3.0000000000000018, 168.15590111097464, 95.09413592438813, 106.52140402482414, 220.05546726114295, 1.7000000000000028, 320.7635021488285, 395.50343099314483, 498.30750071032537, 3.9999999999999982, 71.15030445899706, 241.0463207980684, 162.38240166538873], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-44.363244065648026, 243.53881387868586, -1546.0938834040646, -117.96194453105132, -1289.5317942078675, -395.8773442785742, -1536.2469344575468, 122.66316929957199, -1298.0071796580864, -1140.3824312971174, -637.2483294633843, -1445.1610850882396, -1478.7803132560632, -1448.36402026232, -1453.7120391968324, -1698.9596007835728, -589.144144106503, -1156.4687598099515, -1547.930995266865, -1359.2029178634102, -1435.9420914077132, -1508.5457377300388, -1529.2793363555481, -1249.345024146285, -992.7142394621732, -196.0460515821251, -1291.5157465367781, -1429.3624069745872, -429.5229354564622, -846.4537067129413, -896.9633916361652, -1254.4574233345822, -1164.0264190675985, -1277.2798892445155, -1050.7841789919048, -1378.0531592799925, -343.11632343177854, -970.3568998587465, -1305.679599788633, -1457.0480201231103, 127.04434145722358, -1342.8771254501987, -1120.0301192411796, 21.09971264741568, -1495.2509469767551, -1608.7524043047104, -1416.20788055115, -1480.9010648773617, -458.2082398050539, -1224.0796538252412, -1158.2075096780889, -1455.553605430317, -334.2186571996185, -1179.2118576294133, -1390.1322789321446, -1003.2810225308731, -1366.3360175319056, -1421.9731050345717, -1493.1730788167574, -1419.223834392142, -859.7544532519032, -1164.2079155765605, -311.67209397729715, -1100.4192568887545, -1370.4435208222633, -1269.6358716988007, -1407.4090114371322, -1088.719830130882, -1254.6234422604705, -1528.7638683626028, -1667.8810191890827, -1336.8467156586082, -1577.3907749374314, -919.2281424757132, -478.7605196745093, 51.372394986499984, -187.3169886711003, -620.7604449325954, 142.8355638451451, -926.6776153311346, 77.31852753954965, -1300.006921296928, -333.51242524393825, -1408.8654715639998, -983.0540883340392, -176.18812636022108, -1498.8299324291575, -899.7159732172847, -643.0047868056027, -667.166980153406, -1543.2481808926595, 366.36359023963445, -814.803909242139, 26.11867013038298, -249.3531464151652, -1516.0720594255486, -27.109588377270683, -1298.882762278051, -1415.3162824433264, 280.17839387974425, -1020.6182489663404, 26.775973746301045, 101.46006129966462, -1238.176425022391, -526.6120453233028, -133.80020649057985, -1069.5448101818906, -246.6904408246065, -661.8511320433048, -493.4599152532976, -1192.6538288348224, -571.2551517416451, -1032.135035564477, -818.9017614017695, -95.3463621090558, -1277.183694436098, -1309.187158959266, -1446.3277653087328, -388.3409113084124, -871.6448459839561, -1197.5860871913312, -323.1111330338219, -1399.9406903661595, -159.24436969595553, -1294.984385212365, -1485.7770031413406, -749.7047274677468, -1412.9159306477832, -1491.9830154194874, -1280.0206640891197, -713.8321290359341, -183.1602485834001, -1207.0679278324183, -1350.1841978062923, -1184.5428996853452, -1233.5818853055405, -941.4574020588225, -1120.2675070273285, -1099.4833479744009, -1507.0461877549183, -1054.9225311915186, -918.5668991558845, -1324.092856481583, -675.66810785267, -1194.389012016887, -541.7671418057956, 157.8155338417941, -1224.6127736785475, 89.1183151378336, -894.0340800476391, -1357.713207762419, -951.6763724638597, -1330.7020183196496, 309.1966261785147, -1414.1144537850812, -1230.9180262265122, -952.2817661898017, -765.8077650812871, -1679.7985123543242, -1077.759850348556, -1314.6879721313371, -814.9750158333999, -1459.0555544784393, -1390.3988214047436, -1569.8962212311826, -1184.567792560541, 323.8206545503112, -1277.189947872467, 297.53191949359865, -420.63583289207526, -1393.673318585528, -951.6744256721375, -1237.6305448601436, -1175.994273616613, -1595.5167733816627, -1221.4653798129184, -1213.4037850766629, 62.422125815373676, -1149.1894867941069, -744.5595149183387, -183.6318022321888, -523.8663191214952, -427.2499676893556, -302.4078242636816, -1438.0081066749885, -1409.0821628312203, 203.373424585289, -351.4333984567803, 300.72817710355906, -1350.0781510030974, 25.85768577399905, -54.603906118638236, -1208.1685651861476, -1447.1547631863798, -1122.5739868492942, -406.1395272620834, -786.4806942936385, 8.230133049332524, -310.26351986054317, -245.63374967121797], "policy_predator_policy_reward": [78.86324406564772, 45.061186121313824, 1546.0938834040646, 148.6072313883808, 1290.9317942078671, 457.98580489818585, 1198.5639309115907, 480.6112034144371, 1098.238311974418, 1368.2359072479571, 790.473005894798, 1445.1610850882396, 1478.9803132560633, 1448.5640202623201, 1453.7120391968324, 1698.9596007835728, 672.141869759697, 1176.9687598099517, 1548.5309952668651, 1359.2029178634102, 1436.9420914077123, 1508.5457377300388, 1529.2793363555481, 1275.856553986581, 1171.7207073896425, 180.2168149473803, 1291.5157465367781, 1429.3624069745872, 131.86563078890487, 1361.5856690120593, 1210.562990221898, 1246.288536090851, 1248.7836573041254, 1203.4024806591794, 1136.3841789919045, 1378.0531592799925, 1087.7339369606848, 651.4408983855274, 1308.679599788633, 1457.0480201231103, 371.8603006484873, 1169.9337301366215, 585.7570573733478, 685.7161067981182, 1495.2509469767551, 1608.7524043047104, 1416.20788055115, 1480.9010648773617, 564.0215218440984, 1375.5012371248376, 1447.7031634771788, 1171.8786888348766, 852.3784813478844, 1148.0446456371076, 1384.9450294023682, 1013.0927393079862, 1366.3360175319056, 1422.0731050345717, 1490.9168730483448, 1419.223834392142, 866.4544532519049, 1188.3079155765602, 629.421403104063, 1007.2844950896218, 1370.6435208222633, 1269.6358716988007, 1408.0666020871777, 1122.6575335562013, 1258.3234422604671, 1528.7638683626028, 1667.8810191890827, 1336.8467156586082, 1577.3907749374314, 937.2826000865128, 681.421157686706, 19.418541035327642, 693.0981179084866, 647.8102549047346, 904.587700239234, 527.4655932241076, 410.33202184947663, 1208.3745803019688, 1202.8199390308973, 1014.7134728181065, 1047.0024995755234, 322.14823696464646, 1461.0829744710743, 1107.589404199421, 1136.8178914596954, 501.6278491873949, 19.525064403256998, 1530.803616750116, 752.9565664114922, 436.75660379043893, 391.989130665422, 1517.0720594255488, 149.00577582606354, 1299.982762278051, 1416.4315863420934, 16.413099057250196, 1023.0950635977091, 400.8475234278881, 119.57044832044134, 1238.8764250223903, 558.3349011040565, 302.4672896783392, 1072.1448101818912, 481.6190830199368, 904.6047003194016, 879.5613425046431, 911.1307870731782, 1107.083387641991, 1034.529935323294, 1014.3710465642135, 177.705247364015, 1277.583694436098, 1309.187158959266, 1446.3277653087328, 1337.5810494952525, 295.13005422988954, 953.6628535272307, 1171.8480128446793, 934.7959321557585, 759.7326421142492, 1294.984385212365, 1485.7770031413406, 806.7653616913907, 1412.9159306477832, 1491.9830154194874, 1291.2206640891195, 675.5361020544788, 680.7091034536301, 1212.6470348336825, 1352.479745075539, 1185.6428996853451, 1233.5818853055405, 981.0574020588233, 1133.5675070273285, 1101.8833479744012, 1508.0461877549183, 1085.5133281817414, 918.9376595234105, 1324.092856481583, 678.9681078526701, 1187.1277782615734, 641.7456258937887, 31.687587231003445, 1225.5127736785475, 711.7811152686965, 721.6740101942348, 1310.1402826383226, 1336.236891804399, 1301.490683806814, 210.64801536553725, 1414.1144537850812, 1231.232606692323, 1393.7980666983428, 557.6450090367011, 1683.026145215189, 1091.3022724113562, 1239.0642711511791, 1255.064973428854, 1459.0555544784393, 1390.3988214047436, 1630.2747619632626, 1141.2509167337885, 81.6016963170157, 1277.189947872467, 48.08837406800152, 524.0622294669797, 1393.673318585528, 972.5744256721379, 1243.230544860145, 1176.794273616613, 1595.5167733816627, 1224.4653798129186, 993.426960682017, 325.7105996902478, 827.5965331386755, 1161.2466044981581, 47.93202743813271, 766.0874979403719, 445.9499676893566, 503.76329152482487, 1438.0081066749885, 1410.7821628312204, 311.4788614020069, 157.34461461831722, 83.27525388958583, 1361.5781510030974, 214.00008564973388, 313.0536354052289, 1208.1685651861476, 1451.1547631863798, 1122.5739868492942, 477.2898317210801, 529.979821466058, 489.31706057631646, 235.4821384302055, 482.797532766944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.019685369510399, "mean_inference_ms": 5.185026054885629, "mean_action_processing_ms": 2.175578253403166, "mean_env_wait_ms": 13.212123969443764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010484695434570312, "StateBufferConnector_ms": 0.007256031036376953, "ViewRequirementAgentConnector_ms": 0.12186765670776367}, "num_episodes": 11, "episode_return_max": 648.2112419773517, "episode_return_min": -2.256205768412604, "episode_return_mean": 176.7736090335062, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.39575491925495, "num_env_steps_trained_throughput_per_sec": 153.39575491925495, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 26348.095, "restore_workers_time_ms": 0.042, "training_step_time_ms": 26347.91, "sample_time_ms": 2347.815, "learn_time_ms": 23976.289, "learn_throughput": 166.831, "synch_weights_time_ms": 19.759}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-54-55", "timestamp": 1724383495, "time_this_iter_s": 26.10316801071167, "time_total_s": 1210.9601981639862, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095d19d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1210.9601981639862, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 34.61891891891893, "ram_util_percent": 82.29459459459461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.038701440669872, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1377277157294055, "policy_loss": -0.006833688358938883, "vf_loss": 7.143203135394545, "vf_explained_var": 0.5430935385996702, "kl": 0.006791381586081885, "entropy": 0.6696706846908287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42998.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.87678484563474, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.9786036824423165, "policy_loss": -0.009098474229513496, "vf_loss": 6.985908505273244, "vf_explained_var": 0.6301142465500604, "kl": 0.008968105498287414, "entropy": 0.8934520609795101, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42998.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 648.2112419773517, "episode_reward_min": -2.256205768412604, "episode_reward_mean": 173.8277522231783, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1679.7985123543242, "predator_policy": 16.413099057250196}, "policy_reward_max": {"prey_policy": 366.36359023963445, "predator_policy": 1683.026145215189}, "policy_reward_mean": {"prey_policy": -908.1272233497523, "predator_policy": 995.0410994613418}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6000000000000105, 1.0000000000000013, 26.511529840295815, 163.17723129272198, -3.552713678800501e-15, 217.47465763156302, 305.43071134199766, 10.879829651190509, 85.6, 425.70161205568087, 3.0, 325.96124679213506, 172.54275757770037, -2.1316282072803006e-14, -1.3766765505351941e-14, 257.2348653386387, 5.820737203649752, 486.9926121559581, 4.624467247336856, 0.09999999999999254, -2.256205768412604, 30.800000000000097, 224.61454732763417, 0.19999999999999574, 34.59529407536522, 3.7000000000000157, 7.993605777301127e-15, 18.054457610799133, 273.45157403402175, 532.830939209526, 648.2112419773517, 396.01820839406906, 475.1555150410667, 209.9085218459084, 170.12647302405452, 328.27397368807976, 373.44409050034784, 401.02793109017597, 143.63598425025373, 122.99618744879264, 297.7067968357615, 430.10031180555865, 221.7305096201058, 200.38993896850954, 237.52864219533, 628.8549955274334, 254.30519413870002, 197.86418492126145, 82.75888525496009, 1.865174681370263e-14, 372.7253464327645, 604.8136461467523, 135.3435142078955, -3.552713678800501e-15, 57.0606342236431, 11.200000000000017, 459.25282788877587, 7.874654270512243, 1.0999999999999948, 52.89999999999999, 3.400000000000003, 30.961557357756256, 3.299999999999999, 92.71725033267836, 190.4031210727976, 628.5393605531242, 336.9875942164388, 490.6333070312155, 0.3145804658108502, 233.35354446396096, 16.77005492366574, 364.4662566152945, -8.881784197001252e-16, 17.061664905327206, 405.42235086732677, 449.0466901365035, 20.900000000000006, 6.399999999999995, 3.0000000000000018, 168.15590111097464, 95.09413592438813, 106.52140402482414, 220.05546726114295, 1.7000000000000028, 320.7635021488285, 395.50343099314483, 498.30750071032537, 3.9999999999999982, 71.15030445899706, 241.0463207980684, 162.38240166538873, 107.11300778725683, 13.39999999999996, 0.09269328950713884, 12.26545686486699, 3.6921892474754707, 183.26206818350937, 120.86631890370995, 94.6804501418624, 138.09426154578986], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1547.930995266865, -1359.2029178634102, -1435.9420914077132, -1508.5457377300388, -1529.2793363555481, -1249.345024146285, -992.7142394621732, -196.0460515821251, -1291.5157465367781, -1429.3624069745872, -429.5229354564622, -846.4537067129413, -896.9633916361652, -1254.4574233345822, -1164.0264190675985, -1277.2798892445155, -1050.7841789919048, -1378.0531592799925, -343.11632343177854, -970.3568998587465, -1305.679599788633, -1457.0480201231103, 127.04434145722358, -1342.8771254501987, -1120.0301192411796, 21.09971264741568, -1495.2509469767551, -1608.7524043047104, -1416.20788055115, -1480.9010648773617, -458.2082398050539, -1224.0796538252412, -1158.2075096780889, -1455.553605430317, -334.2186571996185, -1179.2118576294133, -1390.1322789321446, -1003.2810225308731, -1366.3360175319056, -1421.9731050345717, -1493.1730788167574, -1419.223834392142, -859.7544532519032, -1164.2079155765605, -311.67209397729715, -1100.4192568887545, -1370.4435208222633, -1269.6358716988007, -1407.4090114371322, -1088.719830130882, -1254.6234422604705, -1528.7638683626028, -1667.8810191890827, -1336.8467156586082, -1577.3907749374314, -919.2281424757132, -478.7605196745093, 51.372394986499984, -187.3169886711003, -620.7604449325954, 142.8355638451451, -926.6776153311346, 77.31852753954965, -1300.006921296928, -333.51242524393825, -1408.8654715639998, -983.0540883340392, -176.18812636022108, -1498.8299324291575, -899.7159732172847, -643.0047868056027, -667.166980153406, -1543.2481808926595, 366.36359023963445, -814.803909242139, 26.11867013038298, -249.3531464151652, -1516.0720594255486, -27.109588377270683, -1298.882762278051, -1415.3162824433264, 280.17839387974425, -1020.6182489663404, 26.775973746301045, 101.46006129966462, -1238.176425022391, -526.6120453233028, -133.80020649057985, -1069.5448101818906, -246.6904408246065, -661.8511320433048, -493.4599152532976, -1192.6538288348224, -571.2551517416451, -1032.135035564477, -818.9017614017695, -95.3463621090558, -1277.183694436098, -1309.187158959266, -1446.3277653087328, -388.3409113084124, -871.6448459839561, -1197.5860871913312, -323.1111330338219, -1399.9406903661595, -159.24436969595553, -1294.984385212365, -1485.7770031413406, -749.7047274677468, -1412.9159306477832, -1491.9830154194874, -1280.0206640891197, -713.8321290359341, -183.1602485834001, -1207.0679278324183, -1350.1841978062923, -1184.5428996853452, -1233.5818853055405, -941.4574020588225, -1120.2675070273285, -1099.4833479744009, -1507.0461877549183, -1054.9225311915186, -918.5668991558845, -1324.092856481583, -675.66810785267, -1194.389012016887, -541.7671418057956, 157.8155338417941, -1224.6127736785475, 89.1183151378336, -894.0340800476391, -1357.713207762419, -951.6763724638597, -1330.7020183196496, 309.1966261785147, -1414.1144537850812, -1230.9180262265122, -952.2817661898017, -765.8077650812871, -1679.7985123543242, -1077.759850348556, -1314.6879721313371, -814.9750158333999, -1459.0555544784393, -1390.3988214047436, -1569.8962212311826, -1184.567792560541, 323.8206545503112, -1277.189947872467, 297.53191949359865, -420.63583289207526, -1393.673318585528, -951.6744256721375, -1237.6305448601436, -1175.994273616613, -1595.5167733816627, -1221.4653798129184, -1213.4037850766629, 62.422125815373676, -1149.1894867941069, -744.5595149183387, -183.6318022321888, -523.8663191214952, -427.2499676893556, -302.4078242636816, -1438.0081066749885, -1409.0821628312203, 203.373424585289, -351.4333984567803, 300.72817710355906, -1350.0781510030974, 25.85768577399905, -54.603906118638236, -1208.1685651861476, -1447.1547631863798, -1122.5739868492942, -406.1395272620834, -786.4806942936385, 8.230133049332524, -310.26351986054317, -245.63374967121797, -609.3491058978492, -1349.713281582856, -1605.0841886121111, -905.3665446522201, -1356.768409557298, -1531.657490147435, -1299.781451053042, -560.4112353190066, -1176.3407591490554, -974.6802678155243, -1265.1707747010505, -638.951922684633, -826.9066294325365, -1023.1568080491031, -1333.6247330826225, -634.4938891367808, 33.32223941805211, -439.34626791301014], "policy_predator_policy_reward": [1548.5309952668651, 1359.2029178634102, 1436.9420914077123, 1508.5457377300388, 1529.2793363555481, 1275.856553986581, 1171.7207073896425, 180.2168149473803, 1291.5157465367781, 1429.3624069745872, 131.86563078890487, 1361.5856690120593, 1210.562990221898, 1246.288536090851, 1248.7836573041254, 1203.4024806591794, 1136.3841789919045, 1378.0531592799925, 1087.7339369606848, 651.4408983855274, 1308.679599788633, 1457.0480201231103, 371.8603006484873, 1169.9337301366215, 585.7570573733478, 685.7161067981182, 1495.2509469767551, 1608.7524043047104, 1416.20788055115, 1480.9010648773617, 564.0215218440984, 1375.5012371248376, 1447.7031634771788, 1171.8786888348766, 852.3784813478844, 1148.0446456371076, 1384.9450294023682, 1013.0927393079862, 1366.3360175319056, 1422.0731050345717, 1490.9168730483448, 1419.223834392142, 866.4544532519049, 1188.3079155765602, 629.421403104063, 1007.2844950896218, 1370.6435208222633, 1269.6358716988007, 1408.0666020871777, 1122.6575335562013, 1258.3234422604671, 1528.7638683626028, 1667.8810191890827, 1336.8467156586082, 1577.3907749374314, 937.2826000865128, 681.421157686706, 19.418541035327642, 693.0981179084866, 647.8102549047346, 904.587700239234, 527.4655932241076, 410.33202184947663, 1208.3745803019688, 1202.8199390308973, 1014.7134728181065, 1047.0024995755234, 322.14823696464646, 1461.0829744710743, 1107.589404199421, 1136.8178914596954, 501.6278491873949, 19.525064403256998, 1530.803616750116, 752.9565664114922, 436.75660379043893, 391.989130665422, 1517.0720594255488, 149.00577582606354, 1299.982762278051, 1416.4315863420934, 16.413099057250196, 1023.0950635977091, 400.8475234278881, 119.57044832044134, 1238.8764250223903, 558.3349011040565, 302.4672896783392, 1072.1448101818912, 481.6190830199368, 904.6047003194016, 879.5613425046431, 911.1307870731782, 1107.083387641991, 1034.529935323294, 1014.3710465642135, 177.705247364015, 1277.583694436098, 1309.187158959266, 1446.3277653087328, 1337.5810494952525, 295.13005422988954, 953.6628535272307, 1171.8480128446793, 934.7959321557585, 759.7326421142492, 1294.984385212365, 1485.7770031413406, 806.7653616913907, 1412.9159306477832, 1491.9830154194874, 1291.2206640891195, 675.5361020544788, 680.7091034536301, 1212.6470348336825, 1352.479745075539, 1185.6428996853451, 1233.5818853055405, 981.0574020588233, 1133.5675070273285, 1101.8833479744012, 1508.0461877549183, 1085.5133281817414, 918.9376595234105, 1324.092856481583, 678.9681078526701, 1187.1277782615734, 641.7456258937887, 31.687587231003445, 1225.5127736785475, 711.7811152686965, 721.6740101942348, 1310.1402826383226, 1336.236891804399, 1301.490683806814, 210.64801536553725, 1414.1144537850812, 1231.232606692323, 1393.7980666983428, 557.6450090367011, 1683.026145215189, 1091.3022724113562, 1239.0642711511791, 1255.064973428854, 1459.0555544784393, 1390.3988214047436, 1630.2747619632626, 1141.2509167337885, 81.6016963170157, 1277.189947872467, 48.08837406800152, 524.0622294669797, 1393.673318585528, 972.5744256721379, 1243.230544860145, 1176.794273616613, 1595.5167733816627, 1224.4653798129186, 993.426960682017, 325.7105996902478, 827.5965331386755, 1161.2466044981581, 47.93202743813271, 766.0874979403719, 445.9499676893566, 503.76329152482487, 1438.0081066749885, 1410.7821628312204, 311.4788614020069, 157.34461461831722, 83.27525388958583, 1361.5781510030974, 214.00008564973388, 313.0536354052289, 1208.1685651861476, 1451.1547631863798, 1122.5739868492942, 477.2898317210801, 529.979821466058, 489.31706057631646, 235.4821384302055, 482.797532766944, 709.2760494077605, 1356.8993458602035, 1605.0841886121111, 918.7665446522232, 1356.8611028468051, 1531.657490147435, 1299.781451053042, 572.6766921838762, 1177.7407591490542, 976.9724570630002, 1265.1707747010505, 822.2139908681428, 953.7226413606381, 1017.207115024714, 729.174339278644, 1333.6247330826225, 408.46066432846743, 135.657625712285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.992253731754684, "mean_inference_ms": 5.159721733710309, "mean_action_processing_ms": 2.1665026852811526, "mean_env_wait_ms": 13.203402976592901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010564565658569336, "StateBufferConnector_ms": 0.008133292198181152, "ViewRequirementAgentConnector_ms": 0.12579846382141113}, "num_episodes": 9, "episode_return_max": 648.2112419773517, "episode_return_min": -2.256205768412604, "episode_return_mean": 173.8277522231783, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.8961922494175, "num_env_steps_trained_throughput_per_sec": 152.8961922494175, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 26320.139, "restore_workers_time_ms": 0.041, "training_step_time_ms": 26319.956, "sample_time_ms": 2335.663, "learn_time_ms": 23960.872, "learn_throughput": 166.939, "synch_weights_time_ms": 19.75}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-55-22", "timestamp": 1724383522, "time_this_iter_s": 26.210127115249634, "time_total_s": 1237.1703252792358, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08bb0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1237.1703252792358, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 33.42894736842106, "ram_util_percent": 82.12631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.33493888214152, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.313392899023793, "policy_loss": -0.0073928908513927905, "vf_loss": 7.319475910146401, "vf_explained_var": 0.5389600498966439, "kl": 0.00654939253538571, "entropy": 0.623467085348866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 43943.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.299241312218722, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.9448614574614025, "policy_loss": -0.011105285343472604, "vf_loss": 6.954435718374908, "vf_explained_var": 0.6343485195170004, "kl": 0.00765511984641235, "entropy": 0.8443091248078322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 43943.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 648.2112419773517, "episode_reward_min": -2.256205768412604, "episode_reward_mean": 177.4730227290268, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1679.7985123543242, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 366.36359023963445, "predator_policy": 1683.026145215189}, "policy_reward_mean": {"prey_policy": -868.4690952049856, "predator_policy": 957.2056065694993}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.879829651190509, 85.6, 425.70161205568087, 3.0, 325.96124679213506, 172.54275757770037, -2.1316282072803006e-14, -1.3766765505351941e-14, 257.2348653386387, 5.820737203649752, 486.9926121559581, 4.624467247336856, 0.09999999999999254, -2.256205768412604, 30.800000000000097, 224.61454732763417, 0.19999999999999574, 34.59529407536522, 3.7000000000000157, 7.993605777301127e-15, 18.054457610799133, 273.45157403402175, 532.830939209526, 648.2112419773517, 396.01820839406906, 475.1555150410667, 209.9085218459084, 170.12647302405452, 328.27397368807976, 373.44409050034784, 401.02793109017597, 143.63598425025373, 122.99618744879264, 297.7067968357615, 430.10031180555865, 221.7305096201058, 200.38993896850954, 237.52864219533, 628.8549955274334, 254.30519413870002, 197.86418492126145, 82.75888525496009, 1.865174681370263e-14, 372.7253464327645, 604.8136461467523, 135.3435142078955, -3.552713678800501e-15, 57.0606342236431, 11.200000000000017, 459.25282788877587, 7.874654270512243, 1.0999999999999948, 52.89999999999999, 3.400000000000003, 30.961557357756256, 3.299999999999999, 92.71725033267836, 190.4031210727976, 628.5393605531242, 336.9875942164388, 490.6333070312155, 0.3145804658108502, 233.35354446396096, 16.77005492366574, 364.4662566152945, -8.881784197001252e-16, 17.061664905327206, 405.42235086732677, 449.0466901365035, 20.900000000000006, 6.399999999999995, 3.0000000000000018, 168.15590111097464, 95.09413592438813, 106.52140402482414, 220.05546726114295, 1.7000000000000028, 320.7635021488285, 395.50343099314483, 498.30750071032537, 3.9999999999999982, 71.15030445899706, 241.0463207980684, 162.38240166538873, 107.11300778725683, 13.39999999999996, 0.09269328950713884, 12.26545686486699, 3.6921892474754707, 183.26206818350937, 120.86631890370995, 94.6804501418624, 138.09426154578986, 189.0157770262922, 121.03245714104119, 79.99999999999973, 410.2606285435013, 37.733831410235226, 175.69644875197287, 64.98203781838806], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1164.0264190675985, -1277.2798892445155, -1050.7841789919048, -1378.0531592799925, -343.11632343177854, -970.3568998587465, -1305.679599788633, -1457.0480201231103, 127.04434145722358, -1342.8771254501987, -1120.0301192411796, 21.09971264741568, -1495.2509469767551, -1608.7524043047104, -1416.20788055115, -1480.9010648773617, -458.2082398050539, -1224.0796538252412, -1158.2075096780889, -1455.553605430317, -334.2186571996185, -1179.2118576294133, -1390.1322789321446, -1003.2810225308731, -1366.3360175319056, -1421.9731050345717, -1493.1730788167574, -1419.223834392142, -859.7544532519032, -1164.2079155765605, -311.67209397729715, -1100.4192568887545, -1370.4435208222633, -1269.6358716988007, -1407.4090114371322, -1088.719830130882, -1254.6234422604705, -1528.7638683626028, -1667.8810191890827, -1336.8467156586082, -1577.3907749374314, -919.2281424757132, -478.7605196745093, 51.372394986499984, -187.3169886711003, -620.7604449325954, 142.8355638451451, -926.6776153311346, 77.31852753954965, -1300.006921296928, -333.51242524393825, -1408.8654715639998, -983.0540883340392, -176.18812636022108, -1498.8299324291575, -899.7159732172847, -643.0047868056027, -667.166980153406, -1543.2481808926595, 366.36359023963445, -814.803909242139, 26.11867013038298, -249.3531464151652, -1516.0720594255486, -27.109588377270683, -1298.882762278051, -1415.3162824433264, 280.17839387974425, -1020.6182489663404, 26.775973746301045, 101.46006129966462, -1238.176425022391, -526.6120453233028, -133.80020649057985, -1069.5448101818906, -246.6904408246065, -661.8511320433048, -493.4599152532976, -1192.6538288348224, -571.2551517416451, -1032.135035564477, -818.9017614017695, -95.3463621090558, -1277.183694436098, -1309.187158959266, -1446.3277653087328, -388.3409113084124, -871.6448459839561, -1197.5860871913312, -323.1111330338219, -1399.9406903661595, -159.24436969595553, -1294.984385212365, -1485.7770031413406, -749.7047274677468, -1412.9159306477832, -1491.9830154194874, -1280.0206640891197, -713.8321290359341, -183.1602485834001, -1207.0679278324183, -1350.1841978062923, -1184.5428996853452, -1233.5818853055405, -941.4574020588225, -1120.2675070273285, -1099.4833479744009, -1507.0461877549183, -1054.9225311915186, -918.5668991558845, -1324.092856481583, -675.66810785267, -1194.389012016887, -541.7671418057956, 157.8155338417941, -1224.6127736785475, 89.1183151378336, -894.0340800476391, -1357.713207762419, -951.6763724638597, -1330.7020183196496, 309.1966261785147, -1414.1144537850812, -1230.9180262265122, -952.2817661898017, -765.8077650812871, -1679.7985123543242, -1077.759850348556, -1314.6879721313371, -814.9750158333999, -1459.0555544784393, -1390.3988214047436, -1569.8962212311826, -1184.567792560541, 323.8206545503112, -1277.189947872467, 297.53191949359865, -420.63583289207526, -1393.673318585528, -951.6744256721375, -1237.6305448601436, -1175.994273616613, -1595.5167733816627, -1221.4653798129184, -1213.4037850766629, 62.422125815373676, -1149.1894867941069, -744.5595149183387, -183.6318022321888, -523.8663191214952, -427.2499676893556, -302.4078242636816, -1438.0081066749885, -1409.0821628312203, 203.373424585289, -351.4333984567803, 300.72817710355906, -1350.0781510030974, 25.85768577399905, -54.603906118638236, -1208.1685651861476, -1447.1547631863798, -1122.5739868492942, -406.1395272620834, -786.4806942936385, 8.230133049332524, -310.26351986054317, -245.63374967121797, -609.3491058978492, -1349.713281582856, -1605.0841886121111, -905.3665446522201, -1356.768409557298, -1531.657490147435, -1299.781451053042, -560.4112353190066, -1176.3407591490554, -974.6802678155243, -1265.1707747010505, -638.951922684633, -826.9066294325365, -1023.1568080491031, -1333.6247330826225, -634.4938891367808, 33.32223941805211, -439.34626791301014, -1218.672702802338, -260.70077350278495, -1344.0636916439732, -150.61747555572637, 40.0000000000003, 40.0000000000003, 289.4936050703146, -657.291480255374, -690.4725912026192, -1531.419638628513, -481.7824519217412, -481.382752803718, -331.2858707724871, -1257.4605514933885], "policy_predator_policy_reward": [1248.7836573041254, 1203.4024806591794, 1136.3841789919045, 1378.0531592799925, 1087.7339369606848, 651.4408983855274, 1308.679599788633, 1457.0480201231103, 371.8603006484873, 1169.9337301366215, 585.7570573733478, 685.7161067981182, 1495.2509469767551, 1608.7524043047104, 1416.20788055115, 1480.9010648773617, 564.0215218440984, 1375.5012371248376, 1447.7031634771788, 1171.8786888348766, 852.3784813478844, 1148.0446456371076, 1384.9450294023682, 1013.0927393079862, 1366.3360175319056, 1422.0731050345717, 1490.9168730483448, 1419.223834392142, 866.4544532519049, 1188.3079155765602, 629.421403104063, 1007.2844950896218, 1370.6435208222633, 1269.6358716988007, 1408.0666020871777, 1122.6575335562013, 1258.3234422604671, 1528.7638683626028, 1667.8810191890827, 1336.8467156586082, 1577.3907749374314, 937.2826000865128, 681.421157686706, 19.418541035327642, 693.0981179084866, 647.8102549047346, 904.587700239234, 527.4655932241076, 410.33202184947663, 1208.3745803019688, 1202.8199390308973, 1014.7134728181065, 1047.0024995755234, 322.14823696464646, 1461.0829744710743, 1107.589404199421, 1136.8178914596954, 501.6278491873949, 19.525064403256998, 1530.803616750116, 752.9565664114922, 436.75660379043893, 391.989130665422, 1517.0720594255488, 149.00577582606354, 1299.982762278051, 1416.4315863420934, 16.413099057250196, 1023.0950635977091, 400.8475234278881, 119.57044832044134, 1238.8764250223903, 558.3349011040565, 302.4672896783392, 1072.1448101818912, 481.6190830199368, 904.6047003194016, 879.5613425046431, 911.1307870731782, 1107.083387641991, 1034.529935323294, 1014.3710465642135, 177.705247364015, 1277.583694436098, 1309.187158959266, 1446.3277653087328, 1337.5810494952525, 295.13005422988954, 953.6628535272307, 1171.8480128446793, 934.7959321557585, 759.7326421142492, 1294.984385212365, 1485.7770031413406, 806.7653616913907, 1412.9159306477832, 1491.9830154194874, 1291.2206640891195, 675.5361020544788, 680.7091034536301, 1212.6470348336825, 1352.479745075539, 1185.6428996853451, 1233.5818853055405, 981.0574020588233, 1133.5675070273285, 1101.8833479744012, 1508.0461877549183, 1085.5133281817414, 918.9376595234105, 1324.092856481583, 678.9681078526701, 1187.1277782615734, 641.7456258937887, 31.687587231003445, 1225.5127736785475, 711.7811152686965, 721.6740101942348, 1310.1402826383226, 1336.236891804399, 1301.490683806814, 210.64801536553725, 1414.1144537850812, 1231.232606692323, 1393.7980666983428, 557.6450090367011, 1683.026145215189, 1091.3022724113562, 1239.0642711511791, 1255.064973428854, 1459.0555544784393, 1390.3988214047436, 1630.2747619632626, 1141.2509167337885, 81.6016963170157, 1277.189947872467, 48.08837406800152, 524.0622294669797, 1393.673318585528, 972.5744256721379, 1243.230544860145, 1176.794273616613, 1595.5167733816627, 1224.4653798129186, 993.426960682017, 325.7105996902478, 827.5965331386755, 1161.2466044981581, 47.93202743813271, 766.0874979403719, 445.9499676893566, 503.76329152482487, 1438.0081066749885, 1410.7821628312204, 311.4788614020069, 157.34461461831722, 83.27525388958583, 1361.5781510030974, 214.00008564973388, 313.0536354052289, 1208.1685651861476, 1451.1547631863798, 1122.5739868492942, 477.2898317210801, 529.979821466058, 489.31706057631646, 235.4821384302055, 482.797532766944, 709.2760494077605, 1356.8993458602035, 1605.0841886121111, 918.7665446522232, 1356.8611028468051, 1531.657490147435, 1299.781451053042, 572.6766921838762, 1177.7407591490542, 976.9724570630002, 1265.1707747010505, 822.2139908681428, 953.7226413606381, 1017.207115024714, 729.174339278644, 1333.6247330826225, 408.46066432846743, 135.657625712285, 445.9226348098897, 1222.4666185215258, 1345.8636916439716, 269.849932696769, 0.0, 0.0, 658.8228773944184, 119.23562633414289, 728.2064226128565, 1531.419638628513, 890.2386350426282, 248.62301843481296, 396.2679085908774, 1257.4605514933885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.978186456300673, "mean_inference_ms": 5.149051257660984, "mean_action_processing_ms": 2.143391377326505, "mean_env_wait_ms": 13.187697257789686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01101672649383545, "StateBufferConnector_ms": 0.00830066204071045, "ViewRequirementAgentConnector_ms": 0.12409472465515137}, "num_episodes": 7, "episode_return_max": 648.2112419773517, "episode_return_min": -2.256205768412604, "episode_return_mean": 177.4730227290268, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.64068537506367, "num_env_steps_trained_throughput_per_sec": 154.64068537506367, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 26199.307, "restore_workers_time_ms": 0.042, "training_step_time_ms": 26199.117, "sample_time_ms": 2255.316, "learn_time_ms": 23920.342, "learn_throughput": 167.222, "synch_weights_time_ms": 19.718}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-55-48", "timestamp": 1724383548, "time_this_iter_s": 25.895818948745728, "time_total_s": 1263.0661442279816, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08bbca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1263.0661442279816, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 32.58888888888889, "ram_util_percent": 81.3777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.781767971805795, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.146421251347456, "policy_loss": -0.009317740665935966, "vf_loss": 7.15411376953125, "vf_explained_var": 0.48662742672773895, "kl": 0.008126130293581694, "entropy": 0.6006499558529526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44888.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.237591555761913, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.91520839065471, "policy_loss": -0.011354134775077303, "vf_loss": 6.925057800232418, "vf_explained_var": 0.5902539355414255, "kl": 0.007523620519392863, "entropy": 0.8027959649524992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44888.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 648.2112419773517, "episode_reward_min": -3.552713678800501e-15, "episode_reward_mean": 196.71365861641988, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1679.7985123543242, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.29604768994255, "predator_policy": 1683.026145215189}, "policy_reward_mean": {"prey_policy": -801.0929679230409, "predator_policy": 899.449797231251}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.59529407536522, 3.7000000000000157, 7.993605777301127e-15, 18.054457610799133, 273.45157403402175, 532.830939209526, 648.2112419773517, 396.01820839406906, 475.1555150410667, 209.9085218459084, 170.12647302405452, 328.27397368807976, 373.44409050034784, 401.02793109017597, 143.63598425025373, 122.99618744879264, 297.7067968357615, 430.10031180555865, 221.7305096201058, 200.38993896850954, 237.52864219533, 628.8549955274334, 254.30519413870002, 197.86418492126145, 82.75888525496009, 1.865174681370263e-14, 372.7253464327645, 604.8136461467523, 135.3435142078955, -3.552713678800501e-15, 57.0606342236431, 11.200000000000017, 459.25282788877587, 7.874654270512243, 1.0999999999999948, 52.89999999999999, 3.400000000000003, 30.961557357756256, 3.299999999999999, 92.71725033267836, 190.4031210727976, 628.5393605531242, 336.9875942164388, 490.6333070312155, 0.3145804658108502, 233.35354446396096, 16.77005492366574, 364.4662566152945, -8.881784197001252e-16, 17.061664905327206, 405.42235086732677, 449.0466901365035, 20.900000000000006, 6.399999999999995, 3.0000000000000018, 168.15590111097464, 95.09413592438813, 106.52140402482414, 220.05546726114295, 1.7000000000000028, 320.7635021488285, 395.50343099314483, 498.30750071032537, 3.9999999999999982, 71.15030445899706, 241.0463207980684, 162.38240166538873, 107.11300778725683, 13.39999999999996, 0.09269328950713884, 12.26545686486699, 3.6921892474754707, 183.26206818350937, 120.86631890370995, 94.6804501418624, 138.09426154578986, 189.0157770262922, 121.03245714104119, 79.99999999999973, 410.2606285435013, 37.733831410235226, 175.69644875197287, 64.98203781838806, 324.2005526769731, 109.45205223505951, 56.45764670047399, 4.440892098500626e-15, 230.80459364743302, 5.9999999999999964, 45.774699510578955, 7.70974611066295, 567.7665189938064, 20.934086051292702, 94.55993276702127, 183.47985055996412, 217.07829000837944, 396.11690079929775, 506.359813427773, 607.438733923293, 581.7466409088128], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1407.4090114371322, -1088.719830130882, -1254.6234422604705, -1528.7638683626028, -1667.8810191890827, -1336.8467156586082, -1577.3907749374314, -919.2281424757132, -478.7605196745093, 51.372394986499984, -187.3169886711003, -620.7604449325954, 142.8355638451451, -926.6776153311346, 77.31852753954965, -1300.006921296928, -333.51242524393825, -1408.8654715639998, -983.0540883340392, -176.18812636022108, -1498.8299324291575, -899.7159732172847, -643.0047868056027, -667.166980153406, -1543.2481808926595, 366.36359023963445, -814.803909242139, 26.11867013038298, -249.3531464151652, -1516.0720594255486, -27.109588377270683, -1298.882762278051, -1415.3162824433264, 280.17839387974425, -1020.6182489663404, 26.775973746301045, 101.46006129966462, -1238.176425022391, -526.6120453233028, -133.80020649057985, -1069.5448101818906, -246.6904408246065, -661.8511320433048, -493.4599152532976, -1192.6538288348224, -571.2551517416451, -1032.135035564477, -818.9017614017695, -95.3463621090558, -1277.183694436098, -1309.187158959266, -1446.3277653087328, -388.3409113084124, -871.6448459839561, -1197.5860871913312, -323.1111330338219, -1399.9406903661595, -159.24436969595553, -1294.984385212365, -1485.7770031413406, -749.7047274677468, -1412.9159306477832, -1491.9830154194874, -1280.0206640891197, -713.8321290359341, -183.1602485834001, -1207.0679278324183, -1350.1841978062923, -1184.5428996853452, -1233.5818853055405, -941.4574020588225, -1120.2675070273285, -1099.4833479744009, -1507.0461877549183, -1054.9225311915186, -918.5668991558845, -1324.092856481583, -675.66810785267, -1194.389012016887, -541.7671418057956, 157.8155338417941, -1224.6127736785475, 89.1183151378336, -894.0340800476391, -1357.713207762419, -951.6763724638597, -1330.7020183196496, 309.1966261785147, -1414.1144537850812, -1230.9180262265122, -952.2817661898017, -765.8077650812871, -1679.7985123543242, -1077.759850348556, -1314.6879721313371, -814.9750158333999, -1459.0555544784393, -1390.3988214047436, -1569.8962212311826, -1184.567792560541, 323.8206545503112, -1277.189947872467, 297.53191949359865, -420.63583289207526, -1393.673318585528, -951.6744256721375, -1237.6305448601436, -1175.994273616613, -1595.5167733816627, -1221.4653798129184, -1213.4037850766629, 62.422125815373676, -1149.1894867941069, -744.5595149183387, -183.6318022321888, -523.8663191214952, -427.2499676893556, -302.4078242636816, -1438.0081066749885, -1409.0821628312203, 203.373424585289, -351.4333984567803, 300.72817710355906, -1350.0781510030974, 25.85768577399905, -54.603906118638236, -1208.1685651861476, -1447.1547631863798, -1122.5739868492942, -406.1395272620834, -786.4806942936385, 8.230133049332524, -310.26351986054317, -245.63374967121797, -609.3491058978492, -1349.713281582856, -1605.0841886121111, -905.3665446522201, -1356.768409557298, -1531.657490147435, -1299.781451053042, -560.4112353190066, -1176.3407591490554, -974.6802678155243, -1265.1707747010505, -638.951922684633, -826.9066294325365, -1023.1568080491031, -1333.6247330826225, -634.4938891367808, 33.32223941805211, -439.34626791301014, -1218.672702802338, -260.70077350278495, -1344.0636916439732, -150.61747555572637, 40.0000000000003, 40.0000000000003, 289.4936050703146, -657.291480255374, -690.4725912026192, -1531.419638628513, -481.7824519217412, -481.382752803718, -331.2858707724871, -1257.4605514933885, -382.93934828650663, -782.2128673482133, -1288.3445789660373, -643.5319468677097, -612.0545657072427, -1104.5165198241343, -1519.6669098953491, -1136.2626360549696, -691.6637123332606, -417.3175477766007, -906.7724196811761, -1417.459339797053, -769.9452975475141, -130.90016724675547, -908.4952809660308, -1494.1561550581594, 387.29604768994255, -7.356134369390361, -1022.0675802582394, -1141.7855853853785, -229.79651598470184, -1314.9238740395476, -1354.0519854011402, -609.5071971673767, -585.3278926125354, 21.28828143069105, -706.7118475604832, -432.09663275166656, 353.97291383487254, -1023.7328230070594, 131.48482202029703, -761.6848185402866, -1264.6466145332454, -0.8397637237647047], "policy_predator_policy_reward": [1408.0666020871777, 1122.6575335562013, 1258.3234422604671, 1528.7638683626028, 1667.8810191890827, 1336.8467156586082, 1577.3907749374314, 937.2826000865128, 681.421157686706, 19.418541035327642, 693.0981179084866, 647.8102549047346, 904.587700239234, 527.4655932241076, 410.33202184947663, 1208.3745803019688, 1202.8199390308973, 1014.7134728181065, 1047.0024995755234, 322.14823696464646, 1461.0829744710743, 1107.589404199421, 1136.8178914596954, 501.6278491873949, 19.525064403256998, 1530.803616750116, 752.9565664114922, 436.75660379043893, 391.989130665422, 1517.0720594255488, 149.00577582606354, 1299.982762278051, 1416.4315863420934, 16.413099057250196, 1023.0950635977091, 400.8475234278881, 119.57044832044134, 1238.8764250223903, 558.3349011040565, 302.4672896783392, 1072.1448101818912, 481.6190830199368, 904.6047003194016, 879.5613425046431, 911.1307870731782, 1107.083387641991, 1034.529935323294, 1014.3710465642135, 177.705247364015, 1277.583694436098, 1309.187158959266, 1446.3277653087328, 1337.5810494952525, 295.13005422988954, 953.6628535272307, 1171.8480128446793, 934.7959321557585, 759.7326421142492, 1294.984385212365, 1485.7770031413406, 806.7653616913907, 1412.9159306477832, 1491.9830154194874, 1291.2206640891195, 675.5361020544788, 680.7091034536301, 1212.6470348336825, 1352.479745075539, 1185.6428996853451, 1233.5818853055405, 981.0574020588233, 1133.5675070273285, 1101.8833479744012, 1508.0461877549183, 1085.5133281817414, 918.9376595234105, 1324.092856481583, 678.9681078526701, 1187.1277782615734, 641.7456258937887, 31.687587231003445, 1225.5127736785475, 711.7811152686965, 721.6740101942348, 1310.1402826383226, 1336.236891804399, 1301.490683806814, 210.64801536553725, 1414.1144537850812, 1231.232606692323, 1393.7980666983428, 557.6450090367011, 1683.026145215189, 1091.3022724113562, 1239.0642711511791, 1255.064973428854, 1459.0555544784393, 1390.3988214047436, 1630.2747619632626, 1141.2509167337885, 81.6016963170157, 1277.189947872467, 48.08837406800152, 524.0622294669797, 1393.673318585528, 972.5744256721379, 1243.230544860145, 1176.794273616613, 1595.5167733816627, 1224.4653798129186, 993.426960682017, 325.7105996902478, 827.5965331386755, 1161.2466044981581, 47.93202743813271, 766.0874979403719, 445.9499676893566, 503.76329152482487, 1438.0081066749885, 1410.7821628312204, 311.4788614020069, 157.34461461831722, 83.27525388958583, 1361.5781510030974, 214.00008564973388, 313.0536354052289, 1208.1685651861476, 1451.1547631863798, 1122.5739868492942, 477.2898317210801, 529.979821466058, 489.31706057631646, 235.4821384302055, 482.797532766944, 709.2760494077605, 1356.8993458602035, 1605.0841886121111, 918.7665446522232, 1356.8611028468051, 1531.657490147435, 1299.781451053042, 572.6766921838762, 1177.7407591490542, 976.9724570630002, 1265.1707747010505, 822.2139908681428, 953.7226413606381, 1017.207115024714, 729.174339278644, 1333.6247330826225, 408.46066432846743, 135.657625712285, 445.9226348098897, 1222.4666185215258, 1345.8636916439716, 269.849932696769, 0.0, 0.0, 658.8228773944184, 119.23562633414289, 728.2064226128565, 1531.419638628513, 890.2386350426282, 248.62301843481296, 396.2679085908774, 1257.4605514933885, 800.6939754685002, 688.6587928431954, 1286.8225394407768, 754.5060386280323, 1199.8271143431316, 573.2016178887189, 1519.6669098953491, 1136.2626360549696, 628.5835161900335, 711.2023375672616, 912.7724196811763, 1417.459339797053, 196.403792841755, 750.2163714630934, 916.2050270766938, 1494.1561550581594, 41.32379340386871, 146.50281226938483, 1159.9722079074095, 1024.8150437875001, 462.6997830680037, 1176.580539723271, 1046.4159534303767, 1100.6230796981058, 420.906775727393, 360.21112546283075, 721.4111876114843, 813.5141934999625, 161.26263727096128, 1014.8570853289968, 701.1480119128324, 536.4907185304494, 1239.5724433377632, 607.6605758280604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.941143101396515, "mean_inference_ms": 5.104312846160741, "mean_action_processing_ms": 2.107663621347689, "mean_env_wait_ms": 13.15638029116016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010801434516906738, "StateBufferConnector_ms": 0.008522748947143555, "ViewRequirementAgentConnector_ms": 0.16769015789031982}, "num_episodes": 17, "episode_return_max": 648.2112419773517, "episode_return_min": -3.552713678800501e-15, "episode_return_mean": 196.71365861641988, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.93290162393473, "num_env_steps_trained_throughput_per_sec": 152.93290162393473, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 26184.219, "restore_workers_time_ms": 0.046, "training_step_time_ms": 26184.03, "sample_time_ms": 2249.412, "learn_time_ms": 23911.573, "learn_throughput": 167.283, "synch_weights_time_ms": 19.735}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-56-14", "timestamp": 1724383574, "time_this_iter_s": 26.200949907302856, "time_total_s": 1289.2670941352844, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095d1160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1289.2670941352844, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 33.678947368421056, "ram_util_percent": 81.36578947368419}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.817556186958594, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.257145687385842, "policy_loss": -0.0074193699068572155, "vf_loss": 7.2634741813417465, "vf_explained_var": 0.4823796916891027, "kl": 0.005454454079723705, "entropy": 0.5439135691791616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 45833.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.835685764040267, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.834788701395509, "policy_loss": -0.010712827664489548, "vf_loss": 6.844028443634195, "vf_explained_var": 0.621888821780997, "kl": 0.007365320592616049, "entropy": 0.7621188217369967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 45833.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 628.8549955274334, "episode_reward_min": -11.477256354483515, "episode_reward_mean": 181.29907728970093, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1679.7985123543242, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.29604768994255, "predator_policy": 1683.026145215189}, "policy_reward_mean": {"prey_policy": -773.2160252465436, "predator_policy": 863.8655638913945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.38993896850954, 237.52864219533, 628.8549955274334, 254.30519413870002, 197.86418492126145, 82.75888525496009, 1.865174681370263e-14, 372.7253464327645, 604.8136461467523, 135.3435142078955, -3.552713678800501e-15, 57.0606342236431, 11.200000000000017, 459.25282788877587, 7.874654270512243, 1.0999999999999948, 52.89999999999999, 3.400000000000003, 30.961557357756256, 3.299999999999999, 92.71725033267836, 190.4031210727976, 628.5393605531242, 336.9875942164388, 490.6333070312155, 0.3145804658108502, 233.35354446396096, 16.77005492366574, 364.4662566152945, -8.881784197001252e-16, 17.061664905327206, 405.42235086732677, 449.0466901365035, 20.900000000000006, 6.399999999999995, 3.0000000000000018, 168.15590111097464, 95.09413592438813, 106.52140402482414, 220.05546726114295, 1.7000000000000028, 320.7635021488285, 395.50343099314483, 498.30750071032537, 3.9999999999999982, 71.15030445899706, 241.0463207980684, 162.38240166538873, 107.11300778725683, 13.39999999999996, 0.09269328950713884, 12.26545686486699, 3.6921892474754707, 183.26206818350937, 120.86631890370995, 94.6804501418624, 138.09426154578986, 189.0157770262922, 121.03245714104119, 79.99999999999973, 410.2606285435013, 37.733831410235226, 175.69644875197287, 64.98203781838806, 324.2005526769731, 109.45205223505951, 56.45764670047399, 4.440892098500626e-15, 230.80459364743302, 5.9999999999999964, 45.774699510578955, 7.70974611066295, 567.7665189938064, 20.934086051292702, 94.55993276702127, 183.47985055996412, 217.07829000837944, 396.11690079929775, 506.359813427773, 607.438733923293, 581.7466409088128, 471.6883692681107, 176.26041662103592, 0.21821107072746226, 1.9984014443252818e-15, 245.28846200816812, 58.6094343340795, 43.23705700921394, 120.70000000000012, 367.1244151996396, 389.22227765521103, 245.56108697477868, 292.1142502654077, 316.28308553503587, 77.3865831518488, 57.93757164436414, -11.477256354483515, 192.48068346068519, 40.56283453940604, 456.31239539611215], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-526.6120453233028, -133.80020649057985, -1069.5448101818906, -246.6904408246065, -661.8511320433048, -493.4599152532976, -1192.6538288348224, -571.2551517416451, -1032.135035564477, -818.9017614017695, -95.3463621090558, -1277.183694436098, -1309.187158959266, -1446.3277653087328, -388.3409113084124, -871.6448459839561, -1197.5860871913312, -323.1111330338219, -1399.9406903661595, -159.24436969595553, -1294.984385212365, -1485.7770031413406, -749.7047274677468, -1412.9159306477832, -1491.9830154194874, -1280.0206640891197, -713.8321290359341, -183.1602485834001, -1207.0679278324183, -1350.1841978062923, -1184.5428996853452, -1233.5818853055405, -941.4574020588225, -1120.2675070273285, -1099.4833479744009, -1507.0461877549183, -1054.9225311915186, -918.5668991558845, -1324.092856481583, -675.66810785267, -1194.389012016887, -541.7671418057956, 157.8155338417941, -1224.6127736785475, 89.1183151378336, -894.0340800476391, -1357.713207762419, -951.6763724638597, -1330.7020183196496, 309.1966261785147, -1414.1144537850812, -1230.9180262265122, -952.2817661898017, -765.8077650812871, -1679.7985123543242, -1077.759850348556, -1314.6879721313371, -814.9750158333999, -1459.0555544784393, -1390.3988214047436, -1569.8962212311826, -1184.567792560541, 323.8206545503112, -1277.189947872467, 297.53191949359865, -420.63583289207526, -1393.673318585528, -951.6744256721375, -1237.6305448601436, -1175.994273616613, -1595.5167733816627, -1221.4653798129184, -1213.4037850766629, 62.422125815373676, -1149.1894867941069, -744.5595149183387, -183.6318022321888, -523.8663191214952, -427.2499676893556, -302.4078242636816, -1438.0081066749885, -1409.0821628312203, 203.373424585289, -351.4333984567803, 300.72817710355906, -1350.0781510030974, 25.85768577399905, -54.603906118638236, -1208.1685651861476, -1447.1547631863798, -1122.5739868492942, -406.1395272620834, -786.4806942936385, 8.230133049332524, -310.26351986054317, -245.63374967121797, -609.3491058978492, -1349.713281582856, -1605.0841886121111, -905.3665446522201, -1356.768409557298, -1531.657490147435, -1299.781451053042, -560.4112353190066, -1176.3407591490554, -974.6802678155243, -1265.1707747010505, -638.951922684633, -826.9066294325365, -1023.1568080491031, -1333.6247330826225, -634.4938891367808, 33.32223941805211, -439.34626791301014, -1218.672702802338, -260.70077350278495, -1344.0636916439732, -150.61747555572637, 40.0000000000003, 40.0000000000003, 289.4936050703146, -657.291480255374, -690.4725912026192, -1531.419638628513, -481.7824519217412, -481.382752803718, -331.2858707724871, -1257.4605514933885, -382.93934828650663, -782.2128673482133, -1288.3445789660373, -643.5319468677097, -612.0545657072427, -1104.5165198241343, -1519.6669098953491, -1136.2626360549696, -691.6637123332606, -417.3175477766007, -906.7724196811761, -1417.459339797053, -769.9452975475141, -130.90016724675547, -908.4952809660308, -1494.1561550581594, 387.29604768994255, -7.356134369390361, -1022.0675802582394, -1141.7855853853785, -229.79651598470184, -1314.9238740395476, -1354.0519854011402, -609.5071971673767, -585.3278926125354, 21.28828143069105, -706.7118475604832, -432.09663275166656, 353.97291383487254, -1023.7328230070594, 131.48482202029703, -761.6848185402866, -1264.6466145332454, -0.8397637237647047, -89.20581918709668, -554.5035691643174, -69.34869004319583, -996.0133554496825, -1502.4579892261233, -1226.7333168995128, -1433.3390557924984, -838.9616907051133, 97.59893557133833, -760.7235025627274, -540.054113890728, -1314.13163752533, 28.455344810272447, -1349.5664761940245, -413.1274358390593, -554.4774662798385, -238.0366226174782, -726.7710818043021, -450.71168394839265, -110.00701964763408, 52.53534625689632, -639.9531732218239, -935.6561560579547, -74.95184378480171, 83.36797820557345, -609.8724577051361, -246.14085103616154, 28.155753833319732, -30.392059259647624, -1235.7587705134497, -1362.4795494607758, -430.24501265480393, -1249.057482405456, -421.05362836706917, -741.5802377275056, -1311.8109388385974, -62.15615850016483, -1151.3264829293707], "policy_predator_policy_reward": [558.3349011040565, 302.4672896783392, 1072.1448101818912, 481.6190830199368, 904.6047003194016, 879.5613425046431, 911.1307870731782, 1107.083387641991, 1034.529935323294, 1014.3710465642135, 177.705247364015, 1277.583694436098, 1309.187158959266, 1446.3277653087328, 1337.5810494952525, 295.13005422988954, 953.6628535272307, 1171.8480128446793, 934.7959321557585, 759.7326421142492, 1294.984385212365, 1485.7770031413406, 806.7653616913907, 1412.9159306477832, 1491.9830154194874, 1291.2206640891195, 675.5361020544788, 680.7091034536301, 1212.6470348336825, 1352.479745075539, 1185.6428996853451, 1233.5818853055405, 981.0574020588233, 1133.5675070273285, 1101.8833479744012, 1508.0461877549183, 1085.5133281817414, 918.9376595234105, 1324.092856481583, 678.9681078526701, 1187.1277782615734, 641.7456258937887, 31.687587231003445, 1225.5127736785475, 711.7811152686965, 721.6740101942348, 1310.1402826383226, 1336.236891804399, 1301.490683806814, 210.64801536553725, 1414.1144537850812, 1231.232606692323, 1393.7980666983428, 557.6450090367011, 1683.026145215189, 1091.3022724113562, 1239.0642711511791, 1255.064973428854, 1459.0555544784393, 1390.3988214047436, 1630.2747619632626, 1141.2509167337885, 81.6016963170157, 1277.189947872467, 48.08837406800152, 524.0622294669797, 1393.673318585528, 972.5744256721379, 1243.230544860145, 1176.794273616613, 1595.5167733816627, 1224.4653798129186, 993.426960682017, 325.7105996902478, 827.5965331386755, 1161.2466044981581, 47.93202743813271, 766.0874979403719, 445.9499676893566, 503.76329152482487, 1438.0081066749885, 1410.7821628312204, 311.4788614020069, 157.34461461831722, 83.27525388958583, 1361.5781510030974, 214.00008564973388, 313.0536354052289, 1208.1685651861476, 1451.1547631863798, 1122.5739868492942, 477.2898317210801, 529.979821466058, 489.31706057631646, 235.4821384302055, 482.797532766944, 709.2760494077605, 1356.8993458602035, 1605.0841886121111, 918.7665446522232, 1356.8611028468051, 1531.657490147435, 1299.781451053042, 572.6766921838762, 1177.7407591490542, 976.9724570630002, 1265.1707747010505, 822.2139908681428, 953.7226413606381, 1017.207115024714, 729.174339278644, 1333.6247330826225, 408.46066432846743, 135.657625712285, 445.9226348098897, 1222.4666185215258, 1345.8636916439716, 269.849932696769, 0.0, 0.0, 658.8228773944184, 119.23562633414289, 728.2064226128565, 1531.419638628513, 890.2386350426282, 248.62301843481296, 396.2679085908774, 1257.4605514933885, 800.6939754685002, 688.6587928431954, 1286.8225394407768, 754.5060386280323, 1199.8271143431316, 573.2016178887189, 1519.6669098953491, 1136.2626360549696, 628.5835161900335, 711.2023375672616, 912.7724196811763, 1417.459339797053, 196.403792841755, 750.2163714630934, 916.2050270766938, 1494.1561550581594, 41.32379340386871, 146.50281226938483, 1159.9722079074095, 1024.8150437875001, 462.6997830680037, 1176.580539723271, 1046.4159534303767, 1100.6230796981058, 420.906775727393, 360.21112546283075, 721.4111876114843, 813.5141934999625, 161.26263727096128, 1014.8570853289968, 701.1480119128324, 536.4907185304494, 1239.5724433377632, 607.6605758280604, 582.7552429571897, 532.6425146623351, 295.45278694615473, 946.1696751677588, 1401.0335200348968, 1328.375997161466, 1433.3390557924984, 838.9616907051133, 124.48952643683026, 783.9235025627273, 633.4704405929757, 1279.3247451571613, 14.781712198941287, 1349.5664761940245, 461.82743583905943, 626.4774662798396, 556.3472124051109, 775.58490721631, 215.378318261056, 734.5626629901827, 198.6911039263879, 634.287810013319, 687.8330973748343, 614.8891527333317, 131.06962024561287, 711.7179447889866, 229.10744008321862, 66.2642402714724, 1235.7587705134497, 88.32963090401162, 1411.8851419682837, 369.3621637928118, 1190.6517713764156, 671.940022856796, 779.1078105285665, 1314.8462005769459, 538.401676966683, 1131.3933598589624]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.883227379041973, "mean_inference_ms": 5.069428888769929, "mean_action_processing_ms": 2.085986504451698, "mean_env_wait_ms": 13.126046940491966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00944054126739502, "StateBufferConnector_ms": 0.01656198501586914, "ViewRequirementAgentConnector_ms": 0.1704568862915039}, "num_episodes": 19, "episode_return_max": 628.8549955274334, "episode_return_min": -11.477256354483515, "episode_return_mean": 181.29907728970093, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.5945439969036, "num_env_steps_trained_throughput_per_sec": 149.5945439969036, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 26191.521, "restore_workers_time_ms": 0.046, "training_step_time_ms": 26191.333, "sample_time_ms": 2269.467, "learn_time_ms": 23898.859, "learn_throughput": 167.372, "synch_weights_time_ms": 19.745}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-56-41", "timestamp": 1724383601, "time_this_iter_s": 26.801920175552368, "time_total_s": 1316.0690143108368, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095d2430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1316.0690143108368, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 35.38421052631579, "ram_util_percent": 82.00526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.229312859388887, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.203022973499601, "policy_loss": -0.008180223263445354, "vf_loss": 7.209919607071649, "vf_explained_var": 0.43467637218495525, "kl": 0.006417899050690707, "entropy": 0.5483713738817386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46778.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.860409661449452, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.745017542157854, "policy_loss": -0.00984014329948911, "vf_loss": 6.753303743291784, "vf_explained_var": 0.5658849386311082, "kl": 0.0077696933758459865, "entropy": 0.7519597546764152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46778.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 628.5393605531242, "episode_reward_min": -11.477256354483515, "episode_reward_mean": 184.34202934368582, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1679.7985123543242, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.29604768994255, "predator_policy": 1683.026145215189}, "policy_reward_mean": {"prey_policy": -746.6754848737204, "predator_policy": 838.8464995455637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [372.7253464327645, 604.8136461467523, 135.3435142078955, -3.552713678800501e-15, 57.0606342236431, 11.200000000000017, 459.25282788877587, 7.874654270512243, 1.0999999999999948, 52.89999999999999, 3.400000000000003, 30.961557357756256, 3.299999999999999, 92.71725033267836, 190.4031210727976, 628.5393605531242, 336.9875942164388, 490.6333070312155, 0.3145804658108502, 233.35354446396096, 16.77005492366574, 364.4662566152945, -8.881784197001252e-16, 17.061664905327206, 405.42235086732677, 449.0466901365035, 20.900000000000006, 6.399999999999995, 3.0000000000000018, 168.15590111097464, 95.09413592438813, 106.52140402482414, 220.05546726114295, 1.7000000000000028, 320.7635021488285, 395.50343099314483, 498.30750071032537, 3.9999999999999982, 71.15030445899706, 241.0463207980684, 162.38240166538873, 107.11300778725683, 13.39999999999996, 0.09269328950713884, 12.26545686486699, 3.6921892474754707, 183.26206818350937, 120.86631890370995, 94.6804501418624, 138.09426154578986, 189.0157770262922, 121.03245714104119, 79.99999999999973, 410.2606285435013, 37.733831410235226, 175.69644875197287, 64.98203781838806, 324.2005526769731, 109.45205223505951, 56.45764670047399, 4.440892098500626e-15, 230.80459364743302, 5.9999999999999964, 45.774699510578955, 7.70974611066295, 567.7665189938064, 20.934086051292702, 94.55993276702127, 183.47985055996412, 217.07829000837944, 396.11690079929775, 506.359813427773, 607.438733923293, 581.7466409088128, 471.6883692681107, 176.26041662103592, 0.21821107072746226, 1.9984014443252818e-15, 245.28846200816812, 58.6094343340795, 43.23705700921394, 120.70000000000012, 367.1244151996396, 389.22227765521103, 245.56108697477868, 292.1142502654077, 316.28308553503587, 77.3865831518488, 57.93757164436414, -11.477256354483515, 192.48068346068519, 40.56283453940604, 456.31239539611215, 355.741196747707, 140.49770481039337, 204.49861641854048, 124.67406750215656, 302.421505559502, 591.4710355223544, 186.69291984403174], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-388.3409113084124, -871.6448459839561, -1197.5860871913312, -323.1111330338219, -1399.9406903661595, -159.24436969595553, -1294.984385212365, -1485.7770031413406, -749.7047274677468, -1412.9159306477832, -1491.9830154194874, -1280.0206640891197, -713.8321290359341, -183.1602485834001, -1207.0679278324183, -1350.1841978062923, -1184.5428996853452, -1233.5818853055405, -941.4574020588225, -1120.2675070273285, -1099.4833479744009, -1507.0461877549183, -1054.9225311915186, -918.5668991558845, -1324.092856481583, -675.66810785267, -1194.389012016887, -541.7671418057956, 157.8155338417941, -1224.6127736785475, 89.1183151378336, -894.0340800476391, -1357.713207762419, -951.6763724638597, -1330.7020183196496, 309.1966261785147, -1414.1144537850812, -1230.9180262265122, -952.2817661898017, -765.8077650812871, -1679.7985123543242, -1077.759850348556, -1314.6879721313371, -814.9750158333999, -1459.0555544784393, -1390.3988214047436, -1569.8962212311826, -1184.567792560541, 323.8206545503112, -1277.189947872467, 297.53191949359865, -420.63583289207526, -1393.673318585528, -951.6744256721375, -1237.6305448601436, -1175.994273616613, -1595.5167733816627, -1221.4653798129184, -1213.4037850766629, 62.422125815373676, -1149.1894867941069, -744.5595149183387, -183.6318022321888, -523.8663191214952, -427.2499676893556, -302.4078242636816, -1438.0081066749885, -1409.0821628312203, 203.373424585289, -351.4333984567803, 300.72817710355906, -1350.0781510030974, 25.85768577399905, -54.603906118638236, -1208.1685651861476, -1447.1547631863798, -1122.5739868492942, -406.1395272620834, -786.4806942936385, 8.230133049332524, -310.26351986054317, -245.63374967121797, -609.3491058978492, -1349.713281582856, -1605.0841886121111, -905.3665446522201, -1356.768409557298, -1531.657490147435, -1299.781451053042, -560.4112353190066, -1176.3407591490554, -974.6802678155243, -1265.1707747010505, -638.951922684633, -826.9066294325365, -1023.1568080491031, -1333.6247330826225, -634.4938891367808, 33.32223941805211, -439.34626791301014, -1218.672702802338, -260.70077350278495, -1344.0636916439732, -150.61747555572637, 40.0000000000003, 40.0000000000003, 289.4936050703146, -657.291480255374, -690.4725912026192, -1531.419638628513, -481.7824519217412, -481.382752803718, -331.2858707724871, -1257.4605514933885, -382.93934828650663, -782.2128673482133, -1288.3445789660373, -643.5319468677097, -612.0545657072427, -1104.5165198241343, -1519.6669098953491, -1136.2626360549696, -691.6637123332606, -417.3175477766007, -906.7724196811761, -1417.459339797053, -769.9452975475141, -130.90016724675547, -908.4952809660308, -1494.1561550581594, 387.29604768994255, -7.356134369390361, -1022.0675802582394, -1141.7855853853785, -229.79651598470184, -1314.9238740395476, -1354.0519854011402, -609.5071971673767, -585.3278926125354, 21.28828143069105, -706.7118475604832, -432.09663275166656, 353.97291383487254, -1023.7328230070594, 131.48482202029703, -761.6848185402866, -1264.6466145332454, -0.8397637237647047, -89.20581918709668, -554.5035691643174, -69.34869004319583, -996.0133554496825, -1502.4579892261233, -1226.7333168995128, -1433.3390557924984, -838.9616907051133, 97.59893557133833, -760.7235025627274, -540.054113890728, -1314.13163752533, 28.455344810272447, -1349.5664761940245, -413.1274358390593, -554.4774662798385, -238.0366226174782, -726.7710818043021, -450.71168394839265, -110.00701964763408, 52.53534625689632, -639.9531732218239, -935.6561560579547, -74.95184378480171, 83.36797820557345, -609.8724577051361, -246.14085103616154, 28.155753833319732, -30.392059259647624, -1235.7587705134497, -1362.4795494607758, -430.24501265480393, -1249.057482405456, -421.05362836706917, -741.5802377275056, -1311.8109388385974, -62.15615850016483, -1151.3264829293707, -17.128448002291023, -1135.1774226433058, -234.68978197127302, -621.301533106196, -46.46431357747922, -541.4271935679311, -183.75038887205602, -35.814994399537845, 140.62238355928724, -1005.5208113096473, -536.9613976851998, -334.94377158178884, -744.7979876861212, -269.48557306464784], "policy_predator_policy_reward": [1337.5810494952525, 295.13005422988954, 953.6628535272307, 1171.8480128446793, 934.7959321557585, 759.7326421142492, 1294.984385212365, 1485.7770031413406, 806.7653616913907, 1412.9159306477832, 1491.9830154194874, 1291.2206640891195, 675.5361020544788, 680.7091034536301, 1212.6470348336825, 1352.479745075539, 1185.6428996853451, 1233.5818853055405, 981.0574020588233, 1133.5675070273285, 1101.8833479744012, 1508.0461877549183, 1085.5133281817414, 918.9376595234105, 1324.092856481583, 678.9681078526701, 1187.1277782615734, 641.7456258937887, 31.687587231003445, 1225.5127736785475, 711.7811152686965, 721.6740101942348, 1310.1402826383226, 1336.236891804399, 1301.490683806814, 210.64801536553725, 1414.1144537850812, 1231.232606692323, 1393.7980666983428, 557.6450090367011, 1683.026145215189, 1091.3022724113562, 1239.0642711511791, 1255.064973428854, 1459.0555544784393, 1390.3988214047436, 1630.2747619632626, 1141.2509167337885, 81.6016963170157, 1277.189947872467, 48.08837406800152, 524.0622294669797, 1393.673318585528, 972.5744256721379, 1243.230544860145, 1176.794273616613, 1595.5167733816627, 1224.4653798129186, 993.426960682017, 325.7105996902478, 827.5965331386755, 1161.2466044981581, 47.93202743813271, 766.0874979403719, 445.9499676893566, 503.76329152482487, 1438.0081066749885, 1410.7821628312204, 311.4788614020069, 157.34461461831722, 83.27525388958583, 1361.5781510030974, 214.00008564973388, 313.0536354052289, 1208.1685651861476, 1451.1547631863798, 1122.5739868492942, 477.2898317210801, 529.979821466058, 489.31706057631646, 235.4821384302055, 482.797532766944, 709.2760494077605, 1356.8993458602035, 1605.0841886121111, 918.7665446522232, 1356.8611028468051, 1531.657490147435, 1299.781451053042, 572.6766921838762, 1177.7407591490542, 976.9724570630002, 1265.1707747010505, 822.2139908681428, 953.7226413606381, 1017.207115024714, 729.174339278644, 1333.6247330826225, 408.46066432846743, 135.657625712285, 445.9226348098897, 1222.4666185215258, 1345.8636916439716, 269.849932696769, 0.0, 0.0, 658.8228773944184, 119.23562633414289, 728.2064226128565, 1531.419638628513, 890.2386350426282, 248.62301843481296, 396.2679085908774, 1257.4605514933885, 800.6939754685002, 688.6587928431954, 1286.8225394407768, 754.5060386280323, 1199.8271143431316, 573.2016178887189, 1519.6669098953491, 1136.2626360549696, 628.5835161900335, 711.2023375672616, 912.7724196811763, 1417.459339797053, 196.403792841755, 750.2163714630934, 916.2050270766938, 1494.1561550581594, 41.32379340386871, 146.50281226938483, 1159.9722079074095, 1024.8150437875001, 462.6997830680037, 1176.580539723271, 1046.4159534303767, 1100.6230796981058, 420.906775727393, 360.21112546283075, 721.4111876114843, 813.5141934999625, 161.26263727096128, 1014.8570853289968, 701.1480119128324, 536.4907185304494, 1239.5724433377632, 607.6605758280604, 582.7552429571897, 532.6425146623351, 295.45278694615473, 946.1696751677588, 1401.0335200348968, 1328.375997161466, 1433.3390557924984, 838.9616907051133, 124.48952643683026, 783.9235025627273, 633.4704405929757, 1279.3247451571613, 14.781712198941287, 1349.5664761940245, 461.82743583905943, 626.4774662798396, 556.3472124051109, 775.58490721631, 215.378318261056, 734.5626629901827, 198.6911039263879, 634.287810013319, 687.8330973748343, 614.8891527333317, 131.06962024561287, 711.7179447889866, 229.10744008321862, 66.2642402714724, 1235.7587705134497, 88.32963090401162, 1411.8851419682837, 369.3621637928118, 1190.6517713764156, 671.940022856796, 779.1078105285665, 1314.8462005769459, 538.401676966683, 1131.3933598589624, 436.465565036454, 1071.5815023568512, 276.6292413482715, 719.8597785395924, 148.07544402600706, 644.314679537945, 143.37666966996446, 200.86278110378817, 292.86364793944426, 874.456285370417, 635.0911164462904, 828.2850883430526, 1011.5392385835715, 189.43724201123482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.87177187392533, "mean_inference_ms": 5.069094266494071, "mean_action_processing_ms": 2.075991582906469, "mean_env_wait_ms": 13.112888315291023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009418129920959473, "StateBufferConnector_ms": 0.016461849212646484, "ViewRequirementAgentConnector_ms": 0.17184758186340332}, "num_episodes": 7, "episode_return_max": 628.5393605531242, "episode_return_min": -11.477256354483515, "episode_return_mean": 184.34202934368582, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.17558968342314, "num_env_steps_trained_throughput_per_sec": 147.17558968342314, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 26263.329, "restore_workers_time_ms": 0.047, "training_step_time_ms": 26263.061, "sample_time_ms": 2357.283, "learn_time_ms": 23882.198, "learn_throughput": 167.489, "synch_weights_time_ms": 20.03}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-57-08", "timestamp": 1724383628, "time_this_iter_s": 27.22265601158142, "time_total_s": 1343.2916703224182, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08caca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1343.2916703224182, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 35.77368421052631, "ram_util_percent": 82.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.12944157010033, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.882310906162968, "policy_loss": -0.007565990550364688, "vf_loss": 6.888529294634623, "vf_explained_var": 0.4528164957566236, "kl": 0.006738067142389439, "entropy": 0.5806964218616486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 47723.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.69705355306151, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.61269515405887, "policy_loss": -0.009709111567113607, "vf_loss": 6.620867947169713, "vf_explained_var": 0.4838059523748973, "kl": 0.007681682280131749, "entropy": 0.7178762283274737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 47723.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 628.5393605531242, "episode_reward_min": -11.477256354483515, "episode_reward_mean": 191.0372515168358, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1679.7985123543242, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.29604768994255, "predator_policy": 1683.026145215189}, "policy_reward_mean": {"prey_policy": -694.7391559999345, "predator_policy": 790.2577817583525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.89999999999999, 3.400000000000003, 30.961557357756256, 3.299999999999999, 92.71725033267836, 190.4031210727976, 628.5393605531242, 336.9875942164388, 490.6333070312155, 0.3145804658108502, 233.35354446396096, 16.77005492366574, 364.4662566152945, -8.881784197001252e-16, 17.061664905327206, 405.42235086732677, 449.0466901365035, 20.900000000000006, 6.399999999999995, 3.0000000000000018, 168.15590111097464, 95.09413592438813, 106.52140402482414, 220.05546726114295, 1.7000000000000028, 320.7635021488285, 395.50343099314483, 498.30750071032537, 3.9999999999999982, 71.15030445899706, 241.0463207980684, 162.38240166538873, 107.11300778725683, 13.39999999999996, 0.09269328950713884, 12.26545686486699, 3.6921892474754707, 183.26206818350937, 120.86631890370995, 94.6804501418624, 138.09426154578986, 189.0157770262922, 121.03245714104119, 79.99999999999973, 410.2606285435013, 37.733831410235226, 175.69644875197287, 64.98203781838806, 324.2005526769731, 109.45205223505951, 56.45764670047399, 4.440892098500626e-15, 230.80459364743302, 5.9999999999999964, 45.774699510578955, 7.70974611066295, 567.7665189938064, 20.934086051292702, 94.55993276702127, 183.47985055996412, 217.07829000837944, 396.11690079929775, 506.359813427773, 607.438733923293, 581.7466409088128, 471.6883692681107, 176.26041662103592, 0.21821107072746226, 1.9984014443252818e-15, 245.28846200816812, 58.6094343340795, 43.23705700921394, 120.70000000000012, 367.1244151996396, 389.22227765521103, 245.56108697477868, 292.1142502654077, 316.28308553503587, 77.3865831518488, 57.93757164436414, -11.477256354483515, 192.48068346068519, 40.56283453940604, 456.31239539611215, 355.741196747707, 140.49770481039337, 204.49861641854048, 124.67406750215656, 302.421505559502, 591.4710355223544, 186.69291984403174, 362.720731324219, 245.6255157231909, 52.988148307240905, 496.05668108576566, 216.2811303940613, 38.0659360086855, 340.770761558933, 124.63584860639914, 441.74808747684455], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-941.4574020588225, -1120.2675070273285, -1099.4833479744009, -1507.0461877549183, -1054.9225311915186, -918.5668991558845, -1324.092856481583, -675.66810785267, -1194.389012016887, -541.7671418057956, 157.8155338417941, -1224.6127736785475, 89.1183151378336, -894.0340800476391, -1357.713207762419, -951.6763724638597, -1330.7020183196496, 309.1966261785147, -1414.1144537850812, -1230.9180262265122, -952.2817661898017, -765.8077650812871, -1679.7985123543242, -1077.759850348556, -1314.6879721313371, -814.9750158333999, -1459.0555544784393, -1390.3988214047436, -1569.8962212311826, -1184.567792560541, 323.8206545503112, -1277.189947872467, 297.53191949359865, -420.63583289207526, -1393.673318585528, -951.6744256721375, -1237.6305448601436, -1175.994273616613, -1595.5167733816627, -1221.4653798129184, -1213.4037850766629, 62.422125815373676, -1149.1894867941069, -744.5595149183387, -183.6318022321888, -523.8663191214952, -427.2499676893556, -302.4078242636816, -1438.0081066749885, -1409.0821628312203, 203.373424585289, -351.4333984567803, 300.72817710355906, -1350.0781510030974, 25.85768577399905, -54.603906118638236, -1208.1685651861476, -1447.1547631863798, -1122.5739868492942, -406.1395272620834, -786.4806942936385, 8.230133049332524, -310.26351986054317, -245.63374967121797, -609.3491058978492, -1349.713281582856, -1605.0841886121111, -905.3665446522201, -1356.768409557298, -1531.657490147435, -1299.781451053042, -560.4112353190066, -1176.3407591490554, -974.6802678155243, -1265.1707747010505, -638.951922684633, -826.9066294325365, -1023.1568080491031, -1333.6247330826225, -634.4938891367808, 33.32223941805211, -439.34626791301014, -1218.672702802338, -260.70077350278495, -1344.0636916439732, -150.61747555572637, 40.0000000000003, 40.0000000000003, 289.4936050703146, -657.291480255374, -690.4725912026192, -1531.419638628513, -481.7824519217412, -481.382752803718, -331.2858707724871, -1257.4605514933885, -382.93934828650663, -782.2128673482133, -1288.3445789660373, -643.5319468677097, -612.0545657072427, -1104.5165198241343, -1519.6669098953491, -1136.2626360549696, -691.6637123332606, -417.3175477766007, -906.7724196811761, -1417.459339797053, -769.9452975475141, -130.90016724675547, -908.4952809660308, -1494.1561550581594, 387.29604768994255, -7.356134369390361, -1022.0675802582394, -1141.7855853853785, -229.79651598470184, -1314.9238740395476, -1354.0519854011402, -609.5071971673767, -585.3278926125354, 21.28828143069105, -706.7118475604832, -432.09663275166656, 353.97291383487254, -1023.7328230070594, 131.48482202029703, -761.6848185402866, -1264.6466145332454, -0.8397637237647047, -89.20581918709668, -554.5035691643174, -69.34869004319583, -996.0133554496825, -1502.4579892261233, -1226.7333168995128, -1433.3390557924984, -838.9616907051133, 97.59893557133833, -760.7235025627274, -540.054113890728, -1314.13163752533, 28.455344810272447, -1349.5664761940245, -413.1274358390593, -554.4774662798385, -238.0366226174782, -726.7710818043021, -450.71168394839265, -110.00701964763408, 52.53534625689632, -639.9531732218239, -935.6561560579547, -74.95184378480171, 83.36797820557345, -609.8724577051361, -246.14085103616154, 28.155753833319732, -30.392059259647624, -1235.7587705134497, -1362.4795494607758, -430.24501265480393, -1249.057482405456, -421.05362836706917, -741.5802377275056, -1311.8109388385974, -62.15615850016483, -1151.3264829293707, -17.128448002291023, -1135.1774226433058, -234.68978197127302, -621.301533106196, -46.46431357747922, -541.4271935679311, -183.75038887205602, -35.814994399537845, 140.62238355928724, -1005.5208113096473, -536.9613976851998, -334.94377158178884, -744.7979876861212, -269.48557306464784, -91.7978702782644, -1074.1675755600181, 8.014315740236427, -1067.0685234525786, -53.17720654453779, -238.79575065421884, 87.19939138546637, -707.220871245196, -134.08237541906615, -1270.0603625805077, -1116.2094512198034, -419.3318658278441, 135.26363337429436, -626.6806959016023, -631.6305227266771, -125.40582404363002, 117.40898123727956, -332.61470333256256], "policy_predator_policy_reward": [981.0574020588233, 1133.5675070273285, 1101.8833479744012, 1508.0461877549183, 1085.5133281817414, 918.9376595234105, 1324.092856481583, 678.9681078526701, 1187.1277782615734, 641.7456258937887, 31.687587231003445, 1225.5127736785475, 711.7811152686965, 721.6740101942348, 1310.1402826383226, 1336.236891804399, 1301.490683806814, 210.64801536553725, 1414.1144537850812, 1231.232606692323, 1393.7980666983428, 557.6450090367011, 1683.026145215189, 1091.3022724113562, 1239.0642711511791, 1255.064973428854, 1459.0555544784393, 1390.3988214047436, 1630.2747619632626, 1141.2509167337885, 81.6016963170157, 1277.189947872467, 48.08837406800152, 524.0622294669797, 1393.673318585528, 972.5744256721379, 1243.230544860145, 1176.794273616613, 1595.5167733816627, 1224.4653798129186, 993.426960682017, 325.7105996902478, 827.5965331386755, 1161.2466044981581, 47.93202743813271, 766.0874979403719, 445.9499676893566, 503.76329152482487, 1438.0081066749885, 1410.7821628312204, 311.4788614020069, 157.34461461831722, 83.27525388958583, 1361.5781510030974, 214.00008564973388, 313.0536354052289, 1208.1685651861476, 1451.1547631863798, 1122.5739868492942, 477.2898317210801, 529.979821466058, 489.31706057631646, 235.4821384302055, 482.797532766944, 709.2760494077605, 1356.8993458602035, 1605.0841886121111, 918.7665446522232, 1356.8611028468051, 1531.657490147435, 1299.781451053042, 572.6766921838762, 1177.7407591490542, 976.9724570630002, 1265.1707747010505, 822.2139908681428, 953.7226413606381, 1017.207115024714, 729.174339278644, 1333.6247330826225, 408.46066432846743, 135.657625712285, 445.9226348098897, 1222.4666185215258, 1345.8636916439716, 269.849932696769, 0.0, 0.0, 658.8228773944184, 119.23562633414289, 728.2064226128565, 1531.419638628513, 890.2386350426282, 248.62301843481296, 396.2679085908774, 1257.4605514933885, 800.6939754685002, 688.6587928431954, 1286.8225394407768, 754.5060386280323, 1199.8271143431316, 573.2016178887189, 1519.6669098953491, 1136.2626360549696, 628.5835161900335, 711.2023375672616, 912.7724196811763, 1417.459339797053, 196.403792841755, 750.2163714630934, 916.2050270766938, 1494.1561550581594, 41.32379340386871, 146.50281226938483, 1159.9722079074095, 1024.8150437875001, 462.6997830680037, 1176.580539723271, 1046.4159534303767, 1100.6230796981058, 420.906775727393, 360.21112546283075, 721.4111876114843, 813.5141934999625, 161.26263727096128, 1014.8570853289968, 701.1480119128324, 536.4907185304494, 1239.5724433377632, 607.6605758280604, 582.7552429571897, 532.6425146623351, 295.45278694615473, 946.1696751677588, 1401.0335200348968, 1328.375997161466, 1433.3390557924984, 838.9616907051133, 124.48952643683026, 783.9235025627273, 633.4704405929757, 1279.3247451571613, 14.781712198941287, 1349.5664761940245, 461.82743583905943, 626.4774662798396, 556.3472124051109, 775.58490721631, 215.378318261056, 734.5626629901827, 198.6911039263879, 634.287810013319, 687.8330973748343, 614.8891527333317, 131.06962024561287, 711.7179447889866, 229.10744008321862, 66.2642402714724, 1235.7587705134497, 88.32963090401162, 1411.8851419682837, 369.3621637928118, 1190.6517713764156, 671.940022856796, 779.1078105285665, 1314.8462005769459, 538.401676966683, 1131.3933598589624, 436.465565036454, 1071.5815023568512, 276.6292413482715, 719.8597785395924, 148.07544402600706, 644.314679537945, 143.37666966996446, 200.86278110378817, 292.86364793944426, 874.456285370417, 635.0911164462904, 828.2850883430526, 1011.5392385835715, 189.43724201123482, 665.3235987220684, 863.3625784404259, 234.31119998295475, 1070.3685234525792, 77.3653548517771, 267.5957506542181, 582.225859149765, 533.8523017957267, 352.12705675676347, 1268.2968116368727, 1120.3718027960135, 453.2354502603187, 717.5970859531759, 114.59073813306426, 205.3745523605285, 676.2976430161787, 316.69884084241767, 340.25496872970797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.856271524643765, "mean_inference_ms": 5.046882145889819, "mean_action_processing_ms": 2.0616017665296447, "mean_env_wait_ms": 13.100177865335898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009443879127502441, "StateBufferConnector_ms": 0.014183640480041504, "ViewRequirementAgentConnector_ms": 0.15900301933288574}, "num_episodes": 9, "episode_return_max": 628.5393605531242, "episode_return_min": -11.477256354483515, "episode_return_mean": 191.0372515168358, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.57629075542908, "num_env_steps_trained_throughput_per_sec": 152.57629075542908, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 26266.033, "restore_workers_time_ms": 0.046, "training_step_time_ms": 26265.766, "sample_time_ms": 2362.356, "learn_time_ms": 23879.706, "learn_throughput": 167.506, "synch_weights_time_ms": 20.058}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-57-34", "timestamp": 1724383654, "time_this_iter_s": 26.28122115135193, "time_total_s": 1369.5728914737701, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08bb280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1369.5728914737701, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 33.96756756756757, "ram_util_percent": 82.07567567567567}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.735783358604188, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.198198222104835, "policy_loss": -0.006943658555527686, "vf_loss": 6.203645133972168, "vf_explained_var": 0.544413480178389, "kl": 0.007483710308076331, "entropy": 0.6206836734183881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48668.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.164103196411535, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.105159547593859, "policy_loss": -0.008260158171985672, "vf_loss": 6.112246895845605, "vf_explained_var": 0.6137450098991394, "kl": 0.0058642511549233285, "entropy": 0.7553432916207289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48668.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 607.438733923293, "episode_reward_min": -24.91020950547903, "episode_reward_mean": 187.6418812744648, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1679.7985123543242, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.29604768994255, "predator_policy": 1683.026145215189}, "policy_reward_mean": {"prey_policy": -678.536135465794, "predator_policy": 772.3570761030267}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.9875942164388, 490.6333070312155, 0.3145804658108502, 233.35354446396096, 16.77005492366574, 364.4662566152945, -8.881784197001252e-16, 17.061664905327206, 405.42235086732677, 449.0466901365035, 20.900000000000006, 6.399999999999995, 3.0000000000000018, 168.15590111097464, 95.09413592438813, 106.52140402482414, 220.05546726114295, 1.7000000000000028, 320.7635021488285, 395.50343099314483, 498.30750071032537, 3.9999999999999982, 71.15030445899706, 241.0463207980684, 162.38240166538873, 107.11300778725683, 13.39999999999996, 0.09269328950713884, 12.26545686486699, 3.6921892474754707, 183.26206818350937, 120.86631890370995, 94.6804501418624, 138.09426154578986, 189.0157770262922, 121.03245714104119, 79.99999999999973, 410.2606285435013, 37.733831410235226, 175.69644875197287, 64.98203781838806, 324.2005526769731, 109.45205223505951, 56.45764670047399, 4.440892098500626e-15, 230.80459364743302, 5.9999999999999964, 45.774699510578955, 7.70974611066295, 567.7665189938064, 20.934086051292702, 94.55993276702127, 183.47985055996412, 217.07829000837944, 396.11690079929775, 506.359813427773, 607.438733923293, 581.7466409088128, 471.6883692681107, 176.26041662103592, 0.21821107072746226, 1.9984014443252818e-15, 245.28846200816812, 58.6094343340795, 43.23705700921394, 120.70000000000012, 367.1244151996396, 389.22227765521103, 245.56108697477868, 292.1142502654077, 316.28308553503587, 77.3865831518488, 57.93757164436414, -11.477256354483515, 192.48068346068519, 40.56283453940604, 456.31239539611215, 355.741196747707, 140.49770481039337, 204.49861641854048, 124.67406750215656, 302.421505559502, 591.4710355223544, 186.69291984403174, 362.720731324219, 245.6255157231909, 52.988148307240905, 496.05668108576566, 216.2811303940613, 38.0659360086855, 340.770761558933, 124.63584860639914, 441.74808747684455, 79.59999999999975, -24.91020950547903, 30.15926986496275, 25.37680891755862, 176.33404127650218, 286.21890459055084, 89.90544993516362], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1357.713207762419, -951.6763724638597, -1330.7020183196496, 309.1966261785147, -1414.1144537850812, -1230.9180262265122, -952.2817661898017, -765.8077650812871, -1679.7985123543242, -1077.759850348556, -1314.6879721313371, -814.9750158333999, -1459.0555544784393, -1390.3988214047436, -1569.8962212311826, -1184.567792560541, 323.8206545503112, -1277.189947872467, 297.53191949359865, -420.63583289207526, -1393.673318585528, -951.6744256721375, -1237.6305448601436, -1175.994273616613, -1595.5167733816627, -1221.4653798129184, -1213.4037850766629, 62.422125815373676, -1149.1894867941069, -744.5595149183387, -183.6318022321888, -523.8663191214952, -427.2499676893556, -302.4078242636816, -1438.0081066749885, -1409.0821628312203, 203.373424585289, -351.4333984567803, 300.72817710355906, -1350.0781510030974, 25.85768577399905, -54.603906118638236, -1208.1685651861476, -1447.1547631863798, -1122.5739868492942, -406.1395272620834, -786.4806942936385, 8.230133049332524, -310.26351986054317, -245.63374967121797, -609.3491058978492, -1349.713281582856, -1605.0841886121111, -905.3665446522201, -1356.768409557298, -1531.657490147435, -1299.781451053042, -560.4112353190066, -1176.3407591490554, -974.6802678155243, -1265.1707747010505, -638.951922684633, -826.9066294325365, -1023.1568080491031, -1333.6247330826225, -634.4938891367808, 33.32223941805211, -439.34626791301014, -1218.672702802338, -260.70077350278495, -1344.0636916439732, -150.61747555572637, 40.0000000000003, 40.0000000000003, 289.4936050703146, -657.291480255374, -690.4725912026192, -1531.419638628513, -481.7824519217412, -481.382752803718, -331.2858707724871, -1257.4605514933885, -382.93934828650663, -782.2128673482133, -1288.3445789660373, -643.5319468677097, -612.0545657072427, -1104.5165198241343, -1519.6669098953491, -1136.2626360549696, -691.6637123332606, -417.3175477766007, -906.7724196811761, -1417.459339797053, -769.9452975475141, -130.90016724675547, -908.4952809660308, -1494.1561550581594, 387.29604768994255, -7.356134369390361, -1022.0675802582394, -1141.7855853853785, -229.79651598470184, -1314.9238740395476, -1354.0519854011402, -609.5071971673767, -585.3278926125354, 21.28828143069105, -706.7118475604832, -432.09663275166656, 353.97291383487254, -1023.7328230070594, 131.48482202029703, -761.6848185402866, -1264.6466145332454, -0.8397637237647047, -89.20581918709668, -554.5035691643174, -69.34869004319583, -996.0133554496825, -1502.4579892261233, -1226.7333168995128, -1433.3390557924984, -838.9616907051133, 97.59893557133833, -760.7235025627274, -540.054113890728, -1314.13163752533, 28.455344810272447, -1349.5664761940245, -413.1274358390593, -554.4774662798385, -238.0366226174782, -726.7710818043021, -450.71168394839265, -110.00701964763408, 52.53534625689632, -639.9531732218239, -935.6561560579547, -74.95184378480171, 83.36797820557345, -609.8724577051361, -246.14085103616154, 28.155753833319732, -30.392059259647624, -1235.7587705134497, -1362.4795494607758, -430.24501265480393, -1249.057482405456, -421.05362836706917, -741.5802377275056, -1311.8109388385974, -62.15615850016483, -1151.3264829293707, -17.128448002291023, -1135.1774226433058, -234.68978197127302, -621.301533106196, -46.46431357747922, -541.4271935679311, -183.75038887205602, -35.814994399537845, 140.62238355928724, -1005.5208113096473, -536.9613976851998, -334.94377158178884, -744.7979876861212, -269.48557306464784, -91.7978702782644, -1074.1675755600181, 8.014315740236427, -1067.0685234525786, -53.17720654453779, -238.79575065421884, 87.19939138546637, -707.220871245196, -134.08237541906615, -1270.0603625805077, -1116.2094512198034, -419.3318658278441, 135.26363337429436, -626.6806959016023, -631.6305227266771, -125.40582404363002, 117.40898123727956, -332.61470333256256, 36.09989398176272, 40.0000000000003, -1098.890635857492, -982.0218992678779, -828.4173263101044, -876.4233913399156, -584.9087694487345, -707.5752975178785, -998.4185909112208, 39.17151716317368, -776.4315428287837, -666.6051177243489, -152.8079162492168, -1451.5408149276616], "policy_predator_policy_reward": [1310.1402826383226, 1336.236891804399, 1301.490683806814, 210.64801536553725, 1414.1144537850812, 1231.232606692323, 1393.7980666983428, 557.6450090367011, 1683.026145215189, 1091.3022724113562, 1239.0642711511791, 1255.064973428854, 1459.0555544784393, 1390.3988214047436, 1630.2747619632626, 1141.2509167337885, 81.6016963170157, 1277.189947872467, 48.08837406800152, 524.0622294669797, 1393.673318585528, 972.5744256721379, 1243.230544860145, 1176.794273616613, 1595.5167733816627, 1224.4653798129186, 993.426960682017, 325.7105996902478, 827.5965331386755, 1161.2466044981581, 47.93202743813271, 766.0874979403719, 445.9499676893566, 503.76329152482487, 1438.0081066749885, 1410.7821628312204, 311.4788614020069, 157.34461461831722, 83.27525388958583, 1361.5781510030974, 214.00008564973388, 313.0536354052289, 1208.1685651861476, 1451.1547631863798, 1122.5739868492942, 477.2898317210801, 529.979821466058, 489.31706057631646, 235.4821384302055, 482.797532766944, 709.2760494077605, 1356.8993458602035, 1605.0841886121111, 918.7665446522232, 1356.8611028468051, 1531.657490147435, 1299.781451053042, 572.6766921838762, 1177.7407591490542, 976.9724570630002, 1265.1707747010505, 822.2139908681428, 953.7226413606381, 1017.207115024714, 729.174339278644, 1333.6247330826225, 408.46066432846743, 135.657625712285, 445.9226348098897, 1222.4666185215258, 1345.8636916439716, 269.849932696769, 0.0, 0.0, 658.8228773944184, 119.23562633414289, 728.2064226128565, 1531.419638628513, 890.2386350426282, 248.62301843481296, 396.2679085908774, 1257.4605514933885, 800.6939754685002, 688.6587928431954, 1286.8225394407768, 754.5060386280323, 1199.8271143431316, 573.2016178887189, 1519.6669098953491, 1136.2626360549696, 628.5835161900335, 711.2023375672616, 912.7724196811763, 1417.459339797053, 196.403792841755, 750.2163714630934, 916.2050270766938, 1494.1561550581594, 41.32379340386871, 146.50281226938483, 1159.9722079074095, 1024.8150437875001, 462.6997830680037, 1176.580539723271, 1046.4159534303767, 1100.6230796981058, 420.906775727393, 360.21112546283075, 721.4111876114843, 813.5141934999625, 161.26263727096128, 1014.8570853289968, 701.1480119128324, 536.4907185304494, 1239.5724433377632, 607.6605758280604, 582.7552429571897, 532.6425146623351, 295.45278694615473, 946.1696751677588, 1401.0335200348968, 1328.375997161466, 1433.3390557924984, 838.9616907051133, 124.48952643683026, 783.9235025627273, 633.4704405929757, 1279.3247451571613, 14.781712198941287, 1349.5664761940245, 461.82743583905943, 626.4774662798396, 556.3472124051109, 775.58490721631, 215.378318261056, 734.5626629901827, 198.6911039263879, 634.287810013319, 687.8330973748343, 614.8891527333317, 131.06962024561287, 711.7179447889866, 229.10744008321862, 66.2642402714724, 1235.7587705134497, 88.32963090401162, 1411.8851419682837, 369.3621637928118, 1190.6517713764156, 671.940022856796, 779.1078105285665, 1314.8462005769459, 538.401676966683, 1131.3933598589624, 436.465565036454, 1071.5815023568512, 276.6292413482715, 719.8597785395924, 148.07544402600706, 644.314679537945, 143.37666966996446, 200.86278110378817, 292.86364793944426, 874.456285370417, 635.0911164462904, 828.2850883430526, 1011.5392385835715, 189.43724201123482, 665.3235987220684, 863.3625784404259, 234.31119998295475, 1070.3685234525792, 77.3653548517771, 267.5957506542181, 582.225859149765, 533.8523017957267, 352.12705675676347, 1268.2968116368727, 1120.3718027960135, 453.2354502603187, 717.5970859531759, 114.59073813306426, 205.3745523605285, 676.2976430161787, 316.69884084241767, 340.25496872970797, 3.5001060182375294, 0.0, 639.999143780617, 1416.0031818392708, 848.6638237194062, 886.336163795576, 594.2812616116129, 723.5796142725592, 998.4185909112208, 137.1625241133293, 861.4115918470088, 867.8439732966733, 239.38855068872564, 1454.8656304233157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.8548336512885895, "mean_inference_ms": 5.051484062085145, "mean_action_processing_ms": 2.045706834458809, "mean_env_wait_ms": 13.099381050938662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00949239730834961, "StateBufferConnector_ms": 0.014336228370666504, "ViewRequirementAgentConnector_ms": 0.16726648807525635}, "num_episodes": 7, "episode_return_max": 607.438733923293, "episode_return_min": -24.91020950547903, "episode_return_mean": 187.6418812744648, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.61427849746406, "num_env_steps_trained_throughput_per_sec": 148.61427849746406, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 26351.413, "restore_workers_time_ms": 0.047, "training_step_time_ms": 26351.188, "sample_time_ms": 2458.077, "learn_time_ms": 23868.729, "learn_throughput": 167.583, "synch_weights_time_ms": 20.463}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-58-01", "timestamp": 1724383681, "time_this_iter_s": 26.97118592262268, "time_total_s": 1396.5440773963928, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095bf430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1396.5440773963928, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 36.315384615384616, "ram_util_percent": 82.96153846153845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.722395980925786, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.343561260788529, "policy_loss": -0.009110532822235236, "vf_loss": 6.351164451982609, "vf_explained_var": 0.45267430991722796, "kl": 0.007536636229367956, "entropy": 0.6354013537288343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 49613.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.134596605149525, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.10786950701759, "policy_loss": -0.011265256962487622, "vf_loss": 6.1174740130308445, "vf_explained_var": 0.6826319497729104, "kl": 0.008303798537790065, "entropy": 0.7683653314277609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 49613.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 607.438733923293, "episode_reward_min": -24.91020950547903, "episode_reward_mean": 188.6040011711661, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1605.0841886121111, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.29604768994255, "predator_policy": 1630.2747619632626}, "policy_reward_mean": {"prey_policy": -628.2129076227321, "predator_policy": 722.5149082083154}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.061664905327206, 405.42235086732677, 449.0466901365035, 20.900000000000006, 6.399999999999995, 3.0000000000000018, 168.15590111097464, 95.09413592438813, 106.52140402482414, 220.05546726114295, 1.7000000000000028, 320.7635021488285, 395.50343099314483, 498.30750071032537, 3.9999999999999982, 71.15030445899706, 241.0463207980684, 162.38240166538873, 107.11300778725683, 13.39999999999996, 0.09269328950713884, 12.26545686486699, 3.6921892474754707, 183.26206818350937, 120.86631890370995, 94.6804501418624, 138.09426154578986, 189.0157770262922, 121.03245714104119, 79.99999999999973, 410.2606285435013, 37.733831410235226, 175.69644875197287, 64.98203781838806, 324.2005526769731, 109.45205223505951, 56.45764670047399, 4.440892098500626e-15, 230.80459364743302, 5.9999999999999964, 45.774699510578955, 7.70974611066295, 567.7665189938064, 20.934086051292702, 94.55993276702127, 183.47985055996412, 217.07829000837944, 396.11690079929775, 506.359813427773, 607.438733923293, 581.7466409088128, 471.6883692681107, 176.26041662103592, 0.21821107072746226, 1.9984014443252818e-15, 245.28846200816812, 58.6094343340795, 43.23705700921394, 120.70000000000012, 367.1244151996396, 389.22227765521103, 245.56108697477868, 292.1142502654077, 316.28308553503587, 77.3865831518488, 57.93757164436414, -11.477256354483515, 192.48068346068519, 40.56283453940604, 456.31239539611215, 355.741196747707, 140.49770481039337, 204.49861641854048, 124.67406750215656, 302.421505559502, 591.4710355223544, 186.69291984403174, 362.720731324219, 245.6255157231909, 52.988148307240905, 496.05668108576566, 216.2811303940613, 38.0659360086855, 340.770761558933, 124.63584860639914, 441.74808747684455, 79.59999999999975, -24.91020950547903, 30.15926986496275, 25.37680891755862, 176.33404127650218, 286.21890459055084, 89.90544993516362, 151.08663535378736, 422.53308260607093, 97.3172443857799, 108.27493041917651, 198.32533600461863, 1.6753274856786957, 559.5247711314041], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1569.8962212311826, -1184.567792560541, 323.8206545503112, -1277.189947872467, 297.53191949359865, -420.63583289207526, -1393.673318585528, -951.6744256721375, -1237.6305448601436, -1175.994273616613, -1595.5167733816627, -1221.4653798129184, -1213.4037850766629, 62.422125815373676, -1149.1894867941069, -744.5595149183387, -183.6318022321888, -523.8663191214952, -427.2499676893556, -302.4078242636816, -1438.0081066749885, -1409.0821628312203, 203.373424585289, -351.4333984567803, 300.72817710355906, -1350.0781510030974, 25.85768577399905, -54.603906118638236, -1208.1685651861476, -1447.1547631863798, -1122.5739868492942, -406.1395272620834, -786.4806942936385, 8.230133049332524, -310.26351986054317, -245.63374967121797, -609.3491058978492, -1349.713281582856, -1605.0841886121111, -905.3665446522201, -1356.768409557298, -1531.657490147435, -1299.781451053042, -560.4112353190066, -1176.3407591490554, -974.6802678155243, -1265.1707747010505, -638.951922684633, -826.9066294325365, -1023.1568080491031, -1333.6247330826225, -634.4938891367808, 33.32223941805211, -439.34626791301014, -1218.672702802338, -260.70077350278495, -1344.0636916439732, -150.61747555572637, 40.0000000000003, 40.0000000000003, 289.4936050703146, -657.291480255374, -690.4725912026192, -1531.419638628513, -481.7824519217412, -481.382752803718, -331.2858707724871, -1257.4605514933885, -382.93934828650663, -782.2128673482133, -1288.3445789660373, -643.5319468677097, -612.0545657072427, -1104.5165198241343, -1519.6669098953491, -1136.2626360549696, -691.6637123332606, -417.3175477766007, -906.7724196811761, -1417.459339797053, -769.9452975475141, -130.90016724675547, -908.4952809660308, -1494.1561550581594, 387.29604768994255, -7.356134369390361, -1022.0675802582394, -1141.7855853853785, -229.79651598470184, -1314.9238740395476, -1354.0519854011402, -609.5071971673767, -585.3278926125354, 21.28828143069105, -706.7118475604832, -432.09663275166656, 353.97291383487254, -1023.7328230070594, 131.48482202029703, -761.6848185402866, -1264.6466145332454, -0.8397637237647047, -89.20581918709668, -554.5035691643174, -69.34869004319583, -996.0133554496825, -1502.4579892261233, -1226.7333168995128, -1433.3390557924984, -838.9616907051133, 97.59893557133833, -760.7235025627274, -540.054113890728, -1314.13163752533, 28.455344810272447, -1349.5664761940245, -413.1274358390593, -554.4774662798385, -238.0366226174782, -726.7710818043021, -450.71168394839265, -110.00701964763408, 52.53534625689632, -639.9531732218239, -935.6561560579547, -74.95184378480171, 83.36797820557345, -609.8724577051361, -246.14085103616154, 28.155753833319732, -30.392059259647624, -1235.7587705134497, -1362.4795494607758, -430.24501265480393, -1249.057482405456, -421.05362836706917, -741.5802377275056, -1311.8109388385974, -62.15615850016483, -1151.3264829293707, -17.128448002291023, -1135.1774226433058, -234.68978197127302, -621.301533106196, -46.46431357747922, -541.4271935679311, -183.75038887205602, -35.814994399537845, 140.62238355928724, -1005.5208113096473, -536.9613976851998, -334.94377158178884, -744.7979876861212, -269.48557306464784, -91.7978702782644, -1074.1675755600181, 8.014315740236427, -1067.0685234525786, -53.17720654453779, -238.79575065421884, 87.19939138546637, -707.220871245196, -134.08237541906615, -1270.0603625805077, -1116.2094512198034, -419.3318658278441, 135.26363337429436, -626.6806959016023, -631.6305227266771, -125.40582404363002, 117.40898123727956, -332.61470333256256, 36.09989398176272, 40.0000000000003, -1098.890635857492, -982.0218992678779, -828.4173263101044, -876.4233913399156, -584.9087694487345, -707.5752975178785, -998.4185909112208, 39.17151716317368, -776.4315428287837, -666.6051177243489, -152.8079162492168, -1451.5408149276616, -68.01369950519333, -104.50350911356261, -840.6097867023525, 165.187626760044, -657.0441458200404, 30.09730783804449, -28.475082689642548, -386.2561505793016, 67.84922373520465, -1037.8914302299634, -1083.6576437979538, -931.2021087194881, -755.6284754566366, 264.1007326923225], "policy_predator_policy_reward": [1630.2747619632626, 1141.2509167337885, 81.6016963170157, 1277.189947872467, 48.08837406800152, 524.0622294669797, 1393.673318585528, 972.5744256721379, 1243.230544860145, 1176.794273616613, 1595.5167733816627, 1224.4653798129186, 993.426960682017, 325.7105996902478, 827.5965331386755, 1161.2466044981581, 47.93202743813271, 766.0874979403719, 445.9499676893566, 503.76329152482487, 1438.0081066749885, 1410.7821628312204, 311.4788614020069, 157.34461461831722, 83.27525388958583, 1361.5781510030974, 214.00008564973388, 313.0536354052289, 1208.1685651861476, 1451.1547631863798, 1122.5739868492942, 477.2898317210801, 529.979821466058, 489.31706057631646, 235.4821384302055, 482.797532766944, 709.2760494077605, 1356.8993458602035, 1605.0841886121111, 918.7665446522232, 1356.8611028468051, 1531.657490147435, 1299.781451053042, 572.6766921838762, 1177.7407591490542, 976.9724570630002, 1265.1707747010505, 822.2139908681428, 953.7226413606381, 1017.207115024714, 729.174339278644, 1333.6247330826225, 408.46066432846743, 135.657625712285, 445.9226348098897, 1222.4666185215258, 1345.8636916439716, 269.849932696769, 0.0, 0.0, 658.8228773944184, 119.23562633414289, 728.2064226128565, 1531.419638628513, 890.2386350426282, 248.62301843481296, 396.2679085908774, 1257.4605514933885, 800.6939754685002, 688.6587928431954, 1286.8225394407768, 754.5060386280323, 1199.8271143431316, 573.2016178887189, 1519.6669098953491, 1136.2626360549696, 628.5835161900335, 711.2023375672616, 912.7724196811763, 1417.459339797053, 196.403792841755, 750.2163714630934, 916.2050270766938, 1494.1561550581594, 41.32379340386871, 146.50281226938483, 1159.9722079074095, 1024.8150437875001, 462.6997830680037, 1176.580539723271, 1046.4159534303767, 1100.6230796981058, 420.906775727393, 360.21112546283075, 721.4111876114843, 813.5141934999625, 161.26263727096128, 1014.8570853289968, 701.1480119128324, 536.4907185304494, 1239.5724433377632, 607.6605758280604, 582.7552429571897, 532.6425146623351, 295.45278694615473, 946.1696751677588, 1401.0335200348968, 1328.375997161466, 1433.3390557924984, 838.9616907051133, 124.48952643683026, 783.9235025627273, 633.4704405929757, 1279.3247451571613, 14.781712198941287, 1349.5664761940245, 461.82743583905943, 626.4774662798396, 556.3472124051109, 775.58490721631, 215.378318261056, 734.5626629901827, 198.6911039263879, 634.287810013319, 687.8330973748343, 614.8891527333317, 131.06962024561287, 711.7179447889866, 229.10744008321862, 66.2642402714724, 1235.7587705134497, 88.32963090401162, 1411.8851419682837, 369.3621637928118, 1190.6517713764156, 671.940022856796, 779.1078105285665, 1314.8462005769459, 538.401676966683, 1131.3933598589624, 436.465565036454, 1071.5815023568512, 276.6292413482715, 719.8597785395924, 148.07544402600706, 644.314679537945, 143.37666966996446, 200.86278110378817, 292.86364793944426, 874.456285370417, 635.0911164462904, 828.2850883430526, 1011.5392385835715, 189.43724201123482, 665.3235987220684, 863.3625784404259, 234.31119998295475, 1070.3685234525792, 77.3653548517771, 267.5957506542181, 582.225859149765, 533.8523017957267, 352.12705675676347, 1268.2968116368727, 1120.3718027960135, 453.2354502603187, 717.5970859531759, 114.59073813306426, 205.3745523605285, 676.2976430161787, 316.69884084241767, 340.25496872970797, 3.5001060182375294, 0.0, 639.999143780617, 1416.0031818392708, 848.6638237194062, 886.336163795576, 594.2812616116129, 723.5796142725592, 998.4185909112208, 137.1625241133293, 861.4115918470088, 867.8439732966733, 239.38855068872564, 1454.8656304233157, 178.9003348589824, 144.70350911356076, 780.5399851685926, 317.4152573797858, 465.4409694300598, 258.82311293772057, 127.52242175379438, 395.48374193432613, 131.8159977958198, 1036.551544703559, 1080.5974702242934, 935.9376097788273, 432.10566902452763, 618.9468448711893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.844491270778819, "mean_inference_ms": 5.049373995068217, "mean_action_processing_ms": 2.0363681967914253, "mean_env_wait_ms": 13.090200719918279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006888031959533691, "StateBufferConnector_ms": 0.014363288879394531, "ViewRequirementAgentConnector_ms": 0.17042088508605957}, "num_episodes": 7, "episode_return_max": 607.438733923293, "episode_return_min": -24.91020950547903, "episode_return_mean": 188.6040011711661, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.14169748553826, "num_env_steps_trained_throughput_per_sec": 153.14169748553826, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 26348.257, "restore_workers_time_ms": 0.037, "training_step_time_ms": 26348.057, "sample_time_ms": 2479.944, "learn_time_ms": 23843.49, "learn_throughput": 167.761, "synch_weights_time_ms": 20.623}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-58-27", "timestamp": 1724383707, "time_this_iter_s": 26.16120409965515, "time_total_s": 1422.705281496048, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095bfee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1422.705281496048, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 36.178378378378376, "ram_util_percent": 83.12702702702704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.34857473827544, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.176208061137527, "policy_loss": -0.007842276968978464, "vf_loss": 6.182743085629095, "vf_explained_var": 0.5312666481134122, "kl": 0.006536292303452101, "entropy": 0.6229383093339426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50558.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.747830078841517, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.438394334581163, "policy_loss": -0.009690215509069502, "vf_loss": 6.446555370754666, "vf_explained_var": 0.5959996572247258, "kl": 0.007645942711286128, "entropy": 0.7400747945069005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50558.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 607.438733923293, "episode_reward_min": -24.91020950547903, "episode_reward_mean": 197.4337822153183, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1605.0841886121111, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.29604768994255, "predator_policy": 1605.0841886121111}, "policy_reward_mean": {"prey_policy": -605.8475276297713, "predator_policy": 704.5644187374306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.09413592438813, 106.52140402482414, 220.05546726114295, 1.7000000000000028, 320.7635021488285, 395.50343099314483, 498.30750071032537, 3.9999999999999982, 71.15030445899706, 241.0463207980684, 162.38240166538873, 107.11300778725683, 13.39999999999996, 0.09269328950713884, 12.26545686486699, 3.6921892474754707, 183.26206818350937, 120.86631890370995, 94.6804501418624, 138.09426154578986, 189.0157770262922, 121.03245714104119, 79.99999999999973, 410.2606285435013, 37.733831410235226, 175.69644875197287, 64.98203781838806, 324.2005526769731, 109.45205223505951, 56.45764670047399, 4.440892098500626e-15, 230.80459364743302, 5.9999999999999964, 45.774699510578955, 7.70974611066295, 567.7665189938064, 20.934086051292702, 94.55993276702127, 183.47985055996412, 217.07829000837944, 396.11690079929775, 506.359813427773, 607.438733923293, 581.7466409088128, 471.6883692681107, 176.26041662103592, 0.21821107072746226, 1.9984014443252818e-15, 245.28846200816812, 58.6094343340795, 43.23705700921394, 120.70000000000012, 367.1244151996396, 389.22227765521103, 245.56108697477868, 292.1142502654077, 316.28308553503587, 77.3865831518488, 57.93757164436414, -11.477256354483515, 192.48068346068519, 40.56283453940604, 456.31239539611215, 355.741196747707, 140.49770481039337, 204.49861641854048, 124.67406750215656, 302.421505559502, 591.4710355223544, 186.69291984403174, 362.720731324219, 245.6255157231909, 52.988148307240905, 496.05668108576566, 216.2811303940613, 38.0659360086855, 340.770761558933, 124.63584860639914, 441.74808747684455, 79.59999999999975, -24.91020950547903, 30.15926986496275, 25.37680891755862, 176.33404127650218, 286.21890459055084, 89.90544993516362, 151.08663535378736, 422.53308260607093, 97.3172443857799, 108.27493041917651, 198.32533600461863, 1.6753274856786957, 559.5247711314041, 503.8285229951546, 266.7483985891672, 11.399999999999977, 86.71979010089986, 450.7610278854967, 533.9763897044863, 99.53058216014564], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1149.1894867941069, -744.5595149183387, -183.6318022321888, -523.8663191214952, -427.2499676893556, -302.4078242636816, -1438.0081066749885, -1409.0821628312203, 203.373424585289, -351.4333984567803, 300.72817710355906, -1350.0781510030974, 25.85768577399905, -54.603906118638236, -1208.1685651861476, -1447.1547631863798, -1122.5739868492942, -406.1395272620834, -786.4806942936385, 8.230133049332524, -310.26351986054317, -245.63374967121797, -609.3491058978492, -1349.713281582856, -1605.0841886121111, -905.3665446522201, -1356.768409557298, -1531.657490147435, -1299.781451053042, -560.4112353190066, -1176.3407591490554, -974.6802678155243, -1265.1707747010505, -638.951922684633, -826.9066294325365, -1023.1568080491031, -1333.6247330826225, -634.4938891367808, 33.32223941805211, -439.34626791301014, -1218.672702802338, -260.70077350278495, -1344.0636916439732, -150.61747555572637, 40.0000000000003, 40.0000000000003, 289.4936050703146, -657.291480255374, -690.4725912026192, -1531.419638628513, -481.7824519217412, -481.382752803718, -331.2858707724871, -1257.4605514933885, -382.93934828650663, -782.2128673482133, -1288.3445789660373, -643.5319468677097, -612.0545657072427, -1104.5165198241343, -1519.6669098953491, -1136.2626360549696, -691.6637123332606, -417.3175477766007, -906.7724196811761, -1417.459339797053, -769.9452975475141, -130.90016724675547, -908.4952809660308, -1494.1561550581594, 387.29604768994255, -7.356134369390361, -1022.0675802582394, -1141.7855853853785, -229.79651598470184, -1314.9238740395476, -1354.0519854011402, -609.5071971673767, -585.3278926125354, 21.28828143069105, -706.7118475604832, -432.09663275166656, 353.97291383487254, -1023.7328230070594, 131.48482202029703, -761.6848185402866, -1264.6466145332454, -0.8397637237647047, -89.20581918709668, -554.5035691643174, -69.34869004319583, -996.0133554496825, -1502.4579892261233, -1226.7333168995128, -1433.3390557924984, -838.9616907051133, 97.59893557133833, -760.7235025627274, -540.054113890728, -1314.13163752533, 28.455344810272447, -1349.5664761940245, -413.1274358390593, -554.4774662798385, -238.0366226174782, -726.7710818043021, -450.71168394839265, -110.00701964763408, 52.53534625689632, -639.9531732218239, -935.6561560579547, -74.95184378480171, 83.36797820557345, -609.8724577051361, -246.14085103616154, 28.155753833319732, -30.392059259647624, -1235.7587705134497, -1362.4795494607758, -430.24501265480393, -1249.057482405456, -421.05362836706917, -741.5802377275056, -1311.8109388385974, -62.15615850016483, -1151.3264829293707, -17.128448002291023, -1135.1774226433058, -234.68978197127302, -621.301533106196, -46.46431357747922, -541.4271935679311, -183.75038887205602, -35.814994399537845, 140.62238355928724, -1005.5208113096473, -536.9613976851998, -334.94377158178884, -744.7979876861212, -269.48557306464784, -91.7978702782644, -1074.1675755600181, 8.014315740236427, -1067.0685234525786, -53.17720654453779, -238.79575065421884, 87.19939138546637, -707.220871245196, -134.08237541906615, -1270.0603625805077, -1116.2094512198034, -419.3318658278441, 135.26363337429436, -626.6806959016023, -631.6305227266771, -125.40582404363002, 117.40898123727956, -332.61470333256256, 36.09989398176272, 40.0000000000003, -1098.890635857492, -982.0218992678779, -828.4173263101044, -876.4233913399156, -584.9087694487345, -707.5752975178785, -998.4185909112208, 39.17151716317368, -776.4315428287837, -666.6051177243489, -152.8079162492168, -1451.5408149276616, -68.01369950519333, -104.50350911356261, -840.6097867023525, 165.187626760044, -657.0441458200404, 30.09730783804449, -28.475082689642548, -386.2561505793016, 67.84922373520465, -1037.8914302299634, -1083.6576437979538, -931.2021087194881, -755.6284754566366, 264.1007326923225, -112.06330849385513, -793.7947364161043, -355.79479407728843, -146.62698859584094, -648.1699946671857, -1364.542140420589, -361.8247750025718, -875.0617667772063, 259.6272560005731, -1105.341582010487, -984.1952406464627, 34.140486144224624, -240.0505519141883, -1391.0994602335084], "policy_predator_policy_reward": [827.5965331386755, 1161.2466044981581, 47.93202743813271, 766.0874979403719, 445.9499676893566, 503.76329152482487, 1438.0081066749885, 1410.7821628312204, 311.4788614020069, 157.34461461831722, 83.27525388958583, 1361.5781510030974, 214.00008564973388, 313.0536354052289, 1208.1685651861476, 1451.1547631863798, 1122.5739868492942, 477.2898317210801, 529.979821466058, 489.31706057631646, 235.4821384302055, 482.797532766944, 709.2760494077605, 1356.8993458602035, 1605.0841886121111, 918.7665446522232, 1356.8611028468051, 1531.657490147435, 1299.781451053042, 572.6766921838762, 1177.7407591490542, 976.9724570630002, 1265.1707747010505, 822.2139908681428, 953.7226413606381, 1017.207115024714, 729.174339278644, 1333.6247330826225, 408.46066432846743, 135.657625712285, 445.9226348098897, 1222.4666185215258, 1345.8636916439716, 269.849932696769, 0.0, 0.0, 658.8228773944184, 119.23562633414289, 728.2064226128565, 1531.419638628513, 890.2386350426282, 248.62301843481296, 396.2679085908774, 1257.4605514933885, 800.6939754685002, 688.6587928431954, 1286.8225394407768, 754.5060386280323, 1199.8271143431316, 573.2016178887189, 1519.6669098953491, 1136.2626360549696, 628.5835161900335, 711.2023375672616, 912.7724196811763, 1417.459339797053, 196.403792841755, 750.2163714630934, 916.2050270766938, 1494.1561550581594, 41.32379340386871, 146.50281226938483, 1159.9722079074095, 1024.8150437875001, 462.6997830680037, 1176.580539723271, 1046.4159534303767, 1100.6230796981058, 420.906775727393, 360.21112546283075, 721.4111876114843, 813.5141934999625, 161.26263727096128, 1014.8570853289968, 701.1480119128324, 536.4907185304494, 1239.5724433377632, 607.6605758280604, 582.7552429571897, 532.6425146623351, 295.45278694615473, 946.1696751677588, 1401.0335200348968, 1328.375997161466, 1433.3390557924984, 838.9616907051133, 124.48952643683026, 783.9235025627273, 633.4704405929757, 1279.3247451571613, 14.781712198941287, 1349.5664761940245, 461.82743583905943, 626.4774662798396, 556.3472124051109, 775.58490721631, 215.378318261056, 734.5626629901827, 198.6911039263879, 634.287810013319, 687.8330973748343, 614.8891527333317, 131.06962024561287, 711.7179447889866, 229.10744008321862, 66.2642402714724, 1235.7587705134497, 88.32963090401162, 1411.8851419682837, 369.3621637928118, 1190.6517713764156, 671.940022856796, 779.1078105285665, 1314.8462005769459, 538.401676966683, 1131.3933598589624, 436.465565036454, 1071.5815023568512, 276.6292413482715, 719.8597785395924, 148.07544402600706, 644.314679537945, 143.37666966996446, 200.86278110378817, 292.86364793944426, 874.456285370417, 635.0911164462904, 828.2850883430526, 1011.5392385835715, 189.43724201123482, 665.3235987220684, 863.3625784404259, 234.31119998295475, 1070.3685234525792, 77.3653548517771, 267.5957506542181, 582.225859149765, 533.8523017957267, 352.12705675676347, 1268.2968116368727, 1120.3718027960135, 453.2354502603187, 717.5970859531759, 114.59073813306426, 205.3745523605285, 676.2976430161787, 316.69884084241767, 340.25496872970797, 3.5001060182375294, 0.0, 639.999143780617, 1416.0031818392708, 848.6638237194062, 886.336163795576, 594.2812616116129, 723.5796142725592, 998.4185909112208, 137.1625241133293, 861.4115918470088, 867.8439732966733, 239.38855068872564, 1454.8656304233157, 178.9003348589824, 144.70350911356076, 780.5399851685926, 317.4152573797858, 465.4409694300598, 258.82311293772057, 127.52242175379438, 395.48374193432613, 131.8159977958198, 1036.551544703559, 1080.5974702242934, 935.9376097788273, 432.10566902452763, 618.9468448711893, 690.1467148558266, 719.5398530492846, 462.30411377569567, 306.86606748660495, 659.569994667186, 1364.542140420589, 362.3358183062556, 961.2705135744216, 955.2406504167993, 341.2347034786095, 883.2129540994429, 600.8181901072824, 336.67786535860034, 1394.002728949237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.833703133976302, "mean_inference_ms": 5.043618524895788, "mean_action_processing_ms": 2.02979813649986, "mean_env_wait_ms": 13.091410394341082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068950653076171875, "StateBufferConnector_ms": 0.014323949813842773, "ViewRequirementAgentConnector_ms": 0.16904854774475098}, "num_episodes": 7, "episode_return_max": 607.438733923293, "episode_return_min": -24.91020950547903, "episode_return_mean": 197.4337822153183, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.8556004976694, "num_env_steps_trained_throughput_per_sec": 151.8556004976694, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 26376.929, "restore_workers_time_ms": 0.037, "training_step_time_ms": 26376.726, "sample_time_ms": 2518.06, "learn_time_ms": 23832.458, "learn_throughput": 167.838, "synch_weights_time_ms": 22.152}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-58-54", "timestamp": 1724383734, "time_this_iter_s": 26.38308095932007, "time_total_s": 1449.088362455368, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095bf0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1449.088362455368, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 35.983783783783785, "ram_util_percent": 83.19459459459458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.759735257537276, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.12132254302817, "policy_loss": -0.008127887602452012, "vf_loss": 6.128083040853026, "vf_explained_var": 0.46500339558515597, "kl": 0.00683690058683395, "entropy": 0.6365703842311939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51503.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.6121750589401, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.4310330910657445, "policy_loss": -0.010278858946606753, "vf_loss": 6.43977578985628, "vf_explained_var": 0.6060175565815477, "kl": 0.0076807240780600635, "entropy": 0.7169613786475368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51503.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 607.438733923293, "episode_reward_min": -24.91020950547903, "episode_reward_mean": 187.73446566035048, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1605.0841886121111, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.29604768994255, "predator_policy": 1605.0841886121111}, "policy_reward_mean": {"prey_policy": -586.2981319685513, "predator_policy": 680.1653647987268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.15030445899706, 241.0463207980684, 162.38240166538873, 107.11300778725683, 13.39999999999996, 0.09269328950713884, 12.26545686486699, 3.6921892474754707, 183.26206818350937, 120.86631890370995, 94.6804501418624, 138.09426154578986, 189.0157770262922, 121.03245714104119, 79.99999999999973, 410.2606285435013, 37.733831410235226, 175.69644875197287, 64.98203781838806, 324.2005526769731, 109.45205223505951, 56.45764670047399, 4.440892098500626e-15, 230.80459364743302, 5.9999999999999964, 45.774699510578955, 7.70974611066295, 567.7665189938064, 20.934086051292702, 94.55993276702127, 183.47985055996412, 217.07829000837944, 396.11690079929775, 506.359813427773, 607.438733923293, 581.7466409088128, 471.6883692681107, 176.26041662103592, 0.21821107072746226, 1.9984014443252818e-15, 245.28846200816812, 58.6094343340795, 43.23705700921394, 120.70000000000012, 367.1244151996396, 389.22227765521103, 245.56108697477868, 292.1142502654077, 316.28308553503587, 77.3865831518488, 57.93757164436414, -11.477256354483515, 192.48068346068519, 40.56283453940604, 456.31239539611215, 355.741196747707, 140.49770481039337, 204.49861641854048, 124.67406750215656, 302.421505559502, 591.4710355223544, 186.69291984403174, 362.720731324219, 245.6255157231909, 52.988148307240905, 496.05668108576566, 216.2811303940613, 38.0659360086855, 340.770761558933, 124.63584860639914, 441.74808747684455, 79.59999999999975, -24.91020950547903, 30.15926986496275, 25.37680891755862, 176.33404127650218, 286.21890459055084, 89.90544993516362, 151.08663535378736, 422.53308260607093, 97.3172443857799, 108.27493041917651, 198.32533600461863, 1.6753274856786957, 559.5247711314041, 503.8285229951546, 266.7483985891672, 11.399999999999977, 86.71979010089986, 450.7610278854967, 533.9763897044863, 99.53058216014564, 32.17287383199998, 96.25144987856484, 49.21310151275964, 208.1399738922481, 91.1999999999991, 183.72397528109587, 11.312411169197262, 1.0436096431476471e-14], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1122.5739868492942, -406.1395272620834, -786.4806942936385, 8.230133049332524, -310.26351986054317, -245.63374967121797, -609.3491058978492, -1349.713281582856, -1605.0841886121111, -905.3665446522201, -1356.768409557298, -1531.657490147435, -1299.781451053042, -560.4112353190066, -1176.3407591490554, -974.6802678155243, -1265.1707747010505, -638.951922684633, -826.9066294325365, -1023.1568080491031, -1333.6247330826225, -634.4938891367808, 33.32223941805211, -439.34626791301014, -1218.672702802338, -260.70077350278495, -1344.0636916439732, -150.61747555572637, 40.0000000000003, 40.0000000000003, 289.4936050703146, -657.291480255374, -690.4725912026192, -1531.419638628513, -481.7824519217412, -481.382752803718, -331.2858707724871, -1257.4605514933885, -382.93934828650663, -782.2128673482133, -1288.3445789660373, -643.5319468677097, -612.0545657072427, -1104.5165198241343, -1519.6669098953491, -1136.2626360549696, -691.6637123332606, -417.3175477766007, -906.7724196811761, -1417.459339797053, -769.9452975475141, -130.90016724675547, -908.4952809660308, -1494.1561550581594, 387.29604768994255, -7.356134369390361, -1022.0675802582394, -1141.7855853853785, -229.79651598470184, -1314.9238740395476, -1354.0519854011402, -609.5071971673767, -585.3278926125354, 21.28828143069105, -706.7118475604832, -432.09663275166656, 353.97291383487254, -1023.7328230070594, 131.48482202029703, -761.6848185402866, -1264.6466145332454, -0.8397637237647047, -89.20581918709668, -554.5035691643174, -69.34869004319583, -996.0133554496825, -1502.4579892261233, -1226.7333168995128, -1433.3390557924984, -838.9616907051133, 97.59893557133833, -760.7235025627274, -540.054113890728, -1314.13163752533, 28.455344810272447, -1349.5664761940245, -413.1274358390593, -554.4774662798385, -238.0366226174782, -726.7710818043021, -450.71168394839265, -110.00701964763408, 52.53534625689632, -639.9531732218239, -935.6561560579547, -74.95184378480171, 83.36797820557345, -609.8724577051361, -246.14085103616154, 28.155753833319732, -30.392059259647624, -1235.7587705134497, -1362.4795494607758, -430.24501265480393, -1249.057482405456, -421.05362836706917, -741.5802377275056, -1311.8109388385974, -62.15615850016483, -1151.3264829293707, -17.128448002291023, -1135.1774226433058, -234.68978197127302, -621.301533106196, -46.46431357747922, -541.4271935679311, -183.75038887205602, -35.814994399537845, 140.62238355928724, -1005.5208113096473, -536.9613976851998, -334.94377158178884, -744.7979876861212, -269.48557306464784, -91.7978702782644, -1074.1675755600181, 8.014315740236427, -1067.0685234525786, -53.17720654453779, -238.79575065421884, 87.19939138546637, -707.220871245196, -134.08237541906615, -1270.0603625805077, -1116.2094512198034, -419.3318658278441, 135.26363337429436, -626.6806959016023, -631.6305227266771, -125.40582404363002, 117.40898123727956, -332.61470333256256, 36.09989398176272, 40.0000000000003, -1098.890635857492, -982.0218992678779, -828.4173263101044, -876.4233913399156, -584.9087694487345, -707.5752975178785, -998.4185909112208, 39.17151716317368, -776.4315428287837, -666.6051177243489, -152.8079162492168, -1451.5408149276616, -68.01369950519333, -104.50350911356261, -840.6097867023525, 165.187626760044, -657.0441458200404, 30.09730783804449, -28.475082689642548, -386.2561505793016, 67.84922373520465, -1037.8914302299634, -1083.6576437979538, -931.2021087194881, -755.6284754566366, 264.1007326923225, -112.06330849385513, -793.7947364161043, -355.79479407728843, -146.62698859584094, -648.1699946671857, -1364.542140420589, -361.8247750025718, -875.0617667772063, 259.6272560005731, -1105.341582010487, -984.1952406464627, 34.140486144224624, -240.0505519141883, -1391.0994602335084, -374.1489193626765, -20.432024824524007, -749.0473111803309, 36.053210978509306, -873.1729553320633, -179.95975757094666, -716.3924546133046, 31.276458897040452, 28.875111803975468, -4.067704664965106, -15.676905482390737, 61.917763741363196, -648.2007068021167, -36.92506428587774, -1332.6826028815321, -1357.0116871897183], "policy_predator_policy_reward": [1122.5739868492942, 477.2898317210801, 529.979821466058, 489.31706057631646, 235.4821384302055, 482.797532766944, 709.2760494077605, 1356.8993458602035, 1605.0841886121111, 918.7665446522232, 1356.8611028468051, 1531.657490147435, 1299.781451053042, 572.6766921838762, 1177.7407591490542, 976.9724570630002, 1265.1707747010505, 822.2139908681428, 953.7226413606381, 1017.207115024714, 729.174339278644, 1333.6247330826225, 408.46066432846743, 135.657625712285, 445.9226348098897, 1222.4666185215258, 1345.8636916439716, 269.849932696769, 0.0, 0.0, 658.8228773944184, 119.23562633414289, 728.2064226128565, 1531.419638628513, 890.2386350426282, 248.62301843481296, 396.2679085908774, 1257.4605514933885, 800.6939754685002, 688.6587928431954, 1286.8225394407768, 754.5060386280323, 1199.8271143431316, 573.2016178887189, 1519.6669098953491, 1136.2626360549696, 628.5835161900335, 711.2023375672616, 912.7724196811763, 1417.459339797053, 196.403792841755, 750.2163714630934, 916.2050270766938, 1494.1561550581594, 41.32379340386871, 146.50281226938483, 1159.9722079074095, 1024.8150437875001, 462.6997830680037, 1176.580539723271, 1046.4159534303767, 1100.6230796981058, 420.906775727393, 360.21112546283075, 721.4111876114843, 813.5141934999625, 161.26263727096128, 1014.8570853289968, 701.1480119128324, 536.4907185304494, 1239.5724433377632, 607.6605758280604, 582.7552429571897, 532.6425146623351, 295.45278694615473, 946.1696751677588, 1401.0335200348968, 1328.375997161466, 1433.3390557924984, 838.9616907051133, 124.48952643683026, 783.9235025627273, 633.4704405929757, 1279.3247451571613, 14.781712198941287, 1349.5664761940245, 461.82743583905943, 626.4774662798396, 556.3472124051109, 775.58490721631, 215.378318261056, 734.5626629901827, 198.6911039263879, 634.287810013319, 687.8330973748343, 614.8891527333317, 131.06962024561287, 711.7179447889866, 229.10744008321862, 66.2642402714724, 1235.7587705134497, 88.32963090401162, 1411.8851419682837, 369.3621637928118, 1190.6517713764156, 671.940022856796, 779.1078105285665, 1314.8462005769459, 538.401676966683, 1131.3933598589624, 436.465565036454, 1071.5815023568512, 276.6292413482715, 719.8597785395924, 148.07544402600706, 644.314679537945, 143.37666966996446, 200.86278110378817, 292.86364793944426, 874.456285370417, 635.0911164462904, 828.2850883430526, 1011.5392385835715, 189.43724201123482, 665.3235987220684, 863.3625784404259, 234.31119998295475, 1070.3685234525792, 77.3653548517771, 267.5957506542181, 582.225859149765, 533.8523017957267, 352.12705675676347, 1268.2968116368727, 1120.3718027960135, 453.2354502603187, 717.5970859531759, 114.59073813306426, 205.3745523605285, 676.2976430161787, 316.69884084241767, 340.25496872970797, 3.5001060182375294, 0.0, 639.999143780617, 1416.0031818392708, 848.6638237194062, 886.336163795576, 594.2812616116129, 723.5796142725592, 998.4185909112208, 137.1625241133293, 861.4115918470088, 867.8439732966733, 239.38855068872564, 1454.8656304233157, 178.9003348589824, 144.70350911356076, 780.5399851685926, 317.4152573797858, 465.4409694300598, 258.82311293772057, 127.52242175379438, 395.48374193432613, 131.8159977958198, 1036.551544703559, 1080.5974702242934, 935.9376097788273, 432.10566902452763, 618.9468448711893, 690.1467148558266, 719.5398530492846, 462.30411377569567, 306.86606748660495, 659.569994667186, 1364.542140420589, 362.3358183062556, 961.2705135744216, 955.2406504167993, 341.2347034786095, 883.2129540994429, 600.8181901072824, 336.67786535860034, 1394.002728949237, 416.32712561594957, 10.426692403254055, 475.96986743438237, 333.2756826460063, 887.0729553320634, 215.2728590837046, 183.26019480726862, 709.9957748012458, 25.72488819602466, 40.66770466496541, 81.82231827039422, 55.6607987517329, 684.0709533086765, 12.367228948517038, 1332.6826028815321, 1357.0116871897183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.833323505546723, "mean_inference_ms": 5.024668603890542, "mean_action_processing_ms": 2.023743394157643, "mean_env_wait_ms": 13.087217096144569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005265235900878906, "StateBufferConnector_ms": 0.013659238815307617, "ViewRequirementAgentConnector_ms": 0.16320788860321045}, "num_episodes": 8, "episode_return_max": 607.438733923293, "episode_return_min": -24.91020950547903, "episode_return_mean": 187.73446566035048, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.57643645018598, "num_env_steps_trained_throughput_per_sec": 152.57643645018598, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 26390.942, "restore_workers_time_ms": 0.062, "training_step_time_ms": 26390.666, "sample_time_ms": 2513.688, "learn_time_ms": 23851.48, "learn_throughput": 167.704, "synch_weights_time_ms": 21.987}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-59-20", "timestamp": 1724383760, "time_this_iter_s": 26.2535560131073, "time_total_s": 1475.3419184684753, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095a6310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1475.3419184684753, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 34.07297297297298, "ram_util_percent": 82.93783783783785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.35103818424164, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.3914260339484645, "policy_loss": -0.007885284390714434, "vf_loss": 6.39800007885726, "vf_explained_var": 0.4323110719206472, "kl": 0.0065561222025838795, "entropy": 0.6006943860697368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 52448.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.36737468053424, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.303192700784673, "policy_loss": -0.008563388926445176, "vf_loss": 6.310297649121158, "vf_explained_var": 0.6419925952714587, "kl": 0.007291985951147224, "entropy": 0.6930768544081027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 52448.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 607.438733923293, "episode_reward_min": -197.47255801072097, "episode_reward_mean": 194.09545427640077, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1531.419638628513, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.29604768994255, "predator_policy": 1531.419638628513}, "policy_reward_mean": {"prey_policy": -536.9959205646484, "predator_policy": 634.0436477028491}, "custom_metrics": {}, "hist_stats": {"episode_reward": [138.09426154578986, 189.0157770262922, 121.03245714104119, 79.99999999999973, 410.2606285435013, 37.733831410235226, 175.69644875197287, 64.98203781838806, 324.2005526769731, 109.45205223505951, 56.45764670047399, 4.440892098500626e-15, 230.80459364743302, 5.9999999999999964, 45.774699510578955, 7.70974611066295, 567.7665189938064, 20.934086051292702, 94.55993276702127, 183.47985055996412, 217.07829000837944, 396.11690079929775, 506.359813427773, 607.438733923293, 581.7466409088128, 471.6883692681107, 176.26041662103592, 0.21821107072746226, 1.9984014443252818e-15, 245.28846200816812, 58.6094343340795, 43.23705700921394, 120.70000000000012, 367.1244151996396, 389.22227765521103, 245.56108697477868, 292.1142502654077, 316.28308553503587, 77.3865831518488, 57.93757164436414, -11.477256354483515, 192.48068346068519, 40.56283453940604, 456.31239539611215, 355.741196747707, 140.49770481039337, 204.49861641854048, 124.67406750215656, 302.421505559502, 591.4710355223544, 186.69291984403174, 362.720731324219, 245.6255157231909, 52.988148307240905, 496.05668108576566, 216.2811303940613, 38.0659360086855, 340.770761558933, 124.63584860639914, 441.74808747684455, 79.59999999999975, -24.91020950547903, 30.15926986496275, 25.37680891755862, 176.33404127650218, 286.21890459055084, 89.90544993516362, 151.08663535378736, 422.53308260607093, 97.3172443857799, 108.27493041917651, 198.32533600461863, 1.6753274856786957, 559.5247711314041, 503.8285229951546, 266.7483985891672, 11.399999999999977, 86.71979010089986, 450.7610278854967, 533.9763897044863, 99.53058216014564, 32.17287383199998, 96.25144987856484, 49.21310151275964, 208.1399738922481, 91.1999999999991, 183.72397528109587, 11.312411169197262, 1.0436096431476471e-14, 50.36917158798956, 21.093790471640773, 200.7513796049921, 468.86853932932627, 17.126097289554185, 21.61719365766879, 430.8557932965988, 91.66596167210584, 73.6933952924178, -197.47255801072097, 467.48130875410925], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [33.32223941805211, -439.34626791301014, -1218.672702802338, -260.70077350278495, -1344.0636916439732, -150.61747555572637, 40.0000000000003, 40.0000000000003, 289.4936050703146, -657.291480255374, -690.4725912026192, -1531.419638628513, -481.7824519217412, -481.382752803718, -331.2858707724871, -1257.4605514933885, -382.93934828650663, -782.2128673482133, -1288.3445789660373, -643.5319468677097, -612.0545657072427, -1104.5165198241343, -1519.6669098953491, -1136.2626360549696, -691.6637123332606, -417.3175477766007, -906.7724196811761, -1417.459339797053, -769.9452975475141, -130.90016724675547, -908.4952809660308, -1494.1561550581594, 387.29604768994255, -7.356134369390361, -1022.0675802582394, -1141.7855853853785, -229.79651598470184, -1314.9238740395476, -1354.0519854011402, -609.5071971673767, -585.3278926125354, 21.28828143069105, -706.7118475604832, -432.09663275166656, 353.97291383487254, -1023.7328230070594, 131.48482202029703, -761.6848185402866, -1264.6466145332454, -0.8397637237647047, -89.20581918709668, -554.5035691643174, -69.34869004319583, -996.0133554496825, -1502.4579892261233, -1226.7333168995128, -1433.3390557924984, -838.9616907051133, 97.59893557133833, -760.7235025627274, -540.054113890728, -1314.13163752533, 28.455344810272447, -1349.5664761940245, -413.1274358390593, -554.4774662798385, -238.0366226174782, -726.7710818043021, -450.71168394839265, -110.00701964763408, 52.53534625689632, -639.9531732218239, -935.6561560579547, -74.95184378480171, 83.36797820557345, -609.8724577051361, -246.14085103616154, 28.155753833319732, -30.392059259647624, -1235.7587705134497, -1362.4795494607758, -430.24501265480393, -1249.057482405456, -421.05362836706917, -741.5802377275056, -1311.8109388385974, -62.15615850016483, -1151.3264829293707, -17.128448002291023, -1135.1774226433058, -234.68978197127302, -621.301533106196, -46.46431357747922, -541.4271935679311, -183.75038887205602, -35.814994399537845, 140.62238355928724, -1005.5208113096473, -536.9613976851998, -334.94377158178884, -744.7979876861212, -269.48557306464784, -91.7978702782644, -1074.1675755600181, 8.014315740236427, -1067.0685234525786, -53.17720654453779, -238.79575065421884, 87.19939138546637, -707.220871245196, -134.08237541906615, -1270.0603625805077, -1116.2094512198034, -419.3318658278441, 135.26363337429436, -626.6806959016023, -631.6305227266771, -125.40582404363002, 117.40898123727956, -332.61470333256256, 36.09989398176272, 40.0000000000003, -1098.890635857492, -982.0218992678779, -828.4173263101044, -876.4233913399156, -584.9087694487345, -707.5752975178785, -998.4185909112208, 39.17151716317368, -776.4315428287837, -666.6051177243489, -152.8079162492168, -1451.5408149276616, -68.01369950519333, -104.50350911356261, -840.6097867023525, 165.187626760044, -657.0441458200404, 30.09730783804449, -28.475082689642548, -386.2561505793016, 67.84922373520465, -1037.8914302299634, -1083.6576437979538, -931.2021087194881, -755.6284754566366, 264.1007326923225, -112.06330849385513, -793.7947364161043, -355.79479407728843, -146.62698859584094, -648.1699946671857, -1364.542140420589, -361.8247750025718, -875.0617667772063, 259.6272560005731, -1105.341582010487, -984.1952406464627, 34.140486144224624, -240.0505519141883, -1391.0994602335084, -374.1489193626765, -20.432024824524007, -749.0473111803309, 36.053210978509306, -873.1729553320633, -179.95975757094666, -716.3924546133046, 31.276458897040452, 28.875111803975468, -4.067704664965106, -15.676905482390737, 61.917763741363196, -648.2007068021167, -36.92506428587774, -1332.6826028815321, -1357.0116871897183, -402.1120495423536, -850.0959376048418, -77.28724751682262, -417.2016858293837, -229.63503284946194, -1209.3243598340168, 227.27364020158407, -592.8514001052765, -105.12984502742783, -916.4758664854489, -577.5648278912483, -1418.3006487600117, 237.28895566949322, -543.0589470549434, 8.339516582138641, -95.7730429002218, -529.9778370529801, -574.2332645527018, -429.8814435592703, -610.2053867532566, -1025.3884071354946, 37.718563021949784], "policy_predator_policy_reward": [408.46066432846743, 135.657625712285, 445.9226348098897, 1222.4666185215258, 1345.8636916439716, 269.849932696769, 0.0, 0.0, 658.8228773944184, 119.23562633414289, 728.2064226128565, 1531.419638628513, 890.2386350426282, 248.62301843481296, 396.2679085908774, 1257.4605514933885, 800.6939754685002, 688.6587928431954, 1286.8225394407768, 754.5060386280323, 1199.8271143431316, 573.2016178887189, 1519.6669098953491, 1136.2626360549696, 628.5835161900335, 711.2023375672616, 912.7724196811763, 1417.459339797053, 196.403792841755, 750.2163714630934, 916.2050270766938, 1494.1561550581594, 41.32379340386871, 146.50281226938483, 1159.9722079074095, 1024.8150437875001, 462.6997830680037, 1176.580539723271, 1046.4159534303767, 1100.6230796981058, 420.906775727393, 360.21112546283075, 721.4111876114843, 813.5141934999625, 161.26263727096128, 1014.8570853289968, 701.1480119128324, 536.4907185304494, 1239.5724433377632, 607.6605758280604, 582.7552429571897, 532.6425146623351, 295.45278694615473, 946.1696751677588, 1401.0335200348968, 1328.375997161466, 1433.3390557924984, 838.9616907051133, 124.48952643683026, 783.9235025627273, 633.4704405929757, 1279.3247451571613, 14.781712198941287, 1349.5664761940245, 461.82743583905943, 626.4774662798396, 556.3472124051109, 775.58490721631, 215.378318261056, 734.5626629901827, 198.6911039263879, 634.287810013319, 687.8330973748343, 614.8891527333317, 131.06962024561287, 711.7179447889866, 229.10744008321862, 66.2642402714724, 1235.7587705134497, 88.32963090401162, 1411.8851419682837, 369.3621637928118, 1190.6517713764156, 671.940022856796, 779.1078105285665, 1314.8462005769459, 538.401676966683, 1131.3933598589624, 436.465565036454, 1071.5815023568512, 276.6292413482715, 719.8597785395924, 148.07544402600706, 644.314679537945, 143.37666966996446, 200.86278110378817, 292.86364793944426, 874.456285370417, 635.0911164462904, 828.2850883430526, 1011.5392385835715, 189.43724201123482, 665.3235987220684, 863.3625784404259, 234.31119998295475, 1070.3685234525792, 77.3653548517771, 267.5957506542181, 582.225859149765, 533.8523017957267, 352.12705675676347, 1268.2968116368727, 1120.3718027960135, 453.2354502603187, 717.5970859531759, 114.59073813306426, 205.3745523605285, 676.2976430161787, 316.69884084241767, 340.25496872970797, 3.5001060182375294, 0.0, 639.999143780617, 1416.0031818392708, 848.6638237194062, 886.336163795576, 594.2812616116129, 723.5796142725592, 998.4185909112208, 137.1625241133293, 861.4115918470088, 867.8439732966733, 239.38855068872564, 1454.8656304233157, 178.9003348589824, 144.70350911356076, 780.5399851685926, 317.4152573797858, 465.4409694300598, 258.82311293772057, 127.52242175379438, 395.48374193432613, 131.8159977958198, 1036.551544703559, 1080.5974702242934, 935.9376097788273, 432.10566902452763, 618.9468448711893, 690.1467148558266, 719.5398530492846, 462.30411377569567, 306.86606748660495, 659.569994667186, 1364.542140420589, 362.3358183062556, 961.2705135744216, 955.2406504167993, 341.2347034786095, 883.2129540994429, 600.8181901072824, 336.67786535860034, 1394.002728949237, 416.32712561594957, 10.426692403254055, 475.96986743438237, 333.2756826460063, 887.0729553320634, 215.2728590837046, 183.26019480726862, 709.9957748012458, 25.72488819602466, 40.66770466496541, 81.82231827039422, 55.6607987517329, 684.0709533086765, 12.367228948517038, 1332.6826028815321, 1357.0116871897183, 446.74954625936164, 855.8276124758265, 29.804071778210794, 485.778652039638, 571.8714943272736, 1067.8392779612036, 342.40959639911193, 492.0367028339055, 121.73064019661786, 917.0011686058116, 599.1820215489205, 1418.3006487600117, 218.29603468837058, 518.3297499936747, 60.31141008867726, 118.78807790151116, 488.84213947020874, 689.0623574278939, 193.5819674409294, 649.032304860877, 844.0646326347079, 611.0865202329402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.812421361302824, "mean_inference_ms": 5.023106138550987, "mean_action_processing_ms": 2.0143420361736726, "mean_env_wait_ms": 13.072115767773417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005220651626586914, "StateBufferConnector_ms": 0.012722492218017578, "ViewRequirementAgentConnector_ms": 0.16434168815612793}, "num_episodes": 11, "episode_return_max": 607.438733923293, "episode_return_min": -197.47255801072097, "episode_return_mean": 194.09545427640077, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.13643742678067, "num_env_steps_trained_throughput_per_sec": 150.13643742678067, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 26439.029, "restore_workers_time_ms": 0.062, "training_step_time_ms": 26438.755, "sample_time_ms": 2524.206, "learn_time_ms": 23888.711, "learn_throughput": 167.443, "synch_weights_time_ms": 22.214}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "dcfd0_00000", "date": "2024-08-23_08-59-47", "timestamp": 1724383787, "time_this_iter_s": 26.699270963668823, "time_total_s": 1502.0411894321442, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095d18b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1502.0411894321442, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 35.05263157894737, "ram_util_percent": 82.09473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.930340239862915, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.341966842469715, "policy_loss": -0.006543795246798447, "vf_loss": 6.347269641533099, "vf_explained_var": 0.47622595918241634, "kl": 0.006204834881869376, "entropy": 0.59886423264231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53393.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.190302929802545, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.175011041933898, "policy_loss": -0.01150315601905936, "vf_loss": 6.184941638966717, "vf_explained_var": 0.5573018921115411, "kl": 0.007862782145224552, "entropy": 0.691360869735637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53393.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 607.438733923293, "episode_reward_min": -197.47255801072097, "episode_reward_mean": 206.0898864074082, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1502.4579892261233, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.29604768994255, "predator_policy": 1454.8656304233157}, "policy_reward_mean": {"prey_policy": -492.95977561377003, "predator_policy": 596.0047188174741}, "custom_metrics": {}, "hist_stats": {"episode_reward": [567.7665189938064, 20.934086051292702, 94.55993276702127, 183.47985055996412, 217.07829000837944, 396.11690079929775, 506.359813427773, 607.438733923293, 581.7466409088128, 471.6883692681107, 176.26041662103592, 0.21821107072746226, 1.9984014443252818e-15, 245.28846200816812, 58.6094343340795, 43.23705700921394, 120.70000000000012, 367.1244151996396, 389.22227765521103, 245.56108697477868, 292.1142502654077, 316.28308553503587, 77.3865831518488, 57.93757164436414, -11.477256354483515, 192.48068346068519, 40.56283453940604, 456.31239539611215, 355.741196747707, 140.49770481039337, 204.49861641854048, 124.67406750215656, 302.421505559502, 591.4710355223544, 186.69291984403174, 362.720731324219, 245.6255157231909, 52.988148307240905, 496.05668108576566, 216.2811303940613, 38.0659360086855, 340.770761558933, 124.63584860639914, 441.74808747684455, 79.59999999999975, -24.91020950547903, 30.15926986496275, 25.37680891755862, 176.33404127650218, 286.21890459055084, 89.90544993516362, 151.08663535378736, 422.53308260607093, 97.3172443857799, 108.27493041917651, 198.32533600461863, 1.6753274856786957, 559.5247711314041, 503.8285229951546, 266.7483985891672, 11.399999999999977, 86.71979010089986, 450.7610278854967, 533.9763897044863, 99.53058216014564, 32.17287383199998, 96.25144987856484, 49.21310151275964, 208.1399738922481, 91.1999999999991, 183.72397528109587, 11.312411169197262, 1.0436096431476471e-14, 50.36917158798956, 21.093790471640773, 200.7513796049921, 468.86853932932627, 17.126097289554185, 21.61719365766879, 430.8557932965988, 91.66596167210584, 73.6933952924178, -197.47255801072097, 467.48130875410925, 85.5912169517407, 382.9475381821588, 297.2721240486135, 106.09113791065218, 172.4224005962293, 13.899999999999968, -53.91863077846627, 179.28947414794607, 143.39999999999998, 89.19421500251279, 56.41288742942442, 468.4364041495805, 447.29914892209285, 483.9601138958951, 146.58755132155562, 177.77236443920762], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [387.29604768994255, -7.356134369390361, -1022.0675802582394, -1141.7855853853785, -229.79651598470184, -1314.9238740395476, -1354.0519854011402, -609.5071971673767, -585.3278926125354, 21.28828143069105, -706.7118475604832, -432.09663275166656, 353.97291383487254, -1023.7328230070594, 131.48482202029703, -761.6848185402866, -1264.6466145332454, -0.8397637237647047, -89.20581918709668, -554.5035691643174, -69.34869004319583, -996.0133554496825, -1502.4579892261233, -1226.7333168995128, -1433.3390557924984, -838.9616907051133, 97.59893557133833, -760.7235025627274, -540.054113890728, -1314.13163752533, 28.455344810272447, -1349.5664761940245, -413.1274358390593, -554.4774662798385, -238.0366226174782, -726.7710818043021, -450.71168394839265, -110.00701964763408, 52.53534625689632, -639.9531732218239, -935.6561560579547, -74.95184378480171, 83.36797820557345, -609.8724577051361, -246.14085103616154, 28.155753833319732, -30.392059259647624, -1235.7587705134497, -1362.4795494607758, -430.24501265480393, -1249.057482405456, -421.05362836706917, -741.5802377275056, -1311.8109388385974, -62.15615850016483, -1151.3264829293707, -17.128448002291023, -1135.1774226433058, -234.68978197127302, -621.301533106196, -46.46431357747922, -541.4271935679311, -183.75038887205602, -35.814994399537845, 140.62238355928724, -1005.5208113096473, -536.9613976851998, -334.94377158178884, -744.7979876861212, -269.48557306464784, -91.7978702782644, -1074.1675755600181, 8.014315740236427, -1067.0685234525786, -53.17720654453779, -238.79575065421884, 87.19939138546637, -707.220871245196, -134.08237541906615, -1270.0603625805077, -1116.2094512198034, -419.3318658278441, 135.26363337429436, -626.6806959016023, -631.6305227266771, -125.40582404363002, 117.40898123727956, -332.61470333256256, 36.09989398176272, 40.0000000000003, -1098.890635857492, -982.0218992678779, -828.4173263101044, -876.4233913399156, -584.9087694487345, -707.5752975178785, -998.4185909112208, 39.17151716317368, -776.4315428287837, -666.6051177243489, -152.8079162492168, -1451.5408149276616, -68.01369950519333, -104.50350911356261, -840.6097867023525, 165.187626760044, -657.0441458200404, 30.09730783804449, -28.475082689642548, -386.2561505793016, 67.84922373520465, -1037.8914302299634, -1083.6576437979538, -931.2021087194881, -755.6284754566366, 264.1007326923225, -112.06330849385513, -793.7947364161043, -355.79479407728843, -146.62698859584094, -648.1699946671857, -1364.542140420589, -361.8247750025718, -875.0617667772063, 259.6272560005731, -1105.341582010487, -984.1952406464627, 34.140486144224624, -240.0505519141883, -1391.0994602335084, -374.1489193626765, -20.432024824524007, -749.0473111803309, 36.053210978509306, -873.1729553320633, -179.95975757094666, -716.3924546133046, 31.276458897040452, 28.875111803975468, -4.067704664965106, -15.676905482390737, 61.917763741363196, -648.2007068021167, -36.92506428587774, -1332.6826028815321, -1357.0116871897183, -402.1120495423536, -850.0959376048418, -77.28724751682262, -417.2016858293837, -229.63503284946194, -1209.3243598340168, 227.27364020158407, -592.8514001052765, -105.12984502742783, -916.4758664854489, -577.5648278912483, -1418.3006487600117, 237.28895566949322, -543.0589470549434, 8.339516582138641, -95.7730429002218, -529.9778370529801, -574.2332645527018, -429.8814435592703, -610.2053867532566, -1025.3884071354946, 37.718563021949784, 32.02818546858089, -1231.7809775784142, 136.65277969938884, -799.3167061261486, -169.311522455225, 88.2249260441813, 60.71335979548353, -62.97036690633241, 38.04816980656291, -341.4602621584156, -1184.5854040280371, -529.7089476422989, -626.8424243128787, -1064.249807835271, -68.72954809579184, -959.2056391571925, -562.5827210806431, -117.99704770036983, -695.9670886217941, -286.66517500663383, -952.3119006555183, -201.05872467108927, -785.7130372142863, -18.724498985175188, 40.0000000000003, -863.8423793930607, -225.5534615989855, -965.1797053706829, -260.3482960381992, -358.04472154343534, -925.0904161525262, 20.88265232587309], "policy_predator_policy_reward": [41.32379340386871, 146.50281226938483, 1159.9722079074095, 1024.8150437875001, 462.6997830680037, 1176.580539723271, 1046.4159534303767, 1100.6230796981058, 420.906775727393, 360.21112546283075, 721.4111876114843, 813.5141934999625, 161.26263727096128, 1014.8570853289968, 701.1480119128324, 536.4907185304494, 1239.5724433377632, 607.6605758280604, 582.7552429571897, 532.6425146623351, 295.45278694615473, 946.1696751677588, 1401.0335200348968, 1328.375997161466, 1433.3390557924984, 838.9616907051133, 124.48952643683026, 783.9235025627273, 633.4704405929757, 1279.3247451571613, 14.781712198941287, 1349.5664761940245, 461.82743583905943, 626.4774662798396, 556.3472124051109, 775.58490721631, 215.378318261056, 734.5626629901827, 198.6911039263879, 634.287810013319, 687.8330973748343, 614.8891527333317, 131.06962024561287, 711.7179447889866, 229.10744008321862, 66.2642402714724, 1235.7587705134497, 88.32963090401162, 1411.8851419682837, 369.3621637928118, 1190.6517713764156, 671.940022856796, 779.1078105285665, 1314.8462005769459, 538.401676966683, 1131.3933598589624, 436.465565036454, 1071.5815023568512, 276.6292413482715, 719.8597785395924, 148.07544402600706, 644.314679537945, 143.37666966996446, 200.86278110378817, 292.86364793944426, 874.456285370417, 635.0911164462904, 828.2850883430526, 1011.5392385835715, 189.43724201123482, 665.3235987220684, 863.3625784404259, 234.31119998295475, 1070.3685234525792, 77.3653548517771, 267.5957506542181, 582.225859149765, 533.8523017957267, 352.12705675676347, 1268.2968116368727, 1120.3718027960135, 453.2354502603187, 717.5970859531759, 114.59073813306426, 205.3745523605285, 676.2976430161787, 316.69884084241767, 340.25496872970797, 3.5001060182375294, 0.0, 639.999143780617, 1416.0031818392708, 848.6638237194062, 886.336163795576, 594.2812616116129, 723.5796142725592, 998.4185909112208, 137.1625241133293, 861.4115918470088, 867.8439732966733, 239.38855068872564, 1454.8656304233157, 178.9003348589824, 144.70350911356076, 780.5399851685926, 317.4152573797858, 465.4409694300598, 258.82311293772057, 127.52242175379438, 395.48374193432613, 131.8159977958198, 1036.551544703559, 1080.5974702242934, 935.9376097788273, 432.10566902452763, 618.9468448711893, 690.1467148558266, 719.5398530492846, 462.30411377569567, 306.86606748660495, 659.569994667186, 1364.542140420589, 362.3358183062556, 961.2705135744216, 955.2406504167993, 341.2347034786095, 883.2129540994429, 600.8181901072824, 336.67786535860034, 1394.002728949237, 416.32712561594957, 10.426692403254055, 475.96986743438237, 333.2756826460063, 887.0729553320634, 215.2728590837046, 183.26019480726862, 709.9957748012458, 25.72488819602466, 40.66770466496541, 81.82231827039422, 55.6607987517329, 684.0709533086765, 12.367228948517038, 1332.6826028815321, 1357.0116871897183, 446.74954625936164, 855.8276124758265, 29.804071778210794, 485.778652039638, 571.8714943272736, 1067.8392779612036, 342.40959639911193, 492.0367028339055, 121.73064019661786, 917.0011686058116, 599.1820215489205, 1418.3006487600117, 218.29603468837058, 518.3297499936747, 60.31141008867726, 118.78807790151116, 488.84213947020874, 689.0623574278939, 193.5819674409294, 649.032304860877, 844.0646326347079, 611.0865202329402, 53.56303148316105, 1231.7809775784142, 355.83695716984346, 689.7745074390745, 155.64046108919675, 222.71825937044974, 0.0, 108.34814502149929, 291.64847785624585, 184.1860150918383, 1184.9854040280372, 543.2089476423017, 560.0317469805306, 1077.1418543891564, 261.55148911962095, 945.6731722813108, 569.8827210806436, 254.0970477003692, 695.5137195430933, 376.31275908784863, 435.41901234868124, 774.364500407348, 474.71148963231155, 798.1624507167273, 414.5422056273117, 856.5993226878404, 748.817686767457, 925.875594098105, 597.7101818821134, 167.27038702107563, 768.1386164456942, 313.8415118201679]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.790019769726358, "mean_inference_ms": 5.013317969679671, "mean_action_processing_ms": 2.009869117389425, "mean_env_wait_ms": 13.079047390253283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004830002784729004, "StateBufferConnector_ms": 0.012624859809875488, "ViewRequirementAgentConnector_ms": 0.1436769962310791}, "num_episodes": 16, "episode_return_max": 607.438733923293, "episode_return_min": -197.47255801072097, "episode_return_mean": 206.0898864074082, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.14370466178144, "num_env_steps_trained_throughput_per_sec": 154.14370466178144, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 26447.369, "restore_workers_time_ms": 0.061, "training_step_time_ms": 26447.092, "sample_time_ms": 2547.689, "learn_time_ms": 23873.232, "learn_throughput": 167.552, "synch_weights_time_ms": 22.422}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-00-13", "timestamp": 1724383813, "time_this_iter_s": 25.9980149269104, "time_total_s": 1528.0392043590546, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095ce8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1528.0392043590546, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 37.294444444444444, "ram_util_percent": 82.99444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.380150272480396, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.713912612672836, "policy_loss": -0.00685340403209603, "vf_loss": 6.71958187900523, "vf_explained_var": 0.4095051295542843, "kl": 0.005920692307445856, "entropy": 0.531588866628667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 54338.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.69598529553287, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.822426371095042, "policy_loss": -0.008316693498344017, "vf_loss": 6.829498862211036, "vf_explained_var": 0.440221991173174, "kl": 0.006220993202268368, "entropy": 0.6571428221369546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 54338.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 679.8366795908736, "episode_reward_min": -197.47255801072097, "episode_reward_mean": 193.05766906525687, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1502.4579892261233, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 342.3183257510782, "predator_policy": 1454.8656304233157}, "policy_reward_mean": {"prey_policy": -481.33469686036995, "predator_policy": 577.8635313929985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [176.26041662103592, 0.21821107072746226, 1.9984014443252818e-15, 245.28846200816812, 58.6094343340795, 43.23705700921394, 120.70000000000012, 367.1244151996396, 389.22227765521103, 245.56108697477868, 292.1142502654077, 316.28308553503587, 77.3865831518488, 57.93757164436414, -11.477256354483515, 192.48068346068519, 40.56283453940604, 456.31239539611215, 355.741196747707, 140.49770481039337, 204.49861641854048, 124.67406750215656, 302.421505559502, 591.4710355223544, 186.69291984403174, 362.720731324219, 245.6255157231909, 52.988148307240905, 496.05668108576566, 216.2811303940613, 38.0659360086855, 340.770761558933, 124.63584860639914, 441.74808747684455, 79.59999999999975, -24.91020950547903, 30.15926986496275, 25.37680891755862, 176.33404127650218, 286.21890459055084, 89.90544993516362, 151.08663535378736, 422.53308260607093, 97.3172443857799, 108.27493041917651, 198.32533600461863, 1.6753274856786957, 559.5247711314041, 503.8285229951546, 266.7483985891672, 11.399999999999977, 86.71979010089986, 450.7610278854967, 533.9763897044863, 99.53058216014564, 32.17287383199998, 96.25144987856484, 49.21310151275964, 208.1399738922481, 91.1999999999991, 183.72397528109587, 11.312411169197262, 1.0436096431476471e-14, 50.36917158798956, 21.093790471640773, 200.7513796049921, 468.86853932932627, 17.126097289554185, 21.61719365766879, 430.8557932965988, 91.66596167210584, 73.6933952924178, -197.47255801072097, 467.48130875410925, 85.5912169517407, 382.9475381821588, 297.2721240486135, 106.09113791065218, 172.4224005962293, 13.899999999999968, -53.91863077846627, 179.28947414794607, 143.39999999999998, 89.19421500251279, 56.41288742942442, 468.4364041495805, 447.29914892209285, 483.9601138958951, 146.58755132155562, 177.77236443920762, -5.265367785333229, 45.79562006644713, 679.8366795908736, 245.17292640247146, 336.2795771648581, 156.10967029158238, 2.935727517424282, 240.8925045676329, 81.31713428713677, 560.8729303895276], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-69.34869004319583, -996.0133554496825, -1502.4579892261233, -1226.7333168995128, -1433.3390557924984, -838.9616907051133, 97.59893557133833, -760.7235025627274, -540.054113890728, -1314.13163752533, 28.455344810272447, -1349.5664761940245, -413.1274358390593, -554.4774662798385, -238.0366226174782, -726.7710818043021, -450.71168394839265, -110.00701964763408, 52.53534625689632, -639.9531732218239, -935.6561560579547, -74.95184378480171, 83.36797820557345, -609.8724577051361, -246.14085103616154, 28.155753833319732, -30.392059259647624, -1235.7587705134497, -1362.4795494607758, -430.24501265480393, -1249.057482405456, -421.05362836706917, -741.5802377275056, -1311.8109388385974, -62.15615850016483, -1151.3264829293707, -17.128448002291023, -1135.1774226433058, -234.68978197127302, -621.301533106196, -46.46431357747922, -541.4271935679311, -183.75038887205602, -35.814994399537845, 140.62238355928724, -1005.5208113096473, -536.9613976851998, -334.94377158178884, -744.7979876861212, -269.48557306464784, -91.7978702782644, -1074.1675755600181, 8.014315740236427, -1067.0685234525786, -53.17720654453779, -238.79575065421884, 87.19939138546637, -707.220871245196, -134.08237541906615, -1270.0603625805077, -1116.2094512198034, -419.3318658278441, 135.26363337429436, -626.6806959016023, -631.6305227266771, -125.40582404363002, 117.40898123727956, -332.61470333256256, 36.09989398176272, 40.0000000000003, -1098.890635857492, -982.0218992678779, -828.4173263101044, -876.4233913399156, -584.9087694487345, -707.5752975178785, -998.4185909112208, 39.17151716317368, -776.4315428287837, -666.6051177243489, -152.8079162492168, -1451.5408149276616, -68.01369950519333, -104.50350911356261, -840.6097867023525, 165.187626760044, -657.0441458200404, 30.09730783804449, -28.475082689642548, -386.2561505793016, 67.84922373520465, -1037.8914302299634, -1083.6576437979538, -931.2021087194881, -755.6284754566366, 264.1007326923225, -112.06330849385513, -793.7947364161043, -355.79479407728843, -146.62698859584094, -648.1699946671857, -1364.542140420589, -361.8247750025718, -875.0617667772063, 259.6272560005731, -1105.341582010487, -984.1952406464627, 34.140486144224624, -240.0505519141883, -1391.0994602335084, -374.1489193626765, -20.432024824524007, -749.0473111803309, 36.053210978509306, -873.1729553320633, -179.95975757094666, -716.3924546133046, 31.276458897040452, 28.875111803975468, -4.067704664965106, -15.676905482390737, 61.917763741363196, -648.2007068021167, -36.92506428587774, -1332.6826028815321, -1357.0116871897183, -402.1120495423536, -850.0959376048418, -77.28724751682262, -417.2016858293837, -229.63503284946194, -1209.3243598340168, 227.27364020158407, -592.8514001052765, -105.12984502742783, -916.4758664854489, -577.5648278912483, -1418.3006487600117, 237.28895566949322, -543.0589470549434, 8.339516582138641, -95.7730429002218, -529.9778370529801, -574.2332645527018, -429.8814435592703, -610.2053867532566, -1025.3884071354946, 37.718563021949784, 32.02818546858089, -1231.7809775784142, 136.65277969938884, -799.3167061261486, -169.311522455225, 88.2249260441813, 60.71335979548353, -62.97036690633241, 38.04816980656291, -341.4602621584156, -1184.5854040280371, -529.7089476422989, -626.8424243128787, -1064.249807835271, -68.72954809579184, -959.2056391571925, -562.5827210806431, -117.99704770036983, -695.9670886217941, -286.66517500663383, -952.3119006555183, -201.05872467108927, -785.7130372142863, -18.724498985175188, 40.0000000000003, -863.8423793930607, -225.5534615989855, -965.1797053706829, -260.3482960381992, -358.04472154343534, -925.0904161525262, 20.88265232587309, -31.416137682493122, -673.2187433779038, -817.6328577998235, -518.8443730605014, -545.0776637466164, 245.167550851735, -290.19425464774093, -1242.0998851063366, 9.49323558998881, -668.9677976055032, -120.7605511734131, -470.45148213867935, -1123.64324549753, -602.2465794989506, -387.53864884625233, 115.1247294379759, -200.4853685216903, -706.5300905399665, 342.3183257510782, -192.1770004177867], "policy_predator_policy_reward": [295.45278694615473, 946.1696751677588, 1401.0335200348968, 1328.375997161466, 1433.3390557924984, 838.9616907051133, 124.48952643683026, 783.9235025627273, 633.4704405929757, 1279.3247451571613, 14.781712198941287, 1349.5664761940245, 461.82743583905943, 626.4774662798396, 556.3472124051109, 775.58490721631, 215.378318261056, 734.5626629901827, 198.6911039263879, 634.287810013319, 687.8330973748343, 614.8891527333317, 131.06962024561287, 711.7179447889866, 229.10744008321862, 66.2642402714724, 1235.7587705134497, 88.32963090401162, 1411.8851419682837, 369.3621637928118, 1190.6517713764156, 671.940022856796, 779.1078105285665, 1314.8462005769459, 538.401676966683, 1131.3933598589624, 436.465565036454, 1071.5815023568512, 276.6292413482715, 719.8597785395924, 148.07544402600706, 644.314679537945, 143.37666966996446, 200.86278110378817, 292.86364793944426, 874.456285370417, 635.0911164462904, 828.2850883430526, 1011.5392385835715, 189.43724201123482, 665.3235987220684, 863.3625784404259, 234.31119998295475, 1070.3685234525792, 77.3653548517771, 267.5957506542181, 582.225859149765, 533.8523017957267, 352.12705675676347, 1268.2968116368727, 1120.3718027960135, 453.2354502603187, 717.5970859531759, 114.59073813306426, 205.3745523605285, 676.2976430161787, 316.69884084241767, 340.25496872970797, 3.5001060182375294, 0.0, 639.999143780617, 1416.0031818392708, 848.6638237194062, 886.336163795576, 594.2812616116129, 723.5796142725592, 998.4185909112208, 137.1625241133293, 861.4115918470088, 867.8439732966733, 239.38855068872564, 1454.8656304233157, 178.9003348589824, 144.70350911356076, 780.5399851685926, 317.4152573797858, 465.4409694300598, 258.82311293772057, 127.52242175379438, 395.48374193432613, 131.8159977958198, 1036.551544703559, 1080.5974702242934, 935.9376097788273, 432.10566902452763, 618.9468448711893, 690.1467148558266, 719.5398530492846, 462.30411377569567, 306.86606748660495, 659.569994667186, 1364.542140420589, 362.3358183062556, 961.2705135744216, 955.2406504167993, 341.2347034786095, 883.2129540994429, 600.8181901072824, 336.67786535860034, 1394.002728949237, 416.32712561594957, 10.426692403254055, 475.96986743438237, 333.2756826460063, 887.0729553320634, 215.2728590837046, 183.26019480726862, 709.9957748012458, 25.72488819602466, 40.66770466496541, 81.82231827039422, 55.6607987517329, 684.0709533086765, 12.367228948517038, 1332.6826028815321, 1357.0116871897183, 446.74954625936164, 855.8276124758265, 29.804071778210794, 485.778652039638, 571.8714943272736, 1067.8392779612036, 342.40959639911193, 492.0367028339055, 121.73064019661786, 917.0011686058116, 599.1820215489205, 1418.3006487600117, 218.29603468837058, 518.3297499936747, 60.31141008867726, 118.78807790151116, 488.84213947020874, 689.0623574278939, 193.5819674409294, 649.032304860877, 844.0646326347079, 611.0865202329402, 53.56303148316105, 1231.7809775784142, 355.83695716984346, 689.7745074390745, 155.64046108919675, 222.71825937044974, 0.0, 108.34814502149929, 291.64847785624585, 184.1860150918383, 1184.9854040280372, 543.2089476423017, 560.0317469805306, 1077.1418543891564, 261.55148911962095, 945.6731722813108, 569.8827210806436, 254.0970477003692, 695.5137195430933, 376.31275908784863, 435.41901234868124, 774.364500407348, 474.71148963231155, 798.1624507167273, 414.5422056273117, 856.5993226878404, 748.817686767457, 925.875594098105, 597.7101818821134, 167.27038702107563, 768.1386164456942, 313.8415118201679, 6.5944990166312945, 692.7750142584367, 828.0284778662706, 554.244373060505, 518.901900945398, 460.844891540354, 547.1565204818661, 1230.3105456746835, 655.6733168908744, 340.080822289499, 518.9074571491223, 228.41424645455578, 1125.04324549753, 603.782307016375, 403.4324555165508, 109.87396845936246, 288.09874039880725, 700.2338529499883, 69.60756141641156, 341.12404363982506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.798152011945689, "mean_inference_ms": 5.019647895884766, "mean_action_processing_ms": 1.9830236537593748, "mean_env_wait_ms": 13.088398124264518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004810929298400879, "StateBufferConnector_ms": 0.022623300552368164, "ViewRequirementAgentConnector_ms": 0.1224222183227539}, "num_episodes": 10, "episode_return_max": 679.8366795908736, "episode_return_min": -197.47255801072097, "episode_return_mean": 193.05766906525687, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.34879564056354, "num_env_steps_trained_throughput_per_sec": 155.34879564056354, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 26406.692, "restore_workers_time_ms": 0.057, "training_step_time_ms": 26406.377, "sample_time_ms": 2544.347, "learn_time_ms": 23834.829, "learn_throughput": 167.822, "synch_weights_time_ms": 23.278}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-00-39", "timestamp": 1724383839, "time_this_iter_s": 25.787918090820312, "time_total_s": 1553.8271224498749, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095639d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1553.8271224498749, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 33.52162162162163, "ram_util_percent": 81.227027027027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.135931280554917, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.836823217200224, "policy_loss": -0.007672363111906976, "vf_loss": 6.843391552173271, "vf_explained_var": 0.2295182433708635, "kl": 0.005520216157664816, "entropy": 0.5034607130699057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55283.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.236209446538695, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.122408146832986, "policy_loss": -0.009452367740530501, "vf_loss": 7.130235626079418, "vf_explained_var": 0.532925155806163, "kl": 0.008124390399704378, "entropy": 0.6332499967681037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55283.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 679.8366795908736, "episode_reward_min": -197.47255801072097, "episode_reward_mean": 198.56551966614114, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1451.5408149276616, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 342.3183257510782, "predator_policy": 1454.8656304233157}, "policy_reward_mean": {"prey_policy": -453.6482957790135, "predator_policy": 552.9310556120842}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.48068346068519, 40.56283453940604, 456.31239539611215, 355.741196747707, 140.49770481039337, 204.49861641854048, 124.67406750215656, 302.421505559502, 591.4710355223544, 186.69291984403174, 362.720731324219, 245.6255157231909, 52.988148307240905, 496.05668108576566, 216.2811303940613, 38.0659360086855, 340.770761558933, 124.63584860639914, 441.74808747684455, 79.59999999999975, -24.91020950547903, 30.15926986496275, 25.37680891755862, 176.33404127650218, 286.21890459055084, 89.90544993516362, 151.08663535378736, 422.53308260607093, 97.3172443857799, 108.27493041917651, 198.32533600461863, 1.6753274856786957, 559.5247711314041, 503.8285229951546, 266.7483985891672, 11.399999999999977, 86.71979010089986, 450.7610278854967, 533.9763897044863, 99.53058216014564, 32.17287383199998, 96.25144987856484, 49.21310151275964, 208.1399738922481, 91.1999999999991, 183.72397528109587, 11.312411169197262, 1.0436096431476471e-14, 50.36917158798956, 21.093790471640773, 200.7513796049921, 468.86853932932627, 17.126097289554185, 21.61719365766879, 430.8557932965988, 91.66596167210584, 73.6933952924178, -197.47255801072097, 467.48130875410925, 85.5912169517407, 382.9475381821588, 297.2721240486135, 106.09113791065218, 172.4224005962293, 13.899999999999968, -53.91863077846627, 179.28947414794607, 143.39999999999998, 89.19421500251279, 56.41288742942442, 468.4364041495805, 447.29914892209285, 483.9601138958951, 146.58755132155562, 177.77236443920762, -5.265367785333229, 45.79562006644713, 679.8366795908736, 245.17292640247146, 336.2795771648581, 156.10967029158238, 2.935727517424282, 240.8925045676329, 81.31713428713677, 560.8729303895276, 4.299999999999995, 105.13410647361185, 363.384817099176, 395.6813929497129, 311.3999999999998, 254.10402828127954, 362.70359627289884, 347.7033488535268, 46.22736500775732, 193.33694916029447, -54.93757113254274, 409.1951017352319, 88.88880549398927, 73.00000000000013, 29.128715008510937], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1249.057482405456, -421.05362836706917, -741.5802377275056, -1311.8109388385974, -62.15615850016483, -1151.3264829293707, -17.128448002291023, -1135.1774226433058, -234.68978197127302, -621.301533106196, -46.46431357747922, -541.4271935679311, -183.75038887205602, -35.814994399537845, 140.62238355928724, -1005.5208113096473, -536.9613976851998, -334.94377158178884, -744.7979876861212, -269.48557306464784, -91.7978702782644, -1074.1675755600181, 8.014315740236427, -1067.0685234525786, -53.17720654453779, -238.79575065421884, 87.19939138546637, -707.220871245196, -134.08237541906615, -1270.0603625805077, -1116.2094512198034, -419.3318658278441, 135.26363337429436, -626.6806959016023, -631.6305227266771, -125.40582404363002, 117.40898123727956, -332.61470333256256, 36.09989398176272, 40.0000000000003, -1098.890635857492, -982.0218992678779, -828.4173263101044, -876.4233913399156, -584.9087694487345, -707.5752975178785, -998.4185909112208, 39.17151716317368, -776.4315428287837, -666.6051177243489, -152.8079162492168, -1451.5408149276616, -68.01369950519333, -104.50350911356261, -840.6097867023525, 165.187626760044, -657.0441458200404, 30.09730783804449, -28.475082689642548, -386.2561505793016, 67.84922373520465, -1037.8914302299634, -1083.6576437979538, -931.2021087194881, -755.6284754566366, 264.1007326923225, -112.06330849385513, -793.7947364161043, -355.79479407728843, -146.62698859584094, -648.1699946671857, -1364.542140420589, -361.8247750025718, -875.0617667772063, 259.6272560005731, -1105.341582010487, -984.1952406464627, 34.140486144224624, -240.0505519141883, -1391.0994602335084, -374.1489193626765, -20.432024824524007, -749.0473111803309, 36.053210978509306, -873.1729553320633, -179.95975757094666, -716.3924546133046, 31.276458897040452, 28.875111803975468, -4.067704664965106, -15.676905482390737, 61.917763741363196, -648.2007068021167, -36.92506428587774, -1332.6826028815321, -1357.0116871897183, -402.1120495423536, -850.0959376048418, -77.28724751682262, -417.2016858293837, -229.63503284946194, -1209.3243598340168, 227.27364020158407, -592.8514001052765, -105.12984502742783, -916.4758664854489, -577.5648278912483, -1418.3006487600117, 237.28895566949322, -543.0589470549434, 8.339516582138641, -95.7730429002218, -529.9778370529801, -574.2332645527018, -429.8814435592703, -610.2053867532566, -1025.3884071354946, 37.718563021949784, 32.02818546858089, -1231.7809775784142, 136.65277969938884, -799.3167061261486, -169.311522455225, 88.2249260441813, 60.71335979548353, -62.97036690633241, 38.04816980656291, -341.4602621584156, -1184.5854040280371, -529.7089476422989, -626.8424243128787, -1064.249807835271, -68.72954809579184, -959.2056391571925, -562.5827210806431, -117.99704770036983, -695.9670886217941, -286.66517500663383, -952.3119006555183, -201.05872467108927, -785.7130372142863, -18.724498985175188, 40.0000000000003, -863.8423793930607, -225.5534615989855, -965.1797053706829, -260.3482960381992, -358.04472154343534, -925.0904161525262, 20.88265232587309, -31.416137682493122, -673.2187433779038, -817.6328577998235, -518.8443730605014, -545.0776637466164, 245.167550851735, -290.19425464774093, -1242.0998851063366, 9.49323558998881, -668.9677976055032, -120.7605511734131, -470.45148213867935, -1123.64324549753, -602.2465794989506, -387.53864884625233, 115.1247294379759, -200.4853685216903, -706.5300905399665, 342.3183257510782, -192.1770004177867, -1276.343339013131, -1161.5509610195252, -563.1812551017457, -55.747177193725676, -408.87227955740525, -525.1514495062639, -959.3623491510975, 108.8006615228816, 37.2442620071501, 171.45013945934164, 30.321871312381067, -1051.678185219707, 158.41827699525183, -111.39764988858335, -712.9180330332832, -224.98742556550468, -160.54068598927026, -214.2368816532161, -425.1893507788772, -29.05253293429309, -985.8841881659836, -229.83984495717493, -841.2212373553757, -140.73766596984723, -978.7028740054129, -664.7106899710891, 13.880226943705985, -23.739619626669473, -733.1694255999665, -304.41777415507096], "policy_predator_policy_reward": [1190.6517713764156, 671.940022856796, 779.1078105285665, 1314.8462005769459, 538.401676966683, 1131.3933598589624, 436.465565036454, 1071.5815023568512, 276.6292413482715, 719.8597785395924, 148.07544402600706, 644.314679537945, 143.37666966996446, 200.86278110378817, 292.86364793944426, 874.456285370417, 635.0911164462904, 828.2850883430526, 1011.5392385835715, 189.43724201123482, 665.3235987220684, 863.3625784404259, 234.31119998295475, 1070.3685234525792, 77.3653548517771, 267.5957506542181, 582.225859149765, 533.8523017957267, 352.12705675676347, 1268.2968116368727, 1120.3718027960135, 453.2354502603187, 717.5970859531759, 114.59073813306426, 205.3745523605285, 676.2976430161787, 316.69884084241767, 340.25496872970797, 3.5001060182375294, 0.0, 639.999143780617, 1416.0031818392708, 848.6638237194062, 886.336163795576, 594.2812616116129, 723.5796142725592, 998.4185909112208, 137.1625241133293, 861.4115918470088, 867.8439732966733, 239.38855068872564, 1454.8656304233157, 178.9003348589824, 144.70350911356076, 780.5399851685926, 317.4152573797858, 465.4409694300598, 258.82311293772057, 127.52242175379438, 395.48374193432613, 131.8159977958198, 1036.551544703559, 1080.5974702242934, 935.9376097788273, 432.10566902452763, 618.9468448711893, 690.1467148558266, 719.5398530492846, 462.30411377569567, 306.86606748660495, 659.569994667186, 1364.542140420589, 362.3358183062556, 961.2705135744216, 955.2406504167993, 341.2347034786095, 883.2129540994429, 600.8181901072824, 336.67786535860034, 1394.002728949237, 416.32712561594957, 10.426692403254055, 475.96986743438237, 333.2756826460063, 887.0729553320634, 215.2728590837046, 183.26019480726862, 709.9957748012458, 25.72488819602466, 40.66770466496541, 81.82231827039422, 55.6607987517329, 684.0709533086765, 12.367228948517038, 1332.6826028815321, 1357.0116871897183, 446.74954625936164, 855.8276124758265, 29.804071778210794, 485.778652039638, 571.8714943272736, 1067.8392779612036, 342.40959639911193, 492.0367028339055, 121.73064019661786, 917.0011686058116, 599.1820215489205, 1418.3006487600117, 218.29603468837058, 518.3297499936747, 60.31141008867726, 118.78807790151116, 488.84213947020874, 689.0623574278939, 193.5819674409294, 649.032304860877, 844.0646326347079, 611.0865202329402, 53.56303148316105, 1231.7809775784142, 355.83695716984346, 689.7745074390745, 155.64046108919675, 222.71825937044974, 0.0, 108.34814502149929, 291.64847785624585, 184.1860150918383, 1184.9854040280372, 543.2089476423017, 560.0317469805306, 1077.1418543891564, 261.55148911962095, 945.6731722813108, 569.8827210806436, 254.0970477003692, 695.5137195430933, 376.31275908784863, 435.41901234868124, 774.364500407348, 474.71148963231155, 798.1624507167273, 414.5422056273117, 856.5993226878404, 748.817686767457, 925.875594098105, 597.7101818821134, 167.27038702107563, 768.1386164456942, 313.8415118201679, 6.5944990166312945, 692.7750142584367, 828.0284778662706, 554.244373060505, 518.901900945398, 460.844891540354, 547.1565204818661, 1230.3105456746835, 655.6733168908744, 340.080822289499, 518.9074571491223, 228.41424645455578, 1125.04324549753, 603.782307016375, 403.4324555165508, 109.87396845936246, 288.09874039880725, 700.2338529499883, 69.60756141641156, 341.12404363982506, 1279.3433390131283, 1162.850961019524, 268.83531546780904, 455.2272233012772, 710.3645681552534, 587.0439780075963, 940.422154344916, 305.8209262330085, 23.080060848671167, 79.62553768483747, 513.4199973413481, 762.0403448472559, 175.1131767818313, 140.56979238439, 702.8825110798202, 582.7262963724928, 54.74384459423165, 366.26108805600956, 440.03980510994796, 207.53902776352115, 1067.078948390561, 93.70751360005536, 511.24278723372663, 879.911217826728, 978.6207916256399, 753.6815778448533, 23.719773056294002, 59.139619626669976, 252.4763554500349, 814.2395593135178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.783124829114354, "mean_inference_ms": 5.005862989603032, "mean_action_processing_ms": 1.9800079716937917, "mean_env_wait_ms": 13.085854556887448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009013652801513672, "StateBufferConnector_ms": 0.014559507369995117, "ViewRequirementAgentConnector_ms": 0.11746358871459961}, "num_episodes": 15, "episode_return_max": 679.8366795908736, "episode_return_min": -197.47255801072097, "episode_return_mean": 198.56551966614114, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.63052043087782, "num_env_steps_trained_throughput_per_sec": 145.63052043087782, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 26479.477, "restore_workers_time_ms": 0.058, "training_step_time_ms": 26479.131, "sample_time_ms": 2498.034, "learn_time_ms": 23953.81, "learn_throughput": 166.988, "synch_weights_time_ms": 22.7}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-01-06", "timestamp": 1724383866, "time_this_iter_s": 27.550721168518066, "time_total_s": 1581.377843618393, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095bf160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1581.377843618393, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 45.605128205128196, "ram_util_percent": 82.1769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.603632947376795, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.408614705605482, "policy_loss": -0.008486044337657631, "vf_loss": 7.4157037997371935, "vf_explained_var": 0.2944405264955349, "kl": 0.006984770286177832, "entropy": 0.4528731728356982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 56228.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.957619537625995, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.069790126659252, "policy_loss": -0.01103030848267572, "vf_loss": 7.079025445665632, "vf_explained_var": 0.5408020619992857, "kl": 0.008974911982597655, "entropy": 0.6051188887427092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 56228.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 679.8366795908736, "episode_reward_min": -197.47255801072097, "episode_reward_mean": 187.50888998746777, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1451.5408149276616, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 342.3183257510782, "predator_policy": 1454.8656304233157}, "policy_reward_mean": {"prey_policy": -444.95618517269776, "predator_policy": 538.7106301664317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [245.6255157231909, 52.988148307240905, 496.05668108576566, 216.2811303940613, 38.0659360086855, 340.770761558933, 124.63584860639914, 441.74808747684455, 79.59999999999975, -24.91020950547903, 30.15926986496275, 25.37680891755862, 176.33404127650218, 286.21890459055084, 89.90544993516362, 151.08663535378736, 422.53308260607093, 97.3172443857799, 108.27493041917651, 198.32533600461863, 1.6753274856786957, 559.5247711314041, 503.8285229951546, 266.7483985891672, 11.399999999999977, 86.71979010089986, 450.7610278854967, 533.9763897044863, 99.53058216014564, 32.17287383199998, 96.25144987856484, 49.21310151275964, 208.1399738922481, 91.1999999999991, 183.72397528109587, 11.312411169197262, 1.0436096431476471e-14, 50.36917158798956, 21.093790471640773, 200.7513796049921, 468.86853932932627, 17.126097289554185, 21.61719365766879, 430.8557932965988, 91.66596167210584, 73.6933952924178, -197.47255801072097, 467.48130875410925, 85.5912169517407, 382.9475381821588, 297.2721240486135, 106.09113791065218, 172.4224005962293, 13.899999999999968, -53.91863077846627, 179.28947414794607, 143.39999999999998, 89.19421500251279, 56.41288742942442, 468.4364041495805, 447.29914892209285, 483.9601138958951, 146.58755132155562, 177.77236443920762, -5.265367785333229, 45.79562006644713, 679.8366795908736, 245.17292640247146, 336.2795771648581, 156.10967029158238, 2.935727517424282, 240.8925045676329, 81.31713428713677, 560.8729303895276, 4.299999999999995, 105.13410647361185, 363.384817099176, 395.6813929497129, 311.3999999999998, 254.10402828127954, 362.70359627289884, 347.7033488535268, 46.22736500775732, 193.33694916029447, -54.93757113254274, 409.1951017352319, 88.88880549398927, 73.00000000000013, 29.128715008510937, 202.65133683905242, 0.9499390342364986, 158.6405245012118, 598.7184913174224, 19.78246997563076, 334.6741094053528, 36.53871726049695, 278.1508295560799, 77.0999999999999, 49.78785715352951, 95.41644821476102], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [8.014315740236427, -1067.0685234525786, -53.17720654453779, -238.79575065421884, 87.19939138546637, -707.220871245196, -134.08237541906615, -1270.0603625805077, -1116.2094512198034, -419.3318658278441, 135.26363337429436, -626.6806959016023, -631.6305227266771, -125.40582404363002, 117.40898123727956, -332.61470333256256, 36.09989398176272, 40.0000000000003, -1098.890635857492, -982.0218992678779, -828.4173263101044, -876.4233913399156, -584.9087694487345, -707.5752975178785, -998.4185909112208, 39.17151716317368, -776.4315428287837, -666.6051177243489, -152.8079162492168, -1451.5408149276616, -68.01369950519333, -104.50350911356261, -840.6097867023525, 165.187626760044, -657.0441458200404, 30.09730783804449, -28.475082689642548, -386.2561505793016, 67.84922373520465, -1037.8914302299634, -1083.6576437979538, -931.2021087194881, -755.6284754566366, 264.1007326923225, -112.06330849385513, -793.7947364161043, -355.79479407728843, -146.62698859584094, -648.1699946671857, -1364.542140420589, -361.8247750025718, -875.0617667772063, 259.6272560005731, -1105.341582010487, -984.1952406464627, 34.140486144224624, -240.0505519141883, -1391.0994602335084, -374.1489193626765, -20.432024824524007, -749.0473111803309, 36.053210978509306, -873.1729553320633, -179.95975757094666, -716.3924546133046, 31.276458897040452, 28.875111803975468, -4.067704664965106, -15.676905482390737, 61.917763741363196, -648.2007068021167, -36.92506428587774, -1332.6826028815321, -1357.0116871897183, -402.1120495423536, -850.0959376048418, -77.28724751682262, -417.2016858293837, -229.63503284946194, -1209.3243598340168, 227.27364020158407, -592.8514001052765, -105.12984502742783, -916.4758664854489, -577.5648278912483, -1418.3006487600117, 237.28895566949322, -543.0589470549434, 8.339516582138641, -95.7730429002218, -529.9778370529801, -574.2332645527018, -429.8814435592703, -610.2053867532566, -1025.3884071354946, 37.718563021949784, 32.02818546858089, -1231.7809775784142, 136.65277969938884, -799.3167061261486, -169.311522455225, 88.2249260441813, 60.71335979548353, -62.97036690633241, 38.04816980656291, -341.4602621584156, -1184.5854040280371, -529.7089476422989, -626.8424243128787, -1064.249807835271, -68.72954809579184, -959.2056391571925, -562.5827210806431, -117.99704770036983, -695.9670886217941, -286.66517500663383, -952.3119006555183, -201.05872467108927, -785.7130372142863, -18.724498985175188, 40.0000000000003, -863.8423793930607, -225.5534615989855, -965.1797053706829, -260.3482960381992, -358.04472154343534, -925.0904161525262, 20.88265232587309, -31.416137682493122, -673.2187433779038, -817.6328577998235, -518.8443730605014, -545.0776637466164, 245.167550851735, -290.19425464774093, -1242.0998851063366, 9.49323558998881, -668.9677976055032, -120.7605511734131, -470.45148213867935, -1123.64324549753, -602.2465794989506, -387.53864884625233, 115.1247294379759, -200.4853685216903, -706.5300905399665, 342.3183257510782, -192.1770004177867, -1276.343339013131, -1161.5509610195252, -563.1812551017457, -55.747177193725676, -408.87227955740525, -525.1514495062639, -959.3623491510975, 108.8006615228816, 37.2442620071501, 171.45013945934164, 30.321871312381067, -1051.678185219707, 158.41827699525183, -111.39764988858335, -712.9180330332832, -224.98742556550468, -160.54068598927026, -214.2368816532161, -425.1893507788772, -29.05253293429309, -985.8841881659836, -229.83984495717493, -841.2212373553757, -140.73766596984723, -978.7028740054129, -664.7106899710891, 13.880226943705985, -23.739619626669473, -733.1694255999665, -304.41777415507096, 18.286543105165716, -754.2692970403256, -1002.879252542828, -820.417970135191, -523.7399276356259, -393.15675595294243, -133.7958681539261, -943.7373378931568, -835.8119507988051, -480.68425367588554, -18.01732386614948, -313.34451556827634, -231.68874248134358, -299.2810732924962, -688.5384686450927, -558.6283438534842, 30.572401594157107, 9.533392704155114, -457.7400981012235, -800.5306786118621, -773.4999664063353, 40.0000000000003], "policy_predator_policy_reward": [234.31119998295475, 1070.3685234525792, 77.3653548517771, 267.5957506542181, 582.225859149765, 533.8523017957267, 352.12705675676347, 1268.2968116368727, 1120.3718027960135, 453.2354502603187, 717.5970859531759, 114.59073813306426, 205.3745523605285, 676.2976430161787, 316.69884084241767, 340.25496872970797, 3.5001060182375294, 0.0, 639.999143780617, 1416.0031818392708, 848.6638237194062, 886.336163795576, 594.2812616116129, 723.5796142725592, 998.4185909112208, 137.1625241133293, 861.4115918470088, 867.8439732966733, 239.38855068872564, 1454.8656304233157, 178.9003348589824, 144.70350911356076, 780.5399851685926, 317.4152573797858, 465.4409694300598, 258.82311293772057, 127.52242175379438, 395.48374193432613, 131.8159977958198, 1036.551544703559, 1080.5974702242934, 935.9376097788273, 432.10566902452763, 618.9468448711893, 690.1467148558266, 719.5398530492846, 462.30411377569567, 306.86606748660495, 659.569994667186, 1364.542140420589, 362.3358183062556, 961.2705135744216, 955.2406504167993, 341.2347034786095, 883.2129540994429, 600.8181901072824, 336.67786535860034, 1394.002728949237, 416.32712561594957, 10.426692403254055, 475.96986743438237, 333.2756826460063, 887.0729553320634, 215.2728590837046, 183.26019480726862, 709.9957748012458, 25.72488819602466, 40.66770466496541, 81.82231827039422, 55.6607987517329, 684.0709533086765, 12.367228948517038, 1332.6826028815321, 1357.0116871897183, 446.74954625936164, 855.8276124758265, 29.804071778210794, 485.778652039638, 571.8714943272736, 1067.8392779612036, 342.40959639911193, 492.0367028339055, 121.73064019661786, 917.0011686058116, 599.1820215489205, 1418.3006487600117, 218.29603468837058, 518.3297499936747, 60.31141008867726, 118.78807790151116, 488.84213947020874, 689.0623574278939, 193.5819674409294, 649.032304860877, 844.0646326347079, 611.0865202329402, 53.56303148316105, 1231.7809775784142, 355.83695716984346, 689.7745074390745, 155.64046108919675, 222.71825937044974, 0.0, 108.34814502149929, 291.64847785624585, 184.1860150918383, 1184.9854040280372, 543.2089476423017, 560.0317469805306, 1077.1418543891564, 261.55148911962095, 945.6731722813108, 569.8827210806436, 254.0970477003692, 695.5137195430933, 376.31275908784863, 435.41901234868124, 774.364500407348, 474.71148963231155, 798.1624507167273, 414.5422056273117, 856.5993226878404, 748.817686767457, 925.875594098105, 597.7101818821134, 167.27038702107563, 768.1386164456942, 313.8415118201679, 6.5944990166312945, 692.7750142584367, 828.0284778662706, 554.244373060505, 518.901900945398, 460.844891540354, 547.1565204818661, 1230.3105456746835, 655.6733168908744, 340.080822289499, 518.9074571491223, 228.41424645455578, 1125.04324549753, 603.782307016375, 403.4324555165508, 109.87396845936246, 288.09874039880725, 700.2338529499883, 69.60756141641156, 341.12404363982506, 1279.3433390131283, 1162.850961019524, 268.83531546780904, 455.2272233012772, 710.3645681552534, 587.0439780075963, 940.422154344916, 305.8209262330085, 23.080060848671167, 79.62553768483747, 513.4199973413481, 762.0403448472559, 175.1131767818313, 140.56979238439, 702.8825110798202, 582.7262963724928, 54.74384459423165, 366.26108805600956, 440.03980510994796, 207.53902776352115, 1067.078948390561, 93.70751360005536, 511.24278723372663, 879.911217826728, 978.6207916256399, 753.6815778448533, 23.719773056294002, 59.139619626669976, 252.4763554500349, 814.2395593135178, 142.91702172113935, 795.7170690530737, 1002.9291915770644, 821.3179701351912, 473.54636221444827, 601.9908458753342, 875.961168611921, 800.2905287525845, 832.3374525191012, 503.9412219312226, 376.96987304390257, 289.0660757958711, 465.40142753823113, 102.107105496104, 1042.279459209539, 483.0381828451198, 8.527598405843047, 28.466607295845005, 681.0748048259932, 626.9838290406249, 800.4999664063366, 28.416448214761427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.781782635490939, "mean_inference_ms": 4.987690200050241, "mean_action_processing_ms": 1.9563364272992083, "mean_env_wait_ms": 13.089654446898766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008869409561157227, "StateBufferConnector_ms": 0.02072775363922119, "ViewRequirementAgentConnector_ms": 0.16809475421905518}, "num_episodes": 11, "episode_return_max": 679.8366795908736, "episode_return_min": -197.47255801072097, "episode_return_mean": 187.50888998746777, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.14884474909172, "num_env_steps_trained_throughput_per_sec": 147.14884474909172, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 26480.0, "restore_workers_time_ms": 0.086, "training_step_time_ms": 26479.643, "sample_time_ms": 2494.436, "learn_time_ms": 23958.347, "learn_throughput": 166.956, "synch_weights_time_ms": 22.652}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-01-34", "timestamp": 1724383894, "time_this_iter_s": 27.22621989250183, "time_total_s": 1608.6040635108948, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095ce820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1608.6040635108948, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 37.3421052631579, "ram_util_percent": 82.97105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.724267712093535, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.926478988909848, "policy_loss": -0.006477741129134619, "vf_loss": 6.931733184390598, "vf_explained_var": 0.20724486093672495, "kl": 0.006117740474769442, "entropy": 0.4871454094452833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57173.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.11445554803919, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.035269250314703, "policy_loss": -0.006914913043793705, "vf_loss": 7.041018911896559, "vf_explained_var": 0.48162276606080395, "kl": 0.005826358238442076, "entropy": 0.5867635348171153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57173.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 679.8366795908736, "episode_reward_min": -197.47255801072097, "episode_reward_mean": 181.87091890658823, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1451.5408149276616, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 342.3183257510782, "predator_policy": 1454.8656304233157}, "policy_reward_mean": {"prey_policy": -443.4695356928346, "predator_policy": 534.404995146129}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.63584860639914, 441.74808747684455, 79.59999999999975, -24.91020950547903, 30.15926986496275, 25.37680891755862, 176.33404127650218, 286.21890459055084, 89.90544993516362, 151.08663535378736, 422.53308260607093, 97.3172443857799, 108.27493041917651, 198.32533600461863, 1.6753274856786957, 559.5247711314041, 503.8285229951546, 266.7483985891672, 11.399999999999977, 86.71979010089986, 450.7610278854967, 533.9763897044863, 99.53058216014564, 32.17287383199998, 96.25144987856484, 49.21310151275964, 208.1399738922481, 91.1999999999991, 183.72397528109587, 11.312411169197262, 1.0436096431476471e-14, 50.36917158798956, 21.093790471640773, 200.7513796049921, 468.86853932932627, 17.126097289554185, 21.61719365766879, 430.8557932965988, 91.66596167210584, 73.6933952924178, -197.47255801072097, 467.48130875410925, 85.5912169517407, 382.9475381821588, 297.2721240486135, 106.09113791065218, 172.4224005962293, 13.899999999999968, -53.91863077846627, 179.28947414794607, 143.39999999999998, 89.19421500251279, 56.41288742942442, 468.4364041495805, 447.29914892209285, 483.9601138958951, 146.58755132155562, 177.77236443920762, -5.265367785333229, 45.79562006644713, 679.8366795908736, 245.17292640247146, 336.2795771648581, 156.10967029158238, 2.935727517424282, 240.8925045676329, 81.31713428713677, 560.8729303895276, 4.299999999999995, 105.13410647361185, 363.384817099176, 395.6813929497129, 311.3999999999998, 254.10402828127954, 362.70359627289884, 347.7033488535268, 46.22736500775732, 193.33694916029447, -54.93757113254274, 409.1951017352319, 88.88880549398927, 73.00000000000013, 29.128715008510937, 202.65133683905242, 0.9499390342364986, 158.6405245012118, 598.7184913174224, 19.78246997563076, 334.6741094053528, 36.53871726049695, 278.1508295560799, 77.0999999999999, 49.78785715352951, 95.41644821476102, 239.65463052091624, 31.65060116600437, 304.7981902568056, 111.17434414769532, 25.831927209629743, 112.88137168887407], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-631.6305227266771, -125.40582404363002, 117.40898123727956, -332.61470333256256, 36.09989398176272, 40.0000000000003, -1098.890635857492, -982.0218992678779, -828.4173263101044, -876.4233913399156, -584.9087694487345, -707.5752975178785, -998.4185909112208, 39.17151716317368, -776.4315428287837, -666.6051177243489, -152.8079162492168, -1451.5408149276616, -68.01369950519333, -104.50350911356261, -840.6097867023525, 165.187626760044, -657.0441458200404, 30.09730783804449, -28.475082689642548, -386.2561505793016, 67.84922373520465, -1037.8914302299634, -1083.6576437979538, -931.2021087194881, -755.6284754566366, 264.1007326923225, -112.06330849385513, -793.7947364161043, -355.79479407728843, -146.62698859584094, -648.1699946671857, -1364.542140420589, -361.8247750025718, -875.0617667772063, 259.6272560005731, -1105.341582010487, -984.1952406464627, 34.140486144224624, -240.0505519141883, -1391.0994602335084, -374.1489193626765, -20.432024824524007, -749.0473111803309, 36.053210978509306, -873.1729553320633, -179.95975757094666, -716.3924546133046, 31.276458897040452, 28.875111803975468, -4.067704664965106, -15.676905482390737, 61.917763741363196, -648.2007068021167, -36.92506428587774, -1332.6826028815321, -1357.0116871897183, -402.1120495423536, -850.0959376048418, -77.28724751682262, -417.2016858293837, -229.63503284946194, -1209.3243598340168, 227.27364020158407, -592.8514001052765, -105.12984502742783, -916.4758664854489, -577.5648278912483, -1418.3006487600117, 237.28895566949322, -543.0589470549434, 8.339516582138641, -95.7730429002218, -529.9778370529801, -574.2332645527018, -429.8814435592703, -610.2053867532566, -1025.3884071354946, 37.718563021949784, 32.02818546858089, -1231.7809775784142, 136.65277969938884, -799.3167061261486, -169.311522455225, 88.2249260441813, 60.71335979548353, -62.97036690633241, 38.04816980656291, -341.4602621584156, -1184.5854040280371, -529.7089476422989, -626.8424243128787, -1064.249807835271, -68.72954809579184, -959.2056391571925, -562.5827210806431, -117.99704770036983, -695.9670886217941, -286.66517500663383, -952.3119006555183, -201.05872467108927, -785.7130372142863, -18.724498985175188, 40.0000000000003, -863.8423793930607, -225.5534615989855, -965.1797053706829, -260.3482960381992, -358.04472154343534, -925.0904161525262, 20.88265232587309, -31.416137682493122, -673.2187433779038, -817.6328577998235, -518.8443730605014, -545.0776637466164, 245.167550851735, -290.19425464774093, -1242.0998851063366, 9.49323558998881, -668.9677976055032, -120.7605511734131, -470.45148213867935, -1123.64324549753, -602.2465794989506, -387.53864884625233, 115.1247294379759, -200.4853685216903, -706.5300905399665, 342.3183257510782, -192.1770004177867, -1276.343339013131, -1161.5509610195252, -563.1812551017457, -55.747177193725676, -408.87227955740525, -525.1514495062639, -959.3623491510975, 108.8006615228816, 37.2442620071501, 171.45013945934164, 30.321871312381067, -1051.678185219707, 158.41827699525183, -111.39764988858335, -712.9180330332832, -224.98742556550468, -160.54068598927026, -214.2368816532161, -425.1893507788772, -29.05253293429309, -985.8841881659836, -229.83984495717493, -841.2212373553757, -140.73766596984723, -978.7028740054129, -664.7106899710891, 13.880226943705985, -23.739619626669473, -733.1694255999665, -304.41777415507096, 18.286543105165716, -754.2692970403256, -1002.879252542828, -820.417970135191, -523.7399276356259, -393.15675595294243, -133.7958681539261, -943.7373378931568, -835.8119507988051, -480.68425367588554, -18.01732386614948, -313.34451556827634, -231.68874248134358, -299.2810732924962, -688.5384686450927, -558.6283438534842, 30.572401594157107, 9.533392704155114, -457.7400981012235, -800.5306786118621, -773.4999664063353, 40.0000000000003, -91.03643913661833, -1081.2789314241386, -115.28044407069865, -581.8290801243202, -340.6547717408522, -216.5843435583475, -118.79452128064256, -203.60626192263757, -726.6345324362758, -638.7713294097761, -131.32295754177625, -859.026253726675], "policy_predator_policy_reward": [205.3745523605285, 676.2976430161787, 316.69884084241767, 340.25496872970797, 3.5001060182375294, 0.0, 639.999143780617, 1416.0031818392708, 848.6638237194062, 886.336163795576, 594.2812616116129, 723.5796142725592, 998.4185909112208, 137.1625241133293, 861.4115918470088, 867.8439732966733, 239.38855068872564, 1454.8656304233157, 178.9003348589824, 144.70350911356076, 780.5399851685926, 317.4152573797858, 465.4409694300598, 258.82311293772057, 127.52242175379438, 395.48374193432613, 131.8159977958198, 1036.551544703559, 1080.5974702242934, 935.9376097788273, 432.10566902452763, 618.9468448711893, 690.1467148558266, 719.5398530492846, 462.30411377569567, 306.86606748660495, 659.569994667186, 1364.542140420589, 362.3358183062556, 961.2705135744216, 955.2406504167993, 341.2347034786095, 883.2129540994429, 600.8181901072824, 336.67786535860034, 1394.002728949237, 416.32712561594957, 10.426692403254055, 475.96986743438237, 333.2756826460063, 887.0729553320634, 215.2728590837046, 183.26019480726862, 709.9957748012458, 25.72488819602466, 40.66770466496541, 81.82231827039422, 55.6607987517329, 684.0709533086765, 12.367228948517038, 1332.6826028815321, 1357.0116871897183, 446.74954625936164, 855.8276124758265, 29.804071778210794, 485.778652039638, 571.8714943272736, 1067.8392779612036, 342.40959639911193, 492.0367028339055, 121.73064019661786, 917.0011686058116, 599.1820215489205, 1418.3006487600117, 218.29603468837058, 518.3297499936747, 60.31141008867726, 118.78807790151116, 488.84213947020874, 689.0623574278939, 193.5819674409294, 649.032304860877, 844.0646326347079, 611.0865202329402, 53.56303148316105, 1231.7809775784142, 355.83695716984346, 689.7745074390745, 155.64046108919675, 222.71825937044974, 0.0, 108.34814502149929, 291.64847785624585, 184.1860150918383, 1184.9854040280372, 543.2089476423017, 560.0317469805306, 1077.1418543891564, 261.55148911962095, 945.6731722813108, 569.8827210806436, 254.0970477003692, 695.5137195430933, 376.31275908784863, 435.41901234868124, 774.364500407348, 474.71148963231155, 798.1624507167273, 414.5422056273117, 856.5993226878404, 748.817686767457, 925.875594098105, 597.7101818821134, 167.27038702107563, 768.1386164456942, 313.8415118201679, 6.5944990166312945, 692.7750142584367, 828.0284778662706, 554.244373060505, 518.901900945398, 460.844891540354, 547.1565204818661, 1230.3105456746835, 655.6733168908744, 340.080822289499, 518.9074571491223, 228.41424645455578, 1125.04324549753, 603.782307016375, 403.4324555165508, 109.87396845936246, 288.09874039880725, 700.2338529499883, 69.60756141641156, 341.12404363982506, 1279.3433390131283, 1162.850961019524, 268.83531546780904, 455.2272233012772, 710.3645681552534, 587.0439780075963, 940.422154344916, 305.8209262330085, 23.080060848671167, 79.62553768483747, 513.4199973413481, 762.0403448472559, 175.1131767818313, 140.56979238439, 702.8825110798202, 582.7262963724928, 54.74384459423165, 366.26108805600956, 440.03980510994796, 207.53902776352115, 1067.078948390561, 93.70751360005536, 511.24278723372663, 879.911217826728, 978.6207916256399, 753.6815778448533, 23.719773056294002, 59.139619626669976, 252.4763554500349, 814.2395593135178, 142.91702172113935, 795.7170690530737, 1002.9291915770644, 821.3179701351912, 473.54636221444827, 601.9908458753342, 875.961168611921, 800.2905287525845, 832.3374525191012, 503.9412219312226, 376.96987304390257, 289.0660757958711, 465.40142753823113, 102.107105496104, 1042.279459209539, 483.0381828451198, 8.527598405843047, 28.466607295845005, 681.0748048259932, 626.9838290406249, 800.4999664063366, 28.416448214761427, 469.4088687417678, 942.5611323399029, 279.85474829846186, 448.90537706256373, 501.606030122104, 360.43127543390375, 369.9729205278829, 63.60220682309174, 899.3253530796808, 491.91243597600464, 244.1043292306496, 859.126253726675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.778705914723861, "mean_inference_ms": 4.992557930997126, "mean_action_processing_ms": 1.9457586783360639, "mean_env_wait_ms": 13.101954284682984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008777499198913574, "StateBufferConnector_ms": 0.020704984664916992, "ViewRequirementAgentConnector_ms": 0.17029070854187012}, "num_episodes": 6, "episode_return_max": 679.8366795908736, "episode_return_min": -197.47255801072097, "episode_return_mean": 181.87091890658823, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.13703154867636, "num_env_steps_trained_throughput_per_sec": 149.13703154867636, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 26540.46, "restore_workers_time_ms": 0.089, "training_step_time_ms": 26540.097, "sample_time_ms": 2511.39, "learn_time_ms": 24001.915, "learn_throughput": 166.653, "synch_weights_time_ms": 22.621}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-02-01", "timestamp": 1724383921, "time_this_iter_s": 26.867233991622925, "time_total_s": 1635.4712975025177, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095ce700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1635.4712975025177, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 36.76842105263158, "ram_util_percent": 82.83157894736841}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.24126739754248, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.964084442078121, "policy_loss": -0.005853850361718624, "vf_loss": 6.968771085789594, "vf_explained_var": 0.34404112554731825, "kl": 0.0058360117223981035, "entropy": 0.48506382915078017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 58118.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.87158338884828, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.900942125269975, "policy_loss": -0.006477192202681508, "vf_loss": 6.906465476909012, "vf_explained_var": 0.5266396501076915, "kl": 0.004769203696700513, "entropy": 0.5871549990126695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 58118.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 679.8366795908736, "episode_reward_min": -197.47255801072097, "episode_reward_mean": 188.43306346646858, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1451.5408149276616, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 342.3183257510782, "predator_policy": 1454.8656304233157}, "policy_reward_mean": {"prey_policy": -444.62842480186134, "predator_policy": 538.8449565350957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [286.21890459055084, 89.90544993516362, 151.08663535378736, 422.53308260607093, 97.3172443857799, 108.27493041917651, 198.32533600461863, 1.6753274856786957, 559.5247711314041, 503.8285229951546, 266.7483985891672, 11.399999999999977, 86.71979010089986, 450.7610278854967, 533.9763897044863, 99.53058216014564, 32.17287383199998, 96.25144987856484, 49.21310151275964, 208.1399738922481, 91.1999999999991, 183.72397528109587, 11.312411169197262, 1.0436096431476471e-14, 50.36917158798956, 21.093790471640773, 200.7513796049921, 468.86853932932627, 17.126097289554185, 21.61719365766879, 430.8557932965988, 91.66596167210584, 73.6933952924178, -197.47255801072097, 467.48130875410925, 85.5912169517407, 382.9475381821588, 297.2721240486135, 106.09113791065218, 172.4224005962293, 13.899999999999968, -53.91863077846627, 179.28947414794607, 143.39999999999998, 89.19421500251279, 56.41288742942442, 468.4364041495805, 447.29914892209285, 483.9601138958951, 146.58755132155562, 177.77236443920762, -5.265367785333229, 45.79562006644713, 679.8366795908736, 245.17292640247146, 336.2795771648581, 156.10967029158238, 2.935727517424282, 240.8925045676329, 81.31713428713677, 560.8729303895276, 4.299999999999995, 105.13410647361185, 363.384817099176, 395.6813929497129, 311.3999999999998, 254.10402828127954, 362.70359627289884, 347.7033488535268, 46.22736500775732, 193.33694916029447, -54.93757113254274, 409.1951017352319, 88.88880549398927, 73.00000000000013, 29.128715008510937, 202.65133683905242, 0.9499390342364986, 158.6405245012118, 598.7184913174224, 19.78246997563076, 334.6741094053528, 36.53871726049695, 278.1508295560799, 77.0999999999999, 49.78785715352951, 95.41644821476102, 239.65463052091624, 31.65060116600437, 304.7981902568056, 111.17434414769532, 25.831927209629743, 112.88137168887407, 65.80000000000055, 409.76752851098644, 485.3849431335292, 204.69565902133277, 277.7697259775813, 63.74044598138749, 2.000000000000001], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-776.4315428287837, -666.6051177243489, -152.8079162492168, -1451.5408149276616, -68.01369950519333, -104.50350911356261, -840.6097867023525, 165.187626760044, -657.0441458200404, 30.09730783804449, -28.475082689642548, -386.2561505793016, 67.84922373520465, -1037.8914302299634, -1083.6576437979538, -931.2021087194881, -755.6284754566366, 264.1007326923225, -112.06330849385513, -793.7947364161043, -355.79479407728843, -146.62698859584094, -648.1699946671857, -1364.542140420589, -361.8247750025718, -875.0617667772063, 259.6272560005731, -1105.341582010487, -984.1952406464627, 34.140486144224624, -240.0505519141883, -1391.0994602335084, -374.1489193626765, -20.432024824524007, -749.0473111803309, 36.053210978509306, -873.1729553320633, -179.95975757094666, -716.3924546133046, 31.276458897040452, 28.875111803975468, -4.067704664965106, -15.676905482390737, 61.917763741363196, -648.2007068021167, -36.92506428587774, -1332.6826028815321, -1357.0116871897183, -402.1120495423536, -850.0959376048418, -77.28724751682262, -417.2016858293837, -229.63503284946194, -1209.3243598340168, 227.27364020158407, -592.8514001052765, -105.12984502742783, -916.4758664854489, -577.5648278912483, -1418.3006487600117, 237.28895566949322, -543.0589470549434, 8.339516582138641, -95.7730429002218, -529.9778370529801, -574.2332645527018, -429.8814435592703, -610.2053867532566, -1025.3884071354946, 37.718563021949784, 32.02818546858089, -1231.7809775784142, 136.65277969938884, -799.3167061261486, -169.311522455225, 88.2249260441813, 60.71335979548353, -62.97036690633241, 38.04816980656291, -341.4602621584156, -1184.5854040280371, -529.7089476422989, -626.8424243128787, -1064.249807835271, -68.72954809579184, -959.2056391571925, -562.5827210806431, -117.99704770036983, -695.9670886217941, -286.66517500663383, -952.3119006555183, -201.05872467108927, -785.7130372142863, -18.724498985175188, 40.0000000000003, -863.8423793930607, -225.5534615989855, -965.1797053706829, -260.3482960381992, -358.04472154343534, -925.0904161525262, 20.88265232587309, -31.416137682493122, -673.2187433779038, -817.6328577998235, -518.8443730605014, -545.0776637466164, 245.167550851735, -290.19425464774093, -1242.0998851063366, 9.49323558998881, -668.9677976055032, -120.7605511734131, -470.45148213867935, -1123.64324549753, -602.2465794989506, -387.53864884625233, 115.1247294379759, -200.4853685216903, -706.5300905399665, 342.3183257510782, -192.1770004177867, -1276.343339013131, -1161.5509610195252, -563.1812551017457, -55.747177193725676, -408.87227955740525, -525.1514495062639, -959.3623491510975, 108.8006615228816, 37.2442620071501, 171.45013945934164, 30.321871312381067, -1051.678185219707, 158.41827699525183, -111.39764988858335, -712.9180330332832, -224.98742556550468, -160.54068598927026, -214.2368816532161, -425.1893507788772, -29.05253293429309, -985.8841881659836, -229.83984495717493, -841.2212373553757, -140.73766596984723, -978.7028740054129, -664.7106899710891, 13.880226943705985, -23.739619626669473, -733.1694255999665, -304.41777415507096, 18.286543105165716, -754.2692970403256, -1002.879252542828, -820.417970135191, -523.7399276356259, -393.15675595294243, -133.7958681539261, -943.7373378931568, -835.8119507988051, -480.68425367588554, -18.01732386614948, -313.34451556827634, -231.68874248134358, -299.2810732924962, -688.5384686450927, -558.6283438534842, 30.572401594157107, 9.533392704155114, -457.7400981012235, -800.5306786118621, -773.4999664063353, 40.0000000000003, -91.03643913661833, -1081.2789314241386, -115.28044407069865, -581.8290801243202, -340.6547717408522, -216.5843435583475, -118.79452128064256, -203.60626192263757, -726.6345324362758, -638.7713294097761, -131.32295754177625, -859.026253726675, -58.18349815306234, -171.35393572905983, -709.7031350799002, 40.272143820764384, -1235.765536933377, -148.45334542922427, -826.3231306317113, -28.08387697593823, -184.01596417014005, -1124.3858400551942, -678.9396862494293, -86.11280587855232, -960.5315497756765, -993.8242289387108], "policy_predator_policy_reward": [861.4115918470088, 867.8439732966733, 239.38855068872564, 1454.8656304233157, 178.9003348589824, 144.70350911356076, 780.5399851685926, 317.4152573797858, 465.4409694300598, 258.82311293772057, 127.52242175379438, 395.48374193432613, 131.8159977958198, 1036.551544703559, 1080.5974702242934, 935.9376097788273, 432.10566902452763, 618.9468448711893, 690.1467148558266, 719.5398530492846, 462.30411377569567, 306.86606748660495, 659.569994667186, 1364.542140420589, 362.3358183062556, 961.2705135744216, 955.2406504167993, 341.2347034786095, 883.2129540994429, 600.8181901072824, 336.67786535860034, 1394.002728949237, 416.32712561594957, 10.426692403254055, 475.96986743438237, 333.2756826460063, 887.0729553320634, 215.2728590837046, 183.26019480726862, 709.9957748012458, 25.72488819602466, 40.66770466496541, 81.82231827039422, 55.6607987517329, 684.0709533086765, 12.367228948517038, 1332.6826028815321, 1357.0116871897183, 446.74954625936164, 855.8276124758265, 29.804071778210794, 485.778652039638, 571.8714943272736, 1067.8392779612036, 342.40959639911193, 492.0367028339055, 121.73064019661786, 917.0011686058116, 599.1820215489205, 1418.3006487600117, 218.29603468837058, 518.3297499936747, 60.31141008867726, 118.78807790151116, 488.84213947020874, 689.0623574278939, 193.5819674409294, 649.032304860877, 844.0646326347079, 611.0865202329402, 53.56303148316105, 1231.7809775784142, 355.83695716984346, 689.7745074390745, 155.64046108919675, 222.71825937044974, 0.0, 108.34814502149929, 291.64847785624585, 184.1860150918383, 1184.9854040280372, 543.2089476423017, 560.0317469805306, 1077.1418543891564, 261.55148911962095, 945.6731722813108, 569.8827210806436, 254.0970477003692, 695.5137195430933, 376.31275908784863, 435.41901234868124, 774.364500407348, 474.71148963231155, 798.1624507167273, 414.5422056273117, 856.5993226878404, 748.817686767457, 925.875594098105, 597.7101818821134, 167.27038702107563, 768.1386164456942, 313.8415118201679, 6.5944990166312945, 692.7750142584367, 828.0284778662706, 554.244373060505, 518.901900945398, 460.844891540354, 547.1565204818661, 1230.3105456746835, 655.6733168908744, 340.080822289499, 518.9074571491223, 228.41424645455578, 1125.04324549753, 603.782307016375, 403.4324555165508, 109.87396845936246, 288.09874039880725, 700.2338529499883, 69.60756141641156, 341.12404363982506, 1279.3433390131283, 1162.850961019524, 268.83531546780904, 455.2272233012772, 710.3645681552534, 587.0439780075963, 940.422154344916, 305.8209262330085, 23.080060848671167, 79.62553768483747, 513.4199973413481, 762.0403448472559, 175.1131767818313, 140.56979238439, 702.8825110798202, 582.7262963724928, 54.74384459423165, 366.26108805600956, 440.03980510994796, 207.53902776352115, 1067.078948390561, 93.70751360005536, 511.24278723372663, 879.911217826728, 978.6207916256399, 753.6815778448533, 23.719773056294002, 59.139619626669976, 252.4763554500349, 814.2395593135178, 142.91702172113935, 795.7170690530737, 1002.9291915770644, 821.3179701351912, 473.54636221444827, 601.9908458753342, 875.961168611921, 800.2905287525845, 832.3374525191012, 503.9412219312226, 376.96987304390257, 289.0660757958711, 465.40142753823113, 102.107105496104, 1042.279459209539, 483.0381828451198, 8.527598405843047, 28.466607295845005, 681.0748048259932, 626.9838290406249, 800.4999664063366, 28.416448214761427, 469.4088687417678, 942.5611323399029, 279.85474829846186, 448.90537706256373, 501.606030122104, 360.43127543390375, 369.9729205278829, 63.60220682309174, 899.3253530796808, 491.91243597600464, 244.1043292306496, 859.126253726675, 98.38349815306096, 196.95393572905837, 579.146747378961, 500.0517723911589, 1182.861182357306, 686.7426431388174, 940.9672780994445, 118.13538852954181, 572.836708267494, 1013.3348219354186, 696.7993998761593, 131.99353823320882, 961.3315497756764, 995.0242289387108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.765748949153768, "mean_inference_ms": 4.986168139281613, "mean_action_processing_ms": 1.9495095336294992, "mean_env_wait_ms": 13.097857829336233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008787155151367188, "StateBufferConnector_ms": 0.020671486854553223, "ViewRequirementAgentConnector_ms": 0.1649566888809204}, "num_episodes": 7, "episode_return_max": 679.8366795908736, "episode_return_min": -197.47255801072097, "episode_return_mean": 188.43306346646858, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.38947425109285, "num_env_steps_trained_throughput_per_sec": 152.38947425109285, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 26473.781, "restore_workers_time_ms": 0.088, "training_step_time_ms": 26473.38, "sample_time_ms": 2447.295, "learn_time_ms": 23999.068, "learn_throughput": 166.673, "synch_weights_time_ms": 22.579}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-02-27", "timestamp": 1724383947, "time_this_iter_s": 26.31044578552246, "time_total_s": 1661.7817432880402, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095bf160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1661.7817432880402, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 35.15526315789473, "ram_util_percent": 82.96315789473681}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.99471072368521, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.16413984450083, "policy_loss": -0.007800804684924149, "vf_loss": 7.170811766165274, "vf_explained_var": 0.24047959229302784, "kl": 0.005644346004051388, "entropy": 0.42558942402481403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59063.0, "diff_num_grad_updates_vs_sampler_policy": 493.0262500000026}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.238914487349295, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.008082157720334, "policy_loss": -0.01030262381764789, "vf_loss": 7.017397139816688, "vf_explained_var": 0.4220844085885103, "kl": 0.009876291320792267, "entropy": 0.5590611340507629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59063.0, "diff_num_grad_updates_vs_sampler_policy": 493.0262500000026}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 973.087516876329, "episode_reward_min": -197.47255801072097, "episode_reward_mean": 191.8376712210378, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1418.3006487600117, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1418.3006487600117}, "policy_reward_mean": {"prey_policy": -437.84869172564424, "predator_policy": 533.7675273361632}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.6753274856786957, 559.5247711314041, 503.8285229951546, 266.7483985891672, 11.399999999999977, 86.71979010089986, 450.7610278854967, 533.9763897044863, 99.53058216014564, 32.17287383199998, 96.25144987856484, 49.21310151275964, 208.1399738922481, 91.1999999999991, 183.72397528109587, 11.312411169197262, 1.0436096431476471e-14, 50.36917158798956, 21.093790471640773, 200.7513796049921, 468.86853932932627, 17.126097289554185, 21.61719365766879, 430.8557932965988, 91.66596167210584, 73.6933952924178, -197.47255801072097, 467.48130875410925, 85.5912169517407, 382.9475381821588, 297.2721240486135, 106.09113791065218, 172.4224005962293, 13.899999999999968, -53.91863077846627, 179.28947414794607, 143.39999999999998, 89.19421500251279, 56.41288742942442, 468.4364041495805, 447.29914892209285, 483.9601138958951, 146.58755132155562, 177.77236443920762, -5.265367785333229, 45.79562006644713, 679.8366795908736, 245.17292640247146, 336.2795771648581, 156.10967029158238, 2.935727517424282, 240.8925045676329, 81.31713428713677, 560.8729303895276, 4.299999999999995, 105.13410647361185, 363.384817099176, 395.6813929497129, 311.3999999999998, 254.10402828127954, 362.70359627289884, 347.7033488535268, 46.22736500775732, 193.33694916029447, -54.93757113254274, 409.1951017352319, 88.88880549398927, 73.00000000000013, 29.128715008510937, 202.65133683905242, 0.9499390342364986, 158.6405245012118, 598.7184913174224, 19.78246997563076, 334.6741094053528, 36.53871726049695, 278.1508295560799, 77.0999999999999, 49.78785715352951, 95.41644821476102, 239.65463052091624, 31.65060116600437, 304.7981902568056, 111.17434414769532, 25.831927209629743, 112.88137168887407, 65.80000000000055, 409.76752851098644, 485.3849431335292, 204.69565902133277, 277.7697259775813, 63.74044598138749, 2.000000000000001, -82.38474751371349, 406.01921120606926, 28.121035247954936, 63.46386887599005, 973.087516876329, 246.66200658727251, 59.15346747216276], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1083.6576437979538, -931.2021087194881, -755.6284754566366, 264.1007326923225, -112.06330849385513, -793.7947364161043, -355.79479407728843, -146.62698859584094, -648.1699946671857, -1364.542140420589, -361.8247750025718, -875.0617667772063, 259.6272560005731, -1105.341582010487, -984.1952406464627, 34.140486144224624, -240.0505519141883, -1391.0994602335084, -374.1489193626765, -20.432024824524007, -749.0473111803309, 36.053210978509306, -873.1729553320633, -179.95975757094666, -716.3924546133046, 31.276458897040452, 28.875111803975468, -4.067704664965106, -15.676905482390737, 61.917763741363196, -648.2007068021167, -36.92506428587774, -1332.6826028815321, -1357.0116871897183, -402.1120495423536, -850.0959376048418, -77.28724751682262, -417.2016858293837, -229.63503284946194, -1209.3243598340168, 227.27364020158407, -592.8514001052765, -105.12984502742783, -916.4758664854489, -577.5648278912483, -1418.3006487600117, 237.28895566949322, -543.0589470549434, 8.339516582138641, -95.7730429002218, -529.9778370529801, -574.2332645527018, -429.8814435592703, -610.2053867532566, -1025.3884071354946, 37.718563021949784, 32.02818546858089, -1231.7809775784142, 136.65277969938884, -799.3167061261486, -169.311522455225, 88.2249260441813, 60.71335979548353, -62.97036690633241, 38.04816980656291, -341.4602621584156, -1184.5854040280371, -529.7089476422989, -626.8424243128787, -1064.249807835271, -68.72954809579184, -959.2056391571925, -562.5827210806431, -117.99704770036983, -695.9670886217941, -286.66517500663383, -952.3119006555183, -201.05872467108927, -785.7130372142863, -18.724498985175188, 40.0000000000003, -863.8423793930607, -225.5534615989855, -965.1797053706829, -260.3482960381992, -358.04472154343534, -925.0904161525262, 20.88265232587309, -31.416137682493122, -673.2187433779038, -817.6328577998235, -518.8443730605014, -545.0776637466164, 245.167550851735, -290.19425464774093, -1242.0998851063366, 9.49323558998881, -668.9677976055032, -120.7605511734131, -470.45148213867935, -1123.64324549753, -602.2465794989506, -387.53864884625233, 115.1247294379759, -200.4853685216903, -706.5300905399665, 342.3183257510782, -192.1770004177867, -1276.343339013131, -1161.5509610195252, -563.1812551017457, -55.747177193725676, -408.87227955740525, -525.1514495062639, -959.3623491510975, 108.8006615228816, 37.2442620071501, 171.45013945934164, 30.321871312381067, -1051.678185219707, 158.41827699525183, -111.39764988858335, -712.9180330332832, -224.98742556550468, -160.54068598927026, -214.2368816532161, -425.1893507788772, -29.05253293429309, -985.8841881659836, -229.83984495717493, -841.2212373553757, -140.73766596984723, -978.7028740054129, -664.7106899710891, 13.880226943705985, -23.739619626669473, -733.1694255999665, -304.41777415507096, 18.286543105165716, -754.2692970403256, -1002.879252542828, -820.417970135191, -523.7399276356259, -393.15675595294243, -133.7958681539261, -943.7373378931568, -835.8119507988051, -480.68425367588554, -18.01732386614948, -313.34451556827634, -231.68874248134358, -299.2810732924962, -688.5384686450927, -558.6283438534842, 30.572401594157107, 9.533392704155114, -457.7400981012235, -800.5306786118621, -773.4999664063353, 40.0000000000003, -91.03643913661833, -1081.2789314241386, -115.28044407069865, -581.8290801243202, -340.6547717408522, -216.5843435583475, -118.79452128064256, -203.60626192263757, -726.6345324362758, -638.7713294097761, -131.32295754177625, -859.026253726675, -58.18349815306234, -171.35393572905983, -709.7031350799002, 40.272143820764384, -1235.765536933377, -148.45334542922427, -826.3231306317113, -28.08387697593823, -184.01596417014005, -1124.3858400551942, -678.9396862494293, -86.11280587855232, -960.5315497756765, -993.8242289387108, -104.15938310834296, -540.3558225624205, -766.7980630097709, -26.04914798204741, -69.89777092136069, -669.1420471640231, -456.0243612780996, -37.46580515291537, 400.0, -806.5789397390348, -646.6217836681227, -92.41207271798335, -670.8357025566613, -64.75752293257008], "policy_predator_policy_reward": [1080.5974702242934, 935.9376097788273, 432.10566902452763, 618.9468448711893, 690.1467148558266, 719.5398530492846, 462.30411377569567, 306.86606748660495, 659.569994667186, 1364.542140420589, 362.3358183062556, 961.2705135744216, 955.2406504167993, 341.2347034786095, 883.2129540994429, 600.8181901072824, 336.67786535860034, 1394.002728949237, 416.32712561594957, 10.426692403254055, 475.96986743438237, 333.2756826460063, 887.0729553320634, 215.2728590837046, 183.26019480726862, 709.9957748012458, 25.72488819602466, 40.66770466496541, 81.82231827039422, 55.6607987517329, 684.0709533086765, 12.367228948517038, 1332.6826028815321, 1357.0116871897183, 446.74954625936164, 855.8276124758265, 29.804071778210794, 485.778652039638, 571.8714943272736, 1067.8392779612036, 342.40959639911193, 492.0367028339055, 121.73064019661786, 917.0011686058116, 599.1820215489205, 1418.3006487600117, 218.29603468837058, 518.3297499936747, 60.31141008867726, 118.78807790151116, 488.84213947020874, 689.0623574278939, 193.5819674409294, 649.032304860877, 844.0646326347079, 611.0865202329402, 53.56303148316105, 1231.7809775784142, 355.83695716984346, 689.7745074390745, 155.64046108919675, 222.71825937044974, 0.0, 108.34814502149929, 291.64847785624585, 184.1860150918383, 1184.9854040280372, 543.2089476423017, 560.0317469805306, 1077.1418543891564, 261.55148911962095, 945.6731722813108, 569.8827210806436, 254.0970477003692, 695.5137195430933, 376.31275908784863, 435.41901234868124, 774.364500407348, 474.71148963231155, 798.1624507167273, 414.5422056273117, 856.5993226878404, 748.817686767457, 925.875594098105, 597.7101818821134, 167.27038702107563, 768.1386164456942, 313.8415118201679, 6.5944990166312945, 692.7750142584367, 828.0284778662706, 554.244373060505, 518.901900945398, 460.844891540354, 547.1565204818661, 1230.3105456746835, 655.6733168908744, 340.080822289499, 518.9074571491223, 228.41424645455578, 1125.04324549753, 603.782307016375, 403.4324555165508, 109.87396845936246, 288.09874039880725, 700.2338529499883, 69.60756141641156, 341.12404363982506, 1279.3433390131283, 1162.850961019524, 268.83531546780904, 455.2272233012772, 710.3645681552534, 587.0439780075963, 940.422154344916, 305.8209262330085, 23.080060848671167, 79.62553768483747, 513.4199973413481, 762.0403448472559, 175.1131767818313, 140.56979238439, 702.8825110798202, 582.7262963724928, 54.74384459423165, 366.26108805600956, 440.03980510994796, 207.53902776352115, 1067.078948390561, 93.70751360005536, 511.24278723372663, 879.911217826728, 978.6207916256399, 753.6815778448533, 23.719773056294002, 59.139619626669976, 252.4763554500349, 814.2395593135178, 142.91702172113935, 795.7170690530737, 1002.9291915770644, 821.3179701351912, 473.54636221444827, 601.9908458753342, 875.961168611921, 800.2905287525845, 832.3374525191012, 503.9412219312226, 376.96987304390257, 289.0660757958711, 465.40142753823113, 102.107105496104, 1042.279459209539, 483.0381828451198, 8.527598405843047, 28.466607295845005, 681.0748048259932, 626.9838290406249, 800.4999664063366, 28.416448214761427, 469.4088687417678, 942.5611323399029, 279.85474829846186, 448.90537706256373, 501.606030122104, 360.43127543390375, 369.9729205278829, 63.60220682309174, 899.3253530796808, 491.91243597600464, 244.1043292306496, 859.126253726675, 98.38349815306096, 196.95393572905837, 579.146747378961, 500.0517723911589, 1182.861182357306, 686.7426431388174, 940.9672780994445, 118.13538852954181, 572.836708267494, 1013.3348219354186, 696.7993998761593, 131.99353823320882, 961.3315497756764, 995.0242289387108, 269.7455374839027, 292.38492067315127, 480.75329262164763, 718.1131295762385, 89.63063520511226, 677.5302181282258, 188.70567057553163, 368.248364731473, 658.2937908291415, 721.3726657862193, 374.02243969563415, 611.6734232777452, 687.0263649904832, 107.7203279709086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.759266629755984, "mean_inference_ms": 4.97043378719079, "mean_action_processing_ms": 1.9449114688794422, "mean_env_wait_ms": 13.105616960578459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008841633796691895, "StateBufferConnector_ms": 0.020645618438720703, "ViewRequirementAgentConnector_ms": 0.17747843265533447}, "num_episodes": 7, "episode_return_max": 973.087516876329, "episode_return_min": -197.47255801072097, "episode_return_mean": 191.8376712210378, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.594832109631, "num_env_steps_trained_throughput_per_sec": 147.594832109631, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 26571.947, "restore_workers_time_ms": 0.094, "training_step_time_ms": 26571.525, "sample_time_ms": 2527.118, "learn_time_ms": 24015.517, "learn_throughput": 166.559, "synch_weights_time_ms": 24.229}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-02-54", "timestamp": 1724383974, "time_this_iter_s": 27.142489194869995, "time_total_s": 1688.9242324829102, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3096285e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1688.9242324829102, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 38.75, "ram_util_percent": 83.13157894736841}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.6173234270994, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.5827775410243445, "policy_loss": -0.007370906175858287, "vf_loss": 7.588957364723165, "vf_explained_var": 0.198267399634003, "kl": 0.005955330543860635, "entropy": 0.3745132433674323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60008.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.953256920405796, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.356856526773442, "policy_loss": -0.011899179074095276, "vf_loss": 7.367759053669278, "vf_explained_var": 0.4892617906842913, "kl": 0.00996642037831917, "entropy": 0.49751888964542007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60008.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 973.087516876329, "episode_reward_min": -197.47255801072097, "episode_reward_mean": 175.7996872114739, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1418.3006487600117, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1418.3006487600117}, "policy_reward_mean": {"prey_policy": -428.8173810845674, "predator_policy": 516.7172246903043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.25144987856484, 49.21310151275964, 208.1399738922481, 91.1999999999991, 183.72397528109587, 11.312411169197262, 1.0436096431476471e-14, 50.36917158798956, 21.093790471640773, 200.7513796049921, 468.86853932932627, 17.126097289554185, 21.61719365766879, 430.8557932965988, 91.66596167210584, 73.6933952924178, -197.47255801072097, 467.48130875410925, 85.5912169517407, 382.9475381821588, 297.2721240486135, 106.09113791065218, 172.4224005962293, 13.899999999999968, -53.91863077846627, 179.28947414794607, 143.39999999999998, 89.19421500251279, 56.41288742942442, 468.4364041495805, 447.29914892209285, 483.9601138958951, 146.58755132155562, 177.77236443920762, -5.265367785333229, 45.79562006644713, 679.8366795908736, 245.17292640247146, 336.2795771648581, 156.10967029158238, 2.935727517424282, 240.8925045676329, 81.31713428713677, 560.8729303895276, 4.299999999999995, 105.13410647361185, 363.384817099176, 395.6813929497129, 311.3999999999998, 254.10402828127954, 362.70359627289884, 347.7033488535268, 46.22736500775732, 193.33694916029447, -54.93757113254274, 409.1951017352319, 88.88880549398927, 73.00000000000013, 29.128715008510937, 202.65133683905242, 0.9499390342364986, 158.6405245012118, 598.7184913174224, 19.78246997563076, 334.6741094053528, 36.53871726049695, 278.1508295560799, 77.0999999999999, 49.78785715352951, 95.41644821476102, 239.65463052091624, 31.65060116600437, 304.7981902568056, 111.17434414769532, 25.831927209629743, 112.88137168887407, 65.80000000000055, 409.76752851098644, 485.3849431335292, 204.69565902133277, 277.7697259775813, 63.74044598138749, 2.000000000000001, -82.38474751371349, 406.01921120606926, 28.121035247954936, 63.46386887599005, 973.087516876329, 246.66200658727251, 59.15346747216276, 21.51128131009836, 160.30215697291808, 41.40950420841676, 182.3421957726399, 7.558686617562733, 86.49999999999976, 9.223599400724309, 95.57384986840967, 337.87959300349905, 0.238415773779586], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-749.0473111803309, 36.053210978509306, -873.1729553320633, -179.95975757094666, -716.3924546133046, 31.276458897040452, 28.875111803975468, -4.067704664965106, -15.676905482390737, 61.917763741363196, -648.2007068021167, -36.92506428587774, -1332.6826028815321, -1357.0116871897183, -402.1120495423536, -850.0959376048418, -77.28724751682262, -417.2016858293837, -229.63503284946194, -1209.3243598340168, 227.27364020158407, -592.8514001052765, -105.12984502742783, -916.4758664854489, -577.5648278912483, -1418.3006487600117, 237.28895566949322, -543.0589470549434, 8.339516582138641, -95.7730429002218, -529.9778370529801, -574.2332645527018, -429.8814435592703, -610.2053867532566, -1025.3884071354946, 37.718563021949784, 32.02818546858089, -1231.7809775784142, 136.65277969938884, -799.3167061261486, -169.311522455225, 88.2249260441813, 60.71335979548353, -62.97036690633241, 38.04816980656291, -341.4602621584156, -1184.5854040280371, -529.7089476422989, -626.8424243128787, -1064.249807835271, -68.72954809579184, -959.2056391571925, -562.5827210806431, -117.99704770036983, -695.9670886217941, -286.66517500663383, -952.3119006555183, -201.05872467108927, -785.7130372142863, -18.724498985175188, 40.0000000000003, -863.8423793930607, -225.5534615989855, -965.1797053706829, -260.3482960381992, -358.04472154343534, -925.0904161525262, 20.88265232587309, -31.416137682493122, -673.2187433779038, -817.6328577998235, -518.8443730605014, -545.0776637466164, 245.167550851735, -290.19425464774093, -1242.0998851063366, 9.49323558998881, -668.9677976055032, -120.7605511734131, -470.45148213867935, -1123.64324549753, -602.2465794989506, -387.53864884625233, 115.1247294379759, -200.4853685216903, -706.5300905399665, 342.3183257510782, -192.1770004177867, -1276.343339013131, -1161.5509610195252, -563.1812551017457, -55.747177193725676, -408.87227955740525, -525.1514495062639, -959.3623491510975, 108.8006615228816, 37.2442620071501, 171.45013945934164, 30.321871312381067, -1051.678185219707, 158.41827699525183, -111.39764988858335, -712.9180330332832, -224.98742556550468, -160.54068598927026, -214.2368816532161, -425.1893507788772, -29.05253293429309, -985.8841881659836, -229.83984495717493, -841.2212373553757, -140.73766596984723, -978.7028740054129, -664.7106899710891, 13.880226943705985, -23.739619626669473, -733.1694255999665, -304.41777415507096, 18.286543105165716, -754.2692970403256, -1002.879252542828, -820.417970135191, -523.7399276356259, -393.15675595294243, -133.7958681539261, -943.7373378931568, -835.8119507988051, -480.68425367588554, -18.01732386614948, -313.34451556827634, -231.68874248134358, -299.2810732924962, -688.5384686450927, -558.6283438534842, 30.572401594157107, 9.533392704155114, -457.7400981012235, -800.5306786118621, -773.4999664063353, 40.0000000000003, -91.03643913661833, -1081.2789314241386, -115.28044407069865, -581.8290801243202, -340.6547717408522, -216.5843435583475, -118.79452128064256, -203.60626192263757, -726.6345324362758, -638.7713294097761, -131.32295754177625, -859.026253726675, -58.18349815306234, -171.35393572905983, -709.7031350799002, 40.272143820764384, -1235.765536933377, -148.45334542922427, -826.3231306317113, -28.08387697593823, -184.01596417014005, -1124.3858400551942, -678.9396862494293, -86.11280587855232, -960.5315497756765, -993.8242289387108, -104.15938310834296, -540.3558225624205, -766.7980630097709, -26.04914798204741, -69.89777092136069, -669.1420471640231, -456.0243612780996, -37.46580515291537, 400.0, -806.5789397390348, -646.6217836681227, -92.41207271798335, -670.8357025566613, -64.75752293257008, -131.95736056736703, -87.18617669952515, -161.88855060332176, -796.9510107871239, -790.3227658821089, -478.33902923814276, -562.2899073913933, -588.222232813567, -233.90913322633773, -308.86012600909487, -671.213783287632, -221.77878674473536, -491.6730379732041, -805.8577720040579, -233.0656646137177, -535.5590301129116, -119.35365687984012, -451.21507091483824, -568.4933867235013, -941.3674258916525], "policy_predator_policy_reward": [475.96986743438237, 333.2756826460063, 887.0729553320634, 215.2728590837046, 183.26019480726862, 709.9957748012458, 25.72488819602466, 40.66770466496541, 81.82231827039422, 55.6607987517329, 684.0709533086765, 12.367228948517038, 1332.6826028815321, 1357.0116871897183, 446.74954625936164, 855.8276124758265, 29.804071778210794, 485.778652039638, 571.8714943272736, 1067.8392779612036, 342.40959639911193, 492.0367028339055, 121.73064019661786, 917.0011686058116, 599.1820215489205, 1418.3006487600117, 218.29603468837058, 518.3297499936747, 60.31141008867726, 118.78807790151116, 488.84213947020874, 689.0623574278939, 193.5819674409294, 649.032304860877, 844.0646326347079, 611.0865202329402, 53.56303148316105, 1231.7809775784142, 355.83695716984346, 689.7745074390745, 155.64046108919675, 222.71825937044974, 0.0, 108.34814502149929, 291.64847785624585, 184.1860150918383, 1184.9854040280372, 543.2089476423017, 560.0317469805306, 1077.1418543891564, 261.55148911962095, 945.6731722813108, 569.8827210806436, 254.0970477003692, 695.5137195430933, 376.31275908784863, 435.41901234868124, 774.364500407348, 474.71148963231155, 798.1624507167273, 414.5422056273117, 856.5993226878404, 748.817686767457, 925.875594098105, 597.7101818821134, 167.27038702107563, 768.1386164456942, 313.8415118201679, 6.5944990166312945, 692.7750142584367, 828.0284778662706, 554.244373060505, 518.901900945398, 460.844891540354, 547.1565204818661, 1230.3105456746835, 655.6733168908744, 340.080822289499, 518.9074571491223, 228.41424645455578, 1125.04324549753, 603.782307016375, 403.4324555165508, 109.87396845936246, 288.09874039880725, 700.2338529499883, 69.60756141641156, 341.12404363982506, 1279.3433390131283, 1162.850961019524, 268.83531546780904, 455.2272233012772, 710.3645681552534, 587.0439780075963, 940.422154344916, 305.8209262330085, 23.080060848671167, 79.62553768483747, 513.4199973413481, 762.0403448472559, 175.1131767818313, 140.56979238439, 702.8825110798202, 582.7262963724928, 54.74384459423165, 366.26108805600956, 440.03980510994796, 207.53902776352115, 1067.078948390561, 93.70751360005536, 511.24278723372663, 879.911217826728, 978.6207916256399, 753.6815778448533, 23.719773056294002, 59.139619626669976, 252.4763554500349, 814.2395593135178, 142.91702172113935, 795.7170690530737, 1002.9291915770644, 821.3179701351912, 473.54636221444827, 601.9908458753342, 875.961168611921, 800.2905287525845, 832.3374525191012, 503.9412219312226, 376.96987304390257, 289.0660757958711, 465.40142753823113, 102.107105496104, 1042.279459209539, 483.0381828451198, 8.527598405843047, 28.466607295845005, 681.0748048259932, 626.9838290406249, 800.4999664063366, 28.416448214761427, 469.4088687417678, 942.5611323399029, 279.85474829846186, 448.90537706256373, 501.606030122104, 360.43127543390375, 369.9729205278829, 63.60220682309174, 899.3253530796808, 491.91243597600464, 244.1043292306496, 859.126253726675, 98.38349815306096, 196.95393572905837, 579.146747378961, 500.0517723911589, 1182.861182357306, 686.7426431388174, 940.9672780994445, 118.13538852954181, 572.836708267494, 1013.3348219354186, 696.7993998761593, 131.99353823320882, 961.3315497756764, 995.0242289387108, 269.7455374839027, 292.38492067315127, 480.75329262164763, 718.1131295762385, 89.63063520511226, 677.5302181282258, 188.70567057553163, 368.248364731473, 658.2937908291415, 721.3726657862193, 374.02243969563415, 611.6734232777452, 687.0263649904832, 107.7203279709086, 3.8838834764831844, 236.7709351005041, 723.8494290119685, 395.29228935139497, 665.4536353576507, 644.6176639710194, 571.3086889370131, 761.5456470405879, 311.2183861615334, 239.1095596914646, 674.9137832876329, 304.57878674473454, 499.29663737392974, 807.457772004058, 528.0504727216943, 336.1480718733456, 660.4630976719641, 247.9852231262119, 516.8285016383813, 993.270726750552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.75866250691623, "mean_inference_ms": 4.953525180350676, "mean_action_processing_ms": 1.9287481041687509, "mean_env_wait_ms": 13.109414365714567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008838534355163574, "StateBufferConnector_ms": 0.020557165145874023, "ViewRequirementAgentConnector_ms": 0.2372812032699585}, "num_episodes": 10, "episode_return_max": 973.087516876329, "episode_return_min": -197.47255801072097, "episode_return_mean": 175.7996872114739, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.36315860559213, "num_env_steps_trained_throughput_per_sec": 150.36315860559213, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 26598.129, "restore_workers_time_ms": 0.132, "training_step_time_ms": 26597.634, "sample_time_ms": 2575.288, "learn_time_ms": 23995.934, "learn_throughput": 166.695, "synch_weights_time_ms": 21.763}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-03-21", "timestamp": 1724384001, "time_this_iter_s": 26.67043399810791, "time_total_s": 1715.594666481018, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3096289d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1715.594666481018, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 34.36486486486486, "ram_util_percent": 82.6054054054054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.845746764178, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.345954965157484, "policy_loss": -0.005299728188082261, "vf_loss": 7.350105405232263, "vf_explained_var": 0.18096004282986677, "kl": 0.005746437253913394, "entropy": 0.37626596909982185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60953.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.76377529870896, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.373539864575421, "policy_loss": -0.009222501085667068, "vf_loss": 7.381937849963153, "vf_explained_var": 0.35961161195916475, "kl": 0.00824529425014382, "entropy": 0.4837557765541884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60953.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 973.087516876329, "episode_reward_min": -197.47255801072097, "episode_reward_mean": 180.36718299696335, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1418.3006487600117, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1418.3006487600117}, "policy_reward_mean": {"prey_policy": -430.0356502505081, "predator_policy": 520.2192417489899}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.126097289554185, 21.61719365766879, 430.8557932965988, 91.66596167210584, 73.6933952924178, -197.47255801072097, 467.48130875410925, 85.5912169517407, 382.9475381821588, 297.2721240486135, 106.09113791065218, 172.4224005962293, 13.899999999999968, -53.91863077846627, 179.28947414794607, 143.39999999999998, 89.19421500251279, 56.41288742942442, 468.4364041495805, 447.29914892209285, 483.9601138958951, 146.58755132155562, 177.77236443920762, -5.265367785333229, 45.79562006644713, 679.8366795908736, 245.17292640247146, 336.2795771648581, 156.10967029158238, 2.935727517424282, 240.8925045676329, 81.31713428713677, 560.8729303895276, 4.299999999999995, 105.13410647361185, 363.384817099176, 395.6813929497129, 311.3999999999998, 254.10402828127954, 362.70359627289884, 347.7033488535268, 46.22736500775732, 193.33694916029447, -54.93757113254274, 409.1951017352319, 88.88880549398927, 73.00000000000013, 29.128715008510937, 202.65133683905242, 0.9499390342364986, 158.6405245012118, 598.7184913174224, 19.78246997563076, 334.6741094053528, 36.53871726049695, 278.1508295560799, 77.0999999999999, 49.78785715352951, 95.41644821476102, 239.65463052091624, 31.65060116600437, 304.7981902568056, 111.17434414769532, 25.831927209629743, 112.88137168887407, 65.80000000000055, 409.76752851098644, 485.3849431335292, 204.69565902133277, 277.7697259775813, 63.74044598138749, 2.000000000000001, -82.38474751371349, 406.01921120606926, 28.121035247954936, 63.46386887599005, 973.087516876329, 246.66200658727251, 59.15346747216276, 21.51128131009836, 160.30215697291808, 41.40950420841676, 182.3421957726399, 7.558686617562733, 86.49999999999976, 9.223599400724309, 95.57384986840967, 337.87959300349905, 0.238415773779586, 40.98600526742232, 632.4155553441824, 108.09999999999864, 7.170310496922488, 386.6595231978612, -68.21629719278397, 11.211041127172257, 33.72278321197674, 89.77635220899644, 396.23398171529107, 199.6141158997234], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-105.12984502742783, -916.4758664854489, -577.5648278912483, -1418.3006487600117, 237.28895566949322, -543.0589470549434, 8.339516582138641, -95.7730429002218, -529.9778370529801, -574.2332645527018, -429.8814435592703, -610.2053867532566, -1025.3884071354946, 37.718563021949784, 32.02818546858089, -1231.7809775784142, 136.65277969938884, -799.3167061261486, -169.311522455225, 88.2249260441813, 60.71335979548353, -62.97036690633241, 38.04816980656291, -341.4602621584156, -1184.5854040280371, -529.7089476422989, -626.8424243128787, -1064.249807835271, -68.72954809579184, -959.2056391571925, -562.5827210806431, -117.99704770036983, -695.9670886217941, -286.66517500663383, -952.3119006555183, -201.05872467108927, -785.7130372142863, -18.724498985175188, 40.0000000000003, -863.8423793930607, -225.5534615989855, -965.1797053706829, -260.3482960381992, -358.04472154343534, -925.0904161525262, 20.88265232587309, -31.416137682493122, -673.2187433779038, -817.6328577998235, -518.8443730605014, -545.0776637466164, 245.167550851735, -290.19425464774093, -1242.0998851063366, 9.49323558998881, -668.9677976055032, -120.7605511734131, -470.45148213867935, -1123.64324549753, -602.2465794989506, -387.53864884625233, 115.1247294379759, -200.4853685216903, -706.5300905399665, 342.3183257510782, -192.1770004177867, -1276.343339013131, -1161.5509610195252, -563.1812551017457, -55.747177193725676, -408.87227955740525, -525.1514495062639, -959.3623491510975, 108.8006615228816, 37.2442620071501, 171.45013945934164, 30.321871312381067, -1051.678185219707, 158.41827699525183, -111.39764988858335, -712.9180330332832, -224.98742556550468, -160.54068598927026, -214.2368816532161, -425.1893507788772, -29.05253293429309, -985.8841881659836, -229.83984495717493, -841.2212373553757, -140.73766596984723, -978.7028740054129, -664.7106899710891, 13.880226943705985, -23.739619626669473, -733.1694255999665, -304.41777415507096, 18.286543105165716, -754.2692970403256, -1002.879252542828, -820.417970135191, -523.7399276356259, -393.15675595294243, -133.7958681539261, -943.7373378931568, -835.8119507988051, -480.68425367588554, -18.01732386614948, -313.34451556827634, -231.68874248134358, -299.2810732924962, -688.5384686450927, -558.6283438534842, 30.572401594157107, 9.533392704155114, -457.7400981012235, -800.5306786118621, -773.4999664063353, 40.0000000000003, -91.03643913661833, -1081.2789314241386, -115.28044407069865, -581.8290801243202, -340.6547717408522, -216.5843435583475, -118.79452128064256, -203.60626192263757, -726.6345324362758, -638.7713294097761, -131.32295754177625, -859.026253726675, -58.18349815306234, -171.35393572905983, -709.7031350799002, 40.272143820764384, -1235.765536933377, -148.45334542922427, -826.3231306317113, -28.08387697593823, -184.01596417014005, -1124.3858400551942, -678.9396862494293, -86.11280587855232, -960.5315497756765, -993.8242289387108, -104.15938310834296, -540.3558225624205, -766.7980630097709, -26.04914798204741, -69.89777092136069, -669.1420471640231, -456.0243612780996, -37.46580515291537, 400.0, -806.5789397390348, -646.6217836681227, -92.41207271798335, -670.8357025566613, -64.75752293257008, -131.95736056736703, -87.18617669952515, -161.88855060332176, -796.9510107871239, -790.3227658821089, -478.33902923814276, -562.2899073913933, -588.222232813567, -233.90913322633773, -308.86012600909487, -671.213783287632, -221.77878674473536, -491.6730379732041, -805.8577720040579, -233.0656646137177, -535.5590301129116, -119.35365687984012, -451.21507091483824, -568.4933867235013, -941.3674258916525, -265.4530304151007, -581.0313342712791, -789.9228491222359, 245.79869009638887, -867.4872042933888, 71.73961600014367, -260.3450777520491, -25.453055138341334, -992.5173478316578, -464.5296503646198, -544.9244053945134, -582.161830378195, -574.5337553733136, -639.5246965935901, -616.4022906913333, -272.7934197124462, -299.9707157578201, -543.4245675986006, 135.64702597462232, -811.9270986287705, -417.71781642562433, -452.9676971793527], "policy_predator_policy_reward": [121.73064019661786, 917.0011686058116, 599.1820215489205, 1418.3006487600117, 218.29603468837058, 518.3297499936747, 60.31141008867726, 118.78807790151116, 488.84213947020874, 689.0623574278939, 193.5819674409294, 649.032304860877, 844.0646326347079, 611.0865202329402, 53.56303148316105, 1231.7809775784142, 355.83695716984346, 689.7745074390745, 155.64046108919675, 222.71825937044974, 0.0, 108.34814502149929, 291.64847785624585, 184.1860150918383, 1184.9854040280372, 543.2089476423017, 560.0317469805306, 1077.1418543891564, 261.55148911962095, 945.6731722813108, 569.8827210806436, 254.0970477003692, 695.5137195430933, 376.31275908784863, 435.41901234868124, 774.364500407348, 474.71148963231155, 798.1624507167273, 414.5422056273117, 856.5993226878404, 748.817686767457, 925.875594098105, 597.7101818821134, 167.27038702107563, 768.1386164456942, 313.8415118201679, 6.5944990166312945, 692.7750142584367, 828.0284778662706, 554.244373060505, 518.901900945398, 460.844891540354, 547.1565204818661, 1230.3105456746835, 655.6733168908744, 340.080822289499, 518.9074571491223, 228.41424645455578, 1125.04324549753, 603.782307016375, 403.4324555165508, 109.87396845936246, 288.09874039880725, 700.2338529499883, 69.60756141641156, 341.12404363982506, 1279.3433390131283, 1162.850961019524, 268.83531546780904, 455.2272233012772, 710.3645681552534, 587.0439780075963, 940.422154344916, 305.8209262330085, 23.080060848671167, 79.62553768483747, 513.4199973413481, 762.0403448472559, 175.1131767818313, 140.56979238439, 702.8825110798202, 582.7262963724928, 54.74384459423165, 366.26108805600956, 440.03980510994796, 207.53902776352115, 1067.078948390561, 93.70751360005536, 511.24278723372663, 879.911217826728, 978.6207916256399, 753.6815778448533, 23.719773056294002, 59.139619626669976, 252.4763554500349, 814.2395593135178, 142.91702172113935, 795.7170690530737, 1002.9291915770644, 821.3179701351912, 473.54636221444827, 601.9908458753342, 875.961168611921, 800.2905287525845, 832.3374525191012, 503.9412219312226, 376.96987304390257, 289.0660757958711, 465.40142753823113, 102.107105496104, 1042.279459209539, 483.0381828451198, 8.527598405843047, 28.466607295845005, 681.0748048259932, 626.9838290406249, 800.4999664063366, 28.416448214761427, 469.4088687417678, 942.5611323399029, 279.85474829846186, 448.90537706256373, 501.606030122104, 360.43127543390375, 369.9729205278829, 63.60220682309174, 899.3253530796808, 491.91243597600464, 244.1043292306496, 859.126253726675, 98.38349815306096, 196.95393572905837, 579.146747378961, 500.0517723911589, 1182.861182357306, 686.7426431388174, 940.9672780994445, 118.13538852954181, 572.836708267494, 1013.3348219354186, 696.7993998761593, 131.99353823320882, 961.3315497756764, 995.0242289387108, 269.7455374839027, 292.38492067315127, 480.75329262164763, 718.1131295762385, 89.63063520511226, 677.5302181282258, 188.70567057553163, 368.248364731473, 658.2937908291415, 721.3726657862193, 374.02243969563415, 611.6734232777452, 687.0263649904832, 107.7203279709086, 3.8838834764831844, 236.7709351005041, 723.8494290119685, 395.29228935139497, 665.4536353576507, 644.6176639710194, 571.3086889370131, 761.5456470405879, 311.2183861615334, 239.1095596914646, 674.9137832876329, 304.57878674473454, 499.29663737392974, 807.457772004058, 528.0504727216943, 336.1480718733456, 660.4630976719641, 247.9852231262119, 516.8285016383813, 993.270726750552, 288.66707331545416, 598.8032966383568, 431.54740935752557, 744.992305012503, 867.5872042933889, 36.260383999856074, 283.51849935587677, 9.449944031440484, 989.6156243729413, 854.090897021199, 451.17245598198696, 607.6974825979386, 580.154735296619, 645.1147577974566, 619.4842567025838, 303.4342369131754, 315.41096309648486, 617.7606724689376, 311.2103536814661, 761.3037006879717, 382.032722139909, 688.2669073647935]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.737723806263733, "mean_inference_ms": 4.965609736085743, "mean_action_processing_ms": 1.9292531291260715, "mean_env_wait_ms": 13.125343400986747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00877845287322998, "StateBufferConnector_ms": 0.021295785903930664, "ViewRequirementAgentConnector_ms": 0.2361534833908081}, "num_episodes": 11, "episode_return_max": 973.087516876329, "episode_return_min": -197.47255801072097, "episode_return_mean": 180.36718299696335, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.4114593899013, "num_env_steps_trained_throughput_per_sec": 149.4114593899013, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 26653.652, "restore_workers_time_ms": 0.105, "training_step_time_ms": 26653.231, "sample_time_ms": 2609.09, "learn_time_ms": 24016.704, "learn_throughput": 166.551, "synch_weights_time_ms": 22.796}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-03-48", "timestamp": 1724384028, "time_this_iter_s": 26.826231002807617, "time_total_s": 1742.4208974838257, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095b4e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1742.4208974838257, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 35.96315789473683, "ram_util_percent": 82.57631578947367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.911680459976196, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.691591481304673, "policy_loss": -0.007286376986041586, "vf_loss": 7.6979596450846035, "vf_explained_var": 0.07871378042079784, "kl": 0.004590974452599843, "entropy": 0.3392886100465028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61898.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.40607299779458, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.6689480145772295, "policy_loss": -0.00862900179382118, "vf_loss": 7.676820752986525, "vf_explained_var": 0.3676376600114126, "kl": 0.0075624954699484446, "entropy": 0.46208564216497716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61898.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 973.087516876329, "episode_reward_min": -82.38474751371349, "episode_reward_mean": 186.58757536585597, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1276.343339013131, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1279.3433390131283}, "policy_reward_mean": {"prey_policy": -435.1285396183875, "predator_policy": 528.4223273013157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.2721240486135, 106.09113791065218, 172.4224005962293, 13.899999999999968, -53.91863077846627, 179.28947414794607, 143.39999999999998, 89.19421500251279, 56.41288742942442, 468.4364041495805, 447.29914892209285, 483.9601138958951, 146.58755132155562, 177.77236443920762, -5.265367785333229, 45.79562006644713, 679.8366795908736, 245.17292640247146, 336.2795771648581, 156.10967029158238, 2.935727517424282, 240.8925045676329, 81.31713428713677, 560.8729303895276, 4.299999999999995, 105.13410647361185, 363.384817099176, 395.6813929497129, 311.3999999999998, 254.10402828127954, 362.70359627289884, 347.7033488535268, 46.22736500775732, 193.33694916029447, -54.93757113254274, 409.1951017352319, 88.88880549398927, 73.00000000000013, 29.128715008510937, 202.65133683905242, 0.9499390342364986, 158.6405245012118, 598.7184913174224, 19.78246997563076, 334.6741094053528, 36.53871726049695, 278.1508295560799, 77.0999999999999, 49.78785715352951, 95.41644821476102, 239.65463052091624, 31.65060116600437, 304.7981902568056, 111.17434414769532, 25.831927209629743, 112.88137168887407, 65.80000000000055, 409.76752851098644, 485.3849431335292, 204.69565902133277, 277.7697259775813, 63.74044598138749, 2.000000000000001, -82.38474751371349, 406.01921120606926, 28.121035247954936, 63.46386887599005, 973.087516876329, 246.66200658727251, 59.15346747216276, 21.51128131009836, 160.30215697291808, 41.40950420841676, 182.3421957726399, 7.558686617562733, 86.49999999999976, 9.223599400724309, 95.57384986840967, 337.87959300349905, 0.238415773779586, 40.98600526742232, 632.4155553441824, 108.09999999999864, 7.170310496922488, 386.6595231978612, -68.21629719278397, 11.211041127172257, 33.72278321197674, 89.77635220899644, 396.23398171529107, 199.6141158997234, 70.39999999999988, 6.299999999999997, 577.4089364686808, 523.1827175371687, 12.199999999999989, 179.81462450195497, 347.06288867501434, 220.57929645913723, 58.59672033293218], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-169.311522455225, 88.2249260441813, 60.71335979548353, -62.97036690633241, 38.04816980656291, -341.4602621584156, -1184.5854040280371, -529.7089476422989, -626.8424243128787, -1064.249807835271, -68.72954809579184, -959.2056391571925, -562.5827210806431, -117.99704770036983, -695.9670886217941, -286.66517500663383, -952.3119006555183, -201.05872467108927, -785.7130372142863, -18.724498985175188, 40.0000000000003, -863.8423793930607, -225.5534615989855, -965.1797053706829, -260.3482960381992, -358.04472154343534, -925.0904161525262, 20.88265232587309, -31.416137682493122, -673.2187433779038, -817.6328577998235, -518.8443730605014, -545.0776637466164, 245.167550851735, -290.19425464774093, -1242.0998851063366, 9.49323558998881, -668.9677976055032, -120.7605511734131, -470.45148213867935, -1123.64324549753, -602.2465794989506, -387.53864884625233, 115.1247294379759, -200.4853685216903, -706.5300905399665, 342.3183257510782, -192.1770004177867, -1276.343339013131, -1161.5509610195252, -563.1812551017457, -55.747177193725676, -408.87227955740525, -525.1514495062639, -959.3623491510975, 108.8006615228816, 37.2442620071501, 171.45013945934164, 30.321871312381067, -1051.678185219707, 158.41827699525183, -111.39764988858335, -712.9180330332832, -224.98742556550468, -160.54068598927026, -214.2368816532161, -425.1893507788772, -29.05253293429309, -985.8841881659836, -229.83984495717493, -841.2212373553757, -140.73766596984723, -978.7028740054129, -664.7106899710891, 13.880226943705985, -23.739619626669473, -733.1694255999665, -304.41777415507096, 18.286543105165716, -754.2692970403256, -1002.879252542828, -820.417970135191, -523.7399276356259, -393.15675595294243, -133.7958681539261, -943.7373378931568, -835.8119507988051, -480.68425367588554, -18.01732386614948, -313.34451556827634, -231.68874248134358, -299.2810732924962, -688.5384686450927, -558.6283438534842, 30.572401594157107, 9.533392704155114, -457.7400981012235, -800.5306786118621, -773.4999664063353, 40.0000000000003, -91.03643913661833, -1081.2789314241386, -115.28044407069865, -581.8290801243202, -340.6547717408522, -216.5843435583475, -118.79452128064256, -203.60626192263757, -726.6345324362758, -638.7713294097761, -131.32295754177625, -859.026253726675, -58.18349815306234, -171.35393572905983, -709.7031350799002, 40.272143820764384, -1235.765536933377, -148.45334542922427, -826.3231306317113, -28.08387697593823, -184.01596417014005, -1124.3858400551942, -678.9396862494293, -86.11280587855232, -960.5315497756765, -993.8242289387108, -104.15938310834296, -540.3558225624205, -766.7980630097709, -26.04914798204741, -69.89777092136069, -669.1420471640231, -456.0243612780996, -37.46580515291537, 400.0, -806.5789397390348, -646.6217836681227, -92.41207271798335, -670.8357025566613, -64.75752293257008, -131.95736056736703, -87.18617669952515, -161.88855060332176, -796.9510107871239, -790.3227658821089, -478.33902923814276, -562.2899073913933, -588.222232813567, -233.90913322633773, -308.86012600909487, -671.213783287632, -221.77878674473536, -491.6730379732041, -805.8577720040579, -233.0656646137177, -535.5590301129116, -119.35365687984012, -451.21507091483824, -568.4933867235013, -941.3674258916525, -265.4530304151007, -581.0313342712791, -789.9228491222359, 245.79869009638887, -867.4872042933888, 71.73961600014367, -260.3450777520491, -25.453055138341334, -992.5173478316578, -464.5296503646198, -544.9244053945134, -582.161830378195, -574.5337553733136, -639.5246965935901, -616.4022906913333, -272.7934197124462, -299.9707157578201, -543.4245675986006, 135.64702597462232, -811.9270986287705, -417.71781642562433, -452.9676971793527, -607.7697532850318, -664.4450477528336, -813.9186429329519, -790.5248451155933, -696.1548234137964, 291.3831752811599, -815.9919863782546, -212.63633877683623, -596.6114044789971, -846.3155898512598, -978.3361980050573, -107.7888630456043, -197.02423655816625, -752.4107738996864, -519.2214096476558, -43.21171873414738, -461.5654349122572, -611.0931825049298], "policy_predator_policy_reward": [155.64046108919675, 222.71825937044974, 0.0, 108.34814502149929, 291.64847785624585, 184.1860150918383, 1184.9854040280372, 543.2089476423017, 560.0317469805306, 1077.1418543891564, 261.55148911962095, 945.6731722813108, 569.8827210806436, 254.0970477003692, 695.5137195430933, 376.31275908784863, 435.41901234868124, 774.364500407348, 474.71148963231155, 798.1624507167273, 414.5422056273117, 856.5993226878404, 748.817686767457, 925.875594098105, 597.7101818821134, 167.27038702107563, 768.1386164456942, 313.8415118201679, 6.5944990166312945, 692.7750142584367, 828.0284778662706, 554.244373060505, 518.901900945398, 460.844891540354, 547.1565204818661, 1230.3105456746835, 655.6733168908744, 340.080822289499, 518.9074571491223, 228.41424645455578, 1125.04324549753, 603.782307016375, 403.4324555165508, 109.87396845936246, 288.09874039880725, 700.2338529499883, 69.60756141641156, 341.12404363982506, 1279.3433390131283, 1162.850961019524, 268.83531546780904, 455.2272233012772, 710.3645681552534, 587.0439780075963, 940.422154344916, 305.8209262330085, 23.080060848671167, 79.62553768483747, 513.4199973413481, 762.0403448472559, 175.1131767818313, 140.56979238439, 702.8825110798202, 582.7262963724928, 54.74384459423165, 366.26108805600956, 440.03980510994796, 207.53902776352115, 1067.078948390561, 93.70751360005536, 511.24278723372663, 879.911217826728, 978.6207916256399, 753.6815778448533, 23.719773056294002, 59.139619626669976, 252.4763554500349, 814.2395593135178, 142.91702172113935, 795.7170690530737, 1002.9291915770644, 821.3179701351912, 473.54636221444827, 601.9908458753342, 875.961168611921, 800.2905287525845, 832.3374525191012, 503.9412219312226, 376.96987304390257, 289.0660757958711, 465.40142753823113, 102.107105496104, 1042.279459209539, 483.0381828451198, 8.527598405843047, 28.466607295845005, 681.0748048259932, 626.9838290406249, 800.4999664063366, 28.416448214761427, 469.4088687417678, 942.5611323399029, 279.85474829846186, 448.90537706256373, 501.606030122104, 360.43127543390375, 369.9729205278829, 63.60220682309174, 899.3253530796808, 491.91243597600464, 244.1043292306496, 859.126253726675, 98.38349815306096, 196.95393572905837, 579.146747378961, 500.0517723911589, 1182.861182357306, 686.7426431388174, 940.9672780994445, 118.13538852954181, 572.836708267494, 1013.3348219354186, 696.7993998761593, 131.99353823320882, 961.3315497756764, 995.0242289387108, 269.7455374839027, 292.38492067315127, 480.75329262164763, 718.1131295762385, 89.63063520511226, 677.5302181282258, 188.70567057553163, 368.248364731473, 658.2937908291415, 721.3726657862193, 374.02243969563415, 611.6734232777452, 687.0263649904832, 107.7203279709086, 3.8838834764831844, 236.7709351005041, 723.8494290119685, 395.29228935139497, 665.4536353576507, 644.6176639710194, 571.3086889370131, 761.5456470405879, 311.2183861615334, 239.1095596914646, 674.9137832876329, 304.57878674473454, 499.29663737392974, 807.457772004058, 528.0504727216943, 336.1480718733456, 660.4630976719641, 247.9852231262119, 516.8285016383813, 993.270726750552, 288.66707331545416, 598.8032966383568, 431.54740935752557, 744.992305012503, 867.5872042933889, 36.260383999856074, 283.51849935587677, 9.449944031440484, 989.6156243729413, 854.090897021199, 451.17245598198696, 607.6974825979386, 580.154735296619, 645.1147577974566, 619.4842567025838, 303.4342369131754, 315.41096309648486, 617.7606724689376, 311.2103536814661, 761.3037006879717, 382.032722139909, 688.2669073647935, 676.5697532850318, 666.0450477528337, 819.7186429329521, 791.0248451155933, 684.895608590762, 297.28497601055483, 838.3397999039015, 713.4712427883622, 607.2114044789994, 847.9155898512602, 900.7432286417958, 365.1964569108182, 558.5135670753579, 737.9843320575084, 547.2269509132241, 235.7854739277186, 516.2621552451892, 614.9931825049308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.739818705574219, "mean_inference_ms": 4.959130134441013, "mean_action_processing_ms": 1.9262516132872272, "mean_env_wait_ms": 13.129353353193089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008983373641967773, "StateBufferConnector_ms": 0.021451711654663086, "ViewRequirementAgentConnector_ms": 0.23926126956939697}, "num_episodes": 9, "episode_return_max": 973.087516876329, "episode_return_min": -82.38474751371349, "episode_return_mean": 186.58757536585597, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.47910838800578, "num_env_steps_trained_throughput_per_sec": 150.47910838800578, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 26647.584, "restore_workers_time_ms": 0.105, "training_step_time_ms": 26647.164, "sample_time_ms": 2657.204, "learn_time_ms": 23962.73, "learn_throughput": 166.926, "synch_weights_time_ms": 22.742}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-04-14", "timestamp": 1724384054, "time_this_iter_s": 26.61959195137024, "time_total_s": 1769.040489435196, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30955c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1769.040489435196, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 33.952631578947376, "ram_util_percent": 83.04736842105261}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.386679078157616, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.718418665790053, "policy_loss": -0.008219083087154166, "vf_loss": 7.725949883334851, "vf_explained_var": 0.09209930713845309, "kl": 0.0068786590863955475, "entropy": 0.35510274171829226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 62843.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.994684951015252, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.442831739799056, "policy_loss": -0.006105014812151985, "vf_loss": 7.448193975983473, "vf_explained_var": 0.3384824627921695, "kl": 0.007427688115202482, "entropy": 0.4575748706620837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 62843.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 1044.987362404717, "episode_reward_min": -82.38474751371349, "episode_reward_mean": 177.28459179632395, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1276.343339013131, "predator_policy": 3.8838834764831844}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1279.3433390131283}, "policy_reward_mean": {"prey_policy": -443.37126963954523, "predator_policy": 532.0135655377073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [679.8366795908736, 245.17292640247146, 336.2795771648581, 156.10967029158238, 2.935727517424282, 240.8925045676329, 81.31713428713677, 560.8729303895276, 4.299999999999995, 105.13410647361185, 363.384817099176, 395.6813929497129, 311.3999999999998, 254.10402828127954, 362.70359627289884, 347.7033488535268, 46.22736500775732, 193.33694916029447, -54.93757113254274, 409.1951017352319, 88.88880549398927, 73.00000000000013, 29.128715008510937, 202.65133683905242, 0.9499390342364986, 158.6405245012118, 598.7184913174224, 19.78246997563076, 334.6741094053528, 36.53871726049695, 278.1508295560799, 77.0999999999999, 49.78785715352951, 95.41644821476102, 239.65463052091624, 31.65060116600437, 304.7981902568056, 111.17434414769532, 25.831927209629743, 112.88137168887407, 65.80000000000055, 409.76752851098644, 485.3849431335292, 204.69565902133277, 277.7697259775813, 63.74044598138749, 2.000000000000001, -82.38474751371349, 406.01921120606926, 28.121035247954936, 63.46386887599005, 973.087516876329, 246.66200658727251, 59.15346747216276, 21.51128131009836, 160.30215697291808, 41.40950420841676, 182.3421957726399, 7.558686617562733, 86.49999999999976, 9.223599400724309, 95.57384986840967, 337.87959300349905, 0.238415773779586, 40.98600526742232, 632.4155553441824, 108.09999999999864, 7.170310496922488, 386.6595231978612, -68.21629719278397, 11.211041127172257, 33.72278321197674, 89.77635220899644, 396.23398171529107, 199.6141158997234, 70.39999999999988, 6.299999999999997, 577.4089364686808, 523.1827175371687, 12.199999999999989, 179.81462450195497, 347.06288867501434, 220.57929645913723, 58.59672033293218, 97.24581481690109, 278.12715351190764, -5.056550371459867, 1.7622713514635464, 4.3000000000000025, 40.39999999999999, 1044.987362404717, 15.26344344462458, 1.627646485306814, 52.60402222495194, 292.65435122521876, 25.15442655854123, -71.82773559231266, 42.28978825194701, 2.7999999999999954, 16.01909210135408], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-545.0776637466164, 245.167550851735, -290.19425464774093, -1242.0998851063366, 9.49323558998881, -668.9677976055032, -120.7605511734131, -470.45148213867935, -1123.64324549753, -602.2465794989506, -387.53864884625233, 115.1247294379759, -200.4853685216903, -706.5300905399665, 342.3183257510782, -192.1770004177867, -1276.343339013131, -1161.5509610195252, -563.1812551017457, -55.747177193725676, -408.87227955740525, -525.1514495062639, -959.3623491510975, 108.8006615228816, 37.2442620071501, 171.45013945934164, 30.321871312381067, -1051.678185219707, 158.41827699525183, -111.39764988858335, -712.9180330332832, -224.98742556550468, -160.54068598927026, -214.2368816532161, -425.1893507788772, -29.05253293429309, -985.8841881659836, -229.83984495717493, -841.2212373553757, -140.73766596984723, -978.7028740054129, -664.7106899710891, 13.880226943705985, -23.739619626669473, -733.1694255999665, -304.41777415507096, 18.286543105165716, -754.2692970403256, -1002.879252542828, -820.417970135191, -523.7399276356259, -393.15675595294243, -133.7958681539261, -943.7373378931568, -835.8119507988051, -480.68425367588554, -18.01732386614948, -313.34451556827634, -231.68874248134358, -299.2810732924962, -688.5384686450927, -558.6283438534842, 30.572401594157107, 9.533392704155114, -457.7400981012235, -800.5306786118621, -773.4999664063353, 40.0000000000003, -91.03643913661833, -1081.2789314241386, -115.28044407069865, -581.8290801243202, -340.6547717408522, -216.5843435583475, -118.79452128064256, -203.60626192263757, -726.6345324362758, -638.7713294097761, -131.32295754177625, -859.026253726675, -58.18349815306234, -171.35393572905983, -709.7031350799002, 40.272143820764384, -1235.765536933377, -148.45334542922427, -826.3231306317113, -28.08387697593823, -184.01596417014005, -1124.3858400551942, -678.9396862494293, -86.11280587855232, -960.5315497756765, -993.8242289387108, -104.15938310834296, -540.3558225624205, -766.7980630097709, -26.04914798204741, -69.89777092136069, -669.1420471640231, -456.0243612780996, -37.46580515291537, 400.0, -806.5789397390348, -646.6217836681227, -92.41207271798335, -670.8357025566613, -64.75752293257008, -131.95736056736703, -87.18617669952515, -161.88855060332176, -796.9510107871239, -790.3227658821089, -478.33902923814276, -562.2899073913933, -588.222232813567, -233.90913322633773, -308.86012600909487, -671.213783287632, -221.77878674473536, -491.6730379732041, -805.8577720040579, -233.0656646137177, -535.5590301129116, -119.35365687984012, -451.21507091483824, -568.4933867235013, -941.3674258916525, -265.4530304151007, -581.0313342712791, -789.9228491222359, 245.79869009638887, -867.4872042933888, 71.73961600014367, -260.3450777520491, -25.453055138341334, -992.5173478316578, -464.5296503646198, -544.9244053945134, -582.161830378195, -574.5337553733136, -639.5246965935901, -616.4022906913333, -272.7934197124462, -299.9707157578201, -543.4245675986006, 135.64702597462232, -811.9270986287705, -417.71781642562433, -452.9676971793527, -607.7697532850318, -664.4450477528336, -813.9186429329519, -790.5248451155933, -696.1548234137964, 291.3831752811599, -815.9919863782546, -212.63633877683623, -596.6114044789971, -846.3155898512598, -978.3361980050573, -107.7888630456043, -197.02423655816625, -752.4107738996864, -519.2214096476558, -43.21171873414738, -461.5654349122572, -611.0931825049298, -443.89852018258796, -682.4512168727066, 22.154782916186697, -1101.9108811331698, -50.37703133123626, -224.8330997171222, -583.198024854747, -601.8525803475441, -641.5550349972186, -546.218900186236, -328.9865319529184, -540.718902100662, 383.5313483765131, -833.4215295762851, -684.3689773278489, -148.26239116728703, -146.47505203052572, -542.8446228405444, -255.0004628529956, -572.0222618410816, -275.8920712940603, -868.3646299465872, -718.9574985882703, -59.41392199464616, -646.4312634720571, -623.7659490381452, -666.3482912119739, -599.2058133035625, -818.37984920824, -704.7042431180689, -623.4399229724424, -540.3187606359239], "policy_predator_policy_reward": [518.901900945398, 460.844891540354, 547.1565204818661, 1230.3105456746835, 655.6733168908744, 340.080822289499, 518.9074571491223, 228.41424645455578, 1125.04324549753, 603.782307016375, 403.4324555165508, 109.87396845936246, 288.09874039880725, 700.2338529499883, 69.60756141641156, 341.12404363982506, 1279.3433390131283, 1162.850961019524, 268.83531546780904, 455.2272233012772, 710.3645681552534, 587.0439780075963, 940.422154344916, 305.8209262330085, 23.080060848671167, 79.62553768483747, 513.4199973413481, 762.0403448472559, 175.1131767818313, 140.56979238439, 702.8825110798202, 582.7262963724928, 54.74384459423165, 366.26108805600956, 440.03980510994796, 207.53902776352115, 1067.078948390561, 93.70751360005536, 511.24278723372663, 879.911217826728, 978.6207916256399, 753.6815778448533, 23.719773056294002, 59.139619626669976, 252.4763554500349, 814.2395593135178, 142.91702172113935, 795.7170690530737, 1002.9291915770644, 821.3179701351912, 473.54636221444827, 601.9908458753342, 875.961168611921, 800.2905287525845, 832.3374525191012, 503.9412219312226, 376.96987304390257, 289.0660757958711, 465.40142753823113, 102.107105496104, 1042.279459209539, 483.0381828451198, 8.527598405843047, 28.466607295845005, 681.0748048259932, 626.9838290406249, 800.4999664063366, 28.416448214761427, 469.4088687417678, 942.5611323399029, 279.85474829846186, 448.90537706256373, 501.606030122104, 360.43127543390375, 369.9729205278829, 63.60220682309174, 899.3253530796808, 491.91243597600464, 244.1043292306496, 859.126253726675, 98.38349815306096, 196.95393572905837, 579.146747378961, 500.0517723911589, 1182.861182357306, 686.7426431388174, 940.9672780994445, 118.13538852954181, 572.836708267494, 1013.3348219354186, 696.7993998761593, 131.99353823320882, 961.3315497756764, 995.0242289387108, 269.7455374839027, 292.38492067315127, 480.75329262164763, 718.1131295762385, 89.63063520511226, 677.5302181282258, 188.70567057553163, 368.248364731473, 658.2937908291415, 721.3726657862193, 374.02243969563415, 611.6734232777452, 687.0263649904832, 107.7203279709086, 3.8838834764831844, 236.7709351005041, 723.8494290119685, 395.29228935139497, 665.4536353576507, 644.6176639710194, 571.3086889370131, 761.5456470405879, 311.2183861615334, 239.1095596914646, 674.9137832876329, 304.57878674473454, 499.29663737392974, 807.457772004058, 528.0504727216943, 336.1480718733456, 660.4630976719641, 247.9852231262119, 516.8285016383813, 993.270726750552, 288.66707331545416, 598.8032966383568, 431.54740935752557, 744.992305012503, 867.5872042933889, 36.260383999856074, 283.51849935587677, 9.449944031440484, 989.6156243729413, 854.090897021199, 451.17245598198696, 607.6974825979386, 580.154735296619, 645.1147577974566, 619.4842567025838, 303.4342369131754, 315.41096309648486, 617.7606724689376, 311.2103536814661, 761.3037006879717, 382.032722139909, 688.2669073647935, 676.5697532850318, 666.0450477528337, 819.7186429329521, 791.0248451155933, 684.895608590762, 297.28497601055483, 838.3397999039015, 713.4712427883622, 607.2114044789994, 847.9155898512602, 900.7432286417958, 365.1964569108182, 558.5135670753579, 737.9843320575084, 547.2269509132241, 235.7854739277186, 516.2621552451892, 614.9931825049308, 288.3954363502029, 935.200115521996, 637.6711207318419, 720.2121309970534, 12.809698281885776, 257.3438823950105, 583.6980248547469, 603.1148516990083, 643.4550349972186, 548.6189001862364, 359.3865319529196, 550.7189021006621, 758.2301335776729, 736.6474100268142, 145.5970198555513, 702.2977920842086, 132.75035869787362, 558.1969626585042, 455.7634506516105, 423.86329626742, 814.776082763958, 622.1349697019125, 719.1574985882703, 84.36834855318614, 513.2943597654073, 685.0751171524821, 738.0403998796149, 569.8034928878704, 818.37984920824, 707.5042431180696, 636.039922972443, 543.7378527372779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.7290278304605025, "mean_inference_ms": 4.955809460072053, "mean_action_processing_ms": 1.9211575234557463, "mean_env_wait_ms": 13.13679324432609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008939385414123535, "StateBufferConnector_ms": 0.02131068706512451, "ViewRequirementAgentConnector_ms": 0.24928808212280273}, "num_episodes": 16, "episode_return_max": 1044.987362404717, "episode_return_min": -82.38474751371349, "episode_return_mean": 177.28459179632395, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.3952689718403, "num_env_steps_trained_throughput_per_sec": 151.3952689718403, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 26694.694, "restore_workers_time_ms": 0.107, "training_step_time_ms": 26694.279, "sample_time_ms": 2668.198, "learn_time_ms": 23998.958, "learn_throughput": 166.674, "synch_weights_time_ms": 22.636}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-04-41", "timestamp": 1724384081, "time_this_iter_s": 26.46935200691223, "time_total_s": 1795.5098414421082, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3096285e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1795.5098414421082, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 34.564864864864866, "ram_util_percent": 82.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.024814896104196, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.990531309824141, "policy_loss": -0.007820286160758722, "vf_loss": 7.997778476230682, "vf_explained_var": 0.08858490766040862, "kl": 0.005731076697533132, "entropy": 0.3060970337144912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63788.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.951661482563726, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.741740024909771, "policy_loss": -0.009581826864273618, "vf_loss": 7.750450464783523, "vf_explained_var": 0.4790844312420598, "kl": 0.008714037815049763, "entropy": 0.4660188802335628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63788.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 1044.987362404717, "episode_reward_min": -82.38474751371349, "episode_reward_mean": 172.72163908235893, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1235.765536933377, "predator_policy": 3.8838834764831844}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1182.861182357306}, "policy_reward_mean": {"prey_policy": -441.34070984123605, "predator_policy": 527.7015293824157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [363.384817099176, 395.6813929497129, 311.3999999999998, 254.10402828127954, 362.70359627289884, 347.7033488535268, 46.22736500775732, 193.33694916029447, -54.93757113254274, 409.1951017352319, 88.88880549398927, 73.00000000000013, 29.128715008510937, 202.65133683905242, 0.9499390342364986, 158.6405245012118, 598.7184913174224, 19.78246997563076, 334.6741094053528, 36.53871726049695, 278.1508295560799, 77.0999999999999, 49.78785715352951, 95.41644821476102, 239.65463052091624, 31.65060116600437, 304.7981902568056, 111.17434414769532, 25.831927209629743, 112.88137168887407, 65.80000000000055, 409.76752851098644, 485.3849431335292, 204.69565902133277, 277.7697259775813, 63.74044598138749, 2.000000000000001, -82.38474751371349, 406.01921120606926, 28.121035247954936, 63.46386887599005, 973.087516876329, 246.66200658727251, 59.15346747216276, 21.51128131009836, 160.30215697291808, 41.40950420841676, 182.3421957726399, 7.558686617562733, 86.49999999999976, 9.223599400724309, 95.57384986840967, 337.87959300349905, 0.238415773779586, 40.98600526742232, 632.4155553441824, 108.09999999999864, 7.170310496922488, 386.6595231978612, -68.21629719278397, 11.211041127172257, 33.72278321197674, 89.77635220899644, 396.23398171529107, 199.6141158997234, 70.39999999999988, 6.299999999999997, 577.4089364686808, 523.1827175371687, 12.199999999999989, 179.81462450195497, 347.06288867501434, 220.57929645913723, 58.59672033293218, 97.24581481690109, 278.12715351190764, -5.056550371459867, 1.7622713514635464, 4.3000000000000025, 40.39999999999999, 1044.987362404717, 15.26344344462458, 1.627646485306814, 52.60402222495194, 292.65435122521876, 25.15442655854123, -71.82773559231266, 42.28978825194701, 2.7999999999999954, 16.01909210135408, 529.6370309509674, 27.462563412451356, 163.41695480584312, -44.00220856070891, 4.858310525899105, 63.50000000000082, 590.8877665300589, 362.0411228845995, 39.88581012035412, 218.8686346191448], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-408.87227955740525, -525.1514495062639, -959.3623491510975, 108.8006615228816, 37.2442620071501, 171.45013945934164, 30.321871312381067, -1051.678185219707, 158.41827699525183, -111.39764988858335, -712.9180330332832, -224.98742556550468, -160.54068598927026, -214.2368816532161, -425.1893507788772, -29.05253293429309, -985.8841881659836, -229.83984495717493, -841.2212373553757, -140.73766596984723, -978.7028740054129, -664.7106899710891, 13.880226943705985, -23.739619626669473, -733.1694255999665, -304.41777415507096, 18.286543105165716, -754.2692970403256, -1002.879252542828, -820.417970135191, -523.7399276356259, -393.15675595294243, -133.7958681539261, -943.7373378931568, -835.8119507988051, -480.68425367588554, -18.01732386614948, -313.34451556827634, -231.68874248134358, -299.2810732924962, -688.5384686450927, -558.6283438534842, 30.572401594157107, 9.533392704155114, -457.7400981012235, -800.5306786118621, -773.4999664063353, 40.0000000000003, -91.03643913661833, -1081.2789314241386, -115.28044407069865, -581.8290801243202, -340.6547717408522, -216.5843435583475, -118.79452128064256, -203.60626192263757, -726.6345324362758, -638.7713294097761, -131.32295754177625, -859.026253726675, -58.18349815306234, -171.35393572905983, -709.7031350799002, 40.272143820764384, -1235.765536933377, -148.45334542922427, -826.3231306317113, -28.08387697593823, -184.01596417014005, -1124.3858400551942, -678.9396862494293, -86.11280587855232, -960.5315497756765, -993.8242289387108, -104.15938310834296, -540.3558225624205, -766.7980630097709, -26.04914798204741, -69.89777092136069, -669.1420471640231, -456.0243612780996, -37.46580515291537, 400.0, -806.5789397390348, -646.6217836681227, -92.41207271798335, -670.8357025566613, -64.75752293257008, -131.95736056736703, -87.18617669952515, -161.88855060332176, -796.9510107871239, -790.3227658821089, -478.33902923814276, -562.2899073913933, -588.222232813567, -233.90913322633773, -308.86012600909487, -671.213783287632, -221.77878674473536, -491.6730379732041, -805.8577720040579, -233.0656646137177, -535.5590301129116, -119.35365687984012, -451.21507091483824, -568.4933867235013, -941.3674258916525, -265.4530304151007, -581.0313342712791, -789.9228491222359, 245.79869009638887, -867.4872042933888, 71.73961600014367, -260.3450777520491, -25.453055138341334, -992.5173478316578, -464.5296503646198, -544.9244053945134, -582.161830378195, -574.5337553733136, -639.5246965935901, -616.4022906913333, -272.7934197124462, -299.9707157578201, -543.4245675986006, 135.64702597462232, -811.9270986287705, -417.71781642562433, -452.9676971793527, -607.7697532850318, -664.4450477528336, -813.9186429329519, -790.5248451155933, -696.1548234137964, 291.3831752811599, -815.9919863782546, -212.63633877683623, -596.6114044789971, -846.3155898512598, -978.3361980050573, -107.7888630456043, -197.02423655816625, -752.4107738996864, -519.2214096476558, -43.21171873414738, -461.5654349122572, -611.0931825049298, -443.89852018258796, -682.4512168727066, 22.154782916186697, -1101.9108811331698, -50.37703133123626, -224.8330997171222, -583.198024854747, -601.8525803475441, -641.5550349972186, -546.218900186236, -328.9865319529184, -540.718902100662, 383.5313483765131, -833.4215295762851, -684.3689773278489, -148.26239116728703, -146.47505203052572, -542.8446228405444, -255.0004628529956, -572.0222618410816, -275.8920712940603, -868.3646299465872, -718.9574985882703, -59.41392199464616, -646.4312634720571, -623.7659490381452, -666.3482912119739, -599.2058133035625, -818.37984920824, -704.7042431180689, -623.4399229724424, -540.3187606359239, 46.81570903076661, -1027.4733512161072, -382.0222286945304, -841.3125517578919, -599.5694734232973, 0.035833348548322874, -296.31994909302574, -696.1549582114048, -754.0763745395043, -593.0999394390174, -237.96601986444358, -188.23445054424548, -816.7437584405185, 47.62523604897342, -287.5362379901396, -343.808219724945, -704.7111362727942, -290.6922881000062, -50.12636299602979, -473.408976896384], "policy_predator_policy_reward": [710.3645681552534, 587.0439780075963, 940.422154344916, 305.8209262330085, 23.080060848671167, 79.62553768483747, 513.4199973413481, 762.0403448472559, 175.1131767818313, 140.56979238439, 702.8825110798202, 582.7262963724928, 54.74384459423165, 366.26108805600956, 440.03980510994796, 207.53902776352115, 1067.078948390561, 93.70751360005536, 511.24278723372663, 879.911217826728, 978.6207916256399, 753.6815778448533, 23.719773056294002, 59.139619626669976, 252.4763554500349, 814.2395593135178, 142.91702172113935, 795.7170690530737, 1002.9291915770644, 821.3179701351912, 473.54636221444827, 601.9908458753342, 875.961168611921, 800.2905287525845, 832.3374525191012, 503.9412219312226, 376.96987304390257, 289.0660757958711, 465.40142753823113, 102.107105496104, 1042.279459209539, 483.0381828451198, 8.527598405843047, 28.466607295845005, 681.0748048259932, 626.9838290406249, 800.4999664063366, 28.416448214761427, 469.4088687417678, 942.5611323399029, 279.85474829846186, 448.90537706256373, 501.606030122104, 360.43127543390375, 369.9729205278829, 63.60220682309174, 899.3253530796808, 491.91243597600464, 244.1043292306496, 859.126253726675, 98.38349815306096, 196.95393572905837, 579.146747378961, 500.0517723911589, 1182.861182357306, 686.7426431388174, 940.9672780994445, 118.13538852954181, 572.836708267494, 1013.3348219354186, 696.7993998761593, 131.99353823320882, 961.3315497756764, 995.0242289387108, 269.7455374839027, 292.38492067315127, 480.75329262164763, 718.1131295762385, 89.63063520511226, 677.5302181282258, 188.70567057553163, 368.248364731473, 658.2937908291415, 721.3726657862193, 374.02243969563415, 611.6734232777452, 687.0263649904832, 107.7203279709086, 3.8838834764831844, 236.7709351005041, 723.8494290119685, 395.29228935139497, 665.4536353576507, 644.6176639710194, 571.3086889370131, 761.5456470405879, 311.2183861615334, 239.1095596914646, 674.9137832876329, 304.57878674473454, 499.29663737392974, 807.457772004058, 528.0504727216943, 336.1480718733456, 660.4630976719641, 247.9852231262119, 516.8285016383813, 993.270726750552, 288.66707331545416, 598.8032966383568, 431.54740935752557, 744.992305012503, 867.5872042933889, 36.260383999856074, 283.51849935587677, 9.449944031440484, 989.6156243729413, 854.090897021199, 451.17245598198696, 607.6974825979386, 580.154735296619, 645.1147577974566, 619.4842567025838, 303.4342369131754, 315.41096309648486, 617.7606724689376, 311.2103536814661, 761.3037006879717, 382.032722139909, 688.2669073647935, 676.5697532850318, 666.0450477528337, 819.7186429329521, 791.0248451155933, 684.895608590762, 297.28497601055483, 838.3397999039015, 713.4712427883622, 607.2114044789994, 847.9155898512602, 900.7432286417958, 365.1964569108182, 558.5135670753579, 737.9843320575084, 547.2269509132241, 235.7854739277186, 516.2621552451892, 614.9931825049308, 288.3954363502029, 935.200115521996, 637.6711207318419, 720.2121309970534, 12.809698281885776, 257.3438823950105, 583.6980248547469, 603.1148516990083, 643.4550349972186, 548.6189001862364, 359.3865319529196, 550.7189021006621, 758.2301335776729, 736.6474100268142, 145.5970198555513, 702.2977920842086, 132.75035869787362, 558.1969626585042, 455.7634506516105, 423.86329626742, 814.776082763958, 622.1349697019125, 719.1574985882703, 84.36834855318614, 513.2943597654073, 685.0751171524821, 738.0403998796149, 569.8034928878704, 818.37984920824, 707.5042431180696, 636.039922972443, 543.7378527372779, 894.3464557444063, 615.9482173919016, 408.7847921069861, 842.0125517578921, 481.7558737250066, 281.19472115558744, 203.18554494687697, 745.287153796847, 754.9262717175646, 597.1083527868573, 14.766586323323832, 474.93388408536373, 528.1757763965664, 831.8305125250386, 382.16393840156417, 611.221642198119, 726.7980891108311, 308.49114538232607, 280.87180741358117, 461.5321670979844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.727765037072322, "mean_inference_ms": 4.9562946997544906, "mean_action_processing_ms": 1.9037656961251042, "mean_env_wait_ms": 13.146882549827895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008957386016845703, "StateBufferConnector_ms": 0.012501239776611328, "ViewRequirementAgentConnector_ms": 0.2651057243347168}, "num_episodes": 10, "episode_return_max": 1044.987362404717, "episode_return_min": -82.38474751371349, "episode_return_mean": 172.72163908235893, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.17905820593768, "num_env_steps_trained_throughput_per_sec": 155.17905820593768, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 26697.51, "restore_workers_time_ms": 0.102, "training_step_time_ms": 26697.14, "sample_time_ms": 2663.867, "learn_time_ms": 24006.481, "learn_throughput": 166.622, "synch_weights_time_ms": 22.573}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-05-07", "timestamp": 1724384107, "time_this_iter_s": 25.8158278465271, "time_total_s": 1821.3256692886353, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30960d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1821.3256692886353, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 31.664864864864864, "ram_util_percent": 82.52162162162162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.47688123258964, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.84102442453778, "policy_loss": -0.007759109128108889, "vf_loss": 7.848222045797519, "vf_explained_var": 0.11274144870263558, "kl": 0.005614750032318096, "entropy": 0.2836284305368151, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 64733.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.210937258301588, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.765769067895476, "policy_loss": -0.009953962555450816, "vf_loss": 7.774937419790439, "vf_explained_var": 0.45084726375246803, "kl": 0.007856255762584547, "entropy": 0.4360737545780404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 64733.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 1044.987362404717, "episode_reward_min": -234.31825323153677, "episode_reward_mean": 154.55070199951007, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1235.765536933377, "predator_policy": 1.849245807684865}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1182.861182357306}, "policy_reward_mean": {"prey_policy": -464.56907146049457, "predator_policy": 541.84442246025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.128715008510937, 202.65133683905242, 0.9499390342364986, 158.6405245012118, 598.7184913174224, 19.78246997563076, 334.6741094053528, 36.53871726049695, 278.1508295560799, 77.0999999999999, 49.78785715352951, 95.41644821476102, 239.65463052091624, 31.65060116600437, 304.7981902568056, 111.17434414769532, 25.831927209629743, 112.88137168887407, 65.80000000000055, 409.76752851098644, 485.3849431335292, 204.69565902133277, 277.7697259775813, 63.74044598138749, 2.000000000000001, -82.38474751371349, 406.01921120606926, 28.121035247954936, 63.46386887599005, 973.087516876329, 246.66200658727251, 59.15346747216276, 21.51128131009836, 160.30215697291808, 41.40950420841676, 182.3421957726399, 7.558686617562733, 86.49999999999976, 9.223599400724309, 95.57384986840967, 337.87959300349905, 0.238415773779586, 40.98600526742232, 632.4155553441824, 108.09999999999864, 7.170310496922488, 386.6595231978612, -68.21629719278397, 11.211041127172257, 33.72278321197674, 89.77635220899644, 396.23398171529107, 199.6141158997234, 70.39999999999988, 6.299999999999997, 577.4089364686808, 523.1827175371687, 12.199999999999989, 179.81462450195497, 347.06288867501434, 220.57929645913723, 58.59672033293218, 97.24581481690109, 278.12715351190764, -5.056550371459867, 1.7622713514635464, 4.3000000000000025, 40.39999999999999, 1044.987362404717, 15.26344344462458, 1.627646485306814, 52.60402222495194, 292.65435122521876, 25.15442655854123, -71.82773559231266, 42.28978825194701, 2.7999999999999954, 16.01909210135408, 529.6370309509674, 27.462563412451356, 163.41695480584312, -44.00220856070891, 4.858310525899105, 63.50000000000082, 590.8877665300589, 362.0411228845995, 39.88581012035412, 218.8686346191448, 379.9973908025261, 37.64506594677756, 50.643437725338536, 142.3559290510691, -60.1848978679322, 342.1264651045967, 71.96692784510226, 227.91746369643312, 4.799999999999999, -234.31825323153677, 64.74387549782983, -54.099279133763815], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-733.1694255999665, -304.41777415507096, 18.286543105165716, -754.2692970403256, -1002.879252542828, -820.417970135191, -523.7399276356259, -393.15675595294243, -133.7958681539261, -943.7373378931568, -835.8119507988051, -480.68425367588554, -18.01732386614948, -313.34451556827634, -231.68874248134358, -299.2810732924962, -688.5384686450927, -558.6283438534842, 30.572401594157107, 9.533392704155114, -457.7400981012235, -800.5306786118621, -773.4999664063353, 40.0000000000003, -91.03643913661833, -1081.2789314241386, -115.28044407069865, -581.8290801243202, -340.6547717408522, -216.5843435583475, -118.79452128064256, -203.60626192263757, -726.6345324362758, -638.7713294097761, -131.32295754177625, -859.026253726675, -58.18349815306234, -171.35393572905983, -709.7031350799002, 40.272143820764384, -1235.765536933377, -148.45334542922427, -826.3231306317113, -28.08387697593823, -184.01596417014005, -1124.3858400551942, -678.9396862494293, -86.11280587855232, -960.5315497756765, -993.8242289387108, -104.15938310834296, -540.3558225624205, -766.7980630097709, -26.04914798204741, -69.89777092136069, -669.1420471640231, -456.0243612780996, -37.46580515291537, 400.0, -806.5789397390348, -646.6217836681227, -92.41207271798335, -670.8357025566613, -64.75752293257008, -131.95736056736703, -87.18617669952515, -161.88855060332176, -796.9510107871239, -790.3227658821089, -478.33902923814276, -562.2899073913933, -588.222232813567, -233.90913322633773, -308.86012600909487, -671.213783287632, -221.77878674473536, -491.6730379732041, -805.8577720040579, -233.0656646137177, -535.5590301129116, -119.35365687984012, -451.21507091483824, -568.4933867235013, -941.3674258916525, -265.4530304151007, -581.0313342712791, -789.9228491222359, 245.79869009638887, -867.4872042933888, 71.73961600014367, -260.3450777520491, -25.453055138341334, -992.5173478316578, -464.5296503646198, -544.9244053945134, -582.161830378195, -574.5337553733136, -639.5246965935901, -616.4022906913333, -272.7934197124462, -299.9707157578201, -543.4245675986006, 135.64702597462232, -811.9270986287705, -417.71781642562433, -452.9676971793527, -607.7697532850318, -664.4450477528336, -813.9186429329519, -790.5248451155933, -696.1548234137964, 291.3831752811599, -815.9919863782546, -212.63633877683623, -596.6114044789971, -846.3155898512598, -978.3361980050573, -107.7888630456043, -197.02423655816625, -752.4107738996864, -519.2214096476558, -43.21171873414738, -461.5654349122572, -611.0931825049298, -443.89852018258796, -682.4512168727066, 22.154782916186697, -1101.9108811331698, -50.37703133123626, -224.8330997171222, -583.198024854747, -601.8525803475441, -641.5550349972186, -546.218900186236, -328.9865319529184, -540.718902100662, 383.5313483765131, -833.4215295762851, -684.3689773278489, -148.26239116728703, -146.47505203052572, -542.8446228405444, -255.0004628529956, -572.0222618410816, -275.8920712940603, -868.3646299465872, -718.9574985882703, -59.41392199464616, -646.4312634720571, -623.7659490381452, -666.3482912119739, -599.2058133035625, -818.37984920824, -704.7042431180689, -623.4399229724424, -540.3187606359239, 46.81570903076661, -1027.4733512161072, -382.0222286945304, -841.3125517578919, -599.5694734232973, 0.035833348548322874, -296.31994909302574, -696.1549582114048, -754.0763745395043, -593.0999394390174, -237.96601986444358, -188.23445054424548, -816.7437584405185, 47.62523604897342, -287.5362379901396, -343.808219724945, -704.7111362727942, -290.6922881000062, -50.12636299602979, -473.408976896384, -1056.1205055762987, 40.0000000000003, -546.3071014329076, 12.599498393946677, -190.76503327476675, -620.3778058663452, -605.4560937983736, -889.8865594716542, -138.05694057998193, -661.1601135842986, 13.989025705790727, -863.4061199407761, -474.0844391699137, -774.4562609745843, 40.0000000000003, -986.5201939726503, -795.0273401914502, -916.7517920720518, -556.3965730899077, -337.9100491982282, -624.5762903354657, -827.6259631598632, -671.9148088041159, -383.56836854615494], "policy_predator_policy_reward": [252.4763554500349, 814.2395593135178, 142.91702172113935, 795.7170690530737, 1002.9291915770644, 821.3179701351912, 473.54636221444827, 601.9908458753342, 875.961168611921, 800.2905287525845, 832.3374525191012, 503.9412219312226, 376.96987304390257, 289.0660757958711, 465.40142753823113, 102.107105496104, 1042.279459209539, 483.0381828451198, 8.527598405843047, 28.466607295845005, 681.0748048259932, 626.9838290406249, 800.4999664063366, 28.416448214761427, 469.4088687417678, 942.5611323399029, 279.85474829846186, 448.90537706256373, 501.606030122104, 360.43127543390375, 369.9729205278829, 63.60220682309174, 899.3253530796808, 491.91243597600464, 244.1043292306496, 859.126253726675, 98.38349815306096, 196.95393572905837, 579.146747378961, 500.0517723911589, 1182.861182357306, 686.7426431388174, 940.9672780994445, 118.13538852954181, 572.836708267494, 1013.3348219354186, 696.7993998761593, 131.99353823320882, 961.3315497756764, 995.0242289387108, 269.7455374839027, 292.38492067315127, 480.75329262164763, 718.1131295762385, 89.63063520511226, 677.5302181282258, 188.70567057553163, 368.248364731473, 658.2937908291415, 721.3726657862193, 374.02243969563415, 611.6734232777452, 687.0263649904832, 107.7203279709086, 3.8838834764831844, 236.7709351005041, 723.8494290119685, 395.29228935139497, 665.4536353576507, 644.6176639710194, 571.3086889370131, 761.5456470405879, 311.2183861615334, 239.1095596914646, 674.9137832876329, 304.57878674473454, 499.29663737392974, 807.457772004058, 528.0504727216943, 336.1480718733456, 660.4630976719641, 247.9852231262119, 516.8285016383813, 993.270726750552, 288.66707331545416, 598.8032966383568, 431.54740935752557, 744.992305012503, 867.5872042933889, 36.260383999856074, 283.51849935587677, 9.449944031440484, 989.6156243729413, 854.090897021199, 451.17245598198696, 607.6974825979386, 580.154735296619, 645.1147577974566, 619.4842567025838, 303.4342369131754, 315.41096309648486, 617.7606724689376, 311.2103536814661, 761.3037006879717, 382.032722139909, 688.2669073647935, 676.5697532850318, 666.0450477528337, 819.7186429329521, 791.0248451155933, 684.895608590762, 297.28497601055483, 838.3397999039015, 713.4712427883622, 607.2114044789994, 847.9155898512602, 900.7432286417958, 365.1964569108182, 558.5135670753579, 737.9843320575084, 547.2269509132241, 235.7854739277186, 516.2621552451892, 614.9931825049308, 288.3954363502029, 935.200115521996, 637.6711207318419, 720.2121309970534, 12.809698281885776, 257.3438823950105, 583.6980248547469, 603.1148516990083, 643.4550349972186, 548.6189001862364, 359.3865319529196, 550.7189021006621, 758.2301335776729, 736.6474100268142, 145.5970198555513, 702.2977920842086, 132.75035869787362, 558.1969626585042, 455.7634506516105, 423.86329626742, 814.776082763958, 622.1349697019125, 719.1574985882703, 84.36834855318614, 513.2943597654073, 685.0751171524821, 738.0403998796149, 569.8034928878704, 818.37984920824, 707.5042431180696, 636.039922972443, 543.7378527372779, 894.3464557444063, 615.9482173919016, 408.7847921069861, 842.0125517578921, 481.7558737250066, 281.19472115558744, 203.18554494687697, 745.287153796847, 754.9262717175646, 597.1083527868573, 14.766586323323832, 474.93388408536373, 528.1757763965664, 831.8305125250386, 382.16393840156417, 611.221642198119, 726.7980891108311, 308.49114538232607, 280.87180741358117, 461.5321670979844, 1008.4799190925952, 387.63797728623024, 569.5034231780555, 1.849245807684865, 242.85728213438392, 618.9289947320672, 841.8113747897464, 795.8872075313492, 77.5334216986364, 661.4987345977114, 825.8931284876729, 365.6504308519072, 546.6207683258515, 773.8868596637511, 856.4796054193451, 317.95805224973554, 799.1273401914511, 917.451792072052, 632.4276803679073, 27.56068868869738, 689.6695944490442, 827.2765345441187, 693.9556491501706, 307.42824906633535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.7285069613881925, "mean_inference_ms": 4.9541850915830175, "mean_action_processing_ms": 1.8911485013828926, "mean_env_wait_ms": 13.148076932814748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058182477951049805, "StateBufferConnector_ms": 0.012643098831176758, "ViewRequirementAgentConnector_ms": 0.28491759300231934}, "num_episodes": 12, "episode_return_max": 1044.987362404717, "episode_return_min": -234.31825323153677, "episode_return_mean": 154.55070199951007, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.10142515268794, "num_env_steps_trained_throughput_per_sec": 155.10142515268794, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 26529.79, "restore_workers_time_ms": 0.102, "training_step_time_ms": 26529.452, "sample_time_ms": 2653.743, "learn_time_ms": 23850.78, "learn_throughput": 167.709, "synch_weights_time_ms": 21.514}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-05-33", "timestamp": 1724384133, "time_this_iter_s": 25.83225393295288, "time_total_s": 1847.1579232215881, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30960d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1847.1579232215881, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 31.638888888888882, "ram_util_percent": 81.75555555555553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.40011726308752, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.8313831970174475, "policy_loss": -0.007891063817417023, "vf_loss": 7.838611060349399, "vf_explained_var": 0.17480221740783208, "kl": 0.006631922222324031, "entropy": 0.3178457726719518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65678.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.862878158609703, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.734226610799315, "policy_loss": -0.009834529878078866, "vf_loss": 7.74327878144683, "vf_explained_var": 0.4927326157610252, "kl": 0.00782357702455508, "entropy": 0.453131941292021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65678.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 1044.987362404717, "episode_reward_min": -234.31825323153677, "episode_reward_mean": 158.39236948767467, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1235.765536933377, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1182.861182357306}, "policy_reward_mean": {"prey_policy": -460.99985275336564, "predator_policy": 540.1960374972033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [278.1508295560799, 77.0999999999999, 49.78785715352951, 95.41644821476102, 239.65463052091624, 31.65060116600437, 304.7981902568056, 111.17434414769532, 25.831927209629743, 112.88137168887407, 65.80000000000055, 409.76752851098644, 485.3849431335292, 204.69565902133277, 277.7697259775813, 63.74044598138749, 2.000000000000001, -82.38474751371349, 406.01921120606926, 28.121035247954936, 63.46386887599005, 973.087516876329, 246.66200658727251, 59.15346747216276, 21.51128131009836, 160.30215697291808, 41.40950420841676, 182.3421957726399, 7.558686617562733, 86.49999999999976, 9.223599400724309, 95.57384986840967, 337.87959300349905, 0.238415773779586, 40.98600526742232, 632.4155553441824, 108.09999999999864, 7.170310496922488, 386.6595231978612, -68.21629719278397, 11.211041127172257, 33.72278321197674, 89.77635220899644, 396.23398171529107, 199.6141158997234, 70.39999999999988, 6.299999999999997, 577.4089364686808, 523.1827175371687, 12.199999999999989, 179.81462450195497, 347.06288867501434, 220.57929645913723, 58.59672033293218, 97.24581481690109, 278.12715351190764, -5.056550371459867, 1.7622713514635464, 4.3000000000000025, 40.39999999999999, 1044.987362404717, 15.26344344462458, 1.627646485306814, 52.60402222495194, 292.65435122521876, 25.15442655854123, -71.82773559231266, 42.28978825194701, 2.7999999999999954, 16.01909210135408, 529.6370309509674, 27.462563412451356, 163.41695480584312, -44.00220856070891, 4.858310525899105, 63.50000000000082, 590.8877665300589, 362.0411228845995, 39.88581012035412, 218.8686346191448, 379.9973908025261, 37.64506594677756, 50.643437725338536, 142.3559290510691, -60.1848978679322, 342.1264651045967, 71.96692784510226, 227.91746369643312, 4.799999999999999, -234.31825323153677, 64.74387549782983, -54.099279133763815, 11.435240450726285, 356.4155891918862, 445.99878025911175, 7.5434616687053175, 218.3999999999987, 575.9368049890898, -3.826732583324606, 153.34790818218494], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-688.5384686450927, -558.6283438534842, 30.572401594157107, 9.533392704155114, -457.7400981012235, -800.5306786118621, -773.4999664063353, 40.0000000000003, -91.03643913661833, -1081.2789314241386, -115.28044407069865, -581.8290801243202, -340.6547717408522, -216.5843435583475, -118.79452128064256, -203.60626192263757, -726.6345324362758, -638.7713294097761, -131.32295754177625, -859.026253726675, -58.18349815306234, -171.35393572905983, -709.7031350799002, 40.272143820764384, -1235.765536933377, -148.45334542922427, -826.3231306317113, -28.08387697593823, -184.01596417014005, -1124.3858400551942, -678.9396862494293, -86.11280587855232, -960.5315497756765, -993.8242289387108, -104.15938310834296, -540.3558225624205, -766.7980630097709, -26.04914798204741, -69.89777092136069, -669.1420471640231, -456.0243612780996, -37.46580515291537, 400.0, -806.5789397390348, -646.6217836681227, -92.41207271798335, -670.8357025566613, -64.75752293257008, -131.95736056736703, -87.18617669952515, -161.88855060332176, -796.9510107871239, -790.3227658821089, -478.33902923814276, -562.2899073913933, -588.222232813567, -233.90913322633773, -308.86012600909487, -671.213783287632, -221.77878674473536, -491.6730379732041, -805.8577720040579, -233.0656646137177, -535.5590301129116, -119.35365687984012, -451.21507091483824, -568.4933867235013, -941.3674258916525, -265.4530304151007, -581.0313342712791, -789.9228491222359, 245.79869009638887, -867.4872042933888, 71.73961600014367, -260.3450777520491, -25.453055138341334, -992.5173478316578, -464.5296503646198, -544.9244053945134, -582.161830378195, -574.5337553733136, -639.5246965935901, -616.4022906913333, -272.7934197124462, -299.9707157578201, -543.4245675986006, 135.64702597462232, -811.9270986287705, -417.71781642562433, -452.9676971793527, -607.7697532850318, -664.4450477528336, -813.9186429329519, -790.5248451155933, -696.1548234137964, 291.3831752811599, -815.9919863782546, -212.63633877683623, -596.6114044789971, -846.3155898512598, -978.3361980050573, -107.7888630456043, -197.02423655816625, -752.4107738996864, -519.2214096476558, -43.21171873414738, -461.5654349122572, -611.0931825049298, -443.89852018258796, -682.4512168727066, 22.154782916186697, -1101.9108811331698, -50.37703133123626, -224.8330997171222, -583.198024854747, -601.8525803475441, -641.5550349972186, -546.218900186236, -328.9865319529184, -540.718902100662, 383.5313483765131, -833.4215295762851, -684.3689773278489, -148.26239116728703, -146.47505203052572, -542.8446228405444, -255.0004628529956, -572.0222618410816, -275.8920712940603, -868.3646299465872, -718.9574985882703, -59.41392199464616, -646.4312634720571, -623.7659490381452, -666.3482912119739, -599.2058133035625, -818.37984920824, -704.7042431180689, -623.4399229724424, -540.3187606359239, 46.81570903076661, -1027.4733512161072, -382.0222286945304, -841.3125517578919, -599.5694734232973, 0.035833348548322874, -296.31994909302574, -696.1549582114048, -754.0763745395043, -593.0999394390174, -237.96601986444358, -188.23445054424548, -816.7437584405185, 47.62523604897342, -287.5362379901396, -343.808219724945, -704.7111362727942, -290.6922881000062, -50.12636299602979, -473.408976896384, -1056.1205055762987, 40.0000000000003, -546.3071014329076, 12.599498393946677, -190.76503327476675, -620.3778058663452, -605.4560937983736, -889.8865594716542, -138.05694057998193, -661.1601135842986, 13.989025705790727, -863.4061199407761, -474.0844391699137, -774.4562609745843, 40.0000000000003, -986.5201939726503, -795.0273401914502, -916.7517920720518, -556.3965730899077, -337.9100491982282, -624.5762903354657, -827.6259631598632, -671.9148088041159, -383.56836854615494, -465.7421587649119, -831.5928201438561, -569.4208704480378, -206.16488188822174, -4.765449937786907, -902.4993551718562, -507.99735710940934, -570.748706823194, 176.73587976842796, 40.0000000000003, 40.0000000000003, -826.3982409913077, -669.636718173612, -995.0410475585202, -20.938351462083993, -742.0711055566542], "policy_predator_policy_reward": [1042.279459209539, 483.0381828451198, 8.527598405843047, 28.466607295845005, 681.0748048259932, 626.9838290406249, 800.4999664063366, 28.416448214761427, 469.4088687417678, 942.5611323399029, 279.85474829846186, 448.90537706256373, 501.606030122104, 360.43127543390375, 369.9729205278829, 63.60220682309174, 899.3253530796808, 491.91243597600464, 244.1043292306496, 859.126253726675, 98.38349815306096, 196.95393572905837, 579.146747378961, 500.0517723911589, 1182.861182357306, 686.7426431388174, 940.9672780994445, 118.13538852954181, 572.836708267494, 1013.3348219354186, 696.7993998761593, 131.99353823320882, 961.3315497756764, 995.0242289387108, 269.7455374839027, 292.38492067315127, 480.75329262164763, 718.1131295762385, 89.63063520511226, 677.5302181282258, 188.70567057553163, 368.248364731473, 658.2937908291415, 721.3726657862193, 374.02243969563415, 611.6734232777452, 687.0263649904832, 107.7203279709086, 3.8838834764831844, 236.7709351005041, 723.8494290119685, 395.29228935139497, 665.4536353576507, 644.6176639710194, 571.3086889370131, 761.5456470405879, 311.2183861615334, 239.1095596914646, 674.9137832876329, 304.57878674473454, 499.29663737392974, 807.457772004058, 528.0504727216943, 336.1480718733456, 660.4630976719641, 247.9852231262119, 516.8285016383813, 993.270726750552, 288.66707331545416, 598.8032966383568, 431.54740935752557, 744.992305012503, 867.5872042933889, 36.260383999856074, 283.51849935587677, 9.449944031440484, 989.6156243729413, 854.090897021199, 451.17245598198696, 607.6974825979386, 580.154735296619, 645.1147577974566, 619.4842567025838, 303.4342369131754, 315.41096309648486, 617.7606724689376, 311.2103536814661, 761.3037006879717, 382.032722139909, 688.2669073647935, 676.5697532850318, 666.0450477528337, 819.7186429329521, 791.0248451155933, 684.895608590762, 297.28497601055483, 838.3397999039015, 713.4712427883622, 607.2114044789994, 847.9155898512602, 900.7432286417958, 365.1964569108182, 558.5135670753579, 737.9843320575084, 547.2269509132241, 235.7854739277186, 516.2621552451892, 614.9931825049308, 288.3954363502029, 935.200115521996, 637.6711207318419, 720.2121309970534, 12.809698281885776, 257.3438823950105, 583.6980248547469, 603.1148516990083, 643.4550349972186, 548.6189001862364, 359.3865319529196, 550.7189021006621, 758.2301335776729, 736.6474100268142, 145.5970198555513, 702.2977920842086, 132.75035869787362, 558.1969626585042, 455.7634506516105, 423.86329626742, 814.776082763958, 622.1349697019125, 719.1574985882703, 84.36834855318614, 513.2943597654073, 685.0751171524821, 738.0403998796149, 569.8034928878704, 818.37984920824, 707.5042431180696, 636.039922972443, 543.7378527372779, 894.3464557444063, 615.9482173919016, 408.7847921069861, 842.0125517578921, 481.7558737250066, 281.19472115558744, 203.18554494687697, 745.287153796847, 754.9262717175646, 597.1083527868573, 14.766586323323832, 474.93388408536373, 528.1757763965664, 831.8305125250386, 382.16393840156417, 611.221642198119, 726.7980891108311, 308.49114538232607, 280.87180741358117, 461.5321670979844, 1008.4799190925952, 387.63797728623024, 569.5034231780555, 1.849245807684865, 242.85728213438392, 618.9289947320672, 841.8113747897464, 795.8872075313492, 77.5334216986364, 661.4987345977114, 825.8931284876729, 365.6504308519072, 546.6207683258515, 773.8868596637511, 856.4796054193451, 317.95805224973554, 799.1273401914511, 917.451792072052, 632.4276803679073, 27.56068868869738, 689.6695944490442, 827.2765345441187, 693.9556491501706, 307.42824906633535, 477.3628417553097, 831.4073776041866, 581.3204626496567, 550.6808788784848, 594.8409415167511, 758.4226438520031, 509.2933285601969, 576.996197041117, 1.664120231571943, 0.0, 628.6180203166779, 733.7170256637165, 665.8099855902872, 995.0410475585202, 205.19904184619088, 711.158323354732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.7168606625698235, "mean_inference_ms": 4.9552685345013705, "mean_action_processing_ms": 1.8900578805395332, "mean_env_wait_ms": 13.165803389159004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005885004997253418, "StateBufferConnector_ms": 0.01262521743774414, "ViewRequirementAgentConnector_ms": 0.25825953483581543}, "num_episodes": 8, "episode_return_max": 1044.987362404717, "episode_return_min": -234.31825323153677, "episode_return_mean": 158.39236948767467, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.6182309135857, "num_env_steps_trained_throughput_per_sec": 153.6182309135857, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 26415.28, "restore_workers_time_ms": 0.072, "training_step_time_ms": 26415.031, "sample_time_ms": 2541.225, "learn_time_ms": 23849.207, "learn_throughput": 167.72, "synch_weights_time_ms": 21.113}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-05-59", "timestamp": 1724384159, "time_this_iter_s": 26.111056804656982, "time_total_s": 1873.2689800262451, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095ce4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1873.2689800262451, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 33.42162162162162, "ram_util_percent": 82.0702702702703}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.766491008940196, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.889201278787441, "policy_loss": -0.008145727438940889, "vf_loss": 7.896478753367429, "vf_explained_var": -0.08512097590814822, "kl": 0.00868279197211402, "entropy": 0.2975852971512174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 66623.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.05476585317541, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.8450456326600735, "policy_loss": -0.008912170451459667, "vf_loss": 7.8531160647276215, "vf_explained_var": 0.304727055723705, "kl": 0.008417581872048753, "entropy": 0.42739389718524995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 66623.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 1044.987362404717, "episode_reward_min": -234.31825323153677, "episode_reward_mean": 163.92552016396795, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1235.765536933377, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1182.861182357306}, "policy_reward_mean": {"prey_policy": -473.10500531369735, "predator_policy": 555.0677653956816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.80000000000055, 409.76752851098644, 485.3849431335292, 204.69565902133277, 277.7697259775813, 63.74044598138749, 2.000000000000001, -82.38474751371349, 406.01921120606926, 28.121035247954936, 63.46386887599005, 973.087516876329, 246.66200658727251, 59.15346747216276, 21.51128131009836, 160.30215697291808, 41.40950420841676, 182.3421957726399, 7.558686617562733, 86.49999999999976, 9.223599400724309, 95.57384986840967, 337.87959300349905, 0.238415773779586, 40.98600526742232, 632.4155553441824, 108.09999999999864, 7.170310496922488, 386.6595231978612, -68.21629719278397, 11.211041127172257, 33.72278321197674, 89.77635220899644, 396.23398171529107, 199.6141158997234, 70.39999999999988, 6.299999999999997, 577.4089364686808, 523.1827175371687, 12.199999999999989, 179.81462450195497, 347.06288867501434, 220.57929645913723, 58.59672033293218, 97.24581481690109, 278.12715351190764, -5.056550371459867, 1.7622713514635464, 4.3000000000000025, 40.39999999999999, 1044.987362404717, 15.26344344462458, 1.627646485306814, 52.60402222495194, 292.65435122521876, 25.15442655854123, -71.82773559231266, 42.28978825194701, 2.7999999999999954, 16.01909210135408, 529.6370309509674, 27.462563412451356, 163.41695480584312, -44.00220856070891, 4.858310525899105, 63.50000000000082, 590.8877665300589, 362.0411228845995, 39.88581012035412, 218.8686346191448, 379.9973908025261, 37.64506594677756, 50.643437725338536, 142.3559290510691, -60.1848978679322, 342.1264651045967, 71.96692784510226, 227.91746369643312, 4.799999999999999, -234.31825323153677, 64.74387549782983, -54.099279133763815, 11.435240450726285, 356.4155891918862, 445.99878025911175, 7.5434616687053175, 218.3999999999987, 575.9368049890898, -3.826732583324606, 153.34790818218494, 110.22654553952192, -0.13421925939964718, 368.62061488221, 4.222162401073627, 611.335620039599, 108.98097092000445, 5.599999999999996, 11.68892364893456, -79.34407579668138, 738.5647251683627], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-58.18349815306234, -171.35393572905983, -709.7031350799002, 40.272143820764384, -1235.765536933377, -148.45334542922427, -826.3231306317113, -28.08387697593823, -184.01596417014005, -1124.3858400551942, -678.9396862494293, -86.11280587855232, -960.5315497756765, -993.8242289387108, -104.15938310834296, -540.3558225624205, -766.7980630097709, -26.04914798204741, -69.89777092136069, -669.1420471640231, -456.0243612780996, -37.46580515291537, 400.0, -806.5789397390348, -646.6217836681227, -92.41207271798335, -670.8357025566613, -64.75752293257008, -131.95736056736703, -87.18617669952515, -161.88855060332176, -796.9510107871239, -790.3227658821089, -478.33902923814276, -562.2899073913933, -588.222232813567, -233.90913322633773, -308.86012600909487, -671.213783287632, -221.77878674473536, -491.6730379732041, -805.8577720040579, -233.0656646137177, -535.5590301129116, -119.35365687984012, -451.21507091483824, -568.4933867235013, -941.3674258916525, -265.4530304151007, -581.0313342712791, -789.9228491222359, 245.79869009638887, -867.4872042933888, 71.73961600014367, -260.3450777520491, -25.453055138341334, -992.5173478316578, -464.5296503646198, -544.9244053945134, -582.161830378195, -574.5337553733136, -639.5246965935901, -616.4022906913333, -272.7934197124462, -299.9707157578201, -543.4245675986006, 135.64702597462232, -811.9270986287705, -417.71781642562433, -452.9676971793527, -607.7697532850318, -664.4450477528336, -813.9186429329519, -790.5248451155933, -696.1548234137964, 291.3831752811599, -815.9919863782546, -212.63633877683623, -596.6114044789971, -846.3155898512598, -978.3361980050573, -107.7888630456043, -197.02423655816625, -752.4107738996864, -519.2214096476558, -43.21171873414738, -461.5654349122572, -611.0931825049298, -443.89852018258796, -682.4512168727066, 22.154782916186697, -1101.9108811331698, -50.37703133123626, -224.8330997171222, -583.198024854747, -601.8525803475441, -641.5550349972186, -546.218900186236, -328.9865319529184, -540.718902100662, 383.5313483765131, -833.4215295762851, -684.3689773278489, -148.26239116728703, -146.47505203052572, -542.8446228405444, -255.0004628529956, -572.0222618410816, -275.8920712940603, -868.3646299465872, -718.9574985882703, -59.41392199464616, -646.4312634720571, -623.7659490381452, -666.3482912119739, -599.2058133035625, -818.37984920824, -704.7042431180689, -623.4399229724424, -540.3187606359239, 46.81570903076661, -1027.4733512161072, -382.0222286945304, -841.3125517578919, -599.5694734232973, 0.035833348548322874, -296.31994909302574, -696.1549582114048, -754.0763745395043, -593.0999394390174, -237.96601986444358, -188.23445054424548, -816.7437584405185, 47.62523604897342, -287.5362379901396, -343.808219724945, -704.7111362727942, -290.6922881000062, -50.12636299602979, -473.408976896384, -1056.1205055762987, 40.0000000000003, -546.3071014329076, 12.599498393946677, -190.76503327476675, -620.3778058663452, -605.4560937983736, -889.8865594716542, -138.05694057998193, -661.1601135842986, 13.989025705790727, -863.4061199407761, -474.0844391699137, -774.4562609745843, 40.0000000000003, -986.5201939726503, -795.0273401914502, -916.7517920720518, -556.3965730899077, -337.9100491982282, -624.5762903354657, -827.6259631598632, -671.9148088041159, -383.56836854615494, -465.7421587649119, -831.5928201438561, -569.4208704480378, -206.16488188822174, -4.765449937786907, -902.4993551718562, -507.99735710940934, -570.748706823194, 176.73587976842796, 40.0000000000003, 40.0000000000003, -826.3982409913077, -669.636718173612, -995.0410475585202, -20.938351462083993, -742.0711055566542, -452.9821456297195, -640.2578694283344, -533.9631681671975, -737.8026657541909, -378.3155926750086, -358.9680452187627, -624.1366750852529, -681.6856732563692, -57.60629393905657, -865.0340027590051, -672.1906620070282, -528.6120917587522, -578.5883579021071, -651.7877818242625, -532.1995890125056, -670.723103705709, -415.55470382414654, -696.7851918773066, -1003.312799896253, 355.82427396219225], "policy_predator_policy_reward": [98.38349815306096, 196.95393572905837, 579.146747378961, 500.0517723911589, 1182.861182357306, 686.7426431388174, 940.9672780994445, 118.13538852954181, 572.836708267494, 1013.3348219354186, 696.7993998761593, 131.99353823320882, 961.3315497756764, 995.0242289387108, 269.7455374839027, 292.38492067315127, 480.75329262164763, 718.1131295762385, 89.63063520511226, 677.5302181282258, 188.70567057553163, 368.248364731473, 658.2937908291415, 721.3726657862193, 374.02243969563415, 611.6734232777452, 687.0263649904832, 107.7203279709086, 3.8838834764831844, 236.7709351005041, 723.8494290119685, 395.29228935139497, 665.4536353576507, 644.6176639710194, 571.3086889370131, 761.5456470405879, 311.2183861615334, 239.1095596914646, 674.9137832876329, 304.57878674473454, 499.29663737392974, 807.457772004058, 528.0504727216943, 336.1480718733456, 660.4630976719641, 247.9852231262119, 516.8285016383813, 993.270726750552, 288.66707331545416, 598.8032966383568, 431.54740935752557, 744.992305012503, 867.5872042933889, 36.260383999856074, 283.51849935587677, 9.449944031440484, 989.6156243729413, 854.090897021199, 451.17245598198696, 607.6974825979386, 580.154735296619, 645.1147577974566, 619.4842567025838, 303.4342369131754, 315.41096309648486, 617.7606724689376, 311.2103536814661, 761.3037006879717, 382.032722139909, 688.2669073647935, 676.5697532850318, 666.0450477528337, 819.7186429329521, 791.0248451155933, 684.895608590762, 297.28497601055483, 838.3397999039015, 713.4712427883622, 607.2114044789994, 847.9155898512602, 900.7432286417958, 365.1964569108182, 558.5135670753579, 737.9843320575084, 547.2269509132241, 235.7854739277186, 516.2621552451892, 614.9931825049308, 288.3954363502029, 935.200115521996, 637.6711207318419, 720.2121309970534, 12.809698281885776, 257.3438823950105, 583.6980248547469, 603.1148516990083, 643.4550349972186, 548.6189001862364, 359.3865319529196, 550.7189021006621, 758.2301335776729, 736.6474100268142, 145.5970198555513, 702.2977920842086, 132.75035869787362, 558.1969626585042, 455.7634506516105, 423.86329626742, 814.776082763958, 622.1349697019125, 719.1574985882703, 84.36834855318614, 513.2943597654073, 685.0751171524821, 738.0403998796149, 569.8034928878704, 818.37984920824, 707.5042431180696, 636.039922972443, 543.7378527372779, 894.3464557444063, 615.9482173919016, 408.7847921069861, 842.0125517578921, 481.7558737250066, 281.19472115558744, 203.18554494687697, 745.287153796847, 754.9262717175646, 597.1083527868573, 14.766586323323832, 474.93388408536373, 528.1757763965664, 831.8305125250386, 382.16393840156417, 611.221642198119, 726.7980891108311, 308.49114538232607, 280.87180741358117, 461.5321670979844, 1008.4799190925952, 387.63797728623024, 569.5034231780555, 1.849245807684865, 242.85728213438392, 618.9289947320672, 841.8113747897464, 795.8872075313492, 77.5334216986364, 661.4987345977114, 825.8931284876729, 365.6504308519072, 546.6207683258515, 773.8868596637511, 856.4796054193451, 317.95805224973554, 799.1273401914511, 917.451792072052, 632.4276803679073, 27.56068868869738, 689.6695944490442, 827.2765345441187, 693.9556491501706, 307.42824906633535, 477.3628417553097, 831.4073776041866, 581.3204626496567, 550.6808788784848, 594.8409415167511, 758.4226438520031, 509.2933285601969, 576.996197041117, 1.664120231571943, 0.0, 628.6180203166779, 733.7170256637165, 665.8099855902872, 995.0410475585202, 205.19904184619088, 711.158323354732, 530.44487709328, 673.0216835042952, 674.3097281821119, 597.3218864798762, 459.71460164545374, 646.1896511305342, 625.5683030515968, 684.4762076911, 771.3307397032249, 762.6451770344354, 666.9390551837433, 642.8446695020467, 581.7883579021077, 654.1877818242627, 539.888512661442, 674.72310370571, 276.99245977513743, 756.0033601296338, 953.4944177507084, 432.55883335171166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.712044176969429, "mean_inference_ms": 4.937660176576604, "mean_action_processing_ms": 1.884057097616748, "mean_env_wait_ms": 13.150105662264924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00583338737487793, "StateBufferConnector_ms": 0.006275177001953125, "ViewRequirementAgentConnector_ms": 0.24288928508758545}, "num_episodes": 10, "episode_return_max": 1044.987362404717, "episode_return_min": -234.31825323153677, "episode_return_mean": 163.92552016396795, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.37055081812588, "num_env_steps_trained_throughput_per_sec": 152.37055081812588, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 26358.361, "restore_workers_time_ms": 0.07, "training_step_time_ms": 26358.116, "sample_time_ms": 2535.425, "learn_time_ms": 23797.968, "learn_throughput": 168.082, "synch_weights_time_ms": 21.038}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-06-25", "timestamp": 1724384185, "time_this_iter_s": 26.307889938354492, "time_total_s": 1899.5768699645996, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309628ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1899.5768699645996, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 34.07837837837838, "ram_util_percent": 82.42702702702704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.279571354326116, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.667999743910694, "policy_loss": -0.008128734885976112, "vf_loss": 7.675402973316334, "vf_explained_var": 0.13914473914595507, "kl": 0.007255310137268333, "entropy": 0.30035091439882916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67568.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.12248681361083, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.672838127297699, "policy_loss": -0.008450377782777189, "vf_loss": 7.680201574860426, "vf_explained_var": 0.5266304409693158, "kl": 0.010869387745433463, "entropy": 0.4836887461798532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67568.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 1044.987362404717, "episode_reward_min": -234.31825323153677, "episode_reward_mean": 167.04118665955866, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1101.9108811331698, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1008.4799190925952}, "policy_reward_mean": {"prey_policy": -474.16786330731304, "predator_policy": 557.6884566370927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.38474751371349, 406.01921120606926, 28.121035247954936, 63.46386887599005, 973.087516876329, 246.66200658727251, 59.15346747216276, 21.51128131009836, 160.30215697291808, 41.40950420841676, 182.3421957726399, 7.558686617562733, 86.49999999999976, 9.223599400724309, 95.57384986840967, 337.87959300349905, 0.238415773779586, 40.98600526742232, 632.4155553441824, 108.09999999999864, 7.170310496922488, 386.6595231978612, -68.21629719278397, 11.211041127172257, 33.72278321197674, 89.77635220899644, 396.23398171529107, 199.6141158997234, 70.39999999999988, 6.299999999999997, 577.4089364686808, 523.1827175371687, 12.199999999999989, 179.81462450195497, 347.06288867501434, 220.57929645913723, 58.59672033293218, 97.24581481690109, 278.12715351190764, -5.056550371459867, 1.7622713514635464, 4.3000000000000025, 40.39999999999999, 1044.987362404717, 15.26344344462458, 1.627646485306814, 52.60402222495194, 292.65435122521876, 25.15442655854123, -71.82773559231266, 42.28978825194701, 2.7999999999999954, 16.01909210135408, 529.6370309509674, 27.462563412451356, 163.41695480584312, -44.00220856070891, 4.858310525899105, 63.50000000000082, 590.8877665300589, 362.0411228845995, 39.88581012035412, 218.8686346191448, 379.9973908025261, 37.64506594677756, 50.643437725338536, 142.3559290510691, -60.1848978679322, 342.1264651045967, 71.96692784510226, 227.91746369643312, 4.799999999999999, -234.31825323153677, 64.74387549782983, -54.099279133763815, 11.435240450726285, 356.4155891918862, 445.99878025911175, 7.5434616687053175, 218.3999999999987, 575.9368049890898, -3.826732583324606, 153.34790818218494, 110.22654553952192, -0.13421925939964718, 368.62061488221, 4.222162401073627, 611.335620039599, 108.98097092000445, 5.599999999999996, 11.68892364893456, -79.34407579668138, 738.5647251683627, 4.399999999999999, 364.3478406270377, 188.50048784593056, 15.634314792637472, 46.77050983124841, 728.8232714738026, 472.24852761323285], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-104.15938310834296, -540.3558225624205, -766.7980630097709, -26.04914798204741, -69.89777092136069, -669.1420471640231, -456.0243612780996, -37.46580515291537, 400.0, -806.5789397390348, -646.6217836681227, -92.41207271798335, -670.8357025566613, -64.75752293257008, -131.95736056736703, -87.18617669952515, -161.88855060332176, -796.9510107871239, -790.3227658821089, -478.33902923814276, -562.2899073913933, -588.222232813567, -233.90913322633773, -308.86012600909487, -671.213783287632, -221.77878674473536, -491.6730379732041, -805.8577720040579, -233.0656646137177, -535.5590301129116, -119.35365687984012, -451.21507091483824, -568.4933867235013, -941.3674258916525, -265.4530304151007, -581.0313342712791, -789.9228491222359, 245.79869009638887, -867.4872042933888, 71.73961600014367, -260.3450777520491, -25.453055138341334, -992.5173478316578, -464.5296503646198, -544.9244053945134, -582.161830378195, -574.5337553733136, -639.5246965935901, -616.4022906913333, -272.7934197124462, -299.9707157578201, -543.4245675986006, 135.64702597462232, -811.9270986287705, -417.71781642562433, -452.9676971793527, -607.7697532850318, -664.4450477528336, -813.9186429329519, -790.5248451155933, -696.1548234137964, 291.3831752811599, -815.9919863782546, -212.63633877683623, -596.6114044789971, -846.3155898512598, -978.3361980050573, -107.7888630456043, -197.02423655816625, -752.4107738996864, -519.2214096476558, -43.21171873414738, -461.5654349122572, -611.0931825049298, -443.89852018258796, -682.4512168727066, 22.154782916186697, -1101.9108811331698, -50.37703133123626, -224.8330997171222, -583.198024854747, -601.8525803475441, -641.5550349972186, -546.218900186236, -328.9865319529184, -540.718902100662, 383.5313483765131, -833.4215295762851, -684.3689773278489, -148.26239116728703, -146.47505203052572, -542.8446228405444, -255.0004628529956, -572.0222618410816, -275.8920712940603, -868.3646299465872, -718.9574985882703, -59.41392199464616, -646.4312634720571, -623.7659490381452, -666.3482912119739, -599.2058133035625, -818.37984920824, -704.7042431180689, -623.4399229724424, -540.3187606359239, 46.81570903076661, -1027.4733512161072, -382.0222286945304, -841.3125517578919, -599.5694734232973, 0.035833348548322874, -296.31994909302574, -696.1549582114048, -754.0763745395043, -593.0999394390174, -237.96601986444358, -188.23445054424548, -816.7437584405185, 47.62523604897342, -287.5362379901396, -343.808219724945, -704.7111362727942, -290.6922881000062, -50.12636299602979, -473.408976896384, -1056.1205055762987, 40.0000000000003, -546.3071014329076, 12.599498393946677, -190.76503327476675, -620.3778058663452, -605.4560937983736, -889.8865594716542, -138.05694057998193, -661.1601135842986, 13.989025705790727, -863.4061199407761, -474.0844391699137, -774.4562609745843, 40.0000000000003, -986.5201939726503, -795.0273401914502, -916.7517920720518, -556.3965730899077, -337.9100491982282, -624.5762903354657, -827.6259631598632, -671.9148088041159, -383.56836854615494, -465.7421587649119, -831.5928201438561, -569.4208704480378, -206.16488188822174, -4.765449937786907, -902.4993551718562, -507.99735710940934, -570.748706823194, 176.73587976842796, 40.0000000000003, 40.0000000000003, -826.3982409913077, -669.636718173612, -995.0410475585202, -20.938351462083993, -742.0711055566542, -452.9821456297195, -640.2578694283344, -533.9631681671975, -737.8026657541909, -378.3155926750086, -358.9680452187627, -624.1366750852529, -681.6856732563692, -57.60629393905657, -865.0340027590051, -672.1906620070282, -528.6120917587522, -578.5883579021071, -651.7877818242625, -532.1995890125056, -670.723103705709, -415.55470382414654, -696.7851918773066, -1003.312799896253, 355.82427396219225, -778.595233097856, -770.5440040754307, -391.9739769424477, 105.61608227186586, -625.7039358606826, -851.8162310586999, -488.80845142372675, -462.96157772618375, -818.0844187535652, -534.1294383329437, -905.2985972291074, -93.81864584636901, -737.8840218956299, -23.973538931582276], "policy_predator_policy_reward": [269.7455374839027, 292.38492067315127, 480.75329262164763, 718.1131295762385, 89.63063520511226, 677.5302181282258, 188.70567057553163, 368.248364731473, 658.2937908291415, 721.3726657862193, 374.02243969563415, 611.6734232777452, 687.0263649904832, 107.7203279709086, 3.8838834764831844, 236.7709351005041, 723.8494290119685, 395.29228935139497, 665.4536353576507, 644.6176639710194, 571.3086889370131, 761.5456470405879, 311.2183861615334, 239.1095596914646, 674.9137832876329, 304.57878674473454, 499.29663737392974, 807.457772004058, 528.0504727216943, 336.1480718733456, 660.4630976719641, 247.9852231262119, 516.8285016383813, 993.270726750552, 288.66707331545416, 598.8032966383568, 431.54740935752557, 744.992305012503, 867.5872042933889, 36.260383999856074, 283.51849935587677, 9.449944031440484, 989.6156243729413, 854.090897021199, 451.17245598198696, 607.6974825979386, 580.154735296619, 645.1147577974566, 619.4842567025838, 303.4342369131754, 315.41096309648486, 617.7606724689376, 311.2103536814661, 761.3037006879717, 382.032722139909, 688.2669073647935, 676.5697532850318, 666.0450477528337, 819.7186429329521, 791.0248451155933, 684.895608590762, 297.28497601055483, 838.3397999039015, 713.4712427883622, 607.2114044789994, 847.9155898512602, 900.7432286417958, 365.1964569108182, 558.5135670753579, 737.9843320575084, 547.2269509132241, 235.7854739277186, 516.2621552451892, 614.9931825049308, 288.3954363502029, 935.200115521996, 637.6711207318419, 720.2121309970534, 12.809698281885776, 257.3438823950105, 583.6980248547469, 603.1148516990083, 643.4550349972186, 548.6189001862364, 359.3865319529196, 550.7189021006621, 758.2301335776729, 736.6474100268142, 145.5970198555513, 702.2977920842086, 132.75035869787362, 558.1969626585042, 455.7634506516105, 423.86329626742, 814.776082763958, 622.1349697019125, 719.1574985882703, 84.36834855318614, 513.2943597654073, 685.0751171524821, 738.0403998796149, 569.8034928878704, 818.37984920824, 707.5042431180696, 636.039922972443, 543.7378527372779, 894.3464557444063, 615.9482173919016, 408.7847921069861, 842.0125517578921, 481.7558737250066, 281.19472115558744, 203.18554494687697, 745.287153796847, 754.9262717175646, 597.1083527868573, 14.766586323323832, 474.93388408536373, 528.1757763965664, 831.8305125250386, 382.16393840156417, 611.221642198119, 726.7980891108311, 308.49114538232607, 280.87180741358117, 461.5321670979844, 1008.4799190925952, 387.63797728623024, 569.5034231780555, 1.849245807684865, 242.85728213438392, 618.9289947320672, 841.8113747897464, 795.8872075313492, 77.5334216986364, 661.4987345977114, 825.8931284876729, 365.6504308519072, 546.6207683258515, 773.8868596637511, 856.4796054193451, 317.95805224973554, 799.1273401914511, 917.451792072052, 632.4276803679073, 27.56068868869738, 689.6695944490442, 827.2765345441187, 693.9556491501706, 307.42824906633535, 477.3628417553097, 831.4073776041866, 581.3204626496567, 550.6808788784848, 594.8409415167511, 758.4226438520031, 509.2933285601969, 576.996197041117, 1.664120231571943, 0.0, 628.6180203166779, 733.7170256637165, 665.8099855902872, 995.0410475585202, 205.19904184619088, 711.158323354732, 530.44487709328, 673.0216835042952, 674.3097281821119, 597.3218864798762, 459.71460164545374, 646.1896511305342, 625.5683030515968, 684.4762076911, 771.3307397032249, 762.6451770344354, 666.9390551837433, 642.8446695020467, 581.7883579021077, 654.1877818242627, 539.888512661442, 674.72310370571, 276.99245977513743, 756.0033601296338, 953.4944177507084, 432.55883335171166, 779.2952330978561, 774.2440040754313, 403.4060626212954, 247.29967267632398, 910.6296525912378, 755.3910021740724, 257.05463475688316, 710.3497091856672, 818.5844187535653, 580.3999481641921, 823.2630555985813, 904.6774589506953, 692.3131847485116, 541.7929036919282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.701145746606699, "mean_inference_ms": 4.930903219276261, "mean_action_processing_ms": 1.8851885547268512, "mean_env_wait_ms": 13.147531083725084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005900025367736816, "StateBufferConnector_ms": 0.006318807601928711, "ViewRequirementAgentConnector_ms": 0.24549484252929688}, "num_episodes": 7, "episode_return_max": 1044.987362404717, "episode_return_min": -234.31825323153677, "episode_return_mean": 167.04118665955866, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.68423980896333, "num_env_steps_trained_throughput_per_sec": 151.68423980896333, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 26370.565, "restore_workers_time_ms": 0.07, "training_step_time_ms": 26370.297, "sample_time_ms": 2517.439, "learn_time_ms": 23828.481, "learn_throughput": 167.866, "synch_weights_time_ms": 20.905}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-06-51", "timestamp": 1724384211, "time_this_iter_s": 26.41709613800049, "time_total_s": 1925.9939661026, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b084c9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1925.9939661026, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 34.72105263157896, "ram_util_percent": 82.55526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.627814873942622, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.454281979010849, "policy_loss": -0.006887718248205684, "vf_loss": 7.4605694402462595, "vf_explained_var": 0.08890094296642082, "kl": 0.006002367679990591, "entropy": 0.3159720199448722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68513.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.981330337095514, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.676626557143277, "policy_loss": -0.01327547295334399, "vf_loss": 7.68857526577339, "vf_explained_var": 0.3532468731441195, "kl": 0.0132675260475408, "entropy": 0.487095574947892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68513.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 1044.987362404717, "episode_reward_min": -234.31825323153677, "episode_reward_mean": 162.741589125957, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1101.9108811331698, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.5313483765131, "predator_policy": 1008.4799190925952}, "policy_reward_mean": {"prey_policy": -494.7840750798675, "predator_policy": 576.1548696428464}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.558686617562733, 86.49999999999976, 9.223599400724309, 95.57384986840967, 337.87959300349905, 0.238415773779586, 40.98600526742232, 632.4155553441824, 108.09999999999864, 7.170310496922488, 386.6595231978612, -68.21629719278397, 11.211041127172257, 33.72278321197674, 89.77635220899644, 396.23398171529107, 199.6141158997234, 70.39999999999988, 6.299999999999997, 577.4089364686808, 523.1827175371687, 12.199999999999989, 179.81462450195497, 347.06288867501434, 220.57929645913723, 58.59672033293218, 97.24581481690109, 278.12715351190764, -5.056550371459867, 1.7622713514635464, 4.3000000000000025, 40.39999999999999, 1044.987362404717, 15.26344344462458, 1.627646485306814, 52.60402222495194, 292.65435122521876, 25.15442655854123, -71.82773559231266, 42.28978825194701, 2.7999999999999954, 16.01909210135408, 529.6370309509674, 27.462563412451356, 163.41695480584312, -44.00220856070891, 4.858310525899105, 63.50000000000082, 590.8877665300589, 362.0411228845995, 39.88581012035412, 218.8686346191448, 379.9973908025261, 37.64506594677756, 50.643437725338536, 142.3559290510691, -60.1848978679322, 342.1264651045967, 71.96692784510226, 227.91746369643312, 4.799999999999999, -234.31825323153677, 64.74387549782983, -54.099279133763815, 11.435240450726285, 356.4155891918862, 445.99878025911175, 7.5434616687053175, 218.3999999999987, 575.9368049890898, -3.826732583324606, 153.34790818218494, 110.22654553952192, -0.13421925939964718, 368.62061488221, 4.222162401073627, 611.335620039599, 108.98097092000445, 5.599999999999996, 11.68892364893456, -79.34407579668138, 738.5647251683627, 4.399999999999999, 364.3478406270377, 188.50048784593056, 15.634314792637472, 46.77050983124841, 728.8232714738026, 472.24852761323285, 185.36723399036447, 262.56447251090907, 215.97961742030537, 6.777561044831266, 66.60562762651023, 1.0999999999999996, 499.13496542596977, 1.699999999999999, -28.056907768787383, 104.54543447541137, 354.009738930454], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-233.90913322633773, -308.86012600909487, -671.213783287632, -221.77878674473536, -491.6730379732041, -805.8577720040579, -233.0656646137177, -535.5590301129116, -119.35365687984012, -451.21507091483824, -568.4933867235013, -941.3674258916525, -265.4530304151007, -581.0313342712791, -789.9228491222359, 245.79869009638887, -867.4872042933888, 71.73961600014367, -260.3450777520491, -25.453055138341334, -992.5173478316578, -464.5296503646198, -544.9244053945134, -582.161830378195, -574.5337553733136, -639.5246965935901, -616.4022906913333, -272.7934197124462, -299.9707157578201, -543.4245675986006, 135.64702597462232, -811.9270986287705, -417.71781642562433, -452.9676971793527, -607.7697532850318, -664.4450477528336, -813.9186429329519, -790.5248451155933, -696.1548234137964, 291.3831752811599, -815.9919863782546, -212.63633877683623, -596.6114044789971, -846.3155898512598, -978.3361980050573, -107.7888630456043, -197.02423655816625, -752.4107738996864, -519.2214096476558, -43.21171873414738, -461.5654349122572, -611.0931825049298, -443.89852018258796, -682.4512168727066, 22.154782916186697, -1101.9108811331698, -50.37703133123626, -224.8330997171222, -583.198024854747, -601.8525803475441, -641.5550349972186, -546.218900186236, -328.9865319529184, -540.718902100662, 383.5313483765131, -833.4215295762851, -684.3689773278489, -148.26239116728703, -146.47505203052572, -542.8446228405444, -255.0004628529956, -572.0222618410816, -275.8920712940603, -868.3646299465872, -718.9574985882703, -59.41392199464616, -646.4312634720571, -623.7659490381452, -666.3482912119739, -599.2058133035625, -818.37984920824, -704.7042431180689, -623.4399229724424, -540.3187606359239, 46.81570903076661, -1027.4733512161072, -382.0222286945304, -841.3125517578919, -599.5694734232973, 0.035833348548322874, -296.31994909302574, -696.1549582114048, -754.0763745395043, -593.0999394390174, -237.96601986444358, -188.23445054424548, -816.7437584405185, 47.62523604897342, -287.5362379901396, -343.808219724945, -704.7111362727942, -290.6922881000062, -50.12636299602979, -473.408976896384, -1056.1205055762987, 40.0000000000003, -546.3071014329076, 12.599498393946677, -190.76503327476675, -620.3778058663452, -605.4560937983736, -889.8865594716542, -138.05694057998193, -661.1601135842986, 13.989025705790727, -863.4061199407761, -474.0844391699137, -774.4562609745843, 40.0000000000003, -986.5201939726503, -795.0273401914502, -916.7517920720518, -556.3965730899077, -337.9100491982282, -624.5762903354657, -827.6259631598632, -671.9148088041159, -383.56836854615494, -465.7421587649119, -831.5928201438561, -569.4208704480378, -206.16488188822174, -4.765449937786907, -902.4993551718562, -507.99735710940934, -570.748706823194, 176.73587976842796, 40.0000000000003, 40.0000000000003, -826.3982409913077, -669.636718173612, -995.0410475585202, -20.938351462083993, -742.0711055566542, -452.9821456297195, -640.2578694283344, -533.9631681671975, -737.8026657541909, -378.3155926750086, -358.9680452187627, -624.1366750852529, -681.6856732563692, -57.60629393905657, -865.0340027590051, -672.1906620070282, -528.6120917587522, -578.5883579021071, -651.7877818242625, -532.1995890125056, -670.723103705709, -415.55470382414654, -696.7851918773066, -1003.312799896253, 355.82427396219225, -778.595233097856, -770.5440040754307, -391.9739769424477, 105.61608227186586, -625.7039358606826, -851.8162310586999, -488.80845142372675, -462.96157772618375, -818.0844187535652, -534.1294383329437, -905.2985972291074, -93.81864584636901, -737.8840218956299, -23.973538931582276, -150.05121271376572, -875.7736285113577, -638.4308251030444, -489.8117413194341, -617.3818569164763, -12.538899060326164, -499.70916495698134, -562.322329058909, -455.26161771452337, -765.4382307641966, -778.6211199998097, -700.661876794911, -869.5026848404768, -461.75635264107177, -690.2448384237782, -832.0405870096157, -634.0502099556228, -430.20765538205086, -334.64795725578983, -522.6274753686982, -94.89597118597312, -855.5215763099874], "policy_predator_policy_reward": [311.2183861615334, 239.1095596914646, 674.9137832876329, 304.57878674473454, 499.29663737392974, 807.457772004058, 528.0504727216943, 336.1480718733456, 660.4630976719641, 247.9852231262119, 516.8285016383813, 993.270726750552, 288.66707331545416, 598.8032966383568, 431.54740935752557, 744.992305012503, 867.5872042933889, 36.260383999856074, 283.51849935587677, 9.449944031440484, 989.6156243729413, 854.090897021199, 451.17245598198696, 607.6974825979386, 580.154735296619, 645.1147577974566, 619.4842567025838, 303.4342369131754, 315.41096309648486, 617.7606724689376, 311.2103536814661, 761.3037006879717, 382.032722139909, 688.2669073647935, 676.5697532850318, 666.0450477528337, 819.7186429329521, 791.0248451155933, 684.895608590762, 297.28497601055483, 838.3397999039015, 713.4712427883622, 607.2114044789994, 847.9155898512602, 900.7432286417958, 365.1964569108182, 558.5135670753579, 737.9843320575084, 547.2269509132241, 235.7854739277186, 516.2621552451892, 614.9931825049308, 288.3954363502029, 935.200115521996, 637.6711207318419, 720.2121309970534, 12.809698281885776, 257.3438823950105, 583.6980248547469, 603.1148516990083, 643.4550349972186, 548.6189001862364, 359.3865319529196, 550.7189021006621, 758.2301335776729, 736.6474100268142, 145.5970198555513, 702.2977920842086, 132.75035869787362, 558.1969626585042, 455.7634506516105, 423.86329626742, 814.776082763958, 622.1349697019125, 719.1574985882703, 84.36834855318614, 513.2943597654073, 685.0751171524821, 738.0403998796149, 569.8034928878704, 818.37984920824, 707.5042431180696, 636.039922972443, 543.7378527372779, 894.3464557444063, 615.9482173919016, 408.7847921069861, 842.0125517578921, 481.7558737250066, 281.19472115558744, 203.18554494687697, 745.287153796847, 754.9262717175646, 597.1083527868573, 14.766586323323832, 474.93388408536373, 528.1757763965664, 831.8305125250386, 382.16393840156417, 611.221642198119, 726.7980891108311, 308.49114538232607, 280.87180741358117, 461.5321670979844, 1008.4799190925952, 387.63797728623024, 569.5034231780555, 1.849245807684865, 242.85728213438392, 618.9289947320672, 841.8113747897464, 795.8872075313492, 77.5334216986364, 661.4987345977114, 825.8931284876729, 365.6504308519072, 546.6207683258515, 773.8868596637511, 856.4796054193451, 317.95805224973554, 799.1273401914511, 917.451792072052, 632.4276803679073, 27.56068868869738, 689.6695944490442, 827.2765345441187, 693.9556491501706, 307.42824906633535, 477.3628417553097, 831.4073776041866, 581.3204626496567, 550.6808788784848, 594.8409415167511, 758.4226438520031, 509.2933285601969, 576.996197041117, 1.664120231571943, 0.0, 628.6180203166779, 733.7170256637165, 665.8099855902872, 995.0410475585202, 205.19904184619088, 711.158323354732, 530.44487709328, 673.0216835042952, 674.3097281821119, 597.3218864798762, 459.71460164545374, 646.1896511305342, 625.5683030515968, 684.4762076911, 771.3307397032249, 762.6451770344354, 666.9390551837433, 642.8446695020467, 581.7883579021077, 654.1877818242627, 539.888512661442, 674.72310370571, 276.99245977513743, 756.0033601296338, 953.4944177507084, 432.55883335171166, 779.2952330978561, 774.2440040754313, 403.4060626212954, 247.29967267632398, 910.6296525912378, 755.3910021740724, 257.05463475688316, 710.3497091856672, 818.5844187535653, 580.3999481641921, 823.2630555985813, 904.6774589506953, 692.3131847485116, 541.7929036919282, 336.3148383081871, 874.877236907301, 646.5413491071589, 744.2656898262292, 600.6067018560085, 245.29367154109931, 503.7875006345786, 565.0215544261434, 520.2672453410348, 767.0382307641967, 779.7211199998097, 700.661876794911, 863.6055959968048, 966.7884069107023, 691.9448384237785, 832.0405870096157, 722.3273715587843, 313.8735860101082, 401.18208987598587, 560.6387772239159, 490.1261578018027, 814.3011286246103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.67851252286996, "mean_inference_ms": 4.928283599268808, "mean_action_processing_ms": 1.8795554794437126, "mean_env_wait_ms": 13.15345548135582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005669713020324707, "StateBufferConnector_ms": 0.006216526031494141, "ViewRequirementAgentConnector_ms": 0.19583070278167725}, "num_episodes": 11, "episode_return_max": 1044.987362404717, "episode_return_min": -234.31825323153677, "episode_return_mean": 162.741589125957, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.53684217219725, "num_env_steps_trained_throughput_per_sec": 151.53684217219725, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 26300.061, "restore_workers_time_ms": 0.063, "training_step_time_ms": 26299.815, "sample_time_ms": 2456.694, "learn_time_ms": 23820.638, "learn_throughput": 167.922, "synch_weights_time_ms": 19.208}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-07-18", "timestamp": 1724384238, "time_this_iter_s": 26.429691314697266, "time_total_s": 1952.4236574172974, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309667dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1952.4236574172974, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 33.27567567567568, "ram_util_percent": 83.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.73871866786291, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.407966488631314, "policy_loss": -0.007004390128459485, "vf_loss": 7.414410749566618, "vf_explained_var": 0.06803891147886004, "kl": 0.005601589793891267, "entropy": 0.3086167718998339, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 69458.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.930294435743303, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.605886780269563, "policy_loss": -0.007902764364899624, "vf_loss": 7.612956586968962, "vf_explained_var": 0.45194449576120527, "kl": 0.00832948051393032, "entropy": 0.45109479960310395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 69458.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 1044.987362404717, "episode_reward_min": -234.31825323153677, "episode_reward_mean": 156.64643966870915, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1101.9108811331698, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.5313483765131, "predator_policy": 1008.4799190925952}, "policy_reward_mean": {"prey_policy": -506.59297425798786, "predator_policy": 584.9161940923427}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.170310496922488, 386.6595231978612, -68.21629719278397, 11.211041127172257, 33.72278321197674, 89.77635220899644, 396.23398171529107, 199.6141158997234, 70.39999999999988, 6.299999999999997, 577.4089364686808, 523.1827175371687, 12.199999999999989, 179.81462450195497, 347.06288867501434, 220.57929645913723, 58.59672033293218, 97.24581481690109, 278.12715351190764, -5.056550371459867, 1.7622713514635464, 4.3000000000000025, 40.39999999999999, 1044.987362404717, 15.26344344462458, 1.627646485306814, 52.60402222495194, 292.65435122521876, 25.15442655854123, -71.82773559231266, 42.28978825194701, 2.7999999999999954, 16.01909210135408, 529.6370309509674, 27.462563412451356, 163.41695480584312, -44.00220856070891, 4.858310525899105, 63.50000000000082, 590.8877665300589, 362.0411228845995, 39.88581012035412, 218.8686346191448, 379.9973908025261, 37.64506594677756, 50.643437725338536, 142.3559290510691, -60.1848978679322, 342.1264651045967, 71.96692784510226, 227.91746369643312, 4.799999999999999, -234.31825323153677, 64.74387549782983, -54.099279133763815, 11.435240450726285, 356.4155891918862, 445.99878025911175, 7.5434616687053175, 218.3999999999987, 575.9368049890898, -3.826732583324606, 153.34790818218494, 110.22654553952192, -0.13421925939964718, 368.62061488221, 4.222162401073627, 611.335620039599, 108.98097092000445, 5.599999999999996, 11.68892364893456, -79.34407579668138, 738.5647251683627, 4.399999999999999, 364.3478406270377, 188.50048784593056, 15.634314792637472, 46.77050983124841, 728.8232714738026, 472.24852761323285, 185.36723399036447, 262.56447251090907, 215.97961742030537, 6.777561044831266, 66.60562762651023, 1.0999999999999996, 499.13496542596977, 1.699999999999999, -28.056907768787383, 104.54543447541137, 354.009738930454, 0.19478274494072334, 68.32246306959539, 2.799999999999999, 255.42010480912765, 160.27949636404335, 6.699999999999992, 252.89198100324808, 0.6000000000000014, -38.248068440163294], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-260.3450777520491, -25.453055138341334, -992.5173478316578, -464.5296503646198, -544.9244053945134, -582.161830378195, -574.5337553733136, -639.5246965935901, -616.4022906913333, -272.7934197124462, -299.9707157578201, -543.4245675986006, 135.64702597462232, -811.9270986287705, -417.71781642562433, -452.9676971793527, -607.7697532850318, -664.4450477528336, -813.9186429329519, -790.5248451155933, -696.1548234137964, 291.3831752811599, -815.9919863782546, -212.63633877683623, -596.6114044789971, -846.3155898512598, -978.3361980050573, -107.7888630456043, -197.02423655816625, -752.4107738996864, -519.2214096476558, -43.21171873414738, -461.5654349122572, -611.0931825049298, -443.89852018258796, -682.4512168727066, 22.154782916186697, -1101.9108811331698, -50.37703133123626, -224.8330997171222, -583.198024854747, -601.8525803475441, -641.5550349972186, -546.218900186236, -328.9865319529184, -540.718902100662, 383.5313483765131, -833.4215295762851, -684.3689773278489, -148.26239116728703, -146.47505203052572, -542.8446228405444, -255.0004628529956, -572.0222618410816, -275.8920712940603, -868.3646299465872, -718.9574985882703, -59.41392199464616, -646.4312634720571, -623.7659490381452, -666.3482912119739, -599.2058133035625, -818.37984920824, -704.7042431180689, -623.4399229724424, -540.3187606359239, 46.81570903076661, -1027.4733512161072, -382.0222286945304, -841.3125517578919, -599.5694734232973, 0.035833348548322874, -296.31994909302574, -696.1549582114048, -754.0763745395043, -593.0999394390174, -237.96601986444358, -188.23445054424548, -816.7437584405185, 47.62523604897342, -287.5362379901396, -343.808219724945, -704.7111362727942, -290.6922881000062, -50.12636299602979, -473.408976896384, -1056.1205055762987, 40.0000000000003, -546.3071014329076, 12.599498393946677, -190.76503327476675, -620.3778058663452, -605.4560937983736, -889.8865594716542, -138.05694057998193, -661.1601135842986, 13.989025705790727, -863.4061199407761, -474.0844391699137, -774.4562609745843, 40.0000000000003, -986.5201939726503, -795.0273401914502, -916.7517920720518, -556.3965730899077, -337.9100491982282, -624.5762903354657, -827.6259631598632, -671.9148088041159, -383.56836854615494, -465.7421587649119, -831.5928201438561, -569.4208704480378, -206.16488188822174, -4.765449937786907, -902.4993551718562, -507.99735710940934, -570.748706823194, 176.73587976842796, 40.0000000000003, 40.0000000000003, -826.3982409913077, -669.636718173612, -995.0410475585202, -20.938351462083993, -742.0711055566542, -452.9821456297195, -640.2578694283344, -533.9631681671975, -737.8026657541909, -378.3155926750086, -358.9680452187627, -624.1366750852529, -681.6856732563692, -57.60629393905657, -865.0340027590051, -672.1906620070282, -528.6120917587522, -578.5883579021071, -651.7877818242625, -532.1995890125056, -670.723103705709, -415.55470382414654, -696.7851918773066, -1003.312799896253, 355.82427396219225, -778.595233097856, -770.5440040754307, -391.9739769424477, 105.61608227186586, -625.7039358606826, -851.8162310586999, -488.80845142372675, -462.96157772618375, -818.0844187535652, -534.1294383329437, -905.2985972291074, -93.81864584636901, -737.8840218956299, -23.973538931582276, -150.05121271376572, -875.7736285113577, -638.4308251030444, -489.8117413194341, -617.3818569164763, -12.538899060326164, -499.70916495698134, -562.322329058909, -455.26161771452337, -765.4382307641966, -778.6211199998097, -700.661876794911, -869.5026848404768, -461.75635264107177, -690.2448384237782, -832.0405870096157, -634.0502099556228, -430.20765538205086, -334.64795725578983, -522.6274753686982, -94.89597118597312, -855.5215763099874, -933.6489567001792, -723.4281041349146, -266.3702083268571, -838.6971829139501, -563.7791505334701, -837.7814562887878, -149.36999769897525, -772.6840061658008, -569.7991425243256, 14.654900926076436, -566.2224768016985, -815.6024236789829, 18.993058911611335, -775.917797251116, -615.7822147478925, -748.415286078326, -353.26415010546043, -633.3682278980197], "policy_predator_policy_reward": [283.51849935587677, 9.449944031440484, 989.6156243729413, 854.090897021199, 451.17245598198696, 607.6974825979386, 580.154735296619, 645.1147577974566, 619.4842567025838, 303.4342369131754, 315.41096309648486, 617.7606724689376, 311.2103536814661, 761.3037006879717, 382.032722139909, 688.2669073647935, 676.5697532850318, 666.0450477528337, 819.7186429329521, 791.0248451155933, 684.895608590762, 297.28497601055483, 838.3397999039015, 713.4712427883622, 607.2114044789994, 847.9155898512602, 900.7432286417958, 365.1964569108182, 558.5135670753579, 737.9843320575084, 547.2269509132241, 235.7854739277186, 516.2621552451892, 614.9931825049308, 288.3954363502029, 935.200115521996, 637.6711207318419, 720.2121309970534, 12.809698281885776, 257.3438823950105, 583.6980248547469, 603.1148516990083, 643.4550349972186, 548.6189001862364, 359.3865319529196, 550.7189021006621, 758.2301335776729, 736.6474100268142, 145.5970198555513, 702.2977920842086, 132.75035869787362, 558.1969626585042, 455.7634506516105, 423.86329626742, 814.776082763958, 622.1349697019125, 719.1574985882703, 84.36834855318614, 513.2943597654073, 685.0751171524821, 738.0403998796149, 569.8034928878704, 818.37984920824, 707.5042431180696, 636.039922972443, 543.7378527372779, 894.3464557444063, 615.9482173919016, 408.7847921069861, 842.0125517578921, 481.7558737250066, 281.19472115558744, 203.18554494687697, 745.287153796847, 754.9262717175646, 597.1083527868573, 14.766586323323832, 474.93388408536373, 528.1757763965664, 831.8305125250386, 382.16393840156417, 611.221642198119, 726.7980891108311, 308.49114538232607, 280.87180741358117, 461.5321670979844, 1008.4799190925952, 387.63797728623024, 569.5034231780555, 1.849245807684865, 242.85728213438392, 618.9289947320672, 841.8113747897464, 795.8872075313492, 77.5334216986364, 661.4987345977114, 825.8931284876729, 365.6504308519072, 546.6207683258515, 773.8868596637511, 856.4796054193451, 317.95805224973554, 799.1273401914511, 917.451792072052, 632.4276803679073, 27.56068868869738, 689.6695944490442, 827.2765345441187, 693.9556491501706, 307.42824906633535, 477.3628417553097, 831.4073776041866, 581.3204626496567, 550.6808788784848, 594.8409415167511, 758.4226438520031, 509.2933285601969, 576.996197041117, 1.664120231571943, 0.0, 628.6180203166779, 733.7170256637165, 665.8099855902872, 995.0410475585202, 205.19904184619088, 711.158323354732, 530.44487709328, 673.0216835042952, 674.3097281821119, 597.3218864798762, 459.71460164545374, 646.1896511305342, 625.5683030515968, 684.4762076911, 771.3307397032249, 762.6451770344354, 666.9390551837433, 642.8446695020467, 581.7883579021077, 654.1877818242627, 539.888512661442, 674.72310370571, 276.99245977513743, 756.0033601296338, 953.4944177507084, 432.55883335171166, 779.2952330978561, 774.2440040754313, 403.4060626212954, 247.29967267632398, 910.6296525912378, 755.3910021740724, 257.05463475688316, 710.3497091856672, 818.5844187535653, 580.3999481641921, 823.2630555985813, 904.6774589506953, 692.3131847485116, 541.7929036919282, 336.3148383081871, 874.877236907301, 646.5413491071589, 744.2656898262292, 600.6067018560085, 245.29367154109931, 503.7875006345786, 565.0215544261434, 520.2672453410348, 767.0382307641967, 779.7211199998097, 700.661876794911, 863.6055959968048, 966.7884069107023, 691.9448384237785, 832.0405870096157, 722.3273715587843, 313.8735860101082, 401.18208987598587, 560.6387772239159, 490.1261578018027, 814.3011286246103, 933.7113445526547, 723.5604990273798, 874.3322058101242, 299.05764850027765, 566.3791505334708, 837.9814562887879, 389.96824651826364, 787.5058621556416, 207.81143730126092, 507.61230066103184, 571.9224768016985, 816.6024236789829, 233.89892209163716, 775.917797251116, 616.2822147478926, 748.515286078326, 303.51608166529945, 644.8682278980206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.687870177582481, "mean_inference_ms": 4.936659221135129, "mean_action_processing_ms": 1.859219310931984, "mean_env_wait_ms": 13.154646193066048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005344867706298828, "StateBufferConnector_ms": 0.006369352340698242, "ViewRequirementAgentConnector_ms": 0.18854522705078125}, "num_episodes": 9, "episode_return_max": 1044.987362404717, "episode_return_min": -234.31825323153677, "episode_return_mean": 156.64643966870915, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.03618625708043, "num_env_steps_trained_throughput_per_sec": 153.03618625708043, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 26253.558, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26253.368, "sample_time_ms": 2378.681, "learn_time_ms": 23850.965, "learn_throughput": 167.708, "synch_weights_time_ms": 20.303}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-07-44", "timestamp": 1724384264, "time_this_iter_s": 26.180171966552734, "time_total_s": 1978.60382938385, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095b4550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1978.60382938385, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 33.84324324324325, "ram_util_percent": 81.96486486486486}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.7428002256565, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.575768234111645, "policy_loss": -0.009951233317848867, "vf_loss": 7.584925851367768, "vf_explained_var": 0.16506006623071337, "kl": 0.007936187862867006, "entropy": 0.3069123316694189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70403.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999534}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.455621212247816, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.829946102667107, "policy_loss": -0.008653547234892372, "vf_loss": 7.837797344046295, "vf_explained_var": 0.49793800809396005, "kl": 0.008022970712876746, "entropy": 0.4366423727974059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70403.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999534}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 1044.987362404717, "episode_reward_min": -234.31825323153677, "episode_reward_mean": 157.34958706139912, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1101.9108811331698, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.5313483765131, "predator_policy": 1008.4799190925952}, "policy_reward_mean": {"prey_policy": -507.9807838421409, "predator_policy": 586.6555773728408}, "custom_metrics": {}, "hist_stats": {"episode_reward": [396.23398171529107, 199.6141158997234, 70.39999999999988, 6.299999999999997, 577.4089364686808, 523.1827175371687, 12.199999999999989, 179.81462450195497, 347.06288867501434, 220.57929645913723, 58.59672033293218, 97.24581481690109, 278.12715351190764, -5.056550371459867, 1.7622713514635464, 4.3000000000000025, 40.39999999999999, 1044.987362404717, 15.26344344462458, 1.627646485306814, 52.60402222495194, 292.65435122521876, 25.15442655854123, -71.82773559231266, 42.28978825194701, 2.7999999999999954, 16.01909210135408, 529.6370309509674, 27.462563412451356, 163.41695480584312, -44.00220856070891, 4.858310525899105, 63.50000000000082, 590.8877665300589, 362.0411228845995, 39.88581012035412, 218.8686346191448, 379.9973908025261, 37.64506594677756, 50.643437725338536, 142.3559290510691, -60.1848978679322, 342.1264651045967, 71.96692784510226, 227.91746369643312, 4.799999999999999, -234.31825323153677, 64.74387549782983, -54.099279133763815, 11.435240450726285, 356.4155891918862, 445.99878025911175, 7.5434616687053175, 218.3999999999987, 575.9368049890898, -3.826732583324606, 153.34790818218494, 110.22654553952192, -0.13421925939964718, 368.62061488221, 4.222162401073627, 611.335620039599, 108.98097092000445, 5.599999999999996, 11.68892364893456, -79.34407579668138, 738.5647251683627, 4.399999999999999, 364.3478406270377, 188.50048784593056, 15.634314792637472, 46.77050983124841, 728.8232714738026, 472.24852761323285, 185.36723399036447, 262.56447251090907, 215.97961742030537, 6.777561044831266, 66.60562762651023, 1.0999999999999996, 499.13496542596977, 1.699999999999999, -28.056907768787383, 104.54543447541137, 354.009738930454, 0.19478274494072334, 68.32246306959539, 2.799999999999999, 255.42010480912765, 160.27949636404335, 6.699999999999992, 252.89198100324808, 0.6000000000000014, -38.248068440163294, 96.2485203452254, 230.39834832118112, 69.16845339333277, 231.5196356424792, -83.75560429066006, -12.940901092414855], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [135.64702597462232, -811.9270986287705, -417.71781642562433, -452.9676971793527, -607.7697532850318, -664.4450477528336, -813.9186429329519, -790.5248451155933, -696.1548234137964, 291.3831752811599, -815.9919863782546, -212.63633877683623, -596.6114044789971, -846.3155898512598, -978.3361980050573, -107.7888630456043, -197.02423655816625, -752.4107738996864, -519.2214096476558, -43.21171873414738, -461.5654349122572, -611.0931825049298, -443.89852018258796, -682.4512168727066, 22.154782916186697, -1101.9108811331698, -50.37703133123626, -224.8330997171222, -583.198024854747, -601.8525803475441, -641.5550349972186, -546.218900186236, -328.9865319529184, -540.718902100662, 383.5313483765131, -833.4215295762851, -684.3689773278489, -148.26239116728703, -146.47505203052572, -542.8446228405444, -255.0004628529956, -572.0222618410816, -275.8920712940603, -868.3646299465872, -718.9574985882703, -59.41392199464616, -646.4312634720571, -623.7659490381452, -666.3482912119739, -599.2058133035625, -818.37984920824, -704.7042431180689, -623.4399229724424, -540.3187606359239, 46.81570903076661, -1027.4733512161072, -382.0222286945304, -841.3125517578919, -599.5694734232973, 0.035833348548322874, -296.31994909302574, -696.1549582114048, -754.0763745395043, -593.0999394390174, -237.96601986444358, -188.23445054424548, -816.7437584405185, 47.62523604897342, -287.5362379901396, -343.808219724945, -704.7111362727942, -290.6922881000062, -50.12636299602979, -473.408976896384, -1056.1205055762987, 40.0000000000003, -546.3071014329076, 12.599498393946677, -190.76503327476675, -620.3778058663452, -605.4560937983736, -889.8865594716542, -138.05694057998193, -661.1601135842986, 13.989025705790727, -863.4061199407761, -474.0844391699137, -774.4562609745843, 40.0000000000003, -986.5201939726503, -795.0273401914502, -916.7517920720518, -556.3965730899077, -337.9100491982282, -624.5762903354657, -827.6259631598632, -671.9148088041159, -383.56836854615494, -465.7421587649119, -831.5928201438561, -569.4208704480378, -206.16488188822174, -4.765449937786907, -902.4993551718562, -507.99735710940934, -570.748706823194, 176.73587976842796, 40.0000000000003, 40.0000000000003, -826.3982409913077, -669.636718173612, -995.0410475585202, -20.938351462083993, -742.0711055566542, -452.9821456297195, -640.2578694283344, -533.9631681671975, -737.8026657541909, -378.3155926750086, -358.9680452187627, -624.1366750852529, -681.6856732563692, -57.60629393905657, -865.0340027590051, -672.1906620070282, -528.6120917587522, -578.5883579021071, -651.7877818242625, -532.1995890125056, -670.723103705709, -415.55470382414654, -696.7851918773066, -1003.312799896253, 355.82427396219225, -778.595233097856, -770.5440040754307, -391.9739769424477, 105.61608227186586, -625.7039358606826, -851.8162310586999, -488.80845142372675, -462.96157772618375, -818.0844187535652, -534.1294383329437, -905.2985972291074, -93.81864584636901, -737.8840218956299, -23.973538931582276, -150.05121271376572, -875.7736285113577, -638.4308251030444, -489.8117413194341, -617.3818569164763, -12.538899060326164, -499.70916495698134, -562.322329058909, -455.26161771452337, -765.4382307641966, -778.6211199998097, -700.661876794911, -869.5026848404768, -461.75635264107177, -690.2448384237782, -832.0405870096157, -634.0502099556228, -430.20765538205086, -334.64795725578983, -522.6274753686982, -94.89597118597312, -855.5215763099874, -933.6489567001792, -723.4281041349146, -266.3702083268571, -838.6971829139501, -563.7791505334701, -837.7814562887878, -149.36999769897525, -772.6840061658008, -569.7991425243256, 14.654900926076436, -566.2224768016985, -815.6024236789829, 18.993058911611335, -775.917797251116, -615.7822147478925, -748.415286078326, -353.26415010546043, -633.3682278980197, -647.6360046436289, -479.6619109369389, -444.19269530723864, -676.0926767530948, 50.79062471563023, -690.0984021857961, -450.61218689407104, -709.3004700896759, -521.3658121936795, -675.4228264078016, -663.3573788015323, -187.19298991924364], "policy_predator_policy_reward": [311.2103536814661, 761.3037006879717, 382.032722139909, 688.2669073647935, 676.5697532850318, 666.0450477528337, 819.7186429329521, 791.0248451155933, 684.895608590762, 297.28497601055483, 838.3397999039015, 713.4712427883622, 607.2114044789994, 847.9155898512602, 900.7432286417958, 365.1964569108182, 558.5135670753579, 737.9843320575084, 547.2269509132241, 235.7854739277186, 516.2621552451892, 614.9931825049308, 288.3954363502029, 935.200115521996, 637.6711207318419, 720.2121309970534, 12.809698281885776, 257.3438823950105, 583.6980248547469, 603.1148516990083, 643.4550349972186, 548.6189001862364, 359.3865319529196, 550.7189021006621, 758.2301335776729, 736.6474100268142, 145.5970198555513, 702.2977920842086, 132.75035869787362, 558.1969626585042, 455.7634506516105, 423.86329626742, 814.776082763958, 622.1349697019125, 719.1574985882703, 84.36834855318614, 513.2943597654073, 685.0751171524821, 738.0403998796149, 569.8034928878704, 818.37984920824, 707.5042431180696, 636.039922972443, 543.7378527372779, 894.3464557444063, 615.9482173919016, 408.7847921069861, 842.0125517578921, 481.7558737250066, 281.19472115558744, 203.18554494687697, 745.287153796847, 754.9262717175646, 597.1083527868573, 14.766586323323832, 474.93388408536373, 528.1757763965664, 831.8305125250386, 382.16393840156417, 611.221642198119, 726.7980891108311, 308.49114538232607, 280.87180741358117, 461.5321670979844, 1008.4799190925952, 387.63797728623024, 569.5034231780555, 1.849245807684865, 242.85728213438392, 618.9289947320672, 841.8113747897464, 795.8872075313492, 77.5334216986364, 661.4987345977114, 825.8931284876729, 365.6504308519072, 546.6207683258515, 773.8868596637511, 856.4796054193451, 317.95805224973554, 799.1273401914511, 917.451792072052, 632.4276803679073, 27.56068868869738, 689.6695944490442, 827.2765345441187, 693.9556491501706, 307.42824906633535, 477.3628417553097, 831.4073776041866, 581.3204626496567, 550.6808788784848, 594.8409415167511, 758.4226438520031, 509.2933285601969, 576.996197041117, 1.664120231571943, 0.0, 628.6180203166779, 733.7170256637165, 665.8099855902872, 995.0410475585202, 205.19904184619088, 711.158323354732, 530.44487709328, 673.0216835042952, 674.3097281821119, 597.3218864798762, 459.71460164545374, 646.1896511305342, 625.5683030515968, 684.4762076911, 771.3307397032249, 762.6451770344354, 666.9390551837433, 642.8446695020467, 581.7883579021077, 654.1877818242627, 539.888512661442, 674.72310370571, 276.99245977513743, 756.0033601296338, 953.4944177507084, 432.55883335171166, 779.2952330978561, 774.2440040754313, 403.4060626212954, 247.29967267632398, 910.6296525912378, 755.3910021740724, 257.05463475688316, 710.3497091856672, 818.5844187535653, 580.3999481641921, 823.2630555985813, 904.6774589506953, 692.3131847485116, 541.7929036919282, 336.3148383081871, 874.877236907301, 646.5413491071589, 744.2656898262292, 600.6067018560085, 245.29367154109931, 503.7875006345786, 565.0215544261434, 520.2672453410348, 767.0382307641967, 779.7211199998097, 700.661876794911, 863.6055959968048, 966.7884069107023, 691.9448384237785, 832.0405870096157, 722.3273715587843, 313.8735860101082, 401.18208987598587, 560.6387772239159, 490.1261578018027, 814.3011286246103, 933.7113445526547, 723.5604990273798, 874.3322058101242, 299.05764850027765, 566.3791505334708, 837.9814562887879, 389.96824651826364, 787.5058621556416, 207.81143730126092, 507.61230066103184, 571.9224768016985, 816.6024236789829, 233.89892209163716, 775.917797251116, 616.2822147478926, 748.515286078326, 303.51608166529945, 644.8682278980206, 658.8076532953488, 564.7387826304408, 589.9783061490699, 760.7054142324461, 3.9909874803654835, 704.4852433831326, 721.3588722290222, 670.0734203972096, 415.04183508244574, 697.9911992283774, 726.3752371340909, 111.23423049426894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.677054522796241, "mean_inference_ms": 4.92888089830785, "mean_action_processing_ms": 1.8654781237099214, "mean_env_wait_ms": 13.144671980857385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005375981330871582, "StateBufferConnector_ms": 0.005698442459106445, "ViewRequirementAgentConnector_ms": 0.19332194328308105}, "num_episodes": 6, "episode_return_max": 1044.987362404717, "episode_return_min": -234.31825323153677, "episode_return_mean": 157.34958706139912, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.7828096609145, "num_env_steps_trained_throughput_per_sec": 152.7828096609145, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 26194.485, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26194.255, "sample_time_ms": 2367.567, "learn_time_ms": 23803.588, "learn_throughput": 168.042, "synch_weights_time_ms": 19.584}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-08-10", "timestamp": 1724384290, "time_this_iter_s": 26.23310089111328, "time_total_s": 2004.8369302749634, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095bf430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2004.8369302749634, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 36.02162162162162, "ram_util_percent": 82.7945945945946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.322806824830472, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.519665105506856, "policy_loss": -0.006204010991665421, "vf_loss": 7.525102879761388, "vf_explained_var": 0.055403428102927234, "kl": 0.007662430001550881, "entropy": 0.33525902838618665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 71348.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.570381382533483, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.858389221675813, "policy_loss": -0.007893236726029682, "vf_loss": 7.865355804988316, "vf_explained_var": 0.5236596073423113, "kl": 0.009266303856388996, "entropy": 0.44423349455550865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 71348.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 1044.987362404717, "episode_reward_min": -234.31825323153677, "episode_reward_mean": 140.5642625661373, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1079.5366396449476, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 383.5313483765131, "predator_policy": 1079.5366396449476}, "policy_reward_mean": {"prey_policy": -513.0996124297794, "predator_policy": 583.3817437128482}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.056550371459867, 1.7622713514635464, 4.3000000000000025, 40.39999999999999, 1044.987362404717, 15.26344344462458, 1.627646485306814, 52.60402222495194, 292.65435122521876, 25.15442655854123, -71.82773559231266, 42.28978825194701, 2.7999999999999954, 16.01909210135408, 529.6370309509674, 27.462563412451356, 163.41695480584312, -44.00220856070891, 4.858310525899105, 63.50000000000082, 590.8877665300589, 362.0411228845995, 39.88581012035412, 218.8686346191448, 379.9973908025261, 37.64506594677756, 50.643437725338536, 142.3559290510691, -60.1848978679322, 342.1264651045967, 71.96692784510226, 227.91746369643312, 4.799999999999999, -234.31825323153677, 64.74387549782983, -54.099279133763815, 11.435240450726285, 356.4155891918862, 445.99878025911175, 7.5434616687053175, 218.3999999999987, 575.9368049890898, -3.826732583324606, 153.34790818218494, 110.22654553952192, -0.13421925939964718, 368.62061488221, 4.222162401073627, 611.335620039599, 108.98097092000445, 5.599999999999996, 11.68892364893456, -79.34407579668138, 738.5647251683627, 4.399999999999999, 364.3478406270377, 188.50048784593056, 15.634314792637472, 46.77050983124841, 728.8232714738026, 472.24852761323285, 185.36723399036447, 262.56447251090907, 215.97961742030537, 6.777561044831266, 66.60562762651023, 1.0999999999999996, 499.13496542596977, 1.699999999999999, -28.056907768787383, 104.54543447541137, 354.009738930454, 0.19478274494072334, 68.32246306959539, 2.799999999999999, 255.42010480912765, 160.27949636404335, 6.699999999999992, 252.89198100324808, 0.6000000000000014, -38.248068440163294, 96.2485203452254, 230.39834832118112, 69.16845339333277, 231.5196356424792, -83.75560429066006, -12.940901092414855, 210.72984350877172, 5.575356250363328, 117.7, 398.4100218302533, 7.099999999999994, 69.28383759858856, 22.30000000000004, 312.5242518125231, -79.5439249007937, 235.0864530757464, -104.60576170658855, 251.33975441574103, -157.66603149207126], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-50.37703133123626, -224.8330997171222, -583.198024854747, -601.8525803475441, -641.5550349972186, -546.218900186236, -328.9865319529184, -540.718902100662, 383.5313483765131, -833.4215295762851, -684.3689773278489, -148.26239116728703, -146.47505203052572, -542.8446228405444, -255.0004628529956, -572.0222618410816, -275.8920712940603, -868.3646299465872, -718.9574985882703, -59.41392199464616, -646.4312634720571, -623.7659490381452, -666.3482912119739, -599.2058133035625, -818.37984920824, -704.7042431180689, -623.4399229724424, -540.3187606359239, 46.81570903076661, -1027.4733512161072, -382.0222286945304, -841.3125517578919, -599.5694734232973, 0.035833348548322874, -296.31994909302574, -696.1549582114048, -754.0763745395043, -593.0999394390174, -237.96601986444358, -188.23445054424548, -816.7437584405185, 47.62523604897342, -287.5362379901396, -343.808219724945, -704.7111362727942, -290.6922881000062, -50.12636299602979, -473.408976896384, -1056.1205055762987, 40.0000000000003, -546.3071014329076, 12.599498393946677, -190.76503327476675, -620.3778058663452, -605.4560937983736, -889.8865594716542, -138.05694057998193, -661.1601135842986, 13.989025705790727, -863.4061199407761, -474.0844391699137, -774.4562609745843, 40.0000000000003, -986.5201939726503, -795.0273401914502, -916.7517920720518, -556.3965730899077, -337.9100491982282, -624.5762903354657, -827.6259631598632, -671.9148088041159, -383.56836854615494, -465.7421587649119, -831.5928201438561, -569.4208704480378, -206.16488188822174, -4.765449937786907, -902.4993551718562, -507.99735710940934, -570.748706823194, 176.73587976842796, 40.0000000000003, 40.0000000000003, -826.3982409913077, -669.636718173612, -995.0410475585202, -20.938351462083993, -742.0711055566542, -452.9821456297195, -640.2578694283344, -533.9631681671975, -737.8026657541909, -378.3155926750086, -358.9680452187627, -624.1366750852529, -681.6856732563692, -57.60629393905657, -865.0340027590051, -672.1906620070282, -528.6120917587522, -578.5883579021071, -651.7877818242625, -532.1995890125056, -670.723103705709, -415.55470382414654, -696.7851918773066, -1003.312799896253, 355.82427396219225, -778.595233097856, -770.5440040754307, -391.9739769424477, 105.61608227186586, -625.7039358606826, -851.8162310586999, -488.80845142372675, -462.96157772618375, -818.0844187535652, -534.1294383329437, -905.2985972291074, -93.81864584636901, -737.8840218956299, -23.973538931582276, -150.05121271376572, -875.7736285113577, -638.4308251030444, -489.8117413194341, -617.3818569164763, -12.538899060326164, -499.70916495698134, -562.322329058909, -455.26161771452337, -765.4382307641966, -778.6211199998097, -700.661876794911, -869.5026848404768, -461.75635264107177, -690.2448384237782, -832.0405870096157, -634.0502099556228, -430.20765538205086, -334.64795725578983, -522.6274753686982, -94.89597118597312, -855.5215763099874, -933.6489567001792, -723.4281041349146, -266.3702083268571, -838.6971829139501, -563.7791505334701, -837.7814562887878, -149.36999769897525, -772.6840061658008, -569.7991425243256, 14.654900926076436, -566.2224768016985, -815.6024236789829, 18.993058911611335, -775.917797251116, -615.7822147478925, -748.415286078326, -353.26415010546043, -633.3682278980197, -647.6360046436289, -479.6619109369389, -444.19269530723864, -676.0926767530948, 50.79062471563023, -690.0984021857961, -450.61218689407104, -709.3004700896759, -521.3658121936795, -675.4228264078016, -663.3573788015323, -187.19298991924364, -313.6409476636847, -786.5665536874975, -831.59934709147, -547.8135722162923, -1079.5366396449476, -437.44216709313514, -238.47024466964695, -574.6065812858856, -567.6061137936049, -670.7760349162427, -845.1656893650385, -473.4773733690885, -268.59053328623145, -942.6754276344027, -339.6386233409419, -807.6534138853972, -397.5397849439021, -385.85877044491974, -693.4888594005291, -200.04277546334274, -343.19993349861016, -567.1103729578114, 54.16033643333982, -757.7332284527008, -521.1257522169044, -663.2758091821095], "policy_predator_policy_reward": [12.809698281885776, 257.3438823950105, 583.6980248547469, 603.1148516990083, 643.4550349972186, 548.6189001862364, 359.3865319529196, 550.7189021006621, 758.2301335776729, 736.6474100268142, 145.5970198555513, 702.2977920842086, 132.75035869787362, 558.1969626585042, 455.7634506516105, 423.86329626742, 814.776082763958, 622.1349697019125, 719.1574985882703, 84.36834855318614, 513.2943597654073, 685.0751171524821, 738.0403998796149, 569.8034928878704, 818.37984920824, 707.5042431180696, 636.039922972443, 543.7378527372779, 894.3464557444063, 615.9482173919016, 408.7847921069861, 842.0125517578921, 481.7558737250066, 281.19472115558744, 203.18554494687697, 745.287153796847, 754.9262717175646, 597.1083527868573, 14.766586323323832, 474.93388408536373, 528.1757763965664, 831.8305125250386, 382.16393840156417, 611.221642198119, 726.7980891108311, 308.49114538232607, 280.87180741358117, 461.5321670979844, 1008.4799190925952, 387.63797728623024, 569.5034231780555, 1.849245807684865, 242.85728213438392, 618.9289947320672, 841.8113747897464, 795.8872075313492, 77.5334216986364, 661.4987345977114, 825.8931284876729, 365.6504308519072, 546.6207683258515, 773.8868596637511, 856.4796054193451, 317.95805224973554, 799.1273401914511, 917.451792072052, 632.4276803679073, 27.56068868869738, 689.6695944490442, 827.2765345441187, 693.9556491501706, 307.42824906633535, 477.3628417553097, 831.4073776041866, 581.3204626496567, 550.6808788784848, 594.8409415167511, 758.4226438520031, 509.2933285601969, 576.996197041117, 1.664120231571943, 0.0, 628.6180203166779, 733.7170256637165, 665.8099855902872, 995.0410475585202, 205.19904184619088, 711.158323354732, 530.44487709328, 673.0216835042952, 674.3097281821119, 597.3218864798762, 459.71460164545374, 646.1896511305342, 625.5683030515968, 684.4762076911, 771.3307397032249, 762.6451770344354, 666.9390551837433, 642.8446695020467, 581.7883579021077, 654.1877818242627, 539.888512661442, 674.72310370571, 276.99245977513743, 756.0033601296338, 953.4944177507084, 432.55883335171166, 779.2952330978561, 774.2440040754313, 403.4060626212954, 247.29967267632398, 910.6296525912378, 755.3910021740724, 257.05463475688316, 710.3497091856672, 818.5844187535653, 580.3999481641921, 823.2630555985813, 904.6774589506953, 692.3131847485116, 541.7929036919282, 336.3148383081871, 874.877236907301, 646.5413491071589, 744.2656898262292, 600.6067018560085, 245.29367154109931, 503.7875006345786, 565.0215544261434, 520.2672453410348, 767.0382307641967, 779.7211199998097, 700.661876794911, 863.6055959968048, 966.7884069107023, 691.9448384237785, 832.0405870096157, 722.3273715587843, 313.8735860101082, 401.18208987598587, 560.6387772239159, 490.1261578018027, 814.3011286246103, 933.7113445526547, 723.5604990273798, 874.3322058101242, 299.05764850027765, 566.3791505334708, 837.9814562887879, 389.96824651826364, 787.5058621556416, 207.81143730126092, 507.61230066103184, 571.9224768016985, 816.6024236789829, 233.89892209163716, 775.917797251116, 616.2822147478926, 748.515286078326, 303.51608166529945, 644.8682278980206, 658.8076532953488, 564.7387826304408, 589.9783061490699, 760.7054142324461, 3.9909874803654835, 704.4852433831326, 721.3588722290222, 670.0734203972096, 415.04183508244574, 697.9911992283774, 726.3752371340909, 111.23423049426894, 574.1954424954451, 736.7419023645134, 831.5247033418334, 553.4635722162933, 1079.5366396449476, 555.1421670931364, 395.13218809459977, 816.3546596911856, 571.2061137936058, 674.2760349162435, 849.5334563180047, 538.3934440147133, 290.7905332862365, 942.7754276344027, 809.2830641059227, 650.5332249329341, 1.8998993229487044, 701.9547311650817, 715.592679812138, 413.0254081274782, 168.67238839106903, 637.0321563587693, 796.3952330314389, 158.51741340366112, 338.07593179560416, 688.6595981113413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.652040969169697, "mean_inference_ms": 4.910548041912122, "mean_action_processing_ms": 1.8592267474206883, "mean_env_wait_ms": 13.144919077123053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005155324935913086, "StateBufferConnector_ms": 0.011291980743408203, "ViewRequirementAgentConnector_ms": 0.19013679027557373}, "num_episodes": 13, "episode_return_max": 1044.987362404717, "episode_return_min": -234.31825323153677, "episode_return_mean": 140.5642625661373, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.92549262740582, "num_env_steps_trained_throughput_per_sec": 149.92549262740582, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 26204.301, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26204.06, "sample_time_ms": 2310.807, "learn_time_ms": 23868.646, "learn_throughput": 167.584, "synch_weights_time_ms": 20.643}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-08-37", "timestamp": 1724384317, "time_this_iter_s": 26.73151707649231, "time_total_s": 2031.5684473514557, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30960d5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2031.5684473514557, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 46.944736842105264, "ram_util_percent": 82.59736842105265}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.37082649135085, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.8731543964809845, "policy_loss": -0.006572317107822056, "vf_loss": 7.879084950906259, "vf_explained_var": 0.22146588986512844, "kl": 0.006417368037475855, "entropy": 0.31381548843371176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72293.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.558596613041306, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.669123361476514, "policy_loss": -0.010059827300054686, "vf_loss": 7.678168364933559, "vf_explained_var": 0.5447540803561135, "kl": 0.010148243590814884, "entropy": 0.515770740862246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72293.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 989.7167655431639, "episode_reward_min": -234.31825323153677, "episode_reward_mean": 158.6122881424119, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1079.5366396449476, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 384.0083686266236, "predator_policy": 1079.5366396449476}, "policy_reward_mean": {"prey_policy": -515.506427559238, "predator_policy": 594.8125716304443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [529.6370309509674, 27.462563412451356, 163.41695480584312, -44.00220856070891, 4.858310525899105, 63.50000000000082, 590.8877665300589, 362.0411228845995, 39.88581012035412, 218.8686346191448, 379.9973908025261, 37.64506594677756, 50.643437725338536, 142.3559290510691, -60.1848978679322, 342.1264651045967, 71.96692784510226, 227.91746369643312, 4.799999999999999, -234.31825323153677, 64.74387549782983, -54.099279133763815, 11.435240450726285, 356.4155891918862, 445.99878025911175, 7.5434616687053175, 218.3999999999987, 575.9368049890898, -3.826732583324606, 153.34790818218494, 110.22654553952192, -0.13421925939964718, 368.62061488221, 4.222162401073627, 611.335620039599, 108.98097092000445, 5.599999999999996, 11.68892364893456, -79.34407579668138, 738.5647251683627, 4.399999999999999, 364.3478406270377, 188.50048784593056, 15.634314792637472, 46.77050983124841, 728.8232714738026, 472.24852761323285, 185.36723399036447, 262.56447251090907, 215.97961742030537, 6.777561044831266, 66.60562762651023, 1.0999999999999996, 499.13496542596977, 1.699999999999999, -28.056907768787383, 104.54543447541137, 354.009738930454, 0.19478274494072334, 68.32246306959539, 2.799999999999999, 255.42010480912765, 160.27949636404335, 6.699999999999992, 252.89198100324808, 0.6000000000000014, -38.248068440163294, 96.2485203452254, 230.39834832118112, 69.16845339333277, 231.5196356424792, -83.75560429066006, -12.940901092414855, 210.72984350877172, 5.575356250363328, 117.7, 398.4100218302533, 7.099999999999994, 69.28383759858856, 22.30000000000004, 312.5242518125231, -79.5439249007937, 235.0864530757464, -104.60576170658855, 251.33975441574103, -157.66603149207126, 5.999999999999996, 11.599999999999971, 228.73717053974647, 457.42109069585183, -146.22626191915603, 150.34511411209917, 253.80208638980184, 31.37462765570249, 586.3452289154525, 5.299999999999999, 49.67819768911784, 141.9190418649236, 989.7167655431639, 501.7676142251051], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [46.81570903076661, -1027.4733512161072, -382.0222286945304, -841.3125517578919, -599.5694734232973, 0.035833348548322874, -296.31994909302574, -696.1549582114048, -754.0763745395043, -593.0999394390174, -237.96601986444358, -188.23445054424548, -816.7437584405185, 47.62523604897342, -287.5362379901396, -343.808219724945, -704.7111362727942, -290.6922881000062, -50.12636299602979, -473.408976896384, -1056.1205055762987, 40.0000000000003, -546.3071014329076, 12.599498393946677, -190.76503327476675, -620.3778058663452, -605.4560937983736, -889.8865594716542, -138.05694057998193, -661.1601135842986, 13.989025705790727, -863.4061199407761, -474.0844391699137, -774.4562609745843, 40.0000000000003, -986.5201939726503, -795.0273401914502, -916.7517920720518, -556.3965730899077, -337.9100491982282, -624.5762903354657, -827.6259631598632, -671.9148088041159, -383.56836854615494, -465.7421587649119, -831.5928201438561, -569.4208704480378, -206.16488188822174, -4.765449937786907, -902.4993551718562, -507.99735710940934, -570.748706823194, 176.73587976842796, 40.0000000000003, 40.0000000000003, -826.3982409913077, -669.636718173612, -995.0410475585202, -20.938351462083993, -742.0711055566542, -452.9821456297195, -640.2578694283344, -533.9631681671975, -737.8026657541909, -378.3155926750086, -358.9680452187627, -624.1366750852529, -681.6856732563692, -57.60629393905657, -865.0340027590051, -672.1906620070282, -528.6120917587522, -578.5883579021071, -651.7877818242625, -532.1995890125056, -670.723103705709, -415.55470382414654, -696.7851918773066, -1003.312799896253, 355.82427396219225, -778.595233097856, -770.5440040754307, -391.9739769424477, 105.61608227186586, -625.7039358606826, -851.8162310586999, -488.80845142372675, -462.96157772618375, -818.0844187535652, -534.1294383329437, -905.2985972291074, -93.81864584636901, -737.8840218956299, -23.973538931582276, -150.05121271376572, -875.7736285113577, -638.4308251030444, -489.8117413194341, -617.3818569164763, -12.538899060326164, -499.70916495698134, -562.322329058909, -455.26161771452337, -765.4382307641966, -778.6211199998097, -700.661876794911, -869.5026848404768, -461.75635264107177, -690.2448384237782, -832.0405870096157, -634.0502099556228, -430.20765538205086, -334.64795725578983, -522.6274753686982, -94.89597118597312, -855.5215763099874, -933.6489567001792, -723.4281041349146, -266.3702083268571, -838.6971829139501, -563.7791505334701, -837.7814562887878, -149.36999769897525, -772.6840061658008, -569.7991425243256, 14.654900926076436, -566.2224768016985, -815.6024236789829, 18.993058911611335, -775.917797251116, -615.7822147478925, -748.415286078326, -353.26415010546043, -633.3682278980197, -647.6360046436289, -479.6619109369389, -444.19269530723864, -676.0926767530948, 50.79062471563023, -690.0984021857961, -450.61218689407104, -709.3004700896759, -521.3658121936795, -675.4228264078016, -663.3573788015323, -187.19298991924364, -313.6409476636847, -786.5665536874975, -831.59934709147, -547.8135722162923, -1079.5366396449476, -437.44216709313514, -238.47024466964695, -574.6065812858856, -567.6061137936049, -670.7760349162427, -845.1656893650385, -473.4773733690885, -268.59053328623145, -942.6754276344027, -339.6386233409419, -807.6534138853972, -397.5397849439021, -385.85877044491974, -693.4888594005291, -200.04277546334274, -343.19993349861016, -567.1103729578114, 54.16033643333982, -757.7332284527008, -521.1257522169044, -663.2758091821095, -626.3004229193764, -766.3798861507651, -584.2510019980119, -848.1745367552084, -799.2456790295375, -452.295608886865, -766.6783949882365, -321.5366887345418, -478.82488416980283, -456.86593565447276, -805.1805255183158, 5.268849585186713, -834.8840572474014, -186.45649816266885, -289.4378787072217, -378.9853082421121, 325.1332588484207, -846.8844335538031, -580.9625658235076, -720.070707129705, -672.0617846434346, -212.11411040693412, -711.3104459795835, -719.1516902909682, 384.0083686266236, -661.4558592859527, -822.8214038289516, -115.26946437629408], "policy_predator_policy_reward": [894.3464557444063, 615.9482173919016, 408.7847921069861, 842.0125517578921, 481.7558737250066, 281.19472115558744, 203.18554494687697, 745.287153796847, 754.9262717175646, 597.1083527868573, 14.766586323323832, 474.93388408536373, 528.1757763965664, 831.8305125250386, 382.16393840156417, 611.221642198119, 726.7980891108311, 308.49114538232607, 280.87180741358117, 461.5321670979844, 1008.4799190925952, 387.63797728623024, 569.5034231780555, 1.849245807684865, 242.85728213438392, 618.9289947320672, 841.8113747897464, 795.8872075313492, 77.5334216986364, 661.4987345977114, 825.8931284876729, 365.6504308519072, 546.6207683258515, 773.8868596637511, 856.4796054193451, 317.95805224973554, 799.1273401914511, 917.451792072052, 632.4276803679073, 27.56068868869738, 689.6695944490442, 827.2765345441187, 693.9556491501706, 307.42824906633535, 477.3628417553097, 831.4073776041866, 581.3204626496567, 550.6808788784848, 594.8409415167511, 758.4226438520031, 509.2933285601969, 576.996197041117, 1.664120231571943, 0.0, 628.6180203166779, 733.7170256637165, 665.8099855902872, 995.0410475585202, 205.19904184619088, 711.158323354732, 530.44487709328, 673.0216835042952, 674.3097281821119, 597.3218864798762, 459.71460164545374, 646.1896511305342, 625.5683030515968, 684.4762076911, 771.3307397032249, 762.6451770344354, 666.9390551837433, 642.8446695020467, 581.7883579021077, 654.1877818242627, 539.888512661442, 674.72310370571, 276.99245977513743, 756.0033601296338, 953.4944177507084, 432.55883335171166, 779.2952330978561, 774.2440040754313, 403.4060626212954, 247.29967267632398, 910.6296525912378, 755.3910021740724, 257.05463475688316, 710.3497091856672, 818.5844187535653, 580.3999481641921, 823.2630555985813, 904.6774589506953, 692.3131847485116, 541.7929036919282, 336.3148383081871, 874.877236907301, 646.5413491071589, 744.2656898262292, 600.6067018560085, 245.29367154109931, 503.7875006345786, 565.0215544261434, 520.2672453410348, 767.0382307641967, 779.7211199998097, 700.661876794911, 863.6055959968048, 966.7884069107023, 691.9448384237785, 832.0405870096157, 722.3273715587843, 313.8735860101082, 401.18208987598587, 560.6387772239159, 490.1261578018027, 814.3011286246103, 933.7113445526547, 723.5604990273798, 874.3322058101242, 299.05764850027765, 566.3791505334708, 837.9814562887879, 389.96824651826364, 787.5058621556416, 207.81143730126092, 507.61230066103184, 571.9224768016985, 816.6024236789829, 233.89892209163716, 775.917797251116, 616.2822147478926, 748.515286078326, 303.51608166529945, 644.8682278980206, 658.8076532953488, 564.7387826304408, 589.9783061490699, 760.7054142324461, 3.9909874803654835, 704.4852433831326, 721.3588722290222, 670.0734203972096, 415.04183508244574, 697.9911992283774, 726.3752371340909, 111.23423049426894, 574.1954424954451, 736.7419023645134, 831.5247033418334, 553.4635722162933, 1079.5366396449476, 555.1421670931364, 395.13218809459977, 816.3546596911856, 571.2061137936058, 674.2760349162435, 849.5334563180047, 538.3934440147133, 290.7905332862365, 942.7754276344027, 809.2830641059227, 650.5332249329341, 1.8998993229487044, 701.9547311650817, 715.592679812138, 413.0254081274782, 168.67238839106903, 637.0321563587693, 796.3952330314389, 158.51741340366112, 338.07593179560416, 688.6595981113413, 630.5004229193771, 768.1798861507655, 591.6510019980125, 852.3745367552089, 795.9648948116998, 684.3135636444482, 785.2372825491916, 760.3988918694408, 659.1222405787889, 130.34231732633148, 793.7308962389977, 156.52589380623164, 696.6979204766129, 578.4447213232588, 24.175811105818205, 675.6220034992231, 786.3992065663666, 321.6971970544668, 584.7625658235077, 721.5707071297053, 642.8608399466812, 290.9932527928065, 762.0416908265261, 810.3394873089512, 637.8536954437246, 629.3105607587687, 699.6207551485752, 740.2377272817791]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6487381666229295, "mean_inference_ms": 4.903610384040964, "mean_action_processing_ms": 1.8327484204901965, "mean_env_wait_ms": 13.132798899062234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060051679611206055, "StateBufferConnector_ms": 0.011384844779968262, "ViewRequirementAgentConnector_ms": 0.19680416584014893}, "num_episodes": 14, "episode_return_max": 989.7167655431639, "episode_return_min": -234.31825323153677, "episode_return_mean": 158.6122881424119, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.45139635472896, "num_env_steps_trained_throughput_per_sec": 150.45139635472896, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 26220.879, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26220.624, "sample_time_ms": 2336.35, "learn_time_ms": 23857.598, "learn_throughput": 167.661, "synch_weights_time_ms": 22.486}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-09-04", "timestamp": 1724384344, "time_this_iter_s": 26.633035898208618, "time_total_s": 2058.2014832496643, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309604040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2058.2014832496643, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 37.165789473684214, "ram_util_percent": 83.31578947368423}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.77183288745779, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.829338428961537, "policy_loss": -0.0062268592215207206, "vf_loss": 7.834984829816869, "vf_explained_var": 0.09920383262886572, "kl": 0.005804849793104623, "entropy": 0.25823857934071276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 73238.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.287046288182495, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.8070297004053835, "policy_loss": -0.0072270296740705375, "vf_loss": 7.813398229508173, "vf_explained_var": 0.4176994758308249, "kl": 0.008585010738008552, "entropy": 0.4476245738841869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 73238.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 989.7167655431639, "episode_reward_min": -234.31825323153677, "episode_reward_mean": 161.35830714808827, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1079.5366396449476, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 384.0083686266236, "predator_policy": 1079.5366396449476}, "policy_reward_mean": {"prey_policy": -514.1376836405237, "predator_policy": 594.8168372145682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.1848978679322, 342.1264651045967, 71.96692784510226, 227.91746369643312, 4.799999999999999, -234.31825323153677, 64.74387549782983, -54.099279133763815, 11.435240450726285, 356.4155891918862, 445.99878025911175, 7.5434616687053175, 218.3999999999987, 575.9368049890898, -3.826732583324606, 153.34790818218494, 110.22654553952192, -0.13421925939964718, 368.62061488221, 4.222162401073627, 611.335620039599, 108.98097092000445, 5.599999999999996, 11.68892364893456, -79.34407579668138, 738.5647251683627, 4.399999999999999, 364.3478406270377, 188.50048784593056, 15.634314792637472, 46.77050983124841, 728.8232714738026, 472.24852761323285, 185.36723399036447, 262.56447251090907, 215.97961742030537, 6.777561044831266, 66.60562762651023, 1.0999999999999996, 499.13496542596977, 1.699999999999999, -28.056907768787383, 104.54543447541137, 354.009738930454, 0.19478274494072334, 68.32246306959539, 2.799999999999999, 255.42010480912765, 160.27949636404335, 6.699999999999992, 252.89198100324808, 0.6000000000000014, -38.248068440163294, 96.2485203452254, 230.39834832118112, 69.16845339333277, 231.5196356424792, -83.75560429066006, -12.940901092414855, 210.72984350877172, 5.575356250363328, 117.7, 398.4100218302533, 7.099999999999994, 69.28383759858856, 22.30000000000004, 312.5242518125231, -79.5439249007937, 235.0864530757464, -104.60576170658855, 251.33975441574103, -157.66603149207126, 5.999999999999996, 11.599999999999971, 228.73717053974647, 457.42109069585183, -146.22626191915603, 150.34511411209917, 253.80208638980184, 31.37462765570249, 586.3452289154525, 5.299999999999999, 49.67819768911784, 141.9190418649236, 989.7167655431639, 501.7676142251051, 149.86243117101432, 124.59720469133086, 298.9987577818114, 51.603454709272974, 165.85802013594596, 59.75140178710055, 507.6926817070609, 439.6418170550578, 131.618367606821, 180.5092134642167, 46.07583997001697, 361.8729891347765, 313.37251522648194, 10.345014941052877], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-138.05694057998193, -661.1601135842986, 13.989025705790727, -863.4061199407761, -474.0844391699137, -774.4562609745843, 40.0000000000003, -986.5201939726503, -795.0273401914502, -916.7517920720518, -556.3965730899077, -337.9100491982282, -624.5762903354657, -827.6259631598632, -671.9148088041159, -383.56836854615494, -465.7421587649119, -831.5928201438561, -569.4208704480378, -206.16488188822174, -4.765449937786907, -902.4993551718562, -507.99735710940934, -570.748706823194, 176.73587976842796, 40.0000000000003, 40.0000000000003, -826.3982409913077, -669.636718173612, -995.0410475585202, -20.938351462083993, -742.0711055566542, -452.9821456297195, -640.2578694283344, -533.9631681671975, -737.8026657541909, -378.3155926750086, -358.9680452187627, -624.1366750852529, -681.6856732563692, -57.60629393905657, -865.0340027590051, -672.1906620070282, -528.6120917587522, -578.5883579021071, -651.7877818242625, -532.1995890125056, -670.723103705709, -415.55470382414654, -696.7851918773066, -1003.312799896253, 355.82427396219225, -778.595233097856, -770.5440040754307, -391.9739769424477, 105.61608227186586, -625.7039358606826, -851.8162310586999, -488.80845142372675, -462.96157772618375, -818.0844187535652, -534.1294383329437, -905.2985972291074, -93.81864584636901, -737.8840218956299, -23.973538931582276, -150.05121271376572, -875.7736285113577, -638.4308251030444, -489.8117413194341, -617.3818569164763, -12.538899060326164, -499.70916495698134, -562.322329058909, -455.26161771452337, -765.4382307641966, -778.6211199998097, -700.661876794911, -869.5026848404768, -461.75635264107177, -690.2448384237782, -832.0405870096157, -634.0502099556228, -430.20765538205086, -334.64795725578983, -522.6274753686982, -94.89597118597312, -855.5215763099874, -933.6489567001792, -723.4281041349146, -266.3702083268571, -838.6971829139501, -563.7791505334701, -837.7814562887878, -149.36999769897525, -772.6840061658008, -569.7991425243256, 14.654900926076436, -566.2224768016985, -815.6024236789829, 18.993058911611335, -775.917797251116, -615.7822147478925, -748.415286078326, -353.26415010546043, -633.3682278980197, -647.6360046436289, -479.6619109369389, -444.19269530723864, -676.0926767530948, 50.79062471563023, -690.0984021857961, -450.61218689407104, -709.3004700896759, -521.3658121936795, -675.4228264078016, -663.3573788015323, -187.19298991924364, -313.6409476636847, -786.5665536874975, -831.59934709147, -547.8135722162923, -1079.5366396449476, -437.44216709313514, -238.47024466964695, -574.6065812858856, -567.6061137936049, -670.7760349162427, -845.1656893650385, -473.4773733690885, -268.59053328623145, -942.6754276344027, -339.6386233409419, -807.6534138853972, -397.5397849439021, -385.85877044491974, -693.4888594005291, -200.04277546334274, -343.19993349861016, -567.1103729578114, 54.16033643333982, -757.7332284527008, -521.1257522169044, -663.2758091821095, -626.3004229193764, -766.3798861507651, -584.2510019980119, -848.1745367552084, -799.2456790295375, -452.295608886865, -766.6783949882365, -321.5366887345418, -478.82488416980283, -456.86593565447276, -805.1805255183158, 5.268849585186713, -834.8840572474014, -186.45649816266885, -289.4378787072217, -378.9853082421121, 325.1332588484207, -846.8844335538031, -580.9625658235076, -720.070707129705, -672.0617846434346, -212.11411040693412, -711.3104459795835, -719.1516902909682, 384.0083686266236, -661.4558592859527, -822.8214038289516, -115.26946437629408, -86.12165462750065, -781.9632613046144, -227.82518424927787, -55.75207995931391, -714.8632806106824, -251.98993433309587, -177.7554684275561, -262.6066330310738, -76.61134077433398, -989.698024018827, -426.9933433703012, -928.3859640822808, 310.8391942553525, -705.8672536469688, -661.4461730437496, -460.24611345689533, -376.44576924432977, -641.6683613344019, -539.8483781092077, -607.0001343990149, -775.3801849794144, -352.3185819362637, 5.66648507516828, -536.8115162028488, 232.4437533076101, -597.90640408118, -637.9830371226305, -746.8056723519152], "policy_predator_policy_reward": [77.5334216986364, 661.4987345977114, 825.8931284876729, 365.6504308519072, 546.6207683258515, 773.8868596637511, 856.4796054193451, 317.95805224973554, 799.1273401914511, 917.451792072052, 632.4276803679073, 27.56068868869738, 689.6695944490442, 827.2765345441187, 693.9556491501706, 307.42824906633535, 477.3628417553097, 831.4073776041866, 581.3204626496567, 550.6808788784848, 594.8409415167511, 758.4226438520031, 509.2933285601969, 576.996197041117, 1.664120231571943, 0.0, 628.6180203166779, 733.7170256637165, 665.8099855902872, 995.0410475585202, 205.19904184619088, 711.158323354732, 530.44487709328, 673.0216835042952, 674.3097281821119, 597.3218864798762, 459.71460164545374, 646.1896511305342, 625.5683030515968, 684.4762076911, 771.3307397032249, 762.6451770344354, 666.9390551837433, 642.8446695020467, 581.7883579021077, 654.1877818242627, 539.888512661442, 674.72310370571, 276.99245977513743, 756.0033601296338, 953.4944177507084, 432.55883335171166, 779.2952330978561, 774.2440040754313, 403.4060626212954, 247.29967267632398, 910.6296525912378, 755.3910021740724, 257.05463475688316, 710.3497091856672, 818.5844187535653, 580.3999481641921, 823.2630555985813, 904.6774589506953, 692.3131847485116, 541.7929036919282, 336.3148383081871, 874.877236907301, 646.5413491071589, 744.2656898262292, 600.6067018560085, 245.29367154109931, 503.7875006345786, 565.0215544261434, 520.2672453410348, 767.0382307641967, 779.7211199998097, 700.661876794911, 863.6055959968048, 966.7884069107023, 691.9448384237785, 832.0405870096157, 722.3273715587843, 313.8735860101082, 401.18208987598587, 560.6387772239159, 490.1261578018027, 814.3011286246103, 933.7113445526547, 723.5604990273798, 874.3322058101242, 299.05764850027765, 566.3791505334708, 837.9814562887879, 389.96824651826364, 787.5058621556416, 207.81143730126092, 507.61230066103184, 571.9224768016985, 816.6024236789829, 233.89892209163716, 775.917797251116, 616.2822147478926, 748.515286078326, 303.51608166529945, 644.8682278980206, 658.8076532953488, 564.7387826304408, 589.9783061490699, 760.7054142324461, 3.9909874803654835, 704.4852433831326, 721.3588722290222, 670.0734203972096, 415.04183508244574, 697.9911992283774, 726.3752371340909, 111.23423049426894, 574.1954424954451, 736.7419023645134, 831.5247033418334, 553.4635722162933, 1079.5366396449476, 555.1421670931364, 395.13218809459977, 816.3546596911856, 571.2061137936058, 674.2760349162435, 849.5334563180047, 538.3934440147133, 290.7905332862365, 942.7754276344027, 809.2830641059227, 650.5332249329341, 1.8998993229487044, 701.9547311650817, 715.592679812138, 413.0254081274782, 168.67238839106903, 637.0321563587693, 796.3952330314389, 158.51741340366112, 338.07593179560416, 688.6595981113413, 630.5004229193771, 768.1798861507655, 591.6510019980125, 852.3745367552089, 795.9648948116998, 684.3135636444482, 785.2372825491916, 760.3988918694408, 659.1222405787889, 130.34231732633148, 793.7308962389977, 156.52589380623164, 696.6979204766129, 578.4447213232588, 24.175811105818205, 675.6220034992231, 786.3992065663666, 321.6971970544668, 584.7625658235077, 721.5707071297053, 642.8608399466812, 290.9932527928065, 762.0416908265261, 810.3394873089512, 637.8536954437246, 629.3105607587687, 699.6207551485752, 740.2377272817791, 262.37852030822216, 755.5688267949079, 253.4251842492764, 154.74928465064662, 616.9372008821342, 648.9147718434612, 449.40246418432355, 42.56309198358335, 606.4552129713751, 625.7121719577314, 526.2752029151545, 888.8555063245308, 143.6994141453392, 759.0213269533368, 584.1657996316974, 977.1683039240057, 491.72860294521814, 658.0038952403359, 876.5876813787586, 450.7700445936808, 669.8409053264774, 503.9337015592213, 421.1784238925053, 471.8395963699512, 512.4942033112127, 166.34096268883903, 681.7153438275172, 713.4183805880801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.62203965854299, "mean_inference_ms": 4.891737183918972, "mean_action_processing_ms": 1.838003812948339, "mean_env_wait_ms": 13.139306019477367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005980134010314941, "StateBufferConnector_ms": 0.010168075561523438, "ViewRequirementAgentConnector_ms": 0.180739164352417}, "num_episodes": 14, "episode_return_max": 989.7167655431639, "episode_return_min": -234.31825323153677, "episode_return_mean": 161.35830714808827, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.60685667050564, "num_env_steps_trained_throughput_per_sec": 152.60685667050564, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 26264.326, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26264.071, "sample_time_ms": 2357.118, "learn_time_ms": 23881.102, "learn_throughput": 167.496, "synch_weights_time_ms": 21.444}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-09-30", "timestamp": 1724384370, "time_this_iter_s": 26.26301097869873, "time_total_s": 2084.464494228363, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b08bbca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2084.464494228363, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 33.6054054054054, "ram_util_percent": 82.47297297297295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.15860760047953, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.951335290878538, "policy_loss": -0.009724403117788296, "vf_loss": 7.960132780024614, "vf_explained_var": 0.029329118085285974, "kl": 0.009269361197394098, "entropy": 0.24494731692725388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74183.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.54629089718773, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.132280819504349, "policy_loss": -0.010645221797601571, "vf_loss": 8.141885799831813, "vf_explained_var": 0.5094146046688948, "kl": 0.010402561418179955, "entropy": 0.4272954715938164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74183.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 989.7167655431639, "episode_reward_min": -234.31825323153677, "episode_reward_mean": 162.27150725230456, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1079.5366396449476, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 384.70000000000016, "predator_policy": 1079.5366396449476}, "policy_reward_mean": {"prey_policy": -511.66886048700223, "predator_policy": 592.8046141131549}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.91746369643312, 4.799999999999999, -234.31825323153677, 64.74387549782983, -54.099279133763815, 11.435240450726285, 356.4155891918862, 445.99878025911175, 7.5434616687053175, 218.3999999999987, 575.9368049890898, -3.826732583324606, 153.34790818218494, 110.22654553952192, -0.13421925939964718, 368.62061488221, 4.222162401073627, 611.335620039599, 108.98097092000445, 5.599999999999996, 11.68892364893456, -79.34407579668138, 738.5647251683627, 4.399999999999999, 364.3478406270377, 188.50048784593056, 15.634314792637472, 46.77050983124841, 728.8232714738026, 472.24852761323285, 185.36723399036447, 262.56447251090907, 215.97961742030537, 6.777561044831266, 66.60562762651023, 1.0999999999999996, 499.13496542596977, 1.699999999999999, -28.056907768787383, 104.54543447541137, 354.009738930454, 0.19478274494072334, 68.32246306959539, 2.799999999999999, 255.42010480912765, 160.27949636404335, 6.699999999999992, 252.89198100324808, 0.6000000000000014, -38.248068440163294, 96.2485203452254, 230.39834832118112, 69.16845339333277, 231.5196356424792, -83.75560429066006, -12.940901092414855, 210.72984350877172, 5.575356250363328, 117.7, 398.4100218302533, 7.099999999999994, 69.28383759858856, 22.30000000000004, 312.5242518125231, -79.5439249007937, 235.0864530757464, -104.60576170658855, 251.33975441574103, -157.66603149207126, 5.999999999999996, 11.599999999999971, 228.73717053974647, 457.42109069585183, -146.22626191915603, 150.34511411209917, 253.80208638980184, 31.37462765570249, 586.3452289154525, 5.299999999999999, 49.67819768911784, 141.9190418649236, 989.7167655431639, 501.7676142251051, 149.86243117101432, 124.59720469133086, 298.9987577818114, 51.603454709272974, 165.85802013594596, 59.75140178710055, 507.6926817070609, 439.6418170550578, 131.618367606821, 180.5092134642167, 46.07583997001697, 361.8729891347765, 313.37251522648194, 10.345014941052877, 54.000000000000085, -6.371494496605591, 397.600000000001], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [40.0000000000003, -986.5201939726503, -795.0273401914502, -916.7517920720518, -556.3965730899077, -337.9100491982282, -624.5762903354657, -827.6259631598632, -671.9148088041159, -383.56836854615494, -465.7421587649119, -831.5928201438561, -569.4208704480378, -206.16488188822174, -4.765449937786907, -902.4993551718562, -507.99735710940934, -570.748706823194, 176.73587976842796, 40.0000000000003, 40.0000000000003, -826.3982409913077, -669.636718173612, -995.0410475585202, -20.938351462083993, -742.0711055566542, -452.9821456297195, -640.2578694283344, -533.9631681671975, -737.8026657541909, -378.3155926750086, -358.9680452187627, -624.1366750852529, -681.6856732563692, -57.60629393905657, -865.0340027590051, -672.1906620070282, -528.6120917587522, -578.5883579021071, -651.7877818242625, -532.1995890125056, -670.723103705709, -415.55470382414654, -696.7851918773066, -1003.312799896253, 355.82427396219225, -778.595233097856, -770.5440040754307, -391.9739769424477, 105.61608227186586, -625.7039358606826, -851.8162310586999, -488.80845142372675, -462.96157772618375, -818.0844187535652, -534.1294383329437, -905.2985972291074, -93.81864584636901, -737.8840218956299, -23.973538931582276, -150.05121271376572, -875.7736285113577, -638.4308251030444, -489.8117413194341, -617.3818569164763, -12.538899060326164, -499.70916495698134, -562.322329058909, -455.26161771452337, -765.4382307641966, -778.6211199998097, -700.661876794911, -869.5026848404768, -461.75635264107177, -690.2448384237782, -832.0405870096157, -634.0502099556228, -430.20765538205086, -334.64795725578983, -522.6274753686982, -94.89597118597312, -855.5215763099874, -933.6489567001792, -723.4281041349146, -266.3702083268571, -838.6971829139501, -563.7791505334701, -837.7814562887878, -149.36999769897525, -772.6840061658008, -569.7991425243256, 14.654900926076436, -566.2224768016985, -815.6024236789829, 18.993058911611335, -775.917797251116, -615.7822147478925, -748.415286078326, -353.26415010546043, -633.3682278980197, -647.6360046436289, -479.6619109369389, -444.19269530723864, -676.0926767530948, 50.79062471563023, -690.0984021857961, -450.61218689407104, -709.3004700896759, -521.3658121936795, -675.4228264078016, -663.3573788015323, -187.19298991924364, -313.6409476636847, -786.5665536874975, -831.59934709147, -547.8135722162923, -1079.5366396449476, -437.44216709313514, -238.47024466964695, -574.6065812858856, -567.6061137936049, -670.7760349162427, -845.1656893650385, -473.4773733690885, -268.59053328623145, -942.6754276344027, -339.6386233409419, -807.6534138853972, -397.5397849439021, -385.85877044491974, -693.4888594005291, -200.04277546334274, -343.19993349861016, -567.1103729578114, 54.16033643333982, -757.7332284527008, -521.1257522169044, -663.2758091821095, -626.3004229193764, -766.3798861507651, -584.2510019980119, -848.1745367552084, -799.2456790295375, -452.295608886865, -766.6783949882365, -321.5366887345418, -478.82488416980283, -456.86593565447276, -805.1805255183158, 5.268849585186713, -834.8840572474014, -186.45649816266885, -289.4378787072217, -378.9853082421121, 325.1332588484207, -846.8844335538031, -580.9625658235076, -720.070707129705, -672.0617846434346, -212.11411040693412, -711.3104459795835, -719.1516902909682, 384.0083686266236, -661.4558592859527, -822.8214038289516, -115.26946437629408, -86.12165462750065, -781.9632613046144, -227.82518424927787, -55.75207995931391, -714.8632806106824, -251.98993433309587, -177.7554684275561, -262.6066330310738, -76.61134077433398, -989.698024018827, -426.9933433703012, -928.3859640822808, 310.8391942553525, -705.8672536469688, -661.4461730437496, -460.24611345689533, -376.44576924432977, -641.6683613344019, -539.8483781092077, -607.0001343990149, -775.3801849794144, -352.3185819362637, 5.66648507516828, -536.8115162028488, 232.4437533076101, -597.90640408118, -637.9830371226305, -746.8056723519152, -701.571533851645, -559.0385075701496, -290.3763972588308, -634.518162390005, 384.70000000000016, -602.6056167688397], "policy_predator_policy_reward": [856.4796054193451, 317.95805224973554, 799.1273401914511, 917.451792072052, 632.4276803679073, 27.56068868869738, 689.6695944490442, 827.2765345441187, 693.9556491501706, 307.42824906633535, 477.3628417553097, 831.4073776041866, 581.3204626496567, 550.6808788784848, 594.8409415167511, 758.4226438520031, 509.2933285601969, 576.996197041117, 1.664120231571943, 0.0, 628.6180203166779, 733.7170256637165, 665.8099855902872, 995.0410475585202, 205.19904184619088, 711.158323354732, 530.44487709328, 673.0216835042952, 674.3097281821119, 597.3218864798762, 459.71460164545374, 646.1896511305342, 625.5683030515968, 684.4762076911, 771.3307397032249, 762.6451770344354, 666.9390551837433, 642.8446695020467, 581.7883579021077, 654.1877818242627, 539.888512661442, 674.72310370571, 276.99245977513743, 756.0033601296338, 953.4944177507084, 432.55883335171166, 779.2952330978561, 774.2440040754313, 403.4060626212954, 247.29967267632398, 910.6296525912378, 755.3910021740724, 257.05463475688316, 710.3497091856672, 818.5844187535653, 580.3999481641921, 823.2630555985813, 904.6774589506953, 692.3131847485116, 541.7929036919282, 336.3148383081871, 874.877236907301, 646.5413491071589, 744.2656898262292, 600.6067018560085, 245.29367154109931, 503.7875006345786, 565.0215544261434, 520.2672453410348, 767.0382307641967, 779.7211199998097, 700.661876794911, 863.6055959968048, 966.7884069107023, 691.9448384237785, 832.0405870096157, 722.3273715587843, 313.8735860101082, 401.18208987598587, 560.6387772239159, 490.1261578018027, 814.3011286246103, 933.7113445526547, 723.5604990273798, 874.3322058101242, 299.05764850027765, 566.3791505334708, 837.9814562887879, 389.96824651826364, 787.5058621556416, 207.81143730126092, 507.61230066103184, 571.9224768016985, 816.6024236789829, 233.89892209163716, 775.917797251116, 616.2822147478926, 748.515286078326, 303.51608166529945, 644.8682278980206, 658.8076532953488, 564.7387826304408, 589.9783061490699, 760.7054142324461, 3.9909874803654835, 704.4852433831326, 721.3588722290222, 670.0734203972096, 415.04183508244574, 697.9911992283774, 726.3752371340909, 111.23423049426894, 574.1954424954451, 736.7419023645134, 831.5247033418334, 553.4635722162933, 1079.5366396449476, 555.1421670931364, 395.13218809459977, 816.3546596911856, 571.2061137936058, 674.2760349162435, 849.5334563180047, 538.3934440147133, 290.7905332862365, 942.7754276344027, 809.2830641059227, 650.5332249329341, 1.8998993229487044, 701.9547311650817, 715.592679812138, 413.0254081274782, 168.67238839106903, 637.0321563587693, 796.3952330314389, 158.51741340366112, 338.07593179560416, 688.6595981113413, 630.5004229193771, 768.1798861507655, 591.6510019980125, 852.3745367552089, 795.9648948116998, 684.3135636444482, 785.2372825491916, 760.3988918694408, 659.1222405787889, 130.34231732633148, 793.7308962389977, 156.52589380623164, 696.6979204766129, 578.4447213232588, 24.175811105818205, 675.6220034992231, 786.3992065663666, 321.6971970544668, 584.7625658235077, 721.5707071297053, 642.8608399466812, 290.9932527928065, 762.0416908265261, 810.3394873089512, 637.8536954437246, 629.3105607587687, 699.6207551485752, 740.2377272817791, 262.37852030822216, 755.5688267949079, 253.4251842492764, 154.74928465064662, 616.9372008821342, 648.9147718434612, 449.40246418432355, 42.56309198358335, 606.4552129713751, 625.7121719577314, 526.2752029151545, 888.8555063245308, 143.6994141453392, 759.0213269533368, 584.1657996316974, 977.1683039240057, 491.72860294521814, 658.0038952403359, 876.5876813787586, 450.7700445936808, 669.8409053264774, 503.9337015592213, 421.1784238925053, 471.8395963699512, 512.4942033112127, 166.34096268883903, 681.7153438275172, 713.4183805880801, 750.5715338516459, 564.0385075701504, 660.3988872572924, 258.12417789494117, 9.0, 606.5056167688406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.625204806222396, "mean_inference_ms": 4.891321852444884, "mean_action_processing_ms": 1.8305713281724696, "mean_env_wait_ms": 13.14077475488116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059757232666015625, "StateBufferConnector_ms": 0.010139942169189453, "ViewRequirementAgentConnector_ms": 0.17984163761138916}, "num_episodes": 3, "episode_return_max": 989.7167655431639, "episode_return_min": -234.31825323153677, "episode_return_mean": 162.27150725230456, "episodes_this_iter": 3}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.46959503030115, "num_env_steps_trained_throughput_per_sec": 151.46959503030115, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 26326.161, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26325.898, "sample_time_ms": 2403.67, "learn_time_ms": 23895.009, "learn_throughput": 167.399, "synch_weights_time_ms": 22.529}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-09-57", "timestamp": 1724384397, "time_this_iter_s": 26.47329592704773, "time_total_s": 2110.9377901554108, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095b4f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2110.9377901554108, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 34.62702702702703, "ram_util_percent": 82.24594594594596}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.623581729868732, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.934081158814607, "policy_loss": -0.010809165152607771, "vf_loss": 7.944073080133509, "vf_explained_var": -0.19651603276136692, "kl": 0.008172270987939247, "entropy": 0.2443113195360022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 75128.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.136055125382843, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.059573758342278, "policy_loss": -0.007566756774331369, "vf_loss": 8.066285071801888, "vf_explained_var": 0.37701682003717574, "kl": 0.00855474362332157, "entropy": 0.42875397899163464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 75128.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 989.7167655431639, "episode_reward_min": -157.66603149207126, "episode_reward_mean": 173.28952901293295, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1079.5366396449476, "predator_policy": 1.8998993229487044}, "policy_reward_max": {"prey_policy": 384.70000000000016, "predator_policy": 1079.5366396449476}, "policy_reward_mean": {"prey_policy": -510.5447500197834, "predator_policy": 597.1895145262502}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.13421925939964718, 368.62061488221, 4.222162401073627, 611.335620039599, 108.98097092000445, 5.599999999999996, 11.68892364893456, -79.34407579668138, 738.5647251683627, 4.399999999999999, 364.3478406270377, 188.50048784593056, 15.634314792637472, 46.77050983124841, 728.8232714738026, 472.24852761323285, 185.36723399036447, 262.56447251090907, 215.97961742030537, 6.777561044831266, 66.60562762651023, 1.0999999999999996, 499.13496542596977, 1.699999999999999, -28.056907768787383, 104.54543447541137, 354.009738930454, 0.19478274494072334, 68.32246306959539, 2.799999999999999, 255.42010480912765, 160.27949636404335, 6.699999999999992, 252.89198100324808, 0.6000000000000014, -38.248068440163294, 96.2485203452254, 230.39834832118112, 69.16845339333277, 231.5196356424792, -83.75560429066006, -12.940901092414855, 210.72984350877172, 5.575356250363328, 117.7, 398.4100218302533, 7.099999999999994, 69.28383759858856, 22.30000000000004, 312.5242518125231, -79.5439249007937, 235.0864530757464, -104.60576170658855, 251.33975441574103, -157.66603149207126, 5.999999999999996, 11.599999999999971, 228.73717053974647, 457.42109069585183, -146.22626191915603, 150.34511411209917, 253.80208638980184, 31.37462765570249, 586.3452289154525, 5.299999999999999, 49.67819768911784, 141.9190418649236, 989.7167655431639, 501.7676142251051, 149.86243117101432, 124.59720469133086, 298.9987577818114, 51.603454709272974, 165.85802013594596, 59.75140178710055, 507.6926817070609, 439.6418170550578, 131.618367606821, 180.5092134642167, 46.07583997001697, 361.8729891347765, 313.37251522648194, 10.345014941052877, 54.000000000000085, -6.371494496605591, 397.600000000001, 49.875241537633194, -8.725731829230403, 5.5, 355.6559249644398, 297.6848240135762, 664.7472908168521, 191.00800102734894, 0.5999999999999959, 82.32040330583781, 241.20760886561462, 23.000000000000014, 138.8124545978283, 930.6867520158349, 13.950811273962945], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-533.9631681671975, -737.8026657541909, -378.3155926750086, -358.9680452187627, -624.1366750852529, -681.6856732563692, -57.60629393905657, -865.0340027590051, -672.1906620070282, -528.6120917587522, -578.5883579021071, -651.7877818242625, -532.1995890125056, -670.723103705709, -415.55470382414654, -696.7851918773066, -1003.312799896253, 355.82427396219225, -778.595233097856, -770.5440040754307, -391.9739769424477, 105.61608227186586, -625.7039358606826, -851.8162310586999, -488.80845142372675, -462.96157772618375, -818.0844187535652, -534.1294383329437, -905.2985972291074, -93.81864584636901, -737.8840218956299, -23.973538931582276, -150.05121271376572, -875.7736285113577, -638.4308251030444, -489.8117413194341, -617.3818569164763, -12.538899060326164, -499.70916495698134, -562.322329058909, -455.26161771452337, -765.4382307641966, -778.6211199998097, -700.661876794911, -869.5026848404768, -461.75635264107177, -690.2448384237782, -832.0405870096157, -634.0502099556228, -430.20765538205086, -334.64795725578983, -522.6274753686982, -94.89597118597312, -855.5215763099874, -933.6489567001792, -723.4281041349146, -266.3702083268571, -838.6971829139501, -563.7791505334701, -837.7814562887878, -149.36999769897525, -772.6840061658008, -569.7991425243256, 14.654900926076436, -566.2224768016985, -815.6024236789829, 18.993058911611335, -775.917797251116, -615.7822147478925, -748.415286078326, -353.26415010546043, -633.3682278980197, -647.6360046436289, -479.6619109369389, -444.19269530723864, -676.0926767530948, 50.79062471563023, -690.0984021857961, -450.61218689407104, -709.3004700896759, -521.3658121936795, -675.4228264078016, -663.3573788015323, -187.19298991924364, -313.6409476636847, -786.5665536874975, -831.59934709147, -547.8135722162923, -1079.5366396449476, -437.44216709313514, -238.47024466964695, -574.6065812858856, -567.6061137936049, -670.7760349162427, -845.1656893650385, -473.4773733690885, -268.59053328623145, -942.6754276344027, -339.6386233409419, -807.6534138853972, -397.5397849439021, -385.85877044491974, -693.4888594005291, -200.04277546334274, -343.19993349861016, -567.1103729578114, 54.16033643333982, -757.7332284527008, -521.1257522169044, -663.2758091821095, -626.3004229193764, -766.3798861507651, -584.2510019980119, -848.1745367552084, -799.2456790295375, -452.295608886865, -766.6783949882365, -321.5366887345418, -478.82488416980283, -456.86593565447276, -805.1805255183158, 5.268849585186713, -834.8840572474014, -186.45649816266885, -289.4378787072217, -378.9853082421121, 325.1332588484207, -846.8844335538031, -580.9625658235076, -720.070707129705, -672.0617846434346, -212.11411040693412, -711.3104459795835, -719.1516902909682, 384.0083686266236, -661.4558592859527, -822.8214038289516, -115.26946437629408, -86.12165462750065, -781.9632613046144, -227.82518424927787, -55.75207995931391, -714.8632806106824, -251.98993433309587, -177.7554684275561, -262.6066330310738, -76.61134077433398, -989.698024018827, -426.9933433703012, -928.3859640822808, 310.8391942553525, -705.8672536469688, -661.4461730437496, -460.24611345689533, -376.44576924432977, -641.6683613344019, -539.8483781092077, -607.0001343990149, -775.3801849794144, -352.3185819362637, 5.66648507516828, -536.8115162028488, 232.4437533076101, -597.90640408118, -637.9830371226305, -746.8056723519152, -701.571533851645, -559.0385075701496, -290.3763972588308, -634.518162390005, 384.70000000000016, -602.6056167688397, 36.40345470927282, -708.9012004031765, -694.9280143985205, -717.8759712406165, -753.4215808527113, -671.8195282430812, -714.403777578914, -197.57335224489594, -258.1509994695027, -770.0119586328137, 336.9437030256583, -934.4451558381905, -664.0184133856159, -186.00957224193468, -675.3400040742741, -856.1667366023489, 45.361312279692086, -552.7629526009397, -851.3865404651567, -91.49108383002896, -722.8012853378992, -709.669725676653, -752.0891791572581, -413.8796035487708, -790.537629260062, 323.32338727934007, -478.9435073533613, -560.3945701024236], "policy_predator_policy_reward": [674.3097281821119, 597.3218864798762, 459.71460164545374, 646.1896511305342, 625.5683030515968, 684.4762076911, 771.3307397032249, 762.6451770344354, 666.9390551837433, 642.8446695020467, 581.7883579021077, 654.1877818242627, 539.888512661442, 674.72310370571, 276.99245977513743, 756.0033601296338, 953.4944177507084, 432.55883335171166, 779.2952330978561, 774.2440040754313, 403.4060626212954, 247.29967267632398, 910.6296525912378, 755.3910021740724, 257.05463475688316, 710.3497091856672, 818.5844187535653, 580.3999481641921, 823.2630555985813, 904.6774589506953, 692.3131847485116, 541.7929036919282, 336.3148383081871, 874.877236907301, 646.5413491071589, 744.2656898262292, 600.6067018560085, 245.29367154109931, 503.7875006345786, 565.0215544261434, 520.2672453410348, 767.0382307641967, 779.7211199998097, 700.661876794911, 863.6055959968048, 966.7884069107023, 691.9448384237785, 832.0405870096157, 722.3273715587843, 313.8735860101082, 401.18208987598587, 560.6387772239159, 490.1261578018027, 814.3011286246103, 933.7113445526547, 723.5604990273798, 874.3322058101242, 299.05764850027765, 566.3791505334708, 837.9814562887879, 389.96824651826364, 787.5058621556416, 207.81143730126092, 507.61230066103184, 571.9224768016985, 816.6024236789829, 233.89892209163716, 775.917797251116, 616.2822147478926, 748.515286078326, 303.51608166529945, 644.8682278980206, 658.8076532953488, 564.7387826304408, 589.9783061490699, 760.7054142324461, 3.9909874803654835, 704.4852433831326, 721.3588722290222, 670.0734203972096, 415.04183508244574, 697.9911992283774, 726.3752371340909, 111.23423049426894, 574.1954424954451, 736.7419023645134, 831.5247033418334, 553.4635722162933, 1079.5366396449476, 555.1421670931364, 395.13218809459977, 816.3546596911856, 571.2061137936058, 674.2760349162435, 849.5334563180047, 538.3934440147133, 290.7905332862365, 942.7754276344027, 809.2830641059227, 650.5332249329341, 1.8998993229487044, 701.9547311650817, 715.592679812138, 413.0254081274782, 168.67238839106903, 637.0321563587693, 796.3952330314389, 158.51741340366112, 338.07593179560416, 688.6595981113413, 630.5004229193771, 768.1798861507655, 591.6510019980125, 852.3745367552089, 795.9648948116998, 684.3135636444482, 785.2372825491916, 760.3988918694408, 659.1222405787889, 130.34231732633148, 793.7308962389977, 156.52589380623164, 696.6979204766129, 578.4447213232588, 24.175811105818205, 675.6220034992231, 786.3992065663666, 321.6971970544668, 584.7625658235077, 721.5707071297053, 642.8608399466812, 290.9932527928065, 762.0416908265261, 810.3394873089512, 637.8536954437246, 629.3105607587687, 699.6207551485752, 740.2377272817791, 262.37852030822216, 755.5688267949079, 253.4251842492764, 154.74928465064662, 616.9372008821342, 648.9147718434612, 449.40246418432355, 42.56309198358335, 606.4552129713751, 625.7121719577314, 526.2752029151545, 888.8555063245308, 143.6994141453392, 759.0213269533368, 584.1657996316974, 977.1683039240057, 491.72860294521814, 658.0038952403359, 876.5876813787586, 450.7700445936808, 669.8409053264774, 503.9337015592213, 421.1784238925053, 471.8395963699512, 512.4942033112127, 166.34096268883903, 681.7153438275172, 713.4183805880801, 750.5715338516459, 564.0385075701504, 660.3988872572924, 258.12417789494117, 9.0, 606.5056167688406, 10.57178682836036, 711.8012004031768, 687.5579881153344, 716.5202656945713, 754.3215808527115, 676.4195282430809, 646.2677520617153, 621.3653027265314, 592.2201209120901, 733.6276612038066, 521.2960942507077, 740.9526493786713, 629.449911620697, 411.5860750342023, 675.9400040742743, 856.1667366023489, 10.620569313346925, 579.1014743137403, 822.4639819738283, 361.6212511869715, 744.9012853378991, 710.5697256766531, 710.3166364843302, 594.4646008195249, 673.7155185491587, 724.1854754473958, 490.39431862732584, 562.8945701024237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.621964936832438, "mean_inference_ms": 4.880008671208718, "mean_action_processing_ms": 1.8248917296079161, "mean_env_wait_ms": 13.120718375579687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004894375801086426, "StateBufferConnector_ms": 0.01019287109375, "ViewRequirementAgentConnector_ms": 0.15810728073120117}, "num_episodes": 14, "episode_return_max": 989.7167655431639, "episode_return_min": -157.66603149207126, "episode_return_mean": 173.28952901293295, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.62033470503903, "num_env_steps_trained_throughput_per_sec": 149.62033470503903, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 26395.739, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26395.483, "sample_time_ms": 2497.791, "learn_time_ms": 23871.455, "learn_throughput": 167.564, "synch_weights_time_ms": 21.662}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-10-24", "timestamp": 1724384424, "time_this_iter_s": 26.76767587661743, "time_total_s": 2137.705466032028, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309667ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2137.705466032028, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 34.744736842105276, "ram_util_percent": 82.90789473684212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.72887220988198, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.788948411790152, "policy_loss": -0.011853735493348231, "vf_loss": 7.799983657857098, "vf_explained_var": 0.044882607775390465, "kl": 0.008185113393627699, "entropy": 0.2539909991795424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76073.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.59971203476033, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.9604860320923825, "policy_loss": -0.00788561992110714, "vf_loss": 7.967576353385966, "vf_explained_var": 0.42621881797830896, "kl": 0.007952543359900277, "entropy": 0.4016835388998506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76073.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 989.7167655431639, "episode_reward_min": -157.66603149207126, "episode_reward_mean": 163.57569626631673, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1079.5366396449476, "predator_policy": 1.8998993229487044}, "policy_reward_max": {"prey_policy": 384.70000000000016, "predator_policy": 1079.5366396449476}, "policy_reward_mean": {"prey_policy": -510.1848706466923, "predator_policy": 591.9727187798509}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.3478406270377, 188.50048784593056, 15.634314792637472, 46.77050983124841, 728.8232714738026, 472.24852761323285, 185.36723399036447, 262.56447251090907, 215.97961742030537, 6.777561044831266, 66.60562762651023, 1.0999999999999996, 499.13496542596977, 1.699999999999999, -28.056907768787383, 104.54543447541137, 354.009738930454, 0.19478274494072334, 68.32246306959539, 2.799999999999999, 255.42010480912765, 160.27949636404335, 6.699999999999992, 252.89198100324808, 0.6000000000000014, -38.248068440163294, 96.2485203452254, 230.39834832118112, 69.16845339333277, 231.5196356424792, -83.75560429066006, -12.940901092414855, 210.72984350877172, 5.575356250363328, 117.7, 398.4100218302533, 7.099999999999994, 69.28383759858856, 22.30000000000004, 312.5242518125231, -79.5439249007937, 235.0864530757464, -104.60576170658855, 251.33975441574103, -157.66603149207126, 5.999999999999996, 11.599999999999971, 228.73717053974647, 457.42109069585183, -146.22626191915603, 150.34511411209917, 253.80208638980184, 31.37462765570249, 586.3452289154525, 5.299999999999999, 49.67819768911784, 141.9190418649236, 989.7167655431639, 501.7676142251051, 149.86243117101432, 124.59720469133086, 298.9987577818114, 51.603454709272974, 165.85802013594596, 59.75140178710055, 507.6926817070609, 439.6418170550578, 131.618367606821, 180.5092134642167, 46.07583997001697, 361.8729891347765, 313.37251522648194, 10.345014941052877, 54.000000000000085, -6.371494496605591, 397.600000000001, 49.875241537633194, -8.725731829230403, 5.5, 355.6559249644398, 297.6848240135762, 664.7472908168521, 191.00800102734894, 0.5999999999999959, 82.32040330583781, 241.20760886561462, 23.000000000000014, 138.8124545978283, 930.6867520158349, 13.950811273962945, 24.300000000000082, 67.70277505274946, 158.63793862265462, 180.86614693511603, 279.9555584013274, 5.599999999999994, 56.1377299230455, 8.79999999999999, 4.200000000000001, 16.351298407587407], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-391.9739769424477, 105.61608227186586, -625.7039358606826, -851.8162310586999, -488.80845142372675, -462.96157772618375, -818.0844187535652, -534.1294383329437, -905.2985972291074, -93.81864584636901, -737.8840218956299, -23.973538931582276, -150.05121271376572, -875.7736285113577, -638.4308251030444, -489.8117413194341, -617.3818569164763, -12.538899060326164, -499.70916495698134, -562.322329058909, -455.26161771452337, -765.4382307641966, -778.6211199998097, -700.661876794911, -869.5026848404768, -461.75635264107177, -690.2448384237782, -832.0405870096157, -634.0502099556228, -430.20765538205086, -334.64795725578983, -522.6274753686982, -94.89597118597312, -855.5215763099874, -933.6489567001792, -723.4281041349146, -266.3702083268571, -838.6971829139501, -563.7791505334701, -837.7814562887878, -149.36999769897525, -772.6840061658008, -569.7991425243256, 14.654900926076436, -566.2224768016985, -815.6024236789829, 18.993058911611335, -775.917797251116, -615.7822147478925, -748.415286078326, -353.26415010546043, -633.3682278980197, -647.6360046436289, -479.6619109369389, -444.19269530723864, -676.0926767530948, 50.79062471563023, -690.0984021857961, -450.61218689407104, -709.3004700896759, -521.3658121936795, -675.4228264078016, -663.3573788015323, -187.19298991924364, -313.6409476636847, -786.5665536874975, -831.59934709147, -547.8135722162923, -1079.5366396449476, -437.44216709313514, -238.47024466964695, -574.6065812858856, -567.6061137936049, -670.7760349162427, -845.1656893650385, -473.4773733690885, -268.59053328623145, -942.6754276344027, -339.6386233409419, -807.6534138853972, -397.5397849439021, -385.85877044491974, -693.4888594005291, -200.04277546334274, -343.19993349861016, -567.1103729578114, 54.16033643333982, -757.7332284527008, -521.1257522169044, -663.2758091821095, -626.3004229193764, -766.3798861507651, -584.2510019980119, -848.1745367552084, -799.2456790295375, -452.295608886865, -766.6783949882365, -321.5366887345418, -478.82488416980283, -456.86593565447276, -805.1805255183158, 5.268849585186713, -834.8840572474014, -186.45649816266885, -289.4378787072217, -378.9853082421121, 325.1332588484207, -846.8844335538031, -580.9625658235076, -720.070707129705, -672.0617846434346, -212.11411040693412, -711.3104459795835, -719.1516902909682, 384.0083686266236, -661.4558592859527, -822.8214038289516, -115.26946437629408, -86.12165462750065, -781.9632613046144, -227.82518424927787, -55.75207995931391, -714.8632806106824, -251.98993433309587, -177.7554684275561, -262.6066330310738, -76.61134077433398, -989.698024018827, -426.9933433703012, -928.3859640822808, 310.8391942553525, -705.8672536469688, -661.4461730437496, -460.24611345689533, -376.44576924432977, -641.6683613344019, -539.8483781092077, -607.0001343990149, -775.3801849794144, -352.3185819362637, 5.66648507516828, -536.8115162028488, 232.4437533076101, -597.90640408118, -637.9830371226305, -746.8056723519152, -701.571533851645, -559.0385075701496, -290.3763972588308, -634.518162390005, 384.70000000000016, -602.6056167688397, 36.40345470927282, -708.9012004031765, -694.9280143985205, -717.8759712406165, -753.4215808527113, -671.8195282430812, -714.403777578914, -197.57335224489594, -258.1509994695027, -770.0119586328137, 336.9437030256583, -934.4451558381905, -664.0184133856159, -186.00957224193468, -675.3400040742741, -856.1667366023489, 45.361312279692086, -552.7629526009397, -851.3865404651567, -91.49108383002896, -722.8012853378992, -709.669725676653, -752.0891791572581, -413.8796035487708, -790.537629260062, 323.32338727934007, -478.9435073533613, -560.3945701024236, -258.6651578525402, -810.3409193774032, -149.33838317449138, -841.5406089887211, -554.778156775783, -398.8833893649499, -195.70695404289532, -740.6930672330227, 29.181045762176055, -686.2224787507726, -634.3014108975874, -628.2948843143992, -743.5679790004683, -809.87185531534, -564.9453707548084, -618.7343032837665, -535.634346605636, -722.564457609518, -539.4511006222658, -704.2517090535928], "policy_predator_policy_reward": [403.4060626212954, 247.29967267632398, 910.6296525912378, 755.3910021740724, 257.05463475688316, 710.3497091856672, 818.5844187535653, 580.3999481641921, 823.2630555985813, 904.6774589506953, 692.3131847485116, 541.7929036919282, 336.3148383081871, 874.877236907301, 646.5413491071589, 744.2656898262292, 600.6067018560085, 245.29367154109931, 503.7875006345786, 565.0215544261434, 520.2672453410348, 767.0382307641967, 779.7211199998097, 700.661876794911, 863.6055959968048, 966.7884069107023, 691.9448384237785, 832.0405870096157, 722.3273715587843, 313.8735860101082, 401.18208987598587, 560.6387772239159, 490.1261578018027, 814.3011286246103, 933.7113445526547, 723.5604990273798, 874.3322058101242, 299.05764850027765, 566.3791505334708, 837.9814562887879, 389.96824651826364, 787.5058621556416, 207.81143730126092, 507.61230066103184, 571.9224768016985, 816.6024236789829, 233.89892209163716, 775.917797251116, 616.2822147478926, 748.515286078326, 303.51608166529945, 644.8682278980206, 658.8076532953488, 564.7387826304408, 589.9783061490699, 760.7054142324461, 3.9909874803654835, 704.4852433831326, 721.3588722290222, 670.0734203972096, 415.04183508244574, 697.9911992283774, 726.3752371340909, 111.23423049426894, 574.1954424954451, 736.7419023645134, 831.5247033418334, 553.4635722162933, 1079.5366396449476, 555.1421670931364, 395.13218809459977, 816.3546596911856, 571.2061137936058, 674.2760349162435, 849.5334563180047, 538.3934440147133, 290.7905332862365, 942.7754276344027, 809.2830641059227, 650.5332249329341, 1.8998993229487044, 701.9547311650817, 715.592679812138, 413.0254081274782, 168.67238839106903, 637.0321563587693, 796.3952330314389, 158.51741340366112, 338.07593179560416, 688.6595981113413, 630.5004229193771, 768.1798861507655, 591.6510019980125, 852.3745367552089, 795.9648948116998, 684.3135636444482, 785.2372825491916, 760.3988918694408, 659.1222405787889, 130.34231732633148, 793.7308962389977, 156.52589380623164, 696.6979204766129, 578.4447213232588, 24.175811105818205, 675.6220034992231, 786.3992065663666, 321.6971970544668, 584.7625658235077, 721.5707071297053, 642.8608399466812, 290.9932527928065, 762.0416908265261, 810.3394873089512, 637.8536954437246, 629.3105607587687, 699.6207551485752, 740.2377272817791, 262.37852030822216, 755.5688267949079, 253.4251842492764, 154.74928465064662, 616.9372008821342, 648.9147718434612, 449.40246418432355, 42.56309198358335, 606.4552129713751, 625.7121719577314, 526.2752029151545, 888.8555063245308, 143.6994141453392, 759.0213269533368, 584.1657996316974, 977.1683039240057, 491.72860294521814, 658.0038952403359, 876.5876813787586, 450.7700445936808, 669.8409053264774, 503.9337015592213, 421.1784238925053, 471.8395963699512, 512.4942033112127, 166.34096268883903, 681.7153438275172, 713.4183805880801, 750.5715338516459, 564.0385075701504, 660.3988872572924, 258.12417789494117, 9.0, 606.5056167688406, 10.57178682836036, 711.8012004031768, 687.5579881153344, 716.5202656945713, 754.3215808527115, 676.4195282430809, 646.2677520617153, 621.3653027265314, 592.2201209120901, 733.6276612038066, 521.2960942507077, 740.9526493786713, 629.449911620697, 411.5860750342023, 675.9400040742743, 856.1667366023489, 10.620569313346925, 579.1014743137403, 822.4639819738283, 361.6212511869715, 744.9012853378991, 710.5697256766531, 710.3166364843302, 594.4646008195249, 673.7155185491587, 724.1854754473958, 490.39431862732584, 562.8945701024237, 282.2651578525455, 811.0409193774032, 888.6390021907482, 169.94276502522, 552.3103288684111, 559.9891558949784, 482.338442256542, 634.9277259544907, 250.7745126391514, 686.2224787507726, 639.8014108975882, 628.3948843143992, 750.2935933748872, 859.2839708639659, 573.7453707548094, 618.7343032837665, 539.5343466056369, 722.8644576095179, 584.7261597667022, 675.3279483167468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.609453137861963, "mean_inference_ms": 4.8825733394480215, "mean_action_processing_ms": 1.82480089893875, "mean_env_wait_ms": 13.130104745840942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004800081253051758, "StateBufferConnector_ms": 0.010157942771911621, "ViewRequirementAgentConnector_ms": 0.15704822540283203}, "num_episodes": 10, "episode_return_max": 989.7167655431639, "episode_return_min": -157.66603149207126, "episode_return_mean": 163.57569626631673, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.50329661305693, "num_env_steps_trained_throughput_per_sec": 152.50329661305693, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 26393.452, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26393.176, "sample_time_ms": 2475.751, "learn_time_ms": 23890.147, "learn_throughput": 167.433, "synch_weights_time_ms": 22.732}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-10-50", "timestamp": 1724384450, "time_this_iter_s": 26.286405086517334, "time_total_s": 2163.9918711185455, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1325700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2163.9918711185455, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 34.4945945945946, "ram_util_percent": 82.35405405405405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.42557163894492, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.927983657897465, "policy_loss": -0.010395487809120111, "vf_loss": 7.937815184820266, "vf_explained_var": 0.05413289019670436, "kl": 0.005639367793297405, "entropy": 0.24515827507884413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77018.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.39512690084952, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.802927489003176, "policy_loss": -0.008613625625099139, "vf_loss": 7.810707944536966, "vf_explained_var": 0.4466073443649938, "kl": 0.008331606165806532, "entropy": 0.4322286061508946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77018.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 989.7167655431639, "episode_reward_min": -157.66603149207126, "episode_reward_mean": 146.32095655809673, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1079.5366396449476, "predator_policy": 1.8998993229487044}, "policy_reward_max": {"prey_policy": 384.70000000000016, "predator_policy": 1079.5366396449476}, "policy_reward_mean": {"prey_policy": -521.2189119138319, "predator_policy": 594.3793901928807}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.777561044831266, 66.60562762651023, 1.0999999999999996, 499.13496542596977, 1.699999999999999, -28.056907768787383, 104.54543447541137, 354.009738930454, 0.19478274494072334, 68.32246306959539, 2.799999999999999, 255.42010480912765, 160.27949636404335, 6.699999999999992, 252.89198100324808, 0.6000000000000014, -38.248068440163294, 96.2485203452254, 230.39834832118112, 69.16845339333277, 231.5196356424792, -83.75560429066006, -12.940901092414855, 210.72984350877172, 5.575356250363328, 117.7, 398.4100218302533, 7.099999999999994, 69.28383759858856, 22.30000000000004, 312.5242518125231, -79.5439249007937, 235.0864530757464, -104.60576170658855, 251.33975441574103, -157.66603149207126, 5.999999999999996, 11.599999999999971, 228.73717053974647, 457.42109069585183, -146.22626191915603, 150.34511411209917, 253.80208638980184, 31.37462765570249, 586.3452289154525, 5.299999999999999, 49.67819768911784, 141.9190418649236, 989.7167655431639, 501.7676142251051, 149.86243117101432, 124.59720469133086, 298.9987577818114, 51.603454709272974, 165.85802013594596, 59.75140178710055, 507.6926817070609, 439.6418170550578, 131.618367606821, 180.5092134642167, 46.07583997001697, 361.8729891347765, 313.37251522648194, 10.345014941052877, 54.000000000000085, -6.371494496605591, 397.600000000001, 49.875241537633194, -8.725731829230403, 5.5, 355.6559249644398, 297.6848240135762, 664.7472908168521, 191.00800102734894, 0.5999999999999959, 82.32040330583781, 241.20760886561462, 23.000000000000014, 138.8124545978283, 930.6867520158349, 13.950811273962945, 24.300000000000082, 67.70277505274946, 158.63793862265462, 180.86614693511603, 279.9555584013274, 5.599999999999994, 56.1377299230455, 8.79999999999999, 4.200000000000001, 16.351298407587407, 6.189363483975447, 192.6766594517069, 193.9402692117376, 90.43971253894536, -1.0682869174933538, 171.79420765388247, -18.65009587087227, 7.696693971578265, 111.74378176001127], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-499.70916495698134, -562.322329058909, -455.26161771452337, -765.4382307641966, -778.6211199998097, -700.661876794911, -869.5026848404768, -461.75635264107177, -690.2448384237782, -832.0405870096157, -634.0502099556228, -430.20765538205086, -334.64795725578983, -522.6274753686982, -94.89597118597312, -855.5215763099874, -933.6489567001792, -723.4281041349146, -266.3702083268571, -838.6971829139501, -563.7791505334701, -837.7814562887878, -149.36999769897525, -772.6840061658008, -569.7991425243256, 14.654900926076436, -566.2224768016985, -815.6024236789829, 18.993058911611335, -775.917797251116, -615.7822147478925, -748.415286078326, -353.26415010546043, -633.3682278980197, -647.6360046436289, -479.6619109369389, -444.19269530723864, -676.0926767530948, 50.79062471563023, -690.0984021857961, -450.61218689407104, -709.3004700896759, -521.3658121936795, -675.4228264078016, -663.3573788015323, -187.19298991924364, -313.6409476636847, -786.5665536874975, -831.59934709147, -547.8135722162923, -1079.5366396449476, -437.44216709313514, -238.47024466964695, -574.6065812858856, -567.6061137936049, -670.7760349162427, -845.1656893650385, -473.4773733690885, -268.59053328623145, -942.6754276344027, -339.6386233409419, -807.6534138853972, -397.5397849439021, -385.85877044491974, -693.4888594005291, -200.04277546334274, -343.19993349861016, -567.1103729578114, 54.16033643333982, -757.7332284527008, -521.1257522169044, -663.2758091821095, -626.3004229193764, -766.3798861507651, -584.2510019980119, -848.1745367552084, -799.2456790295375, -452.295608886865, -766.6783949882365, -321.5366887345418, -478.82488416980283, -456.86593565447276, -805.1805255183158, 5.268849585186713, -834.8840572474014, -186.45649816266885, -289.4378787072217, -378.9853082421121, 325.1332588484207, -846.8844335538031, -580.9625658235076, -720.070707129705, -672.0617846434346, -212.11411040693412, -711.3104459795835, -719.1516902909682, 384.0083686266236, -661.4558592859527, -822.8214038289516, -115.26946437629408, -86.12165462750065, -781.9632613046144, -227.82518424927787, -55.75207995931391, -714.8632806106824, -251.98993433309587, -177.7554684275561, -262.6066330310738, -76.61134077433398, -989.698024018827, -426.9933433703012, -928.3859640822808, 310.8391942553525, -705.8672536469688, -661.4461730437496, -460.24611345689533, -376.44576924432977, -641.6683613344019, -539.8483781092077, -607.0001343990149, -775.3801849794144, -352.3185819362637, 5.66648507516828, -536.8115162028488, 232.4437533076101, -597.90640408118, -637.9830371226305, -746.8056723519152, -701.571533851645, -559.0385075701496, -290.3763972588308, -634.518162390005, 384.70000000000016, -602.6056167688397, 36.40345470927282, -708.9012004031765, -694.9280143985205, -717.8759712406165, -753.4215808527113, -671.8195282430812, -714.403777578914, -197.57335224489594, -258.1509994695027, -770.0119586328137, 336.9437030256583, -934.4451558381905, -664.0184133856159, -186.00957224193468, -675.3400040742741, -856.1667366023489, 45.361312279692086, -552.7629526009397, -851.3865404651567, -91.49108383002896, -722.8012853378992, -709.669725676653, -752.0891791572581, -413.8796035487708, -790.537629260062, 323.32338727934007, -478.9435073533613, -560.3945701024236, -258.6651578525402, -810.3409193774032, -149.33838317449138, -841.5406089887211, -554.778156775783, -398.8833893649499, -195.70695404289532, -740.6930672330227, 29.181045762176055, -686.2224787507726, -634.3014108975874, -628.2948843143992, -743.5679790004683, -809.87185531534, -564.9453707548084, -618.7343032837665, -535.634346605636, -722.564457609518, -539.4511006222658, -704.2517090535928, -265.257431994224, -662.4414512258103, -449.3107388728186, -824.4882649668363, -657.1065247050442, -173.46828970945342, -817.4937965290139, -246.01240158092446, -800.7607018542385, -647.5429817889594, -881.5977367479414, -553.3770914505059, -745.9629983164934, -544.3498360673027, -695.80717578863, -638.9863351156695, -503.1387274454189, -712.5306846221266], "policy_predator_policy_reward": [503.7875006345786, 565.0215544261434, 520.2672453410348, 767.0382307641967, 779.7211199998097, 700.661876794911, 863.6055959968048, 966.7884069107023, 691.9448384237785, 832.0405870096157, 722.3273715587843, 313.8735860101082, 401.18208987598587, 560.6387772239159, 490.1261578018027, 814.3011286246103, 933.7113445526547, 723.5604990273798, 874.3322058101242, 299.05764850027765, 566.3791505334708, 837.9814562887879, 389.96824651826364, 787.5058621556416, 207.81143730126092, 507.61230066103184, 571.9224768016985, 816.6024236789829, 233.89892209163716, 775.917797251116, 616.2822147478926, 748.515286078326, 303.51608166529945, 644.8682278980206, 658.8076532953488, 564.7387826304408, 589.9783061490699, 760.7054142324461, 3.9909874803654835, 704.4852433831326, 721.3588722290222, 670.0734203972096, 415.04183508244574, 697.9911992283774, 726.3752371340909, 111.23423049426894, 574.1954424954451, 736.7419023645134, 831.5247033418334, 553.4635722162933, 1079.5366396449476, 555.1421670931364, 395.13218809459977, 816.3546596911856, 571.2061137936058, 674.2760349162435, 849.5334563180047, 538.3934440147133, 290.7905332862365, 942.7754276344027, 809.2830641059227, 650.5332249329341, 1.8998993229487044, 701.9547311650817, 715.592679812138, 413.0254081274782, 168.67238839106903, 637.0321563587693, 796.3952330314389, 158.51741340366112, 338.07593179560416, 688.6595981113413, 630.5004229193771, 768.1798861507655, 591.6510019980125, 852.3745367552089, 795.9648948116998, 684.3135636444482, 785.2372825491916, 760.3988918694408, 659.1222405787889, 130.34231732633148, 793.7308962389977, 156.52589380623164, 696.6979204766129, 578.4447213232588, 24.175811105818205, 675.6220034992231, 786.3992065663666, 321.6971970544668, 584.7625658235077, 721.5707071297053, 642.8608399466812, 290.9932527928065, 762.0416908265261, 810.3394873089512, 637.8536954437246, 629.3105607587687, 699.6207551485752, 740.2377272817791, 262.37852030822216, 755.5688267949079, 253.4251842492764, 154.74928465064662, 616.9372008821342, 648.9147718434612, 449.40246418432355, 42.56309198358335, 606.4552129713751, 625.7121719577314, 526.2752029151545, 888.8555063245308, 143.6994141453392, 759.0213269533368, 584.1657996316974, 977.1683039240057, 491.72860294521814, 658.0038952403359, 876.5876813787586, 450.7700445936808, 669.8409053264774, 503.9337015592213, 421.1784238925053, 471.8395963699512, 512.4942033112127, 166.34096268883903, 681.7153438275172, 713.4183805880801, 750.5715338516459, 564.0385075701504, 660.3988872572924, 258.12417789494117, 9.0, 606.5056167688406, 10.57178682836036, 711.8012004031768, 687.5579881153344, 716.5202656945713, 754.3215808527115, 676.4195282430809, 646.2677520617153, 621.3653027265314, 592.2201209120901, 733.6276612038066, 521.2960942507077, 740.9526493786713, 629.449911620697, 411.5860750342023, 675.9400040742743, 856.1667366023489, 10.620569313346925, 579.1014743137403, 822.4639819738283, 361.6212511869715, 744.9012853378991, 710.5697256766531, 710.3166364843302, 594.4646008195249, 673.7155185491587, 724.1854754473958, 490.39431862732584, 562.8945701024237, 282.2651578525455, 811.0409193774032, 888.6390021907482, 169.94276502522, 552.3103288684111, 559.9891558949784, 482.338442256542, 634.9277259544907, 250.7745126391514, 686.2224787507726, 639.8014108975882, 628.3948843143992, 750.2935933748872, 859.2839708639659, 573.7453707548094, 618.7343032837665, 539.5343466056369, 722.8644576095179, 584.7261597667022, 675.3279483167468, 229.29727677622796, 704.5909699277853, 636.3326743445917, 830.1429889467738, 653.5181305213991, 370.99695310483645, 798.1859486645702, 355.7599619843107, 833.2039788050265, 614.031417920682, 866.7082332535788, 740.0608025987557, 585.5957359623092, 686.067002550614, 703.0071757886303, 639.4830290872477, 643.8691185795228, 683.5440752480355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.604903095619606, "mean_inference_ms": 4.878785603652303, "mean_action_processing_ms": 1.8186489833228217, "mean_env_wait_ms": 13.128204646583638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004758715629577637, "StateBufferConnector_ms": 0.010161519050598145, "ViewRequirementAgentConnector_ms": 0.1561737060546875}, "num_episodes": 9, "episode_return_max": 989.7167655431639, "episode_return_min": -157.66603149207126, "episode_return_mean": 146.32095655809673, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.86344042990893, "num_env_steps_trained_throughput_per_sec": 153.86344042990893, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 26356.105, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26355.892, "sample_time_ms": 2475.85, "learn_time_ms": 23853.771, "learn_throughput": 167.688, "synch_weights_time_ms": 22.032}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-11-16", "timestamp": 1724384476, "time_this_iter_s": 26.011873960494995, "time_total_s": 2190.0037450790405, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309667c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2190.0037450790405, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 33.962162162162166, "ram_util_percent": 83.04864864864864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.538788023449126, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.190040026266107, "policy_loss": -0.006474397054050492, "vf_loss": 8.195940591923144, "vf_explained_var": -0.0391051657616146, "kl": 0.0057382322311963115, "entropy": 0.2365092727557692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77963.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.20132417729292, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.028559344155449, "policy_loss": -0.009248872266875372, "vf_loss": 8.036755758618552, "vf_explained_var": 0.4347057210074531, "kl": 0.010524627769479242, "entropy": 0.40729498251405344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77963.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 989.7167655431639, "episode_reward_min": -157.66603149207126, "episode_reward_mean": 142.15672568896082, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1079.5366396449476, "predator_policy": 1.8998993229487044}, "policy_reward_max": {"prey_policy": 384.70000000000016, "predator_policy": 1079.5366396449476}, "policy_reward_mean": {"prey_policy": -519.3480123604827, "predator_policy": 590.4263752049637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.056907768787383, 104.54543447541137, 354.009738930454, 0.19478274494072334, 68.32246306959539, 2.799999999999999, 255.42010480912765, 160.27949636404335, 6.699999999999992, 252.89198100324808, 0.6000000000000014, -38.248068440163294, 96.2485203452254, 230.39834832118112, 69.16845339333277, 231.5196356424792, -83.75560429066006, -12.940901092414855, 210.72984350877172, 5.575356250363328, 117.7, 398.4100218302533, 7.099999999999994, 69.28383759858856, 22.30000000000004, 312.5242518125231, -79.5439249007937, 235.0864530757464, -104.60576170658855, 251.33975441574103, -157.66603149207126, 5.999999999999996, 11.599999999999971, 228.73717053974647, 457.42109069585183, -146.22626191915603, 150.34511411209917, 253.80208638980184, 31.37462765570249, 586.3452289154525, 5.299999999999999, 49.67819768911784, 141.9190418649236, 989.7167655431639, 501.7676142251051, 149.86243117101432, 124.59720469133086, 298.9987577818114, 51.603454709272974, 165.85802013594596, 59.75140178710055, 507.6926817070609, 439.6418170550578, 131.618367606821, 180.5092134642167, 46.07583997001697, 361.8729891347765, 313.37251522648194, 10.345014941052877, 54.000000000000085, -6.371494496605591, 397.600000000001, 49.875241537633194, -8.725731829230403, 5.5, 355.6559249644398, 297.6848240135762, 664.7472908168521, 191.00800102734894, 0.5999999999999959, 82.32040330583781, 241.20760886561462, 23.000000000000014, 138.8124545978283, 930.6867520158349, 13.950811273962945, 24.300000000000082, 67.70277505274946, 158.63793862265462, 180.86614693511603, 279.9555584013274, 5.599999999999994, 56.1377299230455, 8.79999999999999, 4.200000000000001, 16.351298407587407, 6.189363483975447, 192.6766594517069, 193.9402692117376, 90.43971253894536, -1.0682869174933538, 171.79420765388247, -18.65009587087227, 7.696693971578265, 111.74378176001127, 168.22261007253994, 1.3000000000000007, -51.37870130314442, 37.65115841432573, 3.1000000000000005], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-634.0502099556228, -430.20765538205086, -334.64795725578983, -522.6274753686982, -94.89597118597312, -855.5215763099874, -933.6489567001792, -723.4281041349146, -266.3702083268571, -838.6971829139501, -563.7791505334701, -837.7814562887878, -149.36999769897525, -772.6840061658008, -569.7991425243256, 14.654900926076436, -566.2224768016985, -815.6024236789829, 18.993058911611335, -775.917797251116, -615.7822147478925, -748.415286078326, -353.26415010546043, -633.3682278980197, -647.6360046436289, -479.6619109369389, -444.19269530723864, -676.0926767530948, 50.79062471563023, -690.0984021857961, -450.61218689407104, -709.3004700896759, -521.3658121936795, -675.4228264078016, -663.3573788015323, -187.19298991924364, -313.6409476636847, -786.5665536874975, -831.59934709147, -547.8135722162923, -1079.5366396449476, -437.44216709313514, -238.47024466964695, -574.6065812858856, -567.6061137936049, -670.7760349162427, -845.1656893650385, -473.4773733690885, -268.59053328623145, -942.6754276344027, -339.6386233409419, -807.6534138853972, -397.5397849439021, -385.85877044491974, -693.4888594005291, -200.04277546334274, -343.19993349861016, -567.1103729578114, 54.16033643333982, -757.7332284527008, -521.1257522169044, -663.2758091821095, -626.3004229193764, -766.3798861507651, -584.2510019980119, -848.1745367552084, -799.2456790295375, -452.295608886865, -766.6783949882365, -321.5366887345418, -478.82488416980283, -456.86593565447276, -805.1805255183158, 5.268849585186713, -834.8840572474014, -186.45649816266885, -289.4378787072217, -378.9853082421121, 325.1332588484207, -846.8844335538031, -580.9625658235076, -720.070707129705, -672.0617846434346, -212.11411040693412, -711.3104459795835, -719.1516902909682, 384.0083686266236, -661.4558592859527, -822.8214038289516, -115.26946437629408, -86.12165462750065, -781.9632613046144, -227.82518424927787, -55.75207995931391, -714.8632806106824, -251.98993433309587, -177.7554684275561, -262.6066330310738, -76.61134077433398, -989.698024018827, -426.9933433703012, -928.3859640822808, 310.8391942553525, -705.8672536469688, -661.4461730437496, -460.24611345689533, -376.44576924432977, -641.6683613344019, -539.8483781092077, -607.0001343990149, -775.3801849794144, -352.3185819362637, 5.66648507516828, -536.8115162028488, 232.4437533076101, -597.90640408118, -637.9830371226305, -746.8056723519152, -701.571533851645, -559.0385075701496, -290.3763972588308, -634.518162390005, 384.70000000000016, -602.6056167688397, 36.40345470927282, -708.9012004031765, -694.9280143985205, -717.8759712406165, -753.4215808527113, -671.8195282430812, -714.403777578914, -197.57335224489594, -258.1509994695027, -770.0119586328137, 336.9437030256583, -934.4451558381905, -664.0184133856159, -186.00957224193468, -675.3400040742741, -856.1667366023489, 45.361312279692086, -552.7629526009397, -851.3865404651567, -91.49108383002896, -722.8012853378992, -709.669725676653, -752.0891791572581, -413.8796035487708, -790.537629260062, 323.32338727934007, -478.9435073533613, -560.3945701024236, -258.6651578525402, -810.3409193774032, -149.33838317449138, -841.5406089887211, -554.778156775783, -398.8833893649499, -195.70695404289532, -740.6930672330227, 29.181045762176055, -686.2224787507726, -634.3014108975874, -628.2948843143992, -743.5679790004683, -809.87185531534, -564.9453707548084, -618.7343032837665, -535.634346605636, -722.564457609518, -539.4511006222658, -704.2517090535928, -265.257431994224, -662.4414512258103, -449.3107388728186, -824.4882649668363, -657.1065247050442, -173.46828970945342, -817.4937965290139, -246.01240158092446, -800.7607018542385, -647.5429817889594, -881.5977367479414, -553.3770914505059, -745.9629983164934, -544.3498360673027, -695.80717578863, -638.9863351156695, -503.1387274454189, -712.5306846221266, -640.9841170097059, -557.9032027923264, -845.1339470711567, -817.2883731395868, -626.0530913621456, -185.2787028762574, -461.4519603670549, -733.1661160615499, -615.0818019186717, -759.0375789359953], "policy_predator_policy_reward": [722.3273715587843, 313.8735860101082, 401.18208987598587, 560.6387772239159, 490.1261578018027, 814.3011286246103, 933.7113445526547, 723.5604990273798, 874.3322058101242, 299.05764850027765, 566.3791505334708, 837.9814562887879, 389.96824651826364, 787.5058621556416, 207.81143730126092, 507.61230066103184, 571.9224768016985, 816.6024236789829, 233.89892209163716, 775.917797251116, 616.2822147478926, 748.515286078326, 303.51608166529945, 644.8682278980206, 658.8076532953488, 564.7387826304408, 589.9783061490699, 760.7054142324461, 3.9909874803654835, 704.4852433831326, 721.3588722290222, 670.0734203972096, 415.04183508244574, 697.9911992283774, 726.3752371340909, 111.23423049426894, 574.1954424954451, 736.7419023645134, 831.5247033418334, 553.4635722162933, 1079.5366396449476, 555.1421670931364, 395.13218809459977, 816.3546596911856, 571.2061137936058, 674.2760349162435, 849.5334563180047, 538.3934440147133, 290.7905332862365, 942.7754276344027, 809.2830641059227, 650.5332249329341, 1.8998993229487044, 701.9547311650817, 715.592679812138, 413.0254081274782, 168.67238839106903, 637.0321563587693, 796.3952330314389, 158.51741340366112, 338.07593179560416, 688.6595981113413, 630.5004229193771, 768.1798861507655, 591.6510019980125, 852.3745367552089, 795.9648948116998, 684.3135636444482, 785.2372825491916, 760.3988918694408, 659.1222405787889, 130.34231732633148, 793.7308962389977, 156.52589380623164, 696.6979204766129, 578.4447213232588, 24.175811105818205, 675.6220034992231, 786.3992065663666, 321.6971970544668, 584.7625658235077, 721.5707071297053, 642.8608399466812, 290.9932527928065, 762.0416908265261, 810.3394873089512, 637.8536954437246, 629.3105607587687, 699.6207551485752, 740.2377272817791, 262.37852030822216, 755.5688267949079, 253.4251842492764, 154.74928465064662, 616.9372008821342, 648.9147718434612, 449.40246418432355, 42.56309198358335, 606.4552129713751, 625.7121719577314, 526.2752029151545, 888.8555063245308, 143.6994141453392, 759.0213269533368, 584.1657996316974, 977.1683039240057, 491.72860294521814, 658.0038952403359, 876.5876813787586, 450.7700445936808, 669.8409053264774, 503.9337015592213, 421.1784238925053, 471.8395963699512, 512.4942033112127, 166.34096268883903, 681.7153438275172, 713.4183805880801, 750.5715338516459, 564.0385075701504, 660.3988872572924, 258.12417789494117, 9.0, 606.5056167688406, 10.57178682836036, 711.8012004031768, 687.5579881153344, 716.5202656945713, 754.3215808527115, 676.4195282430809, 646.2677520617153, 621.3653027265314, 592.2201209120901, 733.6276612038066, 521.2960942507077, 740.9526493786713, 629.449911620697, 411.5860750342023, 675.9400040742743, 856.1667366023489, 10.620569313346925, 579.1014743137403, 822.4639819738283, 361.6212511869715, 744.9012853378991, 710.5697256766531, 710.3166364843302, 594.4646008195249, 673.7155185491587, 724.1854754473958, 490.39431862732584, 562.8945701024237, 282.2651578525455, 811.0409193774032, 888.6390021907482, 169.94276502522, 552.3103288684111, 559.9891558949784, 482.338442256542, 634.9277259544907, 250.7745126391514, 686.2224787507726, 639.8014108975882, 628.3948843143992, 750.2935933748872, 859.2839708639659, 573.7453707548094, 618.7343032837665, 539.5343466056369, 722.8644576095179, 584.7261597667022, 675.3279483167468, 229.29727677622796, 704.5909699277853, 636.3326743445917, 830.1429889467738, 653.5181305213991, 370.99695310483645, 798.1859486645702, 355.7599619843107, 833.2039788050265, 614.031417920682, 866.7082332535788, 740.0608025987557, 585.5957359623092, 686.067002550614, 703.0071757886303, 639.4830290872477, 643.8691185795228, 683.5440752480355, 948.1060170592709, 419.0039128153047, 846.0339470711567, 817.6883731395868, 138.20200740125364, 621.751085534004, 497.30311878138104, 734.9661160615503, 618.1818019186716, 759.0375789359953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.6093893859799655, "mean_inference_ms": 4.875855959098957, "mean_action_processing_ms": 1.81219056521827, "mean_env_wait_ms": 13.119596197597145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004641890525817871, "StateBufferConnector_ms": 0.010145187377929688, "ViewRequirementAgentConnector_ms": 0.16471564769744873}, "num_episodes": 5, "episode_return_max": 989.7167655431639, "episode_return_min": -157.66603149207126, "episode_return_mean": 142.15672568896082, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.60090656785064, "num_env_steps_trained_throughput_per_sec": 153.60090656785064, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 26320.642, "restore_workers_time_ms": 0.031, "training_step_time_ms": 26320.416, "sample_time_ms": 2460.55, "learn_time_ms": 23833.863, "learn_throughput": 167.828, "synch_weights_time_ms": 21.925}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-11-42", "timestamp": 1724384502, "time_this_iter_s": 26.048120975494385, "time_total_s": 2216.051866054535, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095bf430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2216.051866054535, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 33.486486486486484, "ram_util_percent": 82.34864864864866}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.84220400462075, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.145896159278022, "policy_loss": -0.009815295335279885, "vf_loss": 8.1549572465281, "vf_explained_var": 0.08141455114203155, "kl": 0.007542110881497147, "entropy": 0.23456213494772635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78908.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.28057638400446, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.9417490136686455, "policy_loss": -0.005203786534725358, "vf_loss": 7.94613606690099, "vf_explained_var": 0.37936777620719225, "kl": 0.008167155324013303, "entropy": 0.4074608202649172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78908.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 989.7167655431639, "episode_reward_min": -157.66603149207126, "episode_reward_mean": 159.21992535987482, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1079.5366396449476, "predator_policy": 1.8998993229487044}, "policy_reward_max": {"prey_policy": 384.70000000000016, "predator_policy": 1079.5366396449476}, "policy_reward_mean": {"prey_policy": -514.4321233526442, "predator_policy": 594.0420860325821}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.248068440163294, 96.2485203452254, 230.39834832118112, 69.16845339333277, 231.5196356424792, -83.75560429066006, -12.940901092414855, 210.72984350877172, 5.575356250363328, 117.7, 398.4100218302533, 7.099999999999994, 69.28383759858856, 22.30000000000004, 312.5242518125231, -79.5439249007937, 235.0864530757464, -104.60576170658855, 251.33975441574103, -157.66603149207126, 5.999999999999996, 11.599999999999971, 228.73717053974647, 457.42109069585183, -146.22626191915603, 150.34511411209917, 253.80208638980184, 31.37462765570249, 586.3452289154525, 5.299999999999999, 49.67819768911784, 141.9190418649236, 989.7167655431639, 501.7676142251051, 149.86243117101432, 124.59720469133086, 298.9987577818114, 51.603454709272974, 165.85802013594596, 59.75140178710055, 507.6926817070609, 439.6418170550578, 131.618367606821, 180.5092134642167, 46.07583997001697, 361.8729891347765, 313.37251522648194, 10.345014941052877, 54.000000000000085, -6.371494496605591, 397.600000000001, 49.875241537633194, -8.725731829230403, 5.5, 355.6559249644398, 297.6848240135762, 664.7472908168521, 191.00800102734894, 0.5999999999999959, 82.32040330583781, 241.20760886561462, 23.000000000000014, 138.8124545978283, 930.6867520158349, 13.950811273962945, 24.300000000000082, 67.70277505274946, 158.63793862265462, 180.86614693511603, 279.9555584013274, 5.599999999999994, 56.1377299230455, 8.79999999999999, 4.200000000000001, 16.351298407587407, 6.189363483975447, 192.6766594517069, 193.9402692117376, 90.43971253894536, -1.0682869174933538, 171.79420765388247, -18.65009587087227, 7.696693971578265, 111.74378176001127, 168.22261007253994, 1.3000000000000007, -51.37870130314442, 37.65115841432573, 3.1000000000000005, 627.7393327595291, 95.77227423425782, 3.1445307116670627, 842.0453085372717, 268.3132438574514, 98.342686717412, 146.45976055548357, 11.454040499876166, 340.9426308818982, 9.267221290005994, 440.546030674577], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-353.26415010546043, -633.3682278980197, -647.6360046436289, -479.6619109369389, -444.19269530723864, -676.0926767530948, 50.79062471563023, -690.0984021857961, -450.61218689407104, -709.3004700896759, -521.3658121936795, -675.4228264078016, -663.3573788015323, -187.19298991924364, -313.6409476636847, -786.5665536874975, -831.59934709147, -547.8135722162923, -1079.5366396449476, -437.44216709313514, -238.47024466964695, -574.6065812858856, -567.6061137936049, -670.7760349162427, -845.1656893650385, -473.4773733690885, -268.59053328623145, -942.6754276344027, -339.6386233409419, -807.6534138853972, -397.5397849439021, -385.85877044491974, -693.4888594005291, -200.04277546334274, -343.19993349861016, -567.1103729578114, 54.16033643333982, -757.7332284527008, -521.1257522169044, -663.2758091821095, -626.3004229193764, -766.3798861507651, -584.2510019980119, -848.1745367552084, -799.2456790295375, -452.295608886865, -766.6783949882365, -321.5366887345418, -478.82488416980283, -456.86593565447276, -805.1805255183158, 5.268849585186713, -834.8840572474014, -186.45649816266885, -289.4378787072217, -378.9853082421121, 325.1332588484207, -846.8844335538031, -580.9625658235076, -720.070707129705, -672.0617846434346, -212.11411040693412, -711.3104459795835, -719.1516902909682, 384.0083686266236, -661.4558592859527, -822.8214038289516, -115.26946437629408, -86.12165462750065, -781.9632613046144, -227.82518424927787, -55.75207995931391, -714.8632806106824, -251.98993433309587, -177.7554684275561, -262.6066330310738, -76.61134077433398, -989.698024018827, -426.9933433703012, -928.3859640822808, 310.8391942553525, -705.8672536469688, -661.4461730437496, -460.24611345689533, -376.44576924432977, -641.6683613344019, -539.8483781092077, -607.0001343990149, -775.3801849794144, -352.3185819362637, 5.66648507516828, -536.8115162028488, 232.4437533076101, -597.90640408118, -637.9830371226305, -746.8056723519152, -701.571533851645, -559.0385075701496, -290.3763972588308, -634.518162390005, 384.70000000000016, -602.6056167688397, 36.40345470927282, -708.9012004031765, -694.9280143985205, -717.8759712406165, -753.4215808527113, -671.8195282430812, -714.403777578914, -197.57335224489594, -258.1509994695027, -770.0119586328137, 336.9437030256583, -934.4451558381905, -664.0184133856159, -186.00957224193468, -675.3400040742741, -856.1667366023489, 45.361312279692086, -552.7629526009397, -851.3865404651567, -91.49108383002896, -722.8012853378992, -709.669725676653, -752.0891791572581, -413.8796035487708, -790.537629260062, 323.32338727934007, -478.9435073533613, -560.3945701024236, -258.6651578525402, -810.3409193774032, -149.33838317449138, -841.5406089887211, -554.778156775783, -398.8833893649499, -195.70695404289532, -740.6930672330227, 29.181045762176055, -686.2224787507726, -634.3014108975874, -628.2948843143992, -743.5679790004683, -809.87185531534, -564.9453707548084, -618.7343032837665, -535.634346605636, -722.564457609518, -539.4511006222658, -704.2517090535928, -265.257431994224, -662.4414512258103, -449.3107388728186, -824.4882649668363, -657.1065247050442, -173.46828970945342, -817.4937965290139, -246.01240158092446, -800.7607018542385, -647.5429817889594, -881.5977367479414, -553.3770914505059, -745.9629983164934, -544.3498360673027, -695.80717578863, -638.9863351156695, -503.1387274454189, -712.5306846221266, -640.9841170097059, -557.9032027923264, -845.1339470711567, -817.2883731395868, -626.0530913621456, -185.2787028762574, -461.4519603670549, -733.1661160615499, -615.0818019186717, -759.0375789359953, -535.7995498542801, -216.7994488459799, -97.78124454919269, -762.1135405252031, -472.85934736533807, -665.96369055677, -819.6626840886826, 288.7778002276386, -414.2405634360963, -752.9391833024374, -543.7416918729401, -496.3346847673887, -500.77787575542845, -684.9656431572662, -545.9501400761895, -769.1613729616112, -793.8565708492694, -340.0568201315782, -612.1825308261562, -543.249957786906, 22.223360002226062, -775.1881074191705], "policy_predator_policy_reward": [303.51608166529945, 644.8682278980206, 658.8076532953488, 564.7387826304408, 589.9783061490699, 760.7054142324461, 3.9909874803654835, 704.4852433831326, 721.3588722290222, 670.0734203972096, 415.04183508244574, 697.9911992283774, 726.3752371340909, 111.23423049426894, 574.1954424954451, 736.7419023645134, 831.5247033418334, 553.4635722162933, 1079.5366396449476, 555.1421670931364, 395.13218809459977, 816.3546596911856, 571.2061137936058, 674.2760349162435, 849.5334563180047, 538.3934440147133, 290.7905332862365, 942.7754276344027, 809.2830641059227, 650.5332249329341, 1.8998993229487044, 701.9547311650817, 715.592679812138, 413.0254081274782, 168.67238839106903, 637.0321563587693, 796.3952330314389, 158.51741340366112, 338.07593179560416, 688.6595981113413, 630.5004229193771, 768.1798861507655, 591.6510019980125, 852.3745367552089, 795.9648948116998, 684.3135636444482, 785.2372825491916, 760.3988918694408, 659.1222405787889, 130.34231732633148, 793.7308962389977, 156.52589380623164, 696.6979204766129, 578.4447213232588, 24.175811105818205, 675.6220034992231, 786.3992065663666, 321.6971970544668, 584.7625658235077, 721.5707071297053, 642.8608399466812, 290.9932527928065, 762.0416908265261, 810.3394873089512, 637.8536954437246, 629.3105607587687, 699.6207551485752, 740.2377272817791, 262.37852030822216, 755.5688267949079, 253.4251842492764, 154.74928465064662, 616.9372008821342, 648.9147718434612, 449.40246418432355, 42.56309198358335, 606.4552129713751, 625.7121719577314, 526.2752029151545, 888.8555063245308, 143.6994141453392, 759.0213269533368, 584.1657996316974, 977.1683039240057, 491.72860294521814, 658.0038952403359, 876.5876813787586, 450.7700445936808, 669.8409053264774, 503.9337015592213, 421.1784238925053, 471.8395963699512, 512.4942033112127, 166.34096268883903, 681.7153438275172, 713.4183805880801, 750.5715338516459, 564.0385075701504, 660.3988872572924, 258.12417789494117, 9.0, 606.5056167688406, 10.57178682836036, 711.8012004031768, 687.5579881153344, 716.5202656945713, 754.3215808527115, 676.4195282430809, 646.2677520617153, 621.3653027265314, 592.2201209120901, 733.6276612038066, 521.2960942507077, 740.9526493786713, 629.449911620697, 411.5860750342023, 675.9400040742743, 856.1667366023489, 10.620569313346925, 579.1014743137403, 822.4639819738283, 361.6212511869715, 744.9012853378991, 710.5697256766531, 710.3166364843302, 594.4646008195249, 673.7155185491587, 724.1854754473958, 490.39431862732584, 562.8945701024237, 282.2651578525455, 811.0409193774032, 888.6390021907482, 169.94276502522, 552.3103288684111, 559.9891558949784, 482.338442256542, 634.9277259544907, 250.7745126391514, 686.2224787507726, 639.8014108975882, 628.3948843143992, 750.2935933748872, 859.2839708639659, 573.7453707548094, 618.7343032837665, 539.5343466056369, 722.8644576095179, 584.7261597667022, 675.3279483167468, 229.29727677622796, 704.5909699277853, 636.3326743445917, 830.1429889467738, 653.5181305213991, 370.99695310483645, 798.1859486645702, 355.7599619843107, 833.2039788050265, 614.031417920682, 866.7082332535788, 740.0608025987557, 585.5957359623092, 686.067002550614, 703.0071757886303, 639.4830290872477, 643.8691185795228, 683.5440752480355, 948.1060170592709, 419.0039128153047, 846.0339470711567, 817.6883731395868, 138.20200740125364, 621.751085534004, 497.30311878138104, 734.9661160615503, 618.1818019186716, 759.0375789359953, 699.204070008206, 681.1342614515842, 206.99272014345877, 748.6743391651928, 468.6404801260751, 673.3270885077037, 733.1309556852542, 639.7992367130602, 751.533057965548, 683.9599326304347, 399.2671518702268, 739.1519114875157, 661.1776083118972, 671.0256711562852, 769.1613729616112, 557.404180576067, 687.9901278445947, 786.8658940181513, 613.8409753015258, 550.8587346015438, 698.1466796835359, 495.364098407986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.595507951552862, "mean_inference_ms": 4.8695867766387275, "mean_action_processing_ms": 1.821337908644985, "mean_env_wait_ms": 13.121689076452048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004581809043884277, "StateBufferConnector_ms": 0.009942293167114258, "ViewRequirementAgentConnector_ms": 0.15767455101013184}, "num_episodes": 11, "episode_return_max": 989.7167655431639, "episode_return_min": -157.66603149207126, "episode_return_mean": 159.21992535987482, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.69787745492786, "num_env_steps_trained_throughput_per_sec": 152.69787745492786, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 26326.433, "restore_workers_time_ms": 0.03, "training_step_time_ms": 26326.226, "sample_time_ms": 2484.829, "learn_time_ms": 23815.365, "learn_throughput": 167.959, "synch_weights_time_ms": 22.086}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-12-08", "timestamp": 1724384528, "time_this_iter_s": 26.26529598236084, "time_total_s": 2242.3171620368958, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1325af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2242.3171620368958, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 33.54324324324323, "ram_util_percent": 82.59459459459457}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.045204448699952, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.124451748782365, "policy_loss": -0.006708332147725203, "vf_loss": 8.130455255256129, "vf_explained_var": -0.20330190866712539, "kl": 0.0070479994388445025, "entropy": 0.23844080825962086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 79853.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.66958258643983, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.040616985603615, "policy_loss": -0.010791692053455683, "vf_loss": 8.050390481191968, "vf_explained_var": 0.32563243139357795, "kl": 0.010181797835877332, "entropy": 0.42642990234036926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 79853.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 989.7167655431639, "episode_reward_min": -157.66603149207126, "episode_reward_mean": 173.22557890067907, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1079.5366396449476, "predator_policy": 1.8998993229487044}, "policy_reward_max": {"prey_policy": 398.25303827703067, "predator_policy": 1079.5366396449476}, "policy_reward_mean": {"prey_policy": -512.7215775055757, "predator_policy": 599.3343669559156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.575356250363328, 117.7, 398.4100218302533, 7.099999999999994, 69.28383759858856, 22.30000000000004, 312.5242518125231, -79.5439249007937, 235.0864530757464, -104.60576170658855, 251.33975441574103, -157.66603149207126, 5.999999999999996, 11.599999999999971, 228.73717053974647, 457.42109069585183, -146.22626191915603, 150.34511411209917, 253.80208638980184, 31.37462765570249, 586.3452289154525, 5.299999999999999, 49.67819768911784, 141.9190418649236, 989.7167655431639, 501.7676142251051, 149.86243117101432, 124.59720469133086, 298.9987577818114, 51.603454709272974, 165.85802013594596, 59.75140178710055, 507.6926817070609, 439.6418170550578, 131.618367606821, 180.5092134642167, 46.07583997001697, 361.8729891347765, 313.37251522648194, 10.345014941052877, 54.000000000000085, -6.371494496605591, 397.600000000001, 49.875241537633194, -8.725731829230403, 5.5, 355.6559249644398, 297.6848240135762, 664.7472908168521, 191.00800102734894, 0.5999999999999959, 82.32040330583781, 241.20760886561462, 23.000000000000014, 138.8124545978283, 930.6867520158349, 13.950811273962945, 24.300000000000082, 67.70277505274946, 158.63793862265462, 180.86614693511603, 279.9555584013274, 5.599999999999994, 56.1377299230455, 8.79999999999999, 4.200000000000001, 16.351298407587407, 6.189363483975447, 192.6766594517069, 193.9402692117376, 90.43971253894536, -1.0682869174933538, 171.79420765388247, -18.65009587087227, 7.696693971578265, 111.74378176001127, 168.22261007253994, 1.3000000000000007, -51.37870130314442, 37.65115841432573, 3.1000000000000005, 627.7393327595291, 95.77227423425782, 3.1445307116670627, 842.0453085372717, 268.3132438574514, 98.342686717412, 146.45976055548357, 11.454040499876166, 340.9426308818982, 9.267221290005994, 440.546030674577, -1.7574287641230315, 538.3900383521583, 764.8092352115242, 61.84760167974126, 117.0229387910062, 267.8154337654048, 347.85776243246175, 7.69999999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-831.59934709147, -547.8135722162923, -1079.5366396449476, -437.44216709313514, -238.47024466964695, -574.6065812858856, -567.6061137936049, -670.7760349162427, -845.1656893650385, -473.4773733690885, -268.59053328623145, -942.6754276344027, -339.6386233409419, -807.6534138853972, -397.5397849439021, -385.85877044491974, -693.4888594005291, -200.04277546334274, -343.19993349861016, -567.1103729578114, 54.16033643333982, -757.7332284527008, -521.1257522169044, -663.2758091821095, -626.3004229193764, -766.3798861507651, -584.2510019980119, -848.1745367552084, -799.2456790295375, -452.295608886865, -766.6783949882365, -321.5366887345418, -478.82488416980283, -456.86593565447276, -805.1805255183158, 5.268849585186713, -834.8840572474014, -186.45649816266885, -289.4378787072217, -378.9853082421121, 325.1332588484207, -846.8844335538031, -580.9625658235076, -720.070707129705, -672.0617846434346, -212.11411040693412, -711.3104459795835, -719.1516902909682, 384.0083686266236, -661.4558592859527, -822.8214038289516, -115.26946437629408, -86.12165462750065, -781.9632613046144, -227.82518424927787, -55.75207995931391, -714.8632806106824, -251.98993433309587, -177.7554684275561, -262.6066330310738, -76.61134077433398, -989.698024018827, -426.9933433703012, -928.3859640822808, 310.8391942553525, -705.8672536469688, -661.4461730437496, -460.24611345689533, -376.44576924432977, -641.6683613344019, -539.8483781092077, -607.0001343990149, -775.3801849794144, -352.3185819362637, 5.66648507516828, -536.8115162028488, 232.4437533076101, -597.90640408118, -637.9830371226305, -746.8056723519152, -701.571533851645, -559.0385075701496, -290.3763972588308, -634.518162390005, 384.70000000000016, -602.6056167688397, 36.40345470927282, -708.9012004031765, -694.9280143985205, -717.8759712406165, -753.4215808527113, -671.8195282430812, -714.403777578914, -197.57335224489594, -258.1509994695027, -770.0119586328137, 336.9437030256583, -934.4451558381905, -664.0184133856159, -186.00957224193468, -675.3400040742741, -856.1667366023489, 45.361312279692086, -552.7629526009397, -851.3865404651567, -91.49108383002896, -722.8012853378992, -709.669725676653, -752.0891791572581, -413.8796035487708, -790.537629260062, 323.32338727934007, -478.9435073533613, -560.3945701024236, -258.6651578525402, -810.3409193774032, -149.33838317449138, -841.5406089887211, -554.778156775783, -398.8833893649499, -195.70695404289532, -740.6930672330227, 29.181045762176055, -686.2224787507726, -634.3014108975874, -628.2948843143992, -743.5679790004683, -809.87185531534, -564.9453707548084, -618.7343032837665, -535.634346605636, -722.564457609518, -539.4511006222658, -704.2517090535928, -265.257431994224, -662.4414512258103, -449.3107388728186, -824.4882649668363, -657.1065247050442, -173.46828970945342, -817.4937965290139, -246.01240158092446, -800.7607018542385, -647.5429817889594, -881.5977367479414, -553.3770914505059, -745.9629983164934, -544.3498360673027, -695.80717578863, -638.9863351156695, -503.1387274454189, -712.5306846221266, -640.9841170097059, -557.9032027923264, -845.1339470711567, -817.2883731395868, -626.0530913621456, -185.2787028762574, -461.4519603670549, -733.1661160615499, -615.0818019186717, -759.0375789359953, -535.7995498542801, -216.7994488459799, -97.78124454919269, -762.1135405252031, -472.85934736533807, -665.96369055677, -819.6626840886826, 288.7778002276386, -414.2405634360963, -752.9391833024374, -543.7416918729401, -496.3346847673887, -500.77787575542845, -684.9656431572662, -545.9501400761895, -769.1613729616112, -793.8565708492694, -340.0568201315782, -612.1825308261562, -543.249957786906, 22.223360002226062, -775.1881074191705, -651.0594417493837, -701.7280933765904, -689.1343626994624, -109.37695588924944, 398.25303827703067, -775.7615637594386, -627.7757560268875, -807.6235295780705, -368.67670130206665, -366.02527417701333, -463.69842297287664, -644.9597903625357, -561.320590890933, -237.4471464674647, -549.0757526718754, -683.4630957111801], "policy_predator_policy_reward": [831.5247033418334, 553.4635722162933, 1079.5366396449476, 555.1421670931364, 395.13218809459977, 816.3546596911856, 571.2061137936058, 674.2760349162435, 849.5334563180047, 538.3934440147133, 290.7905332862365, 942.7754276344027, 809.2830641059227, 650.5332249329341, 1.8998993229487044, 701.9547311650817, 715.592679812138, 413.0254081274782, 168.67238839106903, 637.0321563587693, 796.3952330314389, 158.51741340366112, 338.07593179560416, 688.6595981113413, 630.5004229193771, 768.1798861507655, 591.6510019980125, 852.3745367552089, 795.9648948116998, 684.3135636444482, 785.2372825491916, 760.3988918694408, 659.1222405787889, 130.34231732633148, 793.7308962389977, 156.52589380623164, 696.6979204766129, 578.4447213232588, 24.175811105818205, 675.6220034992231, 786.3992065663666, 321.6971970544668, 584.7625658235077, 721.5707071297053, 642.8608399466812, 290.9932527928065, 762.0416908265261, 810.3394873089512, 637.8536954437246, 629.3105607587687, 699.6207551485752, 740.2377272817791, 262.37852030822216, 755.5688267949079, 253.4251842492764, 154.74928465064662, 616.9372008821342, 648.9147718434612, 449.40246418432355, 42.56309198358335, 606.4552129713751, 625.7121719577314, 526.2752029151545, 888.8555063245308, 143.6994141453392, 759.0213269533368, 584.1657996316974, 977.1683039240057, 491.72860294521814, 658.0038952403359, 876.5876813787586, 450.7700445936808, 669.8409053264774, 503.9337015592213, 421.1784238925053, 471.8395963699512, 512.4942033112127, 166.34096268883903, 681.7153438275172, 713.4183805880801, 750.5715338516459, 564.0385075701504, 660.3988872572924, 258.12417789494117, 9.0, 606.5056167688406, 10.57178682836036, 711.8012004031768, 687.5579881153344, 716.5202656945713, 754.3215808527115, 676.4195282430809, 646.2677520617153, 621.3653027265314, 592.2201209120901, 733.6276612038066, 521.2960942507077, 740.9526493786713, 629.449911620697, 411.5860750342023, 675.9400040742743, 856.1667366023489, 10.620569313346925, 579.1014743137403, 822.4639819738283, 361.6212511869715, 744.9012853378991, 710.5697256766531, 710.3166364843302, 594.4646008195249, 673.7155185491587, 724.1854754473958, 490.39431862732584, 562.8945701024237, 282.2651578525455, 811.0409193774032, 888.6390021907482, 169.94276502522, 552.3103288684111, 559.9891558949784, 482.338442256542, 634.9277259544907, 250.7745126391514, 686.2224787507726, 639.8014108975882, 628.3948843143992, 750.2935933748872, 859.2839708639659, 573.7453707548094, 618.7343032837665, 539.5343466056369, 722.8644576095179, 584.7261597667022, 675.3279483167468, 229.29727677622796, 704.5909699277853, 636.3326743445917, 830.1429889467738, 653.5181305213991, 370.99695310483645, 798.1859486645702, 355.7599619843107, 833.2039788050265, 614.031417920682, 866.7082332535788, 740.0608025987557, 585.5957359623092, 686.067002550614, 703.0071757886303, 639.4830290872477, 643.8691185795228, 683.5440752480355, 948.1060170592709, 419.0039128153047, 846.0339470711567, 817.6883731395868, 138.20200740125364, 621.751085534004, 497.30311878138104, 734.9661160615503, 618.1818019186716, 759.0375789359953, 699.204070008206, 681.1342614515842, 206.99272014345877, 748.6743391651928, 468.6404801260751, 673.3270885077037, 733.1309556852542, 639.7992367130602, 751.533057965548, 683.9599326304347, 399.2671518702268, 739.1519114875157, 661.1776083118972, 671.0256711562852, 769.1613729616112, 557.404180576067, 687.9901278445947, 786.8658940181513, 613.8409753015258, 550.8587346015438, 698.1466796835359, 495.364098407986, 669.9880809627609, 681.0420253990907, 635.0880949050164, 701.8132620358568, 407.35001096023433, 734.9677497336945, 721.5815678459894, 775.6653194387105, 404.63948617452235, 447.0854280955667, 746.0163426826308, 630.4573044181889, 496.9605564069341, 649.6649433839267, 556.7757526718768, 683.4630957111801]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.594308938905744, "mean_inference_ms": 4.865337471964237, "mean_action_processing_ms": 1.8098429643068281, "mean_env_wait_ms": 13.122797198022422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004619956016540527, "StateBufferConnector_ms": 0.009916305541992188, "ViewRequirementAgentConnector_ms": 0.15363085269927979}, "num_episodes": 8, "episode_return_max": 989.7167655431639, "episode_return_min": -157.66603149207126, "episode_return_mean": 173.22557890067907, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.54613093030432, "num_env_steps_trained_throughput_per_sec": 153.54613093030432, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 26313.417, "restore_workers_time_ms": 0.031, "training_step_time_ms": 26313.253, "sample_time_ms": 2465.855, "learn_time_ms": 23821.485, "learn_throughput": 167.916, "synch_weights_time_ms": 22.18}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-12-34", "timestamp": 1724384554, "time_this_iter_s": 26.069138050079346, "time_total_s": 2268.386300086975, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1325430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2268.386300086975, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 34.15277777777778, "ram_util_percent": 82.29444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.54074961193024, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.05458535088433, "policy_loss": -0.009048613973908009, "vf_loss": 8.062930852900106, "vf_explained_var": -0.011208998021625336, "kl": 0.0070309213607783905, "entropy": 0.2126161913234721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80798.0, "diff_num_grad_updates_vs_sampler_policy": 503.4212499999994}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.288627199647287, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.6409686588105705, "policy_loss": -0.008153461806338143, "vf_loss": 7.648165008504555, "vf_explained_var": 0.4636527104352517, "kl": 0.009571290596649445, "entropy": 0.4333566034912432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80798.0, "diff_num_grad_updates_vs_sampler_policy": 503.4212499999994}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 989.7167655431639, "episode_reward_min": -157.66603149207126, "episode_reward_mean": 186.41544181556907, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1029.539227410078, "predator_policy": 9.0}, "policy_reward_max": {"prey_policy": 398.25303827703067, "predator_policy": 977.1683039240057}, "policy_reward_mean": {"prey_policy": -511.0500089776887, "predator_policy": 604.2577298854736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-157.66603149207126, 5.999999999999996, 11.599999999999971, 228.73717053974647, 457.42109069585183, -146.22626191915603, 150.34511411209917, 253.80208638980184, 31.37462765570249, 586.3452289154525, 5.299999999999999, 49.67819768911784, 141.9190418649236, 989.7167655431639, 501.7676142251051, 149.86243117101432, 124.59720469133086, 298.9987577818114, 51.603454709272974, 165.85802013594596, 59.75140178710055, 507.6926817070609, 439.6418170550578, 131.618367606821, 180.5092134642167, 46.07583997001697, 361.8729891347765, 313.37251522648194, 10.345014941052877, 54.000000000000085, -6.371494496605591, 397.600000000001, 49.875241537633194, -8.725731829230403, 5.5, 355.6559249644398, 297.6848240135762, 664.7472908168521, 191.00800102734894, 0.5999999999999959, 82.32040330583781, 241.20760886561462, 23.000000000000014, 138.8124545978283, 930.6867520158349, 13.950811273962945, 24.300000000000082, 67.70277505274946, 158.63793862265462, 180.86614693511603, 279.9555584013274, 5.599999999999994, 56.1377299230455, 8.79999999999999, 4.200000000000001, 16.351298407587407, 6.189363483975447, 192.6766594517069, 193.9402692117376, 90.43971253894536, -1.0682869174933538, 171.79420765388247, -18.65009587087227, 7.696693971578265, 111.74378176001127, 168.22261007253994, 1.3000000000000007, -51.37870130314442, 37.65115841432573, 3.1000000000000005, 627.7393327595291, 95.77227423425782, 3.1445307116670627, 842.0453085372717, 268.3132438574514, 98.342686717412, 146.45976055548357, 11.454040499876166, 340.9426308818982, 9.267221290005994, 440.546030674577, -1.7574287641230315, 538.3900383521583, 764.8092352115242, 61.84760167974126, 117.0229387910062, 267.8154337654048, 347.85776243246175, 7.69999999999999, 459.17479048431795, 35.1327896555275, 254.95446608909688, 336.6966372863762, 4.699999999999999, 4.100000000000007, 711.5495538553067, 259.02274283771874, 2.1999999999999993, 446.6037183360975, 40.02158132039263], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-521.1257522169044, -663.2758091821095, -626.3004229193764, -766.3798861507651, -584.2510019980119, -848.1745367552084, -799.2456790295375, -452.295608886865, -766.6783949882365, -321.5366887345418, -478.82488416980283, -456.86593565447276, -805.1805255183158, 5.268849585186713, -834.8840572474014, -186.45649816266885, -289.4378787072217, -378.9853082421121, 325.1332588484207, -846.8844335538031, -580.9625658235076, -720.070707129705, -672.0617846434346, -212.11411040693412, -711.3104459795835, -719.1516902909682, 384.0083686266236, -661.4558592859527, -822.8214038289516, -115.26946437629408, -86.12165462750065, -781.9632613046144, -227.82518424927787, -55.75207995931391, -714.8632806106824, -251.98993433309587, -177.7554684275561, -262.6066330310738, -76.61134077433398, -989.698024018827, -426.9933433703012, -928.3859640822808, 310.8391942553525, -705.8672536469688, -661.4461730437496, -460.24611345689533, -376.44576924432977, -641.6683613344019, -539.8483781092077, -607.0001343990149, -775.3801849794144, -352.3185819362637, 5.66648507516828, -536.8115162028488, 232.4437533076101, -597.90640408118, -637.9830371226305, -746.8056723519152, -701.571533851645, -559.0385075701496, -290.3763972588308, -634.518162390005, 384.70000000000016, -602.6056167688397, 36.40345470927282, -708.9012004031765, -694.9280143985205, -717.8759712406165, -753.4215808527113, -671.8195282430812, -714.403777578914, -197.57335224489594, -258.1509994695027, -770.0119586328137, 336.9437030256583, -934.4451558381905, -664.0184133856159, -186.00957224193468, -675.3400040742741, -856.1667366023489, 45.361312279692086, -552.7629526009397, -851.3865404651567, -91.49108383002896, -722.8012853378992, -709.669725676653, -752.0891791572581, -413.8796035487708, -790.537629260062, 323.32338727934007, -478.9435073533613, -560.3945701024236, -258.6651578525402, -810.3409193774032, -149.33838317449138, -841.5406089887211, -554.778156775783, -398.8833893649499, -195.70695404289532, -740.6930672330227, 29.181045762176055, -686.2224787507726, -634.3014108975874, -628.2948843143992, -743.5679790004683, -809.87185531534, -564.9453707548084, -618.7343032837665, -535.634346605636, -722.564457609518, -539.4511006222658, -704.2517090535928, -265.257431994224, -662.4414512258103, -449.3107388728186, -824.4882649668363, -657.1065247050442, -173.46828970945342, -817.4937965290139, -246.01240158092446, -800.7607018542385, -647.5429817889594, -881.5977367479414, -553.3770914505059, -745.9629983164934, -544.3498360673027, -695.80717578863, -638.9863351156695, -503.1387274454189, -712.5306846221266, -640.9841170097059, -557.9032027923264, -845.1339470711567, -817.2883731395868, -626.0530913621456, -185.2787028762574, -461.4519603670549, -733.1661160615499, -615.0818019186717, -759.0375789359953, -535.7995498542801, -216.7994488459799, -97.78124454919269, -762.1135405252031, -472.85934736533807, -665.96369055677, -819.6626840886826, 288.7778002276386, -414.2405634360963, -752.9391833024374, -543.7416918729401, -496.3346847673887, -500.77787575542845, -684.9656431572662, -545.9501400761895, -769.1613729616112, -793.8565708492694, -340.0568201315782, -612.1825308261562, -543.249957786906, 22.223360002226062, -775.1881074191705, -651.0594417493837, -701.7280933765904, -689.1343626994624, -109.37695588924944, 398.25303827703067, -775.7615637594386, -627.7757560268875, -807.6235295780705, -368.67670130206665, -366.02527417701333, -463.69842297287664, -644.9597903625357, -561.320590890933, -237.4471464674647, -549.0757526718754, -683.4630957111801, -112.92284423429504, -735.4571799784808, -669.2521345468166, -664.4450954411369, -849.5899832872504, -391.8638571427655, -893.4015659633903, -179.43863396309501, -708.1246840639151, -667.4068270080651, -698.740035180817, -742.7645838601077, -1029.539227410078, 114.71880047511566, -690.3842622500563, -154.30216632774517, -644.9939697959438, -784.3205996099047, 169.1152918596335, -475.2618100082679, -48.985690990125306, -724.1903860159097], "policy_predator_policy_reward": [338.07593179560416, 688.6595981113413, 630.5004229193771, 768.1798861507655, 591.6510019980125, 852.3745367552089, 795.9648948116998, 684.3135636444482, 785.2372825491916, 760.3988918694408, 659.1222405787889, 130.34231732633148, 793.7308962389977, 156.52589380623164, 696.6979204766129, 578.4447213232588, 24.175811105818205, 675.6220034992231, 786.3992065663666, 321.6971970544668, 584.7625658235077, 721.5707071297053, 642.8608399466812, 290.9932527928065, 762.0416908265261, 810.3394873089512, 637.8536954437246, 629.3105607587687, 699.6207551485752, 740.2377272817791, 262.37852030822216, 755.5688267949079, 253.4251842492764, 154.74928465064662, 616.9372008821342, 648.9147718434612, 449.40246418432355, 42.56309198358335, 606.4552129713751, 625.7121719577314, 526.2752029151545, 888.8555063245308, 143.6994141453392, 759.0213269533368, 584.1657996316974, 977.1683039240057, 491.72860294521814, 658.0038952403359, 876.5876813787586, 450.7700445936808, 669.8409053264774, 503.9337015592213, 421.1784238925053, 471.8395963699512, 512.4942033112127, 166.34096268883903, 681.7153438275172, 713.4183805880801, 750.5715338516459, 564.0385075701504, 660.3988872572924, 258.12417789494117, 9.0, 606.5056167688406, 10.57178682836036, 711.8012004031768, 687.5579881153344, 716.5202656945713, 754.3215808527115, 676.4195282430809, 646.2677520617153, 621.3653027265314, 592.2201209120901, 733.6276612038066, 521.2960942507077, 740.9526493786713, 629.449911620697, 411.5860750342023, 675.9400040742743, 856.1667366023489, 10.620569313346925, 579.1014743137403, 822.4639819738283, 361.6212511869715, 744.9012853378991, 710.5697256766531, 710.3166364843302, 594.4646008195249, 673.7155185491587, 724.1854754473958, 490.39431862732584, 562.8945701024237, 282.2651578525455, 811.0409193774032, 888.6390021907482, 169.94276502522, 552.3103288684111, 559.9891558949784, 482.338442256542, 634.9277259544907, 250.7745126391514, 686.2224787507726, 639.8014108975882, 628.3948843143992, 750.2935933748872, 859.2839708639659, 573.7453707548094, 618.7343032837665, 539.5343466056369, 722.8644576095179, 584.7261597667022, 675.3279483167468, 229.29727677622796, 704.5909699277853, 636.3326743445917, 830.1429889467738, 653.5181305213991, 370.99695310483645, 798.1859486645702, 355.7599619843107, 833.2039788050265, 614.031417920682, 866.7082332535788, 740.0608025987557, 585.5957359623092, 686.067002550614, 703.0071757886303, 639.4830290872477, 643.8691185795228, 683.5440752480355, 948.1060170592709, 419.0039128153047, 846.0339470711567, 817.6883731395868, 138.20200740125364, 621.751085534004, 497.30311878138104, 734.9661160615503, 618.1818019186716, 759.0375789359953, 699.204070008206, 681.1342614515842, 206.99272014345877, 748.6743391651928, 468.6404801260751, 673.3270885077037, 733.1309556852542, 639.7992367130602, 751.533057965548, 683.9599326304347, 399.2671518702268, 739.1519114875157, 661.1776083118972, 671.0256711562852, 769.1613729616112, 557.404180576067, 687.9901278445947, 786.8658940181513, 613.8409753015258, 550.8587346015438, 698.1466796835359, 495.364098407986, 669.9880809627609, 681.0420253990907, 635.0880949050164, 701.8132620358568, 407.35001096023433, 734.9677497336945, 721.5815678459894, 775.6653194387105, 404.63948617452235, 447.0854280955667, 746.0163426826308, 630.4573044181889, 496.9605564069341, 649.6649433839267, 556.7757526718768, 683.4630957111801, 594.5439722145607, 713.0108424825352, 708.2658553473716, 660.5641642961099, 728.5079368194681, 767.9003696996499, 691.3843520717576, 718.1524851411027, 711.7246840639149, 668.506827008065, 702.8400351808176, 742.7645838601077, 713.395923895676, 912.9740568945891, 634.7441809147596, 468.9649905007644, 647.1939697959444, 784.3205996099047, 633.0680708725364, 119.68216561219475, 86.07997290235733, 727.1176854240701]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.596773772562903, "mean_inference_ms": 4.864711350934269, "mean_action_processing_ms": 1.809115532389376, "mean_env_wait_ms": 13.118613692658496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006350159645080566, "StateBufferConnector_ms": 0.004987120628356934, "ViewRequirementAgentConnector_ms": 0.19332218170166016}, "num_episodes": 11, "episode_return_max": 989.7167655431639, "episode_return_min": -157.66603149207126, "episode_return_mean": 186.41544181556907, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.19123625079663, "num_env_steps_trained_throughput_per_sec": 144.19123625079663, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 26419.518, "restore_workers_time_ms": 0.031, "training_step_time_ms": 26419.365, "sample_time_ms": 2637.783, "learn_time_ms": 23757.149, "learn_throughput": 168.37, "synch_weights_time_ms": 21.135}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-13-02", "timestamp": 1724384582, "time_this_iter_s": 27.803595066070557, "time_total_s": 2296.1898951530457, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30960d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2296.1898951530457, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 37.9125, "ram_util_percent": 83.015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.303873843490763, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.095958878249718, "policy_loss": -0.008017755367068781, "vf_loss": 8.103396803739841, "vf_explained_var": -0.0872116382790621, "kl": 0.005798330636837929, "entropy": 0.22851634948026567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 81743.0, "diff_num_grad_updates_vs_sampler_policy": 503.4212499999994}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.02213970870568, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.997475363211657, "policy_loss": -0.010346595607771878, "vf_loss": 8.007002202795928, "vf_explained_var": 0.23040529060616063, "kl": 0.008197998951272989, "entropy": 0.38781494644899217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 81743.0, "diff_num_grad_updates_vs_sampler_policy": 503.4212499999994}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 989.7167655431639, "episode_reward_min": -108.76613772861782, "episode_reward_mean": 178.61852548009043, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1053.3516181439427, "predator_policy": 3.296545290727474}, "policy_reward_max": {"prey_policy": 398.25303827703067, "predator_policy": 977.1683039240057}, "policy_reward_mean": {"prey_policy": -515.6064421425033, "predator_policy": 604.915704882549}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.299999999999999, 49.67819768911784, 141.9190418649236, 989.7167655431639, 501.7676142251051, 149.86243117101432, 124.59720469133086, 298.9987577818114, 51.603454709272974, 165.85802013594596, 59.75140178710055, 507.6926817070609, 439.6418170550578, 131.618367606821, 180.5092134642167, 46.07583997001697, 361.8729891347765, 313.37251522648194, 10.345014941052877, 54.000000000000085, -6.371494496605591, 397.600000000001, 49.875241537633194, -8.725731829230403, 5.5, 355.6559249644398, 297.6848240135762, 664.7472908168521, 191.00800102734894, 0.5999999999999959, 82.32040330583781, 241.20760886561462, 23.000000000000014, 138.8124545978283, 930.6867520158349, 13.950811273962945, 24.300000000000082, 67.70277505274946, 158.63793862265462, 180.86614693511603, 279.9555584013274, 5.599999999999994, 56.1377299230455, 8.79999999999999, 4.200000000000001, 16.351298407587407, 6.189363483975447, 192.6766594517069, 193.9402692117376, 90.43971253894536, -1.0682869174933538, 171.79420765388247, -18.65009587087227, 7.696693971578265, 111.74378176001127, 168.22261007253994, 1.3000000000000007, -51.37870130314442, 37.65115841432573, 3.1000000000000005, 627.7393327595291, 95.77227423425782, 3.1445307116670627, 842.0453085372717, 268.3132438574514, 98.342686717412, 146.45976055548357, 11.454040499876166, 340.9426308818982, 9.267221290005994, 440.546030674577, -1.7574287641230315, 538.3900383521583, 764.8092352115242, 61.84760167974126, 117.0229387910062, 267.8154337654048, 347.85776243246175, 7.69999999999999, 459.17479048431795, 35.1327896555275, 254.95446608909688, 336.6966372863762, 4.699999999999999, 4.100000000000007, 711.5495538553067, 259.02274283771874, 2.1999999999999993, 446.6037183360975, 40.02158132039263, 125.33765040189085, -108.76613772861782, 5.600000000000003, 359.9869906160485, 7.214118299837152, -105.48237697579493, 94.41589189056515, 65.59020047602317, 208.28102007446617, -10.135965704854947], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-580.9625658235076, -720.070707129705, -672.0617846434346, -212.11411040693412, -711.3104459795835, -719.1516902909682, 384.0083686266236, -661.4558592859527, -822.8214038289516, -115.26946437629408, -86.12165462750065, -781.9632613046144, -227.82518424927787, -55.75207995931391, -714.8632806106824, -251.98993433309587, -177.7554684275561, -262.6066330310738, -76.61134077433398, -989.698024018827, -426.9933433703012, -928.3859640822808, 310.8391942553525, -705.8672536469688, -661.4461730437496, -460.24611345689533, -376.44576924432977, -641.6683613344019, -539.8483781092077, -607.0001343990149, -775.3801849794144, -352.3185819362637, 5.66648507516828, -536.8115162028488, 232.4437533076101, -597.90640408118, -637.9830371226305, -746.8056723519152, -701.571533851645, -559.0385075701496, -290.3763972588308, -634.518162390005, 384.70000000000016, -602.6056167688397, 36.40345470927282, -708.9012004031765, -694.9280143985205, -717.8759712406165, -753.4215808527113, -671.8195282430812, -714.403777578914, -197.57335224489594, -258.1509994695027, -770.0119586328137, 336.9437030256583, -934.4451558381905, -664.0184133856159, -186.00957224193468, -675.3400040742741, -856.1667366023489, 45.361312279692086, -552.7629526009397, -851.3865404651567, -91.49108383002896, -722.8012853378992, -709.669725676653, -752.0891791572581, -413.8796035487708, -790.537629260062, 323.32338727934007, -478.9435073533613, -560.3945701024236, -258.6651578525402, -810.3409193774032, -149.33838317449138, -841.5406089887211, -554.778156775783, -398.8833893649499, -195.70695404289532, -740.6930672330227, 29.181045762176055, -686.2224787507726, -634.3014108975874, -628.2948843143992, -743.5679790004683, -809.87185531534, -564.9453707548084, -618.7343032837665, -535.634346605636, -722.564457609518, -539.4511006222658, -704.2517090535928, -265.257431994224, -662.4414512258103, -449.3107388728186, -824.4882649668363, -657.1065247050442, -173.46828970945342, -817.4937965290139, -246.01240158092446, -800.7607018542385, -647.5429817889594, -881.5977367479414, -553.3770914505059, -745.9629983164934, -544.3498360673027, -695.80717578863, -638.9863351156695, -503.1387274454189, -712.5306846221266, -640.9841170097059, -557.9032027923264, -845.1339470711567, -817.2883731395868, -626.0530913621456, -185.2787028762574, -461.4519603670549, -733.1661160615499, -615.0818019186717, -759.0375789359953, -535.7995498542801, -216.7994488459799, -97.78124454919269, -762.1135405252031, -472.85934736533807, -665.96369055677, -819.6626840886826, 288.7778002276386, -414.2405634360963, -752.9391833024374, -543.7416918729401, -496.3346847673887, -500.77787575542845, -684.9656431572662, -545.9501400761895, -769.1613729616112, -793.8565708492694, -340.0568201315782, -612.1825308261562, -543.249957786906, 22.223360002226062, -775.1881074191705, -651.0594417493837, -701.7280933765904, -689.1343626994624, -109.37695588924944, 398.25303827703067, -775.7615637594386, -627.7757560268875, -807.6235295780705, -368.67670130206665, -366.02527417701333, -463.69842297287664, -644.9597903625357, -561.320590890933, -237.4471464674647, -549.0757526718754, -683.4630957111801, -112.92284423429504, -735.4571799784808, -669.2521345468166, -664.4450954411369, -849.5899832872504, -391.8638571427655, -893.4015659633903, -179.43863396309501, -708.1246840639151, -667.4068270080651, -698.740035180817, -742.7645838601077, -1029.539227410078, 114.71880047511566, -690.3842622500563, -154.30216632774517, -644.9939697959438, -784.3205996099047, 169.1152918596335, -475.2618100082679, -48.985690990125306, -724.1903860159097, -481.7787093352902, -473.794885574163, -128.8310790860365, -658.3256975425915, -839.7635135687137, -625.9012898653108, -1053.3516181439427, -313.49882142656514, -615.3692525770624, -610.3473758525255, -225.9214943379455, -599.001164854905, -708.2790776906465, -723.2408893858241, -573.4908328470824, -659.6412537630417, -835.6182684426079, -273.8315199985565, -744.8991320289646, -62.78195032489225], "policy_predator_policy_reward": [584.7625658235077, 721.5707071297053, 642.8608399466812, 290.9932527928065, 762.0416908265261, 810.3394873089512, 637.8536954437246, 629.3105607587687, 699.6207551485752, 740.2377272817791, 262.37852030822216, 755.5688267949079, 253.4251842492764, 154.74928465064662, 616.9372008821342, 648.9147718434612, 449.40246418432355, 42.56309198358335, 606.4552129713751, 625.7121719577314, 526.2752029151545, 888.8555063245308, 143.6994141453392, 759.0213269533368, 584.1657996316974, 977.1683039240057, 491.72860294521814, 658.0038952403359, 876.5876813787586, 450.7700445936808, 669.8409053264774, 503.9337015592213, 421.1784238925053, 471.8395963699512, 512.4942033112127, 166.34096268883903, 681.7153438275172, 713.4183805880801, 750.5715338516459, 564.0385075701504, 660.3988872572924, 258.12417789494117, 9.0, 606.5056167688406, 10.57178682836036, 711.8012004031768, 687.5579881153344, 716.5202656945713, 754.3215808527115, 676.4195282430809, 646.2677520617153, 621.3653027265314, 592.2201209120901, 733.6276612038066, 521.2960942507077, 740.9526493786713, 629.449911620697, 411.5860750342023, 675.9400040742743, 856.1667366023489, 10.620569313346925, 579.1014743137403, 822.4639819738283, 361.6212511869715, 744.9012853378991, 710.5697256766531, 710.3166364843302, 594.4646008195249, 673.7155185491587, 724.1854754473958, 490.39431862732584, 562.8945701024237, 282.2651578525455, 811.0409193774032, 888.6390021907482, 169.94276502522, 552.3103288684111, 559.9891558949784, 482.338442256542, 634.9277259544907, 250.7745126391514, 686.2224787507726, 639.8014108975882, 628.3948843143992, 750.2935933748872, 859.2839708639659, 573.7453707548094, 618.7343032837665, 539.5343466056369, 722.8644576095179, 584.7261597667022, 675.3279483167468, 229.29727677622796, 704.5909699277853, 636.3326743445917, 830.1429889467738, 653.5181305213991, 370.99695310483645, 798.1859486645702, 355.7599619843107, 833.2039788050265, 614.031417920682, 866.7082332535788, 740.0608025987557, 585.5957359623092, 686.067002550614, 703.0071757886303, 639.4830290872477, 643.8691185795228, 683.5440752480355, 948.1060170592709, 419.0039128153047, 846.0339470711567, 817.6883731395868, 138.20200740125364, 621.751085534004, 497.30311878138104, 734.9661160615503, 618.1818019186716, 759.0375789359953, 699.204070008206, 681.1342614515842, 206.99272014345877, 748.6743391651928, 468.6404801260751, 673.3270885077037, 733.1309556852542, 639.7992367130602, 751.533057965548, 683.9599326304347, 399.2671518702268, 739.1519114875157, 661.1776083118972, 671.0256711562852, 769.1613729616112, 557.404180576067, 687.9901278445947, 786.8658940181513, 613.8409753015258, 550.8587346015438, 698.1466796835359, 495.364098407986, 669.9880809627609, 681.0420253990907, 635.0880949050164, 701.8132620358568, 407.35001096023433, 734.9677497336945, 721.5815678459894, 775.6653194387105, 404.63948617452235, 447.0854280955667, 746.0163426826308, 630.4573044181889, 496.9605564069341, 649.6649433839267, 556.7757526718768, 683.4630957111801, 594.5439722145607, 713.0108424825352, 708.2658553473716, 660.5641642961099, 728.5079368194681, 767.9003696996499, 691.3843520717576, 718.1524851411027, 711.7246840639149, 668.506827008065, 702.8400351808176, 742.7645838601077, 713.395923895676, 912.9740568945891, 634.7441809147596, 468.9649905007644, 647.1939697959444, 784.3205996099047, 633.0680708725364, 119.68216561219475, 86.07997290235733, 727.1176854240701, 601.8784345015705, 479.03281080977604, 15.862567355426938, 662.5280715445831, 841.8635135687139, 629.4012898653108, 954.2866254210263, 772.5508047655343, 614.6891678007205, 618.2415789287064, 716.1437369263263, 3.296545290727474, 788.7902023728413, 737.1456565941947, 638.5810333231077, 660.1412537630418, 728.6238190842165, 589.1069894314165, 754.959362696817, 42.58575395218429]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.593512952157445, "mean_inference_ms": 4.870541868566302, "mean_action_processing_ms": 1.806025916526511, "mean_env_wait_ms": 13.146600624483348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053861141204833984, "StateBufferConnector_ms": 0.004872322082519531, "ViewRequirementAgentConnector_ms": 0.1698465347290039}, "num_episodes": 10, "episode_return_max": 989.7167655431639, "episode_return_min": -108.76613772861782, "episode_return_mean": 178.61852548009043, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.00910409217474, "num_env_steps_trained_throughput_per_sec": 155.00910409217474, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 26341.343, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26341.208, "sample_time_ms": 2589.333, "learn_time_ms": 23729.786, "learn_throughput": 168.565, "synch_weights_time_ms": 19.27}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-13-28", "timestamp": 1724384608, "time_this_iter_s": 25.851001024246216, "time_total_s": 2322.040896177292, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095b4f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2322.040896177292, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 33.34166666666666, "ram_util_percent": 82.87222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.962371872594115, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.237695495666019, "policy_loss": -0.008859398022353176, "vf_loss": 8.245923385922872, "vf_explained_var": 0.040214220682779946, "kl": 0.0063145895408486166, "entropy": 0.22069304725795827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82688.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.039742488457414, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.109360897225677, "policy_loss": -0.011213773323429956, "vf_loss": 8.11956851646383, "vf_explained_var": 0.3784054488101333, "kl": 0.010061720708661057, "entropy": 0.3892889103561482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82688.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 930.6867520158349, "episode_reward_min": -108.76613772861782, "episode_reward_mean": 163.74800583761123, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1053.3516181439427, "predator_policy": 3.296545290727474}, "policy_reward_max": {"prey_policy": 398.25303827703067, "predator_policy": 954.2866254210263}, "policy_reward_mean": {"prey_policy": -532.4801078352793, "predator_policy": 614.3541107540855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.8729891347765, 313.37251522648194, 10.345014941052877, 54.000000000000085, -6.371494496605591, 397.600000000001, 49.875241537633194, -8.725731829230403, 5.5, 355.6559249644398, 297.6848240135762, 664.7472908168521, 191.00800102734894, 0.5999999999999959, 82.32040330583781, 241.20760886561462, 23.000000000000014, 138.8124545978283, 930.6867520158349, 13.950811273962945, 24.300000000000082, 67.70277505274946, 158.63793862265462, 180.86614693511603, 279.9555584013274, 5.599999999999994, 56.1377299230455, 8.79999999999999, 4.200000000000001, 16.351298407587407, 6.189363483975447, 192.6766594517069, 193.9402692117376, 90.43971253894536, -1.0682869174933538, 171.79420765388247, -18.65009587087227, 7.696693971578265, 111.74378176001127, 168.22261007253994, 1.3000000000000007, -51.37870130314442, 37.65115841432573, 3.1000000000000005, 627.7393327595291, 95.77227423425782, 3.1445307116670627, 842.0453085372717, 268.3132438574514, 98.342686717412, 146.45976055548357, 11.454040499876166, 340.9426308818982, 9.267221290005994, 440.546030674577, -1.7574287641230315, 538.3900383521583, 764.8092352115242, 61.84760167974126, 117.0229387910062, 267.8154337654048, 347.85776243246175, 7.69999999999999, 459.17479048431795, 35.1327896555275, 254.95446608909688, 336.6966372863762, 4.699999999999999, 4.100000000000007, 711.5495538553067, 259.02274283771874, 2.1999999999999993, 446.6037183360975, 40.02158132039263, 125.33765040189085, -108.76613772861782, 5.600000000000003, 359.9869906160485, 7.214118299837152, -105.48237697579493, 94.41589189056515, 65.59020047602317, 208.28102007446617, -10.135965704854947, 135.22078653524747, 67.52880831657384, 4.00000000000001, -59.663682671558, 212.4024798331176, 99.55299721835792, 261.3985120028062, 5.763898823016175, 130.95601319874135, 10.900000000000048, 797.7575638004931, 490.4144583378725, 58.09885428737305, -101.73979962245537, 200.58759564992155, 44.36035944453552], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [5.66648507516828, -536.8115162028488, 232.4437533076101, -597.90640408118, -637.9830371226305, -746.8056723519152, -701.571533851645, -559.0385075701496, -290.3763972588308, -634.518162390005, 384.70000000000016, -602.6056167688397, 36.40345470927282, -708.9012004031765, -694.9280143985205, -717.8759712406165, -753.4215808527113, -671.8195282430812, -714.403777578914, -197.57335224489594, -258.1509994695027, -770.0119586328137, 336.9437030256583, -934.4451558381905, -664.0184133856159, -186.00957224193468, -675.3400040742741, -856.1667366023489, 45.361312279692086, -552.7629526009397, -851.3865404651567, -91.49108383002896, -722.8012853378992, -709.669725676653, -752.0891791572581, -413.8796035487708, -790.537629260062, 323.32338727934007, -478.9435073533613, -560.3945701024236, -258.6651578525402, -810.3409193774032, -149.33838317449138, -841.5406089887211, -554.778156775783, -398.8833893649499, -195.70695404289532, -740.6930672330227, 29.181045762176055, -686.2224787507726, -634.3014108975874, -628.2948843143992, -743.5679790004683, -809.87185531534, -564.9453707548084, -618.7343032837665, -535.634346605636, -722.564457609518, -539.4511006222658, -704.2517090535928, -265.257431994224, -662.4414512258103, -449.3107388728186, -824.4882649668363, -657.1065247050442, -173.46828970945342, -817.4937965290139, -246.01240158092446, -800.7607018542385, -647.5429817889594, -881.5977367479414, -553.3770914505059, -745.9629983164934, -544.3498360673027, -695.80717578863, -638.9863351156695, -503.1387274454189, -712.5306846221266, -640.9841170097059, -557.9032027923264, -845.1339470711567, -817.2883731395868, -626.0530913621456, -185.2787028762574, -461.4519603670549, -733.1661160615499, -615.0818019186717, -759.0375789359953, -535.7995498542801, -216.7994488459799, -97.78124454919269, -762.1135405252031, -472.85934736533807, -665.96369055677, -819.6626840886826, 288.7778002276386, -414.2405634360963, -752.9391833024374, -543.7416918729401, -496.3346847673887, -500.77787575542845, -684.9656431572662, -545.9501400761895, -769.1613729616112, -793.8565708492694, -340.0568201315782, -612.1825308261562, -543.249957786906, 22.223360002226062, -775.1881074191705, -651.0594417493837, -701.7280933765904, -689.1343626994624, -109.37695588924944, 398.25303827703067, -775.7615637594386, -627.7757560268875, -807.6235295780705, -368.67670130206665, -366.02527417701333, -463.69842297287664, -644.9597903625357, -561.320590890933, -237.4471464674647, -549.0757526718754, -683.4630957111801, -112.92284423429504, -735.4571799784808, -669.2521345468166, -664.4450954411369, -849.5899832872504, -391.8638571427655, -893.4015659633903, -179.43863396309501, -708.1246840639151, -667.4068270080651, -698.740035180817, -742.7645838601077, -1029.539227410078, 114.71880047511566, -690.3842622500563, -154.30216632774517, -644.9939697959438, -784.3205996099047, 169.1152918596335, -475.2618100082679, -48.985690990125306, -724.1903860159097, -481.7787093352902, -473.794885574163, -128.8310790860365, -658.3256975425915, -839.7635135687137, -625.9012898653108, -1053.3516181439427, -313.49882142656514, -615.3692525770624, -610.3473758525255, -225.9214943379455, -599.001164854905, -708.2790776906465, -723.2408893858241, -573.4908328470824, -659.6412537630417, -835.6182684426079, -273.8315199985565, -744.8991320289646, -62.78195032489225, 40.0000000000003, -734.1717403263192, -708.9442970264893, -708.848786182104, -826.194290163443, -687.6856580921517, -625.4552617673667, -641.9878992021128, -160.8886701643499, -786.7298800324785, -657.6629689991915, -566.7709521037434, -293.8589880342149, -568.0898325352317, -660.0188333714964, -678.4530284959537, -699.204564181299, -499.95385111023177, -465.39334426365065, -703.5690794207826, -832.1605398661917, 244.73692433953298, -1005.4480077128238, -220.72449115813234, -804.3345316752873, -383.12045671677504, -799.9778458546957, -150.7286244637887, -598.6946212049513, -542.4710427405888, -520.8083058988491, -748.2772579525125], "policy_predator_policy_reward": [421.1784238925053, 471.8395963699512, 512.4942033112127, 166.34096268883903, 681.7153438275172, 713.4183805880801, 750.5715338516459, 564.0385075701504, 660.3988872572924, 258.12417789494117, 9.0, 606.5056167688406, 10.57178682836036, 711.8012004031768, 687.5579881153344, 716.5202656945713, 754.3215808527115, 676.4195282430809, 646.2677520617153, 621.3653027265314, 592.2201209120901, 733.6276612038066, 521.2960942507077, 740.9526493786713, 629.449911620697, 411.5860750342023, 675.9400040742743, 856.1667366023489, 10.620569313346925, 579.1014743137403, 822.4639819738283, 361.6212511869715, 744.9012853378991, 710.5697256766531, 710.3166364843302, 594.4646008195249, 673.7155185491587, 724.1854754473958, 490.39431862732584, 562.8945701024237, 282.2651578525455, 811.0409193774032, 888.6390021907482, 169.94276502522, 552.3103288684111, 559.9891558949784, 482.338442256542, 634.9277259544907, 250.7745126391514, 686.2224787507726, 639.8014108975882, 628.3948843143992, 750.2935933748872, 859.2839708639659, 573.7453707548094, 618.7343032837665, 539.5343466056369, 722.8644576095179, 584.7261597667022, 675.3279483167468, 229.29727677622796, 704.5909699277853, 636.3326743445917, 830.1429889467738, 653.5181305213991, 370.99695310483645, 798.1859486645702, 355.7599619843107, 833.2039788050265, 614.031417920682, 866.7082332535788, 740.0608025987557, 585.5957359623092, 686.067002550614, 703.0071757886303, 639.4830290872477, 643.8691185795228, 683.5440752480355, 948.1060170592709, 419.0039128153047, 846.0339470711567, 817.6883731395868, 138.20200740125364, 621.751085534004, 497.30311878138104, 734.9661160615503, 618.1818019186716, 759.0375789359953, 699.204070008206, 681.1342614515842, 206.99272014345877, 748.6743391651928, 468.6404801260751, 673.3270885077037, 733.1309556852542, 639.7992367130602, 751.533057965548, 683.9599326304347, 399.2671518702268, 739.1519114875157, 661.1776083118972, 671.0256711562852, 769.1613729616112, 557.404180576067, 687.9901278445947, 786.8658940181513, 613.8409753015258, 550.8587346015438, 698.1466796835359, 495.364098407986, 669.9880809627609, 681.0420253990907, 635.0880949050164, 701.8132620358568, 407.35001096023433, 734.9677497336945, 721.5815678459894, 775.6653194387105, 404.63948617452235, 447.0854280955667, 746.0163426826308, 630.4573044181889, 496.9605564069341, 649.6649433839267, 556.7757526718768, 683.4630957111801, 594.5439722145607, 713.0108424825352, 708.2658553473716, 660.5641642961099, 728.5079368194681, 767.9003696996499, 691.3843520717576, 718.1524851411027, 711.7246840639149, 668.506827008065, 702.8400351808176, 742.7645838601077, 713.395923895676, 912.9740568945891, 634.7441809147596, 468.9649905007644, 647.1939697959444, 784.3205996099047, 633.0680708725364, 119.68216561219475, 86.07997290235733, 727.1176854240701, 601.8784345015705, 479.03281080977604, 15.862567355426938, 662.5280715445831, 841.8635135687139, 629.4012898653108, 954.2866254210263, 772.5508047655343, 614.6891678007205, 618.2415789287064, 716.1437369263263, 3.296545290727474, 788.7902023728413, 737.1456565941947, 638.5810333231077, 660.1412537630418, 728.6238190842165, 589.1069894314165, 754.959362696817, 42.58575395218429, 95.86986595614955, 733.5226609054178, 796.937007496115, 688.3848840290564, 826.194290163443, 691.6856580921526, 570.2905081274382, 637.4889701704853, 337.79303209224724, 822.2279979377008, 742.9009429164271, 581.0859754048705, 783.0738278404764, 340.27350473177734, 656.0997446432508, 688.1360160472166, 673.6083977632385, 656.5060307270326, 476.29334426365097, 703.5690794207826, 775.8807331050075, 609.3004462221451, 878.7247234529475, 837.8622337558796, 670.6889429022777, 574.8648997771613, 814.9745133527928, 33.992157343236634, 614.6305264678896, 727.1227331275749, 694.4099076231801, 619.0360156727197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.580712282366443, "mean_inference_ms": 4.868444612178991, "mean_action_processing_ms": 1.8152858115727752, "mean_env_wait_ms": 13.138652674377731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054939985275268555, "StateBufferConnector_ms": 0.004799842834472656, "ViewRequirementAgentConnector_ms": 0.17665040493011475}, "num_episodes": 16, "episode_return_max": 930.6867520158349, "episode_return_min": -108.76613772861782, "episode_return_mean": 163.74800583761123, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.3976010597786, "num_env_steps_trained_throughput_per_sec": 151.3976010597786, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 26362.278, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26362.148, "sample_time_ms": 2598.577, "learn_time_ms": 23741.479, "learn_throughput": 168.482, "synch_weights_time_ms": 19.354}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-13-55", "timestamp": 1724384635, "time_this_iter_s": 26.474114894866943, "time_total_s": 2348.515011072159, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309667c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2348.515011072159, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 34.65263157894737, "ram_util_percent": 82.73157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.36882082318503, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.037421081684254, "policy_loss": -0.0074006809941714715, "vf_loss": 8.044254803531384, "vf_explained_var": -0.09800790642935132, "kl": 0.005669598183323624, "entropy": 0.231328953148196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 83633.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.498923502018844, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.072169876098632, "policy_loss": -0.007651003741871112, "vf_loss": 8.07894759354768, "vf_explained_var": 0.38887429748262675, "kl": 0.00873269299020567, "entropy": 0.4040035307407379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 83633.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 930.6867520158349, "episode_reward_min": -208.85097708888046, "episode_reward_mean": 151.76060235987467, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1053.3516181439427, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.25303827703067, "predator_policy": 954.2866254210263}, "policy_reward_mean": {"prey_policy": -540.2199038965896, "predator_policy": 616.1002050765275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.6848240135762, 664.7472908168521, 191.00800102734894, 0.5999999999999959, 82.32040330583781, 241.20760886561462, 23.000000000000014, 138.8124545978283, 930.6867520158349, 13.950811273962945, 24.300000000000082, 67.70277505274946, 158.63793862265462, 180.86614693511603, 279.9555584013274, 5.599999999999994, 56.1377299230455, 8.79999999999999, 4.200000000000001, 16.351298407587407, 6.189363483975447, 192.6766594517069, 193.9402692117376, 90.43971253894536, -1.0682869174933538, 171.79420765388247, -18.65009587087227, 7.696693971578265, 111.74378176001127, 168.22261007253994, 1.3000000000000007, -51.37870130314442, 37.65115841432573, 3.1000000000000005, 627.7393327595291, 95.77227423425782, 3.1445307116670627, 842.0453085372717, 268.3132438574514, 98.342686717412, 146.45976055548357, 11.454040499876166, 340.9426308818982, 9.267221290005994, 440.546030674577, -1.7574287641230315, 538.3900383521583, 764.8092352115242, 61.84760167974126, 117.0229387910062, 267.8154337654048, 347.85776243246175, 7.69999999999999, 459.17479048431795, 35.1327896555275, 254.95446608909688, 336.6966372863762, 4.699999999999999, 4.100000000000007, 711.5495538553067, 259.02274283771874, 2.1999999999999993, 446.6037183360975, 40.02158132039263, 125.33765040189085, -108.76613772861782, 5.600000000000003, 359.9869906160485, 7.214118299837152, -105.48237697579493, 94.41589189056515, 65.59020047602317, 208.28102007446617, -10.135965704854947, 135.22078653524747, 67.52880831657384, 4.00000000000001, -59.663682671558, 212.4024798331176, 99.55299721835792, 261.3985120028062, 5.763898823016175, 130.95601319874135, 10.900000000000048, 797.7575638004931, 490.4144583378725, 58.09885428737305, -101.73979962245537, 200.58759564992155, 44.36035944453552, 243.7593115626855, 9.859707670888456, 358.46249965544894, 19.30000000000001, 10.999999999999993, -44.12240906013313, -86.93872894654905, 9.785527836582462, 22.129180074849483, -208.85097708888046], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-258.1509994695027, -770.0119586328137, 336.9437030256583, -934.4451558381905, -664.0184133856159, -186.00957224193468, -675.3400040742741, -856.1667366023489, 45.361312279692086, -552.7629526009397, -851.3865404651567, -91.49108383002896, -722.8012853378992, -709.669725676653, -752.0891791572581, -413.8796035487708, -790.537629260062, 323.32338727934007, -478.9435073533613, -560.3945701024236, -258.6651578525402, -810.3409193774032, -149.33838317449138, -841.5406089887211, -554.778156775783, -398.8833893649499, -195.70695404289532, -740.6930672330227, 29.181045762176055, -686.2224787507726, -634.3014108975874, -628.2948843143992, -743.5679790004683, -809.87185531534, -564.9453707548084, -618.7343032837665, -535.634346605636, -722.564457609518, -539.4511006222658, -704.2517090535928, -265.257431994224, -662.4414512258103, -449.3107388728186, -824.4882649668363, -657.1065247050442, -173.46828970945342, -817.4937965290139, -246.01240158092446, -800.7607018542385, -647.5429817889594, -881.5977367479414, -553.3770914505059, -745.9629983164934, -544.3498360673027, -695.80717578863, -638.9863351156695, -503.1387274454189, -712.5306846221266, -640.9841170097059, -557.9032027923264, -845.1339470711567, -817.2883731395868, -626.0530913621456, -185.2787028762574, -461.4519603670549, -733.1661160615499, -615.0818019186717, -759.0375789359953, -535.7995498542801, -216.7994488459799, -97.78124454919269, -762.1135405252031, -472.85934736533807, -665.96369055677, -819.6626840886826, 288.7778002276386, -414.2405634360963, -752.9391833024374, -543.7416918729401, -496.3346847673887, -500.77787575542845, -684.9656431572662, -545.9501400761895, -769.1613729616112, -793.8565708492694, -340.0568201315782, -612.1825308261562, -543.249957786906, 22.223360002226062, -775.1881074191705, -651.0594417493837, -701.7280933765904, -689.1343626994624, -109.37695588924944, 398.25303827703067, -775.7615637594386, -627.7757560268875, -807.6235295780705, -368.67670130206665, -366.02527417701333, -463.69842297287664, -644.9597903625357, -561.320590890933, -237.4471464674647, -549.0757526718754, -683.4630957111801, -112.92284423429504, -735.4571799784808, -669.2521345468166, -664.4450954411369, -849.5899832872504, -391.8638571427655, -893.4015659633903, -179.43863396309501, -708.1246840639151, -667.4068270080651, -698.740035180817, -742.7645838601077, -1029.539227410078, 114.71880047511566, -690.3842622500563, -154.30216632774517, -644.9939697959438, -784.3205996099047, 169.1152918596335, -475.2618100082679, -48.985690990125306, -724.1903860159097, -481.7787093352902, -473.794885574163, -128.8310790860365, -658.3256975425915, -839.7635135687137, -625.9012898653108, -1053.3516181439427, -313.49882142656514, -615.3692525770624, -610.3473758525255, -225.9214943379455, -599.001164854905, -708.2790776906465, -723.2408893858241, -573.4908328470824, -659.6412537630417, -835.6182684426079, -273.8315199985565, -744.8991320289646, -62.78195032489225, 40.0000000000003, -734.1717403263192, -708.9442970264893, -708.848786182104, -826.194290163443, -687.6856580921517, -625.4552617673667, -641.9878992021128, -160.8886701643499, -786.7298800324785, -657.6629689991915, -566.7709521037434, -293.8589880342149, -568.0898325352317, -660.0188333714964, -678.4530284959537, -699.204564181299, -499.95385111023177, -465.39334426365065, -703.5690794207826, -832.1605398661917, 244.73692433953298, -1005.4480077128238, -220.72449115813234, -804.3345316752873, -383.12045671677504, -799.9778458546957, -150.7286244637887, -598.6946212049513, -542.4710427405888, -520.8083058988491, -748.2772579525125, -694.8735499620112, -58.4698072206467, -563.2947764749772, -598.449884073304, -362.1870230831063, -165.70040682747648, -583.9472655715509, -633.0099164556921, -500.18134992532276, -691.4160840540428, -661.6351162833587, -513.4887212121029, -818.2921766192818, -469.2597637343606, -519.1033644746844, -604.278309895078, -708.4116800730094, -549.9533277968306, -301.4393365806542, -657.8939314124607], "policy_predator_policy_reward": [592.2201209120901, 733.6276612038066, 521.2960942507077, 740.9526493786713, 629.449911620697, 411.5860750342023, 675.9400040742743, 856.1667366023489, 10.620569313346925, 579.1014743137403, 822.4639819738283, 361.6212511869715, 744.9012853378991, 710.5697256766531, 710.3166364843302, 594.4646008195249, 673.7155185491587, 724.1854754473958, 490.39431862732584, 562.8945701024237, 282.2651578525455, 811.0409193774032, 888.6390021907482, 169.94276502522, 552.3103288684111, 559.9891558949784, 482.338442256542, 634.9277259544907, 250.7745126391514, 686.2224787507726, 639.8014108975882, 628.3948843143992, 750.2935933748872, 859.2839708639659, 573.7453707548094, 618.7343032837665, 539.5343466056369, 722.8644576095179, 584.7261597667022, 675.3279483167468, 229.29727677622796, 704.5909699277853, 636.3326743445917, 830.1429889467738, 653.5181305213991, 370.99695310483645, 798.1859486645702, 355.7599619843107, 833.2039788050265, 614.031417920682, 866.7082332535788, 740.0608025987557, 585.5957359623092, 686.067002550614, 703.0071757886303, 639.4830290872477, 643.8691185795228, 683.5440752480355, 948.1060170592709, 419.0039128153047, 846.0339470711567, 817.6883731395868, 138.20200740125364, 621.751085534004, 497.30311878138104, 734.9661160615503, 618.1818019186716, 759.0375789359953, 699.204070008206, 681.1342614515842, 206.99272014345877, 748.6743391651928, 468.6404801260751, 673.3270885077037, 733.1309556852542, 639.7992367130602, 751.533057965548, 683.9599326304347, 399.2671518702268, 739.1519114875157, 661.1776083118972, 671.0256711562852, 769.1613729616112, 557.404180576067, 687.9901278445947, 786.8658940181513, 613.8409753015258, 550.8587346015438, 698.1466796835359, 495.364098407986, 669.9880809627609, 681.0420253990907, 635.0880949050164, 701.8132620358568, 407.35001096023433, 734.9677497336945, 721.5815678459894, 775.6653194387105, 404.63948617452235, 447.0854280955667, 746.0163426826308, 630.4573044181889, 496.9605564069341, 649.6649433839267, 556.7757526718768, 683.4630957111801, 594.5439722145607, 713.0108424825352, 708.2658553473716, 660.5641642961099, 728.5079368194681, 767.9003696996499, 691.3843520717576, 718.1524851411027, 711.7246840639149, 668.506827008065, 702.8400351808176, 742.7645838601077, 713.395923895676, 912.9740568945891, 634.7441809147596, 468.9649905007644, 647.1939697959444, 784.3205996099047, 633.0680708725364, 119.68216561219475, 86.07997290235733, 727.1176854240701, 601.8784345015705, 479.03281080977604, 15.862567355426938, 662.5280715445831, 841.8635135687139, 629.4012898653108, 954.2866254210263, 772.5508047655343, 614.6891678007205, 618.2415789287064, 716.1437369263263, 3.296545290727474, 788.7902023728413, 737.1456565941947, 638.5810333231077, 660.1412537630418, 728.6238190842165, 589.1069894314165, 754.959362696817, 42.58575395218429, 95.86986595614955, 733.5226609054178, 796.937007496115, 688.3848840290564, 826.194290163443, 691.6856580921526, 570.2905081274382, 637.4889701704853, 337.79303209224724, 822.2279979377008, 742.9009429164271, 581.0859754048705, 783.0738278404764, 340.27350473177734, 656.0997446432508, 688.1360160472166, 673.6083977632385, 656.5060307270326, 476.29334426365097, 703.5690794207826, 775.8807331050075, 609.3004462221451, 878.7247234529475, 837.8622337558796, 670.6889429022777, 574.8648997771613, 814.9745133527928, 33.992157343236634, 614.6305264678896, 727.1227331275749, 694.4099076231801, 619.0360156727197, 662.4642413132233, 334.6384274321224, 569.4456575518401, 602.1587106673322, 695.8896007194918, 190.46032884654, 599.4472655715513, 636.809916455692, 510.08134992532274, 692.5160840540428, 736.6622527658394, 394.3391756694915, 844.2743748313482, 356.338836575749, 526.403364474685, 606.7638377316605, 613.7804500000747, 666.7137379446164, 750.4822909042351, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.573595741927145, "mean_inference_ms": 4.8651664308597615, "mean_action_processing_ms": 1.814495686089321, "mean_env_wait_ms": 13.14802043597227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00549924373626709, "StateBufferConnector_ms": 0.005977630615234375, "ViewRequirementAgentConnector_ms": 0.1784048080444336}, "num_episodes": 10, "episode_return_max": 930.6867520158349, "episode_return_min": -208.85097708888046, "episode_return_mean": 151.76060235987467, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.28824952067984, "num_env_steps_trained_throughput_per_sec": 154.28824952067984, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 26314.034, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26313.913, "sample_time_ms": 2568.554, "learn_time_ms": 23723.706, "learn_throughput": 168.608, "synch_weights_time_ms": 19.242}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-14-21", "timestamp": 1724384661, "time_this_iter_s": 25.95359206199646, "time_total_s": 2374.4686031341553, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309681c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2374.4686031341553, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 33.34444444444444, "ram_util_percent": 82.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.242902092202, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.933687299899954, "policy_loss": -0.00825488177477998, "vf_loss": 7.94132728728037, "vf_explained_var": 0.05358525653364797, "kl": 0.006148701219169038, "entropy": 0.24305830629414352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84578.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.91680561701457, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.811316680403613, "policy_loss": -0.0077453007675194864, "vf_loss": 7.818322898723461, "vf_explained_var": 0.5130070800503725, "kl": 0.007390768649352212, "entropy": 0.4459992131543538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84578.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 842.0453085372717, "episode_reward_min": -208.85097708888046, "episode_reward_mean": 143.4878442088546, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1053.3516181439427, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.25303827703067, "predator_policy": 954.2866254210263}, "policy_reward_mean": {"prey_policy": -541.5638518679048, "predator_policy": 613.3077739723326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.950811273962945, 24.300000000000082, 67.70277505274946, 158.63793862265462, 180.86614693511603, 279.9555584013274, 5.599999999999994, 56.1377299230455, 8.79999999999999, 4.200000000000001, 16.351298407587407, 6.189363483975447, 192.6766594517069, 193.9402692117376, 90.43971253894536, -1.0682869174933538, 171.79420765388247, -18.65009587087227, 7.696693971578265, 111.74378176001127, 168.22261007253994, 1.3000000000000007, -51.37870130314442, 37.65115841432573, 3.1000000000000005, 627.7393327595291, 95.77227423425782, 3.1445307116670627, 842.0453085372717, 268.3132438574514, 98.342686717412, 146.45976055548357, 11.454040499876166, 340.9426308818982, 9.267221290005994, 440.546030674577, -1.7574287641230315, 538.3900383521583, 764.8092352115242, 61.84760167974126, 117.0229387910062, 267.8154337654048, 347.85776243246175, 7.69999999999999, 459.17479048431795, 35.1327896555275, 254.95446608909688, 336.6966372863762, 4.699999999999999, 4.100000000000007, 711.5495538553067, 259.02274283771874, 2.1999999999999993, 446.6037183360975, 40.02158132039263, 125.33765040189085, -108.76613772861782, 5.600000000000003, 359.9869906160485, 7.214118299837152, -105.48237697579493, 94.41589189056515, 65.59020047602317, 208.28102007446617, -10.135965704854947, 135.22078653524747, 67.52880831657384, 4.00000000000001, -59.663682671558, 212.4024798331176, 99.55299721835792, 261.3985120028062, 5.763898823016175, 130.95601319874135, 10.900000000000048, 797.7575638004931, 490.4144583378725, 58.09885428737305, -101.73979962245537, 200.58759564992155, 44.36035944453552, 243.7593115626855, 9.859707670888456, 358.46249965544894, 19.30000000000001, 10.999999999999993, -44.12240906013313, -86.93872894654905, 9.785527836582462, 22.129180074849483, -208.85097708888046, 281.92846948608667, 360.6373655956605, 1.0763813104869113, 41.30000000000031, 39.60683040113031, 503.02509198746054, 12.39999999999997, 490.6173807600626, 12.199999999999976], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-478.9435073533613, -560.3945701024236, -258.6651578525402, -810.3409193774032, -149.33838317449138, -841.5406089887211, -554.778156775783, -398.8833893649499, -195.70695404289532, -740.6930672330227, 29.181045762176055, -686.2224787507726, -634.3014108975874, -628.2948843143992, -743.5679790004683, -809.87185531534, -564.9453707548084, -618.7343032837665, -535.634346605636, -722.564457609518, -539.4511006222658, -704.2517090535928, -265.257431994224, -662.4414512258103, -449.3107388728186, -824.4882649668363, -657.1065247050442, -173.46828970945342, -817.4937965290139, -246.01240158092446, -800.7607018542385, -647.5429817889594, -881.5977367479414, -553.3770914505059, -745.9629983164934, -544.3498360673027, -695.80717578863, -638.9863351156695, -503.1387274454189, -712.5306846221266, -640.9841170097059, -557.9032027923264, -845.1339470711567, -817.2883731395868, -626.0530913621456, -185.2787028762574, -461.4519603670549, -733.1661160615499, -615.0818019186717, -759.0375789359953, -535.7995498542801, -216.7994488459799, -97.78124454919269, -762.1135405252031, -472.85934736533807, -665.96369055677, -819.6626840886826, 288.7778002276386, -414.2405634360963, -752.9391833024374, -543.7416918729401, -496.3346847673887, -500.77787575542845, -684.9656431572662, -545.9501400761895, -769.1613729616112, -793.8565708492694, -340.0568201315782, -612.1825308261562, -543.249957786906, 22.223360002226062, -775.1881074191705, -651.0594417493837, -701.7280933765904, -689.1343626994624, -109.37695588924944, 398.25303827703067, -775.7615637594386, -627.7757560268875, -807.6235295780705, -368.67670130206665, -366.02527417701333, -463.69842297287664, -644.9597903625357, -561.320590890933, -237.4471464674647, -549.0757526718754, -683.4630957111801, -112.92284423429504, -735.4571799784808, -669.2521345468166, -664.4450954411369, -849.5899832872504, -391.8638571427655, -893.4015659633903, -179.43863396309501, -708.1246840639151, -667.4068270080651, -698.740035180817, -742.7645838601077, -1029.539227410078, 114.71880047511566, -690.3842622500563, -154.30216632774517, -644.9939697959438, -784.3205996099047, 169.1152918596335, -475.2618100082679, -48.985690990125306, -724.1903860159097, -481.7787093352902, -473.794885574163, -128.8310790860365, -658.3256975425915, -839.7635135687137, -625.9012898653108, -1053.3516181439427, -313.49882142656514, -615.3692525770624, -610.3473758525255, -225.9214943379455, -599.001164854905, -708.2790776906465, -723.2408893858241, -573.4908328470824, -659.6412537630417, -835.6182684426079, -273.8315199985565, -744.8991320289646, -62.78195032489225, 40.0000000000003, -734.1717403263192, -708.9442970264893, -708.848786182104, -826.194290163443, -687.6856580921517, -625.4552617673667, -641.9878992021128, -160.8886701643499, -786.7298800324785, -657.6629689991915, -566.7709521037434, -293.8589880342149, -568.0898325352317, -660.0188333714964, -678.4530284959537, -699.204564181299, -499.95385111023177, -465.39334426365065, -703.5690794207826, -832.1605398661917, 244.73692433953298, -1005.4480077128238, -220.72449115813234, -804.3345316752873, -383.12045671677504, -799.9778458546957, -150.7286244637887, -598.6946212049513, -542.4710427405888, -520.8083058988491, -748.2772579525125, -694.8735499620112, -58.4698072206467, -563.2947764749772, -598.449884073304, -362.1870230831063, -165.70040682747648, -583.9472655715509, -633.0099164556921, -500.18134992532276, -691.4160840540428, -661.6351162833587, -513.4887212121029, -818.2921766192818, -469.2597637343606, -519.1033644746844, -604.278309895078, -708.4116800730094, -549.9533277968306, -301.4393365806542, -657.8939314124607, -318.2903985611945, -865.1082318150991, -28.91383271119937, -722.622436705465, -366.40878701619636, -317.4411147434406, 40.0000000000003, -744.079823455206, -656.2685282757277, -572.1867464726315, -724.966987189173, -53.53744720873192, -667.9870039728407, -615.8909017421623, -775.167578039757, -147.45991632650453, -611.8742780623516, -643.7180195021122], "policy_predator_policy_reward": [490.39431862732584, 562.8945701024237, 282.2651578525455, 811.0409193774032, 888.6390021907482, 169.94276502522, 552.3103288684111, 559.9891558949784, 482.338442256542, 634.9277259544907, 250.7745126391514, 686.2224787507726, 639.8014108975882, 628.3948843143992, 750.2935933748872, 859.2839708639659, 573.7453707548094, 618.7343032837665, 539.5343466056369, 722.8644576095179, 584.7261597667022, 675.3279483167468, 229.29727677622796, 704.5909699277853, 636.3326743445917, 830.1429889467738, 653.5181305213991, 370.99695310483645, 798.1859486645702, 355.7599619843107, 833.2039788050265, 614.031417920682, 866.7082332535788, 740.0608025987557, 585.5957359623092, 686.067002550614, 703.0071757886303, 639.4830290872477, 643.8691185795228, 683.5440752480355, 948.1060170592709, 419.0039128153047, 846.0339470711567, 817.6883731395868, 138.20200740125364, 621.751085534004, 497.30311878138104, 734.9661160615503, 618.1818019186716, 759.0375789359953, 699.204070008206, 681.1342614515842, 206.99272014345877, 748.6743391651928, 468.6404801260751, 673.3270885077037, 733.1309556852542, 639.7992367130602, 751.533057965548, 683.9599326304347, 399.2671518702268, 739.1519114875157, 661.1776083118972, 671.0256711562852, 769.1613729616112, 557.404180576067, 687.9901278445947, 786.8658940181513, 613.8409753015258, 550.8587346015438, 698.1466796835359, 495.364098407986, 669.9880809627609, 681.0420253990907, 635.0880949050164, 701.8132620358568, 407.35001096023433, 734.9677497336945, 721.5815678459894, 775.6653194387105, 404.63948617452235, 447.0854280955667, 746.0163426826308, 630.4573044181889, 496.9605564069341, 649.6649433839267, 556.7757526718768, 683.4630957111801, 594.5439722145607, 713.0108424825352, 708.2658553473716, 660.5641642961099, 728.5079368194681, 767.9003696996499, 691.3843520717576, 718.1524851411027, 711.7246840639149, 668.506827008065, 702.8400351808176, 742.7645838601077, 713.395923895676, 912.9740568945891, 634.7441809147596, 468.9649905007644, 647.1939697959444, 784.3205996099047, 633.0680708725364, 119.68216561219475, 86.07997290235733, 727.1176854240701, 601.8784345015705, 479.03281080977604, 15.862567355426938, 662.5280715445831, 841.8635135687139, 629.4012898653108, 954.2866254210263, 772.5508047655343, 614.6891678007205, 618.2415789287064, 716.1437369263263, 3.296545290727474, 788.7902023728413, 737.1456565941947, 638.5810333231077, 660.1412537630418, 728.6238190842165, 589.1069894314165, 754.959362696817, 42.58575395218429, 95.86986595614955, 733.5226609054178, 796.937007496115, 688.3848840290564, 826.194290163443, 691.6856580921526, 570.2905081274382, 637.4889701704853, 337.79303209224724, 822.2279979377008, 742.9009429164271, 581.0859754048705, 783.0738278404764, 340.27350473177734, 656.0997446432508, 688.1360160472166, 673.6083977632385, 656.5060307270326, 476.29334426365097, 703.5690794207826, 775.8807331050075, 609.3004462221451, 878.7247234529475, 837.8622337558796, 670.6889429022777, 574.8648997771613, 814.9745133527928, 33.992157343236634, 614.6305264678896, 727.1227331275749, 694.4099076231801, 619.0360156727197, 662.4642413132233, 334.6384274321224, 569.4456575518401, 602.1587106673322, 695.8896007194918, 190.46032884654, 599.4472655715513, 636.809916455692, 510.08134992532274, 692.5160840540428, 736.6622527658394, 394.3391756694915, 844.2743748313482, 356.338836575749, 526.403364474685, 606.7638377316605, 613.7804500000747, 666.7137379446164, 750.4822909042351, 0.0, 923.0485277348629, 542.2785721275202, 489.95253772276993, 622.2210972895507, 103.13018718214346, 581.7960958879831, 0.0, 745.379823455206, 612.2091629057483, 655.8529422437401, 633.3711134196578, 648.1584129657093, 671.5870039728418, 624.6909017421633, 716.3817113662428, 696.8631637600804, 619.9742780623519, 647.8180195021131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.577605480628233, "mean_inference_ms": 4.86810875095991, "mean_action_processing_ms": 1.8010656440224142, "mean_env_wait_ms": 13.164000787356036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005341887474060059, "StateBufferConnector_ms": 0.005858778953552246, "ViewRequirementAgentConnector_ms": 0.18633508682250977}, "num_episodes": 9, "episode_return_max": 842.0453085372717, "episode_return_min": -208.85097708888046, "episode_return_mean": 143.4878442088546, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.01304429718712, "num_env_steps_trained_throughput_per_sec": 154.01304429718712, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 26237.782, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26237.658, "sample_time_ms": 2465.72, "learn_time_ms": 23748.839, "learn_throughput": 168.429, "synch_weights_time_ms": 20.636}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-14-47", "timestamp": 1724384687, "time_this_iter_s": 26.013590097427368, "time_total_s": 2400.4821932315826, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309681e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2400.4821932315826, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 34.362162162162164, "ram_util_percent": 82.59189189189189}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.851994082536645, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.02796641808969, "policy_loss": -0.008383816871397868, "vf_loss": 8.035805881338776, "vf_explained_var": 0.12207807548462399, "kl": 0.0054437317074862894, "entropy": 0.22723762782477827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85523.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.67305871469003, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.641873027155639, "policy_loss": -0.00912250668037111, "vf_loss": 7.650152985507218, "vf_explained_var": 0.5336209461171791, "kl": 0.008425582550889836, "entropy": 0.4603469212849935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85523.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 842.0453085372717, "episode_reward_min": -208.85097708888046, "episode_reward_mean": 140.5090462946785, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1053.3516181439427, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.25303827703067, "predator_policy": 954.2866254210263}, "policy_reward_mean": {"prey_policy": -551.1597004853144, "predator_policy": 621.4142236326543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.351298407587407, 6.189363483975447, 192.6766594517069, 193.9402692117376, 90.43971253894536, -1.0682869174933538, 171.79420765388247, -18.65009587087227, 7.696693971578265, 111.74378176001127, 168.22261007253994, 1.3000000000000007, -51.37870130314442, 37.65115841432573, 3.1000000000000005, 627.7393327595291, 95.77227423425782, 3.1445307116670627, 842.0453085372717, 268.3132438574514, 98.342686717412, 146.45976055548357, 11.454040499876166, 340.9426308818982, 9.267221290005994, 440.546030674577, -1.7574287641230315, 538.3900383521583, 764.8092352115242, 61.84760167974126, 117.0229387910062, 267.8154337654048, 347.85776243246175, 7.69999999999999, 459.17479048431795, 35.1327896555275, 254.95446608909688, 336.6966372863762, 4.699999999999999, 4.100000000000007, 711.5495538553067, 259.02274283771874, 2.1999999999999993, 446.6037183360975, 40.02158132039263, 125.33765040189085, -108.76613772861782, 5.600000000000003, 359.9869906160485, 7.214118299837152, -105.48237697579493, 94.41589189056515, 65.59020047602317, 208.28102007446617, -10.135965704854947, 135.22078653524747, 67.52880831657384, 4.00000000000001, -59.663682671558, 212.4024798331176, 99.55299721835792, 261.3985120028062, 5.763898823016175, 130.95601319874135, 10.900000000000048, 797.7575638004931, 490.4144583378725, 58.09885428737305, -101.73979962245537, 200.58759564992155, 44.36035944453552, 243.7593115626855, 9.859707670888456, 358.46249965544894, 19.30000000000001, 10.999999999999993, -44.12240906013313, -86.93872894654905, 9.785527836582462, 22.129180074849483, -208.85097708888046, 281.92846948608667, 360.6373655956605, 1.0763813104869113, 41.30000000000031, 39.60683040113031, 503.02509198746054, 12.39999999999997, 490.6173807600626, 12.199999999999976, 4.699999999999999, 1.0845579478236425, 4.199999999999999, 4.500000000000002, -3.663435529611337, 60.93591322679815, 283.55883573945806, 115.33623811932246, 2.699999999999995, 28.91905928745648], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-539.4511006222658, -704.2517090535928, -265.257431994224, -662.4414512258103, -449.3107388728186, -824.4882649668363, -657.1065247050442, -173.46828970945342, -817.4937965290139, -246.01240158092446, -800.7607018542385, -647.5429817889594, -881.5977367479414, -553.3770914505059, -745.9629983164934, -544.3498360673027, -695.80717578863, -638.9863351156695, -503.1387274454189, -712.5306846221266, -640.9841170097059, -557.9032027923264, -845.1339470711567, -817.2883731395868, -626.0530913621456, -185.2787028762574, -461.4519603670549, -733.1661160615499, -615.0818019186717, -759.0375789359953, -535.7995498542801, -216.7994488459799, -97.78124454919269, -762.1135405252031, -472.85934736533807, -665.96369055677, -819.6626840886826, 288.7778002276386, -414.2405634360963, -752.9391833024374, -543.7416918729401, -496.3346847673887, -500.77787575542845, -684.9656431572662, -545.9501400761895, -769.1613729616112, -793.8565708492694, -340.0568201315782, -612.1825308261562, -543.249957786906, 22.223360002226062, -775.1881074191705, -651.0594417493837, -701.7280933765904, -689.1343626994624, -109.37695588924944, 398.25303827703067, -775.7615637594386, -627.7757560268875, -807.6235295780705, -368.67670130206665, -366.02527417701333, -463.69842297287664, -644.9597903625357, -561.320590890933, -237.4471464674647, -549.0757526718754, -683.4630957111801, -112.92284423429504, -735.4571799784808, -669.2521345468166, -664.4450954411369, -849.5899832872504, -391.8638571427655, -893.4015659633903, -179.43863396309501, -708.1246840639151, -667.4068270080651, -698.740035180817, -742.7645838601077, -1029.539227410078, 114.71880047511566, -690.3842622500563, -154.30216632774517, -644.9939697959438, -784.3205996099047, 169.1152918596335, -475.2618100082679, -48.985690990125306, -724.1903860159097, -481.7787093352902, -473.794885574163, -128.8310790860365, -658.3256975425915, -839.7635135687137, -625.9012898653108, -1053.3516181439427, -313.49882142656514, -615.3692525770624, -610.3473758525255, -225.9214943379455, -599.001164854905, -708.2790776906465, -723.2408893858241, -573.4908328470824, -659.6412537630417, -835.6182684426079, -273.8315199985565, -744.8991320289646, -62.78195032489225, 40.0000000000003, -734.1717403263192, -708.9442970264893, -708.848786182104, -826.194290163443, -687.6856580921517, -625.4552617673667, -641.9878992021128, -160.8886701643499, -786.7298800324785, -657.6629689991915, -566.7709521037434, -293.8589880342149, -568.0898325352317, -660.0188333714964, -678.4530284959537, -699.204564181299, -499.95385111023177, -465.39334426365065, -703.5690794207826, -832.1605398661917, 244.73692433953298, -1005.4480077128238, -220.72449115813234, -804.3345316752873, -383.12045671677504, -799.9778458546957, -150.7286244637887, -598.6946212049513, -542.4710427405888, -520.8083058988491, -748.2772579525125, -694.8735499620112, -58.4698072206467, -563.2947764749772, -598.449884073304, -362.1870230831063, -165.70040682747648, -583.9472655715509, -633.0099164556921, -500.18134992532276, -691.4160840540428, -661.6351162833587, -513.4887212121029, -818.2921766192818, -469.2597637343606, -519.1033644746844, -604.278309895078, -708.4116800730094, -549.9533277968306, -301.4393365806542, -657.8939314124607, -318.2903985611945, -865.1082318150991, -28.91383271119937, -722.622436705465, -366.40878701619636, -317.4411147434406, 40.0000000000003, -744.079823455206, -656.2685282757277, -572.1867464726315, -724.966987189173, -53.53744720873192, -667.9870039728407, -615.8909017421623, -775.167578039757, -147.45991632650453, -611.8742780623516, -643.7180195021122, -683.5212860274584, -667.8208168867585, -294.27107684771676, -673.2720749809257, -649.92547542973, -674.1382517051451, -708.3611261414011, -673.848827285062, -672.5478359522282, -668.7108118788175, -628.1372598993339, -807.2184553151245, -810.5573067369857, -348.1089588797825, -884.496867083915, -504.44215339057735, -606.7987076752534, -741.4875986256855, -594.3642354157413, -531.3813523600052], "policy_predator_policy_reward": [584.7261597667022, 675.3279483167468, 229.29727677622796, 704.5909699277853, 636.3326743445917, 830.1429889467738, 653.5181305213991, 370.99695310483645, 798.1859486645702, 355.7599619843107, 833.2039788050265, 614.031417920682, 866.7082332535788, 740.0608025987557, 585.5957359623092, 686.067002550614, 703.0071757886303, 639.4830290872477, 643.8691185795228, 683.5440752480355, 948.1060170592709, 419.0039128153047, 846.0339470711567, 817.6883731395868, 138.20200740125364, 621.751085534004, 497.30311878138104, 734.9661160615503, 618.1818019186716, 759.0375789359953, 699.204070008206, 681.1342614515842, 206.99272014345877, 748.6743391651928, 468.6404801260751, 673.3270885077037, 733.1309556852542, 639.7992367130602, 751.533057965548, 683.9599326304347, 399.2671518702268, 739.1519114875157, 661.1776083118972, 671.0256711562852, 769.1613729616112, 557.404180576067, 687.9901278445947, 786.8658940181513, 613.8409753015258, 550.8587346015438, 698.1466796835359, 495.364098407986, 669.9880809627609, 681.0420253990907, 635.0880949050164, 701.8132620358568, 407.35001096023433, 734.9677497336945, 721.5815678459894, 775.6653194387105, 404.63948617452235, 447.0854280955667, 746.0163426826308, 630.4573044181889, 496.9605564069341, 649.6649433839267, 556.7757526718768, 683.4630957111801, 594.5439722145607, 713.0108424825352, 708.2658553473716, 660.5641642961099, 728.5079368194681, 767.9003696996499, 691.3843520717576, 718.1524851411027, 711.7246840639149, 668.506827008065, 702.8400351808176, 742.7645838601077, 713.395923895676, 912.9740568945891, 634.7441809147596, 468.9649905007644, 647.1939697959444, 784.3205996099047, 633.0680708725364, 119.68216561219475, 86.07997290235733, 727.1176854240701, 601.8784345015705, 479.03281080977604, 15.862567355426938, 662.5280715445831, 841.8635135687139, 629.4012898653108, 954.2866254210263, 772.5508047655343, 614.6891678007205, 618.2415789287064, 716.1437369263263, 3.296545290727474, 788.7902023728413, 737.1456565941947, 638.5810333231077, 660.1412537630418, 728.6238190842165, 589.1069894314165, 754.959362696817, 42.58575395218429, 95.86986595614955, 733.5226609054178, 796.937007496115, 688.3848840290564, 826.194290163443, 691.6856580921526, 570.2905081274382, 637.4889701704853, 337.79303209224724, 822.2279979377008, 742.9009429164271, 581.0859754048705, 783.0738278404764, 340.27350473177734, 656.0997446432508, 688.1360160472166, 673.6083977632385, 656.5060307270326, 476.29334426365097, 703.5690794207826, 775.8807331050075, 609.3004462221451, 878.7247234529475, 837.8622337558796, 670.6889429022777, 574.8648997771613, 814.9745133527928, 33.992157343236634, 614.6305264678896, 727.1227331275749, 694.4099076231801, 619.0360156727197, 662.4642413132233, 334.6384274321224, 569.4456575518401, 602.1587106673322, 695.8896007194918, 190.46032884654, 599.4472655715513, 636.809916455692, 510.08134992532274, 692.5160840540428, 736.6622527658394, 394.3391756694915, 844.2743748313482, 356.338836575749, 526.403364474685, 606.7638377316605, 613.7804500000747, 666.7137379446164, 750.4822909042351, 0.0, 923.0485277348629, 542.2785721275202, 489.95253772276993, 622.2210972895507, 103.13018718214346, 581.7960958879831, 0.0, 745.379823455206, 612.2091629057483, 655.8529422437401, 633.3711134196578, 648.1584129657093, 671.5870039728418, 624.6909017421633, 716.3817113662428, 696.8631637600804, 619.9742780623519, 647.8180195021131, 683.7212860274584, 672.3208168867584, 736.7262848138789, 231.90142496259148, 654.02547542973, 674.2382517051451, 710.2611261414011, 676.4488272850626, 663.3058505619671, 674.2893617394666, 767.4123076118335, 728.8793208294253, 764.1479338779662, 678.0771674782625, 875.8686457355935, 628.4066128582242, 608.1987076752537, 742.7875986256857, 681.0737953085919, 473.5908517546163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.576715886774198, "mean_inference_ms": 4.862068016289603, "mean_action_processing_ms": 1.793633538604975, "mean_env_wait_ms": 13.156104770071304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057370662689208984, "StateBufferConnector_ms": 0.006490349769592285, "ViewRequirementAgentConnector_ms": 0.2088911533355713}, "num_episodes": 10, "episode_return_max": 842.0453085372717, "episode_return_min": -208.85097708888046, "episode_return_mean": 140.5090462946785, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.32293070202527, "num_env_steps_trained_throughput_per_sec": 151.32293070202527, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 26258.246, "restore_workers_time_ms": 0.034, "training_step_time_ms": 26258.136, "sample_time_ms": 2537.785, "learn_time_ms": 23698.414, "learn_throughput": 168.788, "synch_weights_time_ms": 19.653}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-15-13", "timestamp": 1724384713, "time_this_iter_s": 26.511422872543335, "time_total_s": 2426.993616104126, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095b4430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2426.993616104126, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 34.362162162162164, "ram_util_percent": 83.23243243243242}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.704049498694285, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.234643593540898, "policy_loss": -0.008765559078061156, "vf_loss": 8.242842776687057, "vf_explained_var": -0.18968958854675294, "kl": 0.005663635089338101, "entropy": 0.23239040382640072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 86468.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.531680558724375, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.6540498334894735, "policy_loss": -0.009479651801662627, "vf_loss": 7.6627021991386615, "vf_explained_var": 0.6142093532299869, "kl": 0.008273092520585846, "entropy": 0.47878180165139456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 86468.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 842.0453085372717, "episode_reward_min": -220.61916463042445, "episode_reward_mean": 160.6622445645693, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1053.3516181439427, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.25303827703067, "predator_policy": 954.2866254210263}, "policy_reward_mean": {"prey_policy": -539.7064796862174, "predator_policy": 620.0376019685026}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.22261007253994, 1.3000000000000007, -51.37870130314442, 37.65115841432573, 3.1000000000000005, 627.7393327595291, 95.77227423425782, 3.1445307116670627, 842.0453085372717, 268.3132438574514, 98.342686717412, 146.45976055548357, 11.454040499876166, 340.9426308818982, 9.267221290005994, 440.546030674577, -1.7574287641230315, 538.3900383521583, 764.8092352115242, 61.84760167974126, 117.0229387910062, 267.8154337654048, 347.85776243246175, 7.69999999999999, 459.17479048431795, 35.1327896555275, 254.95446608909688, 336.6966372863762, 4.699999999999999, 4.100000000000007, 711.5495538553067, 259.02274283771874, 2.1999999999999993, 446.6037183360975, 40.02158132039263, 125.33765040189085, -108.76613772861782, 5.600000000000003, 359.9869906160485, 7.214118299837152, -105.48237697579493, 94.41589189056515, 65.59020047602317, 208.28102007446617, -10.135965704854947, 135.22078653524747, 67.52880831657384, 4.00000000000001, -59.663682671558, 212.4024798331176, 99.55299721835792, 261.3985120028062, 5.763898823016175, 130.95601319874135, 10.900000000000048, 797.7575638004931, 490.4144583378725, 58.09885428737305, -101.73979962245537, 200.58759564992155, 44.36035944453552, 243.7593115626855, 9.859707670888456, 358.46249965544894, 19.30000000000001, 10.999999999999993, -44.12240906013313, -86.93872894654905, 9.785527836582462, 22.129180074849483, -208.85097708888046, 281.92846948608667, 360.6373655956605, 1.0763813104869113, 41.30000000000031, 39.60683040113031, 503.02509198746054, 12.39999999999997, 490.6173807600626, 12.199999999999976, 4.699999999999999, 1.0845579478236425, 4.199999999999999, 4.500000000000002, -3.663435529611337, 60.93591322679815, 283.55883573945806, 115.33623811932246, 2.699999999999995, 28.91905928745648, 705.8904720148323, 391.93434899787974, -0.877809795602702, 144.47639759131178, -220.61916463042445, 666.575645545587, 9.186372661890346, 5.1999999999999975, 570.3562279638768, 514.3109403307853], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-640.9841170097059, -557.9032027923264, -845.1339470711567, -817.2883731395868, -626.0530913621456, -185.2787028762574, -461.4519603670549, -733.1661160615499, -615.0818019186717, -759.0375789359953, -535.7995498542801, -216.7994488459799, -97.78124454919269, -762.1135405252031, -472.85934736533807, -665.96369055677, -819.6626840886826, 288.7778002276386, -414.2405634360963, -752.9391833024374, -543.7416918729401, -496.3346847673887, -500.77787575542845, -684.9656431572662, -545.9501400761895, -769.1613729616112, -793.8565708492694, -340.0568201315782, -612.1825308261562, -543.249957786906, 22.223360002226062, -775.1881074191705, -651.0594417493837, -701.7280933765904, -689.1343626994624, -109.37695588924944, 398.25303827703067, -775.7615637594386, -627.7757560268875, -807.6235295780705, -368.67670130206665, -366.02527417701333, -463.69842297287664, -644.9597903625357, -561.320590890933, -237.4471464674647, -549.0757526718754, -683.4630957111801, -112.92284423429504, -735.4571799784808, -669.2521345468166, -664.4450954411369, -849.5899832872504, -391.8638571427655, -893.4015659633903, -179.43863396309501, -708.1246840639151, -667.4068270080651, -698.740035180817, -742.7645838601077, -1029.539227410078, 114.71880047511566, -690.3842622500563, -154.30216632774517, -644.9939697959438, -784.3205996099047, 169.1152918596335, -475.2618100082679, -48.985690990125306, -724.1903860159097, -481.7787093352902, -473.794885574163, -128.8310790860365, -658.3256975425915, -839.7635135687137, -625.9012898653108, -1053.3516181439427, -313.49882142656514, -615.3692525770624, -610.3473758525255, -225.9214943379455, -599.001164854905, -708.2790776906465, -723.2408893858241, -573.4908328470824, -659.6412537630417, -835.6182684426079, -273.8315199985565, -744.8991320289646, -62.78195032489225, 40.0000000000003, -734.1717403263192, -708.9442970264893, -708.848786182104, -826.194290163443, -687.6856580921517, -625.4552617673667, -641.9878992021128, -160.8886701643499, -786.7298800324785, -657.6629689991915, -566.7709521037434, -293.8589880342149, -568.0898325352317, -660.0188333714964, -678.4530284959537, -699.204564181299, -499.95385111023177, -465.39334426365065, -703.5690794207826, -832.1605398661917, 244.73692433953298, -1005.4480077128238, -220.72449115813234, -804.3345316752873, -383.12045671677504, -799.9778458546957, -150.7286244637887, -598.6946212049513, -542.4710427405888, -520.8083058988491, -748.2772579525125, -694.8735499620112, -58.4698072206467, -563.2947764749772, -598.449884073304, -362.1870230831063, -165.70040682747648, -583.9472655715509, -633.0099164556921, -500.18134992532276, -691.4160840540428, -661.6351162833587, -513.4887212121029, -818.2921766192818, -469.2597637343606, -519.1033644746844, -604.278309895078, -708.4116800730094, -549.9533277968306, -301.4393365806542, -657.8939314124607, -318.2903985611945, -865.1082318150991, -28.91383271119937, -722.622436705465, -366.40878701619636, -317.4411147434406, 40.0000000000003, -744.079823455206, -656.2685282757277, -572.1867464726315, -724.966987189173, -53.53744720873192, -667.9870039728407, -615.8909017421623, -775.167578039757, -147.45991632650453, -611.8742780623516, -643.7180195021122, -683.5212860274584, -667.8208168867585, -294.27107684771676, -673.2720749809257, -649.92547542973, -674.1382517051451, -708.3611261414011, -673.848827285062, -672.5478359522282, -668.7108118788175, -628.1372598993339, -807.2184553151245, -810.5573067369857, -348.1089588797825, -884.496867083915, -504.44215339057735, -606.7987076752534, -741.4875986256855, -594.3642354157413, -531.3813523600052, -49.398772785487495, -727.0524975199361, -758.0420832514396, 332.33388437517186, -798.9808904254605, -697.980360257208, -734.6932350776268, -680.0833686700723, -295.8189834550954, -525.8542936721789, -29.068703100237457, -849.8695679488383, -721.7162059112148, -680.1119391658158, -788.8165688479619, -593.974693738721, -682.2712770357726, 44.492135753615344, -640.6755462049606, 104.89114830137464], "policy_predator_policy_reward": [948.1060170592709, 419.0039128153047, 846.0339470711567, 817.6883731395868, 138.20200740125364, 621.751085534004, 497.30311878138104, 734.9661160615503, 618.1818019186716, 759.0375789359953, 699.204070008206, 681.1342614515842, 206.99272014345877, 748.6743391651928, 468.6404801260751, 673.3270885077037, 733.1309556852542, 639.7992367130602, 751.533057965548, 683.9599326304347, 399.2671518702268, 739.1519114875157, 661.1776083118972, 671.0256711562852, 769.1613729616112, 557.404180576067, 687.9901278445947, 786.8658940181513, 613.8409753015258, 550.8587346015438, 698.1466796835359, 495.364098407986, 669.9880809627609, 681.0420253990907, 635.0880949050164, 701.8132620358568, 407.35001096023433, 734.9677497336945, 721.5815678459894, 775.6653194387105, 404.63948617452235, 447.0854280955667, 746.0163426826308, 630.4573044181889, 496.9605564069341, 649.6649433839267, 556.7757526718768, 683.4630957111801, 594.5439722145607, 713.0108424825352, 708.2658553473716, 660.5641642961099, 728.5079368194681, 767.9003696996499, 691.3843520717576, 718.1524851411027, 711.7246840639149, 668.506827008065, 702.8400351808176, 742.7645838601077, 713.395923895676, 912.9740568945891, 634.7441809147596, 468.9649905007644, 647.1939697959444, 784.3205996099047, 633.0680708725364, 119.68216561219475, 86.07997290235733, 727.1176854240701, 601.8784345015705, 479.03281080977604, 15.862567355426938, 662.5280715445831, 841.8635135687139, 629.4012898653108, 954.2866254210263, 772.5508047655343, 614.6891678007205, 618.2415789287064, 716.1437369263263, 3.296545290727474, 788.7902023728413, 737.1456565941947, 638.5810333231077, 660.1412537630418, 728.6238190842165, 589.1069894314165, 754.959362696817, 42.58575395218429, 95.86986595614955, 733.5226609054178, 796.937007496115, 688.3848840290564, 826.194290163443, 691.6856580921526, 570.2905081274382, 637.4889701704853, 337.79303209224724, 822.2279979377008, 742.9009429164271, 581.0859754048705, 783.0738278404764, 340.27350473177734, 656.0997446432508, 688.1360160472166, 673.6083977632385, 656.5060307270326, 476.29334426365097, 703.5690794207826, 775.8807331050075, 609.3004462221451, 878.7247234529475, 837.8622337558796, 670.6889429022777, 574.8648997771613, 814.9745133527928, 33.992157343236634, 614.6305264678896, 727.1227331275749, 694.4099076231801, 619.0360156727197, 662.4642413132233, 334.6384274321224, 569.4456575518401, 602.1587106673322, 695.8896007194918, 190.46032884654, 599.4472655715513, 636.809916455692, 510.08134992532274, 692.5160840540428, 736.6622527658394, 394.3391756694915, 844.2743748313482, 356.338836575749, 526.403364474685, 606.7638377316605, 613.7804500000747, 666.7137379446164, 750.4822909042351, 0.0, 923.0485277348629, 542.2785721275202, 489.95253772276993, 622.2210972895507, 103.13018718214346, 581.7960958879831, 0.0, 745.379823455206, 612.2091629057483, 655.8529422437401, 633.3711134196578, 648.1584129657093, 671.5870039728418, 624.6909017421633, 716.3817113662428, 696.8631637600804, 619.9742780623519, 647.8180195021131, 683.7212860274584, 672.3208168867584, 736.7262848138789, 231.90142496259148, 654.02547542973, 674.2382517051451, 710.2611261414011, 676.4488272850626, 663.3058505619671, 674.2893617394666, 767.4123076118335, 728.8793208294253, 764.1479338779662, 678.0771674782625, 875.8686457355935, 628.4066128582242, 608.1987076752537, 742.7875986256857, 681.0737953085919, 473.5908517546163, 835.8358020984202, 646.505940221832, 499.5418346315902, 318.1007132425574, 800.12072665196, 695.9627142351063, 706.7175123526697, 852.5354889863403, 601.0541124968497, 0.0, 686.1991729398331, 859.3147436548304, 723.5025785731053, 687.5119391658158, 789.7165688479619, 598.2746937387212, 629.9725548170362, 578.1628144289962, 382.3243805544394, 667.7709576799306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.569551676277372, "mean_inference_ms": 4.859163872518902, "mean_action_processing_ms": 1.7912042882357948, "mean_env_wait_ms": 13.165130294107575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005676984786987305, "StateBufferConnector_ms": 0.0064476728439331055, "ViewRequirementAgentConnector_ms": 0.2074880599975586}, "num_episodes": 10, "episode_return_max": 842.0453085372717, "episode_return_min": -220.61916463042445, "episode_return_mean": 160.6622445645693, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.5503924702198, "num_env_steps_trained_throughput_per_sec": 154.5503924702198, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 26246.689, "restore_workers_time_ms": 0.032, "training_step_time_ms": 26246.582, "sample_time_ms": 2539.962, "learn_time_ms": 23684.373, "learn_throughput": 168.888, "synch_weights_time_ms": 20.041}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-15-39", "timestamp": 1724384739, "time_this_iter_s": 25.923484802246094, "time_total_s": 2452.917100906372, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b13259d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2452.917100906372, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 33.0945945945946, "ram_util_percent": 81.87837837837837}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.682508186057763, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.785136660318526, "policy_loss": -0.00886571868396704, "vf_loss": 7.793522772208723, "vf_explained_var": -0.19458930801462243, "kl": 0.004796283658736794, "entropy": 0.22700650884360862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87413.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999534}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.361958481016615, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.514852546005653, "policy_loss": -0.009248462116109238, "vf_loss": 7.523058135925777, "vf_explained_var": 0.5455138066458324, "kl": 0.010428647364849452, "entropy": 0.48219832736979085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87413.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999534}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 842.0453085372717, "episode_reward_min": -220.61916463042445, "episode_reward_mean": 163.94435920454941, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1053.3516181439427, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.25303827703067, "predator_policy": 954.2866254210263}, "policy_reward_mean": {"prey_policy": -542.6632502725662, "predator_policy": 624.6354298748413}, "custom_metrics": {}, "hist_stats": {"episode_reward": [842.0453085372717, 268.3132438574514, 98.342686717412, 146.45976055548357, 11.454040499876166, 340.9426308818982, 9.267221290005994, 440.546030674577, -1.7574287641230315, 538.3900383521583, 764.8092352115242, 61.84760167974126, 117.0229387910062, 267.8154337654048, 347.85776243246175, 7.69999999999999, 459.17479048431795, 35.1327896555275, 254.95446608909688, 336.6966372863762, 4.699999999999999, 4.100000000000007, 711.5495538553067, 259.02274283771874, 2.1999999999999993, 446.6037183360975, 40.02158132039263, 125.33765040189085, -108.76613772861782, 5.600000000000003, 359.9869906160485, 7.214118299837152, -105.48237697579493, 94.41589189056515, 65.59020047602317, 208.28102007446617, -10.135965704854947, 135.22078653524747, 67.52880831657384, 4.00000000000001, -59.663682671558, 212.4024798331176, 99.55299721835792, 261.3985120028062, 5.763898823016175, 130.95601319874135, 10.900000000000048, 797.7575638004931, 490.4144583378725, 58.09885428737305, -101.73979962245537, 200.58759564992155, 44.36035944453552, 243.7593115626855, 9.859707670888456, 358.46249965544894, 19.30000000000001, 10.999999999999993, -44.12240906013313, -86.93872894654905, 9.785527836582462, 22.129180074849483, -208.85097708888046, 281.92846948608667, 360.6373655956605, 1.0763813104869113, 41.30000000000031, 39.60683040113031, 503.02509198746054, 12.39999999999997, 490.6173807600626, 12.199999999999976, 4.699999999999999, 1.0845579478236425, 4.199999999999999, 4.500000000000002, -3.663435529611337, 60.93591322679815, 283.55883573945806, 115.33623811932246, 2.699999999999995, 28.91905928745648, 705.8904720148323, 391.93434899787974, -0.877809795602702, 144.47639759131178, -220.61916463042445, 666.575645545587, 9.186372661890346, 5.1999999999999975, 570.3562279638768, 514.3109403307853, 10.385239946133925, 40.057561456906754, 141.11239215562492, 17.63223166957313, 457.71938545162936, 6.9999999999999885, 2.900000000000005, 536.9558582073156], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-819.6626840886826, 288.7778002276386, -414.2405634360963, -752.9391833024374, -543.7416918729401, -496.3346847673887, -500.77787575542845, -684.9656431572662, -545.9501400761895, -769.1613729616112, -793.8565708492694, -340.0568201315782, -612.1825308261562, -543.249957786906, 22.223360002226062, -775.1881074191705, -651.0594417493837, -701.7280933765904, -689.1343626994624, -109.37695588924944, 398.25303827703067, -775.7615637594386, -627.7757560268875, -807.6235295780705, -368.67670130206665, -366.02527417701333, -463.69842297287664, -644.9597903625357, -561.320590890933, -237.4471464674647, -549.0757526718754, -683.4630957111801, -112.92284423429504, -735.4571799784808, -669.2521345468166, -664.4450954411369, -849.5899832872504, -391.8638571427655, -893.4015659633903, -179.43863396309501, -708.1246840639151, -667.4068270080651, -698.740035180817, -742.7645838601077, -1029.539227410078, 114.71880047511566, -690.3842622500563, -154.30216632774517, -644.9939697959438, -784.3205996099047, 169.1152918596335, -475.2618100082679, -48.985690990125306, -724.1903860159097, -481.7787093352902, -473.794885574163, -128.8310790860365, -658.3256975425915, -839.7635135687137, -625.9012898653108, -1053.3516181439427, -313.49882142656514, -615.3692525770624, -610.3473758525255, -225.9214943379455, -599.001164854905, -708.2790776906465, -723.2408893858241, -573.4908328470824, -659.6412537630417, -835.6182684426079, -273.8315199985565, -744.8991320289646, -62.78195032489225, 40.0000000000003, -734.1717403263192, -708.9442970264893, -708.848786182104, -826.194290163443, -687.6856580921517, -625.4552617673667, -641.9878992021128, -160.8886701643499, -786.7298800324785, -657.6629689991915, -566.7709521037434, -293.8589880342149, -568.0898325352317, -660.0188333714964, -678.4530284959537, -699.204564181299, -499.95385111023177, -465.39334426365065, -703.5690794207826, -832.1605398661917, 244.73692433953298, -1005.4480077128238, -220.72449115813234, -804.3345316752873, -383.12045671677504, -799.9778458546957, -150.7286244637887, -598.6946212049513, -542.4710427405888, -520.8083058988491, -748.2772579525125, -694.8735499620112, -58.4698072206467, -563.2947764749772, -598.449884073304, -362.1870230831063, -165.70040682747648, -583.9472655715509, -633.0099164556921, -500.18134992532276, -691.4160840540428, -661.6351162833587, -513.4887212121029, -818.2921766192818, -469.2597637343606, -519.1033644746844, -604.278309895078, -708.4116800730094, -549.9533277968306, -301.4393365806542, -657.8939314124607, -318.2903985611945, -865.1082318150991, -28.91383271119937, -722.622436705465, -366.40878701619636, -317.4411147434406, 40.0000000000003, -744.079823455206, -656.2685282757277, -572.1867464726315, -724.966987189173, -53.53744720873192, -667.9870039728407, -615.8909017421623, -775.167578039757, -147.45991632650453, -611.8742780623516, -643.7180195021122, -683.5212860274584, -667.8208168867585, -294.27107684771676, -673.2720749809257, -649.92547542973, -674.1382517051451, -708.3611261414011, -673.848827285062, -672.5478359522282, -668.7108118788175, -628.1372598993339, -807.2184553151245, -810.5573067369857, -348.1089588797825, -884.496867083915, -504.44215339057735, -606.7987076752534, -741.4875986256855, -594.3642354157413, -531.3813523600052, -49.398772785487495, -727.0524975199361, -758.0420832514396, 332.33388437517186, -798.9808904254605, -697.980360257208, -734.6932350776268, -680.0833686700723, -295.8189834550954, -525.8542936721789, -29.068703100237457, -849.8695679488383, -721.7162059112148, -680.1119391658158, -788.8165688479619, -593.974693738721, -682.2712770357726, 44.492135753615344, -640.6755462049606, 104.89114830137464, -734.5542073652042, -729.2030771239073, -348.14800840086906, -740.2780491257193, -502.4274017822913, -739.6599840699781, -722.190852021633, -593.3656272391863, -795.0101553217081, -109.92224049027169, -688.8750089180708, -778.2718875683139, -841.6568912692478, -522.0707467711262, -687.0549802632062, -51.36071277022242], "policy_predator_policy_reward": [733.1309556852542, 639.7992367130602, 751.533057965548, 683.9599326304347, 399.2671518702268, 739.1519114875157, 661.1776083118972, 671.0256711562852, 769.1613729616112, 557.404180576067, 687.9901278445947, 786.8658940181513, 613.8409753015258, 550.8587346015438, 698.1466796835359, 495.364098407986, 669.9880809627609, 681.0420253990907, 635.0880949050164, 701.8132620358568, 407.35001096023433, 734.9677497336945, 721.5815678459894, 775.6653194387105, 404.63948617452235, 447.0854280955667, 746.0163426826308, 630.4573044181889, 496.9605564069341, 649.6649433839267, 556.7757526718768, 683.4630957111801, 594.5439722145607, 713.0108424825352, 708.2658553473716, 660.5641642961099, 728.5079368194681, 767.9003696996499, 691.3843520717576, 718.1524851411027, 711.7246840639149, 668.506827008065, 702.8400351808176, 742.7645838601077, 713.395923895676, 912.9740568945891, 634.7441809147596, 468.9649905007644, 647.1939697959444, 784.3205996099047, 633.0680708725364, 119.68216561219475, 86.07997290235733, 727.1176854240701, 601.8784345015705, 479.03281080977604, 15.862567355426938, 662.5280715445831, 841.8635135687139, 629.4012898653108, 954.2866254210263, 772.5508047655343, 614.6891678007205, 618.2415789287064, 716.1437369263263, 3.296545290727474, 788.7902023728413, 737.1456565941947, 638.5810333231077, 660.1412537630418, 728.6238190842165, 589.1069894314165, 754.959362696817, 42.58575395218429, 95.86986595614955, 733.5226609054178, 796.937007496115, 688.3848840290564, 826.194290163443, 691.6856580921526, 570.2905081274382, 637.4889701704853, 337.79303209224724, 822.2279979377008, 742.9009429164271, 581.0859754048705, 783.0738278404764, 340.27350473177734, 656.0997446432508, 688.1360160472166, 673.6083977632385, 656.5060307270326, 476.29334426365097, 703.5690794207826, 775.8807331050075, 609.3004462221451, 878.7247234529475, 837.8622337558796, 670.6889429022777, 574.8648997771613, 814.9745133527928, 33.992157343236634, 614.6305264678896, 727.1227331275749, 694.4099076231801, 619.0360156727197, 662.4642413132233, 334.6384274321224, 569.4456575518401, 602.1587106673322, 695.8896007194918, 190.46032884654, 599.4472655715513, 636.809916455692, 510.08134992532274, 692.5160840540428, 736.6622527658394, 394.3391756694915, 844.2743748313482, 356.338836575749, 526.403364474685, 606.7638377316605, 613.7804500000747, 666.7137379446164, 750.4822909042351, 0.0, 923.0485277348629, 542.2785721275202, 489.95253772276993, 622.2210972895507, 103.13018718214346, 581.7960958879831, 0.0, 745.379823455206, 612.2091629057483, 655.8529422437401, 633.3711134196578, 648.1584129657093, 671.5870039728418, 624.6909017421633, 716.3817113662428, 696.8631637600804, 619.9742780623519, 647.8180195021131, 683.7212860274584, 672.3208168867584, 736.7262848138789, 231.90142496259148, 654.02547542973, 674.2382517051451, 710.2611261414011, 676.4488272850626, 663.3058505619671, 674.2893617394666, 767.4123076118335, 728.8793208294253, 764.1479338779662, 678.0771674782625, 875.8686457355935, 628.4066128582242, 608.1987076752537, 742.7875986256857, 681.0737953085919, 473.5908517546163, 835.8358020984202, 646.505940221832, 499.5418346315902, 318.1007132425574, 800.12072665196, 695.9627142351063, 706.7175123526697, 852.5354889863403, 601.0541124968497, 0.0, 686.1991729398331, 859.3147436548304, 723.5025785731053, 687.5119391658158, 789.7165688479619, 598.2746937387212, 629.9725548170362, 578.1628144289962, 382.3243805544394, 667.7709576799306, 718.7221151657315, 755.4204092695139, 656.3288928069672, 472.1547261765304, 644.1743761912743, 739.025401816624, 732.4242784868302, 600.7644324435626, 706.0629375231817, 656.5888437404237, 689.2750089180707, 784.8718875683136, 842.0568912692479, 524.5707467711267, 628.5018238878763, 646.8697273528713]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.564994785275726, "mean_inference_ms": 4.867370545942102, "mean_action_processing_ms": 1.7898506432538313, "mean_env_wait_ms": 13.178199996318096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056760311126708984, "StateBufferConnector_ms": 0.006513357162475586, "ViewRequirementAgentConnector_ms": 0.18601202964782715}, "num_episodes": 8, "episode_return_max": 842.0453085372717, "episode_return_min": -220.61916463042445, "episode_return_mean": 163.94435920454941, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.64673088323528, "num_env_steps_trained_throughput_per_sec": 147.64673088323528, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 26351.699, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26351.605, "sample_time_ms": 2522.229, "learn_time_ms": 23805.786, "learn_throughput": 168.026, "synch_weights_time_ms": 20.368}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-16-06", "timestamp": 1724384766, "time_this_iter_s": 27.13040518760681, "time_total_s": 2480.047506093979, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1325280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2480.047506093979, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 43.9, "ram_util_percent": 82.63684210526314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.504639116418424, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 8.018654287429083, "policy_loss": -0.008094855062367897, "vf_loss": 8.026392857485979, "vf_explained_var": 0.10585330011983397, "kl": 0.007125551912751266, "entropy": 0.2359935539582419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 88358.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.18215023222424, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.502370161228079, "policy_loss": -0.00894543536293207, "vf_loss": 7.510423240459785, "vf_explained_var": 0.6001377286734404, "kl": 0.008923508607777495, "entropy": 0.45872072069733233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 88358.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 797.7575638004931, "episode_reward_min": -220.61916463042445, "episode_reward_mean": 152.3624185960872, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1053.3516181439427, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.25303827703067, "predator_policy": 954.2866254210263}, "policy_reward_mean": {"prey_policy": -546.741372855604, "predator_policy": 622.9225821536481}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.454040499876166, 340.9426308818982, 9.267221290005994, 440.546030674577, -1.7574287641230315, 538.3900383521583, 764.8092352115242, 61.84760167974126, 117.0229387910062, 267.8154337654048, 347.85776243246175, 7.69999999999999, 459.17479048431795, 35.1327896555275, 254.95446608909688, 336.6966372863762, 4.699999999999999, 4.100000000000007, 711.5495538553067, 259.02274283771874, 2.1999999999999993, 446.6037183360975, 40.02158132039263, 125.33765040189085, -108.76613772861782, 5.600000000000003, 359.9869906160485, 7.214118299837152, -105.48237697579493, 94.41589189056515, 65.59020047602317, 208.28102007446617, -10.135965704854947, 135.22078653524747, 67.52880831657384, 4.00000000000001, -59.663682671558, 212.4024798331176, 99.55299721835792, 261.3985120028062, 5.763898823016175, 130.95601319874135, 10.900000000000048, 797.7575638004931, 490.4144583378725, 58.09885428737305, -101.73979962245537, 200.58759564992155, 44.36035944453552, 243.7593115626855, 9.859707670888456, 358.46249965544894, 19.30000000000001, 10.999999999999993, -44.12240906013313, -86.93872894654905, 9.785527836582462, 22.129180074849483, -208.85097708888046, 281.92846948608667, 360.6373655956605, 1.0763813104869113, 41.30000000000031, 39.60683040113031, 503.02509198746054, 12.39999999999997, 490.6173807600626, 12.199999999999976, 4.699999999999999, 1.0845579478236425, 4.199999999999999, 4.500000000000002, -3.663435529611337, 60.93591322679815, 283.55883573945806, 115.33623811932246, 2.699999999999995, 28.91905928745648, 705.8904720148323, 391.93434899787974, -0.877809795602702, 144.47639759131178, -220.61916463042445, 666.575645545587, 9.186372661890346, 5.1999999999999975, 570.3562279638768, 514.3109403307853, 10.385239946133925, 40.057561456906754, 141.11239215562492, 17.63223166957313, 457.71938545162936, 6.9999999999999885, 2.900000000000005, 536.9558582073156, 0.9126051733063303, 119.31728642176519, 3.2000000000000037, 73.53704722632745], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-545.9501400761895, -769.1613729616112, -793.8565708492694, -340.0568201315782, -612.1825308261562, -543.249957786906, 22.223360002226062, -775.1881074191705, -651.0594417493837, -701.7280933765904, -689.1343626994624, -109.37695588924944, 398.25303827703067, -775.7615637594386, -627.7757560268875, -807.6235295780705, -368.67670130206665, -366.02527417701333, -463.69842297287664, -644.9597903625357, -561.320590890933, -237.4471464674647, -549.0757526718754, -683.4630957111801, -112.92284423429504, -735.4571799784808, -669.2521345468166, -664.4450954411369, -849.5899832872504, -391.8638571427655, -893.4015659633903, -179.43863396309501, -708.1246840639151, -667.4068270080651, -698.740035180817, -742.7645838601077, -1029.539227410078, 114.71880047511566, -690.3842622500563, -154.30216632774517, -644.9939697959438, -784.3205996099047, 169.1152918596335, -475.2618100082679, -48.985690990125306, -724.1903860159097, -481.7787093352902, -473.794885574163, -128.8310790860365, -658.3256975425915, -839.7635135687137, -625.9012898653108, -1053.3516181439427, -313.49882142656514, -615.3692525770624, -610.3473758525255, -225.9214943379455, -599.001164854905, -708.2790776906465, -723.2408893858241, -573.4908328470824, -659.6412537630417, -835.6182684426079, -273.8315199985565, -744.8991320289646, -62.78195032489225, 40.0000000000003, -734.1717403263192, -708.9442970264893, -708.848786182104, -826.194290163443, -687.6856580921517, -625.4552617673667, -641.9878992021128, -160.8886701643499, -786.7298800324785, -657.6629689991915, -566.7709521037434, -293.8589880342149, -568.0898325352317, -660.0188333714964, -678.4530284959537, -699.204564181299, -499.95385111023177, -465.39334426365065, -703.5690794207826, -832.1605398661917, 244.73692433953298, -1005.4480077128238, -220.72449115813234, -804.3345316752873, -383.12045671677504, -799.9778458546957, -150.7286244637887, -598.6946212049513, -542.4710427405888, -520.8083058988491, -748.2772579525125, -694.8735499620112, -58.4698072206467, -563.2947764749772, -598.449884073304, -362.1870230831063, -165.70040682747648, -583.9472655715509, -633.0099164556921, -500.18134992532276, -691.4160840540428, -661.6351162833587, -513.4887212121029, -818.2921766192818, -469.2597637343606, -519.1033644746844, -604.278309895078, -708.4116800730094, -549.9533277968306, -301.4393365806542, -657.8939314124607, -318.2903985611945, -865.1082318150991, -28.91383271119937, -722.622436705465, -366.40878701619636, -317.4411147434406, 40.0000000000003, -744.079823455206, -656.2685282757277, -572.1867464726315, -724.966987189173, -53.53744720873192, -667.9870039728407, -615.8909017421623, -775.167578039757, -147.45991632650453, -611.8742780623516, -643.7180195021122, -683.5212860274584, -667.8208168867585, -294.27107684771676, -673.2720749809257, -649.92547542973, -674.1382517051451, -708.3611261414011, -673.848827285062, -672.5478359522282, -668.7108118788175, -628.1372598993339, -807.2184553151245, -810.5573067369857, -348.1089588797825, -884.496867083915, -504.44215339057735, -606.7987076752534, -741.4875986256855, -594.3642354157413, -531.3813523600052, -49.398772785487495, -727.0524975199361, -758.0420832514396, 332.33388437517186, -798.9808904254605, -697.980360257208, -734.6932350776268, -680.0833686700723, -295.8189834550954, -525.8542936721789, -29.068703100237457, -849.8695679488383, -721.7162059112148, -680.1119391658158, -788.8165688479619, -593.974693738721, -682.2712770357726, 44.492135753615344, -640.6755462049606, 104.89114830137464, -734.5542073652042, -729.2030771239073, -348.14800840086906, -740.2780491257193, -502.4274017822913, -739.6599840699781, -722.190852021633, -593.3656272391863, -795.0101553217081, -109.92224049027169, -688.8750089180708, -778.2718875683139, -841.6568912692478, -522.0707467711262, -687.0549802632062, -51.36071277022242, -709.9838603568629, -671.7857871829308, -478.9524525179248, -697.1794437081311, -579.3832617723026, -659.142376282944, -317.94397504589045, -625.1378858931874], "policy_predator_policy_reward": [769.1613729616112, 557.404180576067, 687.9901278445947, 786.8658940181513, 613.8409753015258, 550.8587346015438, 698.1466796835359, 495.364098407986, 669.9880809627609, 681.0420253990907, 635.0880949050164, 701.8132620358568, 407.35001096023433, 734.9677497336945, 721.5815678459894, 775.6653194387105, 404.63948617452235, 447.0854280955667, 746.0163426826308, 630.4573044181889, 496.9605564069341, 649.6649433839267, 556.7757526718768, 683.4630957111801, 594.5439722145607, 713.0108424825352, 708.2658553473716, 660.5641642961099, 728.5079368194681, 767.9003696996499, 691.3843520717576, 718.1524851411027, 711.7246840639149, 668.506827008065, 702.8400351808176, 742.7645838601077, 713.395923895676, 912.9740568945891, 634.7441809147596, 468.9649905007644, 647.1939697959444, 784.3205996099047, 633.0680708725364, 119.68216561219475, 86.07997290235733, 727.1176854240701, 601.8784345015705, 479.03281080977604, 15.862567355426938, 662.5280715445831, 841.8635135687139, 629.4012898653108, 954.2866254210263, 772.5508047655343, 614.6891678007205, 618.2415789287064, 716.1437369263263, 3.296545290727474, 788.7902023728413, 737.1456565941947, 638.5810333231077, 660.1412537630418, 728.6238190842165, 589.1069894314165, 754.959362696817, 42.58575395218429, 95.86986595614955, 733.5226609054178, 796.937007496115, 688.3848840290564, 826.194290163443, 691.6856580921526, 570.2905081274382, 637.4889701704853, 337.79303209224724, 822.2279979377008, 742.9009429164271, 581.0859754048705, 783.0738278404764, 340.27350473177734, 656.0997446432508, 688.1360160472166, 673.6083977632385, 656.5060307270326, 476.29334426365097, 703.5690794207826, 775.8807331050075, 609.3004462221451, 878.7247234529475, 837.8622337558796, 670.6889429022777, 574.8648997771613, 814.9745133527928, 33.992157343236634, 614.6305264678896, 727.1227331275749, 694.4099076231801, 619.0360156727197, 662.4642413132233, 334.6384274321224, 569.4456575518401, 602.1587106673322, 695.8896007194918, 190.46032884654, 599.4472655715513, 636.809916455692, 510.08134992532274, 692.5160840540428, 736.6622527658394, 394.3391756694915, 844.2743748313482, 356.338836575749, 526.403364474685, 606.7638377316605, 613.7804500000747, 666.7137379446164, 750.4822909042351, 0.0, 923.0485277348629, 542.2785721275202, 489.95253772276993, 622.2210972895507, 103.13018718214346, 581.7960958879831, 0.0, 745.379823455206, 612.2091629057483, 655.8529422437401, 633.3711134196578, 648.1584129657093, 671.5870039728418, 624.6909017421633, 716.3817113662428, 696.8631637600804, 619.9742780623519, 647.8180195021131, 683.7212860274584, 672.3208168867584, 736.7262848138789, 231.90142496259148, 654.02547542973, 674.2382517051451, 710.2611261414011, 676.4488272850626, 663.3058505619671, 674.2893617394666, 767.4123076118335, 728.8793208294253, 764.1479338779662, 678.0771674782625, 875.8686457355935, 628.4066128582242, 608.1987076752537, 742.7875986256857, 681.0737953085919, 473.5908517546163, 835.8358020984202, 646.505940221832, 499.5418346315902, 318.1007132425574, 800.12072665196, 695.9627142351063, 706.7175123526697, 852.5354889863403, 601.0541124968497, 0.0, 686.1991729398331, 859.3147436548304, 723.5025785731053, 687.5119391658158, 789.7165688479619, 598.2746937387212, 629.9725548170362, 578.1628144289962, 382.3243805544394, 667.7709576799306, 718.7221151657315, 755.4204092695139, 656.3288928069672, 472.1547261765304, 644.1743761912743, 739.025401816624, 732.4242784868302, 600.7644324435626, 706.0629375231817, 656.5888437404237, 689.2750089180707, 784.8718875683136, 842.0568912692479, 524.5707467711267, 628.5018238878763, 646.8697273528713, 709.9838603568629, 672.6983923562375, 603.9539294325916, 691.4952532152319, 582.5832617723034, 659.142376282944, 620.6616592494438, 395.95724891596683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.570019722026461, "mean_inference_ms": 4.871249548321612, "mean_action_processing_ms": 1.7864134776008649, "mean_env_wait_ms": 13.177807646921307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057010650634765625, "StateBufferConnector_ms": 0.0065882205963134766, "ViewRequirementAgentConnector_ms": 0.18591821193695068}, "num_episodes": 4, "episode_return_max": 797.7575638004931, "episode_return_min": -220.61916463042445, "episode_return_mean": 152.3624185960872, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.61428481368043, "num_env_steps_trained_throughput_per_sec": 146.61428481368043, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 26460.393, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26460.298, "sample_time_ms": 2638.314, "learn_time_ms": 23798.535, "learn_throughput": 168.078, "synch_weights_time_ms": 20.096}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-16-34", "timestamp": 1724384794, "time_this_iter_s": 27.32617425918579, "time_total_s": 2507.3736803531647, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3095ced30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2507.3736803531647, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 37.11282051282051, "ram_util_percent": 82.0897435897436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.453834582132007, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 8.1679346604322, "policy_loss": -0.010096393770750159, "vf_loss": 8.177685232515689, "vf_explained_var": -0.02093323418703029, "kl": 0.006916705199527165, "entropy": 0.2192127304811957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89303.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999534}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.638055651023905, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.263527854031356, "policy_loss": -0.00874291562115547, "vf_loss": 7.2714029473602455, "vf_explained_var": 0.6386729939274056, "kl": 0.00867811547193144, "entropy": 0.49393274232193274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89303.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999534}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 797.7575638004931, "episode_reward_min": -220.61916463042445, "episode_reward_mean": 153.7071669686347, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1053.3516181439427, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 332.33388437517186, "predator_policy": 954.2866254210263}, "policy_reward_mean": {"prey_policy": -555.6143449288703, "predator_policy": 632.4679284131882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [459.17479048431795, 35.1327896555275, 254.95446608909688, 336.6966372863762, 4.699999999999999, 4.100000000000007, 711.5495538553067, 259.02274283771874, 2.1999999999999993, 446.6037183360975, 40.02158132039263, 125.33765040189085, -108.76613772861782, 5.600000000000003, 359.9869906160485, 7.214118299837152, -105.48237697579493, 94.41589189056515, 65.59020047602317, 208.28102007446617, -10.135965704854947, 135.22078653524747, 67.52880831657384, 4.00000000000001, -59.663682671558, 212.4024798331176, 99.55299721835792, 261.3985120028062, 5.763898823016175, 130.95601319874135, 10.900000000000048, 797.7575638004931, 490.4144583378725, 58.09885428737305, -101.73979962245537, 200.58759564992155, 44.36035944453552, 243.7593115626855, 9.859707670888456, 358.46249965544894, 19.30000000000001, 10.999999999999993, -44.12240906013313, -86.93872894654905, 9.785527836582462, 22.129180074849483, -208.85097708888046, 281.92846948608667, 360.6373655956605, 1.0763813104869113, 41.30000000000031, 39.60683040113031, 503.02509198746054, 12.39999999999997, 490.6173807600626, 12.199999999999976, 4.699999999999999, 1.0845579478236425, 4.199999999999999, 4.500000000000002, -3.663435529611337, 60.93591322679815, 283.55883573945806, 115.33623811932246, 2.699999999999995, 28.91905928745648, 705.8904720148323, 391.93434899787974, -0.877809795602702, 144.47639759131178, -220.61916463042445, 666.575645545587, 9.186372661890346, 5.1999999999999975, 570.3562279638768, 514.3109403307853, 10.385239946133925, 40.057561456906754, 141.11239215562492, 17.63223166957313, 457.71938545162936, 6.9999999999999885, 2.900000000000005, 536.9558582073156, 0.9126051733063303, 119.31728642176519, 3.2000000000000037, 73.53704722632745, 4.184764545625556, 482.1131640067912, 395.00022062248564, 49.840779670475, 405.0011842865688, 246.683832740843, 363.8649154640334, 317.55849550161435, 123.59653673254839, 2.7, 138.93481814816792, 510.8916303501326], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-112.92284423429504, -735.4571799784808, -669.2521345468166, -664.4450954411369, -849.5899832872504, -391.8638571427655, -893.4015659633903, -179.43863396309501, -708.1246840639151, -667.4068270080651, -698.740035180817, -742.7645838601077, -1029.539227410078, 114.71880047511566, -690.3842622500563, -154.30216632774517, -644.9939697959438, -784.3205996099047, 169.1152918596335, -475.2618100082679, -48.985690990125306, -724.1903860159097, -481.7787093352902, -473.794885574163, -128.8310790860365, -658.3256975425915, -839.7635135687137, -625.9012898653108, -1053.3516181439427, -313.49882142656514, -615.3692525770624, -610.3473758525255, -225.9214943379455, -599.001164854905, -708.2790776906465, -723.2408893858241, -573.4908328470824, -659.6412537630417, -835.6182684426079, -273.8315199985565, -744.8991320289646, -62.78195032489225, 40.0000000000003, -734.1717403263192, -708.9442970264893, -708.848786182104, -826.194290163443, -687.6856580921517, -625.4552617673667, -641.9878992021128, -160.8886701643499, -786.7298800324785, -657.6629689991915, -566.7709521037434, -293.8589880342149, -568.0898325352317, -660.0188333714964, -678.4530284959537, -699.204564181299, -499.95385111023177, -465.39334426365065, -703.5690794207826, -832.1605398661917, 244.73692433953298, -1005.4480077128238, -220.72449115813234, -804.3345316752873, -383.12045671677504, -799.9778458546957, -150.7286244637887, -598.6946212049513, -542.4710427405888, -520.8083058988491, -748.2772579525125, -694.8735499620112, -58.4698072206467, -563.2947764749772, -598.449884073304, -362.1870230831063, -165.70040682747648, -583.9472655715509, -633.0099164556921, -500.18134992532276, -691.4160840540428, -661.6351162833587, -513.4887212121029, -818.2921766192818, -469.2597637343606, -519.1033644746844, -604.278309895078, -708.4116800730094, -549.9533277968306, -301.4393365806542, -657.8939314124607, -318.2903985611945, -865.1082318150991, -28.91383271119937, -722.622436705465, -366.40878701619636, -317.4411147434406, 40.0000000000003, -744.079823455206, -656.2685282757277, -572.1867464726315, -724.966987189173, -53.53744720873192, -667.9870039728407, -615.8909017421623, -775.167578039757, -147.45991632650453, -611.8742780623516, -643.7180195021122, -683.5212860274584, -667.8208168867585, -294.27107684771676, -673.2720749809257, -649.92547542973, -674.1382517051451, -708.3611261414011, -673.848827285062, -672.5478359522282, -668.7108118788175, -628.1372598993339, -807.2184553151245, -810.5573067369857, -348.1089588797825, -884.496867083915, -504.44215339057735, -606.7987076752534, -741.4875986256855, -594.3642354157413, -531.3813523600052, -49.398772785487495, -727.0524975199361, -758.0420832514396, 332.33388437517186, -798.9808904254605, -697.980360257208, -734.6932350776268, -680.0833686700723, -295.8189834550954, -525.8542936721789, -29.068703100237457, -849.8695679488383, -721.7162059112148, -680.1119391658158, -788.8165688479619, -593.974693738721, -682.2712770357726, 44.492135753615344, -640.6755462049606, 104.89114830137464, -734.5542073652042, -729.2030771239073, -348.14800840086906, -740.2780491257193, -502.4274017822913, -739.6599840699781, -722.190852021633, -593.3656272391863, -795.0101553217081, -109.92224049027169, -688.8750089180708, -778.2718875683139, -841.6568912692478, -522.0707467711262, -687.0549802632062, -51.36071277022242, -709.9838603568629, -671.7857871829308, -478.9524525179248, -697.1794437081311, -579.3832617723026, -659.142376282944, -317.94397504589045, -625.1378858931874, -838.4309780846736, -836.3323145580143, -758.1646643300959, -68.89085698826364, -944.7435441797094, -440.6129619255098, -691.8636930750498, -601.953874146611, -688.6973171614658, -129.74166379803117, -833.1153729221627, -205.1322525083855, -381.86199273250776, -747.9990891868879, -291.2547477574749, -708.4968766216762, -687.8426031671617, -531.0744406295604, -666.1580858066023, -699.4087306606351, -553.5146976264901, -800.2402477702631, -394.3990758985672, -470.9599125241191], "policy_predator_policy_reward": [594.5439722145607, 713.0108424825352, 708.2658553473716, 660.5641642961099, 728.5079368194681, 767.9003696996499, 691.3843520717576, 718.1524851411027, 711.7246840639149, 668.506827008065, 702.8400351808176, 742.7645838601077, 713.395923895676, 912.9740568945891, 634.7441809147596, 468.9649905007644, 647.1939697959444, 784.3205996099047, 633.0680708725364, 119.68216561219475, 86.07997290235733, 727.1176854240701, 601.8784345015705, 479.03281080977604, 15.862567355426938, 662.5280715445831, 841.8635135687139, 629.4012898653108, 954.2866254210263, 772.5508047655343, 614.6891678007205, 618.2415789287064, 716.1437369263263, 3.296545290727474, 788.7902023728413, 737.1456565941947, 638.5810333231077, 660.1412537630418, 728.6238190842165, 589.1069894314165, 754.959362696817, 42.58575395218429, 95.86986595614955, 733.5226609054178, 796.937007496115, 688.3848840290564, 826.194290163443, 691.6856580921526, 570.2905081274382, 637.4889701704853, 337.79303209224724, 822.2279979377008, 742.9009429164271, 581.0859754048705, 783.0738278404764, 340.27350473177734, 656.0997446432508, 688.1360160472166, 673.6083977632385, 656.5060307270326, 476.29334426365097, 703.5690794207826, 775.8807331050075, 609.3004462221451, 878.7247234529475, 837.8622337558796, 670.6889429022777, 574.8648997771613, 814.9745133527928, 33.992157343236634, 614.6305264678896, 727.1227331275749, 694.4099076231801, 619.0360156727197, 662.4642413132233, 334.6384274321224, 569.4456575518401, 602.1587106673322, 695.8896007194918, 190.46032884654, 599.4472655715513, 636.809916455692, 510.08134992532274, 692.5160840540428, 736.6622527658394, 394.3391756694915, 844.2743748313482, 356.338836575749, 526.403364474685, 606.7638377316605, 613.7804500000747, 666.7137379446164, 750.4822909042351, 0.0, 923.0485277348629, 542.2785721275202, 489.95253772276993, 622.2210972895507, 103.13018718214346, 581.7960958879831, 0.0, 745.379823455206, 612.2091629057483, 655.8529422437401, 633.3711134196578, 648.1584129657093, 671.5870039728418, 624.6909017421633, 716.3817113662428, 696.8631637600804, 619.9742780623519, 647.8180195021131, 683.7212860274584, 672.3208168867584, 736.7262848138789, 231.90142496259148, 654.02547542973, 674.2382517051451, 710.2611261414011, 676.4488272850626, 663.3058505619671, 674.2893617394666, 767.4123076118335, 728.8793208294253, 764.1479338779662, 678.0771674782625, 875.8686457355935, 628.4066128582242, 608.1987076752537, 742.7875986256857, 681.0737953085919, 473.5908517546163, 835.8358020984202, 646.505940221832, 499.5418346315902, 318.1007132425574, 800.12072665196, 695.9627142351063, 706.7175123526697, 852.5354889863403, 601.0541124968497, 0.0, 686.1991729398331, 859.3147436548304, 723.5025785731053, 687.5119391658158, 789.7165688479619, 598.2746937387212, 629.9725548170362, 578.1628144289962, 382.3243805544394, 667.7709576799306, 718.7221151657315, 755.4204092695139, 656.3288928069672, 472.1547261765304, 644.1743761912743, 739.025401816624, 732.4242784868302, 600.7644324435626, 706.0629375231817, 656.5888437404237, 689.2750089180707, 784.8718875683136, 842.0568912692479, 524.5707467711267, 628.5018238878763, 646.8697273528713, 709.9838603568629, 672.6983923562375, 603.9539294325916, 691.4952532152319, 582.5832617723034, 659.142376282944, 620.6616592494438, 395.95724891596683, 842.6157426302991, 836.3323145580143, 736.6515243937768, 572.5171609313803, 880.415429408665, 899.94129731904, 630.1172734039222, 713.541073488215, 635.2689058219594, 588.1712594241058, 486.4147019599695, 798.5167562114208, 802.994409295394, 690.7315880880477, 692.1274068733036, 625.1827130074622, 673.4231743014938, 669.0904062277779, 668.6580858066023, 699.6087306606352, 752.2438460422711, 740.4459175026504, 694.9373535400667, 681.3132652327529]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.568759635173519, "mean_inference_ms": 4.864877819123551, "mean_action_processing_ms": 1.7851746807364404, "mean_env_wait_ms": 13.177688937566876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00579226016998291, "StateBufferConnector_ms": 0.0066792964935302734, "ViewRequirementAgentConnector_ms": 0.19623041152954102}, "num_episodes": 12, "episode_return_max": 797.7575638004931, "episode_return_min": -220.61916463042445, "episode_return_mean": 153.7071669686347, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.42431049028235, "num_env_steps_trained_throughput_per_sec": 148.42431049028235, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 26550.29, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26550.195, "sample_time_ms": 2668.088, "learn_time_ms": 23859.578, "learn_throughput": 167.648, "synch_weights_time_ms": 19.091}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-17-01", "timestamp": 1724384821, "time_this_iter_s": 26.9970920085907, "time_total_s": 2534.3707723617554, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309681af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2534.3707723617554, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 36.073684210526324, "ram_util_percent": 82.23157894736839}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.94174213989702, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 8.000973888175198, "policy_loss": -0.009638397773560235, "vf_loss": 8.010180764475827, "vf_explained_var": 0.008252234496767558, "kl": 0.008630461317349087, "entropy": 0.2762634475237478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 90248.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.449580265731406, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.342709253704737, "policy_loss": -0.010596869437014142, "vf_loss": 7.352125708766716, "vf_explained_var": 0.6311914462261099, "kl": 0.011804188761081566, "entropy": 0.5521450452703648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 90248.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 797.7575638004931, "episode_reward_min": -220.61916463042445, "episode_reward_mean": 153.0304648602662, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1053.3516181439427, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 332.33388437517186, "predator_policy": 1018.2780995349988}, "policy_reward_mean": {"prey_policy": -560.3091206004015, "predator_policy": 636.8243530305351}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.33765040189085, -108.76613772861782, 5.600000000000003, 359.9869906160485, 7.214118299837152, -105.48237697579493, 94.41589189056515, 65.59020047602317, 208.28102007446617, -10.135965704854947, 135.22078653524747, 67.52880831657384, 4.00000000000001, -59.663682671558, 212.4024798331176, 99.55299721835792, 261.3985120028062, 5.763898823016175, 130.95601319874135, 10.900000000000048, 797.7575638004931, 490.4144583378725, 58.09885428737305, -101.73979962245537, 200.58759564992155, 44.36035944453552, 243.7593115626855, 9.859707670888456, 358.46249965544894, 19.30000000000001, 10.999999999999993, -44.12240906013313, -86.93872894654905, 9.785527836582462, 22.129180074849483, -208.85097708888046, 281.92846948608667, 360.6373655956605, 1.0763813104869113, 41.30000000000031, 39.60683040113031, 503.02509198746054, 12.39999999999997, 490.6173807600626, 12.199999999999976, 4.699999999999999, 1.0845579478236425, 4.199999999999999, 4.500000000000002, -3.663435529611337, 60.93591322679815, 283.55883573945806, 115.33623811932246, 2.699999999999995, 28.91905928745648, 705.8904720148323, 391.93434899787974, -0.877809795602702, 144.47639759131178, -220.61916463042445, 666.575645545587, 9.186372661890346, 5.1999999999999975, 570.3562279638768, 514.3109403307853, 10.385239946133925, 40.057561456906754, 141.11239215562492, 17.63223166957313, 457.71938545162936, 6.9999999999999885, 2.900000000000005, 536.9558582073156, 0.9126051733063303, 119.31728642176519, 3.2000000000000037, 73.53704722632745, 4.184764545625556, 482.1131640067912, 395.00022062248564, 49.840779670475, 405.0011842865688, 246.683832740843, 363.8649154640334, 317.55849550161435, 123.59653673254839, 2.7, 138.93481814816792, 510.8916303501326, 108.3702044205596, 200.06524558611275, 0.5000000000000009, 119.53504481831767, 420.80976567920607, 246.02467032033132, -32.34214003751792, 316.292188219929, 210.49233237002457, 370.33284407260396, 526.4059135784141], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-481.7787093352902, -473.794885574163, -128.8310790860365, -658.3256975425915, -839.7635135687137, -625.9012898653108, -1053.3516181439427, -313.49882142656514, -615.3692525770624, -610.3473758525255, -225.9214943379455, -599.001164854905, -708.2790776906465, -723.2408893858241, -573.4908328470824, -659.6412537630417, -835.6182684426079, -273.8315199985565, -744.8991320289646, -62.78195032489225, 40.0000000000003, -734.1717403263192, -708.9442970264893, -708.848786182104, -826.194290163443, -687.6856580921517, -625.4552617673667, -641.9878992021128, -160.8886701643499, -786.7298800324785, -657.6629689991915, -566.7709521037434, -293.8589880342149, -568.0898325352317, -660.0188333714964, -678.4530284959537, -699.204564181299, -499.95385111023177, -465.39334426365065, -703.5690794207826, -832.1605398661917, 244.73692433953298, -1005.4480077128238, -220.72449115813234, -804.3345316752873, -383.12045671677504, -799.9778458546957, -150.7286244637887, -598.6946212049513, -542.4710427405888, -520.8083058988491, -748.2772579525125, -694.8735499620112, -58.4698072206467, -563.2947764749772, -598.449884073304, -362.1870230831063, -165.70040682747648, -583.9472655715509, -633.0099164556921, -500.18134992532276, -691.4160840540428, -661.6351162833587, -513.4887212121029, -818.2921766192818, -469.2597637343606, -519.1033644746844, -604.278309895078, -708.4116800730094, -549.9533277968306, -301.4393365806542, -657.8939314124607, -318.2903985611945, -865.1082318150991, -28.91383271119937, -722.622436705465, -366.40878701619636, -317.4411147434406, 40.0000000000003, -744.079823455206, -656.2685282757277, -572.1867464726315, -724.966987189173, -53.53744720873192, -667.9870039728407, -615.8909017421623, -775.167578039757, -147.45991632650453, -611.8742780623516, -643.7180195021122, -683.5212860274584, -667.8208168867585, -294.27107684771676, -673.2720749809257, -649.92547542973, -674.1382517051451, -708.3611261414011, -673.848827285062, -672.5478359522282, -668.7108118788175, -628.1372598993339, -807.2184553151245, -810.5573067369857, -348.1089588797825, -884.496867083915, -504.44215339057735, -606.7987076752534, -741.4875986256855, -594.3642354157413, -531.3813523600052, -49.398772785487495, -727.0524975199361, -758.0420832514396, 332.33388437517186, -798.9808904254605, -697.980360257208, -734.6932350776268, -680.0833686700723, -295.8189834550954, -525.8542936721789, -29.068703100237457, -849.8695679488383, -721.7162059112148, -680.1119391658158, -788.8165688479619, -593.974693738721, -682.2712770357726, 44.492135753615344, -640.6755462049606, 104.89114830137464, -734.5542073652042, -729.2030771239073, -348.14800840086906, -740.2780491257193, -502.4274017822913, -739.6599840699781, -722.190852021633, -593.3656272391863, -795.0101553217081, -109.92224049027169, -688.8750089180708, -778.2718875683139, -841.6568912692478, -522.0707467711262, -687.0549802632062, -51.36071277022242, -709.9838603568629, -671.7857871829308, -478.9524525179248, -697.1794437081311, -579.3832617723026, -659.142376282944, -317.94397504589045, -625.1378858931874, -838.4309780846736, -836.3323145580143, -758.1646643300959, -68.89085698826364, -944.7435441797094, -440.6129619255098, -691.8636930750498, -601.953874146611, -688.6973171614658, -129.74166379803117, -833.1153729221627, -205.1322525083855, -381.86199273250776, -747.9990891868879, -291.2547477574749, -708.4968766216762, -687.8426031671617, -531.0744406295604, -666.1580858066023, -699.4087306606351, -553.5146976264901, -800.2402477702631, -394.3990758985672, -470.9599125241191, -680.540222071795, -686.5341162229794, -429.86063808102125, -816.5330286462323, -757.6729382907168, -686.2647787326213, -454.6464272711798, -728.5317305447489, -137.59287524982383, -793.0489763489763, -645.3018663777377, -482.57376262993506, -823.7772137536616, -770.18593040675, -915.5747594956096, -393.65538970827333, -331.2541401124538, -450.19543058198036, -685.9696402173469, 319.3981186942956, -935.8735797059448, -234.31725329414434], "policy_predator_policy_reward": [601.8784345015705, 479.03281080977604, 15.862567355426938, 662.5280715445831, 841.8635135687139, 629.4012898653108, 954.2866254210263, 772.5508047655343, 614.6891678007205, 618.2415789287064, 716.1437369263263, 3.296545290727474, 788.7902023728413, 737.1456565941947, 638.5810333231077, 660.1412537630418, 728.6238190842165, 589.1069894314165, 754.959362696817, 42.58575395218429, 95.86986595614955, 733.5226609054178, 796.937007496115, 688.3848840290564, 826.194290163443, 691.6856580921526, 570.2905081274382, 637.4889701704853, 337.79303209224724, 822.2279979377008, 742.9009429164271, 581.0859754048705, 783.0738278404764, 340.27350473177734, 656.0997446432508, 688.1360160472166, 673.6083977632385, 656.5060307270326, 476.29334426365097, 703.5690794207826, 775.8807331050075, 609.3004462221451, 878.7247234529475, 837.8622337558796, 670.6889429022777, 574.8648997771613, 814.9745133527928, 33.992157343236634, 614.6305264678896, 727.1227331275749, 694.4099076231801, 619.0360156727197, 662.4642413132233, 334.6384274321224, 569.4456575518401, 602.1587106673322, 695.8896007194918, 190.46032884654, 599.4472655715513, 636.809916455692, 510.08134992532274, 692.5160840540428, 736.6622527658394, 394.3391756694915, 844.2743748313482, 356.338836575749, 526.403364474685, 606.7638377316605, 613.7804500000747, 666.7137379446164, 750.4822909042351, 0.0, 923.0485277348629, 542.2785721275202, 489.95253772276993, 622.2210972895507, 103.13018718214346, 581.7960958879831, 0.0, 745.379823455206, 612.2091629057483, 655.8529422437401, 633.3711134196578, 648.1584129657093, 671.5870039728418, 624.6909017421633, 716.3817113662428, 696.8631637600804, 619.9742780623519, 647.8180195021131, 683.7212860274584, 672.3208168867584, 736.7262848138789, 231.90142496259148, 654.02547542973, 674.2382517051451, 710.2611261414011, 676.4488272850626, 663.3058505619671, 674.2893617394666, 767.4123076118335, 728.8793208294253, 764.1479338779662, 678.0771674782625, 875.8686457355935, 628.4066128582242, 608.1987076752537, 742.7875986256857, 681.0737953085919, 473.5908517546163, 835.8358020984202, 646.505940221832, 499.5418346315902, 318.1007132425574, 800.12072665196, 695.9627142351063, 706.7175123526697, 852.5354889863403, 601.0541124968497, 0.0, 686.1991729398331, 859.3147436548304, 723.5025785731053, 687.5119391658158, 789.7165688479619, 598.2746937387212, 629.9725548170362, 578.1628144289962, 382.3243805544394, 667.7709576799306, 718.7221151657315, 755.4204092695139, 656.3288928069672, 472.1547261765304, 644.1743761912743, 739.025401816624, 732.4242784868302, 600.7644324435626, 706.0629375231817, 656.5888437404237, 689.2750089180707, 784.8718875683136, 842.0568912692479, 524.5707467711267, 628.5018238878763, 646.8697273528713, 709.9838603568629, 672.6983923562375, 603.9539294325916, 691.4952532152319, 582.5832617723034, 659.142376282944, 620.6616592494438, 395.95724891596683, 842.6157426302991, 836.3323145580143, 736.6515243937768, 572.5171609313803, 880.415429408665, 899.94129731904, 630.1172734039222, 713.541073488215, 635.2689058219594, 588.1712594241058, 486.4147019599695, 798.5167562114208, 802.994409295394, 690.7315880880477, 692.1274068733036, 625.1827130074622, 673.4231743014938, 669.0904062277779, 668.6580858066023, 699.6087306606352, 752.2438460422711, 740.4459175026504, 694.9373535400667, 681.3132652327529, 798.8290513981876, 676.6154913171484, 700.9821919291583, 745.476720384213, 758.1729382907168, 686.2647787326213, 563.7581938143286, 738.9550088199187, 637.7942236956764, 713.6573935823255, 638.9260056395351, 734.9742936884694, 770.3663726913964, 791.2546314314966, 740.4223144020402, 885.1000230217772, 340.83159526402846, 651.1103078004332, 687.2696402173472, 49.63472537830833, 678.3186470435126, 1018.2780995349988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.5707806026823325, "mean_inference_ms": 4.862787156703273, "mean_action_processing_ms": 1.777631674855284, "mean_env_wait_ms": 13.188984440541985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004326224327087402, "StateBufferConnector_ms": 0.006713390350341797, "ViewRequirementAgentConnector_ms": 0.18209052085876465}, "num_episodes": 11, "episode_return_max": 797.7575638004931, "episode_return_min": -220.61916463042445, "episode_return_mean": 153.0304648602662, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.2065936225011, "num_env_steps_trained_throughput_per_sec": 154.2065936225011, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 26370.119, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26369.954, "sample_time_ms": 2515.517, "learn_time_ms": 23831.078, "learn_throughput": 167.848, "synch_weights_time_ms": 19.779}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-17-27", "timestamp": 1724384847, "time_this_iter_s": 25.98658585548401, "time_total_s": 2560.3573582172394, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309681b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2560.3573582172394, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 35.0027027027027, "ram_util_percent": 82.52162162162163}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.153430037019113, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.8737120007711745, "policy_loss": -0.012455060200460217, "vf_loss": 7.8857966125326815, "vf_explained_var": 0.06417600439969824, "kl": 0.0074088244845538775, "entropy": 0.29503456945457157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91193.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.25245439236757, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.356080349917134, "policy_loss": -0.010860796575064934, "vf_loss": 7.365774226314807, "vf_explained_var": 0.5663998410815284, "kl": 0.011669408840930493, "entropy": 0.5603850699921764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91193.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 797.7575638004931, "episode_reward_min": -220.61916463042445, "episode_reward_mean": 174.83487478800348, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1005.4480077128238, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 340.3710046355517, "predator_policy": 1018.2780995349988}, "policy_reward_mean": {"prey_policy": -553.391256783204, "predator_policy": 640.808694177206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [212.4024798331176, 99.55299721835792, 261.3985120028062, 5.763898823016175, 130.95601319874135, 10.900000000000048, 797.7575638004931, 490.4144583378725, 58.09885428737305, -101.73979962245537, 200.58759564992155, 44.36035944453552, 243.7593115626855, 9.859707670888456, 358.46249965544894, 19.30000000000001, 10.999999999999993, -44.12240906013313, -86.93872894654905, 9.785527836582462, 22.129180074849483, -208.85097708888046, 281.92846948608667, 360.6373655956605, 1.0763813104869113, 41.30000000000031, 39.60683040113031, 503.02509198746054, 12.39999999999997, 490.6173807600626, 12.199999999999976, 4.699999999999999, 1.0845579478236425, 4.199999999999999, 4.500000000000002, -3.663435529611337, 60.93591322679815, 283.55883573945806, 115.33623811932246, 2.699999999999995, 28.91905928745648, 705.8904720148323, 391.93434899787974, -0.877809795602702, 144.47639759131178, -220.61916463042445, 666.575645545587, 9.186372661890346, 5.1999999999999975, 570.3562279638768, 514.3109403307853, 10.385239946133925, 40.057561456906754, 141.11239215562492, 17.63223166957313, 457.71938545162936, 6.9999999999999885, 2.900000000000005, 536.9558582073156, 0.9126051733063303, 119.31728642176519, 3.2000000000000037, 73.53704722632745, 4.184764545625556, 482.1131640067912, 395.00022062248564, 49.840779670475, 405.0011842865688, 246.683832740843, 363.8649154640334, 317.55849550161435, 123.59653673254839, 2.7, 138.93481814816792, 510.8916303501326, 108.3702044205596, 200.06524558611275, 0.5000000000000009, 119.53504481831767, 420.80976567920607, 246.02467032033132, -32.34214003751792, 316.292188219929, 210.49233237002457, 370.33284407260396, 526.4059135784141, 154.57439881286135, 14.320910331073016, 27.027806725814106, 745.4388273026855, 362.9149133549643, 557.3232785554068, 57.64734934171087, -43.5544116937296, 79.49999999999976, 278.43830555524937, 308.889641454002, 347.3010361574837, 79.74624040602967, -1.7763568394002505e-15], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-160.8886701643499, -786.7298800324785, -657.6629689991915, -566.7709521037434, -293.8589880342149, -568.0898325352317, -660.0188333714964, -678.4530284959537, -699.204564181299, -499.95385111023177, -465.39334426365065, -703.5690794207826, -832.1605398661917, 244.73692433953298, -1005.4480077128238, -220.72449115813234, -804.3345316752873, -383.12045671677504, -799.9778458546957, -150.7286244637887, -598.6946212049513, -542.4710427405888, -520.8083058988491, -748.2772579525125, -694.8735499620112, -58.4698072206467, -563.2947764749772, -598.449884073304, -362.1870230831063, -165.70040682747648, -583.9472655715509, -633.0099164556921, -500.18134992532276, -691.4160840540428, -661.6351162833587, -513.4887212121029, -818.2921766192818, -469.2597637343606, -519.1033644746844, -604.278309895078, -708.4116800730094, -549.9533277968306, -301.4393365806542, -657.8939314124607, -318.2903985611945, -865.1082318150991, -28.91383271119937, -722.622436705465, -366.40878701619636, -317.4411147434406, 40.0000000000003, -744.079823455206, -656.2685282757277, -572.1867464726315, -724.966987189173, -53.53744720873192, -667.9870039728407, -615.8909017421623, -775.167578039757, -147.45991632650453, -611.8742780623516, -643.7180195021122, -683.5212860274584, -667.8208168867585, -294.27107684771676, -673.2720749809257, -649.92547542973, -674.1382517051451, -708.3611261414011, -673.848827285062, -672.5478359522282, -668.7108118788175, -628.1372598993339, -807.2184553151245, -810.5573067369857, -348.1089588797825, -884.496867083915, -504.44215339057735, -606.7987076752534, -741.4875986256855, -594.3642354157413, -531.3813523600052, -49.398772785487495, -727.0524975199361, -758.0420832514396, 332.33388437517186, -798.9808904254605, -697.980360257208, -734.6932350776268, -680.0833686700723, -295.8189834550954, -525.8542936721789, -29.068703100237457, -849.8695679488383, -721.7162059112148, -680.1119391658158, -788.8165688479619, -593.974693738721, -682.2712770357726, 44.492135753615344, -640.6755462049606, 104.89114830137464, -734.5542073652042, -729.2030771239073, -348.14800840086906, -740.2780491257193, -502.4274017822913, -739.6599840699781, -722.190852021633, -593.3656272391863, -795.0101553217081, -109.92224049027169, -688.8750089180708, -778.2718875683139, -841.6568912692478, -522.0707467711262, -687.0549802632062, -51.36071277022242, -709.9838603568629, -671.7857871829308, -478.9524525179248, -697.1794437081311, -579.3832617723026, -659.142376282944, -317.94397504589045, -625.1378858931874, -838.4309780846736, -836.3323145580143, -758.1646643300959, -68.89085698826364, -944.7435441797094, -440.6129619255098, -691.8636930750498, -601.953874146611, -688.6973171614658, -129.74166379803117, -833.1153729221627, -205.1322525083855, -381.86199273250776, -747.9990891868879, -291.2547477574749, -708.4968766216762, -687.8426031671617, -531.0744406295604, -666.1580858066023, -699.4087306606351, -553.5146976264901, -800.2402477702631, -394.3990758985672, -470.9599125241191, -680.540222071795, -686.5341162229794, -429.86063808102125, -816.5330286462323, -757.6729382907168, -686.2647787326213, -454.6464272711798, -728.5317305447489, -137.59287524982383, -793.0489763489763, -645.3018663777377, -482.57376262993506, -823.7772137536616, -770.18593040675, -915.5747594956096, -393.65538970827333, -331.2541401124538, -450.19543058198036, -685.9696402173469, 319.3981186942956, -935.8735797059448, -234.31725329414434, -562.1686032200062, -522.5504081835838, -521.8655685730589, -752.3309858197339, -730.6716540273517, -759.1540284033249, -727.8389229948992, 340.3710046355517, -352.80187882303545, -876.9362653019581, -24.92964953071305, -789.4978381234461, -701.5546230741692, -765.8776815732224, -678.1684491376701, -799.8511295816553, 34.66426507082317, 40.0000000000003, -102.94656334047332, -878.1778988566482, -240.00751627685344, -790.3748984293004, -155.28908407453883, -578.6338448773035, -622.674096610068, -719.2046059453181, -743.7061792418028, -735.2058916533994], "policy_predator_policy_reward": [337.79303209224724, 822.2279979377008, 742.9009429164271, 581.0859754048705, 783.0738278404764, 340.27350473177734, 656.0997446432508, 688.1360160472166, 673.6083977632385, 656.5060307270326, 476.29334426365097, 703.5690794207826, 775.8807331050075, 609.3004462221451, 878.7247234529475, 837.8622337558796, 670.6889429022777, 574.8648997771613, 814.9745133527928, 33.992157343236634, 614.6305264678896, 727.1227331275749, 694.4099076231801, 619.0360156727197, 662.4642413132233, 334.6384274321224, 569.4456575518401, 602.1587106673322, 695.8896007194918, 190.46032884654, 599.4472655715513, 636.809916455692, 510.08134992532274, 692.5160840540428, 736.6622527658394, 394.3391756694915, 844.2743748313482, 356.338836575749, 526.403364474685, 606.7638377316605, 613.7804500000747, 666.7137379446164, 750.4822909042351, 0.0, 923.0485277348629, 542.2785721275202, 489.95253772276993, 622.2210972895507, 103.13018718214346, 581.7960958879831, 0.0, 745.379823455206, 612.2091629057483, 655.8529422437401, 633.3711134196578, 648.1584129657093, 671.5870039728418, 624.6909017421633, 716.3817113662428, 696.8631637600804, 619.9742780623519, 647.8180195021131, 683.7212860274584, 672.3208168867584, 736.7262848138789, 231.90142496259148, 654.02547542973, 674.2382517051451, 710.2611261414011, 676.4488272850626, 663.3058505619671, 674.2893617394666, 767.4123076118335, 728.8793208294253, 764.1479338779662, 678.0771674782625, 875.8686457355935, 628.4066128582242, 608.1987076752537, 742.7875986256857, 681.0737953085919, 473.5908517546163, 835.8358020984202, 646.505940221832, 499.5418346315902, 318.1007132425574, 800.12072665196, 695.9627142351063, 706.7175123526697, 852.5354889863403, 601.0541124968497, 0.0, 686.1991729398331, 859.3147436548304, 723.5025785731053, 687.5119391658158, 789.7165688479619, 598.2746937387212, 629.9725548170362, 578.1628144289962, 382.3243805544394, 667.7709576799306, 718.7221151657315, 755.4204092695139, 656.3288928069672, 472.1547261765304, 644.1743761912743, 739.025401816624, 732.4242784868302, 600.7644324435626, 706.0629375231817, 656.5888437404237, 689.2750089180707, 784.8718875683136, 842.0568912692479, 524.5707467711267, 628.5018238878763, 646.8697273528713, 709.9838603568629, 672.6983923562375, 603.9539294325916, 691.4952532152319, 582.5832617723034, 659.142376282944, 620.6616592494438, 395.95724891596683, 842.6157426302991, 836.3323145580143, 736.6515243937768, 572.5171609313803, 880.415429408665, 899.94129731904, 630.1172734039222, 713.541073488215, 635.2689058219594, 588.1712594241058, 486.4147019599695, 798.5167562114208, 802.994409295394, 690.7315880880477, 692.1274068733036, 625.1827130074622, 673.4231743014938, 669.0904062277779, 668.6580858066023, 699.6087306606352, 752.2438460422711, 740.4459175026504, 694.9373535400667, 681.3132652327529, 798.8290513981876, 676.6154913171484, 700.9821919291583, 745.476720384213, 758.1729382907168, 686.2647787326213, 563.7581938143286, 738.9550088199187, 637.7942236956764, 713.6573935823255, 638.9260056395351, 734.9742936884694, 770.3663726913964, 791.2546314314966, 740.4223144020402, 885.1000230217772, 340.83159526402846, 651.1103078004332, 687.2696402173472, 49.63472537830833, 678.3186470435126, 1018.2780995349988, 596.082312654439, 643.2110975620112, 536.1864789041318, 752.3309858197339, 764.7139528672072, 752.1395362892846, 661.6630614542981, 471.2436842077308, 793.3174063962464, 799.3356510837119, 734.647773200796, 637.1029930087692, 759.20197241588, 765.8776815732224, 736.8978072971455, 697.5673597284487, 4.83573492917705, 0.0, 764.8747273488339, 494.6880404035328, 738.9447682171689, 600.327287942987, 583.0384367457497, 498.1855283635768, 710.6629460930848, 710.9619968683311, 743.7061792418028, 735.2058916533994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.560533124471041, "mean_inference_ms": 4.86891485458796, "mean_action_processing_ms": 1.7811882948322992, "mean_env_wait_ms": 13.194609276698962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004373669624328613, "StateBufferConnector_ms": 0.006735086441040039, "ViewRequirementAgentConnector_ms": 0.2004796266555786}, "num_episodes": 14, "episode_return_max": 797.7575638004931, "episode_return_min": -220.61916463042445, "episode_return_mean": 174.83487478800348, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.85032755263651, "num_env_steps_trained_throughput_per_sec": 154.85032755263651, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 26372.767, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26372.597, "sample_time_ms": 2497.092, "learn_time_ms": 23852.062, "learn_throughput": 167.7, "synch_weights_time_ms": 19.644}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-17-53", "timestamp": 1724384873, "time_this_iter_s": 25.878262042999268, "time_total_s": 2586.2356202602386, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309578ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2586.2356202602386, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 34.07222222222222, "ram_util_percent": 82.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.901702956043223, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.876014093368773, "policy_loss": -0.011011899969535608, "vf_loss": 7.886573224849802, "vf_explained_var": 0.1241753517004548, "kl": 0.009055470748158989, "entropy": 0.2857950148286012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 92138.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.56830921021719, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.446978528663595, "policy_loss": -0.009585793277805562, "vf_loss": 7.455345354130659, "vf_explained_var": 0.49587600981747665, "kl": 0.012189591005345973, "entropy": 0.5526398513682935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 92138.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 745.4388273026855, "episode_reward_min": -220.61916463042445, "episode_reward_mean": 186.01404494523803, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -944.7435441797094, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 369.68622243928513, "predator_policy": 1018.2780995349988}, "policy_reward_mean": {"prey_policy": -542.4112758806888, "predator_policy": 635.4182983533082}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.30000000000001, 10.999999999999993, -44.12240906013313, -86.93872894654905, 9.785527836582462, 22.129180074849483, -208.85097708888046, 281.92846948608667, 360.6373655956605, 1.0763813104869113, 41.30000000000031, 39.60683040113031, 503.02509198746054, 12.39999999999997, 490.6173807600626, 12.199999999999976, 4.699999999999999, 1.0845579478236425, 4.199999999999999, 4.500000000000002, -3.663435529611337, 60.93591322679815, 283.55883573945806, 115.33623811932246, 2.699999999999995, 28.91905928745648, 705.8904720148323, 391.93434899787974, -0.877809795602702, 144.47639759131178, -220.61916463042445, 666.575645545587, 9.186372661890346, 5.1999999999999975, 570.3562279638768, 514.3109403307853, 10.385239946133925, 40.057561456906754, 141.11239215562492, 17.63223166957313, 457.71938545162936, 6.9999999999999885, 2.900000000000005, 536.9558582073156, 0.9126051733063303, 119.31728642176519, 3.2000000000000037, 73.53704722632745, 4.184764545625556, 482.1131640067912, 395.00022062248564, 49.840779670475, 405.0011842865688, 246.683832740843, 363.8649154640334, 317.55849550161435, 123.59653673254839, 2.7, 138.93481814816792, 510.8916303501326, 108.3702044205596, 200.06524558611275, 0.5000000000000009, 119.53504481831767, 420.80976567920607, 246.02467032033132, -32.34214003751792, 316.292188219929, 210.49233237002457, 370.33284407260396, 526.4059135784141, 154.57439881286135, 14.320910331073016, 27.027806725814106, 745.4388273026855, 362.9149133549643, 557.3232785554068, 57.64734934171087, -43.5544116937296, 79.49999999999976, 278.43830555524937, 308.889641454002, 347.3010361574837, 79.74624040602967, -1.7763568394002505e-15, 227.1134943489804, 488.9001019540218, 51.96726147527296, -8.612133007140581, 3.000000000000001, 538.7876163335907, 499.6105544268533, 416.30314350799705, -32.70435428145896, 272.2760472301418, 228.88771058531074, 61.22635298144325, 470.2314692248214, 722.5642028064264, 0.8999999999999995], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-583.9472655715509, -633.0099164556921, -500.18134992532276, -691.4160840540428, -661.6351162833587, -513.4887212121029, -818.2921766192818, -469.2597637343606, -519.1033644746844, -604.278309895078, -708.4116800730094, -549.9533277968306, -301.4393365806542, -657.8939314124607, -318.2903985611945, -865.1082318150991, -28.91383271119937, -722.622436705465, -366.40878701619636, -317.4411147434406, 40.0000000000003, -744.079823455206, -656.2685282757277, -572.1867464726315, -724.966987189173, -53.53744720873192, -667.9870039728407, -615.8909017421623, -775.167578039757, -147.45991632650453, -611.8742780623516, -643.7180195021122, -683.5212860274584, -667.8208168867585, -294.27107684771676, -673.2720749809257, -649.92547542973, -674.1382517051451, -708.3611261414011, -673.848827285062, -672.5478359522282, -668.7108118788175, -628.1372598993339, -807.2184553151245, -810.5573067369857, -348.1089588797825, -884.496867083915, -504.44215339057735, -606.7987076752534, -741.4875986256855, -594.3642354157413, -531.3813523600052, -49.398772785487495, -727.0524975199361, -758.0420832514396, 332.33388437517186, -798.9808904254605, -697.980360257208, -734.6932350776268, -680.0833686700723, -295.8189834550954, -525.8542936721789, -29.068703100237457, -849.8695679488383, -721.7162059112148, -680.1119391658158, -788.8165688479619, -593.974693738721, -682.2712770357726, 44.492135753615344, -640.6755462049606, 104.89114830137464, -734.5542073652042, -729.2030771239073, -348.14800840086906, -740.2780491257193, -502.4274017822913, -739.6599840699781, -722.190852021633, -593.3656272391863, -795.0101553217081, -109.92224049027169, -688.8750089180708, -778.2718875683139, -841.6568912692478, -522.0707467711262, -687.0549802632062, -51.36071277022242, -709.9838603568629, -671.7857871829308, -478.9524525179248, -697.1794437081311, -579.3832617723026, -659.142376282944, -317.94397504589045, -625.1378858931874, -838.4309780846736, -836.3323145580143, -758.1646643300959, -68.89085698826364, -944.7435441797094, -440.6129619255098, -691.8636930750498, -601.953874146611, -688.6973171614658, -129.74166379803117, -833.1153729221627, -205.1322525083855, -381.86199273250776, -747.9990891868879, -291.2547477574749, -708.4968766216762, -687.8426031671617, -531.0744406295604, -666.1580858066023, -699.4087306606351, -553.5146976264901, -800.2402477702631, -394.3990758985672, -470.9599125241191, -680.540222071795, -686.5341162229794, -429.86063808102125, -816.5330286462323, -757.6729382907168, -686.2647787326213, -454.6464272711798, -728.5317305447489, -137.59287524982383, -793.0489763489763, -645.3018663777377, -482.57376262993506, -823.7772137536616, -770.18593040675, -915.5747594956096, -393.65538970827333, -331.2541401124538, -450.19543058198036, -685.9696402173469, 319.3981186942956, -935.8735797059448, -234.31725329414434, -562.1686032200062, -522.5504081835838, -521.8655685730589, -752.3309858197339, -730.6716540273517, -759.1540284033249, -727.8389229948992, 340.3710046355517, -352.80187882303545, -876.9362653019581, -24.92964953071305, -789.4978381234461, -701.5546230741692, -765.8776815732224, -678.1684491376701, -799.8511295816553, 34.66426507082317, 40.0000000000003, -102.94656334047332, -878.1778988566482, -240.00751627685344, -790.3748984293004, -155.28908407453883, -578.6338448773035, -622.674096610068, -719.2046059453181, -743.7061792418028, -735.2058916533994, -867.5238136753961, -50.08279193705597, -675.4227844212697, -130.75927752834744, -442.49847836011753, -346.3281081649936, -266.11938479731907, -220.35224615286575, -925.2082601151461, -684.0725110550563, -581.6297458961626, 202.44998674766228, 30.67107821331342, -757.0265633902213, -731.147926960644, 369.68622243928513, -937.4928578911246, -766.4642626407767, -723.1206819148904, -213.4119958176, -486.34814757503375, -476.51956720630085, -553.132410041786, -611.5996334740672, -695.0300798726458, 341.92396582650537, -882.6777892872998, 166.48605698930902, -736.9115975971126, -699.9184551990088], "policy_predator_policy_reward": [599.4472655715513, 636.809916455692, 510.08134992532274, 692.5160840540428, 736.6622527658394, 394.3391756694915, 844.2743748313482, 356.338836575749, 526.403364474685, 606.7638377316605, 613.7804500000747, 666.7137379446164, 750.4822909042351, 0.0, 923.0485277348629, 542.2785721275202, 489.95253772276993, 622.2210972895507, 103.13018718214346, 581.7960958879831, 0.0, 745.379823455206, 612.2091629057483, 655.8529422437401, 633.3711134196578, 648.1584129657093, 671.5870039728418, 624.6909017421633, 716.3817113662428, 696.8631637600804, 619.9742780623519, 647.8180195021131, 683.7212860274584, 672.3208168867584, 736.7262848138789, 231.90142496259148, 654.02547542973, 674.2382517051451, 710.2611261414011, 676.4488272850626, 663.3058505619671, 674.2893617394666, 767.4123076118335, 728.8793208294253, 764.1479338779662, 678.0771674782625, 875.8686457355935, 628.4066128582242, 608.1987076752537, 742.7875986256857, 681.0737953085919, 473.5908517546163, 835.8358020984202, 646.505940221832, 499.5418346315902, 318.1007132425574, 800.12072665196, 695.9627142351063, 706.7175123526697, 852.5354889863403, 601.0541124968497, 0.0, 686.1991729398331, 859.3147436548304, 723.5025785731053, 687.5119391658158, 789.7165688479619, 598.2746937387212, 629.9725548170362, 578.1628144289962, 382.3243805544394, 667.7709576799306, 718.7221151657315, 755.4204092695139, 656.3288928069672, 472.1547261765304, 644.1743761912743, 739.025401816624, 732.4242784868302, 600.7644324435626, 706.0629375231817, 656.5888437404237, 689.2750089180707, 784.8718875683136, 842.0568912692479, 524.5707467711267, 628.5018238878763, 646.8697273528713, 709.9838603568629, 672.6983923562375, 603.9539294325916, 691.4952532152319, 582.5832617723034, 659.142376282944, 620.6616592494438, 395.95724891596683, 842.6157426302991, 836.3323145580143, 736.6515243937768, 572.5171609313803, 880.415429408665, 899.94129731904, 630.1172734039222, 713.541073488215, 635.2689058219594, 588.1712594241058, 486.4147019599695, 798.5167562114208, 802.994409295394, 690.7315880880477, 692.1274068733036, 625.1827130074622, 673.4231743014938, 669.0904062277779, 668.6580858066023, 699.6087306606352, 752.2438460422711, 740.4459175026504, 694.9373535400667, 681.3132652327529, 798.8290513981876, 676.6154913171484, 700.9821919291583, 745.476720384213, 758.1729382907168, 686.2647787326213, 563.7581938143286, 738.9550088199187, 637.7942236956764, 713.6573935823255, 638.9260056395351, 734.9742936884694, 770.3663726913964, 791.2546314314966, 740.4223144020402, 885.1000230217772, 340.83159526402846, 651.1103078004332, 687.2696402173472, 49.63472537830833, 678.3186470435126, 1018.2780995349988, 596.082312654439, 643.2110975620112, 536.1864789041318, 752.3309858197339, 764.7139528672072, 752.1395362892846, 661.6630614542981, 471.2436842077308, 793.3174063962464, 799.3356510837119, 734.647773200796, 637.1029930087692, 759.20197241588, 765.8776815732224, 736.8978072971455, 697.5673597284487, 4.83573492917705, 0.0, 764.8747273488339, 494.6880404035328, 738.9447682171689, 600.327287942987, 583.0384367457497, 498.1855283635768, 710.6629460930848, 710.9619968683311, 743.7061792418028, 735.2058916533994, 763.0526875684577, 381.66741239297687, 619.7951711363562, 675.2869927672803, 570.7707180339543, 270.0231299664335, 477.8594979430464, 0.0, 925.2082601151461, 687.0725110550563, 221.74443060618663, 696.2229448759068, 560.9713542420371, 664.9946853617249, 731.147926960644, 46.61692106871184, 869.7231172045139, 801.529649045928, 694.6278454886182, 514.1808794740112, 673.2336556053078, 518.5217697613422, 776.568371069462, 449.3900254278333, 687.1028344809732, 136.23474878998692, 709.1784963302869, 729.5774387741269, 737.8115975971127, 699.9184551990088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.558723598421998, "mean_inference_ms": 4.859201459311842, "mean_action_processing_ms": 1.7750041635544802, "mean_env_wait_ms": 13.203733526398304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004374504089355469, "StateBufferConnector_ms": 0.0066683292388916016, "ViewRequirementAgentConnector_ms": 0.18601584434509277}, "num_episodes": 15, "episode_return_max": 745.4388273026855, "episode_return_min": -220.61916463042445, "episode_return_mean": 186.01404494523803, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.59997984375264, "num_env_steps_trained_throughput_per_sec": 153.59997984375264, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 26334.884, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26334.715, "sample_time_ms": 2496.799, "learn_time_ms": 23814.7, "learn_throughput": 167.963, "synch_weights_time_ms": 19.543}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-18-19", "timestamp": 1724384899, "time_this_iter_s": 26.093905210494995, "time_total_s": 2612.3295254707336, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309578ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2612.3295254707336, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 34.00810810810812, "ram_util_percent": 82.67567567567568}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.14039485467174, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.798857669729404, "policy_loss": -0.010211605633850452, "vf_loss": 7.808665004104533, "vf_explained_var": 0.02359392901577016, "kl": 0.008085676162656416, "entropy": 0.278671263292353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93083.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.504145733767714, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.472981091151162, "policy_loss": -0.011842551700051421, "vf_loss": 7.483522984338185, "vf_explained_var": 0.508320931593577, "kl": 0.013006666356392166, "entropy": 0.5330438825503859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93083.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 829.9958889678808, "episode_reward_min": -220.61916463042445, "episode_reward_mean": 205.0385474096585, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -944.7435441797094, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 369.68622243928513, "predator_policy": 1018.2780995349988}, "policy_reward_mean": {"prey_policy": -536.9955215566954, "predator_policy": 639.514795261525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-208.85097708888046, 281.92846948608667, 360.6373655956605, 1.0763813104869113, 41.30000000000031, 39.60683040113031, 503.02509198746054, 12.39999999999997, 490.6173807600626, 12.199999999999976, 4.699999999999999, 1.0845579478236425, 4.199999999999999, 4.500000000000002, -3.663435529611337, 60.93591322679815, 283.55883573945806, 115.33623811932246, 2.699999999999995, 28.91905928745648, 705.8904720148323, 391.93434899787974, -0.877809795602702, 144.47639759131178, -220.61916463042445, 666.575645545587, 9.186372661890346, 5.1999999999999975, 570.3562279638768, 514.3109403307853, 10.385239946133925, 40.057561456906754, 141.11239215562492, 17.63223166957313, 457.71938545162936, 6.9999999999999885, 2.900000000000005, 536.9558582073156, 0.9126051733063303, 119.31728642176519, 3.2000000000000037, 73.53704722632745, 4.184764545625556, 482.1131640067912, 395.00022062248564, 49.840779670475, 405.0011842865688, 246.683832740843, 363.8649154640334, 317.55849550161435, 123.59653673254839, 2.7, 138.93481814816792, 510.8916303501326, 108.3702044205596, 200.06524558611275, 0.5000000000000009, 119.53504481831767, 420.80976567920607, 246.02467032033132, -32.34214003751792, 316.292188219929, 210.49233237002457, 370.33284407260396, 526.4059135784141, 154.57439881286135, 14.320910331073016, 27.027806725814106, 745.4388273026855, 362.9149133549643, 557.3232785554068, 57.64734934171087, -43.5544116937296, 79.49999999999976, 278.43830555524937, 308.889641454002, 347.3010361574837, 79.74624040602967, -1.7763568394002505e-15, 227.1134943489804, 488.9001019540218, 51.96726147527296, -8.612133007140581, 3.000000000000001, 538.7876163335907, 499.6105544268533, 416.30314350799705, -32.70435428145896, 272.2760472301418, 228.88771058531074, 61.22635298144325, 470.2314692248214, 722.5642028064264, 0.8999999999999995, 428.4907334793389, 6.5999999999999925, 829.9958889678808, 124.48667362562506, 412.6302865077241, 31.400233766226407], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-301.4393365806542, -657.8939314124607, -318.2903985611945, -865.1082318150991, -28.91383271119937, -722.622436705465, -366.40878701619636, -317.4411147434406, 40.0000000000003, -744.079823455206, -656.2685282757277, -572.1867464726315, -724.966987189173, -53.53744720873192, -667.9870039728407, -615.8909017421623, -775.167578039757, -147.45991632650453, -611.8742780623516, -643.7180195021122, -683.5212860274584, -667.8208168867585, -294.27107684771676, -673.2720749809257, -649.92547542973, -674.1382517051451, -708.3611261414011, -673.848827285062, -672.5478359522282, -668.7108118788175, -628.1372598993339, -807.2184553151245, -810.5573067369857, -348.1089588797825, -884.496867083915, -504.44215339057735, -606.7987076752534, -741.4875986256855, -594.3642354157413, -531.3813523600052, -49.398772785487495, -727.0524975199361, -758.0420832514396, 332.33388437517186, -798.9808904254605, -697.980360257208, -734.6932350776268, -680.0833686700723, -295.8189834550954, -525.8542936721789, -29.068703100237457, -849.8695679488383, -721.7162059112148, -680.1119391658158, -788.8165688479619, -593.974693738721, -682.2712770357726, 44.492135753615344, -640.6755462049606, 104.89114830137464, -734.5542073652042, -729.2030771239073, -348.14800840086906, -740.2780491257193, -502.4274017822913, -739.6599840699781, -722.190852021633, -593.3656272391863, -795.0101553217081, -109.92224049027169, -688.8750089180708, -778.2718875683139, -841.6568912692478, -522.0707467711262, -687.0549802632062, -51.36071277022242, -709.9838603568629, -671.7857871829308, -478.9524525179248, -697.1794437081311, -579.3832617723026, -659.142376282944, -317.94397504589045, -625.1378858931874, -838.4309780846736, -836.3323145580143, -758.1646643300959, -68.89085698826364, -944.7435441797094, -440.6129619255098, -691.8636930750498, -601.953874146611, -688.6973171614658, -129.74166379803117, -833.1153729221627, -205.1322525083855, -381.86199273250776, -747.9990891868879, -291.2547477574749, -708.4968766216762, -687.8426031671617, -531.0744406295604, -666.1580858066023, -699.4087306606351, -553.5146976264901, -800.2402477702631, -394.3990758985672, -470.9599125241191, -680.540222071795, -686.5341162229794, -429.86063808102125, -816.5330286462323, -757.6729382907168, -686.2647787326213, -454.6464272711798, -728.5317305447489, -137.59287524982383, -793.0489763489763, -645.3018663777377, -482.57376262993506, -823.7772137536616, -770.18593040675, -915.5747594956096, -393.65538970827333, -331.2541401124538, -450.19543058198036, -685.9696402173469, 319.3981186942956, -935.8735797059448, -234.31725329414434, -562.1686032200062, -522.5504081835838, -521.8655685730589, -752.3309858197339, -730.6716540273517, -759.1540284033249, -727.8389229948992, 340.3710046355517, -352.80187882303545, -876.9362653019581, -24.92964953071305, -789.4978381234461, -701.5546230741692, -765.8776815732224, -678.1684491376701, -799.8511295816553, 34.66426507082317, 40.0000000000003, -102.94656334047332, -878.1778988566482, -240.00751627685344, -790.3748984293004, -155.28908407453883, -578.6338448773035, -622.674096610068, -719.2046059453181, -743.7061792418028, -735.2058916533994, -867.5238136753961, -50.08279193705597, -675.4227844212697, -130.75927752834744, -442.49847836011753, -346.3281081649936, -266.11938479731907, -220.35224615286575, -925.2082601151461, -684.0725110550563, -581.6297458961626, 202.44998674766228, 30.67107821331342, -757.0265633902213, -731.147926960644, 369.68622243928513, -937.4928578911246, -766.4642626407767, -723.1206819148904, -213.4119958176, -486.34814757503375, -476.51956720630085, -553.132410041786, -611.5996334740672, -695.0300798726458, 341.92396582650537, -882.6777892872998, 166.48605698930902, -736.9115975971126, -699.9184551990088, -723.0129517869608, -87.69292283179088, -711.4152422171233, -539.8913848007668, 185.1053207768809, -855.0504466783555, -461.8521626021813, -919.3850019643761, -189.48239513218326, -720.6506054035913, -652.0640697234694, -494.43434893273036], "policy_predator_policy_reward": [750.4822909042351, 0.0, 923.0485277348629, 542.2785721275202, 489.95253772276993, 622.2210972895507, 103.13018718214346, 581.7960958879831, 0.0, 745.379823455206, 612.2091629057483, 655.8529422437401, 633.3711134196578, 648.1584129657093, 671.5870039728418, 624.6909017421633, 716.3817113662428, 696.8631637600804, 619.9742780623519, 647.8180195021131, 683.7212860274584, 672.3208168867584, 736.7262848138789, 231.90142496259148, 654.02547542973, 674.2382517051451, 710.2611261414011, 676.4488272850626, 663.3058505619671, 674.2893617394666, 767.4123076118335, 728.8793208294253, 764.1479338779662, 678.0771674782625, 875.8686457355935, 628.4066128582242, 608.1987076752537, 742.7875986256857, 681.0737953085919, 473.5908517546163, 835.8358020984202, 646.505940221832, 499.5418346315902, 318.1007132425574, 800.12072665196, 695.9627142351063, 706.7175123526697, 852.5354889863403, 601.0541124968497, 0.0, 686.1991729398331, 859.3147436548304, 723.5025785731053, 687.5119391658158, 789.7165688479619, 598.2746937387212, 629.9725548170362, 578.1628144289962, 382.3243805544394, 667.7709576799306, 718.7221151657315, 755.4204092695139, 656.3288928069672, 472.1547261765304, 644.1743761912743, 739.025401816624, 732.4242784868302, 600.7644324435626, 706.0629375231817, 656.5888437404237, 689.2750089180707, 784.8718875683136, 842.0568912692479, 524.5707467711267, 628.5018238878763, 646.8697273528713, 709.9838603568629, 672.6983923562375, 603.9539294325916, 691.4952532152319, 582.5832617723034, 659.142376282944, 620.6616592494438, 395.95724891596683, 842.6157426302991, 836.3323145580143, 736.6515243937768, 572.5171609313803, 880.415429408665, 899.94129731904, 630.1172734039222, 713.541073488215, 635.2689058219594, 588.1712594241058, 486.4147019599695, 798.5167562114208, 802.994409295394, 690.7315880880477, 692.1274068733036, 625.1827130074622, 673.4231743014938, 669.0904062277779, 668.6580858066023, 699.6087306606352, 752.2438460422711, 740.4459175026504, 694.9373535400667, 681.3132652327529, 798.8290513981876, 676.6154913171484, 700.9821919291583, 745.476720384213, 758.1729382907168, 686.2647787326213, 563.7581938143286, 738.9550088199187, 637.7942236956764, 713.6573935823255, 638.9260056395351, 734.9742936884694, 770.3663726913964, 791.2546314314966, 740.4223144020402, 885.1000230217772, 340.83159526402846, 651.1103078004332, 687.2696402173472, 49.63472537830833, 678.3186470435126, 1018.2780995349988, 596.082312654439, 643.2110975620112, 536.1864789041318, 752.3309858197339, 764.7139528672072, 752.1395362892846, 661.6630614542981, 471.2436842077308, 793.3174063962464, 799.3356510837119, 734.647773200796, 637.1029930087692, 759.20197241588, 765.8776815732224, 736.8978072971455, 697.5673597284487, 4.83573492917705, 0.0, 764.8747273488339, 494.6880404035328, 738.9447682171689, 600.327287942987, 583.0384367457497, 498.1855283635768, 710.6629460930848, 710.9619968683311, 743.7061792418028, 735.2058916533994, 763.0526875684577, 381.66741239297687, 619.7951711363562, 675.2869927672803, 570.7707180339543, 270.0231299664335, 477.8594979430464, 0.0, 925.2082601151461, 687.0725110550563, 221.74443060618663, 696.2229448759068, 560.9713542420371, 664.9946853617249, 731.147926960644, 46.61692106871184, 869.7231172045139, 801.529649045928, 694.6278454886182, 514.1808794740112, 673.2336556053078, 518.5217697613422, 776.568371069462, 449.3900254278333, 687.1028344809732, 136.23474878998692, 709.1784963302869, 729.5774387741269, 737.8115975971127, 699.9184551990088, 661.5359092341168, 577.6606988639736, 711.6152422171233, 546.2913848007671, 774.1295217195035, 725.8114931498509, 590.6254182159876, 915.0984199761947, 675.3354956324644, 647.4277914110378, 741.2594459355989, 436.6392064868303]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.562241382578923, "mean_inference_ms": 4.862074163138322, "mean_action_processing_ms": 1.7702274728376708, "mean_env_wait_ms": 13.20620007788031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004331707954406738, "StateBufferConnector_ms": 0.005458950996398926, "ViewRequirementAgentConnector_ms": 0.18263494968414307}, "num_episodes": 6, "episode_return_max": 829.9958889678808, "episode_return_min": -220.61916463042445, "episode_return_mean": 205.0385474096585, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.39449547323832, "num_env_steps_trained_throughput_per_sec": 153.39449547323832, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 26349.99, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26349.719, "sample_time_ms": 2498.389, "learn_time_ms": 23827.684, "learn_throughput": 167.872, "synch_weights_time_ms": 19.535}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-18-45", "timestamp": 1724384925, "time_this_iter_s": 26.143696069717407, "time_total_s": 2638.473221540451, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x309681d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2638.473221540451, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 35.0945945945946, "ram_util_percent": 82.33783783783782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.924275920504616, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.399900440942673, "policy_loss": -0.01021080955582124, "vf_loss": 7.409630722469753, "vf_explained_var": 0.18937447222452314, "kl": 0.009610134523076118, "entropy": 0.2992710204351516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 94028.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.29337134033284, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.579345659730295, "policy_loss": -0.010147059253027672, "vf_loss": 7.5884414990743005, "vf_explained_var": 0.5080432779574521, "kl": 0.010512177690016056, "entropy": 0.5204430336043948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 94028.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 904.6061760126963, "episode_reward_min": -220.61916463042445, "episode_reward_mean": 218.96120171953123, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -944.7435441797094, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 371.9845303571001, "predator_policy": 1018.2780995349988}, "policy_reward_mean": {"prey_policy": -533.1037977100469, "predator_policy": 642.584398569813}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.699999999999999, 1.0845579478236425, 4.199999999999999, 4.500000000000002, -3.663435529611337, 60.93591322679815, 283.55883573945806, 115.33623811932246, 2.699999999999995, 28.91905928745648, 705.8904720148323, 391.93434899787974, -0.877809795602702, 144.47639759131178, -220.61916463042445, 666.575645545587, 9.186372661890346, 5.1999999999999975, 570.3562279638768, 514.3109403307853, 10.385239946133925, 40.057561456906754, 141.11239215562492, 17.63223166957313, 457.71938545162936, 6.9999999999999885, 2.900000000000005, 536.9558582073156, 0.9126051733063303, 119.31728642176519, 3.2000000000000037, 73.53704722632745, 4.184764545625556, 482.1131640067912, 395.00022062248564, 49.840779670475, 405.0011842865688, 246.683832740843, 363.8649154640334, 317.55849550161435, 123.59653673254839, 2.7, 138.93481814816792, 510.8916303501326, 108.3702044205596, 200.06524558611275, 0.5000000000000009, 119.53504481831767, 420.80976567920607, 246.02467032033132, -32.34214003751792, 316.292188219929, 210.49233237002457, 370.33284407260396, 526.4059135784141, 154.57439881286135, 14.320910331073016, 27.027806725814106, 745.4388273026855, 362.9149133549643, 557.3232785554068, 57.64734934171087, -43.5544116937296, 79.49999999999976, 278.43830555524937, 308.889641454002, 347.3010361574837, 79.74624040602967, -1.7763568394002505e-15, 227.1134943489804, 488.9001019540218, 51.96726147527296, -8.612133007140581, 3.000000000000001, 538.7876163335907, 499.6105544268533, 416.30314350799705, -32.70435428145896, 272.2760472301418, 228.88771058531074, 61.22635298144325, 470.2314692248214, 722.5642028064264, 0.8999999999999995, 428.4907334793389, 6.5999999999999925, 829.9958889678808, 124.48667362562506, 412.6302865077241, 31.400233766226407, 554.0307574484498, 904.6061760126963, 313.10750682901795, 472.93934815811036, 17.545372650343516, 395.7294546606767, 136.6141570800551, 71.27782464586448, 55.455375954065815, 4.900000000000002], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-683.5212860274584, -667.8208168867585, -294.27107684771676, -673.2720749809257, -649.92547542973, -674.1382517051451, -708.3611261414011, -673.848827285062, -672.5478359522282, -668.7108118788175, -628.1372598993339, -807.2184553151245, -810.5573067369857, -348.1089588797825, -884.496867083915, -504.44215339057735, -606.7987076752534, -741.4875986256855, -594.3642354157413, -531.3813523600052, -49.398772785487495, -727.0524975199361, -758.0420832514396, 332.33388437517186, -798.9808904254605, -697.980360257208, -734.6932350776268, -680.0833686700723, -295.8189834550954, -525.8542936721789, -29.068703100237457, -849.8695679488383, -721.7162059112148, -680.1119391658158, -788.8165688479619, -593.974693738721, -682.2712770357726, 44.492135753615344, -640.6755462049606, 104.89114830137464, -734.5542073652042, -729.2030771239073, -348.14800840086906, -740.2780491257193, -502.4274017822913, -739.6599840699781, -722.190852021633, -593.3656272391863, -795.0101553217081, -109.92224049027169, -688.8750089180708, -778.2718875683139, -841.6568912692478, -522.0707467711262, -687.0549802632062, -51.36071277022242, -709.9838603568629, -671.7857871829308, -478.9524525179248, -697.1794437081311, -579.3832617723026, -659.142376282944, -317.94397504589045, -625.1378858931874, -838.4309780846736, -836.3323145580143, -758.1646643300959, -68.89085698826364, -944.7435441797094, -440.6129619255098, -691.8636930750498, -601.953874146611, -688.6973171614658, -129.74166379803117, -833.1153729221627, -205.1322525083855, -381.86199273250776, -747.9990891868879, -291.2547477574749, -708.4968766216762, -687.8426031671617, -531.0744406295604, -666.1580858066023, -699.4087306606351, -553.5146976264901, -800.2402477702631, -394.3990758985672, -470.9599125241191, -680.540222071795, -686.5341162229794, -429.86063808102125, -816.5330286462323, -757.6729382907168, -686.2647787326213, -454.6464272711798, -728.5317305447489, -137.59287524982383, -793.0489763489763, -645.3018663777377, -482.57376262993506, -823.7772137536616, -770.18593040675, -915.5747594956096, -393.65538970827333, -331.2541401124538, -450.19543058198036, -685.9696402173469, 319.3981186942956, -935.8735797059448, -234.31725329414434, -562.1686032200062, -522.5504081835838, -521.8655685730589, -752.3309858197339, -730.6716540273517, -759.1540284033249, -727.8389229948992, 340.3710046355517, -352.80187882303545, -876.9362653019581, -24.92964953071305, -789.4978381234461, -701.5546230741692, -765.8776815732224, -678.1684491376701, -799.8511295816553, 34.66426507082317, 40.0000000000003, -102.94656334047332, -878.1778988566482, -240.00751627685344, -790.3748984293004, -155.28908407453883, -578.6338448773035, -622.674096610068, -719.2046059453181, -743.7061792418028, -735.2058916533994, -867.5238136753961, -50.08279193705597, -675.4227844212697, -130.75927752834744, -442.49847836011753, -346.3281081649936, -266.11938479731907, -220.35224615286575, -925.2082601151461, -684.0725110550563, -581.6297458961626, 202.44998674766228, 30.67107821331342, -757.0265633902213, -731.147926960644, 369.68622243928513, -937.4928578911246, -766.4642626407767, -723.1206819148904, -213.4119958176, -486.34814757503375, -476.51956720630085, -553.132410041786, -611.5996334740672, -695.0300798726458, 341.92396582650537, -882.6777892872998, 166.48605698930902, -736.9115975971126, -699.9184551990088, -723.0129517869608, -87.69292283179088, -711.4152422171233, -539.8913848007668, 185.1053207768809, -855.0504466783555, -461.8521626021813, -919.3850019643761, -189.48239513218326, -720.6506054035913, -652.0640697234694, -494.43434893273036, -1.2984898823474964, -580.6851279702405, -772.9336143646194, 371.9845303571001, -591.1983901521933, 73.20104487306301, -769.2485366998969, -49.83241808324482, -699.573054458833, -856.8430379197139, 16.778283440272137, -743.8782234354259, -560.3920540034981, -445.6729787274779, -611.0960522268713, -789.2015308520616, -656.5425771330642, 26.4802532022865, -710.5219837629435, -622.4365726635085], "policy_predator_policy_reward": [683.7212860274584, 672.3208168867584, 736.7262848138789, 231.90142496259148, 654.02547542973, 674.2382517051451, 710.2611261414011, 676.4488272850626, 663.3058505619671, 674.2893617394666, 767.4123076118335, 728.8793208294253, 764.1479338779662, 678.0771674782625, 875.8686457355935, 628.4066128582242, 608.1987076752537, 742.7875986256857, 681.0737953085919, 473.5908517546163, 835.8358020984202, 646.505940221832, 499.5418346315902, 318.1007132425574, 800.12072665196, 695.9627142351063, 706.7175123526697, 852.5354889863403, 601.0541124968497, 0.0, 686.1991729398331, 859.3147436548304, 723.5025785731053, 687.5119391658158, 789.7165688479619, 598.2746937387212, 629.9725548170362, 578.1628144289962, 382.3243805544394, 667.7709576799306, 718.7221151657315, 755.4204092695139, 656.3288928069672, 472.1547261765304, 644.1743761912743, 739.025401816624, 732.4242784868302, 600.7644324435626, 706.0629375231817, 656.5888437404237, 689.2750089180707, 784.8718875683136, 842.0568912692479, 524.5707467711267, 628.5018238878763, 646.8697273528713, 709.9838603568629, 672.6983923562375, 603.9539294325916, 691.4952532152319, 582.5832617723034, 659.142376282944, 620.6616592494438, 395.95724891596683, 842.6157426302991, 836.3323145580143, 736.6515243937768, 572.5171609313803, 880.415429408665, 899.94129731904, 630.1172734039222, 713.541073488215, 635.2689058219594, 588.1712594241058, 486.4147019599695, 798.5167562114208, 802.994409295394, 690.7315880880477, 692.1274068733036, 625.1827130074622, 673.4231743014938, 669.0904062277779, 668.6580858066023, 699.6087306606352, 752.2438460422711, 740.4459175026504, 694.9373535400667, 681.3132652327529, 798.8290513981876, 676.6154913171484, 700.9821919291583, 745.476720384213, 758.1729382907168, 686.2647787326213, 563.7581938143286, 738.9550088199187, 637.7942236956764, 713.6573935823255, 638.9260056395351, 734.9742936884694, 770.3663726913964, 791.2546314314966, 740.4223144020402, 885.1000230217772, 340.83159526402846, 651.1103078004332, 687.2696402173472, 49.63472537830833, 678.3186470435126, 1018.2780995349988, 596.082312654439, 643.2110975620112, 536.1864789041318, 752.3309858197339, 764.7139528672072, 752.1395362892846, 661.6630614542981, 471.2436842077308, 793.3174063962464, 799.3356510837119, 734.647773200796, 637.1029930087692, 759.20197241588, 765.8776815732224, 736.8978072971455, 697.5673597284487, 4.83573492917705, 0.0, 764.8747273488339, 494.6880404035328, 738.9447682171689, 600.327287942987, 583.0384367457497, 498.1855283635768, 710.6629460930848, 710.9619968683311, 743.7061792418028, 735.2058916533994, 763.0526875684577, 381.66741239297687, 619.7951711363562, 675.2869927672803, 570.7707180339543, 270.0231299664335, 477.8594979430464, 0.0, 925.2082601151461, 687.0725110550563, 221.74443060618663, 696.2229448759068, 560.9713542420371, 664.9946853617249, 731.147926960644, 46.61692106871184, 869.7231172045139, 801.529649045928, 694.6278454886182, 514.1808794740112, 673.2336556053078, 518.5217697613422, 776.568371069462, 449.3900254278333, 687.1028344809732, 136.23474878998692, 709.1784963302869, 729.5774387741269, 737.8115975971127, 699.9184551990088, 661.5359092341168, 577.6606988639736, 711.6152422171233, 546.2913848007671, 774.1295217195035, 725.8114931498509, 590.6254182159876, 915.0984199761947, 675.3354956324644, 647.4277914110378, 741.2594459355989, 436.6392064868303, 575.8061820927045, 560.2081932083313, 578.8313267895032, 726.7239332307178, 0.0, 831.1048521081515, 638.5652161956814, 653.4550867455675, 726.8014860033328, 847.1599790255572, 502.6857918144717, 620.1436028413525, 594.0385300821664, 548.6406597288644, 702.7768218385955, 768.7985858862031, 405.7939838302856, 279.7237160545574, 714.3219837629443, 623.5365726635087]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.558663736804412, "mean_inference_ms": 4.862423413349645, "mean_action_processing_ms": 1.772369731620998, "mean_env_wait_ms": 13.196437913049422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00428164005279541, "StateBufferConnector_ms": 0.005433440208435059, "ViewRequirementAgentConnector_ms": 0.18219029903411865}, "num_episodes": 10, "episode_return_max": 904.6061760126963, "episode_return_min": -220.61916463042445, "episode_return_mean": 218.96120171953123, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.2532281510935, "num_env_steps_trained_throughput_per_sec": 154.2532281510935, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 26345.946, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26345.68, "sample_time_ms": 2529.964, "learn_time_ms": 23793.528, "learn_throughput": 168.113, "synch_weights_time_ms": 18.159}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "dcfd0_00000", "date": "2024-08-23_09-19-11", "timestamp": 1724384951, "time_this_iter_s": 25.985648155212402, "time_total_s": 2664.4588696956635, "pid": 48576, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 2, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1325f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2664.4588696956635, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 33.14324324324325, "ram_util_percent": 82.75675675675674}}
